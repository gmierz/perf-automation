{"code":"(globalThis.webpackJsonp=globalThis.webpackJsonp||[]).push([[14],{1550:function(e,t,n){\"use strict\";n.r(t),n.d(t,\"default\",(function(){return p}));var a=n(0),o=n.n(a),s=n(1),r=n(15),l=n(6),c=n(9),i=n(116),u=n(93),m=n(14),h=n(26),d=n(28),b=n(51);function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class p extends o.a.Component{constructor(e){super(e),g(this,\"updateCurrentRoom\",async e=>{const t=u.a.get();let n;try{n=await t.getStats()}catch{return}let a=null;e&&(a=e.name);const o=t.crawlingRooms(),s=o.crawlingRooms.size,r=o.totalRooms.size;this.setState({eventIndexSize:n.size,eventCount:n.eventCount,crawlingRoomsCount:s,roomCount:r,currentRoom:a})}),g(this,\"onDisable\",async()=>{const e=(await n.e(13).then(n.bind(null,1559))).default;c.a.createTrackedDialog(\"Disable message search\",\"Disable message search\",e,null,null,!1,!0)}),g(this,\"onCrawlerSleepTimeChange\",e=>{this.setState({crawlerSleepTime:e.target.value}),l.b.setValue(\"crawlerSleepTime\",null,m.a.DEVICE,e.target.value)}),this.state={eventIndexSize:0,eventCount:0,crawlingRoomsCount:0,roomCount:0,currentRoom:null,crawlerSleepTime:l.b.getValueAt(m.a.DEVICE,\"crawlerSleepTime\")}}componentWillUnmount(){const e=u.a.get();null!==e&&e.removeListener(\"changedCheckpoint\",this.updateCurrentRoom)}async componentDidMount(){let e=0,t=0,n=0,a=0,o=null;const s=u.a.get();if(null!==s){s.on(\"changedCheckpoint\",this.updateCurrentRoom);try{const t=await s.getStats();e=t.size,a=t.eventCount}catch{}const r=s.crawlingRooms();t=r.crawlingRooms.size,n=r.totalRooms.size;const l=s.currentRoom();l&&(o=l.name)}this.setState({eventIndexSize:e,eventCount:a,crawlingRoomsCount:t,roomCount:n,currentRoom:o})}render(){const e=r.a.get().brand;let t;t=null===this.state.currentRoom?Object(s.a)(\"Not currently indexing messages for any room.\"):Object(s.a)(\"Currently indexing: %(currentRoom)s\",{currentRoom:this.state.currentRoom});const n=Math.max(0,this.state.roomCount-this.state.crawlingRoomsCount),a=o.a.createElement(\"div\",null,Object(s.a)(\"%(brand)s is securely caching encrypted messages locally for them to appear in search results:\",{brand:e}),o.a.createElement(\"div\",{className:\"mx_SettingsTab_subsectionText\"},t,o.a.createElement(\"br\",null),Object(s.a)(\"Space used:\"),\" \",Object(i.a)(this.state.eventIndexSize,0),o.a.createElement(\"br\",null),Object(s.a)(\"Indexed messages:\"),\" \",Object(i.d)(this.state.eventCount),o.a.createElement(\"br\",null),Object(s.a)(\"Indexed rooms:\"),\" \",Object(s.a)(\"%(doneRooms)s out of %(totalRooms)s\",{doneRooms:Object(i.d)(n),totalRooms:Object(i.d)(this.state.roomCount)}),\" \",o.a.createElement(\"br\",null),o.a.createElement(h.a,{label:Object(s.a)(\"Message downloading sleep time(ms)\"),type:\"number\",value:this.state.crawlerSleepTime.toString(),onChange:this.onCrawlerSleepTimeChange})));return o.a.createElement(d.a,{className:\"mx_ManageEventIndexDialog\",onFinished:this.props.onFinished,title:Object(s.a)(\"Message search\")},a,o.a.createElement(b.a,{primaryButton:Object(s.a)(\"Done\"),onPrimaryButtonClick:this.props.onFinished,primaryButtonClass:\"primary\",cancelButton:Object(s.a)(\"Disable\"),onCancel:this.onDisable,cancelButtonClass:\"danger\"}))}}}}]);","extractedComments":[]}