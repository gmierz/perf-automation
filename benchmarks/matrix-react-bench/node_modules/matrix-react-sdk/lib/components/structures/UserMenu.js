"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireWildcard(require("react"));

var _classnames = _interopRequireDefault(require("classnames"));

var _MatrixClientPeg = require("../../MatrixClientPeg");

var _dispatcher = _interopRequireDefault(require("../../dispatcher/dispatcher"));

var _actions = require("../../dispatcher/actions");

var _languageHandler = require("../../languageHandler");

var _ContextMenu = require("./ContextMenu");

var _UserSettingsDialog = require("../views/dialogs/UserSettingsDialog");

var _FeedbackDialog = _interopRequireDefault(require("../views/dialogs/FeedbackDialog"));

var _Modal = _interopRequireDefault(require("../../Modal"));

var _LogoutDialog = _interopRequireDefault(require("../views/dialogs/LogoutDialog"));

var _SettingsStore = _interopRequireDefault(require("../../settings/SettingsStore"));

var _theme = require("../../theme");

var _AccessibleButton = _interopRequireDefault(require("../views/elements/AccessibleButton"));

var _SdkConfig = _interopRequireDefault(require("../../SdkConfig"));

var _pages = require("../../utils/pages");

var _OwnProfileStore = require("../../stores/OwnProfileStore");

var _AsyncStore = require("../../stores/AsyncStore");

var _BaseAvatar = _interopRequireDefault(require("../views/avatars/BaseAvatar"));

var _AccessibleTooltipButton = _interopRequireDefault(require("../views/elements/AccessibleTooltipButton"));

var _SettingLevel = require("../../settings/SettingLevel");

var _IconizedContextMenu = _interopRequireWildcard(require("../views/context_menus/IconizedContextMenu"));

var _CommunityPrototypeStore = require("../../stores/CommunityPrototypeStore");

var _GroupFilterOrderStore = _interopRequireDefault(require("../../stores/GroupFilterOrderStore"));

var _RoomInvite = require("../../RoomInvite");

var _RightPanelStorePhases = require("../../stores/RightPanelStorePhases");

var _ErrorDialog = _interopRequireDefault(require("../views/dialogs/ErrorDialog"));

var _EditCommunityPrototypeDialog = _interopRequireDefault(require("../views/dialogs/EditCommunityPrototypeDialog"));

var _UIFeature = require("../../settings/UIFeature");

var _HostSignupAction = _interopRequireDefault(require("./HostSignupAction"));

var _SpaceStore = _interopRequireDefault(require("../../stores/spaces/SpaceStore"));

var _spaces = require("../../stores/spaces");

var _RoomName = _interopRequireDefault(require("../views/elements/RoomName"));

var _replaceableComponent = require("../../utils/replaceableComponent");

var _InlineSpinner = _interopRequireDefault(require("../views/elements/InlineSpinner"));

var _TooltipButton = _interopRequireDefault(require("../views/elements/TooltipButton"));

var _logger = require("matrix-js-sdk/src/logger");

var _dec, _class;

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

let UserMenu = (_dec = (0, _replaceableComponent.replaceableComponent)("structures.UserMenu"), _dec(_class = class UserMenu extends _react.default.Component {
  constructor(props) {
    super(props);
    (0, _defineProperty2.default)(this, "dispatcherRef", void 0);
    (0, _defineProperty2.default)(this, "themeWatcherRef", void 0);
    (0, _defineProperty2.default)(this, "dndWatcherRef", void 0);
    (0, _defineProperty2.default)(this, "buttonRef", /*#__PURE__*/(0, _react.createRef)());
    (0, _defineProperty2.default)(this, "tagStoreRef", void 0);
    (0, _defineProperty2.default)(this, "onRoom", room => {
      this.removePendingJoinRoom(room.roomId);
    });
    (0, _defineProperty2.default)(this, "onTagStoreUpdate", () => {
      this.forceUpdate(); // we don't have anything useful in state to update
    });
    (0, _defineProperty2.default)(this, "onProfileUpdate", async () => {
      // the store triggered an update, so force a layout update. We don't
      // have any state to store here for that to magically happen.
      this.forceUpdate();
    });
    (0, _defineProperty2.default)(this, "onSelectedSpaceUpdate", async () => {
      this.setState({
        selectedSpace: _SpaceStore.default.instance.activeSpaceRoom
      });
    });
    (0, _defineProperty2.default)(this, "onThemeChanged", () => {
      this.setState({
        isDarkTheme: this.isUserOnDarkTheme(),
        isHighContrast: this.isUserOnHighContrastTheme()
      });
    });
    (0, _defineProperty2.default)(this, "onAction", ev => {
      switch (ev.action) {
        case _actions.Action.ToggleUserMenu:
          if (this.state.contextMenuPosition) {
            this.setState({
              contextMenuPosition: null
            });
          } else {
            if (this.buttonRef.current) this.buttonRef.current.click();
          }

          break;

        case _actions.Action.JoinRoom:
          this.addPendingJoinRoom(ev.roomId);
          break;

        case _actions.Action.JoinRoomReady:
        case _actions.Action.JoinRoomError:
          this.removePendingJoinRoom(ev.roomId);
          break;
      }
    });
    (0, _defineProperty2.default)(this, "onOpenMenuClick", ev => {
      ev.preventDefault();
      ev.stopPropagation();
      const target = ev.target;
      this.setState({
        contextMenuPosition: target.getBoundingClientRect()
      });
    });
    (0, _defineProperty2.default)(this, "onContextMenu", ev => {
      ev.preventDefault();
      ev.stopPropagation();
      this.setState({
        contextMenuPosition: {
          left: ev.clientX,
          top: ev.clientY,
          width: 20,
          height: 0
        }
      });
    });
    (0, _defineProperty2.default)(this, "onCloseMenu", () => {
      this.setState({
        contextMenuPosition: null
      });
    });
    (0, _defineProperty2.default)(this, "onSwitchThemeClick", ev => {
      ev.preventDefault();
      ev.stopPropagation(); // Disable system theme matching if the user hits this button

      _SettingsStore.default.setValue("use_system_theme", null, _SettingLevel.SettingLevel.DEVICE, false);

      let newTheme = this.state.isDarkTheme ? "light" : "dark";

      if (this.state.isHighContrast) {
        const hcTheme = (0, _theme.findHighContrastTheme)(newTheme);

        if (hcTheme) {
          newTheme = hcTheme;
        }
      }

      _SettingsStore.default.setValue("theme", null, _SettingLevel.SettingLevel.DEVICE, newTheme); // set at same level as Appearance tab

    });
    (0, _defineProperty2.default)(this, "onSettingsOpen", (ev, tabId) => {
      ev.preventDefault();
      ev.stopPropagation();
      const payload = {
        action: _actions.Action.ViewUserSettings,
        initialTabId: tabId
      };

      _dispatcher.default.dispatch(payload);

      this.setState({
        contextMenuPosition: null
      }); // also close the menu
    });
    (0, _defineProperty2.default)(this, "onShowArchived", ev => {
      ev.preventDefault();
      ev.stopPropagation(); // TODO: Archived room view: https://github.com/vector-im/element-web/issues/14038
      // Note: You'll need to uncomment the button too.

      _logger.logger.log("TODO: Show archived rooms");
    });
    (0, _defineProperty2.default)(this, "onProvideFeedback", ev => {
      ev.preventDefault();
      ev.stopPropagation();

      _Modal.default.createTrackedDialog('Feedback Dialog', '', _FeedbackDialog.default);

      this.setState({
        contextMenuPosition: null
      }); // also close the menu
    });
    (0, _defineProperty2.default)(this, "onSignOutClick", async ev => {
      var _await$cli$exportRoom;

      ev.preventDefault();
      ev.stopPropagation();

      const cli = _MatrixClientPeg.MatrixClientPeg.get();

      if (!cli || !cli.isCryptoEnabled() || !((_await$cli$exportRoom = await cli.exportRoomKeys()) !== null && _await$cli$exportRoom !== void 0 && _await$cli$exportRoom.length)) {
        // log out without user prompt if they have no local megolm sessions
        _dispatcher.default.dispatch({
          action: 'logout'
        });
      } else {
        _Modal.default.createTrackedDialog('Logout from LeftPanel', '', _LogoutDialog.default);
      }

      this.setState({
        contextMenuPosition: null
      }); // also close the menu
    });
    (0, _defineProperty2.default)(this, "onSignInClick", () => {
      _dispatcher.default.dispatch({
        action: 'start_login'
      });

      this.setState({
        contextMenuPosition: null
      }); // also close the menu
    });
    (0, _defineProperty2.default)(this, "onRegisterClick", () => {
      _dispatcher.default.dispatch({
        action: 'start_registration'
      });

      this.setState({
        contextMenuPosition: null
      }); // also close the menu
    });
    (0, _defineProperty2.default)(this, "onHomeClick", ev => {
      ev.preventDefault();
      ev.stopPropagation();

      _dispatcher.default.dispatch({
        action: 'view_home_page'
      });

      this.setState({
        contextMenuPosition: null
      }); // also close the menu
    });
    (0, _defineProperty2.default)(this, "onCommunitySettingsClick", ev => {
      ev.preventDefault();
      ev.stopPropagation();

      _Modal.default.createTrackedDialog('Edit Community', '', _EditCommunityPrototypeDialog.default, {
        communityId: _CommunityPrototypeStore.CommunityPrototypeStore.instance.getSelectedCommunityId()
      });

      this.setState({
        contextMenuPosition: null
      }); // also close the menu
    });
    (0, _defineProperty2.default)(this, "onCommunityMembersClick", ev => {
      ev.preventDefault();
      ev.stopPropagation(); // We'd ideally just pop open a right panel with the member list, but the current
      // way the right panel is structured makes this exceedingly difficult. Instead, we'll
      // switch to the general room and open the member list there as it should be in sync
      // anyways.

      const chat = _CommunityPrototypeStore.CommunityPrototypeStore.instance.getSelectedCommunityGeneralChat();

      if (chat) {
        _dispatcher.default.dispatch({
          action: _actions.Action.ViewRoom,
          room_id: chat.roomId
        }, true);

        _dispatcher.default.dispatch({
          action: _actions.Action.SetRightPanelPhase,
          phase: _RightPanelStorePhases.RightPanelPhases.RoomMemberList
        });
      } else {
        // "This should never happen" clauses go here for the prototype.
        _Modal.default.createTrackedDialog('Failed to find general chat', '', _ErrorDialog.default, {
          title: (0, _languageHandler._t)('Failed to find the general chat for this community'),
          description: (0, _languageHandler._t)("Failed to find the general chat for this community")
        });
      }

      this.setState({
        contextMenuPosition: null
      }); // also close the menu
    });
    (0, _defineProperty2.default)(this, "onCommunityInviteClick", ev => {
      ev.preventDefault();
      ev.stopPropagation();
      (0, _RoomInvite.showCommunityInviteDialog)(_CommunityPrototypeStore.CommunityPrototypeStore.instance.getSelectedCommunityId());
      this.setState({
        contextMenuPosition: null
      }); // also close the menu
    });
    (0, _defineProperty2.default)(this, "onDndToggle", ev => {
      ev.stopPropagation();

      const current = _SettingsStore.default.getValue("doNotDisturb");

      _SettingsStore.default.setValue("doNotDisturb", null, _SettingLevel.SettingLevel.DEVICE, !current);
    });
    (0, _defineProperty2.default)(this, "renderContextMenu", () => {
      if (!this.state.contextMenuPosition) return null;

      const prototypeCommunityName = _CommunityPrototypeStore.CommunityPrototypeStore.instance.getSelectedCommunityName();

      let topSection;

      const hostSignupConfig = _SdkConfig.default.get().hostSignup;

      if (_MatrixClientPeg.MatrixClientPeg.get().isGuest()) {
        topSection = /*#__PURE__*/_react.default.createElement("div", {
          className: "mx_UserMenu_contextMenu_header mx_UserMenu_contextMenu_guestPrompts"
        }, (0, _languageHandler._t)("Got an account? <a>Sign in</a>", {}, {
          a: sub => /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
            kind: "link",
            onClick: this.onSignInClick
          }, sub)
        }), (0, _languageHandler._t)("New here? <a>Create an account</a>", {}, {
          a: sub => /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
            kind: "link",
            onClick: this.onRegisterClick
          }, sub)
        }));
      } else if (hostSignupConfig) {
        if (hostSignupConfig && hostSignupConfig.url) {
          // If hostSignup.domains is set to a non-empty array, only show
          // dialog if the user is on the domain or a subdomain.
          const hostSignupDomains = hostSignupConfig.domains || [];

          const mxDomain = _MatrixClientPeg.MatrixClientPeg.get().getDomain();

          const validDomains = hostSignupDomains.filter(d => d === mxDomain || mxDomain.endsWith(`.${d}`));

          if (!hostSignupConfig.domains || validDomains.length > 0) {
            topSection = /*#__PURE__*/_react.default.createElement(_HostSignupAction.default, {
              onClick: this.onCloseMenu
            });
          }
        }
      }

      let homeButton = null;

      if (this.hasHomePage) {
        homeButton = /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
          iconClassName: "mx_UserMenu_iconHome",
          label: (0, _languageHandler._t)("Home"),
          onClick: this.onHomeClick
        });
      }

      let feedbackButton;

      if (_SettingsStore.default.getValue(_UIFeature.UIFeature.Feedback)) {
        feedbackButton = /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
          iconClassName: "mx_UserMenu_iconMessage",
          label: (0, _languageHandler._t)("Feedback"),
          onClick: this.onProvideFeedback
        });
      }

      let primaryHeader = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_UserMenu_contextMenu_name"
      }, /*#__PURE__*/_react.default.createElement("span", {
        className: "mx_UserMenu_contextMenu_displayName"
      }, _OwnProfileStore.OwnProfileStore.instance.displayName), /*#__PURE__*/_react.default.createElement("span", {
        className: "mx_UserMenu_contextMenu_userId"
      }, _MatrixClientPeg.MatrixClientPeg.get().getUserId()));

      let primaryOptionList = /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOptionList, null, homeButton, /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
        iconClassName: "mx_UserMenu_iconBell",
        label: (0, _languageHandler._t)("Notification settings"),
        onClick: e => this.onSettingsOpen(e, _UserSettingsDialog.UserTab.Notifications)
      }), /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
        iconClassName: "mx_UserMenu_iconLock",
        label: (0, _languageHandler._t)("Security & privacy"),
        onClick: e => this.onSettingsOpen(e, _UserSettingsDialog.UserTab.Security)
      }), /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
        iconClassName: "mx_UserMenu_iconSettings",
        label: (0, _languageHandler._t)("All settings"),
        onClick: e => this.onSettingsOpen(e, null)
      }), feedbackButton), /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOptionList, {
        red: true
      }, /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
        iconClassName: "mx_UserMenu_iconSignOut",
        label: (0, _languageHandler._t)("Sign out"),
        onClick: this.onSignOutClick
      })));

      let secondarySection = null;

      if (prototypeCommunityName) {
        const communityId = _CommunityPrototypeStore.CommunityPrototypeStore.instance.getSelectedCommunityId();

        primaryHeader = /*#__PURE__*/_react.default.createElement("div", {
          className: "mx_UserMenu_contextMenu_name"
        }, /*#__PURE__*/_react.default.createElement("span", {
          className: "mx_UserMenu_contextMenu_displayName"
        }, prototypeCommunityName));
        let settingsOption;
        let inviteOption;

        if (_CommunityPrototypeStore.CommunityPrototypeStore.instance.canInviteTo(communityId)) {
          inviteOption = /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
            iconClassName: "mx_UserMenu_iconInvite",
            label: (0, _languageHandler._t)("Invite"),
            onClick: this.onCommunityInviteClick
          });
        }

        if (_CommunityPrototypeStore.CommunityPrototypeStore.instance.isAdminOf(communityId)) {
          settingsOption = /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
            iconClassName: "mx_UserMenu_iconSettings",
            label: (0, _languageHandler._t)("Settings"),
            "aria-label": (0, _languageHandler._t)("Community settings"),
            onClick: this.onCommunitySettingsClick
          });
        }

        primaryOptionList = /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOptionList, null, settingsOption, /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
          iconClassName: "mx_UserMenu_iconMembers",
          label: (0, _languageHandler._t)("Members"),
          onClick: this.onCommunityMembersClick
        }), inviteOption);
        secondarySection = /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement("hr", null), /*#__PURE__*/_react.default.createElement("div", {
          className: "mx_UserMenu_contextMenu_header"
        }, /*#__PURE__*/_react.default.createElement("div", {
          className: "mx_UserMenu_contextMenu_name"
        }, /*#__PURE__*/_react.default.createElement("span", {
          className: "mx_UserMenu_contextMenu_displayName"
        }, _OwnProfileStore.OwnProfileStore.instance.displayName), /*#__PURE__*/_react.default.createElement("span", {
          className: "mx_UserMenu_contextMenu_userId"
        }, _MatrixClientPeg.MatrixClientPeg.get().getUserId()))), /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOptionList, null, /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
          iconClassName: "mx_UserMenu_iconSettings",
          label: (0, _languageHandler._t)("Settings"),
          "aria-label": (0, _languageHandler._t)("User settings"),
          onClick: e => this.onSettingsOpen(e, null)
        }), feedbackButton), /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOptionList, {
          red: true
        }, /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
          iconClassName: "mx_UserMenu_iconSignOut",
          label: (0, _languageHandler._t)("Sign out"),
          onClick: this.onSignOutClick
        })));
      } else if (_MatrixClientPeg.MatrixClientPeg.get().isGuest()) {
        primaryOptionList = /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOptionList, null, homeButton, /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
          iconClassName: "mx_UserMenu_iconSettings",
          label: (0, _languageHandler._t)("Settings"),
          onClick: e => this.onSettingsOpen(e, null)
        }), feedbackButton));
      }

      const classes = (0, _classnames.default)({
        "mx_UserMenu_contextMenu": true,
        "mx_UserMenu_contextMenu_prototype": !!prototypeCommunityName
      });
      return /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.default // numerical adjustments to overlap the context menu by just over the width of the
      // menu icon and make it look connected
      , {
        left: this.state.contextMenuPosition.width + this.state.contextMenuPosition.left - 10,
        top: this.state.contextMenuPosition.top + this.state.contextMenuPosition.height + 8,
        onFinished: this.onCloseMenu,
        className: classes
      }, /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_UserMenu_contextMenu_header"
      }, primaryHeader, /*#__PURE__*/_react.default.createElement(_AccessibleTooltipButton.default, {
        className: "mx_UserMenu_contextMenu_themeButton",
        onClick: this.onSwitchThemeClick,
        title: this.state.isDarkTheme ? (0, _languageHandler._t)("Switch to light mode") : (0, _languageHandler._t)("Switch to dark mode")
      }, /*#__PURE__*/_react.default.createElement("img", {
        src: require("../../../res/img/element-icons/roomlist/dark-light-mode.svg"),
        alt: (0, _languageHandler._t)("Switch theme"),
        width: 16
      }))), topSection, primaryOptionList, secondarySection);
    });
    this.state = {
      contextMenuPosition: null,
      isDarkTheme: this.isUserOnDarkTheme(),
      isHighContrast: this.isUserOnHighContrastTheme(),
      pendingRoomJoin: new Set(),
      selectedSpace: _SpaceStore.default.instance.activeSpaceRoom
    };

    _OwnProfileStore.OwnProfileStore.instance.on(_AsyncStore.UPDATE_EVENT, this.onProfileUpdate);

    if (_SpaceStore.default.spacesEnabled) {
      _SpaceStore.default.instance.on(_spaces.UPDATE_SELECTED_SPACE, this.onSelectedSpaceUpdate);
    } // Force update is the easiest way to trigger the UI update (we don't store state for this)


    this.dndWatcherRef = _SettingsStore.default.watchSetting("doNotDisturb", null, () => this.forceUpdate());
  }

  get hasHomePage() {
    return !!(0, _pages.getHomePageUrl)(_SdkConfig.default.get());
  }

  componentDidMount() {
    this.dispatcherRef = _dispatcher.default.register(this.onAction);
    this.themeWatcherRef = _SettingsStore.default.watchSetting("theme", null, this.onThemeChanged);
    this.tagStoreRef = _GroupFilterOrderStore.default.addListener(this.onTagStoreUpdate);

    _MatrixClientPeg.MatrixClientPeg.get().on("Room", this.onRoom);
  }

  componentWillUnmount() {
    if (this.themeWatcherRef) _SettingsStore.default.unwatchSetting(this.themeWatcherRef);
    if (this.dndWatcherRef) _SettingsStore.default.unwatchSetting(this.dndWatcherRef);
    if (this.dispatcherRef) _dispatcher.default.unregister(this.dispatcherRef);

    _OwnProfileStore.OwnProfileStore.instance.off(_AsyncStore.UPDATE_EVENT, this.onProfileUpdate);

    this.tagStoreRef.remove();

    if (_SpaceStore.default.spacesEnabled) {
      _SpaceStore.default.instance.off(_spaces.UPDATE_SELECTED_SPACE, this.onSelectedSpaceUpdate);
    }

    _MatrixClientPeg.MatrixClientPeg.get().removeListener("Room", this.onRoom);
  }

  isUserOnDarkTheme() {
    if (_SettingsStore.default.getValue("use_system_theme")) {
      return window.matchMedia("(prefers-color-scheme: dark)").matches;
    } else {
      const theme = _SettingsStore.default.getValue("theme");

      if (theme.startsWith("custom-")) {
        return (0, _theme.getCustomTheme)(theme.substring("custom-".length)).is_dark;
      }

      return theme === "dark";
    }
  }

  isUserOnHighContrastTheme() {
    if (_SettingsStore.default.getValue("use_system_theme")) {
      return window.matchMedia("(prefers-contrast: more)").matches;
    } else {
      const theme = _SettingsStore.default.getValue("theme");

      if (theme.startsWith("custom-")) {
        return false;
      }

      return (0, _theme.isHighContrastTheme)(theme);
    }
  }

  addPendingJoinRoom(roomId) {
    this.setState({
      pendingRoomJoin: new Set(this.state.pendingRoomJoin).add(roomId)
    });
  }

  removePendingJoinRoom(roomId) {
    if (this.state.pendingRoomJoin.delete(roomId)) {
      this.setState({
        pendingRoomJoin: new Set(this.state.pendingRoomJoin)
      });
    }
  }

  render() {
    const avatarSize = 32; // should match border-radius of the avatar

    const userId = _MatrixClientPeg.MatrixClientPeg.get().getUserId();

    const displayName = _OwnProfileStore.OwnProfileStore.instance.displayName || userId;

    const avatarUrl = _OwnProfileStore.OwnProfileStore.instance.getHttpAvatarUrl(avatarSize);

    const prototypeCommunityName = _CommunityPrototypeStore.CommunityPrototypeStore.instance.getSelectedCommunityName();

    let isPrototype = false;
    let menuName = (0, _languageHandler._t)("User menu");

    let name = /*#__PURE__*/_react.default.createElement("span", {
      className: "mx_UserMenu_userName"
    }, displayName);

    let buttons = /*#__PURE__*/_react.default.createElement("span", {
      className: "mx_UserMenu_headerButtons"
    });

    let dnd;

    if (this.state.selectedSpace) {
      name = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_UserMenu_doubleName"
      }, /*#__PURE__*/_react.default.createElement("span", {
        className: "mx_UserMenu_userName"
      }, displayName), /*#__PURE__*/_react.default.createElement(_RoomName.default, {
        room: this.state.selectedSpace
      }, roomName => /*#__PURE__*/_react.default.createElement("span", {
        className: "mx_UserMenu_subUserName"
      }, roomName)));
    } else if (prototypeCommunityName) {
      name = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_UserMenu_doubleName"
      }, /*#__PURE__*/_react.default.createElement("span", {
        className: "mx_UserMenu_userName"
      }, prototypeCommunityName), /*#__PURE__*/_react.default.createElement("span", {
        className: "mx_UserMenu_subUserName"
      }, displayName));
      menuName = (0, _languageHandler._t)("Community and user menu");
      isPrototype = true;
    } else if (_SettingsStore.default.getValue("feature_communities_v2_prototypes")) {
      name = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_UserMenu_doubleName"
      }, /*#__PURE__*/_react.default.createElement("span", {
        className: "mx_UserMenu_userName"
      }, (0, _languageHandler._t)("Home")), /*#__PURE__*/_react.default.createElement("span", {
        className: "mx_UserMenu_subUserName"
      }, displayName));
      isPrototype = true;
    } else if (_SettingsStore.default.getValue("feature_dnd")) {
      const isDnd = _SettingsStore.default.getValue("doNotDisturb");

      dnd = /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
        onClick: this.onDndToggle,
        className: (0, _classnames.default)({
          "mx_UserMenu_dnd": true,
          "mx_UserMenu_dnd_noisy": !isDnd,
          "mx_UserMenu_dnd_muted": isDnd
        })
      });
    }

    if (this.props.isMinimized) {
      name = null;
      buttons = null;
    }

    const classes = (0, _classnames.default)({
      'mx_UserMenu': true,
      'mx_UserMenu_minimized': this.props.isMinimized,
      'mx_UserMenu_prototype': isPrototype
    });
    return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement(_ContextMenu.ContextMenuButton, {
      className: classes,
      onClick: this.onOpenMenuClick,
      inputRef: this.buttonRef,
      label: menuName,
      isExpanded: !!this.state.contextMenuPosition,
      onContextMenu: this.onContextMenu
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_UserMenu_row"
    }, /*#__PURE__*/_react.default.createElement("span", {
      className: "mx_UserMenu_userAvatarContainer"
    }, /*#__PURE__*/_react.default.createElement(_BaseAvatar.default, {
      idName: userId,
      name: displayName,
      url: avatarUrl,
      width: avatarSize,
      height: avatarSize,
      resizeMethod: "crop",
      className: "mx_UserMenu_userAvatar"
    })), name, this.state.pendingRoomJoin.size > 0 && /*#__PURE__*/_react.default.createElement(_InlineSpinner.default, null, /*#__PURE__*/_react.default.createElement(_TooltipButton.default, {
      helpText: (0, _languageHandler._t)("Currently joining %(count)s rooms", {
        count: this.state.pendingRoomJoin.size
      })
    })), dnd, buttons)), this.renderContextMenu());
  }

}) || _class);
exports.default = UserMenu;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3N0cnVjdHVyZXMvVXNlck1lbnUudHN4Il0sIm5hbWVzIjpbIlVzZXJNZW51IiwiUmVhY3QiLCJDb21wb25lbnQiLCJjb25zdHJ1Y3RvciIsInByb3BzIiwicm9vbSIsInJlbW92ZVBlbmRpbmdKb2luUm9vbSIsInJvb21JZCIsImZvcmNlVXBkYXRlIiwic2V0U3RhdGUiLCJzZWxlY3RlZFNwYWNlIiwiU3BhY2VTdG9yZSIsImluc3RhbmNlIiwiYWN0aXZlU3BhY2VSb29tIiwiaXNEYXJrVGhlbWUiLCJpc1VzZXJPbkRhcmtUaGVtZSIsImlzSGlnaENvbnRyYXN0IiwiaXNVc2VyT25IaWdoQ29udHJhc3RUaGVtZSIsImV2IiwiYWN0aW9uIiwiQWN0aW9uIiwiVG9nZ2xlVXNlck1lbnUiLCJzdGF0ZSIsImNvbnRleHRNZW51UG9zaXRpb24iLCJidXR0b25SZWYiLCJjdXJyZW50IiwiY2xpY2siLCJKb2luUm9vbSIsImFkZFBlbmRpbmdKb2luUm9vbSIsIkpvaW5Sb29tUmVhZHkiLCJKb2luUm9vbUVycm9yIiwicHJldmVudERlZmF1bHQiLCJzdG9wUHJvcGFnYXRpb24iLCJ0YXJnZXQiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJsZWZ0IiwiY2xpZW50WCIsInRvcCIsImNsaWVudFkiLCJ3aWR0aCIsImhlaWdodCIsIlNldHRpbmdzU3RvcmUiLCJzZXRWYWx1ZSIsIlNldHRpbmdMZXZlbCIsIkRFVklDRSIsIm5ld1RoZW1lIiwiaGNUaGVtZSIsInRhYklkIiwicGF5bG9hZCIsIlZpZXdVc2VyU2V0dGluZ3MiLCJpbml0aWFsVGFiSWQiLCJkZWZhdWx0RGlzcGF0Y2hlciIsImRpc3BhdGNoIiwibG9nZ2VyIiwibG9nIiwiTW9kYWwiLCJjcmVhdGVUcmFja2VkRGlhbG9nIiwiRmVlZGJhY2tEaWFsb2ciLCJjbGkiLCJNYXRyaXhDbGllbnRQZWciLCJnZXQiLCJpc0NyeXB0b0VuYWJsZWQiLCJleHBvcnRSb29tS2V5cyIsImxlbmd0aCIsImRpcyIsIkxvZ291dERpYWxvZyIsIkVkaXRDb21tdW5pdHlQcm90b3R5cGVEaWFsb2ciLCJjb21tdW5pdHlJZCIsIkNvbW11bml0eVByb3RvdHlwZVN0b3JlIiwiZ2V0U2VsZWN0ZWRDb21tdW5pdHlJZCIsImNoYXQiLCJnZXRTZWxlY3RlZENvbW11bml0eUdlbmVyYWxDaGF0IiwiVmlld1Jvb20iLCJyb29tX2lkIiwiU2V0UmlnaHRQYW5lbFBoYXNlIiwicGhhc2UiLCJSaWdodFBhbmVsUGhhc2VzIiwiUm9vbU1lbWJlckxpc3QiLCJFcnJvckRpYWxvZyIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJnZXRWYWx1ZSIsInByb3RvdHlwZUNvbW11bml0eU5hbWUiLCJnZXRTZWxlY3RlZENvbW11bml0eU5hbWUiLCJ0b3BTZWN0aW9uIiwiaG9zdFNpZ251cENvbmZpZyIsIlNka0NvbmZpZyIsImhvc3RTaWdudXAiLCJpc0d1ZXN0IiwiYSIsInN1YiIsIm9uU2lnbkluQ2xpY2siLCJvblJlZ2lzdGVyQ2xpY2siLCJ1cmwiLCJob3N0U2lnbnVwRG9tYWlucyIsImRvbWFpbnMiLCJteERvbWFpbiIsImdldERvbWFpbiIsInZhbGlkRG9tYWlucyIsImZpbHRlciIsImQiLCJlbmRzV2l0aCIsIm9uQ2xvc2VNZW51IiwiaG9tZUJ1dHRvbiIsImhhc0hvbWVQYWdlIiwib25Ib21lQ2xpY2siLCJmZWVkYmFja0J1dHRvbiIsIlVJRmVhdHVyZSIsIkZlZWRiYWNrIiwib25Qcm92aWRlRmVlZGJhY2siLCJwcmltYXJ5SGVhZGVyIiwiT3duUHJvZmlsZVN0b3JlIiwiZGlzcGxheU5hbWUiLCJnZXRVc2VySWQiLCJwcmltYXJ5T3B0aW9uTGlzdCIsImUiLCJvblNldHRpbmdzT3BlbiIsIlVzZXJUYWIiLCJOb3RpZmljYXRpb25zIiwiU2VjdXJpdHkiLCJvblNpZ25PdXRDbGljayIsInNlY29uZGFyeVNlY3Rpb24iLCJzZXR0aW5nc09wdGlvbiIsImludml0ZU9wdGlvbiIsImNhbkludml0ZVRvIiwib25Db21tdW5pdHlJbnZpdGVDbGljayIsImlzQWRtaW5PZiIsIm9uQ29tbXVuaXR5U2V0dGluZ3NDbGljayIsIm9uQ29tbXVuaXR5TWVtYmVyc0NsaWNrIiwiY2xhc3NlcyIsIm9uU3dpdGNoVGhlbWVDbGljayIsInJlcXVpcmUiLCJwZW5kaW5nUm9vbUpvaW4iLCJTZXQiLCJvbiIsIlVQREFURV9FVkVOVCIsIm9uUHJvZmlsZVVwZGF0ZSIsInNwYWNlc0VuYWJsZWQiLCJVUERBVEVfU0VMRUNURURfU1BBQ0UiLCJvblNlbGVjdGVkU3BhY2VVcGRhdGUiLCJkbmRXYXRjaGVyUmVmIiwid2F0Y2hTZXR0aW5nIiwiY29tcG9uZW50RGlkTW91bnQiLCJkaXNwYXRjaGVyUmVmIiwicmVnaXN0ZXIiLCJvbkFjdGlvbiIsInRoZW1lV2F0Y2hlclJlZiIsIm9uVGhlbWVDaGFuZ2VkIiwidGFnU3RvcmVSZWYiLCJHcm91cEZpbHRlck9yZGVyU3RvcmUiLCJhZGRMaXN0ZW5lciIsIm9uVGFnU3RvcmVVcGRhdGUiLCJvblJvb20iLCJjb21wb25lbnRXaWxsVW5tb3VudCIsInVud2F0Y2hTZXR0aW5nIiwidW5yZWdpc3RlciIsIm9mZiIsInJlbW92ZSIsInJlbW92ZUxpc3RlbmVyIiwid2luZG93IiwibWF0Y2hNZWRpYSIsIm1hdGNoZXMiLCJ0aGVtZSIsInN0YXJ0c1dpdGgiLCJzdWJzdHJpbmciLCJpc19kYXJrIiwiYWRkIiwiZGVsZXRlIiwicmVuZGVyIiwiYXZhdGFyU2l6ZSIsInVzZXJJZCIsImF2YXRhclVybCIsImdldEh0dHBBdmF0YXJVcmwiLCJpc1Byb3RvdHlwZSIsIm1lbnVOYW1lIiwibmFtZSIsImJ1dHRvbnMiLCJkbmQiLCJyb29tTmFtZSIsImlzRG5kIiwib25EbmRUb2dnbGUiLCJpc01pbmltaXplZCIsIm9uT3Blbk1lbnVDbGljayIsIm9uQ29udGV4dE1lbnUiLCJzaXplIiwiY291bnQiLCJyZW5kZXJDb250ZXh0TWVudSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFnQkE7O0FBRUE7O0FB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QUFBLEdBQUcsRUFBRTJELFNBSFQ7QUFJSSxNQUFBLEtBQUssRUFBRUYsVUFKWDtBQUtJLE1BQUEsTUFBTSxFQUFFQSxVQUxaO0FBTUksTUFBQSxZQUFZLEVBQUMsTUFOakI7QUFPSSxNQUFBLFNBQVMsRUFBQztBQVBkLE1BREosQ0FESixFQVlNTSxJQVpOLEVBYU0sS0FBS3pKLEtBQUwsQ0FBVzhHLGVBQVgsQ0FBMkJvRCxJQUEzQixHQUFrQyxDQUFsQyxpQkFDRSw2QkFBQyxzQkFBRCxxQkFDSSw2QkFBQyxzQkFBRDtBQUFlLE1BQUEsUUFBUSxFQUFFLHlCQUNyQixtQ0FEcUIsRUFFckI7QUFBRUMsUUFBQUEsS0FBSyxFQUFFLEtBQUtuSyxLQUFMLENBQVc4RyxlQUFYLENBQTJCb0Q7QUFBcEMsT0FGcUI7QUFBekIsTUFESixDQWRSLEVBcUJNUCxHQXJCTixFQXNCTUQsT0F0Qk4sQ0FSSixDQURKLEVBa0NNLEtBQUtVLGlCQUFMLEVBbENOLENBREo7QUFzQ0g7O0FBeG1CaUUsQyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG5Db3B5cmlnaHQgMjAyMCwgMjAyMSBUaGUgTWF0cml4Lm9yZyBGb3VuZGF0aW9uIEMuSS5DLlxuXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xueW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG5cbiAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcblxuVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG5TZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG5saW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiovXG5cbmltcG9ydCBSZWFjdCwgeyBjcmVhdGVSZWYgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IFJvb20gfSBmcm9tIFwibWF0cml4LWpzLXNkay9zcmMvbW9kZWxzL3Jvb21cIjtcbmltcG9ydCBjbGFzc05hbWVzIGZyb20gXCJjbGFzc25hbWVzXCI7XG5pbXBvcnQgKiBhcyBmYkVtaXR0ZXIgZnJvbSBcImZiZW1pdHRlclwiO1xuXG5pbXBvcnQgeyBNYXRyaXhDbGllbnRQZWcgfSBmcm9tIFwiLi4vLi4vTWF0cml4Q2xpZW50UGVnXCI7XG5pbXBvcnQgZGVmYXVsdERpc3BhdGNoZXIgZnJvbSBcIi4uLy4uL2Rpc3BhdGNoZXIvZGlzcGF0Y2hlclwiO1xuaW1wb3J0IGRpcyBmcm9tIFwiLi4vLi4vZGlzcGF0Y2hlci9kaXNwYXRjaGVyXCI7XG5pbXBvcnQgeyBBY3Rpb25QYXlsb2FkIH0gZnJvbSBcIi4uLy4uL2Rpc3BhdGNoZXIvcGF5bG9hZHNcIjtcbmltcG9ydCB7IEFjdGlvbiB9IGZyb20gXCIuLi8uLi9kaXNwYXRjaGVyL2FjdGlvbnNcIjtcbmltcG9ydCB7IF90IH0gZnJvbSBcIi4uLy4uL2xhbmd1YWdlSGFuZGxlclwiO1xuaW1wb3J0IHsgQ29udGV4dE1lbnVCdXR0b24gfSBmcm9tIFwiLi9Db250ZXh0TWVudVwiO1xuaW1wb3J0IHsgVXNlclRhYiB9IGZyb20gXCIuLi92aWV3cy9kaWFsb2dzL1VzZXJTZXR0aW5nc0RpYWxvZ1wiO1xuaW1wb3J0IHsgT3BlblRvVGFiUGF5bG9hZCB9IGZyb20gXCIuLi8uLi9kaXNwYXRjaGVyL3BheWxvYWRzL09wZW5Ub1RhYlBheWxvYWRcIjtcbmltcG9ydCBGZWVkYmFja0RpYWxvZyBmcm9tIFwiLi4vdmlld3MvZGlhbG9ncy9GZWVkYmFja0RpYWxvZ1wiO1xuaW1wb3J0IE1vZGFsIGZyb20gXCIuLi8uLi9Nb2RhbFwiO1xuaW1wb3J0IExvZ291dERpYWxvZyBmcm9tIFwiLi4vdmlld3MvZGlhbG9ncy9Mb2dvdXREaWFsb2dcIjtcbmltcG9ydCBTZXR0aW5nc1N0b3JlIGZyb20gXCIuLi8uLi9zZXR0aW5ncy9TZXR0aW5nc1N0b3JlXCI7XG5pbXBvcnQgeyBmaW5kSGlnaENvbnRyYXN0VGhlbWUsIGdldEN1c3RvbVRoZW1lLCBpc0hpZ2hDb250cmFzdFRoZW1lIH0gZnJvbSBcIi4uLy4uL3RoZW1lXCI7XG5pbXBvcnQgQWNjZXNzaWJsZUJ1dHRvbiwgeyBCdXR0b25FdmVudCB9IGZyb20gXCIuLi92aWV3cy9lbGVtZW50cy9BY2Nlc3NpYmxlQnV0dG9uXCI7XG5pbXBvcnQgU2RrQ29uZmlnIGZyb20gXCIuLi8uLi9TZGtDb25maWdcIjtcbmltcG9ydCB7IGdldEhvbWVQYWdlVXJsIH0gZnJvbSBcIi4uLy4uL3V0aWxzL3BhZ2VzXCI7XG5pbXBvcnQgeyBPd25Qcm9maWxlU3RvcmUgfSBmcm9tIFwiLi4vLi4vc3RvcmVzL093blByb2ZpbGVTdG9yZVwiO1xuaW1wb3J0IHsgVVBEQVRFX0VWRU5UIH0gZnJvbSBcIi4uLy4uL3N0b3Jlcy9Bc3luY1N0b3JlXCI7XG5pbXBvcnQgQmFzZUF2YXRhciBmcm9tICcuLi92aWV3cy9hdmF0YXJzL0Jhc2VBdmF0YXInO1xuaW1wb3J0IEFjY2Vzc2libGVUb29sdGlwQnV0dG9uIGZyb20gXCIuLi92aWV3cy9lbGVtZW50cy9BY2Nlc3NpYmxlVG9vbHRpcEJ1dHRvblwiO1xuaW1wb3J0IHsgU2V0dGluZ0xldmVsIH0gZnJvbSBcIi4uLy4uL3NldHRpbmdzL1NldHRpbmdMZXZlbFwiO1xuaW1wb3J0IEljb25pemVkQ29udGV4dE1lbnUsIHtcbiAgICBJY29uaXplZENvbnRleHRNZW51T3B0aW9uLFxuICAgIEljb25pemVkQ29udGV4dE1lbnVPcHRpb25MaXN0LFxufSBmcm9tIFwiLi4vdmlld3MvY29udGV4dF9tZW51cy9JY29uaXplZENvbnRleHRNZW51XCI7XG5pbXBvcnQgeyBDb21tdW5pdHlQcm90b3R5cGVTdG9yZSB9IGZyb20gXCIuLi8uLi9zdG9yZXMvQ29tbXVuaXR5UHJvdG90eXBlU3RvcmVcIjtcbmltcG9ydCBHcm91cEZpbHRlck9yZGVyU3RvcmUgZnJvbSBcIi4uLy4uL3N0b3Jlcy9Hcm91cEZpbHRlck9yZGVyU3RvcmVcIjtcbmltcG9ydCB7IHNob3dDb21tdW5pdHlJbnZpdGVEaWFsb2cgfSBmcm9tIFwiLi4vLi4vUm9vbUludml0ZVwiO1xuaW1wb3J0IHsgUmlnaHRQYW5lbFBoYXNlcyB9IGZyb20gXCIuLi8uLi9zdG9yZXMvUmlnaHRQYW5lbFN0b3JlUGhhc2VzXCI7XG5pbXBvcnQgRXJyb3JEaWFsb2cgZnJvbSBcIi4uL3ZpZXdzL2RpYWxvZ3MvRXJyb3JEaWFsb2dcIjtcbmltcG9ydCBFZGl0Q29tbXVuaXR5UHJvdG90eXBlRGlhbG9nIGZyb20gXCIuLi92aWV3cy9kaWFsb2dzL0VkaXRDb21tdW5pdHlQcm90b3R5cGVEaWFsb2dcIjtcbmltcG9ydCB7IFVJRmVhdHVyZSB9IGZyb20gXCIuLi8uLi9zZXR0aW5ncy9VSUZlYXR1cmVcIjtcbmltcG9ydCBIb3N0U2lnbnVwQWN0aW9uIGZyb20gXCIuL0hvc3RTaWdudXBBY3Rpb25cIjtcbmltcG9ydCB7IElIb3N0U2lnbnVwQ29uZmlnIH0gZnJvbSBcIi4uL3ZpZXdzL2RpYWxvZ3MvSG9zdFNpZ251cERpYWxvZ1R5cGVzXCI7XG5pbXBvcnQgU3BhY2VTdG9yZSBmcm9tIFwiLi4vLi4vc3RvcmVzL3NwYWNlcy9TcGFjZVN0b3JlXCI7XG5pbXBvcnQgeyBVUERBVEVfU0VMRUNURURfU1BBQ0UgfSBmcm9tIFwiLi4vLi4vc3RvcmVzL3NwYWNlc1wiO1xuaW1wb3J0IFJvb21OYW1lIGZyb20gXCIuLi92aWV3cy9lbGVtZW50cy9Sb29tTmFtZVwiO1xuaW1wb3J0IHsgcmVwbGFjZWFibGVDb21wb25lbnQgfSBmcm9tIFwiLi4vLi4vdXRpbHMvcmVwbGFjZWFibGVDb21wb25lbnRcIjtcbmltcG9ydCBJbmxpbmVTcGlubmVyIGZyb20gXCIuLi92aWV3cy9lbGVtZW50cy9JbmxpbmVTcGlubmVyXCI7XG5pbXBvcnQgVG9vbHRpcEJ1dHRvbiBmcm9tIFwiLi4vdmlld3MvZWxlbWVudHMvVG9vbHRpcEJ1dHRvblwiO1xuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSBcIm1hdHJpeC1qcy1zZGsvc3JjL2xvZ2dlclwiO1xuaW50ZXJmYWNlIElQcm9wcyB7XG4gICAgaXNNaW5pbWl6ZWQ6IGJvb2xlYW47XG59XG5cbnR5cGUgUGFydGlhbERPTVJlY3QgPSBQaWNrPERPTVJlY3QsIFwid2lkdGhcIiB8IFwibGVmdFwiIHwgXCJ0b3BcIiB8IFwiaGVpZ2h0XCI+O1xuXG5pbnRlcmZhY2UgSVN0YXRlIHtcbiAgICBjb250ZXh0TWVudVBvc2l0aW9uOiBQYXJ0aWFsRE9NUmVjdDtcbiAgICBpc0RhcmtUaGVtZTogYm9vbGVhbjtcbiAgICBpc0hpZ2hDb250cmFzdDogYm9vbGVhbjtcbiAgICBzZWxlY3RlZFNwYWNlPzogUm9vbTtcbiAgICBwZW5kaW5nUm9vbUpvaW46IFNldDxzdHJpbmc+O1xufVxuXG5AcmVwbGFjZWFibGVDb21wb25lbnQoXCJzdHJ1Y3R1cmVzLlVzZXJNZW51XCIpXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VyTWVudSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxJUHJvcHMsIElTdGF0ZT4ge1xuICAgIHByaXZhdGUgZGlzcGF0Y2hlclJlZjogc3RyaW5nO1xuICAgIHByaXZhdGUgdGhlbWVXYXRjaGVyUmVmOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBkbmRXYXRjaGVyUmVmOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBidXR0b25SZWY6IFJlYWN0LlJlZk9iamVjdDxIVE1MQnV0dG9uRWxlbWVudD4gPSBjcmVhdGVSZWYoKTtcbiAgICBwcml2YXRlIHRhZ1N0b3JlUmVmOiBmYkVtaXR0ZXIuRXZlbnRTdWJzY3JpcHRpb247XG5cbiAgICBjb25zdHJ1Y3Rvcihwcm9wczogSVByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcblxuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgY29udGV4dE1lbnVQb3NpdGlvbjogbnVsbCxcbiAgICAgICAgICAgIGlzRGFya1RoZW1lOiB0aGlzLmlzVXNlck9uRGFya1RoZW1lKCksXG4gICAgICAgICAgICBpc0hpZ2hDb250cmFzdDogdGhpcy5pc1VzZXJPbkhpZ2hDb250cmFzdFRoZW1lKCksXG4gICAgICAgICAgICBwZW5kaW5nUm9vbUpvaW46IG5ldyBTZXQ8c3RyaW5nPigpLFxuICAgICAgICAgICAgc2VsZWN0ZWRTcGFjZTogU3BhY2VTdG9yZS5pbnN0YW5jZS5hY3RpdmVTcGFjZVJvb20sXG4gICAgICAgIH07XG5cbiAgICAgICAgT3duUHJvZmlsZVN0b3JlLmluc3RhbmNlLm9uKFVQREFURV9FVkVOVCwgdGhpcy5vblByb2ZpbGVVcGRhdGUpO1xuICAgICAgICBpZiAoU3BhY2VTdG9yZS5zcGFjZXNFbmFibGVkKSB7XG4gICAgICAgICAgICBTcGFjZVN0b3JlLmluc3RhbmNlLm9uKFVQREFURV9TRUxFQ1RFRF9TUEFDRSwgdGhpcy5vblNlbGVjdGVkU3BhY2VVcGRhdGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRm9yY2UgdXBkYXRlIGlzIHRoZSBlYXNpZXN0IHdheSB0byB0cmlnZ2VyIHRoZSBVSSB1cGRhdGUgKHdlIGRvbid0IHN0b3JlIHN0YXRlIGZvciB0aGlzKVxuICAgICAgICB0aGlzLmRuZFdhdGNoZXJSZWYgPSBTZXR0aW5nc1N0b3JlLndhdGNoU2V0dGluZyhcImRvTm90RGlzdHVyYlwiLCBudWxsLCAoKSA9PiB0aGlzLmZvcmNlVXBkYXRlKCkpO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0IGhhc0hvbWVQYWdlKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gISFnZXRIb21lUGFnZVVybChTZGtDb25maWcuZ2V0KCkpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgICAgdGhpcy5kaXNwYXRjaGVyUmVmID0gZGVmYXVsdERpc3BhdGNoZXIucmVnaXN0ZXIodGhpcy5vbkFjdGlvbik7XG4gICAgICAgIHRoaXMudGhlbWVXYXRjaGVyUmVmID0gU2V0dGluZ3NTdG9yZS53YXRjaFNldHRpbmcoXCJ0aGVtZVwiLCBudWxsLCB0aGlzLm9uVGhlbWVDaGFuZ2VkKTtcbiAgICAgICAgdGhpcy50YWdTdG9yZVJlZiA9IEdyb3VwRmlsdGVyT3JkZXJTdG9yZS5hZGRMaXN0ZW5lcih0aGlzLm9uVGFnU3RvcmVVcGRhdGUpO1xuICAgICAgICBNYXRyaXhDbGllbnRQZWcuZ2V0KCkub24oXCJSb29tXCIsIHRoaXMub25Sb29tKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgICAgIGlmICh0aGlzLnRoZW1lV2F0Y2hlclJlZikgU2V0dGluZ3NTdG9yZS51bndhdGNoU2V0dGluZyh0aGlzLnRoZW1lV2F0Y2hlclJlZik7XG4gICAgICAgIGlmICh0aGlzLmRuZFdhdGNoZXJSZWYpIFNldHRpbmdzU3RvcmUudW53YXRjaFNldHRpbmcodGhpcy5kbmRXYXRjaGVyUmVmKTtcbiAgICAgICAgaWYgKHRoaXMuZGlzcGF0Y2hlclJlZikgZGVmYXVsdERpc3BhdGNoZXIudW5yZWdpc3Rlcih0aGlzLmRpc3BhdGNoZXJSZWYpO1xuICAgICAgICBPd25Qcm9maWxlU3RvcmUuaW5zdGFuY2Uub2ZmKFVQREFURV9FVkVOVCwgdGhpcy5vblByb2ZpbGVVcGRhdGUpO1xuICAgICAgICB0aGlzLnRhZ1N0b3JlUmVmLnJlbW92ZSgpO1xuICAgICAgICBpZiAoU3BhY2VTdG9yZS5zcGFjZXNFbmFibGVkKSB7XG4gICAgICAgICAgICBTcGFjZVN0b3JlLmluc3RhbmNlLm9mZihVUERBVEVfU0VMRUNURURfU1BBQ0UsIHRoaXMub25TZWxlY3RlZFNwYWNlVXBkYXRlKTtcbiAgICAgICAgfVxuICAgICAgICBNYXRyaXhDbGllbnRQZWcuZ2V0KCkucmVtb3ZlTGlzdGVuZXIoXCJSb29tXCIsIHRoaXMub25Sb29tKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIG9uUm9vbSA9IChyb29tOiBSb29tKTogdm9pZCA9PiB7XG4gICAgICAgIHRoaXMucmVtb3ZlUGVuZGluZ0pvaW5Sb29tKHJvb20ucm9vbUlkKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvblRhZ1N0b3JlVXBkYXRlID0gKCkgPT4ge1xuICAgICAgICB0aGlzLmZvcmNlVXBkYXRlKCk7IC8vIHdlIGRvbid0IGhhdmUgYW55dGhpbmcgdXNlZnVsIGluIHN0YXRlIHRvIHVwZGF0ZVxuICAgIH07XG5cbiAgICBwcml2YXRlIGlzVXNlck9uRGFya1RoZW1lKCk6IGJvb2xlYW4ge1xuICAgICAgICBpZiAoU2V0dGluZ3NTdG9yZS5nZXRWYWx1ZShcInVzZV9zeXN0ZW1fdGhlbWVcIikpIHtcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cubWF0Y2hNZWRpYShcIihwcmVmZXJzLWNvbG9yLXNjaGVtZTogZGFyaylcIikubWF0Y2hlcztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHRoZW1lID0gU2V0dGluZ3NTdG9yZS5nZXRWYWx1ZShcInRoZW1lXCIpO1xuICAgICAgICAgICAgaWYgKHRoZW1lLnN0YXJ0c1dpdGgoXCJjdXN0b20tXCIpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldEN1c3RvbVRoZW1lKHRoZW1lLnN1YnN0cmluZyhcImN1c3RvbS1cIi5sZW5ndGgpKS5pc19kYXJrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoZW1lID09PSBcImRhcmtcIjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgaXNVc2VyT25IaWdoQ29udHJhc3RUaGVtZSgpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKFNldHRpbmdzU3RvcmUuZ2V0VmFsdWUoXCJ1c2Vfc3lzdGVtX3RoZW1lXCIpKSB7XG4gICAgICAgICAgICByZXR1cm4gd2luZG93Lm1hdGNoTWVkaWEoXCIocHJlZmVycy1jb250cmFzdDogbW9yZSlcIikubWF0Y2hlcztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHRoZW1lID0gU2V0dGluZ3NTdG9yZS5nZXRWYWx1ZShcInRoZW1lXCIpO1xuICAgICAgICAgICAgaWYgKHRoZW1lLnN0YXJ0c1dpdGgoXCJjdXN0b20tXCIpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGlzSGlnaENvbnRyYXN0VGhlbWUodGhlbWUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvblByb2ZpbGVVcGRhdGUgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgIC8vIHRoZSBzdG9yZSB0cmlnZ2VyZWQgYW4gdXBkYXRlLCBzbyBmb3JjZSBhIGxheW91dCB1cGRhdGUuIFdlIGRvbid0XG4gICAgICAgIC8vIGhhdmUgYW55IHN0YXRlIHRvIHN0b3JlIGhlcmUgZm9yIHRoYXQgdG8gbWFnaWNhbGx5IGhhcHBlbi5cbiAgICAgICAgdGhpcy5mb3JjZVVwZGF0ZSgpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uU2VsZWN0ZWRTcGFjZVVwZGF0ZSA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBzZWxlY3RlZFNwYWNlOiBTcGFjZVN0b3JlLmluc3RhbmNlLmFjdGl2ZVNwYWNlUm9vbSxcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25UaGVtZUNoYW5nZWQgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaXNEYXJrVGhlbWU6IHRoaXMuaXNVc2VyT25EYXJrVGhlbWUoKSxcbiAgICAgICAgICAgICAgICBpc0hpZ2hDb250cmFzdDogdGhpcy5pc1VzZXJPbkhpZ2hDb250cmFzdFRoZW1lKCksXG4gICAgICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkFjdGlvbiA9IChldjogQWN0aW9uUGF5bG9hZCkgPT4ge1xuICAgICAgICBzd2l0Y2ggKGV2LmFjdGlvbikge1xuICAgICAgICAgICAgY2FzZSBBY3Rpb24uVG9nZ2xlVXNlck1lbnU6XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhdGUuY29udGV4dE1lbnVQb3NpdGlvbikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgY29udGV4dE1lbnVQb3NpdGlvbjogbnVsbCB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5idXR0b25SZWYuY3VycmVudCkgdGhpcy5idXR0b25SZWYuY3VycmVudC5jbGljaygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgQWN0aW9uLkpvaW5Sb29tOlxuICAgICAgICAgICAgICAgIHRoaXMuYWRkUGVuZGluZ0pvaW5Sb29tKGV2LnJvb21JZCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIEFjdGlvbi5Kb2luUm9vbVJlYWR5OlxuICAgICAgICAgICAgY2FzZSBBY3Rpb24uSm9pblJvb21FcnJvcjpcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVBlbmRpbmdKb2luUm9vbShldi5yb29tSWQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHByaXZhdGUgYWRkUGVuZGluZ0pvaW5Sb29tKHJvb21JZDogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgcGVuZGluZ1Jvb21Kb2luOiBuZXcgU2V0PHN0cmluZz4odGhpcy5zdGF0ZS5wZW5kaW5nUm9vbUpvaW4pXG4gICAgICAgICAgICAgICAgLmFkZChyb29tSWQpLFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlbW92ZVBlbmRpbmdKb2luUm9vbShyb29tSWQ6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5wZW5kaW5nUm9vbUpvaW4uZGVsZXRlKHJvb21JZCkpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgIHBlbmRpbmdSb29tSm9pbjogbmV3IFNldDxzdHJpbmc+KHRoaXMuc3RhdGUucGVuZGluZ1Jvb21Kb2luKSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvbk9wZW5NZW51Q2xpY2sgPSAoZXY6IFJlYWN0Lk1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGNvbnN0IHRhcmdldCA9IGV2LnRhcmdldCBhcyBIVE1MQnV0dG9uRWxlbWVudDtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGNvbnRleHRNZW51UG9zaXRpb246IHRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkNvbnRleHRNZW51ID0gKGV2OiBSZWFjdC5Nb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGNvbnRleHRNZW51UG9zaXRpb246IHtcbiAgICAgICAgICAgICAgICBsZWZ0OiBldi5jbGllbnRYLFxuICAgICAgICAgICAgICAgIHRvcDogZXYuY2xpZW50WSxcbiAgICAgICAgICAgICAgICB3aWR0aDogMjAsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiAwLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25DbG9zZU1lbnUgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBjb250ZXh0TWVudVBvc2l0aW9uOiBudWxsIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uU3dpdGNoVGhlbWVDbGljayA9IChldjogUmVhY3QuTW91c2VFdmVudCkgPT4ge1xuICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgICAvLyBEaXNhYmxlIHN5c3RlbSB0aGVtZSBtYXRjaGluZyBpZiB0aGUgdXNlciBoaXRzIHRoaXMgYnV0dG9uXG4gICAgICAgIFNldHRpbmdzU3RvcmUuc2V0VmFsdWUoXCJ1c2Vfc3lzdGVtX3RoZW1lXCIsIG51bGwsIFNldHRpbmdMZXZlbC5ERVZJQ0UsIGZhbHNlKTtcblxuICAgICAgICBsZXQgbmV3VGhlbWUgPSB0aGlzLnN0YXRlLmlzRGFya1RoZW1lID8gXCJsaWdodFwiIDogXCJkYXJrXCI7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmlzSGlnaENvbnRyYXN0KSB7XG4gICAgICAgICAgICBjb25zdCBoY1RoZW1lID0gZmluZEhpZ2hDb250cmFzdFRoZW1lKG5ld1RoZW1lKTtcbiAgICAgICAgICAgIGlmIChoY1RoZW1lKSB7XG4gICAgICAgICAgICAgICAgbmV3VGhlbWUgPSBoY1RoZW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFNldHRpbmdzU3RvcmUuc2V0VmFsdWUoXCJ0aGVtZVwiLCBudWxsLCBTZXR0aW5nTGV2ZWwuREVWSUNFLCBuZXdUaGVtZSk7IC8vIHNldCBhdCBzYW1lIGxldmVsIGFzIEFwcGVhcmFuY2UgdGFiXG4gICAgfTtcblxuICAgIHByaXZhdGUgb25TZXR0aW5nc09wZW4gPSAoZXY6IEJ1dHRvbkV2ZW50LCB0YWJJZDogc3RyaW5nKSA9PiB7XG4gICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgIGNvbnN0IHBheWxvYWQ6IE9wZW5Ub1RhYlBheWxvYWQgPSB7IGFjdGlvbjogQWN0aW9uLlZpZXdVc2VyU2V0dGluZ3MsIGluaXRpYWxUYWJJZDogdGFiSWQgfTtcbiAgICAgICAgZGVmYXVsdERpc3BhdGNoZXIuZGlzcGF0Y2gocGF5bG9hZCk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBjb250ZXh0TWVudVBvc2l0aW9uOiBudWxsIH0pOyAvLyBhbHNvIGNsb3NlIHRoZSBtZW51XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25TaG93QXJjaGl2ZWQgPSAoZXY6IEJ1dHRvbkV2ZW50KSA9PiB7XG4gICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgIC8vIFRPRE86IEFyY2hpdmVkIHJvb20gdmlldzogaHR0cHM6Ly9naXRodWIuY29tL3ZlY3Rvci1pbS9lbGVtZW50LXdlYi9pc3N1ZXMvMTQwMzhcbiAgICAgICAgLy8gTm90ZTogWW91J2xsIG5lZWQgdG8gdW5jb21tZW50IHRoZSBidXR0b24gdG9vLlxuICAgICAgICBsb2dnZXIubG9nKFwiVE9ETzogU2hvdyBhcmNoaXZlZCByb29tc1wiKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvblByb3ZpZGVGZWVkYmFjayA9IChldjogQnV0dG9uRXZlbnQpID0+IHtcbiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgTW9kYWwuY3JlYXRlVHJhY2tlZERpYWxvZygnRmVlZGJhY2sgRGlhbG9nJywgJycsIEZlZWRiYWNrRGlhbG9nKTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGNvbnRleHRNZW51UG9zaXRpb246IG51bGwgfSk7IC8vIGFsc28gY2xvc2UgdGhlIG1lbnVcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvblNpZ25PdXRDbGljayA9IGFzeW5jIChldjogQnV0dG9uRXZlbnQpID0+IHtcbiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgY29uc3QgY2xpID0gTWF0cml4Q2xpZW50UGVnLmdldCgpO1xuICAgICAgICBpZiAoIWNsaSB8fCAhY2xpLmlzQ3J5cHRvRW5hYmxlZCgpIHx8ICEoYXdhaXQgY2xpLmV4cG9ydFJvb21LZXlzKCkpPy5sZW5ndGgpIHtcbiAgICAgICAgICAgIC8vIGxvZyBvdXQgd2l0aG91dCB1c2VyIHByb21wdCBpZiB0aGV5IGhhdmUgbm8gbG9jYWwgbWVnb2xtIHNlc3Npb25zXG4gICAgICAgICAgICBkaXMuZGlzcGF0Y2goeyBhY3Rpb246ICdsb2dvdXQnIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgTW9kYWwuY3JlYXRlVHJhY2tlZERpYWxvZygnTG9nb3V0IGZyb20gTGVmdFBhbmVsJywgJycsIExvZ291dERpYWxvZyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNldFN0YXRlKHsgY29udGV4dE1lbnVQb3NpdGlvbjogbnVsbCB9KTsgLy8gYWxzbyBjbG9zZSB0aGUgbWVudVxuICAgIH07XG5cbiAgICBwcml2YXRlIG9uU2lnbkluQ2xpY2sgPSAoKSA9PiB7XG4gICAgICAgIGRpcy5kaXNwYXRjaCh7IGFjdGlvbjogJ3N0YXJ0X2xvZ2luJyB9KTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGNvbnRleHRNZW51UG9zaXRpb246IG51bGwgfSk7IC8vIGFsc28gY2xvc2UgdGhlIG1lbnVcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvblJlZ2lzdGVyQ2xpY2sgPSAoKSA9PiB7XG4gICAgICAgIGRpcy5kaXNwYXRjaCh7IGFjdGlvbjogJ3N0YXJ0X3JlZ2lzdHJhdGlvbicgfSk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBjb250ZXh0TWVudVBvc2l0aW9uOiBudWxsIH0pOyAvLyBhbHNvIGNsb3NlIHRoZSBtZW51XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25Ib21lQ2xpY2sgPSAoZXY6IEJ1dHRvbkV2ZW50KSA9PiB7XG4gICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgIGRlZmF1bHREaXNwYXRjaGVyLmRpc3BhdGNoKHsgYWN0aW9uOiAndmlld19ob21lX3BhZ2UnIH0pO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgY29udGV4dE1lbnVQb3NpdGlvbjogbnVsbCB9KTsgLy8gYWxzbyBjbG9zZSB0aGUgbWVudVxuICAgIH07XG5cbiAgICBwcml2YXRlIG9uQ29tbXVuaXR5U2V0dGluZ3NDbGljayA9IChldjogQnV0dG9uRXZlbnQpID0+IHtcbiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgTW9kYWwuY3JlYXRlVHJhY2tlZERpYWxvZygnRWRpdCBDb21tdW5pdHknLCAnJywgRWRpdENvbW11bml0eVByb3RvdHlwZURpYWxvZywge1xuICAgICAgICAgICAgY29tbXVuaXR5SWQ6IENvbW11bml0eVByb3RvdHlwZVN0b3JlLmluc3RhbmNlLmdldFNlbGVjdGVkQ29tbXVuaXR5SWQoKSxcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBjb250ZXh0TWVudVBvc2l0aW9uOiBudWxsIH0pOyAvLyBhbHNvIGNsb3NlIHRoZSBtZW51XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25Db21tdW5pdHlNZW1iZXJzQ2xpY2sgPSAoZXY6IEJ1dHRvbkV2ZW50KSA9PiB7XG4gICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgIC8vIFdlJ2QgaWRlYWxseSBqdXN0IHBvcCBvcGVuIGEgcmlnaHQgcGFuZWwgd2l0aCB0aGUgbWVtYmVyIGxpc3QsIGJ1dCB0aGUgY3VycmVudFxuICAgICAgICAvLyB3YXkgdGhlIHJpZ2h0IHBhbmVsIGlzIHN0cnVjdHVyZWQgbWFrZXMgdGhpcyBleGNlZWRpbmdseSBkaWZmaWN1bHQuIEluc3RlYWQsIHdlJ2xsXG4gICAgICAgIC8vIHN3aXRjaCB0byB0aGUgZ2VuZXJhbCByb29tIGFuZCBvcGVuIHRoZSBtZW1iZXIgbGlzdCB0aGVyZSBhcyBpdCBzaG91bGQgYmUgaW4gc3luY1xuICAgICAgICAvLyBhbnl3YXlzLlxuICAgICAgICBjb25zdCBjaGF0ID0gQ29tbXVuaXR5UHJvdG90eXBlU3RvcmUuaW5zdGFuY2UuZ2V0U2VsZWN0ZWRDb21tdW5pdHlHZW5lcmFsQ2hhdCgpO1xuICAgICAgICBpZiAoY2hhdCkge1xuICAgICAgICAgICAgZGlzLmRpc3BhdGNoKHtcbiAgICAgICAgICAgICAgICBhY3Rpb246IEFjdGlvbi5WaWV3Um9vbSxcbiAgICAgICAgICAgICAgICByb29tX2lkOiBjaGF0LnJvb21JZCxcbiAgICAgICAgICAgIH0sIHRydWUpO1xuICAgICAgICAgICAgZGlzLmRpc3BhdGNoKHsgYWN0aW9uOiBBY3Rpb24uU2V0UmlnaHRQYW5lbFBoYXNlLCBwaGFzZTogUmlnaHRQYW5lbFBoYXNlcy5Sb29tTWVtYmVyTGlzdCB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFwiVGhpcyBzaG91bGQgbmV2ZXIgaGFwcGVuXCIgY2xhdXNlcyBnbyBoZXJlIGZvciB0aGUgcHJvdG90eXBlLlxuICAgICAgICAgICAgTW9kYWwuY3JlYXRlVHJhY2tlZERpYWxvZygnRmFpbGVkIHRvIGZpbmQgZ2VuZXJhbCBjaGF0JywgJycsIEVycm9yRGlhbG9nLCB7XG4gICAgICAgICAgICAgICAgdGl0bGU6IF90KCdGYWlsZWQgdG8gZmluZCB0aGUgZ2VuZXJhbCBjaGF0IGZvciB0aGlzIGNvbW11bml0eScpLFxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBfdChcIkZhaWxlZCB0byBmaW5kIHRoZSBnZW5lcmFsIGNoYXQgZm9yIHRoaXMgY29tbXVuaXR5XCIpLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGNvbnRleHRNZW51UG9zaXRpb246IG51bGwgfSk7IC8vIGFsc28gY2xvc2UgdGhlIG1lbnVcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkNvbW11bml0eUludml0ZUNsaWNrID0gKGV2OiBCdXR0b25FdmVudCkgPT4ge1xuICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgICBzaG93Q29tbXVuaXR5SW52aXRlRGlhbG9nKENvbW11bml0eVByb3RvdHlwZVN0b3JlLmluc3RhbmNlLmdldFNlbGVjdGVkQ29tbXVuaXR5SWQoKSk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBjb250ZXh0TWVudVBvc2l0aW9uOiBudWxsIH0pOyAvLyBhbHNvIGNsb3NlIHRoZSBtZW51XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25EbmRUb2dnbGUgPSAoZXYpID0+IHtcbiAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGNvbnN0IGN1cnJlbnQgPSBTZXR0aW5nc1N0b3JlLmdldFZhbHVlKFwiZG9Ob3REaXN0dXJiXCIpO1xuICAgICAgICBTZXR0aW5nc1N0b3JlLnNldFZhbHVlKFwiZG9Ob3REaXN0dXJiXCIsIG51bGwsIFNldHRpbmdMZXZlbC5ERVZJQ0UsICFjdXJyZW50KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSByZW5kZXJDb250ZXh0TWVudSA9ICgpOiBSZWFjdC5SZWFjdE5vZGUgPT4ge1xuICAgICAgICBpZiAoIXRoaXMuc3RhdGUuY29udGV4dE1lbnVQb3NpdGlvbikgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgY29uc3QgcHJvdG90eXBlQ29tbXVuaXR5TmFtZSA9IENvbW11bml0eVByb3RvdHlwZVN0b3JlLmluc3RhbmNlLmdldFNlbGVjdGVkQ29tbXVuaXR5TmFtZSgpO1xuXG4gICAgICAgIGxldCB0b3BTZWN0aW9uO1xuICAgICAgICBjb25zdCBob3N0U2lnbnVwQ29uZmlnOiBJSG9zdFNpZ251cENvbmZpZyA9IFNka0NvbmZpZy5nZXQoKS5ob3N0U2lnbnVwO1xuICAgICAgICBpZiAoTWF0cml4Q2xpZW50UGVnLmdldCgpLmlzR3Vlc3QoKSkge1xuICAgICAgICAgICAgdG9wU2VjdGlvbiA9IChcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X1VzZXJNZW51X2NvbnRleHRNZW51X2hlYWRlciBteF9Vc2VyTWVudV9jb250ZXh0TWVudV9ndWVzdFByb21wdHNcIj5cbiAgICAgICAgICAgICAgICAgICAgeyBfdChcIkdvdCBhbiBhY2NvdW50PyA8YT5TaWduIGluPC9hPlwiLCB7fSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgYTogc3ViID0+IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QWNjZXNzaWJsZUJ1dHRvbiBraW5kPVwibGlua1wiIG9uQ2xpY2s9e3RoaXMub25TaWduSW5DbGlja30+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgc3ViIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0FjY2Vzc2libGVCdXR0b24+XG4gICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICB9KSB9XG4gICAgICAgICAgICAgICAgICAgIHsgX3QoXCJOZXcgaGVyZT8gPGE+Q3JlYXRlIGFuIGFjY291bnQ8L2E+XCIsIHt9LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhOiBzdWIgPT4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBY2Nlc3NpYmxlQnV0dG9uIGtpbmQ9XCJsaW5rXCIgb25DbGljaz17dGhpcy5vblJlZ2lzdGVyQ2xpY2t9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHN1YiB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9BY2Nlc3NpYmxlQnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgfSkgfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIGlmIChob3N0U2lnbnVwQ29uZmlnKSB7XG4gICAgICAgICAgICBpZiAoaG9zdFNpZ251cENvbmZpZyAmJiBob3N0U2lnbnVwQ29uZmlnLnVybCkge1xuICAgICAgICAgICAgICAgIC8vIElmIGhvc3RTaWdudXAuZG9tYWlucyBpcyBzZXQgdG8gYSBub24tZW1wdHkgYXJyYXksIG9ubHkgc2hvd1xuICAgICAgICAgICAgICAgIC8vIGRpYWxvZyBpZiB0aGUgdXNlciBpcyBvbiB0aGUgZG9tYWluIG9yIGEgc3ViZG9tYWluLlxuICAgICAgICAgICAgICAgIGNvbnN0IGhvc3RTaWdudXBEb21haW5zID0gaG9zdFNpZ251cENvbmZpZy5kb21haW5zIHx8IFtdO1xuICAgICAgICAgICAgICAgIGNvbnN0IG14RG9tYWluID0gTWF0cml4Q2xpZW50UGVnLmdldCgpLmdldERvbWFpbigpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHZhbGlkRG9tYWlucyA9IGhvc3RTaWdudXBEb21haW5zLmZpbHRlcihkID0+IChkID09PSBteERvbWFpbiB8fCBteERvbWFpbi5lbmRzV2l0aChgLiR7ZH1gKSkpO1xuICAgICAgICAgICAgICAgIGlmICghaG9zdFNpZ251cENvbmZpZy5kb21haW5zIHx8IHZhbGlkRG9tYWlucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvcFNlY3Rpb24gPSA8SG9zdFNpZ251cEFjdGlvbiBvbkNsaWNrPXt0aGlzLm9uQ2xvc2VNZW51fSAvPjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgaG9tZUJ1dHRvbiA9IG51bGw7XG4gICAgICAgIGlmICh0aGlzLmhhc0hvbWVQYWdlKSB7XG4gICAgICAgICAgICBob21lQnV0dG9uID0gKFxuICAgICAgICAgICAgICAgIDxJY29uaXplZENvbnRleHRNZW51T3B0aW9uXG4gICAgICAgICAgICAgICAgICAgIGljb25DbGFzc05hbWU9XCJteF9Vc2VyTWVudV9pY29uSG9tZVwiXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsPXtfdChcIkhvbWVcIil9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMub25Ib21lQ2xpY2t9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgZmVlZGJhY2tCdXR0b247XG4gICAgICAgIGlmIChTZXR0aW5nc1N0b3JlLmdldFZhbHVlKFVJRmVhdHVyZS5GZWVkYmFjaykpIHtcbiAgICAgICAgICAgIGZlZWRiYWNrQnV0dG9uID0gPEljb25pemVkQ29udGV4dE1lbnVPcHRpb25cbiAgICAgICAgICAgICAgICBpY29uQ2xhc3NOYW1lPVwibXhfVXNlck1lbnVfaWNvbk1lc3NhZ2VcIlxuICAgICAgICAgICAgICAgIGxhYmVsPXtfdChcIkZlZWRiYWNrXCIpfVxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMub25Qcm92aWRlRmVlZGJhY2t9XG4gICAgICAgICAgICAvPjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBwcmltYXJ5SGVhZGVyID0gKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJteF9Vc2VyTWVudV9jb250ZXh0TWVudV9uYW1lXCI+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwibXhfVXNlck1lbnVfY29udGV4dE1lbnVfZGlzcGxheU5hbWVcIj5cbiAgICAgICAgICAgICAgICAgICAgeyBPd25Qcm9maWxlU3RvcmUuaW5zdGFuY2UuZGlzcGxheU5hbWUgfVxuICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJteF9Vc2VyTWVudV9jb250ZXh0TWVudV91c2VySWRcIj5cbiAgICAgICAgICAgICAgICAgICAgeyBNYXRyaXhDbGllbnRQZWcuZ2V0KCkuZ2V0VXNlcklkKCkgfVxuICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApO1xuICAgICAgICBsZXQgcHJpbWFyeU9wdGlvbkxpc3QgPSAoXG4gICAgICAgICAgICA8UmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICAgICAgICAgPEljb25pemVkQ29udGV4dE1lbnVPcHRpb25MaXN0PlxuICAgICAgICAgICAgICAgICAgICB7IGhvbWVCdXR0b24gfVxuICAgICAgICAgICAgICAgICAgICA8SWNvbml6ZWRDb250ZXh0TWVudU9wdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgaWNvbkNsYXNzTmFtZT1cIm14X1VzZXJNZW51X2ljb25CZWxsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXtfdChcIk5vdGlmaWNhdGlvbiBzZXR0aW5nc1wiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eyhlKSA9PiB0aGlzLm9uU2V0dGluZ3NPcGVuKGUsIFVzZXJUYWIuTm90aWZpY2F0aW9ucyl9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDxJY29uaXplZENvbnRleHRNZW51T3B0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICBpY29uQ2xhc3NOYW1lPVwibXhfVXNlck1lbnVfaWNvbkxvY2tcIlxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e190KFwiU2VjdXJpdHkgJiBwcml2YWN5XCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KGUpID0+IHRoaXMub25TZXR0aW5nc09wZW4oZSwgVXNlclRhYi5TZWN1cml0eSl9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDxJY29uaXplZENvbnRleHRNZW51T3B0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICBpY29uQ2xhc3NOYW1lPVwibXhfVXNlck1lbnVfaWNvblNldHRpbmdzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXtfdChcIkFsbCBzZXR0aW5nc1wiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eyhlKSA9PiB0aGlzLm9uU2V0dGluZ3NPcGVuKGUsIG51bGwpfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICB7IC8qIDxJY29uaXplZENvbnRleHRNZW51T3B0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICBpY29uQ2xhc3NOYW1lPVwibXhfVXNlck1lbnVfaWNvbkFyY2hpdmVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e190KFwiQXJjaGl2ZWQgcm9vbXNcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uU2hvd0FyY2hpdmVkfVxuICAgICAgICAgICAgICAgICAgICAvPiAqLyB9XG4gICAgICAgICAgICAgICAgICAgIHsgZmVlZGJhY2tCdXR0b24gfVxuICAgICAgICAgICAgICAgIDwvSWNvbml6ZWRDb250ZXh0TWVudU9wdGlvbkxpc3Q+XG4gICAgICAgICAgICAgICAgPEljb25pemVkQ29udGV4dE1lbnVPcHRpb25MaXN0IHJlZD5cbiAgICAgICAgICAgICAgICAgICAgPEljb25pemVkQ29udGV4dE1lbnVPcHRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIGljb25DbGFzc05hbWU9XCJteF9Vc2VyTWVudV9pY29uU2lnbk91dFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD17X3QoXCJTaWduIG91dFwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMub25TaWduT3V0Q2xpY2t9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC9JY29uaXplZENvbnRleHRNZW51T3B0aW9uTGlzdD5cbiAgICAgICAgICAgIDwvUmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICk7XG4gICAgICAgIGxldCBzZWNvbmRhcnlTZWN0aW9uID0gbnVsbDtcblxuICAgICAgICBpZiAocHJvdG90eXBlQ29tbXVuaXR5TmFtZSkge1xuICAgICAgICAgICAgY29uc3QgY29tbXVuaXR5SWQgPSBDb21tdW5pdHlQcm90b3R5cGVTdG9yZS5pbnN0YW5jZS5nZXRTZWxlY3RlZENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICBwcmltYXJ5SGVhZGVyID0gKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfVXNlck1lbnVfY29udGV4dE1lbnVfbmFtZVwiPlxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJteF9Vc2VyTWVudV9jb250ZXh0TWVudV9kaXNwbGF5TmFtZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgeyBwcm90b3R5cGVDb21tdW5pdHlOYW1lIH1cbiAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGxldCBzZXR0aW5nc09wdGlvbjtcbiAgICAgICAgICAgIGxldCBpbnZpdGVPcHRpb247XG4gICAgICAgICAgICBpZiAoQ29tbXVuaXR5UHJvdG90eXBlU3RvcmUuaW5zdGFuY2UuY2FuSW52aXRlVG8oY29tbXVuaXR5SWQpKSB7XG4gICAgICAgICAgICAgICAgaW52aXRlT3B0aW9uID0gKFxuICAgICAgICAgICAgICAgICAgICA8SWNvbml6ZWRDb250ZXh0TWVudU9wdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgaWNvbkNsYXNzTmFtZT1cIm14X1VzZXJNZW51X2ljb25JbnZpdGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e190KFwiSW52aXRlXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5vbkNvbW11bml0eUludml0ZUNsaWNrfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoQ29tbXVuaXR5UHJvdG90eXBlU3RvcmUuaW5zdGFuY2UuaXNBZG1pbk9mKGNvbW11bml0eUlkKSkge1xuICAgICAgICAgICAgICAgIHNldHRpbmdzT3B0aW9uID0gKFxuICAgICAgICAgICAgICAgICAgICA8SWNvbml6ZWRDb250ZXh0TWVudU9wdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgaWNvbkNsYXNzTmFtZT1cIm14X1VzZXJNZW51X2ljb25TZXR0aW5nc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD17X3QoXCJTZXR0aW5nc1wiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGFyaWEtbGFiZWw9e190KFwiQ29tbXVuaXR5IHNldHRpbmdzXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5vbkNvbW11bml0eVNldHRpbmdzQ2xpY2t9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHByaW1hcnlPcHRpb25MaXN0ID0gKFxuICAgICAgICAgICAgICAgIDxJY29uaXplZENvbnRleHRNZW51T3B0aW9uTGlzdD5cbiAgICAgICAgICAgICAgICAgICAgeyBzZXR0aW5nc09wdGlvbiB9XG4gICAgICAgICAgICAgICAgICAgIDxJY29uaXplZENvbnRleHRNZW51T3B0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICBpY29uQ2xhc3NOYW1lPVwibXhfVXNlck1lbnVfaWNvbk1lbWJlcnNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e190KFwiTWVtYmVyc1wiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMub25Db21tdW5pdHlNZW1iZXJzQ2xpY2t9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIHsgaW52aXRlT3B0aW9uIH1cbiAgICAgICAgICAgICAgICA8L0ljb25pemVkQ29udGV4dE1lbnVPcHRpb25MaXN0PlxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHNlY29uZGFyeVNlY3Rpb24gPSAoXG4gICAgICAgICAgICAgICAgPFJlYWN0LkZyYWdtZW50PlxuICAgICAgICAgICAgICAgICAgICA8aHIgLz5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJteF9Vc2VyTWVudV9jb250ZXh0TWVudV9oZWFkZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfVXNlck1lbnVfY29udGV4dE1lbnVfbmFtZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cIm14X1VzZXJNZW51X2NvbnRleHRNZW51X2Rpc3BsYXlOYW1lXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgT3duUHJvZmlsZVN0b3JlLmluc3RhbmNlLmRpc3BsYXlOYW1lIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwibXhfVXNlck1lbnVfY29udGV4dE1lbnVfdXNlcklkXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgTWF0cml4Q2xpZW50UGVnLmdldCgpLmdldFVzZXJJZCgpIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxJY29uaXplZENvbnRleHRNZW51T3B0aW9uTGlzdD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxJY29uaXplZENvbnRleHRNZW51T3B0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbkNsYXNzTmFtZT1cIm14X1VzZXJNZW51X2ljb25TZXR0aW5nc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e190KFwiU2V0dGluZ3NcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJpYS1sYWJlbD17X3QoXCJVc2VyIHNldHRpbmdzXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eyhlKSA9PiB0aGlzLm9uU2V0dGluZ3NPcGVuKGUsIG51bGwpfVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIHsgZmVlZGJhY2tCdXR0b24gfVxuICAgICAgICAgICAgICAgICAgICA8L0ljb25pemVkQ29udGV4dE1lbnVPcHRpb25MaXN0PlxuICAgICAgICAgICAgICAgICAgICA8SWNvbml6ZWRDb250ZXh0TWVudU9wdGlvbkxpc3QgcmVkPlxuICAgICAgICAgICAgICAgICAgICAgICAgPEljb25pemVkQ29udGV4dE1lbnVPcHRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpY29uQ2xhc3NOYW1lPVwibXhfVXNlck1lbnVfaWNvblNpZ25PdXRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXtfdChcIlNpZ24gb3V0XCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMub25TaWduT3V0Q2xpY2t9XG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8L0ljb25pemVkQ29udGV4dE1lbnVPcHRpb25MaXN0PlxuICAgICAgICAgICAgICAgIDwvUmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2UgaWYgKE1hdHJpeENsaWVudFBlZy5nZXQoKS5pc0d1ZXN0KCkpIHtcbiAgICAgICAgICAgIHByaW1hcnlPcHRpb25MaXN0ID0gKFxuICAgICAgICAgICAgICAgIDxSZWFjdC5GcmFnbWVudD5cbiAgICAgICAgICAgICAgICAgICAgPEljb25pemVkQ29udGV4dE1lbnVPcHRpb25MaXN0PlxuICAgICAgICAgICAgICAgICAgICAgICAgeyBob21lQnV0dG9uIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIDxJY29uaXplZENvbnRleHRNZW51T3B0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbkNsYXNzTmFtZT1cIm14X1VzZXJNZW51X2ljb25TZXR0aW5nc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e190KFwiU2V0dGluZ3NcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KGUpID0+IHRoaXMub25TZXR0aW5nc09wZW4oZSwgbnVsbCl9XG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgeyBmZWVkYmFja0J1dHRvbiB9XG4gICAgICAgICAgICAgICAgICAgIDwvSWNvbml6ZWRDb250ZXh0TWVudU9wdGlvbkxpc3Q+XG4gICAgICAgICAgICAgICAgPC9SZWFjdC5GcmFnbWVudD5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjbGFzc2VzID0gY2xhc3NOYW1lcyh7XG4gICAgICAgICAgICBcIm14X1VzZXJNZW51X2NvbnRleHRNZW51XCI6IHRydWUsXG4gICAgICAgICAgICBcIm14X1VzZXJNZW51X2NvbnRleHRNZW51X3Byb3RvdHlwZVwiOiAhIXByb3RvdHlwZUNvbW11bml0eU5hbWUsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiA8SWNvbml6ZWRDb250ZXh0TWVudVxuICAgICAgICAgICAgLy8gbnVtZXJpY2FsIGFkanVzdG1lbnRzIHRvIG92ZXJsYXAgdGhlIGNvbnRleHQgbWVudSBieSBqdXN0IG92ZXIgdGhlIHdpZHRoIG9mIHRoZVxuICAgICAgICAgICAgLy8gbWVudSBpY29uIGFuZCBtYWtlIGl0IGxvb2sgY29ubmVjdGVkXG4gICAgICAgICAgICBsZWZ0PXt0aGlzLnN0YXRlLmNvbnRleHRNZW51UG9zaXRpb24ud2lkdGggKyB0aGlzLnN0YXRlLmNvbnRleHRNZW51UG9zaXRpb24ubGVmdCAtIDEwfVxuICAgICAgICAgICAgdG9wPXt0aGlzLnN0YXRlLmNvbnRleHRNZW51UG9zaXRpb24udG9wICsgdGhpcy5zdGF0ZS5jb250ZXh0TWVudVBvc2l0aW9uLmhlaWdodCArIDh9XG4gICAgICAgICAgICBvbkZpbmlzaGVkPXt0aGlzLm9uQ2xvc2VNZW51fVxuICAgICAgICAgICAgY2xhc3NOYW1lPXtjbGFzc2VzfVxuICAgICAgICA+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X1VzZXJNZW51X2NvbnRleHRNZW51X2hlYWRlclwiPlxuICAgICAgICAgICAgICAgIHsgcHJpbWFyeUhlYWRlciB9XG4gICAgICAgICAgICAgICAgPEFjY2Vzc2libGVUb29sdGlwQnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm14X1VzZXJNZW51X2NvbnRleHRNZW51X3RoZW1lQnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5vblN3aXRjaFRoZW1lQ2xpY2t9XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlPXt0aGlzLnN0YXRlLmlzRGFya1RoZW1lID8gX3QoXCJTd2l0Y2ggdG8gbGlnaHQgbW9kZVwiKSA6IF90KFwiU3dpdGNoIHRvIGRhcmsgbW9kZVwiKX1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIDxpbWdcbiAgICAgICAgICAgICAgICAgICAgICAgIHNyYz17cmVxdWlyZShcIi4uLy4uLy4uL3Jlcy9pbWcvZWxlbWVudC1pY29ucy9yb29tbGlzdC9kYXJrLWxpZ2h0LW1vZGUuc3ZnXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgYWx0PXtfdChcIlN3aXRjaCB0aGVtZVwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPXsxNn1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8L0FjY2Vzc2libGVUb29sdGlwQnV0dG9uPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICB7IHRvcFNlY3Rpb24gfVxuICAgICAgICAgICAgeyBwcmltYXJ5T3B0aW9uTGlzdCB9XG4gICAgICAgICAgICB7IHNlY29uZGFyeVNlY3Rpb24gfVxuICAgICAgICA8L0ljb25pemVkQ29udGV4dE1lbnU+O1xuICAgIH07XG5cbiAgICBwdWJsaWMgcmVuZGVyKCkge1xuICAgICAgICBjb25zdCBhdmF0YXJTaXplID0gMzI7IC8vIHNob3VsZCBtYXRjaCBib3JkZXItcmFkaXVzIG9mIHRoZSBhdmF0YXJcblxuICAgICAgICBjb25zdCB1c2VySWQgPSBNYXRyaXhDbGllbnRQZWcuZ2V0KCkuZ2V0VXNlcklkKCk7XG4gICAgICAgIGNvbnN0IGRpc3BsYXlOYW1lID0gT3duUHJvZmlsZVN0b3JlLmluc3RhbmNlLmRpc3BsYXlOYW1lIHx8IHVzZXJJZDtcbiAgICAgICAgY29uc3QgYXZhdGFyVXJsID0gT3duUHJvZmlsZVN0b3JlLmluc3RhbmNlLmdldEh0dHBBdmF0YXJVcmwoYXZhdGFyU2l6ZSk7XG5cbiAgICAgICAgY29uc3QgcHJvdG90eXBlQ29tbXVuaXR5TmFtZSA9IENvbW11bml0eVByb3RvdHlwZVN0b3JlLmluc3RhbmNlLmdldFNlbGVjdGVkQ29tbXVuaXR5TmFtZSgpO1xuXG4gICAgICAgIGxldCBpc1Byb3RvdHlwZSA9IGZhbHNlO1xuICAgICAgICBsZXQgbWVudU5hbWUgPSBfdChcIlVzZXIgbWVudVwiKTtcbiAgICAgICAgbGV0IG5hbWUgPSA8c3BhbiBjbGFzc05hbWU9XCJteF9Vc2VyTWVudV91c2VyTmFtZVwiPnsgZGlzcGxheU5hbWUgfTwvc3Bhbj47XG4gICAgICAgIGxldCBidXR0b25zID0gKFxuICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwibXhfVXNlck1lbnVfaGVhZGVyQnV0dG9uc1wiPlxuICAgICAgICAgICAgICAgIHsgLyogbWFza2VkIGltYWdlIGluIENTUyAqLyB9XG4gICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICk7XG4gICAgICAgIGxldCBkbmQ7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLnNlbGVjdGVkU3BhY2UpIHtcbiAgICAgICAgICAgIG5hbWUgPSAoXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJteF9Vc2VyTWVudV9kb3VibGVOYW1lXCI+XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cIm14X1VzZXJNZW51X3VzZXJOYW1lXCI+eyBkaXNwbGF5TmFtZSB9PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICA8Um9vbU5hbWUgcm9vbT17dGhpcy5zdGF0ZS5zZWxlY3RlZFNwYWNlfT5cbiAgICAgICAgICAgICAgICAgICAgICAgIHsgKHJvb21OYW1lKSA9PiA8c3BhbiBjbGFzc05hbWU9XCJteF9Vc2VyTWVudV9zdWJVc2VyTmFtZVwiPnsgcm9vbU5hbWUgfTwvc3Bhbj4gfVxuICAgICAgICAgICAgICAgICAgICA8L1Jvb21OYW1lPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIGlmIChwcm90b3R5cGVDb21tdW5pdHlOYW1lKSB7XG4gICAgICAgICAgICBuYW1lID0gKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfVXNlck1lbnVfZG91YmxlTmFtZVwiPlxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJteF9Vc2VyTWVudV91c2VyTmFtZVwiPnsgcHJvdG90eXBlQ29tbXVuaXR5TmFtZSB9PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJteF9Vc2VyTWVudV9zdWJVc2VyTmFtZVwiPnsgZGlzcGxheU5hbWUgfTwvc3Bhbj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBtZW51TmFtZSA9IF90KFwiQ29tbXVuaXR5IGFuZCB1c2VyIG1lbnVcIik7XG4gICAgICAgICAgICBpc1Byb3RvdHlwZSA9IHRydWU7XG4gICAgICAgIH0gZWxzZSBpZiAoU2V0dGluZ3NTdG9yZS5nZXRWYWx1ZShcImZlYXR1cmVfY29tbXVuaXRpZXNfdjJfcHJvdG90eXBlc1wiKSkge1xuICAgICAgICAgICAgbmFtZSA9IChcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X1VzZXJNZW51X2RvdWJsZU5hbWVcIj5cbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwibXhfVXNlck1lbnVfdXNlck5hbWVcIj57IF90KFwiSG9tZVwiKSB9PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJteF9Vc2VyTWVudV9zdWJVc2VyTmFtZVwiPnsgZGlzcGxheU5hbWUgfTwvc3Bhbj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBpc1Byb3RvdHlwZSA9IHRydWU7XG4gICAgICAgIH0gZWxzZSBpZiAoU2V0dGluZ3NTdG9yZS5nZXRWYWx1ZShcImZlYXR1cmVfZG5kXCIpKSB7XG4gICAgICAgICAgICBjb25zdCBpc0RuZCA9IFNldHRpbmdzU3RvcmUuZ2V0VmFsdWUoXCJkb05vdERpc3R1cmJcIik7XG4gICAgICAgICAgICBkbmQgPSA8QWNjZXNzaWJsZUJ1dHRvblxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMub25EbmRUb2dnbGV9XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbGFzc05hbWVzKHtcbiAgICAgICAgICAgICAgICAgICAgXCJteF9Vc2VyTWVudV9kbmRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgXCJteF9Vc2VyTWVudV9kbmRfbm9pc3lcIjogIWlzRG5kLFxuICAgICAgICAgICAgICAgICAgICBcIm14X1VzZXJNZW51X2RuZF9tdXRlZFwiOiBpc0RuZCxcbiAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgIC8+O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnByb3BzLmlzTWluaW1pemVkKSB7XG4gICAgICAgICAgICBuYW1lID0gbnVsbDtcbiAgICAgICAgICAgIGJ1dHRvbnMgPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY2xhc3NlcyA9IGNsYXNzTmFtZXMoe1xuICAgICAgICAgICAgJ214X1VzZXJNZW51JzogdHJ1ZSxcbiAgICAgICAgICAgICdteF9Vc2VyTWVudV9taW5pbWl6ZWQnOiB0aGlzLnByb3BzLmlzTWluaW1pemVkLFxuICAgICAgICAgICAgJ214X1VzZXJNZW51X3Byb3RvdHlwZSc6IGlzUHJvdG90eXBlLFxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPFJlYWN0LkZyYWdtZW50PlxuICAgICAgICAgICAgICAgIDxDb250ZXh0TWVudUJ1dHRvblxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2NsYXNzZXN9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMub25PcGVuTWVudUNsaWNrfVxuICAgICAgICAgICAgICAgICAgICBpbnB1dFJlZj17dGhpcy5idXR0b25SZWZ9XG4gICAgICAgICAgICAgICAgICAgIGxhYmVsPXttZW51TmFtZX1cbiAgICAgICAgICAgICAgICAgICAgaXNFeHBhbmRlZD17ISF0aGlzLnN0YXRlLmNvbnRleHRNZW51UG9zaXRpb259XG4gICAgICAgICAgICAgICAgICAgIG9uQ29udGV4dE1lbnU9e3RoaXMub25Db250ZXh0TWVudX1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfVXNlck1lbnVfcm93XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJteF9Vc2VyTWVudV91c2VyQXZhdGFyQ29udGFpbmVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPEJhc2VBdmF0YXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWROYW1lPXt1c2VySWR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9e2Rpc3BsYXlOYW1lfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw9e2F2YXRhclVybH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9e2F2YXRhclNpemV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodD17YXZhdGFyU2l6ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzaXplTWV0aG9kPVwiY3JvcFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm14X1VzZXJNZW51X3VzZXJBdmF0YXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICB7IG5hbWUgfVxuICAgICAgICAgICAgICAgICAgICAgICAgeyB0aGlzLnN0YXRlLnBlbmRpbmdSb29tSm9pbi5zaXplID4gMCAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPElubGluZVNwaW5uZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUb29sdGlwQnV0dG9uIGhlbHBUZXh0PXtfdChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQ3VycmVudGx5IGpvaW5pbmcgJShjb3VudClzIHJvb21zXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IGNvdW50OiB0aGlzLnN0YXRlLnBlbmRpbmdSb29tSm9pbi5zaXplIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9IC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9JbmxpbmVTcGlubmVyPlxuICAgICAgICAgICAgICAgICAgICAgICAgKSB9XG4gICAgICAgICAgICAgICAgICAgICAgICB7IGRuZCB9XG4gICAgICAgICAgICAgICAgICAgICAgICB7IGJ1dHRvbnMgfVxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L0NvbnRleHRNZW51QnV0dG9uPlxuICAgICAgICAgICAgICAgIHsgdGhpcy5yZW5kZXJDb250ZXh0TWVudSgpIH1cbiAgICAgICAgICAgIDwvUmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICk7XG4gICAgfVxufVxuIl19