"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireDefault(require("react"));

var _thread = require("matrix-js-sdk/src/models/thread");

var _event = require("matrix-js-sdk/src/@types/event");

var _BaseCard = _interopRequireDefault(require("../views/right_panel/BaseCard"));

var _RightPanelStorePhases = require("../../stores/RightPanelStorePhases");

var _replaceableComponent = require("../../utils/replaceableComponent");

var _EventTile = require("../views/rooms/EventTile");

var _MessageComposer = _interopRequireDefault(require("../views/rooms/MessageComposer"));

var _Layout = require("../../settings/enums/Layout");

var _TimelinePanel = _interopRequireDefault(require("./TimelinePanel"));

var _dispatcher = _interopRequireDefault(require("../../dispatcher/dispatcher"));

var _actions = require("../../dispatcher/actions");

var _MatrixClientPeg = require("../../MatrixClientPeg");

var _EditorStateTransfer = _interopRequireDefault(require("../../utils/EditorStateTransfer"));

var _RoomContext = _interopRequireWildcard(require("../../contexts/RoomContext"));

var _ContentMessages = _interopRequireDefault(require("../../ContentMessages"));

var _UploadBar = _interopRequireDefault(require("./UploadBar"));

var _languageHandler = require("../../languageHandler");

var _ThreadListContextMenu = _interopRequireDefault(require("../views/context_menus/ThreadListContextMenu"));

var _RightPanelStore = _interopRequireDefault(require("../../stores/RightPanelStore"));

var _SettingsStore = _interopRequireDefault(require("../../settings/SettingsStore"));

var _WidgetLayoutStore = require("../../stores/widgets/WidgetLayoutStore");

var _dec, _class, _class2, _temp;

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

let ThreadView = (_dec = (0, _replaceableComponent.replaceableComponent)("structures.ThreadView"), _dec(_class = (_temp = _class2 = class ThreadView extends _react.default.Component {
  constructor(props) {
    super(props);
    (0, _defineProperty2.default)(this, "dispatcherRef", void 0);
    (0, _defineProperty2.default)(this, "timelinePanelRef", /*#__PURE__*/_react.default.createRef());
    (0, _defineProperty2.default)(this, "onAction", payload => {
      if (payload.phase == _RightPanelStorePhases.RightPanelPhases.ThreadView && payload.event) {
        this.teardownThread();
        this.setupThread(payload.event);
      }

      switch (payload.action) {
        case _actions.Action.EditEvent:
          // Quit early if it's not a thread context
          if (payload.timelineRenderingType !== _RoomContext.TimelineRenderingType.Thread) return; // Quit early if that's not a thread event

          if (payload.event && !payload.event.getThread()) return;
          this.setState({
            editState: payload.event ? new _EditorStateTransfer.default(payload.event) : null
          }, () => {
            if (payload.event) {
              var _this$timelinePanelRe;

              (_this$timelinePanelRe = this.timelinePanelRef.current) === null || _this$timelinePanelRe === void 0 ? void 0 : _this$timelinePanelRe.scrollToEventIfNeeded(payload.event.getId());
            }
          });
          break;

        case 'reply_to_event':
          if (payload.context === _RoomContext.TimelineRenderingType.Thread) {
            this.setState({
              replyToEvent: payload.event
            });
          }

          break;

        default:
          break;
      }
    });
    (0, _defineProperty2.default)(this, "setupThread", mxEv => {
      let thread = this.props.room.threads.get(mxEv.getId());

      if (!thread) {
        const client = _MatrixClientPeg.MatrixClientPeg.get(); // Do not attach this thread object to the event for now
        // TODO: When local echo gets reintroduced it will be important
        // to add that back in, and the threads model should go through the
        // same reconciliation algorithm as events


        thread = new _thread.Thread([mxEv], this.props.room, client);
      }

      thread.on(_thread.ThreadEvent.Update, this.updateThread);
      thread.once(_thread.ThreadEvent.Ready, this.updateThread);
      this.updateThread(thread);
    });
    (0, _defineProperty2.default)(this, "teardownThread", () => {
      if (this.state.thread) {
        this.state.thread.removeListener(_thread.ThreadEvent.Update, this.updateThread);
        this.state.thread.removeListener(_thread.ThreadEvent.Ready, this.updateThread);
      }
    });
    (0, _defineProperty2.default)(this, "onNewThread", thread => {
      if (thread.id === this.props.mxEvent.getId()) {
        this.teardownThread();
        this.setupThread(this.props.mxEvent);
      }
    });
    (0, _defineProperty2.default)(this, "updateThread", thread => {
      var _this$timelinePanelRe2;

      if (thread) {
        this.setState({
          thread
        });
      }

      (_this$timelinePanelRe2 = this.timelinePanelRef.current) === null || _this$timelinePanelRe2 === void 0 ? void 0 : _this$timelinePanelRe2.refreshTimeline();
    });
    (0, _defineProperty2.default)(this, "onScroll", () => {
      if (this.props.initialEvent && this.props.initialEventHighlighted) {
        var _this$props$initialEv;

        _dispatcher.default.dispatch({
          action: _actions.Action.ViewRoom,
          room_id: this.props.room.roomId,
          event_id: (_this$props$initialEv = this.props.initialEvent) === null || _this$props$initialEv === void 0 ? void 0 : _this$props$initialEv.getId(),
          highlighted: false,
          replyingToEvent: this.state.replyToEvent
        });
      }
    });
    (0, _defineProperty2.default)(this, "renderThreadViewHeader", () => {
      return /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_ThreadPanel__header"
      }, /*#__PURE__*/_react.default.createElement("span", null, (0, _languageHandler._t)("Thread")), /*#__PURE__*/_react.default.createElement(_ThreadListContextMenu.default, {
        mxEvent: this.props.mxEvent,
        permalinkCreator: this.props.permalinkCreator
      }));
    });
    this.state = {};
  }

  componentDidMount() {
    this.setupThread(this.props.mxEvent);
    this.dispatcherRef = _dispatcher.default.register(this.onAction);

    const room = _MatrixClientPeg.MatrixClientPeg.get().getRoom(this.props.mxEvent.getRoomId());

    room.on(_thread.ThreadEvent.New, this.onNewThread);
  }

  componentWillUnmount() {
    this.teardownThread();

    _dispatcher.default.unregister(this.dispatcherRef);

    const room = _MatrixClientPeg.MatrixClientPeg.get().getRoom(this.props.mxEvent.getRoomId());

    room.removeListener(_thread.ThreadEvent.New, this.onNewThread);
  }

  componentDidUpdate(prevProps) {
    if (prevProps.mxEvent !== this.props.mxEvent) {
      this.teardownThread();
      this.setupThread(this.props.mxEvent);
    }

    if (prevProps.room !== this.props.room) {
      _dispatcher.default.dispatch({
        action: _actions.Action.SetRightPanelPhase,
        phase: _RightPanelStorePhases.RightPanelPhases.RoomSummary
      });
    }
  }

  render() {
    var _this$props$initialEv2, _this$state$thread, _this$state, _this$state$thread2, _this$state$thread2$t, _this$state2, _this$state2$thread, _this$props$initialEv3, _this$state3, _this$state3$thread;

    const highlightedEventId = this.props.initialEventHighlighted ? (_this$props$initialEv2 = this.props.initialEvent) === null || _this$props$initialEv2 === void 0 ? void 0 : _this$props$initialEv2.getId() : null;
    const threadRelation = {
      rel_type: _event.RelationType.Thread,
      event_id: (_this$state$thread = this.state.thread) === null || _this$state$thread === void 0 ? void 0 : _this$state$thread.id
    };

    let previousPhase = _RightPanelStore.default.getSharedInstance().previousPhase;

    if (!_SettingsStore.default.getValue("feature_maximised_widgets")) {
      previousPhase = _RightPanelStorePhases.RightPanelPhases.ThreadPanel;
    } // change the previous phase to the threadPanel in case there is no maximised widget anymore


    if (!_WidgetLayoutStore.WidgetLayoutStore.instance.hasMaximisedWidget(this.props.room)) {
      previousPhase = _RightPanelStorePhases.RightPanelPhases.ThreadPanel;
    } // Make sure the previous Phase is always one of the two: Timeline or ThreadPanel


    if (![_RightPanelStorePhases.RightPanelPhases.ThreadPanel, _RightPanelStorePhases.RightPanelPhases.Timeline].includes(previousPhase)) {
      previousPhase = _RightPanelStorePhases.RightPanelPhases.ThreadPanel;
    }

    const previousPhaseLabels = {};
    previousPhaseLabels[_RightPanelStorePhases.RightPanelPhases.ThreadPanel] = (0, _languageHandler._t)("All threads");
    previousPhaseLabels[_RightPanelStorePhases.RightPanelPhases.Timeline] = (0, _languageHandler._t)("Chat");
    return /*#__PURE__*/_react.default.createElement(_RoomContext.default.Provider, {
      value: _objectSpread(_objectSpread({}, this.context), {}, {
        timelineRenderingType: _RoomContext.TimelineRenderingType.Thread,
        liveTimeline: (_this$state = this.state) === null || _this$state === void 0 ? void 0 : (_this$state$thread2 = _this$state.thread) === null || _this$state$thread2 === void 0 ? void 0 : (_this$state$thread2$t = _this$state$thread2.timelineSet) === null || _this$state$thread2$t === void 0 ? void 0 : _this$state$thread2$t.getLiveTimeline()
      })
    }, /*#__PURE__*/_react.default.createElement(_BaseCard.default, {
      className: "mx_ThreadView mx_ThreadPanel",
      onClose: this.props.onClose,
      previousPhase: previousPhase,
      previousPhaseLabel: previousPhaseLabels[previousPhase],
      withoutScrollContainer: true,
      header: this.renderThreadViewHeader()
    }, this.state.thread && /*#__PURE__*/_react.default.createElement(_TimelinePanel.default, {
      ref: this.timelinePanelRef,
      showReadReceipts: false // No RR support in thread's MVP
      ,
      manageReadReceipts: false // No RR support in thread's MVP
      ,
      manageReadMarkers: false // No RM support in thread's MVP
      ,
      sendReadReceiptOnLoad: false // No RR support in thread's MVP
      ,
      timelineSet: (_this$state2 = this.state) === null || _this$state2 === void 0 ? void 0 : (_this$state2$thread = _this$state2.thread) === null || _this$state2$thread === void 0 ? void 0 : _this$state2$thread.timelineSet,
      showUrlPreview: true,
      tileShape: _EventTile.TileShape.Thread,
      layout: _Layout.Layout.Group,
      hideThreadedMessages: false,
      hidden: false,
      showReactions: true,
      className: "mx_RoomView_messagePanel mx_GroupLayout",
      permalinkCreator: this.props.permalinkCreator,
      membersLoaded: true,
      editState: this.state.editState,
      eventId: (_this$props$initialEv3 = this.props.initialEvent) === null || _this$props$initialEv3 === void 0 ? void 0 : _this$props$initialEv3.getId(),
      highlightedEventId: highlightedEventId,
      onUserScroll: this.onScroll
    }), _ContentMessages.default.sharedInstance().getCurrentUploads(threadRelation).length > 0 && /*#__PURE__*/_react.default.createElement(_UploadBar.default, {
      room: this.props.room,
      relation: threadRelation
    }), ((_this$state3 = this.state) === null || _this$state3 === void 0 ? void 0 : (_this$state3$thread = _this$state3.thread) === null || _this$state3$thread === void 0 ? void 0 : _this$state3$thread.timelineSet) && /*#__PURE__*/_react.default.createElement(_MessageComposer.default, {
      room: this.props.room,
      resizeNotifier: this.props.resizeNotifier,
      relation: threadRelation,
      replyToEvent: this.state.replyToEvent,
      permalinkCreator: this.props.permalinkCreator,
      e2eStatus: this.props.e2eStatus,
      compact: true
    })));
  }

}, (0, _defineProperty2.default)(_class2, "contextType", _RoomContext.default), _temp)) || _class);
exports.default = ThreadView;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3N0cnVjdHVyZXMvVGhyZWFkVmlldy50c3giXSwibmFtZXMiOlsiVGhyZWFkVmlldyIsIlJlYWN0IiwiQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJwcm9wcyIsImNyZWF0ZVJlZiIsInBheWxvYWQiLCJwaGFzZSIsIlJpZ2h0UGFuZWxQaGFzZXMiLCJldmVudCIsInRlYXJkb3duVGhyZWFkIiwic2V0dXBUaHJlYWQiLCJhY3Rpb24iLCJBY3Rpb24iLCJFZGl0RXZlbnQiLCJ0aW1lbGluZVJlbmRlcmluZ1R5cGUiLCJUaW1lbGluZVJlbmRlcmluZ1R5cGUiLCJUaHJlYWQiLCJnZXRUaHJlYWQiLCJzZXRTdGF0ZSIsImVkaXRTdGF0ZSIsIkVkaXRvclN0YXRlVHJhbnNmZXIiLCJ0aW1lbGluZVBhbmVsUmVmIiwiY3VycmVudCIsInNjcm9sbFRvRXZlbnRJZk5lZWRlZCIsImdldElkIiwiY29udGV4dCIsInJlcGx5VG9FdmVudCIsIm14RXYiLCJ0aHJlYWQiLCJyb29tIiwidGhyZWFkcyIsImdldCIsImNsaWVudCIsIk1hdHJpeENsaWVudFBlZyIsIm9uIiwiVGhyZWFkRXZlbnQiLCJVcGRhdGUiLCJ1cGRhdGVUaHJlYWQiLCJvbmNlIiwiUmVhZHkiLCJzdGF0ZSIsInJlbW92ZUxpc3RlbmVyIiwiaWQiLCJteEV2ZW50IiwicmVmcmVzaFRpbWVsaW5lIiwiaW5pdGlhbEV2ZW50IiwiaW5pdGlhbEV2ZW50SGlnaGxpZ2h0ZWQiLCJkaXMiLCJkaXNwYXRjaCIsIlZpZXdSb29tIiwicm9vbV9pZCIsInJvb21JZCIsImV2ZW50X2lkIiwiaGlnaGxpZ2h0ZWQiLCJyZXBseWluZ1RvRXZlbnQiLCJwZXJtYWxpbmtDcmVhdG9yIiwiY29tcG9uZW50RGlkTW91bnQiLCJkaXNwYXRjaGVyUmVmIiwicmVnaXN0ZXIiLCJvbkFjdGlvbiIsImdldFJvb20iLCJnZXRSb29tSWQiLCJOZXciLCJvbk5ld1RocmVhZCIsImNvbXBvbmVudFdpbGxVbm1vdW50IiwidW5yZWdpc3RlciIsImNvbXBvbmVudERpZFVwZGF0ZSIsInByZXZQcm9wcyIsIlNldFJpZ2h0UGFuZWxQaGFzZSIsIlJvb21TdW1tYXJ5IiwicmVuZGVyIiwiaGlnaGxpZ2h0ZWRFdmVudElkIiwidGhyZWFkUmVsYXRpb24iLCJyZWxfdHlwZSIsIlJlbGF0aW9uVHlwZSIsInByZXZpb3VzUGhhc2UiLCJSaWdodFBhbmVsU3RvcmUiLCJnZXRTaGFyZWRJbnN0YW5jZSIsIlNldHRpbmdzU3RvcmUiLCJnZXRWYWx1ZSIsIlRocmVhZFBhbmVsIiwiV2lkZ2V0TGF5b3V0U3RvcmUiLCJpbnN0YW5jZSIsImhhc01heGltaXNlZFdpZGdldCIsIlRpbWVsaW5lIiwiaW5jbHVkZXMiLCJwcmV2aW91c1BoYXNlTGFiZWxzIiwibGl2ZVRpbWVsaW5lIiwidGltZWxpbmVTZXQiLCJnZXRMaXZlVGltZWxpbmUiLCJvbkNsb3NlIiwicmVuZGVyVGhyZWFkVmlld0hlYWRlciIsIlRpbGVTaGFwZSIsIkxheW91dCIsIkdyb3VwIiwib25TY3JvbGwiLCJDb250ZW50TWVzc2FnZXMiLCJzaGFyZWRJbnN0YW5jZSIsImdldEN1cnJlbnRVcGxvYWRzIiwibGVuZ3RoIiwicmVzaXplTm90aWZpZXIiLCJlMmVTdGF0dXMiLCJSb29tQ29udGV4dCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFnQkE7O0FBRUE7O0FBQ0E7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBR0E7O0FBQ0E7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBR0E7O0FBQ0E7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7Ozs7Ozs7OztJQW1CcUJBLFUsV0FEcEIsZ0RBQXFCLHVCQUFyQixDLG1DQUFELE1BQ3FCQSxVQURyQixTQUN3Q0MsZUFBTUMsU0FEOUMsQ0FDd0U7QUFNcEVDLEVBQUFBLFdBQVcsQ0FBQ0MsS0FBRCxFQUFnQjtBQUN2QixVQUFNQSxLQUFOO0FBRHVCO0FBQUEseUVBRmdD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QWRqQztBQWVJLE1BQUEsYUFBYSxFQUFFLElBZm5CO0FBZ0JJLE1BQUEsU0FBUyxFQUFFLEtBQUtmLEtBQUwsQ0FBV3JCLFNBaEIxQjtBQWlCSSxNQUFBLE9BQU8sNEJBQUUsS0FBS2hCLEtBQUwsQ0FBVzBDLFlBQWIsMkRBQUUsdUJBQXlCckIsS0FBekIsRUFqQmI7QUFrQkksTUFBQSxrQkFBa0IsRUFBRStDLGtCQWxCeEI7QUFtQkksTUFBQSxZQUFZLEVBQUUsS0FBS3dCO0FBbkJ2QixNQVRSLEVBZ0NNQyx5QkFBZ0JDLGNBQWhCLEdBQWlDQyxpQkFBakMsQ0FBbUQxQixjQUFuRCxFQUFtRTJCLE1BQW5FLEdBQTRFLENBQTVFLGlCQUNFLDZCQUFDLGtCQUFEO0FBQVcsTUFBQSxJQUFJLEVBQUUsS0FBS2hHLEtBQUwsQ0FBVzBCLElBQTVCO0FBQWtDLE1BQUEsUUFBUSxFQUFFMkM7QUFBNUMsTUFqQ1IsRUFvQ00sc0JBQUtoQyxLQUFMLHFGQUFZWixNQUFaLDRFQUFvQjRELFdBQXBCLGtCQUFvQyw2QkFBQyx3QkFBRDtBQUNsQyxNQUFBLElBQUksRUFBRSxLQUFLckYsS0FBTCxDQUFXMEIsSUFEaUI7QUFFbEMsTUFBQSxjQUFjLEVBQUUsS0FBSzFCLEtBQUwsQ0FBV2lHLGNBRk87QUFHbEMsTUFBQSxRQUFRLEVBQUU1QixjQUh3QjtBQUlsQyxNQUFBLFlBQVksRUFBRSxLQUFLaEMsS0FBTCxDQUFXZCxZQUpTO0FBS2xDLE1BQUEsZ0JBQWdCLEVBQUUsS0FBS3ZCLEtBQUwsQ0FBV29ELGdCQUxLO0FBTWxDLE1BQUEsU0FBUyxFQUFFLEtBQUtwRCxLQUFMLENBQVdrRyxTQU5ZO0FBT2xDLE1BQUEsT0FBTyxFQUFFO0FBUHlCLE1BcEMxQyxDQU5KLENBREo7QUF1REg7O0FBek5tRSxDLHdEQUMvQ0Msb0IiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuQ29weXJpZ2h0IDIwMjEgVGhlIE1hdHJpeC5vcmcgRm91bmRhdGlvbiBDLkkuQy5cblxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbnlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbllvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuXG4gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cblVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbmRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxubGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4qL1xuXG5pbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgSUV2ZW50UmVsYXRpb24sIE1hdHJpeEV2ZW50LCBSb29tIH0gZnJvbSAnbWF0cml4LWpzLXNkay9zcmMnO1xuaW1wb3J0IHsgVGhyZWFkLCBUaHJlYWRFdmVudCB9IGZyb20gJ21hdHJpeC1qcy1zZGsvc3JjL21vZGVscy90aHJlYWQnO1xuaW1wb3J0IHsgUmVsYXRpb25UeXBlIH0gZnJvbSAnbWF0cml4LWpzLXNkay9zcmMvQHR5cGVzL2V2ZW50JztcblxuaW1wb3J0IEJhc2VDYXJkIGZyb20gXCIuLi92aWV3cy9yaWdodF9wYW5lbC9CYXNlQ2FyZFwiO1xuaW1wb3J0IHsgUmlnaHRQYW5lbFBoYXNlcyB9IGZyb20gXCIuLi8uLi9zdG9yZXMvUmlnaHRQYW5lbFN0b3JlUGhhc2VzXCI7XG5pbXBvcnQgeyByZXBsYWNlYWJsZUNvbXBvbmVudCB9IGZyb20gXCIuLi8uLi91dGlscy9yZXBsYWNlYWJsZUNvbXBvbmVudFwiO1xuXG5pbXBvcnQgUmVzaXplTm90aWZpZXIgZnJvbSAnLi4vLi4vdXRpbHMvUmVzaXplTm90aWZpZXInO1xuaW1wb3J0IHsgVGlsZVNoYXBlIH0gZnJvbSAnLi4vdmlld3Mvcm9vbXMvRXZlbnRUaWxlJztcbmltcG9ydCBNZXNzYWdlQ29tcG9zZXIgZnJvbSAnLi4vdmlld3Mvcm9vbXMvTWVzc2FnZUNvbXBvc2VyJztcbmltcG9ydCB7IFJvb21QZXJtYWxpbmtDcmVhdG9yIH0gZnJvbSAnLi4vLi4vdXRpbHMvcGVybWFsaW5rcy9QZXJtYWxpbmtzJztcbmltcG9ydCB7IExheW91dCB9IGZyb20gJy4uLy4uL3NldHRpbmdzL2VudW1zL0xheW91dCc7XG5pbXBvcnQgVGltZWxpbmVQYW5lbCBmcm9tICcuL1RpbWVsaW5lUGFuZWwnO1xuaW1wb3J0IGRpcyBmcm9tIFwiLi4vLi4vZGlzcGF0Y2hlci9kaXNwYXRjaGVyXCI7XG5pbXBvcnQgeyBBY3Rpb25QYXlsb2FkIH0gZnJvbSAnLi4vLi4vZGlzcGF0Y2hlci9wYXlsb2Fkcyc7XG5pbXBvcnQgeyBTZXRSaWdodFBhbmVsUGhhc2VQYXlsb2FkIH0gZnJvbSAnLi4vLi4vZGlzcGF0Y2hlci9wYXlsb2Fkcy9TZXRSaWdodFBhbmVsUGhhc2VQYXlsb2FkJztcbmltcG9ydCB7IEFjdGlvbiB9IGZyb20gJy4uLy4uL2Rpc3BhdGNoZXIvYWN0aW9ucyc7XG5pbXBvcnQgeyBNYXRyaXhDbGllbnRQZWcgfSBmcm9tICcuLi8uLi9NYXRyaXhDbGllbnRQZWcnO1xuaW1wb3J0IHsgRTJFU3RhdHVzIH0gZnJvbSAnLi4vLi4vdXRpbHMvU2hpZWxkVXRpbHMnO1xuaW1wb3J0IEVkaXRvclN0YXRlVHJhbnNmZXIgZnJvbSAnLi4vLi4vdXRpbHMvRWRpdG9yU3RhdGVUcmFuc2Zlcic7XG5pbXBvcnQgUm9vbUNvbnRleHQsIHsgVGltZWxpbmVSZW5kZXJpbmdUeXBlIH0gZnJvbSAnLi4vLi4vY29udGV4dHMvUm9vbUNvbnRleHQnO1xuaW1wb3J0IENvbnRlbnRNZXNzYWdlcyBmcm9tICcuLi8uLi9Db250ZW50TWVzc2FnZXMnO1xuaW1wb3J0IFVwbG9hZEJhciBmcm9tICcuL1VwbG9hZEJhcic7XG5pbXBvcnQgeyBfdCB9IGZyb20gJy4uLy4uL2xhbmd1YWdlSGFuZGxlcic7XG5pbXBvcnQgVGhyZWFkTGlzdENvbnRleHRNZW51IGZyb20gJy4uL3ZpZXdzL2NvbnRleHRfbWVudXMvVGhyZWFkTGlzdENvbnRleHRNZW51JztcbmltcG9ydCBSaWdodFBhbmVsU3RvcmUgZnJvbSAnLi4vLi4vc3RvcmVzL1JpZ2h0UGFuZWxTdG9yZSc7XG5pbXBvcnQgU2V0dGluZ3NTdG9yZSBmcm9tICcuLi8uLi9zZXR0aW5ncy9TZXR0aW5nc1N0b3JlJztcbmltcG9ydCB7IFdpZGdldExheW91dFN0b3JlIH0gZnJvbSAnLi4vLi4vc3RvcmVzL3dpZGdldHMvV2lkZ2V0TGF5b3V0U3RvcmUnO1xuXG5pbnRlcmZhY2UgSVByb3BzIHtcbiAgICByb29tOiBSb29tO1xuICAgIG9uQ2xvc2U6ICgpID0+IHZvaWQ7XG4gICAgcmVzaXplTm90aWZpZXI6IFJlc2l6ZU5vdGlmaWVyO1xuICAgIG14RXZlbnQ6IE1hdHJpeEV2ZW50O1xuICAgIHBlcm1hbGlua0NyZWF0b3I/OiBSb29tUGVybWFsaW5rQ3JlYXRvcjtcbiAgICBlMmVTdGF0dXM/OiBFMkVTdGF0dXM7XG4gICAgaW5pdGlhbEV2ZW50PzogTWF0cml4RXZlbnQ7XG4gICAgaW5pdGlhbEV2ZW50SGlnaGxpZ2h0ZWQ/OiBib29sZWFuO1xufVxuaW50ZXJmYWNlIElTdGF0ZSB7XG4gICAgdGhyZWFkPzogVGhyZWFkO1xuICAgIGVkaXRTdGF0ZT86IEVkaXRvclN0YXRlVHJhbnNmZXI7XG4gICAgcmVwbHlUb0V2ZW50PzogTWF0cml4RXZlbnQ7XG59XG5cbkByZXBsYWNlYWJsZUNvbXBvbmVudChcInN0cnVjdHVyZXMuVGhyZWFkVmlld1wiKVxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGhyZWFkVmlldyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxJUHJvcHMsIElTdGF0ZT4ge1xuICAgIHN0YXRpYyBjb250ZXh0VHlwZSA9IFJvb21Db250ZXh0O1xuXG4gICAgcHJpdmF0ZSBkaXNwYXRjaGVyUmVmOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSB0aW1lbGluZVBhbmVsUmVmOiBSZWFjdC5SZWZPYmplY3Q8VGltZWxpbmVQYW5lbD4gPSBSZWFjdC5jcmVhdGVSZWYoKTtcblxuICAgIGNvbnN0cnVjdG9yKHByb3BzOiBJUHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgICAgICB0aGlzLnN0YXRlID0ge307XG4gICAgfVxuICAgIHB1YmxpYyBjb21wb25lbnREaWRNb3VudCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zZXR1cFRocmVhZCh0aGlzLnByb3BzLm14RXZlbnQpO1xuICAgICAgICB0aGlzLmRpc3BhdGNoZXJSZWYgPSBkaXMucmVnaXN0ZXIodGhpcy5vbkFjdGlvbik7XG5cbiAgICAgICAgY29uc3Qgcm9vbSA9IE1hdHJpeENsaWVudFBlZy5nZXQoKS5nZXRSb29tKHRoaXMucHJvcHMubXhFdmVudC5nZXRSb29tSWQoKSk7XG4gICAgICAgIHJvb20ub24oVGhyZWFkRXZlbnQuTmV3LCB0aGlzLm9uTmV3VGhyZWFkKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY29tcG9uZW50V2lsbFVubW91bnQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMudGVhcmRvd25UaHJlYWQoKTtcbiAgICAgICAgZGlzLnVucmVnaXN0ZXIodGhpcy5kaXNwYXRjaGVyUmVmKTtcbiAgICAgICAgY29uc3Qgcm9vbSA9IE1hdHJpeENsaWVudFBlZy5nZXQoKS5nZXRSb29tKHRoaXMucHJvcHMubXhFdmVudC5nZXRSb29tSWQoKSk7XG4gICAgICAgIHJvb20ucmVtb3ZlTGlzdGVuZXIoVGhyZWFkRXZlbnQuTmV3LCB0aGlzLm9uTmV3VGhyZWFkKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY29tcG9uZW50RGlkVXBkYXRlKHByZXZQcm9wcykge1xuICAgICAgICBpZiAocHJldlByb3BzLm14RXZlbnQgIT09IHRoaXMucHJvcHMubXhFdmVudCkge1xuICAgICAgICAgICAgdGhpcy50ZWFyZG93blRocmVhZCgpO1xuICAgICAgICAgICAgdGhpcy5zZXR1cFRocmVhZCh0aGlzLnByb3BzLm14RXZlbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHByZXZQcm9wcy5yb29tICE9PSB0aGlzLnByb3BzLnJvb20pIHtcbiAgICAgICAgICAgIGRpcy5kaXNwYXRjaDxTZXRSaWdodFBhbmVsUGhhc2VQYXlsb2FkPih7XG4gICAgICAgICAgICAgICAgYWN0aW9uOiBBY3Rpb24uU2V0UmlnaHRQYW5lbFBoYXNlLFxuICAgICAgICAgICAgICAgIHBoYXNlOiBSaWdodFBhbmVsUGhhc2VzLlJvb21TdW1tYXJ5LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIG9uQWN0aW9uID0gKHBheWxvYWQ6IEFjdGlvblBheWxvYWQpOiB2b2lkID0+IHtcbiAgICAgICAgaWYgKHBheWxvYWQucGhhc2UgPT0gUmlnaHRQYW5lbFBoYXNlcy5UaHJlYWRWaWV3ICYmIHBheWxvYWQuZXZlbnQpIHtcbiAgICAgICAgICAgIHRoaXMudGVhcmRvd25UaHJlYWQoKTtcbiAgICAgICAgICAgIHRoaXMuc2V0dXBUaHJlYWQocGF5bG9hZC5ldmVudCk7XG4gICAgICAgIH1cbiAgICAgICAgc3dpdGNoIChwYXlsb2FkLmFjdGlvbikge1xuICAgICAgICAgICAgY2FzZSBBY3Rpb24uRWRpdEV2ZW50OlxuICAgICAgICAgICAgICAgIC8vIFF1aXQgZWFybHkgaWYgaXQncyBub3QgYSB0aHJlYWQgY29udGV4dFxuICAgICAgICAgICAgICAgIGlmIChwYXlsb2FkLnRpbWVsaW5lUmVuZGVyaW5nVHlwZSAhPT0gVGltZWxpbmVSZW5kZXJpbmdUeXBlLlRocmVhZCkgcmV0dXJuO1xuICAgICAgICAgICAgICAgIC8vIFF1aXQgZWFybHkgaWYgdGhhdCdzIG5vdCBhIHRocmVhZCBldmVudFxuICAgICAgICAgICAgICAgIGlmIChwYXlsb2FkLmV2ZW50ICYmICFwYXlsb2FkLmV2ZW50LmdldFRocmVhZCgpKSByZXR1cm47XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIGVkaXRTdGF0ZTogcGF5bG9hZC5ldmVudCA/IG5ldyBFZGl0b3JTdGF0ZVRyYW5zZmVyKHBheWxvYWQuZXZlbnQpIDogbnVsbCxcbiAgICAgICAgICAgICAgICB9LCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXlsb2FkLmV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRpbWVsaW5lUGFuZWxSZWYuY3VycmVudD8uc2Nyb2xsVG9FdmVudElmTmVlZGVkKHBheWxvYWQuZXZlbnQuZ2V0SWQoKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3JlcGx5X3RvX2V2ZW50JzpcbiAgICAgICAgICAgICAgICBpZiAocGF5bG9hZC5jb250ZXh0ID09PSBUaW1lbGluZVJlbmRlcmluZ1R5cGUuVGhyZWFkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVwbHlUb0V2ZW50OiBwYXlsb2FkLmV2ZW50LFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHByaXZhdGUgc2V0dXBUaHJlYWQgPSAobXhFdjogTWF0cml4RXZlbnQpID0+IHtcbiAgICAgICAgbGV0IHRocmVhZCA9IHRoaXMucHJvcHMucm9vbS50aHJlYWRzLmdldChteEV2LmdldElkKCkpO1xuICAgICAgICBpZiAoIXRocmVhZCkge1xuICAgICAgICAgICAgY29uc3QgY2xpZW50ID0gTWF0cml4Q2xpZW50UGVnLmdldCgpO1xuICAgICAgICAgICAgLy8gRG8gbm90IGF0dGFjaCB0aGlzIHRocmVhZCBvYmplY3QgdG8gdGhlIGV2ZW50IGZvciBub3dcbiAgICAgICAgICAgIC8vIFRPRE86IFdoZW4gbG9jYWwgZWNobyBnZXRzIHJlaW50cm9kdWNlZCBpdCB3aWxsIGJlIGltcG9ydGFudFxuICAgICAgICAgICAgLy8gdG8gYWRkIHRoYXQgYmFjayBpbiwgYW5kIHRoZSB0aHJlYWRzIG1vZGVsIHNob3VsZCBnbyB0aHJvdWdoIHRoZVxuICAgICAgICAgICAgLy8gc2FtZSByZWNvbmNpbGlhdGlvbiBhbGdvcml0aG0gYXMgZXZlbnRzXG4gICAgICAgICAgICB0aHJlYWQgPSBuZXcgVGhyZWFkKFxuICAgICAgICAgICAgICAgIFtteEV2XSxcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLnJvb20sXG4gICAgICAgICAgICAgICAgY2xpZW50LFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJlYWQub24oVGhyZWFkRXZlbnQuVXBkYXRlLCB0aGlzLnVwZGF0ZVRocmVhZCk7XG4gICAgICAgIHRocmVhZC5vbmNlKFRocmVhZEV2ZW50LlJlYWR5LCB0aGlzLnVwZGF0ZVRocmVhZCk7XG4gICAgICAgIHRoaXMudXBkYXRlVGhyZWFkKHRocmVhZCk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgdGVhcmRvd25UaHJlYWQgPSAoKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLnRocmVhZCkge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZS50aHJlYWQucmVtb3ZlTGlzdGVuZXIoVGhyZWFkRXZlbnQuVXBkYXRlLCB0aGlzLnVwZGF0ZVRocmVhZCk7XG4gICAgICAgICAgICB0aGlzLnN0YXRlLnRocmVhZC5yZW1vdmVMaXN0ZW5lcihUaHJlYWRFdmVudC5SZWFkeSwgdGhpcy51cGRhdGVUaHJlYWQpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25OZXdUaHJlYWQgPSAodGhyZWFkOiBUaHJlYWQpID0+IHtcbiAgICAgICAgaWYgKHRocmVhZC5pZCA9PT0gdGhpcy5wcm9wcy5teEV2ZW50LmdldElkKCkpIHtcbiAgICAgICAgICAgIHRoaXMudGVhcmRvd25UaHJlYWQoKTtcbiAgICAgICAgICAgIHRoaXMuc2V0dXBUaHJlYWQodGhpcy5wcm9wcy5teEV2ZW50KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwcml2YXRlIHVwZGF0ZVRocmVhZCA9ICh0aHJlYWQ/OiBUaHJlYWQpID0+IHtcbiAgICAgICAgaWYgKHRocmVhZCkge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgdGhyZWFkLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnRpbWVsaW5lUGFuZWxSZWYuY3VycmVudD8ucmVmcmVzaFRpbWVsaW5lKCk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25TY3JvbGwgPSAoKTogdm9pZCA9PiB7XG4gICAgICAgIGlmICh0aGlzLnByb3BzLmluaXRpYWxFdmVudCAmJiB0aGlzLnByb3BzLmluaXRpYWxFdmVudEhpZ2hsaWdodGVkKSB7XG4gICAgICAgICAgICBkaXMuZGlzcGF0Y2goe1xuICAgICAgICAgICAgICAgIGFjdGlvbjogQWN0aW9uLlZpZXdSb29tLFxuICAgICAgICAgICAgICAgIHJvb21faWQ6IHRoaXMucHJvcHMucm9vbS5yb29tSWQsXG4gICAgICAgICAgICAgICAgZXZlbnRfaWQ6IHRoaXMucHJvcHMuaW5pdGlhbEV2ZW50Py5nZXRJZCgpLFxuICAgICAgICAgICAgICAgIGhpZ2hsaWdodGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICByZXBseWluZ1RvRXZlbnQ6IHRoaXMuc3RhdGUucmVwbHlUb0V2ZW50LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcHJpdmF0ZSByZW5kZXJUaHJlYWRWaWV3SGVhZGVyID0gKCk6IEpTWC5FbGVtZW50ID0+IHtcbiAgICAgICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwibXhfVGhyZWFkUGFuZWxfX2hlYWRlclwiPlxuICAgICAgICAgICAgPHNwYW4+eyBfdChcIlRocmVhZFwiKSB9PC9zcGFuPlxuICAgICAgICAgICAgPFRocmVhZExpc3RDb250ZXh0TWVudVxuICAgICAgICAgICAgICAgIG14RXZlbnQ9e3RoaXMucHJvcHMubXhFdmVudH1cbiAgICAgICAgICAgICAgICBwZXJtYWxpbmtDcmVhdG9yPXt0aGlzLnByb3BzLnBlcm1hbGlua0NyZWF0b3J9IC8+XG4gICAgICAgIDwvZGl2PjtcbiAgICB9O1xuXG4gICAgcHVibGljIHJlbmRlcigpOiBKU1guRWxlbWVudCB7XG4gICAgICAgIGNvbnN0IGhpZ2hsaWdodGVkRXZlbnRJZCA9IHRoaXMucHJvcHMuaW5pdGlhbEV2ZW50SGlnaGxpZ2h0ZWRcbiAgICAgICAgICAgID8gdGhpcy5wcm9wcy5pbml0aWFsRXZlbnQ/LmdldElkKClcbiAgICAgICAgICAgIDogbnVsbDtcblxuICAgICAgICBjb25zdCB0aHJlYWRSZWxhdGlvbjogSUV2ZW50UmVsYXRpb24gPSB7XG4gICAgICAgICAgICByZWxfdHlwZTogUmVsYXRpb25UeXBlLlRocmVhZCxcbiAgICAgICAgICAgIGV2ZW50X2lkOiB0aGlzLnN0YXRlLnRocmVhZD8uaWQsXG4gICAgICAgIH07XG5cbiAgICAgICAgbGV0IHByZXZpb3VzUGhhc2UgPSBSaWdodFBhbmVsU3RvcmUuZ2V0U2hhcmVkSW5zdGFuY2UoKS5wcmV2aW91c1BoYXNlO1xuICAgICAgICBpZiAoIVNldHRpbmdzU3RvcmUuZ2V0VmFsdWUoXCJmZWF0dXJlX21heGltaXNlZF93aWRnZXRzXCIpKSB7XG4gICAgICAgICAgICBwcmV2aW91c1BoYXNlID0gUmlnaHRQYW5lbFBoYXNlcy5UaHJlYWRQYW5lbDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGNoYW5nZSB0aGUgcHJldmlvdXMgcGhhc2UgdG8gdGhlIHRocmVhZFBhbmVsIGluIGNhc2UgdGhlcmUgaXMgbm8gbWF4aW1pc2VkIHdpZGdldCBhbnltb3JlXG4gICAgICAgIGlmICghV2lkZ2V0TGF5b3V0U3RvcmUuaW5zdGFuY2UuaGFzTWF4aW1pc2VkV2lkZ2V0KHRoaXMucHJvcHMucm9vbSkpIHtcbiAgICAgICAgICAgIHByZXZpb3VzUGhhc2UgPSBSaWdodFBhbmVsUGhhc2VzLlRocmVhZFBhbmVsO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTWFrZSBzdXJlIHRoZSBwcmV2aW91cyBQaGFzZSBpcyBhbHdheXMgb25lIG9mIHRoZSB0d286IFRpbWVsaW5lIG9yIFRocmVhZFBhbmVsXG4gICAgICAgIGlmICghW1JpZ2h0UGFuZWxQaGFzZXMuVGhyZWFkUGFuZWwsIFJpZ2h0UGFuZWxQaGFzZXMuVGltZWxpbmVdLmluY2x1ZGVzKHByZXZpb3VzUGhhc2UpKSB7XG4gICAgICAgICAgICBwcmV2aW91c1BoYXNlID0gUmlnaHRQYW5lbFBoYXNlcy5UaHJlYWRQYW5lbDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwcmV2aW91c1BoYXNlTGFiZWxzID0ge307XG4gICAgICAgIHByZXZpb3VzUGhhc2VMYWJlbHNbUmlnaHRQYW5lbFBoYXNlcy5UaHJlYWRQYW5lbF0gPSBfdChcIkFsbCB0aHJlYWRzXCIpO1xuICAgICAgICBwcmV2aW91c1BoYXNlTGFiZWxzW1JpZ2h0UGFuZWxQaGFzZXMuVGltZWxpbmVdID0gX3QoXCJDaGF0XCIpO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8Um9vbUNvbnRleHQuUHJvdmlkZXIgdmFsdWU9e3tcbiAgICAgICAgICAgICAgICAuLi50aGlzLmNvbnRleHQsXG4gICAgICAgICAgICAgICAgdGltZWxpbmVSZW5kZXJpbmdUeXBlOiBUaW1lbGluZVJlbmRlcmluZ1R5cGUuVGhyZWFkLFxuICAgICAgICAgICAgICAgIGxpdmVUaW1lbGluZTogdGhpcy5zdGF0ZT8udGhyZWFkPy50aW1lbGluZVNldD8uZ2V0TGl2ZVRpbWVsaW5lKCksXG4gICAgICAgICAgICB9fT5cblxuICAgICAgICAgICAgICAgIDxCYXNlQ2FyZFxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJteF9UaHJlYWRWaWV3IG14X1RocmVhZFBhbmVsXCJcbiAgICAgICAgICAgICAgICAgICAgb25DbG9zZT17dGhpcy5wcm9wcy5vbkNsb3NlfVxuICAgICAgICAgICAgICAgICAgICBwcmV2aW91c1BoYXNlPXtwcmV2aW91c1BoYXNlfVxuICAgICAgICAgICAgICAgICAgICBwcmV2aW91c1BoYXNlTGFiZWw9e3ByZXZpb3VzUGhhc2VMYWJlbHNbcHJldmlvdXNQaGFzZV19XG4gICAgICAgICAgICAgICAgICAgIHdpdGhvdXRTY3JvbGxDb250YWluZXI9e3RydWV9XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcj17dGhpcy5yZW5kZXJUaHJlYWRWaWV3SGVhZGVyKCl9XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICB7IHRoaXMuc3RhdGUudGhyZWFkICYmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxUaW1lbGluZVBhbmVsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmPXt0aGlzLnRpbWVsaW5lUGFuZWxSZWZ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd1JlYWRSZWNlaXB0cz17ZmFsc2V9IC8vIE5vIFJSIHN1cHBvcnQgaW4gdGhyZWFkJ3MgTVZQXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFuYWdlUmVhZFJlY2VpcHRzPXtmYWxzZX0gLy8gTm8gUlIgc3VwcG9ydCBpbiB0aHJlYWQncyBNVlBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYW5hZ2VSZWFkTWFya2Vycz17ZmFsc2V9IC8vIE5vIFJNIHN1cHBvcnQgaW4gdGhyZWFkJ3MgTVZQXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VuZFJlYWRSZWNlaXB0T25Mb2FkPXtmYWxzZX0gLy8gTm8gUlIgc3VwcG9ydCBpbiB0aHJlYWQncyBNVlBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lbGluZVNldD17dGhpcy5zdGF0ZT8udGhyZWFkPy50aW1lbGluZVNldH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93VXJsUHJldmlldz17dHJ1ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aWxlU2hhcGU9e1RpbGVTaGFwZS5UaHJlYWR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0PXtMYXlvdXQuR3JvdXB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZVRocmVhZGVkTWVzc2FnZXM9e2ZhbHNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZGRlbj17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd1JlYWN0aW9ucz17dHJ1ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJteF9Sb29tVmlld19tZXNzYWdlUGFuZWwgbXhfR3JvdXBMYXlvdXRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcm1hbGlua0NyZWF0b3I9e3RoaXMucHJvcHMucGVybWFsaW5rQ3JlYXRvcn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZW1iZXJzTG9hZGVkPXt0cnVlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRTdGF0ZT17dGhpcy5zdGF0ZS5lZGl0U3RhdGV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRJZD17dGhpcy5wcm9wcy5pbml0aWFsRXZlbnQ/LmdldElkKCl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0ZWRFdmVudElkPXtoaWdobGlnaHRlZEV2ZW50SWR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25Vc2VyU2Nyb2xsPXt0aGlzLm9uU2Nyb2xsfVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgKSB9XG5cbiAgICAgICAgICAgICAgICAgICAgeyBDb250ZW50TWVzc2FnZXMuc2hhcmVkSW5zdGFuY2UoKS5nZXRDdXJyZW50VXBsb2Fkcyh0aHJlYWRSZWxhdGlvbikubGVuZ3RoID4gMCAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8VXBsb2FkQmFyIHJvb209e3RoaXMucHJvcHMucm9vbX0gcmVsYXRpb249e3RocmVhZFJlbGF0aW9ufSAvPlxuICAgICAgICAgICAgICAgICAgICApIH1cblxuICAgICAgICAgICAgICAgICAgICB7IHRoaXMuc3RhdGU/LnRocmVhZD8udGltZWxpbmVTZXQgJiYgKDxNZXNzYWdlQ29tcG9zZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvb209e3RoaXMucHJvcHMucm9vbX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc2l6ZU5vdGlmaWVyPXt0aGlzLnByb3BzLnJlc2l6ZU5vdGlmaWVyfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVsYXRpb249e3RocmVhZFJlbGF0aW9ufVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVwbHlUb0V2ZW50PXt0aGlzLnN0YXRlLnJlcGx5VG9FdmVudH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcm1hbGlua0NyZWF0b3I9e3RoaXMucHJvcHMucGVybWFsaW5rQ3JlYXRvcn1cbiAgICAgICAgICAgICAgICAgICAgICAgIGUyZVN0YXR1cz17dGhpcy5wcm9wcy5lMmVTdGF0dXN9XG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wYWN0PXt0cnVlfVxuICAgICAgICAgICAgICAgICAgICAvPikgfVxuICAgICAgICAgICAgICAgIDwvQmFzZUNhcmQ+XG4gICAgICAgICAgICA8L1Jvb21Db250ZXh0LlByb3ZpZGVyPlxuICAgICAgICApO1xuICAgIH1cbn1cbiJdfQ==