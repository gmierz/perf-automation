"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.RoomView = void 0;

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireWildcard(require("react"));

var _classnames = _interopRequireDefault(require("classnames"));

var _room = require("matrix-js-sdk/src/models/room");

var _shouldHideEvent = _interopRequireDefault(require("../../shouldHideEvent"));

var _languageHandler = require("../../languageHandler");

var _Permalinks = require("../../utils/permalinks/Permalinks");

var _ContentMessages = _interopRequireDefault(require("../../ContentMessages"));

var _Modal = _interopRequireDefault(require("../../Modal"));

var _CallHandler = _interopRequireDefault(require("../../CallHandler"));

var _dispatcher = _interopRequireDefault(require("../../dispatcher/dispatcher"));

var Rooms = _interopRequireWildcard(require("../../Rooms"));

var _Searching = _interopRequireWildcard(require("../../Searching"));

var _MainSplit = _interopRequireDefault(require("./MainSplit"));

var _RightPanel = _interopRequireDefault(require("./RightPanel"));

var _RoomViewStore = _interopRequireDefault(require("../../stores/RoomViewStore"));

var _RoomScrollStateStore = _interopRequireDefault(require("../../stores/RoomScrollStateStore"));

var _WidgetEchoStore = _interopRequireDefault(require("../../stores/WidgetEchoStore"));

var _SettingsStore = _interopRequireDefault(require("../../settings/SettingsStore"));

var _Layout = require("../../settings/enums/Layout");

var _AccessibleButton = _interopRequireDefault(require("../views/elements/AccessibleButton"));

var _RightPanelStore = _interopRequireDefault(require("../../stores/RightPanelStore"));

var _EventTile = require("../views/rooms/EventTile");

var _RoomContext = _interopRequireWildcard(require("../../contexts/RoomContext"));

var _MatrixClientContext = _interopRequireWildcard(require("../../contexts/MatrixClientContext"));

var _ShieldUtils = require("../../utils/ShieldUtils");

var _actions = require("../../dispatcher/actions");

var _ScrollPanel = _interopRequireDefault(require("./ScrollPanel"));

var _TimelinePanel = _interopRequireDefault(require("./TimelinePanel"));

var _ErrorBoundary = _interopRequireDefault(require("../views/elements/ErrorBoundary"));

var _RoomPreviewBar = _interopRequireDefault(require("../views/rooms/RoomPreviewBar"));

var _SearchBar = _interopRequireWildcard(require("../views/rooms/SearchBar"));

var _RoomUpgradeWarningBar = _interopRequireDefault(require("../views/rooms/RoomUpgradeWarningBar"));

var _AuxPanel = _interopRequireDefault(require("../views/rooms/AuxPanel"));

var _RoomHeader = _interopRequireDefault(require("../views/rooms/RoomHeader"));

var _EffectsOverlay = _interopRequireDefault(require("../views/elements/EffectsOverlay"));

var _utils = require("../../effects/utils");

var _effects = require("../../effects");

var _WidgetStore = _interopRequireDefault(require("../../stores/WidgetStore"));

var _AsyncStore = require("../../stores/AsyncStore");

var _Notifier = _interopRequireDefault(require("../../Notifier"));

var _DesktopNotificationsToast = require("../../toasts/DesktopNotificationsToast");

var _RoomNotificationStateStore = require("../../stores/notifications/RoomNotificationStateStore");

var _WidgetLayoutStore = require("../../stores/widgets/WidgetLayoutStore");

var _KeyBindingsManager = require("../../KeyBindingsManager");

var _objects = require("../../utils/objects");

var _SpaceRoomView = _interopRequireDefault(require("./SpaceRoomView"));

var _replaceableComponent = require("../../utils/replaceableComponent");

var _EditorStateTransfer = _interopRequireDefault(require("../../utils/EditorStateTransfer"));

var _lodash = require("lodash");

var _ErrorDialog = _interopRequireDefault(require("../views/dialogs/ErrorDialog"));

var _SearchResultTile = _interopRequireDefault(require("../views/rooms/SearchResultTile"));

var _Spinner = _interopRequireDefault(require("../views/elements/Spinner"));

var _UploadBar = _interopRequireDefault(require("./UploadBar"));

var _RoomStatusBar = _interopRequireDefault(require("./RoomStatusBar"));

var _MessageComposer = _interopRequireDefault(require("../views/rooms/MessageComposer"));

var _JumpToBottomButton = _interopRequireDefault(require("../views/rooms/JumpToBottomButton"));

var _TopUnreadMessagesBar = _interopRequireDefault(require("../views/rooms/TopUnreadMessagesBar"));

var _SpaceStore = _interopRequireDefault(require("../../stores/spaces/SpaceStore"));

var _logger = require("matrix-js-sdk/src/logger");

var _threads = require("../../dispatcher/dispatch-actions/threads");

var _EventUtils = require("../../utils/EventUtils");

var _ComposerInsertPayload = require("../../dispatcher/payloads/ComposerInsertPayload");

var _AppsDrawer = _interopRequireDefault(require("../views/rooms/AppsDrawer"));

var _RightPanelStorePhases = require("../../stores/RightPanelStorePhases");

const _excluded = ["upgradeRecommendation"],
      _excluded2 = ["upgradeRecommendation"];

var _dec, _class, _class2, _temp;

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

const DEBUG = false;

let debuglog = function (msg) {};

const BROWSER_SUPPORTS_SANDBOX = ('sandbox' in document.createElement('iframe'));

if (DEBUG) {
  // using bind means that we get to keep useful line numbers in the console
  debuglog = _logger.logger.log.bind(console);
}

// This defines the content of the mainSplit.
// If the mainSplit does not contain the Timeline, the chat is shown in the right panel.
var MainSplitContentType;

(function (MainSplitContentType) {
  MainSplitContentType[MainSplitContentType["Timeline"] = 0] = "Timeline";
  MainSplitContentType[MainSplitContentType["MaximisedWidget"] = 1] = "MaximisedWidget";
})(MainSplitContentType || (MainSplitContentType = {}));

let RoomView = (_dec = (0, _replaceableComponent.replaceableComponent)("structures.RoomView"), _dec(_class = (_temp = _class2 = class RoomView extends _react.default.Component {
  constructor(props, context) {
    super(props, context);
    (0, _defineProperty2.default)(this, "dispatcherRef", void 0);
    (0, _defineProperty2.default)(this, "roomStoreToken", void 0);
    (0, _defineProperty2.default)(this, "rightPanelStoreToken", void 0);
    (0, _defineProperty2.default)(this, "settingWatchers", void 0);
    (0, _defineProperty2.default)(this, "unmounted", false);
    (0, _defineProperty2.default)(this, "permalinkCreators", {});
    (0, _defineProperty2.default)(this, "searchId", void 0);
    (0, _defineProperty2.default)(this, "roomView", /*#__PURE__*/(0, _react.createRef)());
    (0, _defineProperty2.default)(this, "searchResultsPanel", /*#__PURE__*/(0, _react.createRef)());
    (0, _defineProperty2.default)(this, "messagePanel", void 0);
    (0, _defineProperty2.default)(this, "onWidgetStoreUpdate", () => {
      if (!this.state.room) return;
      this.checkWidgets(this.state.room);
    });
    (0, _defineProperty2.default)(this, "onWidgetEchoStoreUpdate", () => {
      if (!this.state.room) return;
      this.checkWidgets(this.state.room);
    });
    (0, _defineProperty2.default)(this, "onWidgetLayoutChange", () => {
      if (!this.state.room) return;

      if (_WidgetLayoutStore.WidgetLayoutStore.instance.hasMaximisedWidget(this.state.room)) {
        // Show chat in right panel when a widget is maximised
        _dispatcher.default.dispatch({
          action: _actions.Action.SetRightPanelPhase,
          phase: _RightPanelStorePhases.RightPanelPhases.Timeline
        });
      }

      this.checkWidgets(this.state.room);
      this.checkRightPanel(this.state.room);
    });
    (0, _defineProperty2.default)(this, "checkWidgets", room => {
      this.setState({
        hasPinnedWidgets: _WidgetLayoutStore.WidgetLayoutStore.instance.hasPinnedWidgets(room),
        mainSplitContentType: this.getMainSplitContentType(room),
        showApps: this.shouldShowApps(room)
      });
    });
    (0, _defineProperty2.default)(this, "getMainSplitContentType", room => {
      // TODO-video check if video should be displayed in main panel
      return _WidgetLayoutStore.WidgetLayoutStore.instance.hasMaximisedWidget(room) ? MainSplitContentType.MaximisedWidget : MainSplitContentType.Timeline;
    });
    (0, _defineProperty2.default)(this, "checkRightPanel", room => {
      // This is a hack to hide the chat. This should not be necessary once the right panel
      // phase is stored per room. (need to be done after check widget so that mainSplitContentType is updated)
      if (_RightPanelStore.default.getSharedInstance().roomPanelPhase === _RightPanelStorePhases.RightPanelPhases.Timeline && this.state.showRightPanel && !_WidgetLayoutStore.WidgetLayoutStore.instance.hasMaximisedWidget(this.state.room)) {
        // Two timelines are shown prevent this by hiding the right panel
        _dispatcher.default.dispatch({
          action: _actions.Action.ToggleRightPanel,
          type: "room"
        });
      }
    });
    (0, _defineProperty2.default)(this, "onReadReceiptsChange", () => {
      this.setState({
        showReadReceipts: _SettingsStore.default.getValue("showReadReceipts", this.state.roomId)
      });
    });
    (0, _defineProperty2.default)(this, "onRoomViewStoreUpdate", async initial => {
      if (this.unmounted) {
        return;
      }

      if (!initial && this.state.roomId !== _RoomViewStore.default.getRoomId()) {
        // RoomView explicitly does not support changing what room
        // is being viewed: instead it should just be re-mounted when
        // switching rooms. Therefore, if the room ID changes, we
        // ignore this. We either need to do this or add code to handle
        // saving the scroll position (otherwise we end up saving the
        // scroll position against the wrong room).
        // Given that doing the setState here would cause a bunch of
        // unnecessary work, we just ignore the change since we know
        // that if the current room ID has changed from what we thought
        // it was, it means we're about to be unmounted.
        return;
      }

      const roomId = _RoomViewStore.default.getRoomId();

      const newState = {
        roomId,
        roomAlias: _RoomViewStore.default.getRoomAlias(),
        roomLoading: _RoomViewStore.default.isRoomLoading(),
        roomLoadError: _RoomViewStore.default.getRoomLoadError(),
        joining: _RoomViewStore.default.isJoining(),
        replyToEvent: _RoomViewStore.default.getQuotingEvent(),
        // we should only peek once we have a ready client
        shouldPeek: this.state.matrixClientIsReady && _RoomViewStore.default.shouldPeek(),
        showReadReceipts: _SettingsStore.default.getValue("showReadReceipts", roomId),
        showRedactions: _SettingsStore.default.getValue("showRedactions", roomId),
        showJoinLeaves: _SettingsStore.default.getValue("showJoinLeaves", roomId),
        showAvatarChanges: _SettingsStore.default.getValue("showAvatarChanges", roomId),
        showDisplaynameChanges: _SettingsStore.default.getValue("showDisplaynameChanges", roomId),
        wasContextSwitch: _RoomViewStore.default.getWasContextSwitch()
      };

      const initialEventId = _RoomViewStore.default.getInitialEventId();

      if (initialEventId) {
        var _initialEvent, _initialEvent2;

        const room = this.context.getRoom(roomId);
        let initialEvent = room === null || room === void 0 ? void 0 : room.findEventById(initialEventId); // The event does not exist in the current sync data
        // We need to fetch it to know whether to route this request
        // to the main timeline or to a threaded one
        // In the current state, if a thread does not exist in the sync data
        // We will only display the event targeted by the `matrix.to` link
        // and the root event.
        // The rest will be lost for now, until the aggregation API on the server
        // becomes available to fetch a whole thread

        if (!initialEvent) {
          initialEvent = await (0, _EventUtils.fetchInitialEvent)(this.context, roomId, initialEventId);
        }

        const thread = (_initialEvent = initialEvent) === null || _initialEvent === void 0 ? void 0 : _initialEvent.getThread();

        if (thread && !((_initialEvent2 = initialEvent) !== null && _initialEvent2 !== void 0 && _initialEvent2.isThreadRoot)) {
          (0, _threads.dispatchShowThreadEvent)(thread.rootEvent, initialEvent, _RoomViewStore.default.isInitialEventHighlighted());
        } else {
          var _initialEvent3;

          newState.initialEventId = initialEventId;
          newState.isInitialEventHighlighted = _RoomViewStore.default.isInitialEventHighlighted();

          if (thread && (_initialEvent3 = initialEvent) !== null && _initialEvent3 !== void 0 && _initialEvent3.isThreadRoot) {
            (0, _threads.dispatchShowThreadEvent)(thread.rootEvent, initialEvent, _RoomViewStore.default.isInitialEventHighlighted());
          }
        }
      } // Add watchers for each of the settings we just looked up


      this.settingWatchers = this.settingWatchers.concat([_SettingsStore.default.watchSetting("showReadReceipts", roomId, (...[,,, value]) => this.setState({
        showReadReceipts: value
      })), _SettingsStore.default.watchSetting("showRedactions", roomId, (...[,,, value]) => this.setState({
        showRedactions: value
      })), _SettingsStore.default.watchSetting("showJoinLeaves", roomId, (...[,,, value]) => this.setState({
        showJoinLeaves: value
      })), _SettingsStore.default.watchSetting("showAvatarChanges", roomId, (...[,,, value]) => this.setState({
        showAvatarChanges: value
      })), _SettingsStore.default.watchSetting("showDisplaynameChanges", roomId, (...[,,, value]) => this.setState({
        showDisplaynameChanges: value
      }))]);

      if (!initial && this.state.shouldPeek && !newState.shouldPeek) {
        // Stop peeking because we have joined this room now
        this.context.stopPeeking();
      } // Temporary logging to diagnose https://github.com/vector-im/element-web/issues/4307


      _logger.logger.log('RVS update:', newState.roomId, newState.roomAlias, 'loading?', newState.roomLoading, 'joining?', newState.joining, 'initial?', initial, 'shouldPeek?', newState.shouldPeek); // NB: This does assume that the roomID will not change for the lifetime of
      // the RoomView instance


      if (initial) {
        newState.room = this.context.getRoom(newState.roomId);

        if (newState.room) {
          newState.showApps = this.shouldShowApps(newState.room);
          this.onRoomLoaded(newState.room);
        }
      }

      if (this.state.roomId === null && newState.roomId !== null) {
        // Get the scroll state for the new room
        // If an event ID wasn't specified, default to the one saved for this room
        // in the scroll state store. Assume initialEventPixelOffset should be set.
        if (!newState.initialEventId) {
          const roomScrollState = _RoomScrollStateStore.default.getScrollState(newState.roomId);

          if (roomScrollState) {
            newState.initialEventId = roomScrollState.focussedEvent;
            newState.initialEventPixelOffset = roomScrollState.pixelOffset;
          }
        }
      } // Clear the search results when clicking a search result (which changes the
      // currently scrolled to event, this.state.initialEventId).


      if (this.state.initialEventId !== newState.initialEventId) {
        newState.searchResults = null;
      }

      this.setState(newState); // At this point, newState.roomId could be null (e.g. the alias might not
      // have been resolved yet) so anything called here must handle this case.
      // We pass the new state into this function for it to read: it needs to
      // observe the new state but we don't want to put it in the setState
      // callback because this would prevent the setStates from being batched,
      // ie. cause it to render RoomView twice rather than the once that is necessary.

      if (initial) {
        this.setupRoom(newState.room, newState.roomId, newState.joining, newState.shouldPeek);
      }
    });
    (0, _defineProperty2.default)(this, "getRoomId", () => {
      // According to `onRoomViewStoreUpdate`, `state.roomId` can be null
      // if we have a room alias we haven't resolved yet. To work around this,
      // first we'll try the room object if it's there, and then fallback to
      // the bare room ID. (We may want to update `state.roomId` after
      // resolving aliases, so we could always trust it.)
      return this.state.room ? this.state.room.roomId : this.state.roomId;
    });
    (0, _defineProperty2.default)(this, "onUserScroll", () => {
      if (this.state.initialEventId && this.state.isInitialEventHighlighted) {
        _dispatcher.default.dispatch({
          action: _actions.Action.ViewRoom,
          room_id: this.state.room.roomId,
          event_id: this.state.initialEventId,
          highlighted: false,
          replyingToEvent: this.state.replyToEvent
        });
      }
    });
    (0, _defineProperty2.default)(this, "onRightPanelStoreUpdate", () => {
      this.setState({
        showRightPanel: _RightPanelStore.default.getSharedInstance().isOpenForRoom
      });
    });
    (0, _defineProperty2.default)(this, "onPageUnload", event => {
      if (_ContentMessages.default.sharedInstance().getCurrentUploads().length > 0) {
        return event.returnValue = (0, _languageHandler._t)("You seem to be uploading files, are you sure you want to quit?");
      } else if (this.getCallForRoom() && this.state.callState !== 'ended') {
        return event.returnValue = (0, _languageHandler._t)("You seem to be in a call, are you sure you want to quit?");
      }
    });
    (0, _defineProperty2.default)(this, "onReactKeyDown", ev => {
      let handled = false;
      const action = (0, _KeyBindingsManager.getKeyBindingsManager)().getRoomAction(ev);

      switch (action) {
        case _KeyBindingsManager.RoomAction.DismissReadMarker:
          this.messagePanel.forgetReadMarker();
          this.jumpToLiveTimeline();
          handled = true;
          break;

        case _KeyBindingsManager.RoomAction.JumpToOldestUnread:
          this.jumpToReadMarker();
          handled = true;
          break;

        case _KeyBindingsManager.RoomAction.UploadFile:
          _dispatcher.default.dispatch({
            action: "upload_file"
          }, true);

          handled = true;
          break;
      }

      if (handled) {
        ev.stopPropagation();
        ev.preventDefault();
      }
    });
    (0, _defineProperty2.default)(this, "onAction", payload => {
      switch (payload.action) {
        case 'message_sent':
          this.checkDesktopNotifications();
          break;

        case 'post_sticker_message':
          this.injectSticker(payload.data.content.url, payload.data.content.info, payload.data.description || payload.data.name);
          break;

        case 'picture_snapshot':
          _ContentMessages.default.sharedInstance().sendContentListToRoom([payload.file], this.state.room.roomId, null, this.context);

          break;

        case 'notifier_enabled':
        case _actions.Action.UploadStarted:
        case _actions.Action.UploadFinished:
        case _actions.Action.UploadCanceled:
          this.forceUpdate();
          break;

        case 'call_state':
          {
            // don't filter out payloads for room IDs other than props.room because
            // we may be interested in the conf 1:1 room
            if (!payload.room_id) {
              return;
            }

            const call = this.getCallForRoom();
            this.setState({
              callState: call ? call.state : null
            });
            break;
          }

        case 'appsDrawer':
          this.setState({
            showApps: payload.show
          });
          break;

        case 'reply_to_event':
          if (this.state.searchResults && payload.event.getRoomId() === this.state.roomId && !this.unmounted && payload.context === _RoomContext.TimelineRenderingType.Room) {
            this.onCancelSearchClick();
          }

          break;

        case 'quote':
          if (this.state.searchResults) {
            const roomId = payload.event.getRoomId();

            if (roomId === this.state.roomId) {
              this.onCancelSearchClick();
            }

            setImmediate(() => {
              _dispatcher.default.dispatch({
                action: _actions.Action.ViewRoom,
                room_id: roomId,
                deferred_action: payload
              });
            });
          }

          break;

        case 'sync_state':
          if (!this.state.matrixClientIsReady) {
            this.setState({
              matrixClientIsReady: this.context && this.context.isInitialSyncComplete()
            }, () => {
              // send another "initial" RVS update to trigger peeking if needed
              this.onRoomViewStoreUpdate(true);
            });
          }

          break;

        case 'focus_search':
          this.onSearchClick();
          break;

        case _actions.Action.EditEvent:
          {
            // Quit early if we're trying to edit events in wrong rendering context
            if (payload.timelineRenderingType !== this.state.timelineRenderingType) return;
            const editState = payload.event ? new _EditorStateTransfer.default(payload.event) : null;
            this.setState({
              editState
            }, () => {
              if (payload.event) {
                var _this$messagePanel;

                (_this$messagePanel = this.messagePanel) === null || _this$messagePanel === void 0 ? void 0 : _this$messagePanel.scrollToEventIfNeeded(payload.event.getId());
              }
            });
            break;
          }

        case _actions.Action.ComposerInsert:
          {
            if (payload.composerType) break; // re-dispatch to the correct composer

            _dispatcher.default.dispatch(_objectSpread(_objectSpread({}, payload), {}, {
              composerType: this.state.editState ? _ComposerInsertPayload.ComposerType.Edit : _ComposerInsertPayload.ComposerType.Send
            }));

            break;
          }

        case _actions.Action.FocusAComposer:
          {
            // re-dispatch to the correct composer
            _dispatcher.default.fire(this.state.editState ? _actions.Action.FocusEditMessageComposer : _actions.Action.FocusSendMessageComposer);

            break;
          }

        case "scroll_to_bottom":
          if (payload.timelineRenderingType === this.context.timelineRenderingType) {
            var _this$messagePanel2;

            (_this$messagePanel2 = this.messagePanel) === null || _this$messagePanel2 === void 0 ? void 0 : _this$messagePanel2.jumpToLiveTimeline();
          }

          break;
      }
    });
    (0, _defineProperty2.default)(this, "onRoomTimeline", (ev, room, toStartOfTimeline, removed, data) => {
      var _this$state$room;

      if (this.unmounted) return; // ignore events for other rooms

      if (!room || room.roomId !== ((_this$state$room = this.state.room) === null || _this$state$room === void 0 ? void 0 : _this$state$room.roomId)) return; // ignore events from filtered timelines

      if (data.timeline.getTimelineSet() !== room.getUnfilteredTimelineSet()) return;

      if (ev.getType() === "org.matrix.room.preview_urls") {
        this.updatePreviewUrlVisibility(room);
      }

      if (ev.getType() === "m.room.encryption") {
        this.updateE2EStatus(room);
      } // ignore anything but real-time updates at the end of the room:
      // updates from pagination will happen when the paginate completes.


      if (toStartOfTimeline || !data || !data.liveEvent) return; // no point handling anything while we're waiting for the join to finish:
      // we'll only be showing a spinner.

      if (this.state.joining) return;

      if (!ev.isBeingDecrypted() && !ev.isDecryptionFailure()) {
        this.handleEffects(ev);
      }

      if (ev.getSender() !== this.context.credentials.userId) {
        // update unread count when scrolled up
        if (!this.state.searchResults && this.state.atEndOfLiveTimeline) {// no change
        } else if (!(0, _shouldHideEvent.default)(ev, this.state)) {
          this.setState((state, props) => {
            return {
              numUnreadMessages: state.numUnreadMessages + 1
            };
          });
        }
      }
    });
    (0, _defineProperty2.default)(this, "onEventDecrypted", ev => {
      if (!this.state.room || !this.state.matrixClientIsReady) return; // not ready at all

      if (ev.getRoomId() !== this.state.room.roomId) return; // not for us

      if (ev.isDecryptionFailure()) return;
      this.handleEffects(ev);
    });
    (0, _defineProperty2.default)(this, "handleEffects", ev => {
      const notifState = _RoomNotificationStateStore.RoomNotificationStateStore.instance.getRoomState(this.state.room);

      if (!notifState.isUnread) return;

      _effects.CHAT_EFFECTS.forEach(effect => {
        if ((0, _utils.containsEmoji)(ev.getContent(), effect.emojis) || ev.getContent().msgtype === effect.msgType) {
          // For initial threads launch, chat effects are disabled
          // see #19731
          if (!_SettingsStore.default.getValue("feature_thread") || !ev.isThreadRelation) {
            _dispatcher.default.dispatch({
              action: `effects.${effect.command}`
            });
          }
        }
      });
    });
    (0, _defineProperty2.default)(this, "onRoomName", room => {
      if (this.state.room && room.roomId == this.state.room.roomId) {
        this.forceUpdate();
      }
    });
    (0, _defineProperty2.default)(this, "onKeyBackupStatus", () => {
      // Key backup status changes affect whether the in-room recovery
      // reminder is displayed.
      this.forceUpdate();
    });
    (0, _defineProperty2.default)(this, "canResetTimeline", () => {
      if (!this.messagePanel) {
        return true;
      }

      return this.messagePanel.canResetTimeline();
    });
    (0, _defineProperty2.default)(this, "onRoomLoaded", room => {
      if (this.unmounted) return; // Attach a widget store listener only when we get a room

      _WidgetLayoutStore.WidgetLayoutStore.instance.on(_WidgetLayoutStore.WidgetLayoutStore.emissionForRoom(room), this.onWidgetLayoutChange);

      this.calculatePeekRules(room);
      this.updatePreviewUrlVisibility(room);
      this.loadMembersIfJoined(room);
      this.calculateRecommendedVersion(room);
      this.updateE2EStatus(room);
      this.updatePermissions(room);
      this.checkWidgets(room);
      this.checkRightPanel(room);
      this.setState({
        liveTimeline: room.getLiveTimeline()
      });
    });
    (0, _defineProperty2.default)(this, "onRoom", room => {
      if (!room || room.roomId !== this.state.roomId) {
        return;
      } // Detach the listener if the room is changing for some reason


      if (this.state.room) {
        _WidgetLayoutStore.WidgetLayoutStore.instance.off(_WidgetLayoutStore.WidgetLayoutStore.emissionForRoom(this.state.room), this.onWidgetLayoutChange);
      }

      this.setState({
        room: room
      }, () => {
        this.onRoomLoaded(room);
      });
    });
    (0, _defineProperty2.default)(this, "onDeviceVerificationChanged", (userId, device) => {
      const room = this.state.room;

      if (!room.currentState.getMember(userId)) {
        return;
      }

      this.updateE2EStatus(room);
    });
    (0, _defineProperty2.default)(this, "onUserVerificationChanged", (userId, trustStatus) => {
      const room = this.state.room;

      if (!room || !room.currentState.getMember(userId)) {
        return;
      }

      this.updateE2EStatus(room);
    });
    (0, _defineProperty2.default)(this, "onCrossSigningKeysChanged", () => {
      const room = this.state.room;

      if (room) {
        this.updateE2EStatus(room);
      }
    });
    (0, _defineProperty2.default)(this, "onAccountData", event => {
      const type = event.getType();

      if ((type === "org.matrix.preview_urls" || type === "im.vector.web.settings") && this.state.room) {
        // non-e2ee url previews are stored in legacy event type `org.matrix.room.preview_urls`
        this.updatePreviewUrlVisibility(this.state.room);
      }
    });
    (0, _defineProperty2.default)(this, "onRoomAccountData", (event, room) => {
      if (room.roomId == this.state.roomId) {
        const type = event.getType();

        if (type === "org.matrix.room.preview_urls" || type === "im.vector.web.settings") {
          // non-e2ee url previews are stored in legacy event type `org.matrix.room.preview_urls`
          this.updatePreviewUrlVisibility(room);
        }
      }
    });
    (0, _defineProperty2.default)(this, "onRoomStateEvents", (ev, state) => {
      // ignore if we don't have a room yet
      if (!this.state.room || this.state.room.roomId !== state.roomId) {
        return;
      }

      this.updatePermissions(this.state.room);
    });
    (0, _defineProperty2.default)(this, "onRoomStateMember", (ev, state, member) => {
      // ignore if we don't have a room yet
      if (!this.state.room) {
        return;
      } // ignore members in other rooms


      if (member.roomId !== this.state.room.roomId) {
        return;
      }

      this.updateRoomMembers();
    });
    (0, _defineProperty2.default)(this, "onMyMembership", (room, membership, oldMembership) => {
      if (room.roomId === this.state.roomId) {
        this.forceUpdate();
        this.loadMembersIfJoined(room);
        this.updatePermissions(room);
      }
    });
    (0, _defineProperty2.default)(this, "updateRoomMembers", (0, _lodash.throttle)(() => {
      this.updateDMState();
      this.updateE2EStatus(this.state.room);
    }, 500, {
      leading: true,
      trailing: true
    }));
    (0, _defineProperty2.default)(this, "onSearchResultsFillRequest", backwards => {
      if (!backwards) {
        return Promise.resolve(false);
      }

      if (this.state.searchResults.next_batch) {
        debuglog("requesting more search results");
        const searchPromise = (0, _Searching.searchPagination)(this.state.searchResults);
        return this.handleSearchResult(searchPromise);
      } else {
        debuglog("no more search results");
        return Promise.resolve(false);
      }
    });
    (0, _defineProperty2.default)(this, "onInviteButtonClick", () => {
      // call AddressPickerDialog
      _dispatcher.default.dispatch({
        action: 'view_invite',
        roomId: this.state.room.roomId
      });
    });
    (0, _defineProperty2.default)(this, "onJoinButtonClicked", () => {
      // If the user is a ROU, allow them to transition to a PWLU
      if (this.context && this.context.isGuest()) {
        // Join this room once the user has registered and logged in
        // (If we failed to peek, we may not have a valid room object.)
        _dispatcher.default.dispatch({
          action: 'do_after_sync_prepared',
          deferred_action: {
            action: _actions.Action.ViewRoom,
            room_id: this.getRoomId()
          }
        });

        _dispatcher.default.dispatch({
          action: 'require_registration'
        });
      } else {
        Promise.resolve().then(() => {
          var _this$props$threepidI;

          const signUrl = (_this$props$threepidI = this.props.threepidInvite) === null || _this$props$threepidI === void 0 ? void 0 : _this$props$threepidI.signUrl;

          _dispatcher.default.dispatch({
            action: _actions.Action.JoinRoom,
            roomId: this.getRoomId(),
            opts: {
              inviteSignUrl: signUrl
            },
            _type: "unknown" // TODO: instrumentation

          });

          return Promise.resolve();
        });
      }
    });
    (0, _defineProperty2.default)(this, "onMessageListScroll", ev => {
      if (this.messagePanel.isAtEndOfLiveTimeline()) {
        this.setState({
          numUnreadMessages: 0,
          atEndOfLiveTimeline: true
        });
      } else {
        this.setState({
          atEndOfLiveTimeline: false
        });
      }

      this.updateTopUnreadMessagesBar();
    });
    (0, _defineProperty2.default)(this, "onDragEnter", ev => {
      ev.stopPropagation();
      ev.preventDefault(); // We always increment the counter no matter the types, because dragging is
      // still happening. If we didn't, the drag counter would get out of sync.

      this.setState({
        dragCounter: this.state.dragCounter + 1
      }); // See:
      // https://docs.w3cub.com/dom/datatransfer/types
      // https://developer.mozilla.org/en-US/docs/Web/API/HTML_Drag_and_Drop_API/Recommended_drag_types#file

      if (ev.dataTransfer.types.includes("Files") || ev.dataTransfer.types.includes("application/x-moz-file")) {
        this.setState({
          draggingFile: true
        });
      }
    });
    (0, _defineProperty2.default)(this, "onDragLeave", ev => {
      ev.stopPropagation();
      ev.preventDefault();
      this.setState({
        dragCounter: this.state.dragCounter - 1
      });

      if (this.state.dragCounter === 0) {
        this.setState({
          draggingFile: false
        });
      }
    });
    (0, _defineProperty2.default)(this, "onDragOver", ev => {
      ev.stopPropagation();
      ev.preventDefault();
      ev.dataTransfer.dropEffect = 'none'; // See:
      // https://docs.w3cub.com/dom/datatransfer/types
      // https://developer.mozilla.org/en-US/docs/Web/API/HTML_Drag_and_Drop_API/Recommended_drag_types#file

      if (ev.dataTransfer.types.includes("Files") || ev.dataTransfer.types.includes("application/x-moz-file")) {
        ev.dataTransfer.dropEffect = 'copy';
      }
    });
    (0, _defineProperty2.default)(this, "onDrop", ev => {
      ev.stopPropagation();
      ev.preventDefault();

      _ContentMessages.default.sharedInstance().sendContentListToRoom(ev.dataTransfer.files, this.state.room.roomId, null, this.context);

      _dispatcher.default.fire(_actions.Action.FocusSendMessageComposer);

      this.setState({
        draggingFile: false,
        dragCounter: this.state.dragCounter - 1
      });
    });
    (0, _defineProperty2.default)(this, "onSearch", (term, scope) => {
      this.setState({
        searchTerm: term,
        searchScope: scope,
        searchResults: {},
        searchHighlights: []
      }); // if we already have a search panel, we need to tell it to forget
      // about its scroll state.

      if (this.searchResultsPanel.current) {
        this.searchResultsPanel.current.resetScrollState();
      } // make sure that we don't end up showing results from
      // an aborted search by keeping a unique id.
      //
      // todo: should cancel any previous search requests.


      this.searchId = new Date().getTime();
      let roomId;
      if (scope === _SearchBar.SearchScope.Room) roomId = this.state.room.roomId;
      debuglog("sending search request");
      const searchPromise = (0, _Searching.default)(term, roomId);
      this.handleSearchResult(searchPromise);
    });
    (0, _defineProperty2.default)(this, "onCallPlaced", type => {
      _dispatcher.default.dispatch({
        action: 'place_call',
        type: type,
        room_id: this.state.room.roomId
      });
    });
    (0, _defineProperty2.default)(this, "onAppsClick", () => {
      _dispatcher.default.dispatch({
        action: "appsDrawer",
        show: !this.state.showApps
      });
    });
    (0, _defineProperty2.default)(this, "onForgetClick", () => {
      _dispatcher.default.dispatch({
        action: 'forget_room',
        room_id: this.state.room.roomId
      });
    });
    (0, _defineProperty2.default)(this, "onRejectButtonClicked", () => {
      this.setState({
        rejecting: true
      });
      this.context.leave(this.state.roomId).then(() => {
        _dispatcher.default.dispatch({
          action: 'view_home_page'
        });

        this.setState({
          rejecting: false
        });
      }, error => {
        _logger.logger.error("Failed to reject invite: %s", error);

        const msg = error.message ? error.message : JSON.stringify(error);

        _Modal.default.createTrackedDialog('Failed to reject invite', '', _ErrorDialog.default, {
          title: (0, _languageHandler._t)("Failed to reject invite"),
          description: msg
        });

        this.setState({
          rejecting: false,
          rejectError: error
        });
      });
    });
    (0, _defineProperty2.default)(this, "onRejectAndIgnoreClick", async () => {
      this.setState({
        rejecting: true
      });

      try {
        const myMember = this.state.room.getMember(this.context.getUserId());
        const inviteEvent = myMember.events.member;
        const ignoredUsers = this.context.getIgnoredUsers();
        ignoredUsers.push(inviteEvent.getSender()); // de-duped internally in the js-sdk

        await this.context.setIgnoredUsers(ignoredUsers);
        await this.context.leave(this.state.roomId);

        _dispatcher.default.dispatch({
          action: 'view_home_page'
        });

        this.setState({
          rejecting: false
        });
      } catch (error) {
        _logger.logger.error("Failed to reject invite: %s", error);

        const msg = error.message ? error.message : JSON.stringify(error);

        _Modal.default.createTrackedDialog('Failed to reject invite', '', _ErrorDialog.default, {
          title: (0, _languageHandler._t)("Failed to reject invite"),
          description: msg
        });

        this.setState({
          rejecting: false,
          rejectError: error
        });
      }
    });
    (0, _defineProperty2.default)(this, "onRejectThreepidInviteButtonClicked", () => {
      // We can reject 3pid invites in the same way that we accept them,
      // using /leave rather than /join. In the short term though, we
      // just ignore them.
      // https://github.com/vector-im/vector-web/issues/1134
      _dispatcher.default.fire(_actions.Action.ViewRoomDirectory);
    });
    (0, _defineProperty2.default)(this, "onSearchClick", () => {
      this.setState({
        searching: !this.state.searching
      });
    });
    (0, _defineProperty2.default)(this, "onCancelSearchClick", () => {
      this.setState({
        searching: false,
        searchResults: null
      });
    });
    (0, _defineProperty2.default)(this, "jumpToLiveTimeline", () => {
      if (this.state.initialEventId && this.state.isInitialEventHighlighted) {
        // If we were viewing a highlighted event, firing view_room without
        // an event will take care of both clearing the URL fragment and
        // jumping to the bottom
        _dispatcher.default.dispatch({
          action: _actions.Action.ViewRoom,
          room_id: this.state.room.roomId
        });
      } else {
        // Otherwise we have to jump manually
        this.messagePanel.jumpToLiveTimeline();

        _dispatcher.default.fire(_actions.Action.FocusSendMessageComposer);
      }
    });
    (0, _defineProperty2.default)(this, "jumpToReadMarker", () => {
      this.messagePanel.jumpToReadMarker();
    });
    (0, _defineProperty2.default)(this, "forgetReadMarker", ev => {
      ev.stopPropagation();
      this.messagePanel.forgetReadMarker();
    });
    (0, _defineProperty2.default)(this, "updateTopUnreadMessagesBar", () => {
      if (!this.messagePanel) {
        return;
      }

      const showBar = this.messagePanel.canJumpToReadMarker();

      if (this.state.showTopUnreadMessagesBar != showBar) {
        this.setState({
          showTopUnreadMessagesBar: showBar
        });
      }
    });
    (0, _defineProperty2.default)(this, "onStatusBarVisible", () => {
      if (this.unmounted || this.state.statusBarVisible) return;
      this.setState({
        statusBarVisible: true
      });
    });
    (0, _defineProperty2.default)(this, "onStatusBarHidden", () => {
      // This is currently not desired as it is annoying if it keeps expanding and collapsing
      if (this.unmounted || !this.state.statusBarVisible) return;
      this.setState({
        statusBarVisible: false
      });
    });
    (0, _defineProperty2.default)(this, "handleScrollKey", ev => {
      let panel;

      if (this.searchResultsPanel.current) {
        panel = this.searchResultsPanel.current;
      } else if (this.messagePanel) {
        panel = this.messagePanel;
      }

      if (panel) {
        panel.handleScrollKey(ev);
      }
    });
    (0, _defineProperty2.default)(this, "gatherTimelinePanelRef", r => {
      this.messagePanel = r;
    });
    (0, _defineProperty2.default)(this, "onHiddenHighlightsClick", () => {
      const oldRoom = this.getOldRoom();
      if (!oldRoom) return;

      _dispatcher.default.dispatch({
        action: "view_room",
        room_id: oldRoom.roomId
      });
    });
    const llMembers = this.context.hasLazyLoadMembersEnabled();
    this.state = {
      roomId: null,
      roomLoading: true,
      peekLoading: false,
      shouldPeek: true,
      membersLoaded: !llMembers,
      numUnreadMessages: 0,
      draggingFile: false,
      searching: false,
      searchResults: null,
      callState: null,
      guestsCanJoin: false,
      canPeek: false,
      showApps: false,
      isPeeking: false,
      showRightPanel: _RightPanelStore.default.getSharedInstance().isOpenForRoom,
      joining: false,
      atEndOfLiveTimeline: true,
      atEndOfLiveTimelineInit: false,
      showTopUnreadMessagesBar: false,
      statusBarVisible: false,
      canReact: false,
      canReply: false,
      layout: _SettingsStore.default.getValue("layout"),
      lowBandwidth: _SettingsStore.default.getValue("lowBandwidth"),
      alwaysShowTimestamps: _SettingsStore.default.getValue("alwaysShowTimestamps"),
      showTwelveHourTimestamps: _SettingsStore.default.getValue("showTwelveHourTimestamps"),
      readMarkerInViewThresholdMs: _SettingsStore.default.getValue("readMarkerInViewThresholdMs"),
      readMarkerOutOfViewThresholdMs: _SettingsStore.default.getValue("readMarkerOutOfViewThresholdMs"),
      showHiddenEventsInTimeline: _SettingsStore.default.getValue("showHiddenEventsInTimeline"),
      showReadReceipts: true,
      showRedactions: true,
      showJoinLeaves: true,
      showAvatarChanges: true,
      showDisplaynameChanges: true,
      matrixClientIsReady: this.context && this.context.isInitialSyncComplete(),
      mainSplitContentType: MainSplitContentType.Timeline,
      dragCounter: 0,
      timelineRenderingType: _RoomContext.TimelineRenderingType.Room,
      liveTimeline: undefined
    };
    this.dispatcherRef = _dispatcher.default.register(this.onAction);
    this.context.on("Room", this.onRoom);
    this.context.on("Room.timeline", this.onRoomTimeline);
    this.context.on("Room.name", this.onRoomName);
    this.context.on("Room.accountData", this.onRoomAccountData);
    this.context.on("RoomState.events", this.onRoomStateEvents);
    this.context.on("RoomState.members", this.onRoomStateMember);
    this.context.on("Room.myMembership", this.onMyMembership);
    this.context.on("accountData", this.onAccountData);
    this.context.on("crypto.keyBackupStatus", this.onKeyBackupStatus);
    this.context.on("deviceVerificationChanged", this.onDeviceVerificationChanged);
    this.context.on("userTrustStatusChanged", this.onUserVerificationChanged);
    this.context.on("crossSigning.keysChanged", this.onCrossSigningKeysChanged);
    this.context.on("Event.decrypted", this.onEventDecrypted); // Start listening for RoomViewStore updates

    this.roomStoreToken = _RoomViewStore.default.addListener(this.onRoomViewStoreUpdate);
    this.rightPanelStoreToken = _RightPanelStore.default.getSharedInstance().addListener(this.onRightPanelStoreUpdate);

    _WidgetEchoStore.default.on(_AsyncStore.UPDATE_EVENT, this.onWidgetEchoStoreUpdate);

    _WidgetStore.default.instance.on(_AsyncStore.UPDATE_EVENT, this.onWidgetStoreUpdate);

    this.settingWatchers = [_SettingsStore.default.watchSetting("layout", null, (...[,,, value]) => this.setState({
      layout: value
    })), _SettingsStore.default.watchSetting("lowBandwidth", null, (...[,,, value]) => this.setState({
      lowBandwidth: value
    })), _SettingsStore.default.watchSetting("alwaysShowTimestamps", null, (...[,,, value]) => this.setState({
      alwaysShowTimestamps: value
    })), _SettingsStore.default.watchSetting("showTwelveHourTimestamps", null, (...[,,, value]) => this.setState({
      showTwelveHourTimestamps: value
    })), _SettingsStore.default.watchSetting("readMarkerInViewThresholdMs", null, (...[,,, value]) => this.setState({
      readMarkerInViewThresholdMs: value
    })), _SettingsStore.default.watchSetting("readMarkerOutOfViewThresholdMs", null, (...[,,, value]) => this.setState({
      readMarkerOutOfViewThresholdMs: value
    })), _SettingsStore.default.watchSetting("showHiddenEventsInTimeline", null, (...[,,, value]) => this.setState({
      showHiddenEventsInTimeline: value
    }))];
  }

  getPermalinkCreatorForRoom(room) {
    if (this.permalinkCreators[room.roomId]) return this.permalinkCreators[room.roomId];
    this.permalinkCreators[room.roomId] = new _Permalinks.RoomPermalinkCreator(room);

    if (this.state.room && room.roomId === this.state.room.roomId) {
      // We want to watch for changes in the creator for the primary room in the view, but
      // don't need to do so for search results.
      this.permalinkCreators[room.roomId].start();
    } else {
      this.permalinkCreators[room.roomId].load();
    }

    return this.permalinkCreators[room.roomId];
  }

  stopAllPermalinkCreators() {
    if (!this.permalinkCreators) return;

    for (const roomId of Object.keys(this.permalinkCreators)) {
      this.permalinkCreators[roomId].stop();
    }
  }

  setupRoom(room, roomId, joining, shouldPeek) {
    // if this is an unknown room then we're in one of three states:
    // - This is a room we can peek into (search engine) (we can /peek)
    // - This is a room we can publicly join or were invited to. (we can /join)
    // - This is a room we cannot join at all. (no action can help us)
    // We can't try to /join because this may implicitly accept invites (!)
    // We can /peek though. If it fails then we present the join UI. If it
    // succeeds then great, show the preview (but we still may be able to /join!).
    // Note that peeking works by room ID and room ID only, as opposed to joining
    // which must be by alias or invite wherever possible (peeking currently does
    // not work over federation).
    // NB. We peek if we have never seen the room before (i.e. js-sdk does not know
    // about it). We don't peek in the historical case where we were joined but are
    // now not joined because the js-sdk peeking API will clobber our historical room,
    // making it impossible to indicate a newly joined room.
    if (!joining && roomId) {
      if (!room && shouldPeek) {
        _logger.logger.info("Attempting to peek into room %s", roomId);

        this.setState({
          peekLoading: true,
          isPeeking: true // this will change to false if peeking fails

        });
        this.context.peekInRoom(roomId).then(room => {
          if (this.unmounted) {
            return;
          }

          this.setState({
            room: room,
            peekLoading: false
          });
          this.onRoomLoaded(room);
        }).catch(err => {
          if (this.unmounted) {
            return;
          } // Stop peeking if anything went wrong


          this.setState({
            isPeeking: false
          }); // This won't necessarily be a MatrixError, but we duck-type
          // here and say if it's got an 'errcode' key with the right value,
          // it means we can't peek.

          if (err.errcode === "M_GUEST_ACCESS_FORBIDDEN" || err.errcode === 'M_FORBIDDEN') {
            // This is fine: the room just isn't peekable (we assume).
            this.setState({
              peekLoading: false
            });
          } else {
            throw err;
          }
        });
      } else if (room) {
        // Stop peeking because we have joined this room previously
        this.context.stopPeeking();
        this.setState({
          isPeeking: false
        });
      }
    }
  }

  shouldShowApps(room) {
    if (!BROWSER_SUPPORTS_SANDBOX || !room) return false; // Check if user has previously chosen to hide the app drawer for this
    // room. If so, do not show apps

    const hideWidgetKey = room.roomId + "_hide_widget_drawer";
    const hideWidgetDrawer = localStorage.getItem(hideWidgetKey); // If unset show the Tray
    // Otherwise (in case the user set hideWidgetDrawer by clicking the button) follow the parameter.

    const isManuallyShown = hideWidgetDrawer ? hideWidgetDrawer === "false" : true;

    const widgets = _WidgetLayoutStore.WidgetLayoutStore.instance.getContainerWidgets(room, _WidgetLayoutStore.Container.Top);

    return isManuallyShown && widgets.length > 0;
  }

  componentDidMount() {
    this.onRoomViewStoreUpdate(true);
    const call = this.getCallForRoom();
    const callState = call ? call.state : null;
    this.setState({
      callState: callState
    });
    window.addEventListener('beforeunload', this.onPageUnload);
  }

  shouldComponentUpdate(nextProps, nextState) {
    const hasPropsDiff = (0, _objects.objectHasDiff)(this.props, nextProps);
    const _this$state = this.state,
          {
      upgradeRecommendation
    } = _this$state,
          state = (0, _objectWithoutProperties2.default)(_this$state, _excluded);
    const {
      upgradeRecommendation: newUpgradeRecommendation
    } = nextState,
          newState = (0, _objectWithoutProperties2.default)(nextState, _excluded2);
    const hasStateDiff = (newUpgradeRecommendation === null || newUpgradeRecommendation === void 0 ? void 0 : newUpgradeRecommendation.needsUpgrade) !== (upgradeRecommendation === null || upgradeRecommendation === void 0 ? void 0 : upgradeRecommendation.needsUpgrade) || (0, _objects.objectHasDiff)(state, newState);
    return hasPropsDiff || hasStateDiff;
  }

  componentDidUpdate() {
    if (this.roomView.current) {
      const roomView = this.roomView.current;

      if (!roomView.ondrop) {
        roomView.addEventListener('drop', this.onDrop);
        roomView.addEventListener('dragover', this.onDragOver);
        roomView.addEventListener('dragenter', this.onDragEnter);
        roomView.addEventListener('dragleave', this.onDragLeave);
      }
    } // Note: We check the ref here with a flag because componentDidMount, despite
    // documentation, does not define our messagePanel ref. It looks like our spinner
    // in render() prevents the ref from being set on first mount, so we try and
    // catch the messagePanel when it does mount. Because we only want the ref once,
    // we use a boolean flag to avoid duplicate work.


    if (this.messagePanel && !this.state.atEndOfLiveTimelineInit) {
      this.setState({
        atEndOfLiveTimelineInit: true,
        atEndOfLiveTimeline: this.messagePanel.isAtEndOfLiveTimeline()
      });
    }
  }

  componentWillUnmount() {
    // set a boolean to say we've been unmounted, which any pending
    // promises can use to throw away their results.
    //
    // (We could use isMounted, but facebook have deprecated that.)
    this.unmounted = true; // update the scroll map before we get unmounted

    if (this.state.roomId) {
      _RoomScrollStateStore.default.setScrollState(this.state.roomId, this.getScrollState());
    }

    if (this.state.shouldPeek) {
      this.context.stopPeeking();
    } // stop tracking room changes to format permalinks


    this.stopAllPermalinkCreators();

    if (this.roomView.current) {
      // disconnect the D&D event listeners from the room view. This
      // is really just for hygiene - we're going to be
      // deleted anyway, so it doesn't matter if the event listeners
      // don't get cleaned up.
      const roomView = this.roomView.current;
      roomView.removeEventListener('drop', this.onDrop);
      roomView.removeEventListener('dragover', this.onDragOver);
      roomView.removeEventListener('dragenter', this.onDragEnter);
      roomView.removeEventListener('dragleave', this.onDragLeave);
    }

    _dispatcher.default.unregister(this.dispatcherRef);

    if (this.context) {
      this.context.removeListener("Room", this.onRoom);
      this.context.removeListener("Room.timeline", this.onRoomTimeline);
      this.context.removeListener("Room.name", this.onRoomName);
      this.context.removeListener("Room.accountData", this.onRoomAccountData);
      this.context.removeListener("RoomState.events", this.onRoomStateEvents);
      this.context.removeListener("Room.myMembership", this.onMyMembership);
      this.context.removeListener("RoomState.members", this.onRoomStateMember);
      this.context.removeListener("accountData", this.onAccountData);
      this.context.removeListener("crypto.keyBackupStatus", this.onKeyBackupStatus);
      this.context.removeListener("deviceVerificationChanged", this.onDeviceVerificationChanged);
      this.context.removeListener("userTrustStatusChanged", this.onUserVerificationChanged);
      this.context.removeListener("crossSigning.keysChanged", this.onCrossSigningKeysChanged);
      this.context.removeListener("Event.decrypted", this.onEventDecrypted);
    }

    window.removeEventListener('beforeunload', this.onPageUnload); // Remove RoomStore listener

    if (this.roomStoreToken) {
      this.roomStoreToken.remove();
    } // Remove RightPanelStore listener


    if (this.rightPanelStoreToken) {
      this.rightPanelStoreToken.remove();
    }

    _WidgetEchoStore.default.removeListener(_AsyncStore.UPDATE_EVENT, this.onWidgetEchoStoreUpdate);

    _WidgetStore.default.instance.removeListener(_AsyncStore.UPDATE_EVENT, this.onWidgetStoreUpdate);

    if (this.state.room) {
      _WidgetLayoutStore.WidgetLayoutStore.instance.off(_WidgetLayoutStore.WidgetLayoutStore.emissionForRoom(this.state.room), this.onWidgetLayoutChange);
    } // cancel any pending calls to the throttled updated


    this.updateRoomMembers.cancel();

    for (const watcher of this.settingWatchers) {
      _SettingsStore.default.unwatchSetting(watcher);
    }
  }

  async calculateRecommendedVersion(room) {
    const upgradeRecommendation = await room.getRecommendedVersion();
    if (this.unmounted) return;
    this.setState({
      upgradeRecommendation
    });
  }

  async loadMembersIfJoined(room) {
    // lazy load members if enabled
    if (this.context.hasLazyLoadMembersEnabled()) {
      if (room && room.getMyMembership() === 'join') {
        try {
          await room.loadMembersIfNeeded();

          if (!this.unmounted) {
            this.setState({
              membersLoaded: true
            });
          }
        } catch (err) {
          const errorMessage = `Fetching room members for ${room.roomId} failed.` + " Room members will appear incomplete.";

          _logger.logger.error(errorMessage);

          _logger.logger.error(err);
        }
      }
    }
  }

  calculatePeekRules(room) {
    const guestAccessEvent = room.currentState.getStateEvents("m.room.guest_access", "");

    if (guestAccessEvent && guestAccessEvent.getContent().guest_access === "can_join") {
      this.setState({
        guestsCanJoin: true
      });
    }

    const historyVisibility = room.currentState.getStateEvents("m.room.history_visibility", "");

    if (historyVisibility && historyVisibility.getContent().history_visibility === "world_readable") {
      this.setState({
        canPeek: true
      });
    }
  }

  updatePreviewUrlVisibility({
    roomId
  }) {
    // URL Previews in E2EE rooms can be a privacy leak so use a different setting which is per-room explicit
    const key = this.context.isRoomEncrypted(roomId) ? 'urlPreviewsEnabled_e2ee' : 'urlPreviewsEnabled';
    this.setState({
      showUrlPreview: _SettingsStore.default.getValue(key, roomId)
    });
  }

  async updateE2EStatus(room) {
    if (!this.context.isRoomEncrypted(room.roomId)) return; // If crypto is not currently enabled, we aren't tracking devices at all,
    // so we don't know what the answer is. Let's error on the safe side and show
    // a warning for this case.

    let e2eStatus = _ShieldUtils.E2EStatus.Warning;

    if (this.context.isCryptoEnabled()) {
      /* At this point, the user has encryption on and cross-signing on */
      e2eStatus = await (0, _ShieldUtils.shieldStatusForRoom)(this.context, room);
    }

    if (this.unmounted) return;
    this.setState({
      e2eStatus
    });
  }

  updatePermissions(room) {
    if (room) {
      const me = this.context.getUserId();
      const canReact = room.getMyMembership() === "join" && room.currentState.maySendEvent("m.reaction", me);
      const canReply = room.maySendMessage();
      this.setState({
        canReact,
        canReply
      });
    }
  } // rate limited because a power level change will emit an event for every member in the room.


  checkDesktopNotifications() {
    const memberCount = this.state.room.getJoinedMemberCount() + this.state.room.getInvitedMemberCount(); // if they are not alone prompt the user about notifications so they don't miss replies

    if (memberCount > 1 && _Notifier.default.shouldShowPrompt()) {
      (0, _DesktopNotificationsToast.showToast)(true);
    }
  }

  updateDMState() {
    const room = this.state.room;

    if (room.getMyMembership() != "join") {
      return;
    }

    const dmInviter = room.getDMInviter();

    if (dmInviter) {
      Rooms.setDMRoom(room.roomId, dmInviter);
    }
  }

  injectSticker(url, info, text) {
    if (this.context.isGuest()) {
      _dispatcher.default.dispatch({
        action: 'require_registration'
      });

      return;
    }

    _ContentMessages.default.sharedInstance().sendStickerContentToRoom(url, this.state.room.roomId, info, text, this.context).then(undefined, error => {
      if (error.name === "UnknownDeviceError") {
        // Let the staus bar handle this
        return;
      }
    });
  }

  handleSearchResult(searchPromise) {
    // keep a record of the current search id, so that if the search terms
    // change before we get a response, we can ignore the results.
    const localSearchId = this.searchId;
    this.setState({
      searchInProgress: true
    });
    return searchPromise.then(results => {
      debuglog("search complete");

      if (this.unmounted || !this.state.searching || this.searchId != localSearchId) {
        _logger.logger.error("Discarding stale search results");

        return false;
      } // postgres on synapse returns us precise details of the strings
      // which actually got matched for highlighting.
      //
      // In either case, we want to highlight the literal search term
      // whether it was used by the search engine or not.


      let highlights = results.highlights;

      if (highlights.indexOf(this.state.searchTerm) < 0) {
        highlights = highlights.concat(this.state.searchTerm);
      } // For overlapping highlights,
      // favour longer (more specific) terms first


      highlights = highlights.sort(function (a, b) {
        return b.length - a.length;
      });
      this.setState({
        searchHighlights: highlights,
        searchResults: results
      });
    }, error => {
      _logger.logger.error("Search failed", error);

      _Modal.default.createTrackedDialog('Search failed', '', _ErrorDialog.default, {
        title: (0, _languageHandler._t)("Search failed"),
        description: error && error.message ? error.message : (0, _languageHandler._t)("Server may be unavailable, overloaded, or search timed out :(")
      });

      return false;
    }).finally(() => {
      this.setState({
        searchInProgress: false
      });
    });
  }

  getSearchResultTiles() {
    // XXX: todo: merge overlapping results somehow?
    // XXX: why doesn't searching on name work?
    const ret = [];

    if (this.state.searchInProgress) {
      ret.push( /*#__PURE__*/_react.default.createElement("li", {
        key: "search-spinner"
      }, /*#__PURE__*/_react.default.createElement(_Spinner.default, null)));
    }

    if (!this.state.searchResults.next_batch) {
      var _this$state$searchRes, _this$state$searchRes2;

      if (!((_this$state$searchRes = this.state.searchResults) !== null && _this$state$searchRes !== void 0 && (_this$state$searchRes2 = _this$state$searchRes.results) !== null && _this$state$searchRes2 !== void 0 && _this$state$searchRes2.length)) {
        ret.push( /*#__PURE__*/_react.default.createElement("li", {
          key: "search-top-marker"
        }, /*#__PURE__*/_react.default.createElement("h2", {
          className: "mx_RoomView_topMarker"
        }, (0, _languageHandler._t)("No results"))));
      } else {
        ret.push( /*#__PURE__*/_react.default.createElement("li", {
          key: "search-top-marker"
        }, /*#__PURE__*/_react.default.createElement("h2", {
          className: "mx_RoomView_topMarker"
        }, (0, _languageHandler._t)("No more results"))));
      }
    } // once dynamic content in the search results load, make the scrollPanel check
    // the scroll offsets.


    const onHeightChanged = () => {
      const scrollPanel = this.searchResultsPanel.current;

      if (scrollPanel) {
        scrollPanel.checkScroll();
      }
    };

    let lastRoomId;

    for (let i = (((_this$state$searchRes3 = this.state.searchResults) === null || _this$state$searchRes3 === void 0 ? void 0 : (_this$state$searchRes4 = _this$state$searchRes3.results) === null || _this$state$searchRes4 === void 0 ? void 0 : _this$state$searchRes4.length) || 0) - 1; i >= 0; i--) {
      var _this$state$searchRes3, _this$state$searchRes4;

      const result = this.state.searchResults.results[i];
      const mxEv = result.context.getEvent();
      const roomId = mxEv.getRoomId();
      const room = this.context.getRoom(roomId);

      if (!room) {
        // if we do not have the room in js-sdk stores then hide it as we cannot easily show it
        // As per the spec, an all rooms search can create this condition,
        // it happens with Seshat but not Synapse.
        // It will make the result count not match the displayed count.
        _logger.logger.log("Hiding search result from an unknown room", roomId);

        continue;
      }

      if (!(0, _EventTile.haveTileForEvent)(mxEv, this.state.showHiddenEventsInTimeline)) {
        // XXX: can this ever happen? It will make the result count
        // not match the displayed count.
        continue;
      }

      if (this.state.searchScope === 'All') {
        if (roomId !== lastRoomId) {
          ret.push( /*#__PURE__*/_react.default.createElement("li", {
            key: mxEv.getId() + "-room"
          }, /*#__PURE__*/_react.default.createElement("h2", null, (0, _languageHandler._t)("Room"), ": ", room.name)));
          lastRoomId = roomId;
        }
      }

      const resultLink = "#/room/" + roomId + "/" + mxEv.getId();
      ret.push( /*#__PURE__*/_react.default.createElement(_SearchResultTile.default, {
        key: mxEv.getId(),
        searchResult: result,
        searchHighlights: this.state.searchHighlights,
        resultLink: resultLink,
        permalinkCreator: this.getPermalinkCreatorForRoom(room),
        onHeightChanged: onHeightChanged
      }));
    }

    return ret;
  }

  // get the current scroll position of the room, so that it can be
  // restored when we switch back to it.
  //
  getScrollState() {
    const messagePanel = this.messagePanel;
    if (!messagePanel) return null; // if we're following the live timeline, we want to return null; that
    // means that, if we switch back, we will jump to the read-up-to mark.
    //
    // That should be more intuitive than slavishly preserving the current
    // scroll state, in the case where the room advances in the meantime
    // (particularly in the case that the user reads some stuff on another
    // device).
    //

    if (this.state.atEndOfLiveTimeline) {
      return null;
    }

    const scrollState = messagePanel.getScrollState(); // getScrollState on TimelinePanel *may* return null, so guard against that

    if (!scrollState || scrollState.stuckAtBottom) {
      // we don't really expect to be in this state, but it will
      // occasionally happen when no scroll state has been set on the
      // messagePanel (ie, we didn't have an initial event (so it's
      // probably a new room), there has been no user-initiated scroll, and
      // no read-receipts have arrived to update the scroll position).
      //
      // Return null, which will cause us to scroll to last unread on
      // reload.
      return null;
    }

    return {
      focussedEvent: scrollState.trackedScrollToken,
      pixelOffset: scrollState.pixelOffset
    };
  }

  /**
   * get any current call for this room
   */
  getCallForRoom() {
    if (!this.state.room) {
      return null;
    }

    return _CallHandler.default.sharedInstance().getCallForRoom(this.state.room.roomId);
  } // this has to be a proper method rather than an unnamed function,
  // otherwise react calls it with null on each update.


  getOldRoom() {
    const createEvent = this.state.room.currentState.getStateEvents("m.room.create", "");
    if (!createEvent || !createEvent.getContent()['predecessor']) return null;
    return this.context.getRoom(createEvent.getContent()['predecessor']['room_id']);
  }

  getHiddenHighlightCount() {
    const oldRoom = this.getOldRoom();
    if (!oldRoom) return 0;
    return oldRoom.getUnreadNotificationCount('highlight');
  }

  render() {
    var _this$state$room3;

    if (!this.state.room) {
      const loading = !this.state.matrixClientIsReady || this.state.roomLoading || this.state.peekLoading;

      if (loading) {
        // Assume preview loading if we don't have a ready client or a room ID (still resolving the alias)
        const previewLoading = !this.state.matrixClientIsReady || !this.state.roomId || this.state.peekLoading;
        return /*#__PURE__*/_react.default.createElement("div", {
          className: "mx_RoomView"
        }, /*#__PURE__*/_react.default.createElement(_ErrorBoundary.default, null, /*#__PURE__*/_react.default.createElement(_RoomPreviewBar.default, {
          canPreview: false,
          previewLoading: previewLoading && !this.state.roomLoadError,
          error: this.state.roomLoadError,
          loading: loading,
          joining: this.state.joining,
          oobData: this.props.oobData
        })));
      } else {
        var _this$props$threepidI2, _this$props$threepidI3;

        let inviterName = undefined;

        if (this.props.oobData) {
          inviterName = this.props.oobData.inviterName;
        }

        const invitedEmail = (_this$props$threepidI2 = this.props.threepidInvite) === null || _this$props$threepidI2 === void 0 ? void 0 : _this$props$threepidI2.toEmail; // We have no room object for this room, only the ID.
        // We've got to this room by following a link, possibly a third party invite.

        const roomAlias = this.state.roomAlias;
        return /*#__PURE__*/_react.default.createElement("div", {
          className: "mx_RoomView"
        }, /*#__PURE__*/_react.default.createElement(_ErrorBoundary.default, null, /*#__PURE__*/_react.default.createElement(_RoomPreviewBar.default, {
          onJoinClick: this.onJoinButtonClicked,
          onForgetClick: this.onForgetClick,
          onRejectClick: this.onRejectThreepidInviteButtonClicked,
          canPreview: false,
          error: this.state.roomLoadError,
          roomAlias: roomAlias,
          joining: this.state.joining,
          inviterName: inviterName,
          invitedEmail: invitedEmail,
          oobData: this.props.oobData,
          signUrl: (_this$props$threepidI3 = this.props.threepidInvite) === null || _this$props$threepidI3 === void 0 ? void 0 : _this$props$threepidI3.signUrl,
          room: this.state.room
        })));
      }
    }

    const myMembership = this.state.room.getMyMembership(); // SpaceRoomView handles invites itself

    if (myMembership === "invite" && (!_SpaceStore.default.spacesEnabled || !this.state.room.isSpaceRoom())) {
      if (this.state.joining || this.state.rejecting) {
        return /*#__PURE__*/_react.default.createElement(_ErrorBoundary.default, null, /*#__PURE__*/_react.default.createElement(_RoomPreviewBar.default, {
          canPreview: false,
          error: this.state.roomLoadError,
          joining: this.state.joining,
          rejecting: this.state.rejecting
        }));
      } else {
        const myUserId = this.context.credentials.userId;
        const myMember = this.state.room.getMember(myUserId);
        const inviteEvent = myMember ? myMember.events.member : null;
        let inviterName = (0, _languageHandler._t)("Unknown");

        if (inviteEvent) {
          inviterName = inviteEvent.sender ? inviteEvent.sender.name : inviteEvent.getSender();
        } // We deliberately don't try to peek into invites, even if we have permission to peek
        // as they could be a spam vector.
        // XXX: in future we could give the option of a 'Preview' button which lets them view anyway.
        // We have a regular invite for this room.


        return /*#__PURE__*/_react.default.createElement("div", {
          className: "mx_RoomView"
        }, /*#__PURE__*/_react.default.createElement(_ErrorBoundary.default, null, /*#__PURE__*/_react.default.createElement(_RoomPreviewBar.default, {
          onJoinClick: this.onJoinButtonClicked,
          onForgetClick: this.onForgetClick,
          onRejectClick: this.onRejectButtonClicked,
          onRejectAndIgnoreClick: this.onRejectAndIgnoreClick,
          inviterName: inviterName,
          canPreview: false,
          joining: this.state.joining,
          room: this.state.room
        })));
      }
    }

    let fileDropTarget = null;

    if (this.state.draggingFile) {
      fileDropTarget = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_RoomView_fileDropTarget"
      }, /*#__PURE__*/_react.default.createElement("img", {
        src: require("../../../res/img/upload-big.svg"),
        className: "mx_RoomView_fileDropTarget_image"
      }), (0, _languageHandler._t)("Drop file here to upload"));
    } // We have successfully loaded this room, and are not previewing.
    // Display the "normal" room view.


    let activeCall = null;
    {
      // New block because this variable doesn't need to hang around for the rest of the function
      const call = this.getCallForRoom();

      if (call && this.state.callState !== 'ended' && this.state.callState !== 'ringing') {
        activeCall = call;
      }
    }
    const scrollheaderClasses = (0, _classnames.default)({
      mx_RoomView_scrollheader: true
    });
    let statusBar;
    let isStatusAreaExpanded = true;

    if (_ContentMessages.default.sharedInstance().getCurrentUploads().length > 0) {
      statusBar = /*#__PURE__*/_react.default.createElement(_UploadBar.default, {
        room: this.state.room
      });
    } else if (!this.state.searchResults) {
      isStatusAreaExpanded = this.state.statusBarVisible;
      statusBar = /*#__PURE__*/_react.default.createElement(_RoomStatusBar.default, {
        room: this.state.room,
        isPeeking: myMembership !== "join",
        onInviteClick: this.onInviteButtonClick,
        onVisible: this.onStatusBarVisible,
        onHidden: this.onStatusBarHidden
      });
    }

    const statusBarAreaClass = (0, _classnames.default)("mx_RoomView_statusArea", {
      "mx_RoomView_statusArea_expanded": isStatusAreaExpanded
    }); // if statusBar does not exist then statusBarArea is blank and takes up unnecessary space on the screen
    // show statusBarArea only if statusBar is present

    const statusBarArea = statusBar && /*#__PURE__*/_react.default.createElement("div", {
      className: statusBarAreaClass
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_RoomView_statusAreaBox"
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_RoomView_statusAreaBox_line"
    }), statusBar));

    const roomVersionRecommendation = this.state.upgradeRecommendation;
    const showRoomUpgradeBar = roomVersionRecommendation && roomVersionRecommendation.needsUpgrade && this.state.room.userMayUpgradeRoom(this.context.credentials.userId);
    const hiddenHighlightCount = this.getHiddenHighlightCount();
    let aux = null;
    let previewBar;

    if (this.state.searching) {
      aux = /*#__PURE__*/_react.default.createElement(_SearchBar.default, {
        searchInProgress: this.state.searchInProgress,
        onCancelClick: this.onCancelSearchClick,
        onSearch: this.onSearch,
        isRoomEncrypted: this.context.isRoomEncrypted(this.state.room.roomId)
      });
    } else if (showRoomUpgradeBar) {
      aux = /*#__PURE__*/_react.default.createElement(_RoomUpgradeWarningBar.default, {
        room: this.state.room
      });
    } else if (myMembership !== "join") {
      var _this$props$threepidI4, _this$state$room2;

      // We do have a room object for this room, but we're not currently in it.
      // We may have a 3rd party invite to it.
      let inviterName = undefined;

      if (this.props.oobData) {
        inviterName = this.props.oobData.inviterName;
      }

      const invitedEmail = (_this$props$threepidI4 = this.props.threepidInvite) === null || _this$props$threepidI4 === void 0 ? void 0 : _this$props$threepidI4.toEmail;
      previewBar = /*#__PURE__*/_react.default.createElement(_RoomPreviewBar.default, {
        onJoinClick: this.onJoinButtonClicked,
        onForgetClick: this.onForgetClick,
        onRejectClick: this.onRejectThreepidInviteButtonClicked,
        joining: this.state.joining,
        inviterName: inviterName,
        invitedEmail: invitedEmail,
        oobData: this.props.oobData,
        canPreview: this.state.canPeek,
        room: this.state.room
      });

      if (!this.state.canPeek && (!_SpaceStore.default.spacesEnabled || !((_this$state$room2 = this.state.room) !== null && _this$state$room2 !== void 0 && _this$state$room2.isSpaceRoom()))) {
        return /*#__PURE__*/_react.default.createElement("div", {
          className: "mx_RoomView"
        }, previewBar);
      }
    } else if (hiddenHighlightCount > 0) {
      aux = /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
        element: "div",
        className: "mx_RoomView_auxPanel_hiddenHighlights",
        onClick: this.onHiddenHighlightsClick
      }, (0, _languageHandler._t)("You have %(count)s unread notifications in a prior version of this room.", {
        count: hiddenHighlightCount
      }));
    }

    if ((_this$state$room3 = this.state.room) !== null && _this$state$room3 !== void 0 && _this$state$room3.isSpaceRoom() && !this.props.forceTimeline) {
      return /*#__PURE__*/_react.default.createElement(_SpaceRoomView.default, {
        space: this.state.room,
        justCreatedOpts: this.props.justCreatedOpts,
        resizeNotifier: this.props.resizeNotifier,
        onJoinButtonClicked: this.onJoinButtonClicked,
        onRejectButtonClicked: this.props.threepidInvite ? this.onRejectThreepidInviteButtonClicked : this.onRejectButtonClicked
      });
    }

    const auxPanel = /*#__PURE__*/_react.default.createElement(_AuxPanel.default, {
      room: this.state.room,
      userId: this.context.credentials.userId,
      showApps: this.state.showApps,
      resizeNotifier: this.props.resizeNotifier
    }, aux);

    let messageComposer;
    let searchInfo;
    const canSpeak = // joined and not showing search results
    myMembership === 'join' && !this.state.searchResults;

    if (canSpeak) {
      messageComposer = /*#__PURE__*/_react.default.createElement(_MessageComposer.default, {
        room: this.state.room,
        e2eStatus: this.state.e2eStatus,
        resizeNotifier: this.props.resizeNotifier,
        replyToEvent: this.state.replyToEvent,
        permalinkCreator: this.getPermalinkCreatorForRoom(this.state.room)
      });
    } // TODO: Why aren't we storing the term/scope/count in this format
    // in this.state if this is what RoomHeader desires?


    if (this.state.searchResults) {
      searchInfo = {
        searchTerm: this.state.searchTerm,
        searchScope: this.state.searchScope,
        searchCount: this.state.searchResults.count
      };
    } // if we have search results, we keep the messagepanel (so that it preserves its
    // scroll state), but hide it.


    let searchResultsPanel;
    let hideMessagePanel = false;

    if (this.state.searchResults) {
      // show searching spinner
      if (this.state.searchResults.count === undefined) {
        searchResultsPanel = /*#__PURE__*/_react.default.createElement("div", {
          className: "mx_RoomView_messagePanel mx_RoomView_messagePanelSearchSpinner"
        });
      } else {
        searchResultsPanel = /*#__PURE__*/_react.default.createElement(_ScrollPanel.default, {
          ref: this.searchResultsPanel,
          className: "mx_RoomView_messagePanel mx_RoomView_searchResultsPanel mx_GroupLayout",
          onFillRequest: this.onSearchResultsFillRequest,
          resizeNotifier: this.props.resizeNotifier
        }, /*#__PURE__*/_react.default.createElement("li", {
          className: scrollheaderClasses
        }), this.getSearchResultTiles());
      }

      hideMessagePanel = true;
    }

    let highlightedEventId = null;

    if (this.state.isInitialEventHighlighted) {
      highlightedEventId = this.state.initialEventId;
    }

    const messagePanelClassNames = (0, _classnames.default)("mx_RoomView_messagePanel", {
      "mx_IRCLayout": this.state.layout == _Layout.Layout.IRC,
      "mx_GroupLayout": this.state.layout == _Layout.Layout.Group
    }); // console.info("ShowUrlPreview for %s is %s", this.state.room.roomId, this.state.showUrlPreview);

    const messagePanel = /*#__PURE__*/_react.default.createElement(_TimelinePanel.default, {
      ref: this.gatherTimelinePanelRef,
      timelineSet: this.state.room.getUnfilteredTimelineSet(),
      showReadReceipts: this.state.showReadReceipts,
      manageReadReceipts: !this.state.isPeeking,
      sendReadReceiptOnLoad: !this.state.wasContextSwitch,
      manageReadMarkers: !this.state.isPeeking,
      hidden: hideMessagePanel,
      highlightedEventId: highlightedEventId,
      eventId: this.state.initialEventId,
      eventPixelOffset: this.state.initialEventPixelOffset,
      onScroll: this.onMessageListScroll,
      onUserScroll: this.onUserScroll,
      onReadMarkerUpdated: this.updateTopUnreadMessagesBar,
      showUrlPreview: this.state.showUrlPreview,
      className: messagePanelClassNames,
      membersLoaded: this.state.membersLoaded,
      permalinkCreator: this.getPermalinkCreatorForRoom(this.state.room),
      resizeNotifier: this.props.resizeNotifier,
      showReactions: true,
      layout: this.state.layout,
      editState: this.state.editState
    });

    let topUnreadMessagesBar = null; // Do not show TopUnreadMessagesBar if we have search results showing, it makes no sense

    if (this.state.showTopUnreadMessagesBar && !this.state.searchResults) {
      topUnreadMessagesBar = /*#__PURE__*/_react.default.createElement(_TopUnreadMessagesBar.default, {
        onScrollUpClick: this.jumpToReadMarker,
        onCloseClick: this.forgetReadMarker
      });
    }

    let jumpToBottom; // Do not show JumpToBottomButton if we have search results showing, it makes no sense

    if (!this.state.atEndOfLiveTimeline && !this.state.searchResults) {
      jumpToBottom = /*#__PURE__*/_react.default.createElement(_JumpToBottomButton.default, {
        highlight: this.state.room.getUnreadNotificationCount(_room.NotificationCountType.Highlight) > 0,
        numUnreadMessages: this.state.numUnreadMessages,
        onScrollToBottomClick: this.jumpToLiveTimeline
      });
    }

    const showRightPanel = this.state.room && this.state.showRightPanel;
    const rightPanel = showRightPanel ? /*#__PURE__*/_react.default.createElement(_RightPanel.default, {
      room: this.state.room,
      resizeNotifier: this.props.resizeNotifier,
      permalinkCreator: this.getPermalinkCreatorForRoom(this.state.room),
      e2eStatus: this.state.e2eStatus
    }) : null;
    const timelineClasses = (0, _classnames.default)("mx_RoomView_timeline", {
      mx_RoomView_timeline_rr_enabled: this.state.showReadReceipts
    });
    const mainClasses = (0, _classnames.default)("mx_RoomView", {
      mx_RoomView_inCall: Boolean(activeCall)
    });

    const showChatEffects = _SettingsStore.default.getValue('showChatEffects'); // Decide what to show in the main split


    let mainSplitBody = /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, auxPanel, /*#__PURE__*/_react.default.createElement("div", {
      className: timelineClasses
    }, fileDropTarget, topUnreadMessagesBar, jumpToBottom, messagePanel, searchResultsPanel), statusBarArea, previewBar, messageComposer);

    switch (this.state.mainSplitContentType) {
      case MainSplitContentType.Timeline:
        // keep the timeline in as the mainSplitBody
        break;

      case MainSplitContentType.MaximisedWidget:
        if (!_SettingsStore.default.getValue("feature_maximised_widgets")) break;
        mainSplitBody = /*#__PURE__*/_react.default.createElement(_AppsDrawer.default, {
          room: this.state.room,
          userId: this.context.credentials.userId,
          resizeNotifier: this.props.resizeNotifier,
          showApps: true
        });
        break;
      // TODO-video MainSplitContentType.Video:
      //     break;
    }

    let excludedRightPanelPhaseButtons = [_RightPanelStorePhases.RightPanelPhases.Timeline];
    let onAppsClick = this.onAppsClick;
    let onForgetClick = this.onForgetClick;
    let onSearchClick = this.onSearchClick;

    if (this.state.mainSplitContentType === MainSplitContentType.MaximisedWidget) {
      // Disable phase buttons and action button to have a simplified header when a widget is maximised
      // and enable (not disable) the RightPanelPhases.Timeline button
      excludedRightPanelPhaseButtons = [_RightPanelStorePhases.RightPanelPhases.ThreadPanel, _RightPanelStorePhases.RightPanelPhases.PinnedMessages];
      onAppsClick = null;
      onForgetClick = null;
      onSearchClick = null;
    }

    return /*#__PURE__*/_react.default.createElement(_RoomContext.default.Provider, {
      value: this.state
    }, /*#__PURE__*/_react.default.createElement("main", {
      className: mainClasses,
      ref: this.roomView,
      onKeyDown: this.onReactKeyDown
    }, showChatEffects && this.roomView.current && /*#__PURE__*/_react.default.createElement(_EffectsOverlay.default, {
      roomWidth: this.roomView.current.offsetWidth
    }), /*#__PURE__*/_react.default.createElement(_ErrorBoundary.default, null, /*#__PURE__*/_react.default.createElement(_RoomHeader.default, {
      room: this.state.room,
      searchInfo: searchInfo,
      oobData: this.props.oobData,
      inRoom: myMembership === 'join',
      onSearchClick: onSearchClick,
      onForgetClick: myMembership === "leave" ? onForgetClick : null,
      e2eStatus: this.state.e2eStatus,
      onAppsClick: this.state.hasPinnedWidgets ? onAppsClick : null,
      appsShown: this.state.showApps,
      onCallPlaced: this.onCallPlaced,
      excludedRightPanelPhaseButtons: excludedRightPanelPhaseButtons
    }), /*#__PURE__*/_react.default.createElement(_MainSplit.default, {
      panel: rightPanel,
      resizeNotifier: this.props.resizeNotifier
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_RoomView_body"
    }, mainSplitBody)))));
  }

}, (0, _defineProperty2.default)(_class2, "contextType", _MatrixClientContext.default), _temp)) || _class);
exports.RoomView = RoomView;
const RoomViewWithMatrixClient = (0, _MatrixClientContext.withMatrixClientHOC)(RoomView);
var _default = RoomViewWithMatrixClient;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3N0cnVjdHVyZXMvUm9vbVZpZXcudHN4Il0sIm5hbWVzIjpbIkRFQlVHIiwiZGVidWdsb2ciLCJtc2ciLCJCUk9XU0VSX1NVUFBPUlRTX1NBTkRCT1giLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJsb2dnZXIiLCJsb2ciLCJiaW5kIiwiY29uc29sZSIsIk1haW5TcGxpdENvbnRlbnRUeXBlIiwiUm9vbVZpZXciLCJSZWFjdCIsIkNvbXBvbmVudCIsImNvbnN0cnVjdG9yIiwicHJvcHMiLCJjb250ZXh0Iiwic3RhdGUiLCJyb29tIiwiY2hlY2tXaWRnZXRzIiwiV2lkZ2V0TGF5b3V0U3RvcmUiLCJpbnN0YW5jZSIsImhhc01heGltaXNlZFdpZGdldCIsImRpcyIsImRpc3BhdGNoIiwiYWN0aW9uIiwiQWN0aW9uIiwiU2V0UmlnaHRQYW5lbFBoYXNlIiwicGhhc2UiLCJSaWdodFBhbmVsUGhhc2VzIiwiVGltZWxpbmUiLCJjaGVja1JpZ2h0UGFuZWwiLCJzZXRTdGF0ZSIsImhhc1Bpbm5lZFdpZGdldHMiLCJtYWluU3BsaXRDb250ZW50VHlwZSIsImdldE1haW5TcGxpdENvbnRlbnRUeXBlIiwic2hvd0FwcHMiLCJzaG91bGRTaG93QXBwcyIsIk1heGltaXNlZFdpZGdldCIsIlJpZ2h0UGFuZWxTdG9yZSIsImdldFNoYXJlZEluc3RhbmNlIiwicm9vbVBhbmVsUGhhc2UiLCJzaG93UmlnaHRQYW5lbCIsIlRvZ2dsZVJpZ2h0UGFuZWwiLCJ0eXBlIiwic2hvd1JlYWRSZWNlaXB0cyIsIlNldHRpbmdzU3RvcmUiLCJnZXRWYWx1ZSIsInJvb21JZCIsImluaXRpYWwiLCJ1bm1vdW50ZWQiLCJSb29tVmlld1N0b3JlIiwiZ2V0Um9vbUlkIiwibmV3U3RhdGUiLCJyb29tQWxpYXMiLCJnZXRSb29tQWxpYXMiLCJyb29tTG9hZGluZyIsImlzUm9vbUxvYWRpbmciLCJyb29tTG9hZEVycm9yIiwiZ2V0Um9vbUxvYWRFcnJvciIsImpvaW5pbmciLCJpc0pvaW5pbmciLCJyZXBseVRvRXZlbnQiLCJnZXRRdW90aW5nRXZlbnQiLCJzaG91bGRQZWVrIiwibWF0cml4Q2xpZW50SXNSZWFkeSIsInNob3dSZWRhY3Rpb25zIiwic2hvd0pvaW5MZWF2ZXMiLCJzaG93QXZhdGFyQ2hhbmdlcyIsInNob3dEaXNwbGF5bmFtZUNoYW5nZXMiLCJ3YXNDb250ZXh0U3dpdGNoIiwiZ2V0V2FzQ29udGV4dFN3aXRjaCIsImluaXRpYWxFdmVudElkIiwiZ2V0SW5pdGlhbEV2ZW50SWQiLCJnZXRSb29tIiwiaW5pdGlhbEV2ZW50IiwiZmluZEV2ZW50QnlJZCIsInRocmVhZCIsImdldFRocmVhZCIsImlzVGhyZWFkUm9vdCIsInJvb3RFdmVudCIsImlzSW5pdGlhbEV2ZW50SGlnaGxpZ2h0ZWQiLCJzZXR0aW5nV2F0Y2hlcnMiLCJjb25jYXQiLCJ3YXRjaFNldHRpbmciLCJ2YWx1ZSIsInN0b3BQZWVraW5nIiwib25Sb29tTG9hZGVkIiwicm9vbVNjcm9sbFN0YXRlIiwiUm9vbVNjcm9sbFN0YXRlU3RvcmUiLCJnZXRTY3JvbGxTdGF0ZSIsImZvY3Vzc2VkRXZlbnQiLCJpbml0aWFsRXZlbnRQaXhlbE9mZnNldCIsInBpeGVsT2Zmc2V0Iiwic2VhcmNoUmVzdWx0cyIsInNldHVwUm9vbSIsIlZpZXdSb29tIiwicm9vbV9pZCIsImV2ZW50X2lkIiwiaGlnaGxpZ2h0ZWQiLCJyZXBseWluZ1RvRXZlbnQiLCJpc09wZW5Gb3JSb29tIiwiZXZlbnQiLCJDb250ZW50TWVzc2FnZXMiLCJzaGFyZWRJbnN0YW5jZSIsImdldEN1cnJlbnRVcGxvYWRzIiwibGVuZ3RoIiwicmV0dXJuVmFsdWUiLCJnZXRDYWxsRm9yUm9vbSIsImNhbGxTdGF0ZSIsImV2IiwiaGFuZGxlZCIsImdldFJvb21BY3Rpb24iLCJSb29tQWN0aW9uIiwiRGlzbWlzc1JlYWRNYXJrZXIiLCJtZXNzYWdlUGFuZWwiLCJmb3JnZXRSZWFkTWFya2VyIiwianVtcFRvTGl2ZVRpbWVsaW5lIiwiSnVtcFRvT2xkZXN0VW5yZWFkIiwianVtcFRvUmVhZE1hcmtlciIsIlVwbG9hZEZpbGUiLCJzdG9wUHJvcGFnYXRpb24iLCJwcmV2ZW50RGVmYXVsdCIsInBheWxvYWQiLCJjaGVja0Rlc2t0b3BOb3RpZmljYXRpb25zIiwiaW5qZWN0U3RpY2tlciIsImRhdGEiLCJjb250ZW50IiwidXJsIiwiaW5mbyIsImRlc2NyaXB0aW9uIiwibmFtZSIsInNlbmRDb250ZW50TGlzdFRvUm9vbSIsImZpbGUiLCJVcGxvYWRTdGFydGVkIiwiVXBsb2FkRmluaXNoZWQiLCJVcGxvYWRDYW5jZWxlZCIsImZvcmNlVXBkYXRlIiwiY2FsbCIsInNob3ciLCJUaW1lbGluZVJlbmRlcmluZ1R5cGUiLCJSb29tIiwib25DYW5jZWxTZWFyY2hDbGljayIsInNldEltbWVkaWF0ZSIsImRlZmVycmVkX2FjdGlvbiIsImlzSW5pdGlhbFN5bmNDb21wbGV0ZSIsIm9uUm9vbVZpZXdTdG9yZVVwZGF0ZSIsIm9uU2VhcmNoQ2xpY2siLCJFZGl0RXZlbnQiLCJ0aW1lbGluZVJlbmRlcmluZ1R5cGUiLCJlZGl0U3RhdGUiLCJFZGl0b3JTdGF0ZVRyYW5zZmVyIiwic2Nyb2xsVG9FdmVudElmTmVlZGVkIiwiZ2V0SWQiLCJDb21wb3Nlckluc2VydCIsImNvbXBvc2VyVHlwZSIsIkNvbXBvc2VyVHlwZSIsIkVkaXQiLCJTZW5kIiwiRm9jdXNBQ29tcG9zZXIiLCJmaXJlIiwiRm9jdXNFZGl0TWVzc2FnZUNvbXBvc2VyIiwiRm9jdXNTZW5kTWVzc2FnZUNvbXBvc2VyIiwidG9TdGFydE9mVGltZWxpbmUiLCJyZW1vdmVkIiwidGltZWxpbmUiLCJnZXRUaW1lbGluZVNldCIsImdldFVuZmlsdGVyZWRUaW1lbGluZVNldCIsImdldFR5cGUiLCJ1cGRhdGVQcmV2aWV3VXJsVmlzaWJpbGl0eSIsInVwZGF0ZUUyRVN0YXR1cyIsImxpdmVFdmVudCIsImlzQmVpbmdEZWNyeXB0ZWQiLCJpc0RlY3J5cHRpb25GYWlsdXJlIiwiaGFuZGxlRWZmZWN0cyIsImdldFNlbmRlciIsImNyZWRlbnRpYWxzIiwidXNlcklkIiwiYXRFbmRPZkxpdmVUaW1lbGluZSIsIm51bVVucmVhZE1lc3NhZ2VzIiwibm90aWZTdGF0ZSIsIlJvb21Ob3RpZmljYXRpb25TdGF0ZVN0b3JlIiwiZ2V0Um9vbVN0YXRlIiwiaXNVbnJlYWQiLCJDSEFUX0VGRkVDVFMiLCJmb3JFYWNoIiwiZWZmZWN0IiwiZ2V0Q29udGVudCIsImVtb2ppcyIsIm1zZ3R5cGUiLCJtc2dUeXBlIiwiaXNUaHJlYWRSZWxhdGlvbiIsImNvbW1hbmQiLCJjYW5SZXNldFRpbWVsaW5lIiwib24iLCJlbWlzc2lvbkZvclJvb20iLCJvbldpZGdldExheW91dENoYW5nZSIsImNhbGN1bGF0ZVBlZWtSdWxlcyIsImxvYWRNZW1iZXJzSWZKb2luZWQiLCJjYWxjdWxhdGVSZWNvbW1lbmRlZFZlcnNpb24iLCJ1cGRhdGVQZXJtaXNzaW9ucyIsImxpdmVUaW1lbGluZSIsImdldExpdmVUaW1lbGluZSIsIm9mZiIsImRldmljZSIsImN1cnJlbnRTdGF0ZSIsImdldE1lbWJlciIsInRydXN0U3RhdHVzIiwibWVtYmVyIiwidXBkYXRlUm9vbU1lbWJlcnMiLCJtZW1iZXJzaGlwIiwib2xkTWVtYmVyc2hpcCIsInVwZGF0ZURNU3RhdGUiLCJsZWFkaW5nIiwidHJhaWxpbmciLCJiYWNrd2FyZHMiLCJQcm9taXNlIiwicmVzb2x2ZSIsIm5leHRfYmF0Y2giLCJzZWFyY2hQcm9taXNlIiwiaGFuZGxlU2VhcmNoUmVzdWx0IiwiaXNHdWVzdCIsInRoZW4iLCJzaWduVXJsIiwidGhyZWVwaWRJbnZpdGUiLCJKb2luUm9vbSIsIm9wdHMiLCJpbnZpdGVTaWduVXJsIiwiX3R5cGUiLCJpc0F0RW5kT2ZMaXZlVGltZWxpbmUiLCJ1cGRhdGVUb3BVbnJlYWRNZXNzYWdlc0JhciIsImRyYWdDb3VudGVyIiwiZGF0YVRyYW5zZmVyIiwidHlwZXMiLCJpbmNsdWRlcyIsImRyYWdnaW5nRmlsZSIsImRyb3BFZmZlY3QiLCJmaWxlcyIsInRlcm0iLCJzY29wZSIsInNlYXJjaFRlcm0iLCJzZWFyY2hTY29wZSIsInNlYXJjaEhpZ2hsaWdodHMiLCJzZWFyY2hSZXN1bHRzUGFuZWwiLCJjdXJyZW50IiwicmVzZXRTY3JvbGxTdGF0ZSIsInNlYXJjaElkIiwiRGF0ZSIsImdldFRpbWUiLCJTZWFyY2hTY29wZSIsInJlamVjdGluZyIsImxlYXZlIiwiZXJyb3IiLCJtZXNzYWdlIiwiSlNPTiIsInN0cmluZ2lmeSIsIk1vZGFsIiwiY3JlYXRlVHJhY2tlZERpYWxvZyIsIkVycm9yRGlhbG9nIiwidGl0bGUiLCJyZWplY3RFcnJvciIsIm15TWVtYmVyIiwiZ2V0VXNlcklkIiwiaW52aXRlRXZlbnQiLCJldmVudHMiLCJpZ25vcmVkVXNlcnMiLCJnZXRJZ25vcmVkVXNlcnMiLCJwdXNoIiwic2V0SWdub3JlZFVzZXJzIiwiVmlld1Jvb21EaXJlY3RvcnkiLCJzZWFyY2hpbmciLCJzaG93QmFyIiwiY2FuSnVtcFRvUmVhZE1hcmtlciIsInNob3dUb3BVbnJlYWRNZXNzYWdlc0JhciIsInN0YXR1c0JhclZpc2libGUiLCJwYW5lbCIsImhhbmRsZVNjcm9sbEtleSIsInIiLCJvbGRSb29tIiwiZ2V0T2xkUm9vbSIsImxsTWVtYmVycyIsImhhc0xhenlMb2FkTWVtYmVyc0VuYWJsZWQiLCJwZWVrTG9hZGluZyIsIm1lbWJlcnNMb2FkZWQiLCJndWVzdHNDYW5Kb2luIiwiY2FuUGVlayIsImlzUGVla2luZyIsImF0RW5kT2ZMaXZlVGltZWxpbmVJbml0IiwiY2FuUmVhY3QiLCJjYW5SZXBseSIsImxheW91dCIsImxvd0JhbmR3aWR0aCIsImFsd2F5c1Nob3dUaW1lc3RhbXBzIiwic2hvd1R3ZWx2ZUhvdXJUaW1lc3RhbXBzIiwicmVhZE1hcmtlckluVmlld1RocmVzaG9sZE1zIiwicmVhZE1hcmtlck91dE9mVmlld1RocmVzaG9sZE1zIiwic2hvd0hpZGRlbkV2ZW50c0luVGltZWxpbmUiLCJ1bmRlZmluZWQiLCJkaXNwYXRjaGVyUmVmIiwicmVnaXN0ZXIiLCJvbkFjdGlvbiIsIm9uUm9vbSIsIm9uUm9vbVRpbWVsaW5lIiwib25Sb29tTmFtZSIsIm9uUm9vbUFjY291bnREYXRhIiwib25Sb29tU3RhdGVFdmVudHMiLCJvblJvb21TdGF0ZU1lbWJlciIsIm9uTXlNZW1iZXJzaGlwIiwib25BY2NvdW50RGF0YSIsIm9uS2V5QmFja3VwU3RhdHVzIiwib25EZXZpY2VWZXJpZmljYXRpb25DaGFuZ2VkIiwib25Vc2VyVmVyaWZpY2F0aW9uQ2hhbmdlZCIsIm9uQ3Jvc3NTaWduaW5nS2V5c0NoYW5nZWQiLCJvbkV2ZW50RGVjcnlwdGVkIiwicm9vbVN0b3JlVG9rZW4iLCJhZGRMaXN0ZW5lciIsInJpZ2h0UGFuZWxTdG9yZVRva2VuIiwib25SaWdodFBhbmVsU3RvcmVVcGRhdGUiLCJXaWRnZXRFY2hvU3RvcmUiLCJVUERBVEVfRVZFTlQiLCJvbldpZGdldEVjaG9TdG9yZVVwZGF0ZSIsIldpZGdldFN0b3JlIiwib25XaWRnZXRTdG9yZVVwZGF0ZSIsImdldFBlcm1hbGlua0NyZWF0b3JGb3JSb29tIiwicGVybWFsaW5rQ3JlYXRvcnMiLCJSb29tUGVybWFsaW5rQ3JlYXRvciIsInN0YXJ0IiwibG9hZCIsInN0b3BBbGxQZXJtYWxpbmtDcmVhdG9ycyIsIk9iamVjdCIsImtleXMiLCJzdG9wIiwicGVla0luUm9vbSIsImNhdGNoIiwiZXJyIiwiZXJyY29kZSIsImhpZGVXaWRnZXRLZXkiLCJoaWRlV2lkZ2V0RHJhd2VyIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImlzTWFudWFsbHlTaG93biIsIndpZGdldHMiLCJnZXRDb250YWluZXJXaWRnZXRzIiwiQ29udGFpbmVyIiwiVG9wIiwiY29tcG9uZW50RGlkTW91bnQiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwib25QYWdlVW5sb2FkIiwic2hvdWxkQ29tcG9uZW50VXBkYXRlIiwibmV4dFByb3BzIiwibmV4dFN0YXRlIiwiaGFzUHJvcHNEaWZmIiwidXBncmFkZVJlY29tbWVuZGF0aW9uIiwibmV3VXBncmFkZVJlY29tbWVuZGF0aW9uIiwiaGFzU3RhdGVEaWZmIiwibmVlZHNVcGdyYWRlIiwiY29tcG9uZW50RGlkVXBkYXRlIiwicm9vbVZpZXciLCJvbmRyb3AiLCJvbkRyb3AiLCJvbkRyYWdPdmVyIiwib25EcmFnRW50ZXIiLCJvbkRyYWdMZWF2ZSIsImNvbXBvbmVudFdpbGxVbm1vdW50Iiwic2V0U2Nyb2xsU3RhdGUiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwidW5yZWdpc3RlciIsInJlbW92ZUxpc3RlbmVyIiwicmVtb3ZlIiwiY2FuY2VsIiwid2F0Y2hlciIsInVud2F0Y2hTZXR0aW5nIiwiZ2V0UmVjb21tZW5kZWRWZXJzaW9uIiwiZ2V0TXlNZW1iZXJzaGlwIiwibG9hZE1lbWJlcnNJZk5lZWRlZCIsImVycm9yTWVzc2FnZSIsImd1ZXN0QWNjZXNzRXZlbnQiLCJnZXRTdGF0ZUV2ZW50cyIsImd1ZXN0X2FjY2VzcyIsImhpc3RvcnlWaXNpYmlsaXR5IiwiaGlzdG9yeV92aXNpYmlsaXR5Iiwia2V5IiwiaXNSb29tRW5jcnlwdGVkIiwic2hvd1VybFByZXZpZXciLCJlMmVTdGF0dXMiLCJFMkVTdGF0dXMiLCJXYXJuaW5nIiwiaXNDcnlwdG9FbmFibGVkIiwibWUiLCJtYXlTZW5kRXZlbnQiLCJtYXlTZW5kTWVzc2FnZSIsIm1lbWJlckNvdW50IiwiZ2V0Sm9pbmVkTWVtYmVyQ291bnQiLCJnZXRJbnZpdGVkTWVtYmVyQ291bnQiLCJOb3RpZmllciIsInNob3VsZFNob3dQcm9tcHQiLCJkbUludml0ZXIiLCJnZXRETUludml0ZXIiLCJSb29tcyIsInNldERNUm9vbSIsInRleHQiLCJzZW5kU3RpY2tlckNvbnRlbnRUb1Jvb20iLCJsb2NhbFNlYXJjaElkIiwic2VhcmNoSW5Qcm9ncmVzcyIsInJlc3VsdHMiLCJoaWdobGlnaHRzIiwiaW5kZXhPZiIsInNvcnQiLCJhIiwiYiIsImZpbmFsbHkiLCJnZXRTZWFyY2hSZXN1bHRUaWxlcyIsInJldCIsIm9uSGVpZ2h0Q2hhbmdlZCIsInNjcm9sbFBhbmVsIiwiY2hlY2tTY3JvbGwiLCJsYXN0Um9vbUlkIiwiaSIsInJlc3VsdCIsIm14RXYiLCJnZXRFdmVudCIsInJlc3VsdExpbmsiLCJzY3JvbGxTdGF0ZSIsInN0dWNrQXRCb3R0b20iLCJ0cmFja2VkU2Nyb2xsVG9rZW4iLCJDYWxsSGFuZGxlciIsImNyZWF0ZUV2ZW50IiwiZ2V0SGlkZGVuSGlnaGxpZ2h0Q291bnQiLCJnZXRVbnJlYWROb3RpZmljYXRpb25Db3VudCIsInJlbmRlciIsImxvYWRpbmciLCJwcmV2aWV3TG9hZGluZyIsIm9vYkRhdGEiLCJpbnZpdGVyTmFtZSIsImludml0ZWRFbWFpbCIsInRvRW1haWwiLCJvbkpvaW5CdXR0b25DbGlja2VkIiwib25Gb3JnZXRDbGljayIsIm9uUmVqZWN0VGhyZWVwaWRJbnZpdGVCdXR0b25DbGlja2VkIiwibXlNZW1iZXJzaGlwIiwiU3BhY2VTdG9yZSIsInNwYWNlc0VuYWJsZWQiLCJpc1NwYWNlUm9vbSIsIm15VXNlcklkIiwic2VuZGVyIiwib25SZWplY3RCdXR0b25DbGlja2VkIiwib25SZWplY3RBbmRJZ25vcmVDbGljayIsImZpbGVEcm9wVGFyZ2V0IiwicmVxdWlyZSIsImFjdGl2ZUNhbGwiLCJzY3JvbGxoZWFkZXJDbGFzc2VzIiwibXhfUm9vbVZpZXdfc2Nyb2xsaGVhZGVyIiwic3RhdHVzQmFyIiwiaXNTdGF0dXNBcmVhRXhwYW5kZWQiLCJvbkludml0ZUJ1dHRvbkNsaWNrIiwib25TdGF0dXNCYXJWaXNpYmxlIiwib25TdGF0dXNCYXJIaWRkZW4iLCJzdGF0dXNCYXJBcmVhQ2xhc3MiLCJzdGF0dXNCYXJBcmVhIiwicm9vbVZlcnNpb25SZWNvbW1lbmRhdGlvbiIsInNob3dSb29tVXBncmFkZUJhciIsInVzZXJNYXlVcGdyYWRlUm9vbSIsImhpZGRlbkhpZ2hsaWdodENvdW50IiwiYXV4IiwicHJldmlld0JhciIsIm9uU2VhcmNoIiwib25IaWRkZW5IaWdobGlnaHRzQ2xpY2siLCJjb3VudCIsImZvcmNlVGltZWxpbmUiLCJqdXN0Q3JlYXRlZE9wdHMiLCJyZXNpemVOb3RpZmllciIsImF1eFBhbmVsIiwibWVzc2FnZUNvbXBvc2VyIiwic2VhcmNoSW5mbyIsImNhblNwZWFrIiwic2VhcmNoQ291bnQiLCJoaWRlTWVzc2FnZVBhbmVsIiwib25TZWFyY2hSZXN1bHRzRmlsbFJlcXVlc3QiLCJoaWdobGlnaHRlZEV2ZW50SWQiLCJtZXNzYWdlUGFuZWxDbGFzc05hbWVzIiwiTGF5b3V0IiwiSVJDIiwiR3JvdXAiLCJnYXRoZXJUaW1lbGluZVBhbmVsUmVmIiwib25NZXNzYWdlTGlzdFNjcm9sbCIsIm9uVXNlclNjcm9sbCIsInRvcFVucmVhZE1lc3NhZ2VzQmFyIiwianVtcFRvQm90dG9tIiwiTm90aWZpY2F0aW9uQ291bnRUeXBlIiwiSGlnaGxpZ2h0IiwicmlnaHRQYW5lbCIsInRpbWVsaW5lQ2xhc3NlcyIsIm14X1Jvb21WaWV3X3RpbWVsaW5lX3JyX2VuYWJsZWQiLCJtYWluQ2xhc3NlcyIsIm14X1Jvb21WaWV3X2luQ2FsbCIsIkJvb2xlYW4iLCJzaG93Q2hhdEVmZmVjdHMiLCJtYWluU3BsaXRCb2R5IiwiZXhjbHVkZWRSaWdodFBhbmVsUGhhc2VCdXR0b25zIiwib25BcHBzQ2xpY2siLCJUaHJlYWRQYW5lbCIsIlBpbm5lZE1lc3NhZ2VzIiwib25SZWFjdEtleURvd24iLCJvZmZzZXRXaWR0aCIsIm9uQ2FsbFBsYWNlZCIsIk1hdHJpeENsaWVudENvbnRleHQiLCJSb29tVmlld1dpdGhNYXRyaXhDbGllbnQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUF1QkE7O0FBQ0E7O0FBQ0E7O0FBS0E7O0FBQ0E7O0FBQ0E7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FB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QUQ7QUFDSSxNQUFBLElBQUksRUFBRSxLQUFLdmUsS0FBTCxDQUFXQyxJQURyQjtBQUVJLE1BQUEsVUFBVSxFQUFFd2MsVUFGaEI7QUFHSSxNQUFBLE9BQU8sRUFBRSxLQUFLM2MsS0FBTCxDQUFXa2EsT0FIeEI7QUFJSSxNQUFBLE1BQU0sRUFBRU8sWUFBWSxLQUFLLE1BSjdCO0FBS0ksTUFBQSxhQUFhLEVBQUVyUyxhQUxuQjtBQU1JLE1BQUEsYUFBYSxFQUFHcVMsWUFBWSxLQUFLLE9BQWxCLEdBQTZCRixhQUE3QixHQUE2QyxJQU5oRTtBQU9JLE1BQUEsU0FBUyxFQUFFLEtBQUtyYSxLQUFMLENBQVdnWCxTQVAxQjtBQVFJLE1BQUEsV0FBVyxFQUFFLEtBQUtoWCxLQUFMLENBQVdnQixnQkFBWCxHQUE4Qm1kLFdBQTlCLEdBQTRDLElBUjdEO0FBU0ksTUFBQSxTQUFTLEVBQUUsS0FBS25lLEtBQUwsQ0FBV21CLFFBVDFCO0FBVUksTUFBQSxZQUFZLEVBQUUsS0FBS3FkLFlBVnZCO0FBV0ksTUFBQSw4QkFBOEIsRUFBRU47QUFYcEMsTUFESixlQWNJLDZCQUFDLGtCQUFEO0FBQVcsTUFBQSxLQUFLLEVBQUVSLFVBQWxCO0FBQThCLE1BQUEsY0FBYyxFQUFFLEtBQUs1ZCxLQUFMLENBQVd3YztBQUF6RCxvQkFDSTtBQUFLLE1BQUEsU0FBUyxFQUFDO0FBQWYsT0FDTTJCLGFBRE4sQ0FESixDQWRKLENBSkosQ0FESixDQURKO0FBNkJIOztBQTk5RGlFLEMsd0RBYzdDUSw0Qjs7QUFtOUR6QixNQUFNQyx3QkFBd0IsR0FBRyw4Q0FBb0JoZixRQUFwQixDQUFqQztlQUNlZ2Ysd0IiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuQ29weXJpZ2h0IDIwMTUsIDIwMTYgT3Blbk1hcmtldCBMdGRcbkNvcHlyaWdodCAyMDE3IFZlY3RvciBDcmVhdGlvbnMgTHRkXG5Db3B5cmlnaHQgMjAxOCwgMjAxOSBOZXcgVmVjdG9yIEx0ZFxuQ29weXJpZ2h0IDIwMTkgVGhlIE1hdHJpeC5vcmcgRm91bmRhdGlvbiBDLkkuQy5cblxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbnlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbllvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuXG4gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cblVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbmRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxubGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4qL1xuXG4vLyBUT0RPOiBUaGlzIGNvbXBvbmVudCBpcyBlbm9ybW91cyEgVGhlcmUncyBzZXZlcmFsIHRoaW5ncyB3aGljaCBjb3VsZCBzdGFuZC1hbG9uZTpcbi8vICAtIFNlYXJjaCByZXN1bHRzIGNvbXBvbmVudFxuLy8gIC0gRHJhZyBhbmQgZHJvcFxuXG5pbXBvcnQgUmVhY3QsIHsgY3JlYXRlUmVmIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IGNsYXNzTmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XG5pbXBvcnQgeyBJUmVjb21tZW5kZWRWZXJzaW9uLCBOb3RpZmljYXRpb25Db3VudFR5cGUsIFJvb20gfSBmcm9tIFwibWF0cml4LWpzLXNkay9zcmMvbW9kZWxzL3Jvb21cIjtcbmltcG9ydCB7IE1hdHJpeEV2ZW50IH0gZnJvbSBcIm1hdHJpeC1qcy1zZGsvc3JjL21vZGVscy9ldmVudFwiO1xuaW1wb3J0IHsgRXZlbnRTdWJzY3JpcHRpb24gfSBmcm9tIFwiZmJlbWl0dGVyXCI7XG5pbXBvcnQgeyBJU2VhcmNoUmVzdWx0cyB9IGZyb20gJ21hdHJpeC1qcy1zZGsvc3JjL0B0eXBlcy9zZWFyY2gnO1xuXG5pbXBvcnQgc2hvdWxkSGlkZUV2ZW50IGZyb20gJy4uLy4uL3Nob3VsZEhpZGVFdmVudCc7XG5pbXBvcnQgeyBfdCB9IGZyb20gJy4uLy4uL2xhbmd1YWdlSGFuZGxlcic7XG5pbXBvcnQgeyBSb29tUGVybWFsaW5rQ3JlYXRvciB9IGZyb20gJy4uLy4uL3V0aWxzL3Blcm1hbGlua3MvUGVybWFsaW5rcyc7XG5pbXBvcnQgUmVzaXplTm90aWZpZXIgZnJvbSAnLi4vLi4vdXRpbHMvUmVzaXplTm90aWZpZXInO1xuaW1wb3J0IENvbnRlbnRNZXNzYWdlcyBmcm9tICcuLi8uLi9Db250ZW50TWVzc2FnZXMnO1xuaW1wb3J0IE1vZGFsIGZyb20gJy4uLy4uL01vZGFsJztcbmltcG9ydCBDYWxsSGFuZGxlciwgeyBQbGFjZUNhbGxUeXBlIH0gZnJvbSAnLi4vLi4vQ2FsbEhhbmRsZXInO1xuaW1wb3J0IGRpcyBmcm9tICcuLi8uLi9kaXNwYXRjaGVyL2Rpc3BhdGNoZXInO1xuaW1wb3J0ICogYXMgUm9vbXMgZnJvbSAnLi4vLi4vUm9vbXMnO1xuaW1wb3J0IGV2ZW50U2VhcmNoLCB7IHNlYXJjaFBhZ2luYXRpb24gfSBmcm9tICcuLi8uLi9TZWFyY2hpbmcnO1xuaW1wb3J0IE1haW5TcGxpdCBmcm9tICcuL01haW5TcGxpdCc7XG5pbXBvcnQgUmlnaHRQYW5lbCBmcm9tICcuL1JpZ2h0UGFuZWwnO1xuaW1wb3J0IFJvb21WaWV3U3RvcmUgZnJvbSAnLi4vLi4vc3RvcmVzL1Jvb21WaWV3U3RvcmUnO1xuaW1wb3J0IFJvb21TY3JvbGxTdGF0ZVN0b3JlLCB7IFNjcm9sbFN0YXRlIH0gZnJvbSAnLi4vLi4vc3RvcmVzL1Jvb21TY3JvbGxTdGF0ZVN0b3JlJztcbmltcG9ydCBXaWRnZXRFY2hvU3RvcmUgZnJvbSAnLi4vLi4vc3RvcmVzL1dpZGdldEVjaG9TdG9yZSc7XG5pbXBvcnQgU2V0dGluZ3NTdG9yZSBmcm9tIFwiLi4vLi4vc2V0dGluZ3MvU2V0dGluZ3NTdG9yZVwiO1xuaW1wb3J0IHsgTGF5b3V0IH0gZnJvbSBcIi4uLy4uL3NldHRpbmdzL2VudW1zL0xheW91dFwiO1xuaW1wb3J0IEFjY2Vzc2libGVCdXR0b24gZnJvbSBcIi4uL3ZpZXdzL2VsZW1lbnRzL0FjY2Vzc2libGVCdXR0b25cIjtcbmltcG9ydCBSaWdodFBhbmVsU3RvcmUgZnJvbSBcIi4uLy4uL3N0b3Jlcy9SaWdodFBhbmVsU3RvcmVcIjtcbmltcG9ydCB7IGhhdmVUaWxlRm9yRXZlbnQgfSBmcm9tIFwiLi4vdmlld3Mvcm9vbXMvRXZlbnRUaWxlXCI7XG5pbXBvcnQgUm9vbUNvbnRleHQsIHsgVGltZWxpbmVSZW5kZXJpbmdUeXBlIH0gZnJvbSBcIi4uLy4uL2NvbnRleHRzL1Jvb21Db250ZXh0XCI7XG5pbXBvcnQgTWF0cml4Q2xpZW50Q29udGV4dCwgeyB3aXRoTWF0cml4Q2xpZW50SE9DLCBNYXRyaXhDbGllbnRQcm9wcyB9IGZyb20gXCIuLi8uLi9jb250ZXh0cy9NYXRyaXhDbGllbnRDb250ZXh0XCI7XG5pbXBvcnQgeyBFMkVTdGF0dXMsIHNoaWVsZFN0YXR1c0ZvclJvb20gfSBmcm9tICcuLi8uLi91dGlscy9TaGllbGRVdGlscyc7XG5pbXBvcnQgeyBBY3Rpb24gfSBmcm9tIFwiLi4vLi4vZGlzcGF0Y2hlci9hY3Rpb25zXCI7XG5pbXBvcnQgeyBJTWF0cml4Q2xpZW50Q3JlZHMgfSBmcm9tIFwiLi4vLi4vTWF0cml4Q2xpZW50UGVnXCI7XG5pbXBvcnQgU2Nyb2xsUGFuZWwgZnJvbSBcIi4vU2Nyb2xsUGFuZWxcIjtcbmltcG9ydCBUaW1lbGluZVBhbmVsIGZyb20gXCIuL1RpbWVsaW5lUGFuZWxcIjtcbmltcG9ydCBFcnJvckJvdW5kYXJ5IGZyb20gXCIuLi92aWV3cy9lbGVtZW50cy9FcnJvckJvdW5kYXJ5XCI7XG5pbXBvcnQgUm9vbVByZXZpZXdCYXIgZnJvbSBcIi4uL3ZpZXdzL3Jvb21zL1Jvb21QcmV2aWV3QmFyXCI7XG5pbXBvcnQgU2VhcmNoQmFyLCB7IFNlYXJjaFNjb3BlIH0gZnJvbSBcIi4uL3ZpZXdzL3Jvb21zL1NlYXJjaEJhclwiO1xuaW1wb3J0IFJvb21VcGdyYWRlV2FybmluZ0JhciBmcm9tIFwiLi4vdmlld3Mvcm9vbXMvUm9vbVVwZ3JhZGVXYXJuaW5nQmFyXCI7XG5pbXBvcnQgQXV4UGFuZWwgZnJvbSBcIi4uL3ZpZXdzL3Jvb21zL0F1eFBhbmVsXCI7XG5pbXBvcnQgUm9vbUhlYWRlciBmcm9tIFwiLi4vdmlld3Mvcm9vbXMvUm9vbUhlYWRlclwiO1xuaW1wb3J0IHsgWE9SIH0gZnJvbSBcIi4uLy4uL0B0eXBlcy9jb21tb25cIjtcbmltcG9ydCB7IElPT0JEYXRhLCBJVGhyZWVwaWRJbnZpdGUgfSBmcm9tIFwiLi4vLi4vc3RvcmVzL1RocmVlcGlkSW52aXRlU3RvcmVcIjtcbmltcG9ydCBFZmZlY3RzT3ZlcmxheSBmcm9tIFwiLi4vdmlld3MvZWxlbWVudHMvRWZmZWN0c092ZXJsYXlcIjtcbmltcG9ydCB7IGNvbnRhaW5zRW1vamkgfSBmcm9tICcuLi8uLi9lZmZlY3RzL3V0aWxzJztcbmltcG9ydCB7IENIQVRfRUZGRUNUUyB9IGZyb20gJy4uLy4uL2VmZmVjdHMnO1xuaW1wb3J0IHsgQ2FsbFN0YXRlLCBNYXRyaXhDYWxsIH0gZnJvbSBcIm1hdHJpeC1qcy1zZGsvc3JjL3dlYnJ0Yy9jYWxsXCI7XG5pbXBvcnQgV2lkZ2V0U3RvcmUgZnJvbSBcIi4uLy4uL3N0b3Jlcy9XaWRnZXRTdG9yZVwiO1xuaW1wb3J0IHsgVVBEQVRFX0VWRU5UIH0gZnJvbSBcIi4uLy4uL3N0b3Jlcy9Bc3luY1N0b3JlXCI7XG5pbXBvcnQgTm90aWZpZXIgZnJvbSBcIi4uLy4uL05vdGlmaWVyXCI7XG5pbXBvcnQgeyBzaG93VG9hc3QgYXMgc2hvd05vdGlmaWNhdGlvbnNUb2FzdCB9IGZyb20gXCIuLi8uLi90b2FzdHMvRGVza3RvcE5vdGlmaWNhdGlvbnNUb2FzdFwiO1xuaW1wb3J0IHsgUm9vbU5vdGlmaWNhdGlvblN0YXRlU3RvcmUgfSBmcm9tIFwiLi4vLi4vc3RvcmVzL25vdGlmaWNhdGlvbnMvUm9vbU5vdGlmaWNhdGlvblN0YXRlU3RvcmVcIjtcbmltcG9ydCB7IENvbnRhaW5lciwgV2lkZ2V0TGF5b3V0U3RvcmUgfSBmcm9tIFwiLi4vLi4vc3RvcmVzL3dpZGdldHMvV2lkZ2V0TGF5b3V0U3RvcmVcIjtcbmltcG9ydCB7IGdldEtleUJpbmRpbmdzTWFuYWdlciwgUm9vbUFjdGlvbiB9IGZyb20gJy4uLy4uL0tleUJpbmRpbmdzTWFuYWdlcic7XG5pbXBvcnQgeyBvYmplY3RIYXNEaWZmIH0gZnJvbSBcIi4uLy4uL3V0aWxzL29iamVjdHNcIjtcbmltcG9ydCBTcGFjZVJvb21WaWV3IGZyb20gXCIuL1NwYWNlUm9vbVZpZXdcIjtcbmltcG9ydCB7IElPcHRzIH0gZnJvbSBcIi4uLy4uL2NyZWF0ZVJvb21cIjtcbmltcG9ydCB7IHJlcGxhY2VhYmxlQ29tcG9uZW50IH0gZnJvbSBcIi4uLy4uL3V0aWxzL3JlcGxhY2VhYmxlQ29tcG9uZW50XCI7XG5pbXBvcnQgRWRpdG9yU3RhdGVUcmFuc2ZlciBmcm9tIFwiLi4vLi4vdXRpbHMvRWRpdG9yU3RhdGVUcmFuc2ZlclwiO1xuaW1wb3J0IHsgdGhyb3R0bGUgfSBmcm9tIFwibG9kYXNoXCI7XG5pbXBvcnQgRXJyb3JEaWFsb2cgZnJvbSAnLi4vdmlld3MvZGlhbG9ncy9FcnJvckRpYWxvZyc7XG5pbXBvcnQgU2VhcmNoUmVzdWx0VGlsZSBmcm9tICcuLi92aWV3cy9yb29tcy9TZWFyY2hSZXN1bHRUaWxlJztcbmltcG9ydCBTcGlubmVyIGZyb20gXCIuLi92aWV3cy9lbGVtZW50cy9TcGlubmVyXCI7XG5pbXBvcnQgVXBsb2FkQmFyIGZyb20gJy4vVXBsb2FkQmFyJztcbmltcG9ydCBSb29tU3RhdHVzQmFyIGZyb20gXCIuL1Jvb21TdGF0dXNCYXJcIjtcbmltcG9ydCBNZXNzYWdlQ29tcG9zZXIgZnJvbSAnLi4vdmlld3Mvcm9vbXMvTWVzc2FnZUNvbXBvc2VyJztcbmltcG9ydCBKdW1wVG9Cb3R0b21CdXR0b24gZnJvbSBcIi4uL3ZpZXdzL3Jvb21zL0p1bXBUb0JvdHRvbUJ1dHRvblwiO1xuaW1wb3J0IFRvcFVucmVhZE1lc3NhZ2VzQmFyIGZyb20gXCIuLi92aWV3cy9yb29tcy9Ub3BVbnJlYWRNZXNzYWdlc0JhclwiO1xuaW1wb3J0IFNwYWNlU3RvcmUgZnJvbSBcIi4uLy4uL3N0b3Jlcy9zcGFjZXMvU3BhY2VTdG9yZVwiO1xuXG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tIFwibWF0cml4LWpzLXNkay9zcmMvbG9nZ2VyXCI7XG5pbXBvcnQgeyBFdmVudFRpbWVsaW5lIH0gZnJvbSAnbWF0cml4LWpzLXNkay9zcmMvbW9kZWxzL2V2ZW50LXRpbWVsaW5lJztcbmltcG9ydCB7IGRpc3BhdGNoU2hvd1RocmVhZEV2ZW50IH0gZnJvbSAnLi4vLi4vZGlzcGF0Y2hlci9kaXNwYXRjaC1hY3Rpb25zL3RocmVhZHMnO1xuaW1wb3J0IHsgZmV0Y2hJbml0aWFsRXZlbnQgfSBmcm9tIFwiLi4vLi4vdXRpbHMvRXZlbnRVdGlsc1wiO1xuaW1wb3J0IHsgQ29tcG9zZXJUeXBlIH0gZnJvbSBcIi4uLy4uL2Rpc3BhdGNoZXIvcGF5bG9hZHMvQ29tcG9zZXJJbnNlcnRQYXlsb2FkXCI7XG5pbXBvcnQgQXBwc0RyYXdlciBmcm9tICcuLi92aWV3cy9yb29tcy9BcHBzRHJhd2VyJztcbmltcG9ydCB7IFNldFJpZ2h0UGFuZWxQaGFzZVBheWxvYWQgfSBmcm9tICcuLi8uLi9kaXNwYXRjaGVyL3BheWxvYWRzL1NldFJpZ2h0UGFuZWxQaGFzZVBheWxvYWQnO1xuaW1wb3J0IHsgUmlnaHRQYW5lbFBoYXNlcyB9IGZyb20gJy4uLy4uL3N0b3Jlcy9SaWdodFBhbmVsU3RvcmVQaGFzZXMnO1xuXG5jb25zdCBERUJVRyA9IGZhbHNlO1xubGV0IGRlYnVnbG9nID0gZnVuY3Rpb24obXNnOiBzdHJpbmcpIHt9O1xuXG5jb25zdCBCUk9XU0VSX1NVUFBPUlRTX1NBTkRCT1ggPSAnc2FuZGJveCcgaW4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaWZyYW1lJyk7XG5cbmlmIChERUJVRykge1xuICAgIC8vIHVzaW5nIGJpbmQgbWVhbnMgdGhhdCB3ZSBnZXQgdG8ga2VlcCB1c2VmdWwgbGluZSBudW1iZXJzIGluIHRoZSBjb25zb2xlXG4gICAgZGVidWdsb2cgPSBsb2dnZXIubG9nLmJpbmQoY29uc29sZSk7XG59XG5cbmludGVyZmFjZSBJUm9vbVByb3BzIGV4dGVuZHMgTWF0cml4Q2xpZW50UHJvcHMge1xuICAgIHRocmVlcGlkSW52aXRlOiBJVGhyZWVwaWRJbnZpdGU7XG4gICAgb29iRGF0YT86IElPT0JEYXRhO1xuXG4gICAgcmVzaXplTm90aWZpZXI6IFJlc2l6ZU5vdGlmaWVyO1xuICAgIGp1c3RDcmVhdGVkT3B0cz86IElPcHRzO1xuXG4gICAgZm9yY2VUaW1lbGluZT86IGJvb2xlYW47IC8vIHNob3VsZCB3ZSBmb3JjZSBhY2Nlc3MgdG8gdGhlIHRpbWVsaW5lLCBvdmVycmlkaW5nIChmb3IgZWcpIHNwYWNlc1xuXG4gICAgLy8gQ2FsbGVkIHdpdGggdGhlIGNyZWRlbnRpYWxzIG9mIGEgcmVnaXN0ZXJlZCB1c2VyIChpZiB0aGV5IHdlcmUgYSBST1UgdGhhdCB0cmFuc2l0aW9uZWQgdG8gUFdMVSlcbiAgICBvblJlZ2lzdGVyZWQ/KGNyZWRlbnRpYWxzOiBJTWF0cml4Q2xpZW50Q3JlZHMpOiB2b2lkO1xufVxuXG4vLyBUaGlzIGRlZmluZXMgdGhlIGNvbnRlbnQgb2YgdGhlIG1haW5TcGxpdC5cbi8vIElmIHRoZSBtYWluU3BsaXQgZG9lcyBub3QgY29udGFpbiB0aGUgVGltZWxpbmUsIHRoZSBjaGF0IGlzIHNob3duIGluIHRoZSByaWdodCBwYW5lbC5cbmVudW0gTWFpblNwbGl0Q29udGVudFR5cGUge1xuICAgIFRpbWVsaW5lLFxuICAgIE1heGltaXNlZFdpZGdldCxcbiAgICAvLyBWaWRlb1xufVxuZXhwb3J0IGludGVyZmFjZSBJUm9vbVN0YXRlIHtcbiAgICByb29tPzogUm9vbTtcbiAgICByb29tSWQ/OiBzdHJpbmc7XG4gICAgcm9vbUFsaWFzPzogc3RyaW5nO1xuICAgIHJvb21Mb2FkaW5nOiBib29sZWFuO1xuICAgIHBlZWtMb2FkaW5nOiBib29sZWFuO1xuICAgIHNob3VsZFBlZWs6IGJvb2xlYW47XG4gICAgLy8gdXNlZCB0byB0cmlnZ2VyIGEgcmVyZW5kZXIgaW4gVGltZWxpbmVQYW5lbCBvbmNlIHRoZSBtZW1iZXJzIGFyZSBsb2FkZWQsXG4gICAgLy8gc28gUlIgYXJlIHJlbmRlcmVkIGFnYWluIChub3cgd2l0aCB0aGUgbWVtYmVycyBhdmFpbGFibGUpLCAuLi5cbiAgICBtZW1iZXJzTG9hZGVkOiBib29sZWFuO1xuICAgIC8vIFRoZSBldmVudCB0byBiZSBzY3JvbGxlZCB0byBpbml0aWFsbHlcbiAgICBpbml0aWFsRXZlbnRJZD86IHN0cmluZztcbiAgICAvLyBUaGUgb2Zmc2V0IGluIHBpeGVscyBmcm9tIHRoZSBldmVudCB3aXRoIHdoaWNoIHRvIHNjcm9sbCB2ZXJ0aWNhbGx5XG4gICAgaW5pdGlhbEV2ZW50UGl4ZWxPZmZzZXQ/OiBudW1iZXI7XG4gICAgLy8gV2hldGhlciB0byBoaWdobGlnaHQgdGhlIGV2ZW50IHNjcm9sbGVkIHRvXG4gICAgaXNJbml0aWFsRXZlbnRIaWdobGlnaHRlZD86IGJvb2xlYW47XG4gICAgcmVwbHlUb0V2ZW50PzogTWF0cml4RXZlbnQ7XG4gICAgbnVtVW5yZWFkTWVzc2FnZXM6IG51bWJlcjtcbiAgICBkcmFnZ2luZ0ZpbGU6IGJvb2xlYW47XG4gICAgc2VhcmNoaW5nOiBib29sZWFuO1xuICAgIHNlYXJjaFRlcm0/OiBzdHJpbmc7XG4gICAgc2VhcmNoU2NvcGU/OiBTZWFyY2hTY29wZTtcbiAgICBzZWFyY2hSZXN1bHRzPzogWE9SPHt9LCBJU2VhcmNoUmVzdWx0cz47XG4gICAgc2VhcmNoSGlnaGxpZ2h0cz86IHN0cmluZ1tdO1xuICAgIHNlYXJjaEluUHJvZ3Jlc3M/OiBib29sZWFuO1xuICAgIGNhbGxTdGF0ZT86IENhbGxTdGF0ZTtcbiAgICBndWVzdHNDYW5Kb2luOiBib29sZWFuO1xuICAgIGNhblBlZWs6IGJvb2xlYW47XG4gICAgc2hvd0FwcHM6IGJvb2xlYW47XG4gICAgaXNQZWVraW5nOiBib29sZWFuO1xuICAgIHNob3dSaWdodFBhbmVsOiBib29sZWFuO1xuICAgIC8vIGVycm9yIG9iamVjdCwgYXMgZnJvbSB0aGUgbWF0cml4IGNsaWVudC9zZXJ2ZXIgQVBJXG4gICAgLy8gSWYgd2UgZmFpbGVkIHRvIGxvYWQgaW5mb3JtYXRpb24gYWJvdXQgdGhlIHJvb20sXG4gICAgLy8gc3RvcmUgdGhlIGVycm9yIGhlcmUuXG4gICAgcm9vbUxvYWRFcnJvcj86IEVycm9yO1xuICAgIC8vIEhhdmUgd2Ugc2VudCBhIHJlcXVlc3QgdG8gam9pbiB0aGUgcm9vbSB0aGF0IHdlJ3JlIHdhaXRpbmcgdG8gY29tcGxldGU/XG4gICAgam9pbmluZzogYm9vbGVhbjtcbiAgICAvLyB0aGlzIGlzIHRydWUgaWYgd2UgYXJlIGZ1bGx5IHNjcm9sbGVkLWRvd24sIGFuZCBhcmUgbG9va2luZyBhdFxuICAgIC8vIHRoZSBlbmQgb2YgdGhlIGxpdmUgdGltZWxpbmUuIEl0IGhhcyB0aGUgZWZmZWN0IG9mIGhpZGluZyB0aGVcbiAgICAvLyAnc2Nyb2xsIHRvIGJvdHRvbScga25vYiwgYW1vbmcgYSBjb3VwbGUgb2Ygb3RoZXIgdGhpbmdzLlxuICAgIGF0RW5kT2ZMaXZlVGltZWxpbmU6IGJvb2xlYW47XG4gICAgLy8gdXNlZCBieSBjb21wb25lbnREaWRVcGRhdGUgdG8gYXZvaWQgdW5uZWNlc3NhcnkgY2hlY2tzXG4gICAgYXRFbmRPZkxpdmVUaW1lbGluZUluaXQ6IGJvb2xlYW47XG4gICAgc2hvd1RvcFVucmVhZE1lc3NhZ2VzQmFyOiBib29sZWFuO1xuICAgIHN0YXR1c0JhclZpc2libGU6IGJvb2xlYW47XG4gICAgLy8gV2UgbG9hZCB0aGlzIGxhdGVyIGJ5IGFza2luZyB0aGUganMtc2RrIHRvIHN1Z2dlc3QgYSB2ZXJzaW9uIGZvciB1cy5cbiAgICAvLyBUaGlzIG9iamVjdCBpcyB0aGUgcmVzdWx0IG9mIFJvb20jZ2V0UmVjb21tZW5kZWRWZXJzaW9uKClcblxuICAgIHVwZ3JhZGVSZWNvbW1lbmRhdGlvbj86IElSZWNvbW1lbmRlZFZlcnNpb247XG4gICAgY2FuUmVhY3Q6IGJvb2xlYW47XG4gICAgY2FuUmVwbHk6IGJvb2xlYW47XG4gICAgbGF5b3V0OiBMYXlvdXQ7XG4gICAgbG93QmFuZHdpZHRoOiBib29sZWFuO1xuICAgIGFsd2F5c1Nob3dUaW1lc3RhbXBzOiBib29sZWFuO1xuICAgIHNob3dUd2VsdmVIb3VyVGltZXN0YW1wczogYm9vbGVhbjtcbiAgICByZWFkTWFya2VySW5WaWV3VGhyZXNob2xkTXM6IG51bWJlcjtcbiAgICByZWFkTWFya2VyT3V0T2ZWaWV3VGhyZXNob2xkTXM6IG51bWJlcjtcbiAgICBzaG93SGlkZGVuRXZlbnRzSW5UaW1lbGluZTogYm9vbGVhbjtcbiAgICBzaG93UmVhZFJlY2VpcHRzOiBib29sZWFuO1xuICAgIHNob3dSZWRhY3Rpb25zOiBib29sZWFuO1xuICAgIHNob3dKb2luTGVhdmVzOiBib29sZWFuO1xuICAgIHNob3dBdmF0YXJDaGFuZ2VzOiBib29sZWFuO1xuICAgIHNob3dEaXNwbGF5bmFtZUNoYW5nZXM6IGJvb2xlYW47XG4gICAgbWF0cml4Q2xpZW50SXNSZWFkeTogYm9vbGVhbjtcbiAgICBzaG93VXJsUHJldmlldz86IGJvb2xlYW47XG4gICAgZTJlU3RhdHVzPzogRTJFU3RhdHVzO1xuICAgIHJlamVjdGluZz86IGJvb2xlYW47XG4gICAgcmVqZWN0RXJyb3I/OiBFcnJvcjtcbiAgICBoYXNQaW5uZWRXaWRnZXRzPzogYm9vbGVhbjtcbiAgICBtYWluU3BsaXRDb250ZW50VHlwZT86IE1haW5TcGxpdENvbnRlbnRUeXBlO1xuICAgIGRyYWdDb3VudGVyOiBudW1iZXI7XG4gICAgLy8gd2hldGhlciBvciBub3QgYSBzcGFjZXMgY29udGV4dCBzd2l0Y2ggYnJvdWdodCB1cyBoZXJlLFxuICAgIC8vIGlmIGl0IGRpZCB3ZSBkb24ndCB3YW50IHRoZSByb29tIHRvIGJlIG1hcmtlZCBhcyByZWFkIGFzIHNvb24gYXMgaXQgaXMgbG9hZGVkLlxuICAgIHdhc0NvbnRleHRTd2l0Y2g/OiBib29sZWFuO1xuICAgIGVkaXRTdGF0ZT86IEVkaXRvclN0YXRlVHJhbnNmZXI7XG4gICAgdGltZWxpbmVSZW5kZXJpbmdUeXBlOiBUaW1lbGluZVJlbmRlcmluZ1R5cGU7XG4gICAgbGl2ZVRpbWVsaW5lPzogRXZlbnRUaW1lbGluZTtcbn1cblxuQHJlcGxhY2VhYmxlQ29tcG9uZW50KFwic3RydWN0dXJlcy5Sb29tVmlld1wiKVxuZXhwb3J0IGNsYXNzIFJvb21WaWV3IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PElSb29tUHJvcHMsIElSb29tU3RhdGU+IHtcbiAgICBwcml2YXRlIHJlYWRvbmx5IGRpc3BhdGNoZXJSZWY6IHN0cmluZztcbiAgICBwcml2YXRlIHJlYWRvbmx5IHJvb21TdG9yZVRva2VuOiBFdmVudFN1YnNjcmlwdGlvbjtcbiAgICBwcml2YXRlIHJlYWRvbmx5IHJpZ2h0UGFuZWxTdG9yZVRva2VuOiBFdmVudFN1YnNjcmlwdGlvbjtcbiAgICBwcml2YXRlIHNldHRpbmdXYXRjaGVyczogc3RyaW5nW107XG5cbiAgICBwcml2YXRlIHVubW91bnRlZCA9IGZhbHNlO1xuICAgIHByaXZhdGUgcGVybWFsaW5rQ3JlYXRvcnM6IFJlY29yZDxzdHJpbmcsIFJvb21QZXJtYWxpbmtDcmVhdG9yPiA9IHt9O1xuICAgIHByaXZhdGUgc2VhcmNoSWQ6IG51bWJlcjtcblxuICAgIHByaXZhdGUgcm9vbVZpZXcgPSBjcmVhdGVSZWY8SFRNTEVsZW1lbnQ+KCk7XG4gICAgcHJpdmF0ZSBzZWFyY2hSZXN1bHRzUGFuZWwgPSBjcmVhdGVSZWY8U2Nyb2xsUGFuZWw+KCk7XG4gICAgcHJpdmF0ZSBtZXNzYWdlUGFuZWw6IFRpbWVsaW5lUGFuZWw7XG5cbiAgICBzdGF0aWMgY29udGV4dFR5cGUgPSBNYXRyaXhDbGllbnRDb250ZXh0O1xuXG4gICAgY29uc3RydWN0b3IocHJvcHMsIGNvbnRleHQpIHtcbiAgICAgICAgc3VwZXIocHJvcHMsIGNvbnRleHQpO1xuXG4gICAgICAgIGNvbnN0IGxsTWVtYmVycyA9IHRoaXMuY29udGV4dC5oYXNMYXp5TG9hZE1lbWJlcnNFbmFibGVkKCk7XG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICByb29tSWQ6IG51bGwsXG4gICAgICAgICAgICByb29tTG9hZGluZzogdHJ1ZSxcbiAgICAgICAgICAgIHBlZWtMb2FkaW5nOiBmYWxzZSxcbiAgICAgICAgICAgIHNob3VsZFBlZWs6IHRydWUsXG4gICAgICAgICAgICBtZW1iZXJzTG9hZGVkOiAhbGxNZW1iZXJzLFxuICAgICAgICAgICAgbnVtVW5yZWFkTWVzc2FnZXM6IDAsXG4gICAgICAgICAgICBkcmFnZ2luZ0ZpbGU6IGZhbHNlLFxuICAgICAgICAgICAgc2VhcmNoaW5nOiBmYWxzZSxcbiAgICAgICAgICAgIHNlYXJjaFJlc3VsdHM6IG51bGwsXG4gICAgICAgICAgICBjYWxsU3RhdGU6IG51bGwsXG4gICAgICAgICAgICBndWVzdHNDYW5Kb2luOiBmYWxzZSxcbiAgICAgICAgICAgIGNhblBlZWs6IGZhbHNlLFxuICAgICAgICAgICAgc2hvd0FwcHM6IGZhbHNlLFxuICAgICAgICAgICAgaXNQZWVraW5nOiBmYWxzZSxcbiAgICAgICAgICAgIHNob3dSaWdodFBhbmVsOiBSaWdodFBhbmVsU3RvcmUuZ2V0U2hhcmVkSW5zdGFuY2UoKS5pc09wZW5Gb3JSb29tLFxuICAgICAgICAgICAgam9pbmluZzogZmFsc2UsXG4gICAgICAgICAgICBhdEVuZE9mTGl2ZVRpbWVsaW5lOiB0cnVlLFxuICAgICAgICAgICAgYXRFbmRPZkxpdmVUaW1lbGluZUluaXQ6IGZhbHNlLFxuICAgICAgICAgICAgc2hvd1RvcFVucmVhZE1lc3NhZ2VzQmFyOiBmYWxzZSxcbiAgICAgICAgICAgIHN0YXR1c0JhclZpc2libGU6IGZhbHNlLFxuICAgICAgICAgICAgY2FuUmVhY3Q6IGZhbHNlLFxuICAgICAgICAgICAgY2FuUmVwbHk6IGZhbHNlLFxuICAgICAgICAgICAgbGF5b3V0OiBTZXR0aW5nc1N0b3JlLmdldFZhbHVlKFwibGF5b3V0XCIpLFxuICAgICAgICAgICAgbG93QmFuZHdpZHRoOiBTZXR0aW5nc1N0b3JlLmdldFZhbHVlKFwibG93QmFuZHdpZHRoXCIpLFxuICAgICAgICAgICAgYWx3YXlzU2hvd1RpbWVzdGFtcHM6IFNldHRpbmdzU3RvcmUuZ2V0VmFsdWUoXCJhbHdheXNTaG93VGltZXN0YW1wc1wiKSxcbiAgICAgICAgICAgIHNob3dUd2VsdmVIb3VyVGltZXN0YW1wczogU2V0dGluZ3NTdG9yZS5nZXRWYWx1ZShcInNob3dUd2VsdmVIb3VyVGltZXN0YW1wc1wiKSxcbiAgICAgICAgICAgIHJlYWRNYXJrZXJJblZpZXdUaHJlc2hvbGRNczogU2V0dGluZ3NTdG9yZS5nZXRWYWx1ZShcInJlYWRNYXJrZXJJblZpZXdUaHJlc2hvbGRNc1wiKSxcbiAgICAgICAgICAgIHJlYWRNYXJrZXJPdXRPZlZpZXdUaHJlc2hvbGRNczogU2V0dGluZ3NTdG9yZS5nZXRWYWx1ZShcInJlYWRNYXJrZXJPdXRPZlZpZXdUaHJlc2hvbGRNc1wiKSxcbiAgICAgICAgICAgIHNob3dIaWRkZW5FdmVudHNJblRpbWVsaW5lOiBTZXR0aW5nc1N0b3JlLmdldFZhbHVlKFwic2hvd0hpZGRlbkV2ZW50c0luVGltZWxpbmVcIiksXG4gICAgICAgICAgICBzaG93UmVhZFJlY2VpcHRzOiB0cnVlLFxuICAgICAgICAgICAgc2hvd1JlZGFjdGlvbnM6IHRydWUsXG4gICAgICAgICAgICBzaG93Sm9pbkxlYXZlczogdHJ1ZSxcbiAgICAgICAgICAgIHNob3dBdmF0YXJDaGFuZ2VzOiB0cnVlLFxuICAgICAgICAgICAgc2hvd0Rpc3BsYXluYW1lQ2hhbmdlczogdHJ1ZSxcbiAgICAgICAgICAgIG1hdHJpeENsaWVudElzUmVhZHk6IHRoaXMuY29udGV4dCAmJiB0aGlzLmNvbnRleHQuaXNJbml0aWFsU3luY0NvbXBsZXRlKCksXG4gICAgICAgICAgICBtYWluU3BsaXRDb250ZW50VHlwZTogTWFpblNwbGl0Q29udGVudFR5cGUuVGltZWxpbmUsXG4gICAgICAgICAgICBkcmFnQ291bnRlcjogMCxcbiAgICAgICAgICAgIHRpbWVsaW5lUmVuZGVyaW5nVHlwZTogVGltZWxpbmVSZW5kZXJpbmdUeXBlLlJvb20sXG4gICAgICAgICAgICBsaXZlVGltZWxpbmU6IHVuZGVmaW5lZCxcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLmRpc3BhdGNoZXJSZWYgPSBkaXMucmVnaXN0ZXIodGhpcy5vbkFjdGlvbik7XG4gICAgICAgIHRoaXMuY29udGV4dC5vbihcIlJvb21cIiwgdGhpcy5vblJvb20pO1xuICAgICAgICB0aGlzLmNvbnRleHQub24oXCJSb29tLnRpbWVsaW5lXCIsIHRoaXMub25Sb29tVGltZWxpbmUpO1xuICAgICAgICB0aGlzLmNvbnRleHQub24oXCJSb29tLm5hbWVcIiwgdGhpcy5vblJvb21OYW1lKTtcbiAgICAgICAgdGhpcy5jb250ZXh0Lm9uKFwiUm9vbS5hY2NvdW50RGF0YVwiLCB0aGlzLm9uUm9vbUFjY291bnREYXRhKTtcbiAgICAgICAgdGhpcy5jb250ZXh0Lm9uKFwiUm9vbVN0YXRlLmV2ZW50c1wiLCB0aGlzLm9uUm9vbVN0YXRlRXZlbnRzKTtcbiAgICAgICAgdGhpcy5jb250ZXh0Lm9uKFwiUm9vbVN0YXRlLm1lbWJlcnNcIiwgdGhpcy5vblJvb21TdGF0ZU1lbWJlcik7XG4gICAgICAgIHRoaXMuY29udGV4dC5vbihcIlJvb20ubXlNZW1iZXJzaGlwXCIsIHRoaXMub25NeU1lbWJlcnNoaXApO1xuICAgICAgICB0aGlzLmNvbnRleHQub24oXCJhY2NvdW50RGF0YVwiLCB0aGlzLm9uQWNjb3VudERhdGEpO1xuICAgICAgICB0aGlzLmNvbnRleHQub24oXCJjcnlwdG8ua2V5QmFja3VwU3RhdHVzXCIsIHRoaXMub25LZXlCYWNrdXBTdGF0dXMpO1xuICAgICAgICB0aGlzLmNvbnRleHQub24oXCJkZXZpY2VWZXJpZmljYXRpb25DaGFuZ2VkXCIsIHRoaXMub25EZXZpY2VWZXJpZmljYXRpb25DaGFuZ2VkKTtcbiAgICAgICAgdGhpcy5jb250ZXh0Lm9uKFwidXNlclRydXN0U3RhdHVzQ2hhbmdlZFwiLCB0aGlzLm9uVXNlclZlcmlmaWNhdGlvbkNoYW5nZWQpO1xuICAgICAgICB0aGlzLmNvbnRleHQub24oXCJjcm9zc1NpZ25pbmcua2V5c0NoYW5nZWRcIiwgdGhpcy5vbkNyb3NzU2lnbmluZ0tleXNDaGFuZ2VkKTtcbiAgICAgICAgdGhpcy5jb250ZXh0Lm9uKFwiRXZlbnQuZGVjcnlwdGVkXCIsIHRoaXMub25FdmVudERlY3J5cHRlZCk7XG4gICAgICAgIC8vIFN0YXJ0IGxpc3RlbmluZyBmb3IgUm9vbVZpZXdTdG9yZSB1cGRhdGVzXG4gICAgICAgIHRoaXMucm9vbVN0b3JlVG9rZW4gPSBSb29tVmlld1N0b3JlLmFkZExpc3RlbmVyKHRoaXMub25Sb29tVmlld1N0b3JlVXBkYXRlKTtcbiAgICAgICAgdGhpcy5yaWdodFBhbmVsU3RvcmVUb2tlbiA9IFJpZ2h0UGFuZWxTdG9yZS5nZXRTaGFyZWRJbnN0YW5jZSgpLmFkZExpc3RlbmVyKHRoaXMub25SaWdodFBhbmVsU3RvcmVVcGRhdGUpO1xuXG4gICAgICAgIFdpZGdldEVjaG9TdG9yZS5vbihVUERBVEVfRVZFTlQsIHRoaXMub25XaWRnZXRFY2hvU3RvcmVVcGRhdGUpO1xuICAgICAgICBXaWRnZXRTdG9yZS5pbnN0YW5jZS5vbihVUERBVEVfRVZFTlQsIHRoaXMub25XaWRnZXRTdG9yZVVwZGF0ZSk7XG5cbiAgICAgICAgdGhpcy5zZXR0aW5nV2F0Y2hlcnMgPSBbXG4gICAgICAgICAgICBTZXR0aW5nc1N0b3JlLndhdGNoU2V0dGluZyhcImxheW91dFwiLCBudWxsLCAoLi4uWywsLCB2YWx1ZV0pID0+XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGxheW91dDogdmFsdWUgYXMgTGF5b3V0IH0pLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIFNldHRpbmdzU3RvcmUud2F0Y2hTZXR0aW5nKFwibG93QmFuZHdpZHRoXCIsIG51bGwsICguLi5bLCwsIHZhbHVlXSkgPT5cbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgbG93QmFuZHdpZHRoOiB2YWx1ZSBhcyBib29sZWFuIH0pLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIFNldHRpbmdzU3RvcmUud2F0Y2hTZXR0aW5nKFwiYWx3YXlzU2hvd1RpbWVzdGFtcHNcIiwgbnVsbCwgKC4uLlssLCwgdmFsdWVdKSA9PlxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBhbHdheXNTaG93VGltZXN0YW1wczogdmFsdWUgYXMgYm9vbGVhbiB9KSxcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICBTZXR0aW5nc1N0b3JlLndhdGNoU2V0dGluZyhcInNob3dUd2VsdmVIb3VyVGltZXN0YW1wc1wiLCBudWxsLCAoLi4uWywsLCB2YWx1ZV0pID0+XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHNob3dUd2VsdmVIb3VyVGltZXN0YW1wczogdmFsdWUgYXMgYm9vbGVhbiB9KSxcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICBTZXR0aW5nc1N0b3JlLndhdGNoU2V0dGluZyhcInJlYWRNYXJrZXJJblZpZXdUaHJlc2hvbGRNc1wiLCBudWxsLCAoLi4uWywsLCB2YWx1ZV0pID0+XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHJlYWRNYXJrZXJJblZpZXdUaHJlc2hvbGRNczogdmFsdWUgYXMgbnVtYmVyIH0pLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIFNldHRpbmdzU3RvcmUud2F0Y2hTZXR0aW5nKFwicmVhZE1hcmtlck91dE9mVmlld1RocmVzaG9sZE1zXCIsIG51bGwsICguLi5bLCwsIHZhbHVlXSkgPT5cbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgcmVhZE1hcmtlck91dE9mVmlld1RocmVzaG9sZE1zOiB2YWx1ZSBhcyBudW1iZXIgfSksXG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgU2V0dGluZ3NTdG9yZS53YXRjaFNldHRpbmcoXCJzaG93SGlkZGVuRXZlbnRzSW5UaW1lbGluZVwiLCBudWxsLCAoLi4uWywsLCB2YWx1ZV0pID0+XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHNob3dIaWRkZW5FdmVudHNJblRpbWVsaW5lOiB2YWx1ZSBhcyBib29sZWFuIH0pLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgXTtcbiAgICB9XG5cbiAgICBwcml2YXRlIG9uV2lkZ2V0U3RvcmVVcGRhdGUgPSAoKSA9PiB7XG4gICAgICAgIGlmICghdGhpcy5zdGF0ZS5yb29tKSByZXR1cm47XG4gICAgICAgIHRoaXMuY2hlY2tXaWRnZXRzKHRoaXMuc3RhdGUucm9vbSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25XaWRnZXRFY2hvU3RvcmVVcGRhdGUgPSAoKSA9PiB7XG4gICAgICAgIGlmICghdGhpcy5zdGF0ZS5yb29tKSByZXR1cm47XG4gICAgICAgIHRoaXMuY2hlY2tXaWRnZXRzKHRoaXMuc3RhdGUucm9vbSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25XaWRnZXRMYXlvdXRDaGFuZ2UgPSAoKSA9PiB7XG4gICAgICAgIGlmICghdGhpcy5zdGF0ZS5yb29tKSByZXR1cm47XG4gICAgICAgIGlmIChXaWRnZXRMYXlvdXRTdG9yZS5pbnN0YW5jZS5oYXNNYXhpbWlzZWRXaWRnZXQodGhpcy5zdGF0ZS5yb29tKSkge1xuICAgICAgICAgICAgLy8gU2hvdyBjaGF0IGluIHJpZ2h0IHBhbmVsIHdoZW4gYSB3aWRnZXQgaXMgbWF4aW1pc2VkXG4gICAgICAgICAgICBkaXMuZGlzcGF0Y2g8U2V0UmlnaHRQYW5lbFBoYXNlUGF5bG9hZD4oe1xuICAgICAgICAgICAgICAgIGFjdGlvbjogQWN0aW9uLlNldFJpZ2h0UGFuZWxQaGFzZSxcbiAgICAgICAgICAgICAgICBwaGFzZTogUmlnaHRQYW5lbFBoYXNlcy5UaW1lbGluZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2hlY2tXaWRnZXRzKHRoaXMuc3RhdGUucm9vbSk7XG4gICAgICAgIHRoaXMuY2hlY2tSaWdodFBhbmVsKHRoaXMuc3RhdGUucm9vbSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgY2hlY2tXaWRnZXRzID0gKHJvb20pID0+IHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBoYXNQaW5uZWRXaWRnZXRzOiBXaWRnZXRMYXlvdXRTdG9yZS5pbnN0YW5jZS5oYXNQaW5uZWRXaWRnZXRzKHJvb20pLFxuICAgICAgICAgICAgbWFpblNwbGl0Q29udGVudFR5cGU6IHRoaXMuZ2V0TWFpblNwbGl0Q29udGVudFR5cGUocm9vbSksXG4gICAgICAgICAgICBzaG93QXBwczogdGhpcy5zaG91bGRTaG93QXBwcyhyb29tKSxcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgZ2V0TWFpblNwbGl0Q29udGVudFR5cGUgPSAocm9vbSkgPT4ge1xuICAgICAgICAvLyBUT0RPLXZpZGVvIGNoZWNrIGlmIHZpZGVvIHNob3VsZCBiZSBkaXNwbGF5ZWQgaW4gbWFpbiBwYW5lbFxuICAgICAgICByZXR1cm4gKFdpZGdldExheW91dFN0b3JlLmluc3RhbmNlLmhhc01heGltaXNlZFdpZGdldChyb29tKSlcbiAgICAgICAgICAgID8gTWFpblNwbGl0Q29udGVudFR5cGUuTWF4aW1pc2VkV2lkZ2V0XG4gICAgICAgICAgICA6IE1haW5TcGxpdENvbnRlbnRUeXBlLlRpbWVsaW5lO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNoZWNrUmlnaHRQYW5lbCA9IChyb29tKSA9PiB7XG4gICAgICAgIC8vIFRoaXMgaXMgYSBoYWNrIHRvIGhpZGUgdGhlIGNoYXQuIFRoaXMgc2hvdWxkIG5vdCBiZSBuZWNlc3Nhcnkgb25jZSB0aGUgcmlnaHQgcGFuZWxcbiAgICAgICAgLy8gcGhhc2UgaXMgc3RvcmVkIHBlciByb29tLiAobmVlZCB0byBiZSBkb25lIGFmdGVyIGNoZWNrIHdpZGdldCBzbyB0aGF0IG1haW5TcGxpdENvbnRlbnRUeXBlIGlzIHVwZGF0ZWQpXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIFJpZ2h0UGFuZWxTdG9yZS5nZXRTaGFyZWRJbnN0YW5jZSgpLnJvb21QYW5lbFBoYXNlID09PSBSaWdodFBhbmVsUGhhc2VzLlRpbWVsaW5lICYmXG4gICAgICAgICAgICB0aGlzLnN0YXRlLnNob3dSaWdodFBhbmVsICYmXG4gICAgICAgICAgICAhV2lkZ2V0TGF5b3V0U3RvcmUuaW5zdGFuY2UuaGFzTWF4aW1pc2VkV2lkZ2V0KHRoaXMuc3RhdGUucm9vbSlcbiAgICAgICAgKSB7XG4gICAgICAgICAgICAvLyBUd28gdGltZWxpbmVzIGFyZSBzaG93biBwcmV2ZW50IHRoaXMgYnkgaGlkaW5nIHRoZSByaWdodCBwYW5lbFxuICAgICAgICAgICAgZGlzLmRpc3BhdGNoKHtcbiAgICAgICAgICAgICAgICBhY3Rpb246IEFjdGlvbi5Ub2dnbGVSaWdodFBhbmVsLFxuICAgICAgICAgICAgICAgIHR5cGU6IFwicm9vbVwiLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvblJlYWRSZWNlaXB0c0NoYW5nZSA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBzaG93UmVhZFJlY2VpcHRzOiBTZXR0aW5nc1N0b3JlLmdldFZhbHVlKFwic2hvd1JlYWRSZWNlaXB0c1wiLCB0aGlzLnN0YXRlLnJvb21JZCksXG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uUm9vbVZpZXdTdG9yZVVwZGF0ZSA9IGFzeW5jIChpbml0aWFsPzogYm9vbGVhbik6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgICAgICBpZiAodGhpcy51bm1vdW50ZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghaW5pdGlhbCAmJiB0aGlzLnN0YXRlLnJvb21JZCAhPT0gUm9vbVZpZXdTdG9yZS5nZXRSb29tSWQoKSkge1xuICAgICAgICAgICAgLy8gUm9vbVZpZXcgZXhwbGljaXRseSBkb2VzIG5vdCBzdXBwb3J0IGNoYW5naW5nIHdoYXQgcm9vbVxuICAgICAgICAgICAgLy8gaXMgYmVpbmcgdmlld2VkOiBpbnN0ZWFkIGl0IHNob3VsZCBqdXN0IGJlIHJlLW1vdW50ZWQgd2hlblxuICAgICAgICAgICAgLy8gc3dpdGNoaW5nIHJvb21zLiBUaGVyZWZvcmUsIGlmIHRoZSByb29tIElEIGNoYW5nZXMsIHdlXG4gICAgICAgICAgICAvLyBpZ25vcmUgdGhpcy4gV2UgZWl0aGVyIG5lZWQgdG8gZG8gdGhpcyBvciBhZGQgY29kZSB0byBoYW5kbGVcbiAgICAgICAgICAgIC8vIHNhdmluZyB0aGUgc2Nyb2xsIHBvc2l0aW9uIChvdGhlcndpc2Ugd2UgZW5kIHVwIHNhdmluZyB0aGVcbiAgICAgICAgICAgIC8vIHNjcm9sbCBwb3NpdGlvbiBhZ2FpbnN0IHRoZSB3cm9uZyByb29tKS5cblxuICAgICAgICAgICAgLy8gR2l2ZW4gdGhhdCBkb2luZyB0aGUgc2V0U3RhdGUgaGVyZSB3b3VsZCBjYXVzZSBhIGJ1bmNoIG9mXG4gICAgICAgICAgICAvLyB1bm5lY2Vzc2FyeSB3b3JrLCB3ZSBqdXN0IGlnbm9yZSB0aGUgY2hhbmdlIHNpbmNlIHdlIGtub3dcbiAgICAgICAgICAgIC8vIHRoYXQgaWYgdGhlIGN1cnJlbnQgcm9vbSBJRCBoYXMgY2hhbmdlZCBmcm9tIHdoYXQgd2UgdGhvdWdodFxuICAgICAgICAgICAgLy8gaXQgd2FzLCBpdCBtZWFucyB3ZSdyZSBhYm91dCB0byBiZSB1bm1vdW50ZWQuXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByb29tSWQgPSBSb29tVmlld1N0b3JlLmdldFJvb21JZCgpO1xuXG4gICAgICAgIGNvbnN0IG5ld1N0YXRlOiBQaWNrPElSb29tU3RhdGUsIGFueT4gPSB7XG4gICAgICAgICAgICByb29tSWQsXG4gICAgICAgICAgICByb29tQWxpYXM6IFJvb21WaWV3U3RvcmUuZ2V0Um9vbUFsaWFzKCksXG4gICAgICAgICAgICByb29tTG9hZGluZzogUm9vbVZpZXdTdG9yZS5pc1Jvb21Mb2FkaW5nKCksXG4gICAgICAgICAgICByb29tTG9hZEVycm9yOiBSb29tVmlld1N0b3JlLmdldFJvb21Mb2FkRXJyb3IoKSxcbiAgICAgICAgICAgIGpvaW5pbmc6IFJvb21WaWV3U3RvcmUuaXNKb2luaW5nKCksXG4gICAgICAgICAgICByZXBseVRvRXZlbnQ6IFJvb21WaWV3U3RvcmUuZ2V0UXVvdGluZ0V2ZW50KCksXG4gICAgICAgICAgICAvLyB3ZSBzaG91bGQgb25seSBwZWVrIG9uY2Ugd2UgaGF2ZSBhIHJlYWR5IGNsaWVudFxuICAgICAgICAgICAgc2hvdWxkUGVlazogdGhpcy5zdGF0ZS5tYXRyaXhDbGllbnRJc1JlYWR5ICYmIFJvb21WaWV3U3RvcmUuc2hvdWxkUGVlaygpLFxuICAgICAgICAgICAgc2hvd1JlYWRSZWNlaXB0czogU2V0dGluZ3NTdG9yZS5nZXRWYWx1ZShcInNob3dSZWFkUmVjZWlwdHNcIiwgcm9vbUlkKSxcbiAgICAgICAgICAgIHNob3dSZWRhY3Rpb25zOiBTZXR0aW5nc1N0b3JlLmdldFZhbHVlKFwic2hvd1JlZGFjdGlvbnNcIiwgcm9vbUlkKSxcbiAgICAgICAgICAgIHNob3dKb2luTGVhdmVzOiBTZXR0aW5nc1N0b3JlLmdldFZhbHVlKFwic2hvd0pvaW5MZWF2ZXNcIiwgcm9vbUlkKSxcbiAgICAgICAgICAgIHNob3dBdmF0YXJDaGFuZ2VzOiBTZXR0aW5nc1N0b3JlLmdldFZhbHVlKFwic2hvd0F2YXRhckNoYW5nZXNcIiwgcm9vbUlkKSxcbiAgICAgICAgICAgIHNob3dEaXNwbGF5bmFtZUNoYW5nZXM6IFNldHRpbmdzU3RvcmUuZ2V0VmFsdWUoXCJzaG93RGlzcGxheW5hbWVDaGFuZ2VzXCIsIHJvb21JZCksXG4gICAgICAgICAgICB3YXNDb250ZXh0U3dpdGNoOiBSb29tVmlld1N0b3JlLmdldFdhc0NvbnRleHRTd2l0Y2goKSxcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBpbml0aWFsRXZlbnRJZCA9IFJvb21WaWV3U3RvcmUuZ2V0SW5pdGlhbEV2ZW50SWQoKTtcbiAgICAgICAgaWYgKGluaXRpYWxFdmVudElkKSB7XG4gICAgICAgICAgICBjb25zdCByb29tID0gdGhpcy5jb250ZXh0LmdldFJvb20ocm9vbUlkKTtcbiAgICAgICAgICAgIGxldCBpbml0aWFsRXZlbnQgPSByb29tPy5maW5kRXZlbnRCeUlkKGluaXRpYWxFdmVudElkKTtcbiAgICAgICAgICAgIC8vIFRoZSBldmVudCBkb2VzIG5vdCBleGlzdCBpbiB0aGUgY3VycmVudCBzeW5jIGRhdGFcbiAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gZmV0Y2ggaXQgdG8ga25vdyB3aGV0aGVyIHRvIHJvdXRlIHRoaXMgcmVxdWVzdFxuICAgICAgICAgICAgLy8gdG8gdGhlIG1haW4gdGltZWxpbmUgb3IgdG8gYSB0aHJlYWRlZCBvbmVcbiAgICAgICAgICAgIC8vIEluIHRoZSBjdXJyZW50IHN0YXRlLCBpZiBhIHRocmVhZCBkb2VzIG5vdCBleGlzdCBpbiB0aGUgc3luYyBkYXRhXG4gICAgICAgICAgICAvLyBXZSB3aWxsIG9ubHkgZGlzcGxheSB0aGUgZXZlbnQgdGFyZ2V0ZWQgYnkgdGhlIGBtYXRyaXgudG9gIGxpbmtcbiAgICAgICAgICAgIC8vIGFuZCB0aGUgcm9vdCBldmVudC5cbiAgICAgICAgICAgIC8vIFRoZSByZXN0IHdpbGwgYmUgbG9zdCBmb3Igbm93LCB1bnRpbCB0aGUgYWdncmVnYXRpb24gQVBJIG9uIHRoZSBzZXJ2ZXJcbiAgICAgICAgICAgIC8vIGJlY29tZXMgYXZhaWxhYmxlIHRvIGZldGNoIGEgd2hvbGUgdGhyZWFkXG4gICAgICAgICAgICBpZiAoIWluaXRpYWxFdmVudCkge1xuICAgICAgICAgICAgICAgIGluaXRpYWxFdmVudCA9IGF3YWl0IGZldGNoSW5pdGlhbEV2ZW50KFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRleHQsXG4gICAgICAgICAgICAgICAgICAgIHJvb21JZCxcbiAgICAgICAgICAgICAgICAgICAgaW5pdGlhbEV2ZW50SWQsXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgdGhyZWFkID0gaW5pdGlhbEV2ZW50Py5nZXRUaHJlYWQoKTtcbiAgICAgICAgICAgIGlmICh0aHJlYWQgJiYgIWluaXRpYWxFdmVudD8uaXNUaHJlYWRSb290KSB7XG4gICAgICAgICAgICAgICAgZGlzcGF0Y2hTaG93VGhyZWFkRXZlbnQoXG4gICAgICAgICAgICAgICAgICAgIHRocmVhZC5yb290RXZlbnQsXG4gICAgICAgICAgICAgICAgICAgIGluaXRpYWxFdmVudCxcbiAgICAgICAgICAgICAgICAgICAgUm9vbVZpZXdTdG9yZS5pc0luaXRpYWxFdmVudEhpZ2hsaWdodGVkKCksXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbmV3U3RhdGUuaW5pdGlhbEV2ZW50SWQgPSBpbml0aWFsRXZlbnRJZDtcbiAgICAgICAgICAgICAgICBuZXdTdGF0ZS5pc0luaXRpYWxFdmVudEhpZ2hsaWdodGVkID0gUm9vbVZpZXdTdG9yZS5pc0luaXRpYWxFdmVudEhpZ2hsaWdodGVkKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhyZWFkICYmIGluaXRpYWxFdmVudD8uaXNUaHJlYWRSb290KSB7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoU2hvd1RocmVhZEV2ZW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyZWFkLnJvb3RFdmVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGluaXRpYWxFdmVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFJvb21WaWV3U3RvcmUuaXNJbml0aWFsRXZlbnRIaWdobGlnaHRlZCgpLFxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCB3YXRjaGVycyBmb3IgZWFjaCBvZiB0aGUgc2V0dGluZ3Mgd2UganVzdCBsb29rZWQgdXBcbiAgICAgICAgdGhpcy5zZXR0aW5nV2F0Y2hlcnMgPSB0aGlzLnNldHRpbmdXYXRjaGVycy5jb25jYXQoW1xuICAgICAgICAgICAgU2V0dGluZ3NTdG9yZS53YXRjaFNldHRpbmcoXCJzaG93UmVhZFJlY2VpcHRzXCIsIHJvb21JZCwgKC4uLlssLCwgdmFsdWVdKSA9PlxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBzaG93UmVhZFJlY2VpcHRzOiB2YWx1ZSBhcyBib29sZWFuIH0pLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIFNldHRpbmdzU3RvcmUud2F0Y2hTZXR0aW5nKFwic2hvd1JlZGFjdGlvbnNcIiwgcm9vbUlkLCAoLi4uWywsLCB2YWx1ZV0pID0+XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHNob3dSZWRhY3Rpb25zOiB2YWx1ZSBhcyBib29sZWFuIH0pLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIFNldHRpbmdzU3RvcmUud2F0Y2hTZXR0aW5nKFwic2hvd0pvaW5MZWF2ZXNcIiwgcm9vbUlkLCAoLi4uWywsLCB2YWx1ZV0pID0+XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHNob3dKb2luTGVhdmVzOiB2YWx1ZSBhcyBib29sZWFuIH0pLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIFNldHRpbmdzU3RvcmUud2F0Y2hTZXR0aW5nKFwic2hvd0F2YXRhckNoYW5nZXNcIiwgcm9vbUlkLCAoLi4uWywsLCB2YWx1ZV0pID0+XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHNob3dBdmF0YXJDaGFuZ2VzOiB2YWx1ZSBhcyBib29sZWFuIH0pLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIFNldHRpbmdzU3RvcmUud2F0Y2hTZXR0aW5nKFwic2hvd0Rpc3BsYXluYW1lQ2hhbmdlc1wiLCByb29tSWQsICguLi5bLCwsIHZhbHVlXSkgPT5cbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgc2hvd0Rpc3BsYXluYW1lQ2hhbmdlczogdmFsdWUgYXMgYm9vbGVhbiB9KSxcbiAgICAgICAgICAgICksXG4gICAgICAgIF0pO1xuXG4gICAgICAgIGlmICghaW5pdGlhbCAmJiB0aGlzLnN0YXRlLnNob3VsZFBlZWsgJiYgIW5ld1N0YXRlLnNob3VsZFBlZWspIHtcbiAgICAgICAgICAgIC8vIFN0b3AgcGVla2luZyBiZWNhdXNlIHdlIGhhdmUgam9pbmVkIHRoaXMgcm9vbSBub3dcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5zdG9wUGVla2luZygpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVGVtcG9yYXJ5IGxvZ2dpbmcgdG8gZGlhZ25vc2UgaHR0cHM6Ly9naXRodWIuY29tL3ZlY3Rvci1pbS9lbGVtZW50LXdlYi9pc3N1ZXMvNDMwN1xuICAgICAgICBsb2dnZXIubG9nKFxuICAgICAgICAgICAgJ1JWUyB1cGRhdGU6JyxcbiAgICAgICAgICAgIG5ld1N0YXRlLnJvb21JZCxcbiAgICAgICAgICAgIG5ld1N0YXRlLnJvb21BbGlhcyxcbiAgICAgICAgICAgICdsb2FkaW5nPycsIG5ld1N0YXRlLnJvb21Mb2FkaW5nLFxuICAgICAgICAgICAgJ2pvaW5pbmc/JywgbmV3U3RhdGUuam9pbmluZyxcbiAgICAgICAgICAgICdpbml0aWFsPycsIGluaXRpYWwsXG4gICAgICAgICAgICAnc2hvdWxkUGVlaz8nLCBuZXdTdGF0ZS5zaG91bGRQZWVrLFxuICAgICAgICApO1xuXG4gICAgICAgIC8vIE5COiBUaGlzIGRvZXMgYXNzdW1lIHRoYXQgdGhlIHJvb21JRCB3aWxsIG5vdCBjaGFuZ2UgZm9yIHRoZSBsaWZldGltZSBvZlxuICAgICAgICAvLyB0aGUgUm9vbVZpZXcgaW5zdGFuY2VcbiAgICAgICAgaWYgKGluaXRpYWwpIHtcbiAgICAgICAgICAgIG5ld1N0YXRlLnJvb20gPSB0aGlzLmNvbnRleHQuZ2V0Um9vbShuZXdTdGF0ZS5yb29tSWQpO1xuICAgICAgICAgICAgaWYgKG5ld1N0YXRlLnJvb20pIHtcbiAgICAgICAgICAgICAgICBuZXdTdGF0ZS5zaG93QXBwcyA9IHRoaXMuc2hvdWxkU2hvd0FwcHMobmV3U3RhdGUucm9vbSk7XG4gICAgICAgICAgICAgICAgdGhpcy5vblJvb21Mb2FkZWQobmV3U3RhdGUucm9vbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5zdGF0ZS5yb29tSWQgPT09IG51bGwgJiYgbmV3U3RhdGUucm9vbUlkICE9PSBudWxsKSB7XG4gICAgICAgICAgICAvLyBHZXQgdGhlIHNjcm9sbCBzdGF0ZSBmb3IgdGhlIG5ldyByb29tXG5cbiAgICAgICAgICAgIC8vIElmIGFuIGV2ZW50IElEIHdhc24ndCBzcGVjaWZpZWQsIGRlZmF1bHQgdG8gdGhlIG9uZSBzYXZlZCBmb3IgdGhpcyByb29tXG4gICAgICAgICAgICAvLyBpbiB0aGUgc2Nyb2xsIHN0YXRlIHN0b3JlLiBBc3N1bWUgaW5pdGlhbEV2ZW50UGl4ZWxPZmZzZXQgc2hvdWxkIGJlIHNldC5cbiAgICAgICAgICAgIGlmICghbmV3U3RhdGUuaW5pdGlhbEV2ZW50SWQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByb29tU2Nyb2xsU3RhdGUgPSBSb29tU2Nyb2xsU3RhdGVTdG9yZS5nZXRTY3JvbGxTdGF0ZShuZXdTdGF0ZS5yb29tSWQpO1xuICAgICAgICAgICAgICAgIGlmIChyb29tU2Nyb2xsU3RhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3U3RhdGUuaW5pdGlhbEV2ZW50SWQgPSByb29tU2Nyb2xsU3RhdGUuZm9jdXNzZWRFdmVudDtcbiAgICAgICAgICAgICAgICAgICAgbmV3U3RhdGUuaW5pdGlhbEV2ZW50UGl4ZWxPZmZzZXQgPSByb29tU2Nyb2xsU3RhdGUucGl4ZWxPZmZzZXQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2xlYXIgdGhlIHNlYXJjaCByZXN1bHRzIHdoZW4gY2xpY2tpbmcgYSBzZWFyY2ggcmVzdWx0ICh3aGljaCBjaGFuZ2VzIHRoZVxuICAgICAgICAvLyBjdXJyZW50bHkgc2Nyb2xsZWQgdG8gZXZlbnQsIHRoaXMuc3RhdGUuaW5pdGlhbEV2ZW50SWQpLlxuICAgICAgICBpZiAodGhpcy5zdGF0ZS5pbml0aWFsRXZlbnRJZCAhPT0gbmV3U3RhdGUuaW5pdGlhbEV2ZW50SWQpIHtcbiAgICAgICAgICAgIG5ld1N0YXRlLnNlYXJjaFJlc3VsdHMgPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zZXRTdGF0ZShuZXdTdGF0ZSk7XG4gICAgICAgIC8vIEF0IHRoaXMgcG9pbnQsIG5ld1N0YXRlLnJvb21JZCBjb3VsZCBiZSBudWxsIChlLmcuIHRoZSBhbGlhcyBtaWdodCBub3RcbiAgICAgICAgLy8gaGF2ZSBiZWVuIHJlc29sdmVkIHlldCkgc28gYW55dGhpbmcgY2FsbGVkIGhlcmUgbXVzdCBoYW5kbGUgdGhpcyBjYXNlLlxuXG4gICAgICAgIC8vIFdlIHBhc3MgdGhlIG5ldyBzdGF0ZSBpbnRvIHRoaXMgZnVuY3Rpb24gZm9yIGl0IHRvIHJlYWQ6IGl0IG5lZWRzIHRvXG4gICAgICAgIC8vIG9ic2VydmUgdGhlIG5ldyBzdGF0ZSBidXQgd2UgZG9uJ3Qgd2FudCB0byBwdXQgaXQgaW4gdGhlIHNldFN0YXRlXG4gICAgICAgIC8vIGNhbGxiYWNrIGJlY2F1c2UgdGhpcyB3b3VsZCBwcmV2ZW50IHRoZSBzZXRTdGF0ZXMgZnJvbSBiZWluZyBiYXRjaGVkLFxuICAgICAgICAvLyBpZS4gY2F1c2UgaXQgdG8gcmVuZGVyIFJvb21WaWV3IHR3aWNlIHJhdGhlciB0aGFuIHRoZSBvbmNlIHRoYXQgaXMgbmVjZXNzYXJ5LlxuICAgICAgICBpZiAoaW5pdGlhbCkge1xuICAgICAgICAgICAgdGhpcy5zZXR1cFJvb20obmV3U3RhdGUucm9vbSwgbmV3U3RhdGUucm9vbUlkLCBuZXdTdGF0ZS5qb2luaW5nLCBuZXdTdGF0ZS5zaG91bGRQZWVrKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwcml2YXRlIGdldFJvb21JZCA9ICgpID0+IHtcbiAgICAgICAgLy8gQWNjb3JkaW5nIHRvIGBvblJvb21WaWV3U3RvcmVVcGRhdGVgLCBgc3RhdGUucm9vbUlkYCBjYW4gYmUgbnVsbFxuICAgICAgICAvLyBpZiB3ZSBoYXZlIGEgcm9vbSBhbGlhcyB3ZSBoYXZlbid0IHJlc29sdmVkIHlldC4gVG8gd29yayBhcm91bmQgdGhpcyxcbiAgICAgICAgLy8gZmlyc3Qgd2UnbGwgdHJ5IHRoZSByb29tIG9iamVjdCBpZiBpdCdzIHRoZXJlLCBhbmQgdGhlbiBmYWxsYmFjayB0b1xuICAgICAgICAvLyB0aGUgYmFyZSByb29tIElELiAoV2UgbWF5IHdhbnQgdG8gdXBkYXRlIGBzdGF0ZS5yb29tSWRgIGFmdGVyXG4gICAgICAgIC8vIHJlc29sdmluZyBhbGlhc2VzLCBzbyB3ZSBjb3VsZCBhbHdheXMgdHJ1c3QgaXQuKVxuICAgICAgICByZXR1cm4gdGhpcy5zdGF0ZS5yb29tID8gdGhpcy5zdGF0ZS5yb29tLnJvb21JZCA6IHRoaXMuc3RhdGUucm9vbUlkO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGdldFBlcm1hbGlua0NyZWF0b3JGb3JSb29tKHJvb206IFJvb20pIHtcbiAgICAgICAgaWYgKHRoaXMucGVybWFsaW5rQ3JlYXRvcnNbcm9vbS5yb29tSWRdKSByZXR1cm4gdGhpcy5wZXJtYWxpbmtDcmVhdG9yc1tyb29tLnJvb21JZF07XG5cbiAgICAgICAgdGhpcy5wZXJtYWxpbmtDcmVhdG9yc1tyb29tLnJvb21JZF0gPSBuZXcgUm9vbVBlcm1hbGlua0NyZWF0b3Iocm9vbSk7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLnJvb20gJiYgcm9vbS5yb29tSWQgPT09IHRoaXMuc3RhdGUucm9vbS5yb29tSWQpIHtcbiAgICAgICAgICAgIC8vIFdlIHdhbnQgdG8gd2F0Y2ggZm9yIGNoYW5nZXMgaW4gdGhlIGNyZWF0b3IgZm9yIHRoZSBwcmltYXJ5IHJvb20gaW4gdGhlIHZpZXcsIGJ1dFxuICAgICAgICAgICAgLy8gZG9uJ3QgbmVlZCB0byBkbyBzbyBmb3Igc2VhcmNoIHJlc3VsdHMuXG4gICAgICAgICAgICB0aGlzLnBlcm1hbGlua0NyZWF0b3JzW3Jvb20ucm9vbUlkXS5zdGFydCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5wZXJtYWxpbmtDcmVhdG9yc1tyb29tLnJvb21JZF0ubG9hZCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnBlcm1hbGlua0NyZWF0b3JzW3Jvb20ucm9vbUlkXTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHN0b3BBbGxQZXJtYWxpbmtDcmVhdG9ycygpIHtcbiAgICAgICAgaWYgKCF0aGlzLnBlcm1hbGlua0NyZWF0b3JzKSByZXR1cm47XG4gICAgICAgIGZvciAoY29uc3Qgcm9vbUlkIG9mIE9iamVjdC5rZXlzKHRoaXMucGVybWFsaW5rQ3JlYXRvcnMpKSB7XG4gICAgICAgICAgICB0aGlzLnBlcm1hbGlua0NyZWF0b3JzW3Jvb21JZF0uc3RvcCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZXR1cFJvb20ocm9vbTogUm9vbSwgcm9vbUlkOiBzdHJpbmcsIGpvaW5pbmc6IGJvb2xlYW4sIHNob3VsZFBlZWs6IGJvb2xlYW4pIHtcbiAgICAgICAgLy8gaWYgdGhpcyBpcyBhbiB1bmtub3duIHJvb20gdGhlbiB3ZSdyZSBpbiBvbmUgb2YgdGhyZWUgc3RhdGVzOlxuICAgICAgICAvLyAtIFRoaXMgaXMgYSByb29tIHdlIGNhbiBwZWVrIGludG8gKHNlYXJjaCBlbmdpbmUpICh3ZSBjYW4gL3BlZWspXG4gICAgICAgIC8vIC0gVGhpcyBpcyBhIHJvb20gd2UgY2FuIHB1YmxpY2x5IGpvaW4gb3Igd2VyZSBpbnZpdGVkIHRvLiAod2UgY2FuIC9qb2luKVxuICAgICAgICAvLyAtIFRoaXMgaXMgYSByb29tIHdlIGNhbm5vdCBqb2luIGF0IGFsbC4gKG5vIGFjdGlvbiBjYW4gaGVscCB1cylcbiAgICAgICAgLy8gV2UgY2FuJ3QgdHJ5IHRvIC9qb2luIGJlY2F1c2UgdGhpcyBtYXkgaW1wbGljaXRseSBhY2NlcHQgaW52aXRlcyAoISlcbiAgICAgICAgLy8gV2UgY2FuIC9wZWVrIHRob3VnaC4gSWYgaXQgZmFpbHMgdGhlbiB3ZSBwcmVzZW50IHRoZSBqb2luIFVJLiBJZiBpdFxuICAgICAgICAvLyBzdWNjZWVkcyB0aGVuIGdyZWF0LCBzaG93IHRoZSBwcmV2aWV3IChidXQgd2Ugc3RpbGwgbWF5IGJlIGFibGUgdG8gL2pvaW4hKS5cbiAgICAgICAgLy8gTm90ZSB0aGF0IHBlZWtpbmcgd29ya3MgYnkgcm9vbSBJRCBhbmQgcm9vbSBJRCBvbmx5LCBhcyBvcHBvc2VkIHRvIGpvaW5pbmdcbiAgICAgICAgLy8gd2hpY2ggbXVzdCBiZSBieSBhbGlhcyBvciBpbnZpdGUgd2hlcmV2ZXIgcG9zc2libGUgKHBlZWtpbmcgY3VycmVudGx5IGRvZXNcbiAgICAgICAgLy8gbm90IHdvcmsgb3ZlciBmZWRlcmF0aW9uKS5cblxuICAgICAgICAvLyBOQi4gV2UgcGVlayBpZiB3ZSBoYXZlIG5ldmVyIHNlZW4gdGhlIHJvb20gYmVmb3JlIChpLmUuIGpzLXNkayBkb2VzIG5vdCBrbm93XG4gICAgICAgIC8vIGFib3V0IGl0KS4gV2UgZG9uJ3QgcGVlayBpbiB0aGUgaGlzdG9yaWNhbCBjYXNlIHdoZXJlIHdlIHdlcmUgam9pbmVkIGJ1dCBhcmVcbiAgICAgICAgLy8gbm93IG5vdCBqb2luZWQgYmVjYXVzZSB0aGUganMtc2RrIHBlZWtpbmcgQVBJIHdpbGwgY2xvYmJlciBvdXIgaGlzdG9yaWNhbCByb29tLFxuICAgICAgICAvLyBtYWtpbmcgaXQgaW1wb3NzaWJsZSB0byBpbmRpY2F0ZSBhIG5ld2x5IGpvaW5lZCByb29tLlxuICAgICAgICBpZiAoIWpvaW5pbmcgJiYgcm9vbUlkKSB7XG4gICAgICAgICAgICBpZiAoIXJvb20gJiYgc2hvdWxkUGVlaykge1xuICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKFwiQXR0ZW1wdGluZyB0byBwZWVrIGludG8gcm9vbSAlc1wiLCByb29tSWQpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICBwZWVrTG9hZGluZzogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaXNQZWVraW5nOiB0cnVlLCAvLyB0aGlzIHdpbGwgY2hhbmdlIHRvIGZhbHNlIGlmIHBlZWtpbmcgZmFpbHNcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRleHQucGVla0luUm9vbShyb29tSWQpLnRoZW4oKHJvb20pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudW5tb3VudGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICByb29tOiByb29tLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGVla0xvYWRpbmc6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vblJvb21Mb2FkZWQocm9vbSk7XG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy51bm1vdW50ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIFN0b3AgcGVla2luZyBpZiBhbnl0aGluZyB3ZW50IHdyb25nXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNQZWVraW5nOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyB3b24ndCBuZWNlc3NhcmlseSBiZSBhIE1hdHJpeEVycm9yLCBidXQgd2UgZHVjay10eXBlXG4gICAgICAgICAgICAgICAgICAgIC8vIGhlcmUgYW5kIHNheSBpZiBpdCdzIGdvdCBhbiAnZXJyY29kZScga2V5IHdpdGggdGhlIHJpZ2h0IHZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAvLyBpdCBtZWFucyB3ZSBjYW4ndCBwZWVrLlxuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyLmVycmNvZGUgPT09IFwiTV9HVUVTVF9BQ0NFU1NfRk9SQklEREVOXCIgfHwgZXJyLmVycmNvZGUgPT09ICdNX0ZPUkJJRERFTicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgZmluZTogdGhlIHJvb20ganVzdCBpc24ndCBwZWVrYWJsZSAod2UgYXNzdW1lKS5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlZWtMb2FkaW5nOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJvb20pIHtcbiAgICAgICAgICAgICAgICAvLyBTdG9wIHBlZWtpbmcgYmVjYXVzZSB3ZSBoYXZlIGpvaW5lZCB0aGlzIHJvb20gcHJldmlvdXNseVxuICAgICAgICAgICAgICAgIHRoaXMuY29udGV4dC5zdG9wUGVla2luZygpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBpc1BlZWtpbmc6IGZhbHNlIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzaG91bGRTaG93QXBwcyhyb29tOiBSb29tKSB7XG4gICAgICAgIGlmICghQlJPV1NFUl9TVVBQT1JUU19TQU5EQk9YIHx8ICFyb29tKSByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgdXNlciBoYXMgcHJldmlvdXNseSBjaG9zZW4gdG8gaGlkZSB0aGUgYXBwIGRyYXdlciBmb3IgdGhpc1xuICAgICAgICAvLyByb29tLiBJZiBzbywgZG8gbm90IHNob3cgYXBwc1xuICAgICAgICBjb25zdCBoaWRlV2lkZ2V0S2V5ID0gcm9vbS5yb29tSWQgKyBcIl9oaWRlX3dpZGdldF9kcmF3ZXJcIjtcbiAgICAgICAgY29uc3QgaGlkZVdpZGdldERyYXdlciA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGhpZGVXaWRnZXRLZXkpO1xuXG4gICAgICAgIC8vIElmIHVuc2V0IHNob3cgdGhlIFRyYXlcbiAgICAgICAgLy8gT3RoZXJ3aXNlIChpbiBjYXNlIHRoZSB1c2VyIHNldCBoaWRlV2lkZ2V0RHJhd2VyIGJ5IGNsaWNraW5nIHRoZSBidXR0b24pIGZvbGxvdyB0aGUgcGFyYW1ldGVyLlxuICAgICAgICBjb25zdCBpc01hbnVhbGx5U2hvd24gPSBoaWRlV2lkZ2V0RHJhd2VyID8gaGlkZVdpZGdldERyYXdlciA9PT0gXCJmYWxzZVwiOiB0cnVlO1xuXG4gICAgICAgIGNvbnN0IHdpZGdldHMgPSBXaWRnZXRMYXlvdXRTdG9yZS5pbnN0YW5jZS5nZXRDb250YWluZXJXaWRnZXRzKHJvb20sIENvbnRhaW5lci5Ub3ApO1xuICAgICAgICByZXR1cm4gaXNNYW51YWxseVNob3duICYmIHdpZGdldHMubGVuZ3RoID4gMDtcbiAgICB9XG5cbiAgICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgICAgdGhpcy5vblJvb21WaWV3U3RvcmVVcGRhdGUodHJ1ZSk7XG5cbiAgICAgICAgY29uc3QgY2FsbCA9IHRoaXMuZ2V0Q2FsbEZvclJvb20oKTtcbiAgICAgICAgY29uc3QgY2FsbFN0YXRlID0gY2FsbCA/IGNhbGwuc3RhdGUgOiBudWxsO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGNhbGxTdGF0ZTogY2FsbFN0YXRlLFxuICAgICAgICB9KTtcblxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignYmVmb3JldW5sb2FkJywgdGhpcy5vblBhZ2VVbmxvYWQpO1xuICAgIH1cblxuICAgIHNob3VsZENvbXBvbmVudFVwZGF0ZShuZXh0UHJvcHMsIG5leHRTdGF0ZSkge1xuICAgICAgICBjb25zdCBoYXNQcm9wc0RpZmYgPSBvYmplY3RIYXNEaWZmKHRoaXMucHJvcHMsIG5leHRQcm9wcyk7XG5cbiAgICAgICAgY29uc3QgeyB1cGdyYWRlUmVjb21tZW5kYXRpb24sIC4uLnN0YXRlIH0gPSB0aGlzLnN0YXRlO1xuICAgICAgICBjb25zdCB7IHVwZ3JhZGVSZWNvbW1lbmRhdGlvbjogbmV3VXBncmFkZVJlY29tbWVuZGF0aW9uLCAuLi5uZXdTdGF0ZSB9ID0gbmV4dFN0YXRlO1xuXG4gICAgICAgIGNvbnN0IGhhc1N0YXRlRGlmZiA9XG4gICAgICAgICAgICBuZXdVcGdyYWRlUmVjb21tZW5kYXRpb24/Lm5lZWRzVXBncmFkZSAhPT0gdXBncmFkZVJlY29tbWVuZGF0aW9uPy5uZWVkc1VwZ3JhZGUgfHxcbiAgICAgICAgICAgIG9iamVjdEhhc0RpZmYoc3RhdGUsIG5ld1N0YXRlKTtcblxuICAgICAgICByZXR1cm4gaGFzUHJvcHNEaWZmIHx8IGhhc1N0YXRlRGlmZjtcbiAgICB9XG5cbiAgICBjb21wb25lbnREaWRVcGRhdGUoKSB7XG4gICAgICAgIGlmICh0aGlzLnJvb21WaWV3LmN1cnJlbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IHJvb21WaWV3ID0gdGhpcy5yb29tVmlldy5jdXJyZW50O1xuICAgICAgICAgICAgaWYgKCFyb29tVmlldy5vbmRyb3ApIHtcbiAgICAgICAgICAgICAgICByb29tVmlldy5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgdGhpcy5vbkRyb3ApO1xuICAgICAgICAgICAgICAgIHJvb21WaWV3LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdvdmVyJywgdGhpcy5vbkRyYWdPdmVyKTtcbiAgICAgICAgICAgICAgICByb29tVmlldy5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW50ZXInLCB0aGlzLm9uRHJhZ0VudGVyKTtcbiAgICAgICAgICAgICAgICByb29tVmlldy5hZGRFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCB0aGlzLm9uRHJhZ0xlYXZlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE5vdGU6IFdlIGNoZWNrIHRoZSByZWYgaGVyZSB3aXRoIGEgZmxhZyBiZWNhdXNlIGNvbXBvbmVudERpZE1vdW50LCBkZXNwaXRlXG4gICAgICAgIC8vIGRvY3VtZW50YXRpb24sIGRvZXMgbm90IGRlZmluZSBvdXIgbWVzc2FnZVBhbmVsIHJlZi4gSXQgbG9va3MgbGlrZSBvdXIgc3Bpbm5lclxuICAgICAgICAvLyBpbiByZW5kZXIoKSBwcmV2ZW50cyB0aGUgcmVmIGZyb20gYmVpbmcgc2V0IG9uIGZpcnN0IG1vdW50LCBzbyB3ZSB0cnkgYW5kXG4gICAgICAgIC8vIGNhdGNoIHRoZSBtZXNzYWdlUGFuZWwgd2hlbiBpdCBkb2VzIG1vdW50LiBCZWNhdXNlIHdlIG9ubHkgd2FudCB0aGUgcmVmIG9uY2UsXG4gICAgICAgIC8vIHdlIHVzZSBhIGJvb2xlYW4gZmxhZyB0byBhdm9pZCBkdXBsaWNhdGUgd29yay5cbiAgICAgICAgaWYgKHRoaXMubWVzc2FnZVBhbmVsICYmICF0aGlzLnN0YXRlLmF0RW5kT2ZMaXZlVGltZWxpbmVJbml0KSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICBhdEVuZE9mTGl2ZVRpbWVsaW5lSW5pdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBhdEVuZE9mTGl2ZVRpbWVsaW5lOiB0aGlzLm1lc3NhZ2VQYW5lbC5pc0F0RW5kT2ZMaXZlVGltZWxpbmUoKSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgICAgIC8vIHNldCBhIGJvb2xlYW4gdG8gc2F5IHdlJ3ZlIGJlZW4gdW5tb3VudGVkLCB3aGljaCBhbnkgcGVuZGluZ1xuICAgICAgICAvLyBwcm9taXNlcyBjYW4gdXNlIHRvIHRocm93IGF3YXkgdGhlaXIgcmVzdWx0cy5cbiAgICAgICAgLy9cbiAgICAgICAgLy8gKFdlIGNvdWxkIHVzZSBpc01vdW50ZWQsIGJ1dCBmYWNlYm9vayBoYXZlIGRlcHJlY2F0ZWQgdGhhdC4pXG4gICAgICAgIHRoaXMudW5tb3VudGVkID0gdHJ1ZTtcblxuICAgICAgICAvLyB1cGRhdGUgdGhlIHNjcm9sbCBtYXAgYmVmb3JlIHdlIGdldCB1bm1vdW50ZWRcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUucm9vbUlkKSB7XG4gICAgICAgICAgICBSb29tU2Nyb2xsU3RhdGVTdG9yZS5zZXRTY3JvbGxTdGF0ZSh0aGlzLnN0YXRlLnJvb21JZCwgdGhpcy5nZXRTY3JvbGxTdGF0ZSgpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnN0YXRlLnNob3VsZFBlZWspIHtcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5zdG9wUGVla2luZygpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gc3RvcCB0cmFja2luZyByb29tIGNoYW5nZXMgdG8gZm9ybWF0IHBlcm1hbGlua3NcbiAgICAgICAgdGhpcy5zdG9wQWxsUGVybWFsaW5rQ3JlYXRvcnMoKTtcblxuICAgICAgICBpZiAodGhpcy5yb29tVmlldy5jdXJyZW50KSB7XG4gICAgICAgICAgICAvLyBkaXNjb25uZWN0IHRoZSBEJkQgZXZlbnQgbGlzdGVuZXJzIGZyb20gdGhlIHJvb20gdmlldy4gVGhpc1xuICAgICAgICAgICAgLy8gaXMgcmVhbGx5IGp1c3QgZm9yIGh5Z2llbmUgLSB3ZSdyZSBnb2luZyB0byBiZVxuICAgICAgICAgICAgLy8gZGVsZXRlZCBhbnl3YXksIHNvIGl0IGRvZXNuJ3QgbWF0dGVyIGlmIHRoZSBldmVudCBsaXN0ZW5lcnNcbiAgICAgICAgICAgIC8vIGRvbid0IGdldCBjbGVhbmVkIHVwLlxuICAgICAgICAgICAgY29uc3Qgcm9vbVZpZXcgPSB0aGlzLnJvb21WaWV3LmN1cnJlbnQ7XG4gICAgICAgICAgICByb29tVmlldy5yZW1vdmVFdmVudExpc3RlbmVyKCdkcm9wJywgdGhpcy5vbkRyb3ApO1xuICAgICAgICAgICAgcm9vbVZpZXcucmVtb3ZlRXZlbnRMaXN0ZW5lcignZHJhZ292ZXInLCB0aGlzLm9uRHJhZ092ZXIpO1xuICAgICAgICAgICAgcm9vbVZpZXcucmVtb3ZlRXZlbnRMaXN0ZW5lcignZHJhZ2VudGVyJywgdGhpcy5vbkRyYWdFbnRlcik7XG4gICAgICAgICAgICByb29tVmlldy5yZW1vdmVFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCB0aGlzLm9uRHJhZ0xlYXZlKTtcbiAgICAgICAgfVxuICAgICAgICBkaXMudW5yZWdpc3Rlcih0aGlzLmRpc3BhdGNoZXJSZWYpO1xuICAgICAgICBpZiAodGhpcy5jb250ZXh0KSB7XG4gICAgICAgICAgICB0aGlzLmNvbnRleHQucmVtb3ZlTGlzdGVuZXIoXCJSb29tXCIsIHRoaXMub25Sb29tKTtcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5yZW1vdmVMaXN0ZW5lcihcIlJvb20udGltZWxpbmVcIiwgdGhpcy5vblJvb21UaW1lbGluZSk7XG4gICAgICAgICAgICB0aGlzLmNvbnRleHQucmVtb3ZlTGlzdGVuZXIoXCJSb29tLm5hbWVcIiwgdGhpcy5vblJvb21OYW1lKTtcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5yZW1vdmVMaXN0ZW5lcihcIlJvb20uYWNjb3VudERhdGFcIiwgdGhpcy5vblJvb21BY2NvdW50RGF0YSk7XG4gICAgICAgICAgICB0aGlzLmNvbnRleHQucmVtb3ZlTGlzdGVuZXIoXCJSb29tU3RhdGUuZXZlbnRzXCIsIHRoaXMub25Sb29tU3RhdGVFdmVudHMpO1xuICAgICAgICAgICAgdGhpcy5jb250ZXh0LnJlbW92ZUxpc3RlbmVyKFwiUm9vbS5teU1lbWJlcnNoaXBcIiwgdGhpcy5vbk15TWVtYmVyc2hpcCk7XG4gICAgICAgICAgICB0aGlzLmNvbnRleHQucmVtb3ZlTGlzdGVuZXIoXCJSb29tU3RhdGUubWVtYmVyc1wiLCB0aGlzLm9uUm9vbVN0YXRlTWVtYmVyKTtcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5yZW1vdmVMaXN0ZW5lcihcImFjY291bnREYXRhXCIsIHRoaXMub25BY2NvdW50RGF0YSk7XG4gICAgICAgICAgICB0aGlzLmNvbnRleHQucmVtb3ZlTGlzdGVuZXIoXCJjcnlwdG8ua2V5QmFja3VwU3RhdHVzXCIsIHRoaXMub25LZXlCYWNrdXBTdGF0dXMpO1xuICAgICAgICAgICAgdGhpcy5jb250ZXh0LnJlbW92ZUxpc3RlbmVyKFwiZGV2aWNlVmVyaWZpY2F0aW9uQ2hhbmdlZFwiLCB0aGlzLm9uRGV2aWNlVmVyaWZpY2F0aW9uQ2hhbmdlZCk7XG4gICAgICAgICAgICB0aGlzLmNvbnRleHQucmVtb3ZlTGlzdGVuZXIoXCJ1c2VyVHJ1c3RTdGF0dXNDaGFuZ2VkXCIsIHRoaXMub25Vc2VyVmVyaWZpY2F0aW9uQ2hhbmdlZCk7XG4gICAgICAgICAgICB0aGlzLmNvbnRleHQucmVtb3ZlTGlzdGVuZXIoXCJjcm9zc1NpZ25pbmcua2V5c0NoYW5nZWRcIiwgdGhpcy5vbkNyb3NzU2lnbmluZ0tleXNDaGFuZ2VkKTtcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5yZW1vdmVMaXN0ZW5lcihcIkV2ZW50LmRlY3J5cHRlZFwiLCB0aGlzLm9uRXZlbnREZWNyeXB0ZWQpO1xuICAgICAgICB9XG5cbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2JlZm9yZXVubG9hZCcsIHRoaXMub25QYWdlVW5sb2FkKTtcblxuICAgICAgICAvLyBSZW1vdmUgUm9vbVN0b3JlIGxpc3RlbmVyXG4gICAgICAgIGlmICh0aGlzLnJvb21TdG9yZVRva2VuKSB7XG4gICAgICAgICAgICB0aGlzLnJvb21TdG9yZVRva2VuLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFJlbW92ZSBSaWdodFBhbmVsU3RvcmUgbGlzdGVuZXJcbiAgICAgICAgaWYgKHRoaXMucmlnaHRQYW5lbFN0b3JlVG9rZW4pIHtcbiAgICAgICAgICAgIHRoaXMucmlnaHRQYW5lbFN0b3JlVG9rZW4ucmVtb3ZlKCk7XG4gICAgICAgIH1cblxuICAgICAgICBXaWRnZXRFY2hvU3RvcmUucmVtb3ZlTGlzdGVuZXIoVVBEQVRFX0VWRU5ULCB0aGlzLm9uV2lkZ2V0RWNob1N0b3JlVXBkYXRlKTtcbiAgICAgICAgV2lkZ2V0U3RvcmUuaW5zdGFuY2UucmVtb3ZlTGlzdGVuZXIoVVBEQVRFX0VWRU5ULCB0aGlzLm9uV2lkZ2V0U3RvcmVVcGRhdGUpO1xuXG4gICAgICAgIGlmICh0aGlzLnN0YXRlLnJvb20pIHtcbiAgICAgICAgICAgIFdpZGdldExheW91dFN0b3JlLmluc3RhbmNlLm9mZihcbiAgICAgICAgICAgICAgICBXaWRnZXRMYXlvdXRTdG9yZS5lbWlzc2lvbkZvclJvb20odGhpcy5zdGF0ZS5yb29tKSxcbiAgICAgICAgICAgICAgICB0aGlzLm9uV2lkZ2V0TGF5b3V0Q2hhbmdlLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGNhbmNlbCBhbnkgcGVuZGluZyBjYWxscyB0byB0aGUgdGhyb3R0bGVkIHVwZGF0ZWRcbiAgICAgICAgdGhpcy51cGRhdGVSb29tTWVtYmVycy5jYW5jZWwoKTtcblxuICAgICAgICBmb3IgKGNvbnN0IHdhdGNoZXIgb2YgdGhpcy5zZXR0aW5nV2F0Y2hlcnMpIHtcbiAgICAgICAgICAgIFNldHRpbmdzU3RvcmUudW53YXRjaFNldHRpbmcod2F0Y2hlcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIG9uVXNlclNjcm9sbCA9ICgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuaW5pdGlhbEV2ZW50SWQgJiYgdGhpcy5zdGF0ZS5pc0luaXRpYWxFdmVudEhpZ2hsaWdodGVkKSB7XG4gICAgICAgICAgICBkaXMuZGlzcGF0Y2goe1xuICAgICAgICAgICAgICAgIGFjdGlvbjogQWN0aW9uLlZpZXdSb29tLFxuICAgICAgICAgICAgICAgIHJvb21faWQ6IHRoaXMuc3RhdGUucm9vbS5yb29tSWQsXG4gICAgICAgICAgICAgICAgZXZlbnRfaWQ6IHRoaXMuc3RhdGUuaW5pdGlhbEV2ZW50SWQsXG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHJlcGx5aW5nVG9FdmVudDogdGhpcy5zdGF0ZS5yZXBseVRvRXZlbnQsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwcml2YXRlIG9uUmlnaHRQYW5lbFN0b3JlVXBkYXRlID0gKCkgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIHNob3dSaWdodFBhbmVsOiBSaWdodFBhbmVsU3RvcmUuZ2V0U2hhcmVkSW5zdGFuY2UoKS5pc09wZW5Gb3JSb29tLFxuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvblBhZ2VVbmxvYWQgPSBldmVudCA9PiB7XG4gICAgICAgIGlmIChDb250ZW50TWVzc2FnZXMuc2hhcmVkSW5zdGFuY2UoKS5nZXRDdXJyZW50VXBsb2FkcygpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHJldHVybiBldmVudC5yZXR1cm5WYWx1ZSA9XG4gICAgICAgICAgICAgICAgX3QoXCJZb3Ugc2VlbSB0byBiZSB1cGxvYWRpbmcgZmlsZXMsIGFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBxdWl0P1wiKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmdldENhbGxGb3JSb29tKCkgJiYgdGhpcy5zdGF0ZS5jYWxsU3RhdGUgIT09ICdlbmRlZCcpIHtcbiAgICAgICAgICAgIHJldHVybiBldmVudC5yZXR1cm5WYWx1ZSA9XG4gICAgICAgICAgICAgICAgX3QoXCJZb3Ugc2VlbSB0byBiZSBpbiBhIGNhbGwsIGFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBxdWl0P1wiKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwcml2YXRlIG9uUmVhY3RLZXlEb3duID0gZXYgPT4ge1xuICAgICAgICBsZXQgaGFuZGxlZCA9IGZhbHNlO1xuXG4gICAgICAgIGNvbnN0IGFjdGlvbiA9IGdldEtleUJpbmRpbmdzTWFuYWdlcigpLmdldFJvb21BY3Rpb24oZXYpO1xuICAgICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICAgICAgY2FzZSBSb29tQWN0aW9uLkRpc21pc3NSZWFkTWFya2VyOlxuICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZVBhbmVsLmZvcmdldFJlYWRNYXJrZXIoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmp1bXBUb0xpdmVUaW1lbGluZSgpO1xuICAgICAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBSb29tQWN0aW9uLkp1bXBUb09sZGVzdFVucmVhZDpcbiAgICAgICAgICAgICAgICB0aGlzLmp1bXBUb1JlYWRNYXJrZXIoKTtcbiAgICAgICAgICAgICAgICBoYW5kbGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgUm9vbUFjdGlvbi5VcGxvYWRGaWxlOlxuICAgICAgICAgICAgICAgIGRpcy5kaXNwYXRjaCh7IGFjdGlvbjogXCJ1cGxvYWRfZmlsZVwiIH0sIHRydWUpO1xuICAgICAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGhhbmRsZWQpIHtcbiAgICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwcml2YXRlIG9uQWN0aW9uID0gcGF5bG9hZCA9PiB7XG4gICAgICAgIHN3aXRjaCAocGF5bG9hZC5hY3Rpb24pIHtcbiAgICAgICAgICAgIGNhc2UgJ21lc3NhZ2Vfc2VudCc6XG4gICAgICAgICAgICAgICAgdGhpcy5jaGVja0Rlc2t0b3BOb3RpZmljYXRpb25zKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdwb3N0X3N0aWNrZXJfbWVzc2FnZSc6XG4gICAgICAgICAgICAgICAgdGhpcy5pbmplY3RTdGlja2VyKFxuICAgICAgICAgICAgICAgICAgICBwYXlsb2FkLmRhdGEuY29udGVudC51cmwsXG4gICAgICAgICAgICAgICAgICAgIHBheWxvYWQuZGF0YS5jb250ZW50LmluZm8sXG4gICAgICAgICAgICAgICAgICAgIHBheWxvYWQuZGF0YS5kZXNjcmlwdGlvbiB8fCBwYXlsb2FkLmRhdGEubmFtZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdwaWN0dXJlX3NuYXBzaG90JzpcbiAgICAgICAgICAgICAgICBDb250ZW50TWVzc2FnZXMuc2hhcmVkSW5zdGFuY2UoKS5zZW5kQ29udGVudExpc3RUb1Jvb20oXG4gICAgICAgICAgICAgICAgICAgIFtwYXlsb2FkLmZpbGVdLCB0aGlzLnN0YXRlLnJvb20ucm9vbUlkLCBudWxsLCB0aGlzLmNvbnRleHQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnbm90aWZpZXJfZW5hYmxlZCc6XG4gICAgICAgICAgICBjYXNlIEFjdGlvbi5VcGxvYWRTdGFydGVkOlxuICAgICAgICAgICAgY2FzZSBBY3Rpb24uVXBsb2FkRmluaXNoZWQ6XG4gICAgICAgICAgICBjYXNlIEFjdGlvbi5VcGxvYWRDYW5jZWxlZDpcbiAgICAgICAgICAgICAgICB0aGlzLmZvcmNlVXBkYXRlKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdjYWxsX3N0YXRlJzoge1xuICAgICAgICAgICAgICAgIC8vIGRvbid0IGZpbHRlciBvdXQgcGF5bG9hZHMgZm9yIHJvb20gSURzIG90aGVyIHRoYW4gcHJvcHMucm9vbSBiZWNhdXNlXG4gICAgICAgICAgICAgICAgLy8gd2UgbWF5IGJlIGludGVyZXN0ZWQgaW4gdGhlIGNvbmYgMToxIHJvb21cblxuICAgICAgICAgICAgICAgIGlmICghcGF5bG9hZC5yb29tX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zdCBjYWxsID0gdGhpcy5nZXRDYWxsRm9yUm9vbSgpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxTdGF0ZTogY2FsbCA/IGNhbGwuc3RhdGUgOiBudWxsLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSAnYXBwc0RyYXdlcic6XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIHNob3dBcHBzOiBwYXlsb2FkLnNob3csXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdyZXBseV90b19ldmVudCc6XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhdGUuc2VhcmNoUmVzdWx0c1xuICAgICAgICAgICAgICAgICAgICAgICAgJiYgcGF5bG9hZC5ldmVudC5nZXRSb29tSWQoKSA9PT0gdGhpcy5zdGF0ZS5yb29tSWRcbiAgICAgICAgICAgICAgICAgICAgICAgICYmICF0aGlzLnVubW91bnRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgcGF5bG9hZC5jb250ZXh0ID09PSBUaW1lbGluZVJlbmRlcmluZ1R5cGUuUm9vbSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQ2FuY2VsU2VhcmNoQ2xpY2soKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdxdW90ZSc6XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhdGUuc2VhcmNoUmVzdWx0cykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByb29tSWQgPSBwYXlsb2FkLmV2ZW50LmdldFJvb21JZCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocm9vbUlkID09PSB0aGlzLnN0YXRlLnJvb21JZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkNhbmNlbFNlYXJjaENsaWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBzZXRJbW1lZGlhdGUoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGlzLmRpc3BhdGNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb246IEFjdGlvbi5WaWV3Um9vbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb29tX2lkOiByb29tSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWRfYWN0aW9uOiBwYXlsb2FkLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3N5bmNfc3RhdGUnOlxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5zdGF0ZS5tYXRyaXhDbGllbnRJc1JlYWR5KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWF0cml4Q2xpZW50SXNSZWFkeTogdGhpcy5jb250ZXh0ICYmIHRoaXMuY29udGV4dC5pc0luaXRpYWxTeW5jQ29tcGxldGUoKSxcbiAgICAgICAgICAgICAgICAgICAgfSwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VuZCBhbm90aGVyIFwiaW5pdGlhbFwiIFJWUyB1cGRhdGUgdG8gdHJpZ2dlciBwZWVraW5nIGlmIG5lZWRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vblJvb21WaWV3U3RvcmVVcGRhdGUodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2ZvY3VzX3NlYXJjaCc6XG4gICAgICAgICAgICAgICAgdGhpcy5vblNlYXJjaENsaWNrKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgQWN0aW9uLkVkaXRFdmVudDoge1xuICAgICAgICAgICAgICAgIC8vIFF1aXQgZWFybHkgaWYgd2UncmUgdHJ5aW5nIHRvIGVkaXQgZXZlbnRzIGluIHdyb25nIHJlbmRlcmluZyBjb250ZXh0XG4gICAgICAgICAgICAgICAgaWYgKHBheWxvYWQudGltZWxpbmVSZW5kZXJpbmdUeXBlICE9PSB0aGlzLnN0YXRlLnRpbWVsaW5lUmVuZGVyaW5nVHlwZSkgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRTdGF0ZSA9IHBheWxvYWQuZXZlbnQgPyBuZXcgRWRpdG9yU3RhdGVUcmFuc2ZlcihwYXlsb2FkLmV2ZW50KSA6IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGVkaXRTdGF0ZSB9LCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXlsb2FkLmV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VQYW5lbD8uc2Nyb2xsVG9FdmVudElmTmVlZGVkKHBheWxvYWQuZXZlbnQuZ2V0SWQoKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSBBY3Rpb24uQ29tcG9zZXJJbnNlcnQ6IHtcbiAgICAgICAgICAgICAgICBpZiAocGF5bG9hZC5jb21wb3NlclR5cGUpIGJyZWFrO1xuICAgICAgICAgICAgICAgIC8vIHJlLWRpc3BhdGNoIHRvIHRoZSBjb3JyZWN0IGNvbXBvc2VyXG4gICAgICAgICAgICAgICAgZGlzLmRpc3BhdGNoKHtcbiAgICAgICAgICAgICAgICAgICAgLi4ucGF5bG9hZCxcbiAgICAgICAgICAgICAgICAgICAgY29tcG9zZXJUeXBlOiB0aGlzLnN0YXRlLmVkaXRTdGF0ZSA/IENvbXBvc2VyVHlwZS5FZGl0IDogQ29tcG9zZXJUeXBlLlNlbmQsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgQWN0aW9uLkZvY3VzQUNvbXBvc2VyOiB7XG4gICAgICAgICAgICAgICAgLy8gcmUtZGlzcGF0Y2ggdG8gdGhlIGNvcnJlY3QgY29tcG9zZXJcbiAgICAgICAgICAgICAgICBkaXMuZmlyZSh0aGlzLnN0YXRlLmVkaXRTdGF0ZSA/IEFjdGlvbi5Gb2N1c0VkaXRNZXNzYWdlQ29tcG9zZXIgOiBBY3Rpb24uRm9jdXNTZW5kTWVzc2FnZUNvbXBvc2VyKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSBcInNjcm9sbF90b19ib3R0b21cIjpcbiAgICAgICAgICAgICAgICBpZiAocGF5bG9hZC50aW1lbGluZVJlbmRlcmluZ1R5cGUgPT09IHRoaXMuY29udGV4dC50aW1lbGluZVJlbmRlcmluZ1R5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlUGFuZWw/Lmp1bXBUb0xpdmVUaW1lbGluZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwcml2YXRlIG9uUm9vbVRpbWVsaW5lID0gKGV2OiBNYXRyaXhFdmVudCwgcm9vbTogUm9vbSwgdG9TdGFydE9mVGltZWxpbmU6IGJvb2xlYW4sIHJlbW92ZWQsIGRhdGEpID0+IHtcbiAgICAgICAgaWYgKHRoaXMudW5tb3VudGVkKSByZXR1cm47XG5cbiAgICAgICAgLy8gaWdub3JlIGV2ZW50cyBmb3Igb3RoZXIgcm9vbXNcbiAgICAgICAgaWYgKCFyb29tIHx8IHJvb20ucm9vbUlkICE9PSB0aGlzLnN0YXRlLnJvb20/LnJvb21JZCkgcmV0dXJuO1xuXG4gICAgICAgIC8vIGlnbm9yZSBldmVudHMgZnJvbSBmaWx0ZXJlZCB0aW1lbGluZXNcbiAgICAgICAgaWYgKGRhdGEudGltZWxpbmUuZ2V0VGltZWxpbmVTZXQoKSAhPT0gcm9vbS5nZXRVbmZpbHRlcmVkVGltZWxpbmVTZXQoKSkgcmV0dXJuO1xuXG4gICAgICAgIGlmIChldi5nZXRUeXBlKCkgPT09IFwib3JnLm1hdHJpeC5yb29tLnByZXZpZXdfdXJsc1wiKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVByZXZpZXdVcmxWaXNpYmlsaXR5KHJvb20pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGV2LmdldFR5cGUoKSA9PT0gXCJtLnJvb20uZW5jcnlwdGlvblwiKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUUyRVN0YXR1cyhyb29tKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGlnbm9yZSBhbnl0aGluZyBidXQgcmVhbC10aW1lIHVwZGF0ZXMgYXQgdGhlIGVuZCBvZiB0aGUgcm9vbTpcbiAgICAgICAgLy8gdXBkYXRlcyBmcm9tIHBhZ2luYXRpb24gd2lsbCBoYXBwZW4gd2hlbiB0aGUgcGFnaW5hdGUgY29tcGxldGVzLlxuICAgICAgICBpZiAodG9TdGFydE9mVGltZWxpbmUgfHwgIWRhdGEgfHwgIWRhdGEubGl2ZUV2ZW50KSByZXR1cm47XG5cbiAgICAgICAgLy8gbm8gcG9pbnQgaGFuZGxpbmcgYW55dGhpbmcgd2hpbGUgd2UncmUgd2FpdGluZyBmb3IgdGhlIGpvaW4gdG8gZmluaXNoOlxuICAgICAgICAvLyB3ZSdsbCBvbmx5IGJlIHNob3dpbmcgYSBzcGlubmVyLlxuICAgICAgICBpZiAodGhpcy5zdGF0ZS5qb2luaW5nKSByZXR1cm47XG5cbiAgICAgICAgaWYgKCFldi5pc0JlaW5nRGVjcnlwdGVkKCkgJiYgIWV2LmlzRGVjcnlwdGlvbkZhaWx1cmUoKSkge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVFZmZlY3RzKGV2KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChldi5nZXRTZW5kZXIoKSAhPT0gdGhpcy5jb250ZXh0LmNyZWRlbnRpYWxzLnVzZXJJZCkge1xuICAgICAgICAgICAgLy8gdXBkYXRlIHVucmVhZCBjb3VudCB3aGVuIHNjcm9sbGVkIHVwXG4gICAgICAgICAgICBpZiAoIXRoaXMuc3RhdGUuc2VhcmNoUmVzdWx0cyAmJiB0aGlzLnN0YXRlLmF0RW5kT2ZMaXZlVGltZWxpbmUpIHtcbiAgICAgICAgICAgICAgICAvLyBubyBjaGFuZ2VcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIXNob3VsZEhpZGVFdmVudChldiwgdGhpcy5zdGF0ZSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKChzdGF0ZSwgcHJvcHMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgbnVtVW5yZWFkTWVzc2FnZXM6IHN0YXRlLm51bVVucmVhZE1lc3NhZ2VzICsgMSB9O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25FdmVudERlY3J5cHRlZCA9IChldjogTWF0cml4RXZlbnQpID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLnN0YXRlLnJvb20gfHwgIXRoaXMuc3RhdGUubWF0cml4Q2xpZW50SXNSZWFkeSkgcmV0dXJuOyAvLyBub3QgcmVhZHkgYXQgYWxsXG4gICAgICAgIGlmIChldi5nZXRSb29tSWQoKSAhPT0gdGhpcy5zdGF0ZS5yb29tLnJvb21JZCkgcmV0dXJuOyAvLyBub3QgZm9yIHVzXG4gICAgICAgIGlmIChldi5pc0RlY3J5cHRpb25GYWlsdXJlKCkpIHJldHVybjtcbiAgICAgICAgdGhpcy5oYW5kbGVFZmZlY3RzKGV2KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBoYW5kbGVFZmZlY3RzID0gKGV2OiBNYXRyaXhFdmVudCkgPT4ge1xuICAgICAgICBjb25zdCBub3RpZlN0YXRlID0gUm9vbU5vdGlmaWNhdGlvblN0YXRlU3RvcmUuaW5zdGFuY2UuZ2V0Um9vbVN0YXRlKHRoaXMuc3RhdGUucm9vbSk7XG4gICAgICAgIGlmICghbm90aWZTdGF0ZS5pc1VucmVhZCkgcmV0dXJuO1xuXG4gICAgICAgIENIQVRfRUZGRUNUUy5mb3JFYWNoKGVmZmVjdCA9PiB7XG4gICAgICAgICAgICBpZiAoY29udGFpbnNFbW9qaShldi5nZXRDb250ZW50KCksIGVmZmVjdC5lbW9qaXMpIHx8IGV2LmdldENvbnRlbnQoKS5tc2d0eXBlID09PSBlZmZlY3QubXNnVHlwZSkge1xuICAgICAgICAgICAgICAgIC8vIEZvciBpbml0aWFsIHRocmVhZHMgbGF1bmNoLCBjaGF0IGVmZmVjdHMgYXJlIGRpc2FibGVkXG4gICAgICAgICAgICAgICAgLy8gc2VlICMxOTczMVxuICAgICAgICAgICAgICAgIGlmICghU2V0dGluZ3NTdG9yZS5nZXRWYWx1ZShcImZlYXR1cmVfdGhyZWFkXCIpIHx8ICFldi5pc1RocmVhZFJlbGF0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGRpcy5kaXNwYXRjaCh7IGFjdGlvbjogYGVmZmVjdHMuJHtlZmZlY3QuY29tbWFuZH1gIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25Sb29tTmFtZSA9IChyb29tOiBSb29tKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLnJvb20gJiYgcm9vbS5yb29tSWQgPT0gdGhpcy5zdGF0ZS5yb29tLnJvb21JZCkge1xuICAgICAgICAgICAgdGhpcy5mb3JjZVVwZGF0ZSgpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25LZXlCYWNrdXBTdGF0dXMgPSAoKSA9PiB7XG4gICAgICAgIC8vIEtleSBiYWNrdXAgc3RhdHVzIGNoYW5nZXMgYWZmZWN0IHdoZXRoZXIgdGhlIGluLXJvb20gcmVjb3ZlcnlcbiAgICAgICAgLy8gcmVtaW5kZXIgaXMgZGlzcGxheWVkLlxuICAgICAgICB0aGlzLmZvcmNlVXBkYXRlKCk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBjYW5SZXNldFRpbWVsaW5lID0gKCkgPT4ge1xuICAgICAgICBpZiAoIXRoaXMubWVzc2FnZVBhbmVsKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5tZXNzYWdlUGFuZWwuY2FuUmVzZXRUaW1lbGluZSgpO1xuICAgIH07XG5cbiAgICAvLyBjYWxsZWQgd2hlbiBzdGF0ZS5yb29tIGlzIGZpcnN0IGluaXRpYWxpc2VkIChlaXRoZXIgYXQgaW5pdGlhbCBsb2FkLFxuICAgIC8vIGFmdGVyIGEgc3VjY2Vzc2Z1bCBwZWVrLCBvciBhZnRlciB3ZSBqb2luIHRoZSByb29tKS5cbiAgICBwcml2YXRlIG9uUm9vbUxvYWRlZCA9IChyb29tOiBSb29tKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLnVubW91bnRlZCkgcmV0dXJuO1xuICAgICAgICAvLyBBdHRhY2ggYSB3aWRnZXQgc3RvcmUgbGlzdGVuZXIgb25seSB3aGVuIHdlIGdldCBhIHJvb21cbiAgICAgICAgV2lkZ2V0TGF5b3V0U3RvcmUuaW5zdGFuY2Uub24oV2lkZ2V0TGF5b3V0U3RvcmUuZW1pc3Npb25Gb3JSb29tKHJvb20pLCB0aGlzLm9uV2lkZ2V0TGF5b3V0Q2hhbmdlKTtcblxuICAgICAgICB0aGlzLmNhbGN1bGF0ZVBlZWtSdWxlcyhyb29tKTtcbiAgICAgICAgdGhpcy51cGRhdGVQcmV2aWV3VXJsVmlzaWJpbGl0eShyb29tKTtcbiAgICAgICAgdGhpcy5sb2FkTWVtYmVyc0lmSm9pbmVkKHJvb20pO1xuICAgICAgICB0aGlzLmNhbGN1bGF0ZVJlY29tbWVuZGVkVmVyc2lvbihyb29tKTtcbiAgICAgICAgdGhpcy51cGRhdGVFMkVTdGF0dXMocm9vbSk7XG4gICAgICAgIHRoaXMudXBkYXRlUGVybWlzc2lvbnMocm9vbSk7XG4gICAgICAgIHRoaXMuY2hlY2tXaWRnZXRzKHJvb20pO1xuICAgICAgICB0aGlzLmNoZWNrUmlnaHRQYW5lbChyb29tKTtcblxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGxpdmVUaW1lbGluZTogcm9vbS5nZXRMaXZlVGltZWxpbmUoKSxcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgYXN5bmMgY2FsY3VsYXRlUmVjb21tZW5kZWRWZXJzaW9uKHJvb206IFJvb20pIHtcbiAgICAgICAgY29uc3QgdXBncmFkZVJlY29tbWVuZGF0aW9uID0gYXdhaXQgcm9vbS5nZXRSZWNvbW1lbmRlZFZlcnNpb24oKTtcbiAgICAgICAgaWYgKHRoaXMudW5tb3VudGVkKSByZXR1cm47XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyB1cGdyYWRlUmVjb21tZW5kYXRpb24gfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBsb2FkTWVtYmVyc0lmSm9pbmVkKHJvb206IFJvb20pIHtcbiAgICAgICAgLy8gbGF6eSBsb2FkIG1lbWJlcnMgaWYgZW5hYmxlZFxuICAgICAgICBpZiAodGhpcy5jb250ZXh0Lmhhc0xhenlMb2FkTWVtYmVyc0VuYWJsZWQoKSkge1xuICAgICAgICAgICAgaWYgKHJvb20gJiYgcm9vbS5nZXRNeU1lbWJlcnNoaXAoKSA9PT0gJ2pvaW4nKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgcm9vbS5sb2FkTWVtYmVyc0lmTmVlZGVkKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy51bm1vdW50ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBtZW1iZXJzTG9hZGVkOiB0cnVlIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGBGZXRjaGluZyByb29tIG1lbWJlcnMgZm9yICR7cm9vbS5yb29tSWR9IGZhaWxlZC5gICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiIFJvb20gbWVtYmVycyB3aWxsIGFwcGVhciBpbmNvbXBsZXRlLlwiO1xuICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjYWxjdWxhdGVQZWVrUnVsZXMocm9vbTogUm9vbSkge1xuICAgICAgICBjb25zdCBndWVzdEFjY2Vzc0V2ZW50ID0gcm9vbS5jdXJyZW50U3RhdGUuZ2V0U3RhdGVFdmVudHMoXCJtLnJvb20uZ3Vlc3RfYWNjZXNzXCIsIFwiXCIpO1xuICAgICAgICBpZiAoZ3Vlc3RBY2Nlc3NFdmVudCAmJiBndWVzdEFjY2Vzc0V2ZW50LmdldENvbnRlbnQoKS5ndWVzdF9hY2Nlc3MgPT09IFwiY2FuX2pvaW5cIikge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgZ3Vlc3RzQ2FuSm9pbjogdHJ1ZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgaGlzdG9yeVZpc2liaWxpdHkgPSByb29tLmN1cnJlbnRTdGF0ZS5nZXRTdGF0ZUV2ZW50cyhcIm0ucm9vbS5oaXN0b3J5X3Zpc2liaWxpdHlcIiwgXCJcIik7XG4gICAgICAgIGlmIChoaXN0b3J5VmlzaWJpbGl0eSAmJiBoaXN0b3J5VmlzaWJpbGl0eS5nZXRDb250ZW50KCkuaGlzdG9yeV92aXNpYmlsaXR5ID09PSBcIndvcmxkX3JlYWRhYmxlXCIpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgIGNhblBlZWs6IHRydWUsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgdXBkYXRlUHJldmlld1VybFZpc2liaWxpdHkoeyByb29tSWQgfTogUm9vbSkge1xuICAgICAgICAvLyBVUkwgUHJldmlld3MgaW4gRTJFRSByb29tcyBjYW4gYmUgYSBwcml2YWN5IGxlYWsgc28gdXNlIGEgZGlmZmVyZW50IHNldHRpbmcgd2hpY2ggaXMgcGVyLXJvb20gZXhwbGljaXRcbiAgICAgICAgY29uc3Qga2V5ID0gdGhpcy5jb250ZXh0LmlzUm9vbUVuY3J5cHRlZChyb29tSWQpID8gJ3VybFByZXZpZXdzRW5hYmxlZF9lMmVlJyA6ICd1cmxQcmV2aWV3c0VuYWJsZWQnO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIHNob3dVcmxQcmV2aWV3OiBTZXR0aW5nc1N0b3JlLmdldFZhbHVlKGtleSwgcm9vbUlkKSxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvblJvb20gPSAocm9vbTogUm9vbSkgPT4ge1xuICAgICAgICBpZiAoIXJvb20gfHwgcm9vbS5yb29tSWQgIT09IHRoaXMuc3RhdGUucm9vbUlkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEZXRhY2ggdGhlIGxpc3RlbmVyIGlmIHRoZSByb29tIGlzIGNoYW5naW5nIGZvciBzb21lIHJlYXNvblxuICAgICAgICBpZiAodGhpcy5zdGF0ZS5yb29tKSB7XG4gICAgICAgICAgICBXaWRnZXRMYXlvdXRTdG9yZS5pbnN0YW5jZS5vZmYoXG4gICAgICAgICAgICAgICAgV2lkZ2V0TGF5b3V0U3RvcmUuZW1pc3Npb25Gb3JSb29tKHRoaXMuc3RhdGUucm9vbSksXG4gICAgICAgICAgICAgICAgdGhpcy5vbldpZGdldExheW91dENoYW5nZSxcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIHJvb206IHJvb20sXG4gICAgICAgIH0sICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMub25Sb29tTG9hZGVkKHJvb20pO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkRldmljZVZlcmlmaWNhdGlvbkNoYW5nZWQgPSAodXNlcklkOiBzdHJpbmcsIGRldmljZTogb2JqZWN0KSA9PiB7XG4gICAgICAgIGNvbnN0IHJvb20gPSB0aGlzLnN0YXRlLnJvb207XG4gICAgICAgIGlmICghcm9vbS5jdXJyZW50U3RhdGUuZ2V0TWVtYmVyKHVzZXJJZCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnVwZGF0ZUUyRVN0YXR1cyhyb29tKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvblVzZXJWZXJpZmljYXRpb25DaGFuZ2VkID0gKHVzZXJJZDogc3RyaW5nLCB0cnVzdFN0YXR1czogb2JqZWN0KSA9PiB7XG4gICAgICAgIGNvbnN0IHJvb20gPSB0aGlzLnN0YXRlLnJvb207XG4gICAgICAgIGlmICghcm9vbSB8fCAhcm9vbS5jdXJyZW50U3RhdGUuZ2V0TWVtYmVyKHVzZXJJZCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnVwZGF0ZUUyRVN0YXR1cyhyb29tKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkNyb3NzU2lnbmluZ0tleXNDaGFuZ2VkID0gKCkgPT4ge1xuICAgICAgICBjb25zdCByb29tID0gdGhpcy5zdGF0ZS5yb29tO1xuICAgICAgICBpZiAocm9vbSkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVFMkVTdGF0dXMocm9vbSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBhc3luYyB1cGRhdGVFMkVTdGF0dXMocm9vbTogUm9vbSkge1xuICAgICAgICBpZiAoIXRoaXMuY29udGV4dC5pc1Jvb21FbmNyeXB0ZWQocm9vbS5yb29tSWQpKSByZXR1cm47XG5cbiAgICAgICAgLy8gSWYgY3J5cHRvIGlzIG5vdCBjdXJyZW50bHkgZW5hYmxlZCwgd2UgYXJlbid0IHRyYWNraW5nIGRldmljZXMgYXQgYWxsLFxuICAgICAgICAvLyBzbyB3ZSBkb24ndCBrbm93IHdoYXQgdGhlIGFuc3dlciBpcy4gTGV0J3MgZXJyb3Igb24gdGhlIHNhZmUgc2lkZSBhbmQgc2hvd1xuICAgICAgICAvLyBhIHdhcm5pbmcgZm9yIHRoaXMgY2FzZS5cbiAgICAgICAgbGV0IGUyZVN0YXR1cyA9IEUyRVN0YXR1cy5XYXJuaW5nO1xuICAgICAgICBpZiAodGhpcy5jb250ZXh0LmlzQ3J5cHRvRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAvKiBBdCB0aGlzIHBvaW50LCB0aGUgdXNlciBoYXMgZW5jcnlwdGlvbiBvbiBhbmQgY3Jvc3Mtc2lnbmluZyBvbiAqL1xuICAgICAgICAgICAgZTJlU3RhdHVzID0gYXdhaXQgc2hpZWxkU3RhdHVzRm9yUm9vbSh0aGlzLmNvbnRleHQsIHJvb20pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMudW5tb3VudGVkKSByZXR1cm47XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBlMmVTdGF0dXMgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvbkFjY291bnREYXRhID0gKGV2ZW50OiBNYXRyaXhFdmVudCkgPT4ge1xuICAgICAgICBjb25zdCB0eXBlID0gZXZlbnQuZ2V0VHlwZSgpO1xuICAgICAgICBpZiAoKHR5cGUgPT09IFwib3JnLm1hdHJpeC5wcmV2aWV3X3VybHNcIiB8fCB0eXBlID09PSBcImltLnZlY3Rvci53ZWIuc2V0dGluZ3NcIikgJiYgdGhpcy5zdGF0ZS5yb29tKSB7XG4gICAgICAgICAgICAvLyBub24tZTJlZSB1cmwgcHJldmlld3MgYXJlIHN0b3JlZCBpbiBsZWdhY3kgZXZlbnQgdHlwZSBgb3JnLm1hdHJpeC5yb29tLnByZXZpZXdfdXJsc2BcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUHJldmlld1VybFZpc2liaWxpdHkodGhpcy5zdGF0ZS5yb29tKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwcml2YXRlIG9uUm9vbUFjY291bnREYXRhID0gKGV2ZW50OiBNYXRyaXhFdmVudCwgcm9vbTogUm9vbSkgPT4ge1xuICAgICAgICBpZiAocm9vbS5yb29tSWQgPT0gdGhpcy5zdGF0ZS5yb29tSWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBldmVudC5nZXRUeXBlKCk7XG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gXCJvcmcubWF0cml4LnJvb20ucHJldmlld191cmxzXCIgfHwgdHlwZSA9PT0gXCJpbS52ZWN0b3Iud2ViLnNldHRpbmdzXCIpIHtcbiAgICAgICAgICAgICAgICAvLyBub24tZTJlZSB1cmwgcHJldmlld3MgYXJlIHN0b3JlZCBpbiBsZWdhY3kgZXZlbnQgdHlwZSBgb3JnLm1hdHJpeC5yb29tLnByZXZpZXdfdXJsc2BcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVByZXZpZXdVcmxWaXNpYmlsaXR5KHJvb20pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25Sb29tU3RhdGVFdmVudHMgPSAoZXY6IE1hdHJpeEV2ZW50LCBzdGF0ZSkgPT4ge1xuICAgICAgICAvLyBpZ25vcmUgaWYgd2UgZG9uJ3QgaGF2ZSBhIHJvb20geWV0XG4gICAgICAgIGlmICghdGhpcy5zdGF0ZS5yb29tIHx8IHRoaXMuc3RhdGUucm9vbS5yb29tSWQgIT09IHN0YXRlLnJvb21JZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy51cGRhdGVQZXJtaXNzaW9ucyh0aGlzLnN0YXRlLnJvb20pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uUm9vbVN0YXRlTWVtYmVyID0gKGV2OiBNYXRyaXhFdmVudCwgc3RhdGUsIG1lbWJlcikgPT4ge1xuICAgICAgICAvLyBpZ25vcmUgaWYgd2UgZG9uJ3QgaGF2ZSBhIHJvb20geWV0XG4gICAgICAgIGlmICghdGhpcy5zdGF0ZS5yb29tKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpZ25vcmUgbWVtYmVycyBpbiBvdGhlciByb29tc1xuICAgICAgICBpZiAobWVtYmVyLnJvb21JZCAhPT0gdGhpcy5zdGF0ZS5yb29tLnJvb21JZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy51cGRhdGVSb29tTWVtYmVycygpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uTXlNZW1iZXJzaGlwID0gKHJvb206IFJvb20sIG1lbWJlcnNoaXA6IHN0cmluZywgb2xkTWVtYmVyc2hpcDogc3RyaW5nKSA9PiB7XG4gICAgICAgIGlmIChyb29tLnJvb21JZCA9PT0gdGhpcy5zdGF0ZS5yb29tSWQpIHtcbiAgICAgICAgICAgIHRoaXMuZm9yY2VVcGRhdGUoKTtcbiAgICAgICAgICAgIHRoaXMubG9hZE1lbWJlcnNJZkpvaW5lZChyb29tKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUGVybWlzc2lvbnMocm9vbSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcHJpdmF0ZSB1cGRhdGVQZXJtaXNzaW9ucyhyb29tOiBSb29tKSB7XG4gICAgICAgIGlmIChyb29tKSB7XG4gICAgICAgICAgICBjb25zdCBtZSA9IHRoaXMuY29udGV4dC5nZXRVc2VySWQoKTtcbiAgICAgICAgICAgIGNvbnN0IGNhblJlYWN0ID0gcm9vbS5nZXRNeU1lbWJlcnNoaXAoKSA9PT0gXCJqb2luXCIgJiYgcm9vbS5jdXJyZW50U3RhdGUubWF5U2VuZEV2ZW50KFwibS5yZWFjdGlvblwiLCBtZSk7XG4gICAgICAgICAgICBjb25zdCBjYW5SZXBseSA9IHJvb20ubWF5U2VuZE1lc3NhZ2UoKTtcblxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGNhblJlYWN0LCBjYW5SZXBseSB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIHJhdGUgbGltaXRlZCBiZWNhdXNlIGEgcG93ZXIgbGV2ZWwgY2hhbmdlIHdpbGwgZW1pdCBhbiBldmVudCBmb3IgZXZlcnkgbWVtYmVyIGluIHRoZSByb29tLlxuICAgIHByaXZhdGUgdXBkYXRlUm9vbU1lbWJlcnMgPSB0aHJvdHRsZSgoKSA9PiB7XG4gICAgICAgIHRoaXMudXBkYXRlRE1TdGF0ZSgpO1xuICAgICAgICB0aGlzLnVwZGF0ZUUyRVN0YXR1cyh0aGlzLnN0YXRlLnJvb20pO1xuICAgIH0sIDUwMCwgeyBsZWFkaW5nOiB0cnVlLCB0cmFpbGluZzogdHJ1ZSB9KTtcblxuICAgIHByaXZhdGUgY2hlY2tEZXNrdG9wTm90aWZpY2F0aW9ucygpIHtcbiAgICAgICAgY29uc3QgbWVtYmVyQ291bnQgPSB0aGlzLnN0YXRlLnJvb20uZ2V0Sm9pbmVkTWVtYmVyQ291bnQoKSArIHRoaXMuc3RhdGUucm9vbS5nZXRJbnZpdGVkTWVtYmVyQ291bnQoKTtcbiAgICAgICAgLy8gaWYgdGhleSBhcmUgbm90IGFsb25lIHByb21wdCB0aGUgdXNlciBhYm91dCBub3RpZmljYXRpb25zIHNvIHRoZXkgZG9uJ3QgbWlzcyByZXBsaWVzXG4gICAgICAgIGlmIChtZW1iZXJDb3VudCA+IDEgJiYgTm90aWZpZXIuc2hvdWxkU2hvd1Byb21wdCgpKSB7XG4gICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uc1RvYXN0KHRydWUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB1cGRhdGVETVN0YXRlKCkge1xuICAgICAgICBjb25zdCByb29tID0gdGhpcy5zdGF0ZS5yb29tO1xuICAgICAgICBpZiAocm9vbS5nZXRNeU1lbWJlcnNoaXAoKSAhPSBcImpvaW5cIikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRtSW52aXRlciA9IHJvb20uZ2V0RE1JbnZpdGVyKCk7XG4gICAgICAgIGlmIChkbUludml0ZXIpIHtcbiAgICAgICAgICAgIFJvb21zLnNldERNUm9vbShyb29tLnJvb21JZCwgZG1JbnZpdGVyKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgb25TZWFyY2hSZXN1bHRzRmlsbFJlcXVlc3QgPSAoYmFja3dhcmRzOiBib29sZWFuKTogUHJvbWlzZTxib29sZWFuPiA9PiB7XG4gICAgICAgIGlmICghYmFja3dhcmRzKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGZhbHNlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnN0YXRlLnNlYXJjaFJlc3VsdHMubmV4dF9iYXRjaCkge1xuICAgICAgICAgICAgZGVidWdsb2coXCJyZXF1ZXN0aW5nIG1vcmUgc2VhcmNoIHJlc3VsdHNcIik7XG4gICAgICAgICAgICBjb25zdCBzZWFyY2hQcm9taXNlID0gc2VhcmNoUGFnaW5hdGlvbih0aGlzLnN0YXRlLnNlYXJjaFJlc3VsdHMgYXMgSVNlYXJjaFJlc3VsdHMpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlU2VhcmNoUmVzdWx0KHNlYXJjaFByb21pc2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGVidWdsb2coXCJubyBtb3JlIHNlYXJjaCByZXN1bHRzXCIpO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkludml0ZUJ1dHRvbkNsaWNrID0gKCkgPT4ge1xuICAgICAgICAvLyBjYWxsIEFkZHJlc3NQaWNrZXJEaWFsb2dcbiAgICAgICAgZGlzLmRpc3BhdGNoKHtcbiAgICAgICAgICAgIGFjdGlvbjogJ3ZpZXdfaW52aXRlJyxcbiAgICAgICAgICAgIHJvb21JZDogdGhpcy5zdGF0ZS5yb29tLnJvb21JZCxcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25Kb2luQnV0dG9uQ2xpY2tlZCA9ICgpID0+IHtcbiAgICAgICAgLy8gSWYgdGhlIHVzZXIgaXMgYSBST1UsIGFsbG93IHRoZW0gdG8gdHJhbnNpdGlvbiB0byBhIFBXTFVcbiAgICAgICAgaWYgKHRoaXMuY29udGV4dCAmJiB0aGlzLmNvbnRleHQuaXNHdWVzdCgpKSB7XG4gICAgICAgICAgICAvLyBKb2luIHRoaXMgcm9vbSBvbmNlIHRoZSB1c2VyIGhhcyByZWdpc3RlcmVkIGFuZCBsb2dnZWQgaW5cbiAgICAgICAgICAgIC8vIChJZiB3ZSBmYWlsZWQgdG8gcGVlaywgd2UgbWF5IG5vdCBoYXZlIGEgdmFsaWQgcm9vbSBvYmplY3QuKVxuICAgICAgICAgICAgZGlzLmRpc3BhdGNoKHtcbiAgICAgICAgICAgICAgICBhY3Rpb246ICdkb19hZnRlcl9zeW5jX3ByZXBhcmVkJyxcbiAgICAgICAgICAgICAgICBkZWZlcnJlZF9hY3Rpb246IHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBBY3Rpb24uVmlld1Jvb20sXG4gICAgICAgICAgICAgICAgICAgIHJvb21faWQ6IHRoaXMuZ2V0Um9vbUlkKCksXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZGlzLmRpc3BhdGNoKHsgYWN0aW9uOiAncmVxdWlyZV9yZWdpc3RyYXRpb24nIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2lnblVybCA9IHRoaXMucHJvcHMudGhyZWVwaWRJbnZpdGU/LnNpZ25Vcmw7XG4gICAgICAgICAgICAgICAgZGlzLmRpc3BhdGNoKHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBBY3Rpb24uSm9pblJvb20sXG4gICAgICAgICAgICAgICAgICAgIHJvb21JZDogdGhpcy5nZXRSb29tSWQoKSxcbiAgICAgICAgICAgICAgICAgICAgb3B0czogeyBpbnZpdGVTaWduVXJsOiBzaWduVXJsIH0sXG4gICAgICAgICAgICAgICAgICAgIF90eXBlOiBcInVua25vd25cIiwgLy8gVE9ETzogaW5zdHJ1bWVudGF0aW9uXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbk1lc3NhZ2VMaXN0U2Nyb2xsID0gZXYgPT4ge1xuICAgICAgICBpZiAodGhpcy5tZXNzYWdlUGFuZWwuaXNBdEVuZE9mTGl2ZVRpbWVsaW5lKCkpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgIG51bVVucmVhZE1lc3NhZ2VzOiAwLFxuICAgICAgICAgICAgICAgIGF0RW5kT2ZMaXZlVGltZWxpbmU6IHRydWUsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgIGF0RW5kT2ZMaXZlVGltZWxpbmU6IGZhbHNlLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cGRhdGVUb3BVbnJlYWRNZXNzYWdlc0JhcigpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uRHJhZ0VudGVyID0gZXYgPT4ge1xuICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAvLyBXZSBhbHdheXMgaW5jcmVtZW50IHRoZSBjb3VudGVyIG5vIG1hdHRlciB0aGUgdHlwZXMsIGJlY2F1c2UgZHJhZ2dpbmcgaXNcbiAgICAgICAgLy8gc3RpbGwgaGFwcGVuaW5nLiBJZiB3ZSBkaWRuJ3QsIHRoZSBkcmFnIGNvdW50ZXIgd291bGQgZ2V0IG91dCBvZiBzeW5jLlxuICAgICAgICB0aGlzLnNldFN0YXRlKHsgZHJhZ0NvdW50ZXI6IHRoaXMuc3RhdGUuZHJhZ0NvdW50ZXIgKyAxIH0pO1xuXG4gICAgICAgIC8vIFNlZTpcbiAgICAgICAgLy8gaHR0cHM6Ly9kb2NzLnczY3ViLmNvbS9kb20vZGF0YXRyYW5zZmVyL3R5cGVzXG4gICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9IVE1MX0RyYWdfYW5kX0Ryb3BfQVBJL1JlY29tbWVuZGVkX2RyYWdfdHlwZXMjZmlsZVxuICAgICAgICBpZiAoZXYuZGF0YVRyYW5zZmVyLnR5cGVzLmluY2x1ZGVzKFwiRmlsZXNcIikgfHwgZXYuZGF0YVRyYW5zZmVyLnR5cGVzLmluY2x1ZGVzKFwiYXBwbGljYXRpb24veC1tb3otZmlsZVwiKSkge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGRyYWdnaW5nRmlsZTogdHJ1ZSB9KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwcml2YXRlIG9uRHJhZ0xlYXZlID0gZXYgPT4ge1xuICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGRyYWdDb3VudGVyOiB0aGlzLnN0YXRlLmRyYWdDb3VudGVyIC0gMSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuZHJhZ0NvdW50ZXIgPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgIGRyYWdnaW5nRmlsZTogZmFsc2UsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwcml2YXRlIG9uRHJhZ092ZXIgPSBldiA9PiB7XG4gICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIGV2LmRhdGFUcmFuc2Zlci5kcm9wRWZmZWN0ID0gJ25vbmUnO1xuXG4gICAgICAgIC8vIFNlZTpcbiAgICAgICAgLy8gaHR0cHM6Ly9kb2NzLnczY3ViLmNvbS9kb20vZGF0YXRyYW5zZmVyL3R5cGVzXG4gICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9IVE1MX0RyYWdfYW5kX0Ryb3BfQVBJL1JlY29tbWVuZGVkX2RyYWdfdHlwZXMjZmlsZVxuICAgICAgICBpZiAoZXYuZGF0YVRyYW5zZmVyLnR5cGVzLmluY2x1ZGVzKFwiRmlsZXNcIikgfHwgZXYuZGF0YVRyYW5zZmVyLnR5cGVzLmluY2x1ZGVzKFwiYXBwbGljYXRpb24veC1tb3otZmlsZVwiKSkge1xuICAgICAgICAgICAgZXYuZGF0YVRyYW5zZmVyLmRyb3BFZmZlY3QgPSAnY29weSc7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkRyb3AgPSBldiA9PiB7XG4gICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBDb250ZW50TWVzc2FnZXMuc2hhcmVkSW5zdGFuY2UoKS5zZW5kQ29udGVudExpc3RUb1Jvb20oXG4gICAgICAgICAgICBldi5kYXRhVHJhbnNmZXIuZmlsZXMsIHRoaXMuc3RhdGUucm9vbS5yb29tSWQsIG51bGwsIHRoaXMuY29udGV4dCxcbiAgICAgICAgKTtcbiAgICAgICAgZGlzLmZpcmUoQWN0aW9uLkZvY3VzU2VuZE1lc3NhZ2VDb21wb3Nlcik7XG5cbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBkcmFnZ2luZ0ZpbGU6IGZhbHNlLFxuICAgICAgICAgICAgZHJhZ0NvdW50ZXI6IHRoaXMuc3RhdGUuZHJhZ0NvdW50ZXIgLSAxLFxuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBpbmplY3RTdGlja2VyKHVybDogc3RyaW5nLCBpbmZvOiBvYmplY3QsIHRleHQ6IHN0cmluZykge1xuICAgICAgICBpZiAodGhpcy5jb250ZXh0LmlzR3Vlc3QoKSkge1xuICAgICAgICAgICAgZGlzLmRpc3BhdGNoKHsgYWN0aW9uOiAncmVxdWlyZV9yZWdpc3RyYXRpb24nIH0pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgQ29udGVudE1lc3NhZ2VzLnNoYXJlZEluc3RhbmNlKCkuc2VuZFN0aWNrZXJDb250ZW50VG9Sb29tKHVybCwgdGhpcy5zdGF0ZS5yb29tLnJvb21JZCwgaW5mbywgdGV4dCwgdGhpcy5jb250ZXh0KVxuICAgICAgICAgICAgLnRoZW4odW5kZWZpbmVkLCAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IubmFtZSA9PT0gXCJVbmtub3duRGV2aWNlRXJyb3JcIikge1xuICAgICAgICAgICAgICAgICAgICAvLyBMZXQgdGhlIHN0YXVzIGJhciBoYW5kbGUgdGhpc1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvblNlYXJjaCA9ICh0ZXJtOiBzdHJpbmcsIHNjb3BlOiBTZWFyY2hTY29wZSkgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIHNlYXJjaFRlcm06IHRlcm0sXG4gICAgICAgICAgICBzZWFyY2hTY29wZTogc2NvcGUsXG4gICAgICAgICAgICBzZWFyY2hSZXN1bHRzOiB7fSxcbiAgICAgICAgICAgIHNlYXJjaEhpZ2hsaWdodHM6IFtdLFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBpZiB3ZSBhbHJlYWR5IGhhdmUgYSBzZWFyY2ggcGFuZWwsIHdlIG5lZWQgdG8gdGVsbCBpdCB0byBmb3JnZXRcbiAgICAgICAgLy8gYWJvdXQgaXRzIHNjcm9sbCBzdGF0ZS5cbiAgICAgICAgaWYgKHRoaXMuc2VhcmNoUmVzdWx0c1BhbmVsLmN1cnJlbnQpIHtcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoUmVzdWx0c1BhbmVsLmN1cnJlbnQucmVzZXRTY3JvbGxTdGF0ZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gbWFrZSBzdXJlIHRoYXQgd2UgZG9uJ3QgZW5kIHVwIHNob3dpbmcgcmVzdWx0cyBmcm9tXG4gICAgICAgIC8vIGFuIGFib3J0ZWQgc2VhcmNoIGJ5IGtlZXBpbmcgYSB1bmlxdWUgaWQuXG4gICAgICAgIC8vXG4gICAgICAgIC8vIHRvZG86IHNob3VsZCBjYW5jZWwgYW55IHByZXZpb3VzIHNlYXJjaCByZXF1ZXN0cy5cbiAgICAgICAgdGhpcy5zZWFyY2hJZCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuXG4gICAgICAgIGxldCByb29tSWQ7XG4gICAgICAgIGlmIChzY29wZSA9PT0gU2VhcmNoU2NvcGUuUm9vbSkgcm9vbUlkID0gdGhpcy5zdGF0ZS5yb29tLnJvb21JZDtcblxuICAgICAgICBkZWJ1Z2xvZyhcInNlbmRpbmcgc2VhcmNoIHJlcXVlc3RcIik7XG4gICAgICAgIGNvbnN0IHNlYXJjaFByb21pc2UgPSBldmVudFNlYXJjaCh0ZXJtLCByb29tSWQpO1xuICAgICAgICB0aGlzLmhhbmRsZVNlYXJjaFJlc3VsdChzZWFyY2hQcm9taXNlKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBoYW5kbGVTZWFyY2hSZXN1bHQoc2VhcmNoUHJvbWlzZTogUHJvbWlzZTxhbnk+KTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgICAgIC8vIGtlZXAgYSByZWNvcmQgb2YgdGhlIGN1cnJlbnQgc2VhcmNoIGlkLCBzbyB0aGF0IGlmIHRoZSBzZWFyY2ggdGVybXNcbiAgICAgICAgLy8gY2hhbmdlIGJlZm9yZSB3ZSBnZXQgYSByZXNwb25zZSwgd2UgY2FuIGlnbm9yZSB0aGUgcmVzdWx0cy5cbiAgICAgICAgY29uc3QgbG9jYWxTZWFyY2hJZCA9IHRoaXMuc2VhcmNoSWQ7XG5cbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBzZWFyY2hJblByb2dyZXNzOiB0cnVlLFxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gc2VhcmNoUHJvbWlzZS50aGVuKChyZXN1bHRzKSA9PiB7XG4gICAgICAgICAgICBkZWJ1Z2xvZyhcInNlYXJjaCBjb21wbGV0ZVwiKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnVubW91bnRlZCB8fCAhdGhpcy5zdGF0ZS5zZWFyY2hpbmcgfHwgdGhpcy5zZWFyY2hJZCAhPSBsb2NhbFNlYXJjaElkKSB7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKFwiRGlzY2FyZGluZyBzdGFsZSBzZWFyY2ggcmVzdWx0c1wiKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIHBvc3RncmVzIG9uIHN5bmFwc2UgcmV0dXJucyB1cyBwcmVjaXNlIGRldGFpbHMgb2YgdGhlIHN0cmluZ3NcbiAgICAgICAgICAgIC8vIHdoaWNoIGFjdHVhbGx5IGdvdCBtYXRjaGVkIGZvciBoaWdobGlnaHRpbmcuXG4gICAgICAgICAgICAvL1xuICAgICAgICAgICAgLy8gSW4gZWl0aGVyIGNhc2UsIHdlIHdhbnQgdG8gaGlnaGxpZ2h0IHRoZSBsaXRlcmFsIHNlYXJjaCB0ZXJtXG4gICAgICAgICAgICAvLyB3aGV0aGVyIGl0IHdhcyB1c2VkIGJ5IHRoZSBzZWFyY2ggZW5naW5lIG9yIG5vdC5cblxuICAgICAgICAgICAgbGV0IGhpZ2hsaWdodHMgPSByZXN1bHRzLmhpZ2hsaWdodHM7XG4gICAgICAgICAgICBpZiAoaGlnaGxpZ2h0cy5pbmRleE9mKHRoaXMuc3RhdGUuc2VhcmNoVGVybSkgPCAwKSB7XG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0cyA9IGhpZ2hsaWdodHMuY29uY2F0KHRoaXMuc3RhdGUuc2VhcmNoVGVybSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEZvciBvdmVybGFwcGluZyBoaWdobGlnaHRzLFxuICAgICAgICAgICAgLy8gZmF2b3VyIGxvbmdlciAobW9yZSBzcGVjaWZpYykgdGVybXMgZmlyc3RcbiAgICAgICAgICAgIGhpZ2hsaWdodHMgPSBoaWdobGlnaHRzLnNvcnQoZnVuY3Rpb24oYSwgYikge1xuICAgICAgICAgICAgICAgIHJldHVybiBiLmxlbmd0aCAtIGEubGVuZ3RoO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgIHNlYXJjaEhpZ2hsaWdodHM6IGhpZ2hsaWdodHMsXG4gICAgICAgICAgICAgICAgc2VhcmNoUmVzdWx0czogcmVzdWx0cyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LCAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihcIlNlYXJjaCBmYWlsZWRcIiwgZXJyb3IpO1xuICAgICAgICAgICAgTW9kYWwuY3JlYXRlVHJhY2tlZERpYWxvZygnU2VhcmNoIGZhaWxlZCcsICcnLCBFcnJvckRpYWxvZywge1xuICAgICAgICAgICAgICAgIHRpdGxlOiBfdChcIlNlYXJjaCBmYWlsZWRcIiksXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICgoZXJyb3IgJiYgZXJyb3IubWVzc2FnZSkgPyBlcnJvci5tZXNzYWdlIDpcbiAgICAgICAgICAgICAgICAgICAgX3QoXCJTZXJ2ZXIgbWF5IGJlIHVuYXZhaWxhYmxlLCBvdmVybG9hZGVkLCBvciBzZWFyY2ggdGltZWQgb3V0IDooXCIpKSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9KS5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgIHNlYXJjaEluUHJvZ3Jlc3M6IGZhbHNlLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0U2VhcmNoUmVzdWx0VGlsZXMoKSB7XG4gICAgICAgIC8vIFhYWDogdG9kbzogbWVyZ2Ugb3ZlcmxhcHBpbmcgcmVzdWx0cyBzb21laG93P1xuICAgICAgICAvLyBYWFg6IHdoeSBkb2Vzbid0IHNlYXJjaGluZyBvbiBuYW1lIHdvcms/XG5cbiAgICAgICAgY29uc3QgcmV0ID0gW107XG5cbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuc2VhcmNoSW5Qcm9ncmVzcykge1xuICAgICAgICAgICAgcmV0LnB1c2goPGxpIGtleT1cInNlYXJjaC1zcGlubmVyXCI+XG4gICAgICAgICAgICAgICAgPFNwaW5uZXIgLz5cbiAgICAgICAgICAgIDwvbGk+KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdGhpcy5zdGF0ZS5zZWFyY2hSZXN1bHRzLm5leHRfYmF0Y2gpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5zdGF0ZS5zZWFyY2hSZXN1bHRzPy5yZXN1bHRzPy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXQucHVzaCg8bGkga2V5PVwic2VhcmNoLXRvcC1tYXJrZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgPGgyIGNsYXNzTmFtZT1cIm14X1Jvb21WaWV3X3RvcE1hcmtlclwiPnsgX3QoXCJObyByZXN1bHRzXCIpIH08L2gyPlxuICAgICAgICAgICAgICAgIDwvbGk+LFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldC5wdXNoKDxsaSBrZXk9XCJzZWFyY2gtdG9wLW1hcmtlclwiPlxuICAgICAgICAgICAgICAgICAgICA8aDIgY2xhc3NOYW1lPVwibXhfUm9vbVZpZXdfdG9wTWFya2VyXCI+eyBfdChcIk5vIG1vcmUgcmVzdWx0c1wiKSB9PC9oMj5cbiAgICAgICAgICAgICAgICA8L2xpPixcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gb25jZSBkeW5hbWljIGNvbnRlbnQgaW4gdGhlIHNlYXJjaCByZXN1bHRzIGxvYWQsIG1ha2UgdGhlIHNjcm9sbFBhbmVsIGNoZWNrXG4gICAgICAgIC8vIHRoZSBzY3JvbGwgb2Zmc2V0cy5cbiAgICAgICAgY29uc3Qgb25IZWlnaHRDaGFuZ2VkID0gKCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc2Nyb2xsUGFuZWwgPSB0aGlzLnNlYXJjaFJlc3VsdHNQYW5lbC5jdXJyZW50O1xuICAgICAgICAgICAgaWYgKHNjcm9sbFBhbmVsKSB7XG4gICAgICAgICAgICAgICAgc2Nyb2xsUGFuZWwuY2hlY2tTY3JvbGwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBsZXQgbGFzdFJvb21JZDtcblxuICAgICAgICBmb3IgKGxldCBpID0gKHRoaXMuc3RhdGUuc2VhcmNoUmVzdWx0cz8ucmVzdWx0cz8ubGVuZ3RoIHx8IDApIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMuc3RhdGUuc2VhcmNoUmVzdWx0cy5yZXN1bHRzW2ldO1xuXG4gICAgICAgICAgICBjb25zdCBteEV2ID0gcmVzdWx0LmNvbnRleHQuZ2V0RXZlbnQoKTtcbiAgICAgICAgICAgIGNvbnN0IHJvb21JZCA9IG14RXYuZ2V0Um9vbUlkKCk7XG4gICAgICAgICAgICBjb25zdCByb29tID0gdGhpcy5jb250ZXh0LmdldFJvb20ocm9vbUlkKTtcbiAgICAgICAgICAgIGlmICghcm9vbSkge1xuICAgICAgICAgICAgICAgIC8vIGlmIHdlIGRvIG5vdCBoYXZlIHRoZSByb29tIGluIGpzLXNkayBzdG9yZXMgdGhlbiBoaWRlIGl0IGFzIHdlIGNhbm5vdCBlYXNpbHkgc2hvdyBpdFxuICAgICAgICAgICAgICAgIC8vIEFzIHBlciB0aGUgc3BlYywgYW4gYWxsIHJvb21zIHNlYXJjaCBjYW4gY3JlYXRlIHRoaXMgY29uZGl0aW9uLFxuICAgICAgICAgICAgICAgIC8vIGl0IGhhcHBlbnMgd2l0aCBTZXNoYXQgYnV0IG5vdCBTeW5hcHNlLlxuICAgICAgICAgICAgICAgIC8vIEl0IHdpbGwgbWFrZSB0aGUgcmVzdWx0IGNvdW50IG5vdCBtYXRjaCB0aGUgZGlzcGxheWVkIGNvdW50LlxuICAgICAgICAgICAgICAgIGxvZ2dlci5sb2coXCJIaWRpbmcgc2VhcmNoIHJlc3VsdCBmcm9tIGFuIHVua25vd24gcm9vbVwiLCByb29tSWQpO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIWhhdmVUaWxlRm9yRXZlbnQobXhFdiwgdGhpcy5zdGF0ZS5zaG93SGlkZGVuRXZlbnRzSW5UaW1lbGluZSkpIHtcbiAgICAgICAgICAgICAgICAvLyBYWFg6IGNhbiB0aGlzIGV2ZXIgaGFwcGVuPyBJdCB3aWxsIG1ha2UgdGhlIHJlc3VsdCBjb3VudFxuICAgICAgICAgICAgICAgIC8vIG5vdCBtYXRjaCB0aGUgZGlzcGxheWVkIGNvdW50LlxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5zdGF0ZS5zZWFyY2hTY29wZSA9PT0gJ0FsbCcpIHtcbiAgICAgICAgICAgICAgICBpZiAocm9vbUlkICE9PSBsYXN0Um9vbUlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldC5wdXNoKDxsaSBrZXk9e214RXYuZ2V0SWQoKSArIFwiLXJvb21cIn0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8aDI+eyBfdChcIlJvb21cIikgfTogeyByb29tLm5hbWUgfTwvaDI+XG4gICAgICAgICAgICAgICAgICAgIDwvbGk+KTtcbiAgICAgICAgICAgICAgICAgICAgbGFzdFJvb21JZCA9IHJvb21JZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdExpbmsgPSBcIiMvcm9vbS9cIityb29tSWQrXCIvXCIrbXhFdi5nZXRJZCgpO1xuXG4gICAgICAgICAgICByZXQucHVzaCg8U2VhcmNoUmVzdWx0VGlsZVxuICAgICAgICAgICAgICAgIGtleT17bXhFdi5nZXRJZCgpfVxuICAgICAgICAgICAgICAgIHNlYXJjaFJlc3VsdD17cmVzdWx0fVxuICAgICAgICAgICAgICAgIHNlYXJjaEhpZ2hsaWdodHM9e3RoaXMuc3RhdGUuc2VhcmNoSGlnaGxpZ2h0c31cbiAgICAgICAgICAgICAgICByZXN1bHRMaW5rPXtyZXN1bHRMaW5rfVxuICAgICAgICAgICAgICAgIHBlcm1hbGlua0NyZWF0b3I9e3RoaXMuZ2V0UGVybWFsaW5rQ3JlYXRvckZvclJvb20ocm9vbSl9XG4gICAgICAgICAgICAgICAgb25IZWlnaHRDaGFuZ2VkPXtvbkhlaWdodENoYW5nZWR9XG4gICAgICAgICAgICAvPik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICB9XG5cbiAgICBwcml2YXRlIG9uQ2FsbFBsYWNlZCA9ICh0eXBlOiBQbGFjZUNhbGxUeXBlKSA9PiB7XG4gICAgICAgIGRpcy5kaXNwYXRjaCh7XG4gICAgICAgICAgICBhY3Rpb246ICdwbGFjZV9jYWxsJyxcbiAgICAgICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgICAgICByb29tX2lkOiB0aGlzLnN0YXRlLnJvb20ucm9vbUlkLFxuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkFwcHNDbGljayA9ICgpID0+IHtcbiAgICAgICAgZGlzLmRpc3BhdGNoKHtcbiAgICAgICAgICAgIGFjdGlvbjogXCJhcHBzRHJhd2VyXCIsXG4gICAgICAgICAgICBzaG93OiAhdGhpcy5zdGF0ZS5zaG93QXBwcyxcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25Gb3JnZXRDbGljayA9ICgpID0+IHtcbiAgICAgICAgZGlzLmRpc3BhdGNoKHtcbiAgICAgICAgICAgIGFjdGlvbjogJ2ZvcmdldF9yb29tJyxcbiAgICAgICAgICAgIHJvb21faWQ6IHRoaXMuc3RhdGUucm9vbS5yb29tSWQsXG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uUmVqZWN0QnV0dG9uQ2xpY2tlZCA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICByZWplY3Rpbmc6IHRydWUsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmNvbnRleHQubGVhdmUodGhpcy5zdGF0ZS5yb29tSWQpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgZGlzLmRpc3BhdGNoKHsgYWN0aW9uOiAndmlld19ob21lX3BhZ2UnIH0pO1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgcmVqZWN0aW5nOiBmYWxzZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LCAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byByZWplY3QgaW52aXRlOiAlc1wiLCBlcnJvcik7XG5cbiAgICAgICAgICAgIGNvbnN0IG1zZyA9IGVycm9yLm1lc3NhZ2UgPyBlcnJvci5tZXNzYWdlIDogSlNPTi5zdHJpbmdpZnkoZXJyb3IpO1xuICAgICAgICAgICAgTW9kYWwuY3JlYXRlVHJhY2tlZERpYWxvZygnRmFpbGVkIHRvIHJlamVjdCBpbnZpdGUnLCAnJywgRXJyb3JEaWFsb2csIHtcbiAgICAgICAgICAgICAgICB0aXRsZTogX3QoXCJGYWlsZWQgdG8gcmVqZWN0IGludml0ZVwiKSxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogbXNnLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgIHJlamVjdGluZzogZmFsc2UsXG4gICAgICAgICAgICAgICAgcmVqZWN0RXJyb3I6IGVycm9yLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uUmVqZWN0QW5kSWdub3JlQ2xpY2sgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgcmVqZWN0aW5nOiB0cnVlLFxuICAgICAgICB9KTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgbXlNZW1iZXIgPSB0aGlzLnN0YXRlLnJvb20uZ2V0TWVtYmVyKHRoaXMuY29udGV4dC5nZXRVc2VySWQoKSk7XG4gICAgICAgICAgICBjb25zdCBpbnZpdGVFdmVudCA9IG15TWVtYmVyLmV2ZW50cy5tZW1iZXI7XG4gICAgICAgICAgICBjb25zdCBpZ25vcmVkVXNlcnMgPSB0aGlzLmNvbnRleHQuZ2V0SWdub3JlZFVzZXJzKCk7XG4gICAgICAgICAgICBpZ25vcmVkVXNlcnMucHVzaChpbnZpdGVFdmVudC5nZXRTZW5kZXIoKSk7IC8vIGRlLWR1cGVkIGludGVybmFsbHkgaW4gdGhlIGpzLXNka1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5jb250ZXh0LnNldElnbm9yZWRVc2VycyhpZ25vcmVkVXNlcnMpO1xuXG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNvbnRleHQubGVhdmUodGhpcy5zdGF0ZS5yb29tSWQpO1xuICAgICAgICAgICAgZGlzLmRpc3BhdGNoKHsgYWN0aW9uOiAndmlld19ob21lX3BhZ2UnIH0pO1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgcmVqZWN0aW5nOiBmYWxzZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIHJlamVjdCBpbnZpdGU6ICVzXCIsIGVycm9yKTtcblxuICAgICAgICAgICAgY29uc3QgbXNnID0gZXJyb3IubWVzc2FnZSA/IGVycm9yLm1lc3NhZ2UgOiBKU09OLnN0cmluZ2lmeShlcnJvcik7XG4gICAgICAgICAgICBNb2RhbC5jcmVhdGVUcmFja2VkRGlhbG9nKCdGYWlsZWQgdG8gcmVqZWN0IGludml0ZScsICcnLCBFcnJvckRpYWxvZywge1xuICAgICAgICAgICAgICAgIHRpdGxlOiBfdChcIkZhaWxlZCB0byByZWplY3QgaW52aXRlXCIpLFxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBtc2csXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgcmVqZWN0aW5nOiBmYWxzZSxcbiAgICAgICAgICAgICAgICByZWplY3RFcnJvcjogZXJyb3IsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwcml2YXRlIG9uUmVqZWN0VGhyZWVwaWRJbnZpdGVCdXR0b25DbGlja2VkID0gKCkgPT4ge1xuICAgICAgICAvLyBXZSBjYW4gcmVqZWN0IDNwaWQgaW52aXRlcyBpbiB0aGUgc2FtZSB3YXkgdGhhdCB3ZSBhY2NlcHQgdGhlbSxcbiAgICAgICAgLy8gdXNpbmcgL2xlYXZlIHJhdGhlciB0aGFuIC9qb2luLiBJbiB0aGUgc2hvcnQgdGVybSB0aG91Z2gsIHdlXG4gICAgICAgIC8vIGp1c3QgaWdub3JlIHRoZW0uXG4gICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS92ZWN0b3ItaW0vdmVjdG9yLXdlYi9pc3N1ZXMvMTEzNFxuICAgICAgICBkaXMuZmlyZShBY3Rpb24uVmlld1Jvb21EaXJlY3RvcnkpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uU2VhcmNoQ2xpY2sgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgc2VhcmNoaW5nOiAhdGhpcy5zdGF0ZS5zZWFyY2hpbmcsXG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uQ2FuY2VsU2VhcmNoQ2xpY2sgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgc2VhcmNoaW5nOiBmYWxzZSxcbiAgICAgICAgICAgIHNlYXJjaFJlc3VsdHM6IG51bGwsXG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICAvLyBqdW1wIGRvd24gdG8gdGhlIGJvdHRvbSBvZiB0aGlzIHJvb20sIHdoZXJlIG5ldyBldmVudHMgYXJlIGFycml2aW5nXG4gICAgcHJpdmF0ZSBqdW1wVG9MaXZlVGltZWxpbmUgPSAoKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmluaXRpYWxFdmVudElkICYmIHRoaXMuc3RhdGUuaXNJbml0aWFsRXZlbnRIaWdobGlnaHRlZCkge1xuICAgICAgICAgICAgLy8gSWYgd2Ugd2VyZSB2aWV3aW5nIGEgaGlnaGxpZ2h0ZWQgZXZlbnQsIGZpcmluZyB2aWV3X3Jvb20gd2l0aG91dFxuICAgICAgICAgICAgLy8gYW4gZXZlbnQgd2lsbCB0YWtlIGNhcmUgb2YgYm90aCBjbGVhcmluZyB0aGUgVVJMIGZyYWdtZW50IGFuZFxuICAgICAgICAgICAgLy8ganVtcGluZyB0byB0aGUgYm90dG9tXG4gICAgICAgICAgICBkaXMuZGlzcGF0Y2goe1xuICAgICAgICAgICAgICAgIGFjdGlvbjogQWN0aW9uLlZpZXdSb29tLFxuICAgICAgICAgICAgICAgIHJvb21faWQ6IHRoaXMuc3RhdGUucm9vbS5yb29tSWQsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIE90aGVyd2lzZSB3ZSBoYXZlIHRvIGp1bXAgbWFudWFsbHlcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZVBhbmVsLmp1bXBUb0xpdmVUaW1lbGluZSgpO1xuICAgICAgICAgICAgZGlzLmZpcmUoQWN0aW9uLkZvY3VzU2VuZE1lc3NhZ2VDb21wb3Nlcik7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8ganVtcCB1cCB0byB3aGVyZXZlciBvdXIgcmVhZCBtYXJrZXIgaXNcbiAgICBwcml2YXRlIGp1bXBUb1JlYWRNYXJrZXIgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMubWVzc2FnZVBhbmVsLmp1bXBUb1JlYWRNYXJrZXIoKTtcbiAgICB9O1xuXG4gICAgLy8gdXBkYXRlIHRoZSByZWFkIG1hcmtlciB0byBtYXRjaCB0aGUgcmVhZC1yZWNlaXB0XG4gICAgcHJpdmF0ZSBmb3JnZXRSZWFkTWFya2VyID0gZXYgPT4ge1xuICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgdGhpcy5tZXNzYWdlUGFuZWwuZm9yZ2V0UmVhZE1hcmtlcigpO1xuICAgIH07XG5cbiAgICAvLyBkZWNpZGUgd2hldGhlciBvciBub3QgdGhlIHRvcCAndW5yZWFkIG1lc3NhZ2VzJyBiYXIgc2hvdWxkIGJlIHNob3duXG4gICAgcHJpdmF0ZSB1cGRhdGVUb3BVbnJlYWRNZXNzYWdlc0JhciA9ICgpID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLm1lc3NhZ2VQYW5lbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc2hvd0JhciA9IHRoaXMubWVzc2FnZVBhbmVsLmNhbkp1bXBUb1JlYWRNYXJrZXIoKTtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuc2hvd1RvcFVucmVhZE1lc3NhZ2VzQmFyICE9IHNob3dCYXIpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBzaG93VG9wVW5yZWFkTWVzc2FnZXNCYXI6IHNob3dCYXIgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8gZ2V0IHRoZSBjdXJyZW50IHNjcm9sbCBwb3NpdGlvbiBvZiB0aGUgcm9vbSwgc28gdGhhdCBpdCBjYW4gYmVcbiAgICAvLyByZXN0b3JlZCB3aGVuIHdlIHN3aXRjaCBiYWNrIHRvIGl0LlxuICAgIC8vXG4gICAgcHJpdmF0ZSBnZXRTY3JvbGxTdGF0ZSgpOiBTY3JvbGxTdGF0ZSB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2VQYW5lbCA9IHRoaXMubWVzc2FnZVBhbmVsO1xuICAgICAgICBpZiAoIW1lc3NhZ2VQYW5lbCkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgLy8gaWYgd2UncmUgZm9sbG93aW5nIHRoZSBsaXZlIHRpbWVsaW5lLCB3ZSB3YW50IHRvIHJldHVybiBudWxsOyB0aGF0XG4gICAgICAgIC8vIG1lYW5zIHRoYXQsIGlmIHdlIHN3aXRjaCBiYWNrLCB3ZSB3aWxsIGp1bXAgdG8gdGhlIHJlYWQtdXAtdG8gbWFyay5cbiAgICAgICAgLy9cbiAgICAgICAgLy8gVGhhdCBzaG91bGQgYmUgbW9yZSBpbnR1aXRpdmUgdGhhbiBzbGF2aXNobHkgcHJlc2VydmluZyB0aGUgY3VycmVudFxuICAgICAgICAvLyBzY3JvbGwgc3RhdGUsIGluIHRoZSBjYXNlIHdoZXJlIHRoZSByb29tIGFkdmFuY2VzIGluIHRoZSBtZWFudGltZVxuICAgICAgICAvLyAocGFydGljdWxhcmx5IGluIHRoZSBjYXNlIHRoYXQgdGhlIHVzZXIgcmVhZHMgc29tZSBzdHVmZiBvbiBhbm90aGVyXG4gICAgICAgIC8vIGRldmljZSkuXG4gICAgICAgIC8vXG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmF0RW5kT2ZMaXZlVGltZWxpbmUpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc2Nyb2xsU3RhdGUgPSBtZXNzYWdlUGFuZWwuZ2V0U2Nyb2xsU3RhdGUoKTtcblxuICAgICAgICAvLyBnZXRTY3JvbGxTdGF0ZSBvbiBUaW1lbGluZVBhbmVsICptYXkqIHJldHVybiBudWxsLCBzbyBndWFyZCBhZ2FpbnN0IHRoYXRcbiAgICAgICAgaWYgKCFzY3JvbGxTdGF0ZSB8fCBzY3JvbGxTdGF0ZS5zdHVja0F0Qm90dG9tKSB7XG4gICAgICAgICAgICAvLyB3ZSBkb24ndCByZWFsbHkgZXhwZWN0IHRvIGJlIGluIHRoaXMgc3RhdGUsIGJ1dCBpdCB3aWxsXG4gICAgICAgICAgICAvLyBvY2Nhc2lvbmFsbHkgaGFwcGVuIHdoZW4gbm8gc2Nyb2xsIHN0YXRlIGhhcyBiZWVuIHNldCBvbiB0aGVcbiAgICAgICAgICAgIC8vIG1lc3NhZ2VQYW5lbCAoaWUsIHdlIGRpZG4ndCBoYXZlIGFuIGluaXRpYWwgZXZlbnQgKHNvIGl0J3NcbiAgICAgICAgICAgIC8vIHByb2JhYmx5IGEgbmV3IHJvb20pLCB0aGVyZSBoYXMgYmVlbiBubyB1c2VyLWluaXRpYXRlZCBzY3JvbGwsIGFuZFxuICAgICAgICAgICAgLy8gbm8gcmVhZC1yZWNlaXB0cyBoYXZlIGFycml2ZWQgdG8gdXBkYXRlIHRoZSBzY3JvbGwgcG9zaXRpb24pLlxuICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIC8vIFJldHVybiBudWxsLCB3aGljaCB3aWxsIGNhdXNlIHVzIHRvIHNjcm9sbCB0byBsYXN0IHVucmVhZCBvblxuICAgICAgICAgICAgLy8gcmVsb2FkLlxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZm9jdXNzZWRFdmVudDogc2Nyb2xsU3RhdGUudHJhY2tlZFNjcm9sbFRva2VuLFxuICAgICAgICAgICAgcGl4ZWxPZmZzZXQ6IHNjcm9sbFN0YXRlLnBpeGVsT2Zmc2V0LFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHByaXZhdGUgb25TdGF0dXNCYXJWaXNpYmxlID0gKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy51bm1vdW50ZWQgfHwgdGhpcy5zdGF0ZS5zdGF0dXNCYXJWaXNpYmxlKSByZXR1cm47XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBzdGF0dXNCYXJWaXNpYmxlOiB0cnVlIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uU3RhdHVzQmFySGlkZGVuID0gKCkgPT4ge1xuICAgICAgICAvLyBUaGlzIGlzIGN1cnJlbnRseSBub3QgZGVzaXJlZCBhcyBpdCBpcyBhbm5veWluZyBpZiBpdCBrZWVwcyBleHBhbmRpbmcgYW5kIGNvbGxhcHNpbmdcbiAgICAgICAgaWYgKHRoaXMudW5tb3VudGVkIHx8ICF0aGlzLnN0YXRlLnN0YXR1c0JhclZpc2libGUpIHJldHVybjtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHN0YXR1c0JhclZpc2libGU6IGZhbHNlIH0pO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBjYWxsZWQgYnkgdGhlIHBhcmVudCBjb21wb25lbnQgd2hlbiBQYWdlVXAvRG93bi9ldGMgaXMgcHJlc3NlZC5cbiAgICAgKlxuICAgICAqIFdlIHBhc3MgaXQgZG93biB0byB0aGUgc2Nyb2xsIHBhbmVsLlxuICAgICAqL1xuICAgIHByaXZhdGUgaGFuZGxlU2Nyb2xsS2V5ID0gZXYgPT4ge1xuICAgICAgICBsZXQgcGFuZWw7XG4gICAgICAgIGlmICh0aGlzLnNlYXJjaFJlc3VsdHNQYW5lbC5jdXJyZW50KSB7XG4gICAgICAgICAgICBwYW5lbCA9IHRoaXMuc2VhcmNoUmVzdWx0c1BhbmVsLmN1cnJlbnQ7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5tZXNzYWdlUGFuZWwpIHtcbiAgICAgICAgICAgIHBhbmVsID0gdGhpcy5tZXNzYWdlUGFuZWw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocGFuZWwpIHtcbiAgICAgICAgICAgIHBhbmVsLmhhbmRsZVNjcm9sbEtleShldik7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogZ2V0IGFueSBjdXJyZW50IGNhbGwgZm9yIHRoaXMgcm9vbVxuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0Q2FsbEZvclJvb20oKTogTWF0cml4Q2FsbCB7XG4gICAgICAgIGlmICghdGhpcy5zdGF0ZS5yb29tKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gQ2FsbEhhbmRsZXIuc2hhcmVkSW5zdGFuY2UoKS5nZXRDYWxsRm9yUm9vbSh0aGlzLnN0YXRlLnJvb20ucm9vbUlkKTtcbiAgICB9XG5cbiAgICAvLyB0aGlzIGhhcyB0byBiZSBhIHByb3BlciBtZXRob2QgcmF0aGVyIHRoYW4gYW4gdW5uYW1lZCBmdW5jdGlvbixcbiAgICAvLyBvdGhlcndpc2UgcmVhY3QgY2FsbHMgaXQgd2l0aCBudWxsIG9uIGVhY2ggdXBkYXRlLlxuICAgIHByaXZhdGUgZ2F0aGVyVGltZWxpbmVQYW5lbFJlZiA9IHIgPT4ge1xuICAgICAgICB0aGlzLm1lc3NhZ2VQYW5lbCA9IHI7XG4gICAgfTtcblxuICAgIHByaXZhdGUgZ2V0T2xkUm9vbSgpIHtcbiAgICAgICAgY29uc3QgY3JlYXRlRXZlbnQgPSB0aGlzLnN0YXRlLnJvb20uY3VycmVudFN0YXRlLmdldFN0YXRlRXZlbnRzKFwibS5yb29tLmNyZWF0ZVwiLCBcIlwiKTtcbiAgICAgICAgaWYgKCFjcmVhdGVFdmVudCB8fCAhY3JlYXRlRXZlbnQuZ2V0Q29udGVudCgpWydwcmVkZWNlc3NvciddKSByZXR1cm4gbnVsbDtcblxuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LmdldFJvb20oY3JlYXRlRXZlbnQuZ2V0Q29udGVudCgpWydwcmVkZWNlc3NvciddWydyb29tX2lkJ10pO1xuICAgIH1cblxuICAgIGdldEhpZGRlbkhpZ2hsaWdodENvdW50KCkge1xuICAgICAgICBjb25zdCBvbGRSb29tID0gdGhpcy5nZXRPbGRSb29tKCk7XG4gICAgICAgIGlmICghb2xkUm9vbSkgcmV0dXJuIDA7XG4gICAgICAgIHJldHVybiBvbGRSb29tLmdldFVucmVhZE5vdGlmaWNhdGlvbkNvdW50KCdoaWdobGlnaHQnKTtcbiAgICB9XG5cbiAgICBvbkhpZGRlbkhpZ2hsaWdodHNDbGljayA9ICgpID0+IHtcbiAgICAgICAgY29uc3Qgb2xkUm9vbSA9IHRoaXMuZ2V0T2xkUm9vbSgpO1xuICAgICAgICBpZiAoIW9sZFJvb20pIHJldHVybjtcbiAgICAgICAgZGlzLmRpc3BhdGNoKHsgYWN0aW9uOiBcInZpZXdfcm9vbVwiLCByb29tX2lkOiBvbGRSb29tLnJvb21JZCB9KTtcbiAgICB9O1xuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBpZiAoIXRoaXMuc3RhdGUucm9vbSkge1xuICAgICAgICAgICAgY29uc3QgbG9hZGluZyA9ICF0aGlzLnN0YXRlLm1hdHJpeENsaWVudElzUmVhZHkgfHwgdGhpcy5zdGF0ZS5yb29tTG9hZGluZyB8fCB0aGlzLnN0YXRlLnBlZWtMb2FkaW5nO1xuICAgICAgICAgICAgaWYgKGxvYWRpbmcpIHtcbiAgICAgICAgICAgICAgICAvLyBBc3N1bWUgcHJldmlldyBsb2FkaW5nIGlmIHdlIGRvbid0IGhhdmUgYSByZWFkeSBjbGllbnQgb3IgYSByb29tIElEIChzdGlsbCByZXNvbHZpbmcgdGhlIGFsaWFzKVxuICAgICAgICAgICAgICAgIGNvbnN0IHByZXZpZXdMb2FkaW5nID0gIXRoaXMuc3RhdGUubWF0cml4Q2xpZW50SXNSZWFkeSB8fCAhdGhpcy5zdGF0ZS5yb29tSWQgfHwgdGhpcy5zdGF0ZS5wZWVrTG9hZGluZztcbiAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X1Jvb21WaWV3XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8RXJyb3JCb3VuZGFyeT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Um9vbVByZXZpZXdCYXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FuUHJldmlldz17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdMb2FkaW5nPXtwcmV2aWV3TG9hZGluZyAmJiAhdGhpcy5zdGF0ZS5yb29tTG9hZEVycm9yfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcj17dGhpcy5zdGF0ZS5yb29tTG9hZEVycm9yfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkaW5nPXtsb2FkaW5nfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqb2luaW5nPXt0aGlzLnN0YXRlLmpvaW5pbmd9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9vYkRhdGE9e3RoaXMucHJvcHMub29iRGF0YX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9FcnJvckJvdW5kYXJ5PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBsZXQgaW52aXRlck5hbWUgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMub29iRGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBpbnZpdGVyTmFtZSA9IHRoaXMucHJvcHMub29iRGF0YS5pbnZpdGVyTmFtZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgaW52aXRlZEVtYWlsID0gdGhpcy5wcm9wcy50aHJlZXBpZEludml0ZT8udG9FbWFpbDtcblxuICAgICAgICAgICAgICAgIC8vIFdlIGhhdmUgbm8gcm9vbSBvYmplY3QgZm9yIHRoaXMgcm9vbSwgb25seSB0aGUgSUQuXG4gICAgICAgICAgICAgICAgLy8gV2UndmUgZ290IHRvIHRoaXMgcm9vbSBieSBmb2xsb3dpbmcgYSBsaW5rLCBwb3NzaWJseSBhIHRoaXJkIHBhcnR5IGludml0ZS5cbiAgICAgICAgICAgICAgICBjb25zdCByb29tQWxpYXMgPSB0aGlzLnN0YXRlLnJvb21BbGlhcztcbiAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X1Jvb21WaWV3XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8RXJyb3JCb3VuZGFyeT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Um9vbVByZXZpZXdCYXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25Kb2luQ2xpY2s9e3RoaXMub25Kb2luQnV0dG9uQ2xpY2tlZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25Gb3JnZXRDbGljaz17dGhpcy5vbkZvcmdldENsaWNrfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblJlamVjdENsaWNrPXt0aGlzLm9uUmVqZWN0VGhyZWVwaWRJbnZpdGVCdXR0b25DbGlja2VkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYW5QcmV2aWV3PXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I9e3RoaXMuc3RhdGUucm9vbUxvYWRFcnJvcn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm9vbUFsaWFzPXtyb29tQWxpYXN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpvaW5pbmc9e3RoaXMuc3RhdGUuam9pbmluZ31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW52aXRlck5hbWU9e2ludml0ZXJOYW1lfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnZpdGVkRW1haWw9e2ludml0ZWRFbWFpbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb29iRGF0YT17dGhpcy5wcm9wcy5vb2JEYXRhfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaWduVXJsPXt0aGlzLnByb3BzLnRocmVlcGlkSW52aXRlPy5zaWduVXJsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb29tPXt0aGlzLnN0YXRlLnJvb219XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvRXJyb3JCb3VuZGFyeT5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG15TWVtYmVyc2hpcCA9IHRoaXMuc3RhdGUucm9vbS5nZXRNeU1lbWJlcnNoaXAoKTtcbiAgICAgICAgLy8gU3BhY2VSb29tVmlldyBoYW5kbGVzIGludml0ZXMgaXRzZWxmXG4gICAgICAgIGlmIChteU1lbWJlcnNoaXAgPT09IFwiaW52aXRlXCIgJiYgKCFTcGFjZVN0b3JlLnNwYWNlc0VuYWJsZWQgfHwgIXRoaXMuc3RhdGUucm9vbS5pc1NwYWNlUm9vbSgpKSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuc3RhdGUuam9pbmluZyB8fCB0aGlzLnN0YXRlLnJlamVjdGluZykge1xuICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgIDxFcnJvckJvdW5kYXJ5PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFJvb21QcmV2aWV3QmFyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FuUHJldmlldz17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I9e3RoaXMuc3RhdGUucm9vbUxvYWRFcnJvcn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqb2luaW5nPXt0aGlzLnN0YXRlLmpvaW5pbmd9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0aW5nPXt0aGlzLnN0YXRlLnJlamVjdGluZ31cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvRXJyb3JCb3VuZGFyeT5cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBteVVzZXJJZCA9IHRoaXMuY29udGV4dC5jcmVkZW50aWFscy51c2VySWQ7XG4gICAgICAgICAgICAgICAgY29uc3QgbXlNZW1iZXIgPSB0aGlzLnN0YXRlLnJvb20uZ2V0TWVtYmVyKG15VXNlcklkKTtcbiAgICAgICAgICAgICAgICBjb25zdCBpbnZpdGVFdmVudCA9IG15TWVtYmVyID8gbXlNZW1iZXIuZXZlbnRzLm1lbWJlciA6IG51bGw7XG4gICAgICAgICAgICAgICAgbGV0IGludml0ZXJOYW1lID0gX3QoXCJVbmtub3duXCIpO1xuICAgICAgICAgICAgICAgIGlmIChpbnZpdGVFdmVudCkge1xuICAgICAgICAgICAgICAgICAgICBpbnZpdGVyTmFtZSA9IGludml0ZUV2ZW50LnNlbmRlciA/IGludml0ZUV2ZW50LnNlbmRlci5uYW1lIDogaW52aXRlRXZlbnQuZ2V0U2VuZGVyKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gV2UgZGVsaWJlcmF0ZWx5IGRvbid0IHRyeSB0byBwZWVrIGludG8gaW52aXRlcywgZXZlbiBpZiB3ZSBoYXZlIHBlcm1pc3Npb24gdG8gcGVla1xuICAgICAgICAgICAgICAgIC8vIGFzIHRoZXkgY291bGQgYmUgYSBzcGFtIHZlY3Rvci5cbiAgICAgICAgICAgICAgICAvLyBYWFg6IGluIGZ1dHVyZSB3ZSBjb3VsZCBnaXZlIHRoZSBvcHRpb24gb2YgYSAnUHJldmlldycgYnV0dG9uIHdoaWNoIGxldHMgdGhlbSB2aWV3IGFueXdheS5cblxuICAgICAgICAgICAgICAgIC8vIFdlIGhhdmUgYSByZWd1bGFyIGludml0ZSBmb3IgdGhpcyByb29tLlxuICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfUm9vbVZpZXdcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxFcnJvckJvdW5kYXJ5PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxSb29tUHJldmlld0JhclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkpvaW5DbGljaz17dGhpcy5vbkpvaW5CdXR0b25DbGlja2VkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkZvcmdldENsaWNrPXt0aGlzLm9uRm9yZ2V0Q2xpY2t9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uUmVqZWN0Q2xpY2s9e3RoaXMub25SZWplY3RCdXR0b25DbGlja2VkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblJlamVjdEFuZElnbm9yZUNsaWNrPXt0aGlzLm9uUmVqZWN0QW5kSWdub3JlQ2xpY2t9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludml0ZXJOYW1lPXtpbnZpdGVyTmFtZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FuUHJldmlldz17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpvaW5pbmc9e3RoaXMuc3RhdGUuam9pbmluZ31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm9vbT17dGhpcy5zdGF0ZS5yb29tfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L0Vycm9yQm91bmRhcnk+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgZmlsZURyb3BUYXJnZXQgPSBudWxsO1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5kcmFnZ2luZ0ZpbGUpIHtcbiAgICAgICAgICAgIGZpbGVEcm9wVGFyZ2V0ID0gKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfUm9vbVZpZXdfZmlsZURyb3BUYXJnZXRcIj5cbiAgICAgICAgICAgICAgICAgICAgPGltZ1xuICAgICAgICAgICAgICAgICAgICAgICAgc3JjPXtyZXF1aXJlKFwiLi4vLi4vLi4vcmVzL2ltZy91cGxvYWQtYmlnLnN2Z1wiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm14X1Jvb21WaWV3X2ZpbGVEcm9wVGFyZ2V0X2ltYWdlXCJcbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgeyBfdChcIkRyb3AgZmlsZSBoZXJlIHRvIHVwbG9hZFwiKSB9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gV2UgaGF2ZSBzdWNjZXNzZnVsbHkgbG9hZGVkIHRoaXMgcm9vbSwgYW5kIGFyZSBub3QgcHJldmlld2luZy5cbiAgICAgICAgLy8gRGlzcGxheSB0aGUgXCJub3JtYWxcIiByb29tIHZpZXcuXG5cbiAgICAgICAgbGV0IGFjdGl2ZUNhbGwgPSBudWxsO1xuICAgICAgICB7XG4gICAgICAgICAgICAvLyBOZXcgYmxvY2sgYmVjYXVzZSB0aGlzIHZhcmlhYmxlIGRvZXNuJ3QgbmVlZCB0byBoYW5nIGFyb3VuZCBmb3IgdGhlIHJlc3Qgb2YgdGhlIGZ1bmN0aW9uXG4gICAgICAgICAgICBjb25zdCBjYWxsID0gdGhpcy5nZXRDYWxsRm9yUm9vbSgpO1xuICAgICAgICAgICAgaWYgKGNhbGwgJiYgKHRoaXMuc3RhdGUuY2FsbFN0YXRlICE9PSAnZW5kZWQnICYmIHRoaXMuc3RhdGUuY2FsbFN0YXRlICE9PSAncmluZ2luZycpKSB7XG4gICAgICAgICAgICAgICAgYWN0aXZlQ2FsbCA9IGNhbGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzY3JvbGxoZWFkZXJDbGFzc2VzID0gY2xhc3NOYW1lcyh7XG4gICAgICAgICAgICBteF9Sb29tVmlld19zY3JvbGxoZWFkZXI6IHRydWUsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGxldCBzdGF0dXNCYXI7XG4gICAgICAgIGxldCBpc1N0YXR1c0FyZWFFeHBhbmRlZCA9IHRydWU7XG5cbiAgICAgICAgaWYgKENvbnRlbnRNZXNzYWdlcy5zaGFyZWRJbnN0YW5jZSgpLmdldEN1cnJlbnRVcGxvYWRzKCkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgc3RhdHVzQmFyID0gPFVwbG9hZEJhciByb29tPXt0aGlzLnN0YXRlLnJvb219IC8+O1xuICAgICAgICB9IGVsc2UgaWYgKCF0aGlzLnN0YXRlLnNlYXJjaFJlc3VsdHMpIHtcbiAgICAgICAgICAgIGlzU3RhdHVzQXJlYUV4cGFuZGVkID0gdGhpcy5zdGF0ZS5zdGF0dXNCYXJWaXNpYmxlO1xuICAgICAgICAgICAgc3RhdHVzQmFyID0gPFJvb21TdGF0dXNCYXJcbiAgICAgICAgICAgICAgICByb29tPXt0aGlzLnN0YXRlLnJvb219XG4gICAgICAgICAgICAgICAgaXNQZWVraW5nPXtteU1lbWJlcnNoaXAgIT09IFwiam9pblwifVxuICAgICAgICAgICAgICAgIG9uSW52aXRlQ2xpY2s9e3RoaXMub25JbnZpdGVCdXR0b25DbGlja31cbiAgICAgICAgICAgICAgICBvblZpc2libGU9e3RoaXMub25TdGF0dXNCYXJWaXNpYmxlfVxuICAgICAgICAgICAgICAgIG9uSGlkZGVuPXt0aGlzLm9uU3RhdHVzQmFySGlkZGVufVxuICAgICAgICAgICAgLz47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzdGF0dXNCYXJBcmVhQ2xhc3MgPSBjbGFzc05hbWVzKFwibXhfUm9vbVZpZXdfc3RhdHVzQXJlYVwiLCB7XG4gICAgICAgICAgICBcIm14X1Jvb21WaWV3X3N0YXR1c0FyZWFfZXhwYW5kZWRcIjogaXNTdGF0dXNBcmVhRXhwYW5kZWQsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGlmIHN0YXR1c0JhciBkb2VzIG5vdCBleGlzdCB0aGVuIHN0YXR1c0JhckFyZWEgaXMgYmxhbmsgYW5kIHRha2VzIHVwIHVubmVjZXNzYXJ5IHNwYWNlIG9uIHRoZSBzY3JlZW5cbiAgICAgICAgLy8gc2hvdyBzdGF0dXNCYXJBcmVhIG9ubHkgaWYgc3RhdHVzQmFyIGlzIHByZXNlbnRcbiAgICAgICAgY29uc3Qgc3RhdHVzQmFyQXJlYSA9IHN0YXR1c0JhciAmJiA8ZGl2IGNsYXNzTmFtZT17c3RhdHVzQmFyQXJlYUNsYXNzfT5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfUm9vbVZpZXdfc3RhdHVzQXJlYUJveFwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfUm9vbVZpZXdfc3RhdHVzQXJlYUJveF9saW5lXCIgLz5cbiAgICAgICAgICAgICAgICB7IHN0YXR1c0JhciB9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+O1xuXG4gICAgICAgIGNvbnN0IHJvb21WZXJzaW9uUmVjb21tZW5kYXRpb24gPSB0aGlzLnN0YXRlLnVwZ3JhZGVSZWNvbW1lbmRhdGlvbjtcbiAgICAgICAgY29uc3Qgc2hvd1Jvb21VcGdyYWRlQmFyID0gKFxuICAgICAgICAgICAgcm9vbVZlcnNpb25SZWNvbW1lbmRhdGlvbiAmJlxuICAgICAgICAgICAgcm9vbVZlcnNpb25SZWNvbW1lbmRhdGlvbi5uZWVkc1VwZ3JhZGUgJiZcbiAgICAgICAgICAgIHRoaXMuc3RhdGUucm9vbS51c2VyTWF5VXBncmFkZVJvb20odGhpcy5jb250ZXh0LmNyZWRlbnRpYWxzLnVzZXJJZClcbiAgICAgICAgKTtcblxuICAgICAgICBjb25zdCBoaWRkZW5IaWdobGlnaHRDb3VudCA9IHRoaXMuZ2V0SGlkZGVuSGlnaGxpZ2h0Q291bnQoKTtcblxuICAgICAgICBsZXQgYXV4ID0gbnVsbDtcbiAgICAgICAgbGV0IHByZXZpZXdCYXI7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLnNlYXJjaGluZykge1xuICAgICAgICAgICAgYXV4ID0gPFNlYXJjaEJhclxuICAgICAgICAgICAgICAgIHNlYXJjaEluUHJvZ3Jlc3M9e3RoaXMuc3RhdGUuc2VhcmNoSW5Qcm9ncmVzc31cbiAgICAgICAgICAgICAgICBvbkNhbmNlbENsaWNrPXt0aGlzLm9uQ2FuY2VsU2VhcmNoQ2xpY2t9XG4gICAgICAgICAgICAgICAgb25TZWFyY2g9e3RoaXMub25TZWFyY2h9XG4gICAgICAgICAgICAgICAgaXNSb29tRW5jcnlwdGVkPXt0aGlzLmNvbnRleHQuaXNSb29tRW5jcnlwdGVkKHRoaXMuc3RhdGUucm9vbS5yb29tSWQpfVxuICAgICAgICAgICAgLz47XG4gICAgICAgIH0gZWxzZSBpZiAoc2hvd1Jvb21VcGdyYWRlQmFyKSB7XG4gICAgICAgICAgICBhdXggPSA8Um9vbVVwZ3JhZGVXYXJuaW5nQmFyIHJvb209e3RoaXMuc3RhdGUucm9vbX0gLz47XG4gICAgICAgIH0gZWxzZSBpZiAobXlNZW1iZXJzaGlwICE9PSBcImpvaW5cIikge1xuICAgICAgICAgICAgLy8gV2UgZG8gaGF2ZSBhIHJvb20gb2JqZWN0IGZvciB0aGlzIHJvb20sIGJ1dCB3ZSdyZSBub3QgY3VycmVudGx5IGluIGl0LlxuICAgICAgICAgICAgLy8gV2UgbWF5IGhhdmUgYSAzcmQgcGFydHkgaW52aXRlIHRvIGl0LlxuICAgICAgICAgICAgbGV0IGludml0ZXJOYW1lID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMub29iRGF0YSkge1xuICAgICAgICAgICAgICAgIGludml0ZXJOYW1lID0gdGhpcy5wcm9wcy5vb2JEYXRhLmludml0ZXJOYW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgaW52aXRlZEVtYWlsID0gdGhpcy5wcm9wcy50aHJlZXBpZEludml0ZT8udG9FbWFpbDtcbiAgICAgICAgICAgIHByZXZpZXdCYXIgPSAoXG4gICAgICAgICAgICAgICAgPFJvb21QcmV2aWV3QmFyXG4gICAgICAgICAgICAgICAgICAgIG9uSm9pbkNsaWNrPXt0aGlzLm9uSm9pbkJ1dHRvbkNsaWNrZWR9XG4gICAgICAgICAgICAgICAgICAgIG9uRm9yZ2V0Q2xpY2s9e3RoaXMub25Gb3JnZXRDbGlja31cbiAgICAgICAgICAgICAgICAgICAgb25SZWplY3RDbGljaz17dGhpcy5vblJlamVjdFRocmVlcGlkSW52aXRlQnV0dG9uQ2xpY2tlZH1cbiAgICAgICAgICAgICAgICAgICAgam9pbmluZz17dGhpcy5zdGF0ZS5qb2luaW5nfVxuICAgICAgICAgICAgICAgICAgICBpbnZpdGVyTmFtZT17aW52aXRlck5hbWV9XG4gICAgICAgICAgICAgICAgICAgIGludml0ZWRFbWFpbD17aW52aXRlZEVtYWlsfVxuICAgICAgICAgICAgICAgICAgICBvb2JEYXRhPXt0aGlzLnByb3BzLm9vYkRhdGF9XG4gICAgICAgICAgICAgICAgICAgIGNhblByZXZpZXc9e3RoaXMuc3RhdGUuY2FuUGVla31cbiAgICAgICAgICAgICAgICAgICAgcm9vbT17dGhpcy5zdGF0ZS5yb29tfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgaWYgKCF0aGlzLnN0YXRlLmNhblBlZWsgJiYgKCFTcGFjZVN0b3JlLnNwYWNlc0VuYWJsZWQgfHwgIXRoaXMuc3RhdGUucm9vbT8uaXNTcGFjZVJvb20oKSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X1Jvb21WaWV3XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICB7IHByZXZpZXdCYXIgfVxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGhpZGRlbkhpZ2hsaWdodENvdW50ID4gMCkge1xuICAgICAgICAgICAgYXV4ID0gKFxuICAgICAgICAgICAgICAgIDxBY2Nlc3NpYmxlQnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQ9XCJkaXZcIlxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJteF9Sb29tVmlld19hdXhQYW5lbF9oaWRkZW5IaWdobGlnaHRzXCJcbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5vbkhpZGRlbkhpZ2hsaWdodHNDbGlja31cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIHsgX3QoXG4gICAgICAgICAgICAgICAgICAgICAgICBcIllvdSBoYXZlICUoY291bnQpcyB1bnJlYWQgbm90aWZpY2F0aW9ucyBpbiBhIHByaW9yIHZlcnNpb24gb2YgdGhpcyByb29tLlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgeyBjb3VudDogaGlkZGVuSGlnaGxpZ2h0Q291bnQgfSxcbiAgICAgICAgICAgICAgICAgICAgKSB9XG4gICAgICAgICAgICAgICAgPC9BY2Nlc3NpYmxlQnV0dG9uPlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnN0YXRlLnJvb20/LmlzU3BhY2VSb29tKCkgJiYgIXRoaXMucHJvcHMuZm9yY2VUaW1lbGluZSkge1xuICAgICAgICAgICAgcmV0dXJuIDxTcGFjZVJvb21WaWV3XG4gICAgICAgICAgICAgICAgc3BhY2U9e3RoaXMuc3RhdGUucm9vbX1cbiAgICAgICAgICAgICAgICBqdXN0Q3JlYXRlZE9wdHM9e3RoaXMucHJvcHMuanVzdENyZWF0ZWRPcHRzfVxuICAgICAgICAgICAgICAgIHJlc2l6ZU5vdGlmaWVyPXt0aGlzLnByb3BzLnJlc2l6ZU5vdGlmaWVyfVxuICAgICAgICAgICAgICAgIG9uSm9pbkJ1dHRvbkNsaWNrZWQ9e3RoaXMub25Kb2luQnV0dG9uQ2xpY2tlZH1cbiAgICAgICAgICAgICAgICBvblJlamVjdEJ1dHRvbkNsaWNrZWQ9e3RoaXMucHJvcHMudGhyZWVwaWRJbnZpdGVcbiAgICAgICAgICAgICAgICAgICAgPyB0aGlzLm9uUmVqZWN0VGhyZWVwaWRJbnZpdGVCdXR0b25DbGlja2VkXG4gICAgICAgICAgICAgICAgICAgIDogdGhpcy5vblJlamVjdEJ1dHRvbkNsaWNrZWR9XG4gICAgICAgICAgICAvPjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGF1eFBhbmVsID0gKFxuICAgICAgICAgICAgPEF1eFBhbmVsXG4gICAgICAgICAgICAgICAgcm9vbT17dGhpcy5zdGF0ZS5yb29tfVxuICAgICAgICAgICAgICAgIHVzZXJJZD17dGhpcy5jb250ZXh0LmNyZWRlbnRpYWxzLnVzZXJJZH1cbiAgICAgICAgICAgICAgICBzaG93QXBwcz17dGhpcy5zdGF0ZS5zaG93QXBwc31cbiAgICAgICAgICAgICAgICByZXNpemVOb3RpZmllcj17dGhpcy5wcm9wcy5yZXNpemVOb3RpZmllcn1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7IGF1eCB9XG4gICAgICAgICAgICA8L0F1eFBhbmVsPlxuICAgICAgICApO1xuXG4gICAgICAgIGxldCBtZXNzYWdlQ29tcG9zZXI7IGxldCBzZWFyY2hJbmZvO1xuICAgICAgICBjb25zdCBjYW5TcGVhayA9IChcbiAgICAgICAgICAgIC8vIGpvaW5lZCBhbmQgbm90IHNob3dpbmcgc2VhcmNoIHJlc3VsdHNcbiAgICAgICAgICAgIG15TWVtYmVyc2hpcCA9PT0gJ2pvaW4nICYmICF0aGlzLnN0YXRlLnNlYXJjaFJlc3VsdHNcbiAgICAgICAgKTtcbiAgICAgICAgaWYgKGNhblNwZWFrKSB7XG4gICAgICAgICAgICBtZXNzYWdlQ29tcG9zZXIgPVxuICAgICAgICAgICAgICAgIDxNZXNzYWdlQ29tcG9zZXJcbiAgICAgICAgICAgICAgICAgICAgcm9vbT17dGhpcy5zdGF0ZS5yb29tfVxuICAgICAgICAgICAgICAgICAgICBlMmVTdGF0dXM9e3RoaXMuc3RhdGUuZTJlU3RhdHVzfVxuICAgICAgICAgICAgICAgICAgICByZXNpemVOb3RpZmllcj17dGhpcy5wcm9wcy5yZXNpemVOb3RpZmllcn1cbiAgICAgICAgICAgICAgICAgICAgcmVwbHlUb0V2ZW50PXt0aGlzLnN0YXRlLnJlcGx5VG9FdmVudH1cbiAgICAgICAgICAgICAgICAgICAgcGVybWFsaW5rQ3JlYXRvcj17dGhpcy5nZXRQZXJtYWxpbmtDcmVhdG9yRm9yUm9vbSh0aGlzLnN0YXRlLnJvb20pfVxuICAgICAgICAgICAgICAgIC8+O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVE9ETzogV2h5IGFyZW4ndCB3ZSBzdG9yaW5nIHRoZSB0ZXJtL3Njb3BlL2NvdW50IGluIHRoaXMgZm9ybWF0XG4gICAgICAgIC8vIGluIHRoaXMuc3RhdGUgaWYgdGhpcyBpcyB3aGF0IFJvb21IZWFkZXIgZGVzaXJlcz9cbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuc2VhcmNoUmVzdWx0cykge1xuICAgICAgICAgICAgc2VhcmNoSW5mbyA9IHtcbiAgICAgICAgICAgICAgICBzZWFyY2hUZXJtOiB0aGlzLnN0YXRlLnNlYXJjaFRlcm0sXG4gICAgICAgICAgICAgICAgc2VhcmNoU2NvcGU6IHRoaXMuc3RhdGUuc2VhcmNoU2NvcGUsXG4gICAgICAgICAgICAgICAgc2VhcmNoQ291bnQ6IHRoaXMuc3RhdGUuc2VhcmNoUmVzdWx0cy5jb3VudCxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpZiB3ZSBoYXZlIHNlYXJjaCByZXN1bHRzLCB3ZSBrZWVwIHRoZSBtZXNzYWdlcGFuZWwgKHNvIHRoYXQgaXQgcHJlc2VydmVzIGl0c1xuICAgICAgICAvLyBzY3JvbGwgc3RhdGUpLCBidXQgaGlkZSBpdC5cbiAgICAgICAgbGV0IHNlYXJjaFJlc3VsdHNQYW5lbDtcbiAgICAgICAgbGV0IGhpZGVNZXNzYWdlUGFuZWwgPSBmYWxzZTtcblxuICAgICAgICBpZiAodGhpcy5zdGF0ZS5zZWFyY2hSZXN1bHRzKSB7XG4gICAgICAgICAgICAvLyBzaG93IHNlYXJjaGluZyBzcGlubmVyXG4gICAgICAgICAgICBpZiAodGhpcy5zdGF0ZS5zZWFyY2hSZXN1bHRzLmNvdW50ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBzZWFyY2hSZXN1bHRzUGFuZWwgPSAoXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfUm9vbVZpZXdfbWVzc2FnZVBhbmVsIG14X1Jvb21WaWV3X21lc3NhZ2VQYW5lbFNlYXJjaFNwaW5uZXJcIiAvPlxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHNlYXJjaFJlc3VsdHNQYW5lbCA9IChcbiAgICAgICAgICAgICAgICAgICAgPFNjcm9sbFBhbmVsXG4gICAgICAgICAgICAgICAgICAgICAgICByZWY9e3RoaXMuc2VhcmNoUmVzdWx0c1BhbmVsfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXhfUm9vbVZpZXdfbWVzc2FnZVBhbmVsIG14X1Jvb21WaWV3X3NlYXJjaFJlc3VsdHNQYW5lbCBteF9Hcm91cExheW91dFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkZpbGxSZXF1ZXN0PXt0aGlzLm9uU2VhcmNoUmVzdWx0c0ZpbGxSZXF1ZXN0fVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzaXplTm90aWZpZXI9e3RoaXMucHJvcHMucmVzaXplTm90aWZpZXJ9XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxsaSBjbGFzc05hbWU9e3Njcm9sbGhlYWRlckNsYXNzZXN9IC8+XG4gICAgICAgICAgICAgICAgICAgICAgICB7IHRoaXMuZ2V0U2VhcmNoUmVzdWx0VGlsZXMoKSB9XG4gICAgICAgICAgICAgICAgICAgIDwvU2Nyb2xsUGFuZWw+XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGhpZGVNZXNzYWdlUGFuZWwgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGhpZ2hsaWdodGVkRXZlbnRJZCA9IG51bGw7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmlzSW5pdGlhbEV2ZW50SGlnaGxpZ2h0ZWQpIHtcbiAgICAgICAgICAgIGhpZ2hsaWdodGVkRXZlbnRJZCA9IHRoaXMuc3RhdGUuaW5pdGlhbEV2ZW50SWQ7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBtZXNzYWdlUGFuZWxDbGFzc05hbWVzID0gY2xhc3NOYW1lcyhcbiAgICAgICAgICAgIFwibXhfUm9vbVZpZXdfbWVzc2FnZVBhbmVsXCIsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgXCJteF9JUkNMYXlvdXRcIjogdGhpcy5zdGF0ZS5sYXlvdXQgPT0gTGF5b3V0LklSQyxcbiAgICAgICAgICAgICAgICBcIm14X0dyb3VwTGF5b3V0XCI6IHRoaXMuc3RhdGUubGF5b3V0ID09IExheW91dC5Hcm91cCxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGNvbnNvbGUuaW5mbyhcIlNob3dVcmxQcmV2aWV3IGZvciAlcyBpcyAlc1wiLCB0aGlzLnN0YXRlLnJvb20ucm9vbUlkLCB0aGlzLnN0YXRlLnNob3dVcmxQcmV2aWV3KTtcbiAgICAgICAgY29uc3QgbWVzc2FnZVBhbmVsID0gKFxuICAgICAgICAgICAgPFRpbWVsaW5lUGFuZWxcbiAgICAgICAgICAgICAgICByZWY9e3RoaXMuZ2F0aGVyVGltZWxpbmVQYW5lbFJlZn1cbiAgICAgICAgICAgICAgICB0aW1lbGluZVNldD17dGhpcy5zdGF0ZS5yb29tLmdldFVuZmlsdGVyZWRUaW1lbGluZVNldCgpfVxuICAgICAgICAgICAgICAgIHNob3dSZWFkUmVjZWlwdHM9e3RoaXMuc3RhdGUuc2hvd1JlYWRSZWNlaXB0c31cbiAgICAgICAgICAgICAgICBtYW5hZ2VSZWFkUmVjZWlwdHM9eyF0aGlzLnN0YXRlLmlzUGVla2luZ31cbiAgICAgICAgICAgICAgICBzZW5kUmVhZFJlY2VpcHRPbkxvYWQ9eyF0aGlzLnN0YXRlLndhc0NvbnRleHRTd2l0Y2h9XG4gICAgICAgICAgICAgICAgbWFuYWdlUmVhZE1hcmtlcnM9eyF0aGlzLnN0YXRlLmlzUGVla2luZ31cbiAgICAgICAgICAgICAgICBoaWRkZW49e2hpZGVNZXNzYWdlUGFuZWx9XG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0ZWRFdmVudElkPXtoaWdobGlnaHRlZEV2ZW50SWR9XG4gICAgICAgICAgICAgICAgZXZlbnRJZD17dGhpcy5zdGF0ZS5pbml0aWFsRXZlbnRJZH1cbiAgICAgICAgICAgICAgICBldmVudFBpeGVsT2Zmc2V0PXt0aGlzLnN0YXRlLmluaXRpYWxFdmVudFBpeGVsT2Zmc2V0fVxuICAgICAgICAgICAgICAgIG9uU2Nyb2xsPXt0aGlzLm9uTWVzc2FnZUxpc3RTY3JvbGx9XG4gICAgICAgICAgICAgICAgb25Vc2VyU2Nyb2xsPXt0aGlzLm9uVXNlclNjcm9sbH1cbiAgICAgICAgICAgICAgICBvblJlYWRNYXJrZXJVcGRhdGVkPXt0aGlzLnVwZGF0ZVRvcFVucmVhZE1lc3NhZ2VzQmFyfVxuICAgICAgICAgICAgICAgIHNob3dVcmxQcmV2aWV3PXt0aGlzLnN0YXRlLnNob3dVcmxQcmV2aWV3fVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17bWVzc2FnZVBhbmVsQ2xhc3NOYW1lc31cbiAgICAgICAgICAgICAgICBtZW1iZXJzTG9hZGVkPXt0aGlzLnN0YXRlLm1lbWJlcnNMb2FkZWR9XG4gICAgICAgICAgICAgICAgcGVybWFsaW5rQ3JlYXRvcj17dGhpcy5nZXRQZXJtYWxpbmtDcmVhdG9yRm9yUm9vbSh0aGlzLnN0YXRlLnJvb20pfVxuICAgICAgICAgICAgICAgIHJlc2l6ZU5vdGlmaWVyPXt0aGlzLnByb3BzLnJlc2l6ZU5vdGlmaWVyfVxuICAgICAgICAgICAgICAgIHNob3dSZWFjdGlvbnM9e3RydWV9XG4gICAgICAgICAgICAgICAgbGF5b3V0PXt0aGlzLnN0YXRlLmxheW91dH1cbiAgICAgICAgICAgICAgICBlZGl0U3RhdGU9e3RoaXMuc3RhdGUuZWRpdFN0YXRlfVxuICAgICAgICAgICAgLz4pO1xuXG4gICAgICAgIGxldCB0b3BVbnJlYWRNZXNzYWdlc0JhciA9IG51bGw7XG4gICAgICAgIC8vIERvIG5vdCBzaG93IFRvcFVucmVhZE1lc3NhZ2VzQmFyIGlmIHdlIGhhdmUgc2VhcmNoIHJlc3VsdHMgc2hvd2luZywgaXQgbWFrZXMgbm8gc2Vuc2VcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuc2hvd1RvcFVucmVhZE1lc3NhZ2VzQmFyICYmICF0aGlzLnN0YXRlLnNlYXJjaFJlc3VsdHMpIHtcbiAgICAgICAgICAgIHRvcFVucmVhZE1lc3NhZ2VzQmFyID0gKFxuICAgICAgICAgICAgICAgIDxUb3BVbnJlYWRNZXNzYWdlc0JhciBvblNjcm9sbFVwQ2xpY2s9e3RoaXMuanVtcFRvUmVhZE1hcmtlcn0gb25DbG9zZUNsaWNrPXt0aGlzLmZvcmdldFJlYWRNYXJrZXJ9IC8+XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGxldCBqdW1wVG9Cb3R0b207XG4gICAgICAgIC8vIERvIG5vdCBzaG93IEp1bXBUb0JvdHRvbUJ1dHRvbiBpZiB3ZSBoYXZlIHNlYXJjaCByZXN1bHRzIHNob3dpbmcsIGl0IG1ha2VzIG5vIHNlbnNlXG4gICAgICAgIGlmICghdGhpcy5zdGF0ZS5hdEVuZE9mTGl2ZVRpbWVsaW5lICYmICF0aGlzLnN0YXRlLnNlYXJjaFJlc3VsdHMpIHtcbiAgICAgICAgICAgIGp1bXBUb0JvdHRvbSA9ICg8SnVtcFRvQm90dG9tQnV0dG9uXG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0PXt0aGlzLnN0YXRlLnJvb20uZ2V0VW5yZWFkTm90aWZpY2F0aW9uQ291bnQoTm90aWZpY2F0aW9uQ291bnRUeXBlLkhpZ2hsaWdodCkgPiAwfVxuICAgICAgICAgICAgICAgIG51bVVucmVhZE1lc3NhZ2VzPXt0aGlzLnN0YXRlLm51bVVucmVhZE1lc3NhZ2VzfVxuICAgICAgICAgICAgICAgIG9uU2Nyb2xsVG9Cb3R0b21DbGljaz17dGhpcy5qdW1wVG9MaXZlVGltZWxpbmV9XG4gICAgICAgICAgICAvPik7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzaG93UmlnaHRQYW5lbCA9IHRoaXMuc3RhdGUucm9vbSAmJiB0aGlzLnN0YXRlLnNob3dSaWdodFBhbmVsO1xuXG4gICAgICAgIGNvbnN0IHJpZ2h0UGFuZWwgPSBzaG93UmlnaHRQYW5lbFxuICAgICAgICAgICAgPyA8UmlnaHRQYW5lbFxuICAgICAgICAgICAgICAgIHJvb209e3RoaXMuc3RhdGUucm9vbX1cbiAgICAgICAgICAgICAgICByZXNpemVOb3RpZmllcj17dGhpcy5wcm9wcy5yZXNpemVOb3RpZmllcn1cbiAgICAgICAgICAgICAgICBwZXJtYWxpbmtDcmVhdG9yPXt0aGlzLmdldFBlcm1hbGlua0NyZWF0b3JGb3JSb29tKHRoaXMuc3RhdGUucm9vbSl9XG4gICAgICAgICAgICAgICAgZTJlU3RhdHVzPXt0aGlzLnN0YXRlLmUyZVN0YXR1c30gLz5cbiAgICAgICAgICAgIDogbnVsbDtcblxuICAgICAgICBjb25zdCB0aW1lbGluZUNsYXNzZXMgPSBjbGFzc05hbWVzKFwibXhfUm9vbVZpZXdfdGltZWxpbmVcIiwge1xuICAgICAgICAgICAgbXhfUm9vbVZpZXdfdGltZWxpbmVfcnJfZW5hYmxlZDogdGhpcy5zdGF0ZS5zaG93UmVhZFJlY2VpcHRzLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBtYWluQ2xhc3NlcyA9IGNsYXNzTmFtZXMoXCJteF9Sb29tVmlld1wiLCB7XG4gICAgICAgICAgICBteF9Sb29tVmlld19pbkNhbGw6IEJvb2xlYW4oYWN0aXZlQ2FsbCksXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHNob3dDaGF0RWZmZWN0cyA9IFNldHRpbmdzU3RvcmUuZ2V0VmFsdWUoJ3Nob3dDaGF0RWZmZWN0cycpO1xuXG4gICAgICAgIC8vIERlY2lkZSB3aGF0IHRvIHNob3cgaW4gdGhlIG1haW4gc3BsaXRcbiAgICAgICAgbGV0IG1haW5TcGxpdEJvZHkgPSA8UmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICAgICB7IGF1eFBhbmVsIH1cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXt0aW1lbGluZUNsYXNzZXN9PlxuICAgICAgICAgICAgICAgIHsgZmlsZURyb3BUYXJnZXQgfVxuICAgICAgICAgICAgICAgIHsgdG9wVW5yZWFkTWVzc2FnZXNCYXIgfVxuICAgICAgICAgICAgICAgIHsganVtcFRvQm90dG9tIH1cbiAgICAgICAgICAgICAgICB7IG1lc3NhZ2VQYW5lbCB9XG4gICAgICAgICAgICAgICAgeyBzZWFyY2hSZXN1bHRzUGFuZWwgfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICB7IHN0YXR1c0JhckFyZWEgfVxuICAgICAgICAgICAgeyBwcmV2aWV3QmFyIH1cbiAgICAgICAgICAgIHsgbWVzc2FnZUNvbXBvc2VyIH1cbiAgICAgICAgPC9SZWFjdC5GcmFnbWVudD47XG5cbiAgICAgICAgc3dpdGNoICh0aGlzLnN0YXRlLm1haW5TcGxpdENvbnRlbnRUeXBlKSB7XG4gICAgICAgICAgICBjYXNlIE1haW5TcGxpdENvbnRlbnRUeXBlLlRpbWVsaW5lOlxuICAgICAgICAgICAgICAgIC8vIGtlZXAgdGhlIHRpbWVsaW5lIGluIGFzIHRoZSBtYWluU3BsaXRCb2R5XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIE1haW5TcGxpdENvbnRlbnRUeXBlLk1heGltaXNlZFdpZGdldDpcbiAgICAgICAgICAgICAgICBpZiAoIVNldHRpbmdzU3RvcmUuZ2V0VmFsdWUoXCJmZWF0dXJlX21heGltaXNlZF93aWRnZXRzXCIpKSBicmVhaztcbiAgICAgICAgICAgICAgICBtYWluU3BsaXRCb2R5ID0gPEFwcHNEcmF3ZXJcbiAgICAgICAgICAgICAgICAgICAgcm9vbT17dGhpcy5zdGF0ZS5yb29tfVxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ9e3RoaXMuY29udGV4dC5jcmVkZW50aWFscy51c2VySWR9XG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZU5vdGlmaWVyPXt0aGlzLnByb3BzLnJlc2l6ZU5vdGlmaWVyfVxuICAgICAgICAgICAgICAgICAgICBzaG93QXBwcz17dHJ1ZX1cbiAgICAgICAgICAgICAgICAvPjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIC8vIFRPRE8tdmlkZW8gTWFpblNwbGl0Q29udGVudFR5cGUuVmlkZW86XG4gICAgICAgICAgICAvLyAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGV4Y2x1ZGVkUmlnaHRQYW5lbFBoYXNlQnV0dG9ucyA9IFtSaWdodFBhbmVsUGhhc2VzLlRpbWVsaW5lXTtcbiAgICAgICAgbGV0IG9uQXBwc0NsaWNrID0gdGhpcy5vbkFwcHNDbGljaztcbiAgICAgICAgbGV0IG9uRm9yZ2V0Q2xpY2sgPSB0aGlzLm9uRm9yZ2V0Q2xpY2s7XG4gICAgICAgIGxldCBvblNlYXJjaENsaWNrID0gdGhpcy5vblNlYXJjaENsaWNrO1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5tYWluU3BsaXRDb250ZW50VHlwZSA9PT0gTWFpblNwbGl0Q29udGVudFR5cGUuTWF4aW1pc2VkV2lkZ2V0KSB7XG4gICAgICAgICAgICAvLyBEaXNhYmxlIHBoYXNlIGJ1dHRvbnMgYW5kIGFjdGlvbiBidXR0b24gdG8gaGF2ZSBhIHNpbXBsaWZpZWQgaGVhZGVyIHdoZW4gYSB3aWRnZXQgaXMgbWF4aW1pc2VkXG4gICAgICAgICAgICAvLyBhbmQgZW5hYmxlIChub3QgZGlzYWJsZSkgdGhlIFJpZ2h0UGFuZWxQaGFzZXMuVGltZWxpbmUgYnV0dG9uXG4gICAgICAgICAgICBleGNsdWRlZFJpZ2h0UGFuZWxQaGFzZUJ1dHRvbnMgPSBbXG4gICAgICAgICAgICAgICAgUmlnaHRQYW5lbFBoYXNlcy5UaHJlYWRQYW5lbCxcbiAgICAgICAgICAgICAgICBSaWdodFBhbmVsUGhhc2VzLlBpbm5lZE1lc3NhZ2VzLFxuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIG9uQXBwc0NsaWNrID0gbnVsbDtcbiAgICAgICAgICAgIG9uRm9yZ2V0Q2xpY2sgPSBudWxsO1xuICAgICAgICAgICAgb25TZWFyY2hDbGljayA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxSb29tQ29udGV4dC5Qcm92aWRlciB2YWx1ZT17dGhpcy5zdGF0ZX0+XG4gICAgICAgICAgICAgICAgPG1haW4gY2xhc3NOYW1lPXttYWluQ2xhc3Nlc30gcmVmPXt0aGlzLnJvb21WaWV3fSBvbktleURvd249e3RoaXMub25SZWFjdEtleURvd259PlxuICAgICAgICAgICAgICAgICAgICB7IHNob3dDaGF0RWZmZWN0cyAmJiB0aGlzLnJvb21WaWV3LmN1cnJlbnQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIDxFZmZlY3RzT3ZlcmxheSByb29tV2lkdGg9e3RoaXMucm9vbVZpZXcuY3VycmVudC5vZmZzZXRXaWR0aH0gLz5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICA8RXJyb3JCb3VuZGFyeT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxSb29tSGVhZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm9vbT17dGhpcy5zdGF0ZS5yb29tfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlYXJjaEluZm89e3NlYXJjaEluZm99XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb29iRGF0YT17dGhpcy5wcm9wcy5vb2JEYXRhfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluUm9vbT17bXlNZW1iZXJzaGlwID09PSAnam9pbid9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25TZWFyY2hDbGljaz17b25TZWFyY2hDbGlja31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkZvcmdldENsaWNrPXsobXlNZW1iZXJzaGlwID09PSBcImxlYXZlXCIpID8gb25Gb3JnZXRDbGljayA6IG51bGx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZTJlU3RhdHVzPXt0aGlzLnN0YXRlLmUyZVN0YXR1c31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkFwcHNDbGljaz17dGhpcy5zdGF0ZS5oYXNQaW5uZWRXaWRnZXRzID8gb25BcHBzQ2xpY2sgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcHNTaG93bj17dGhpcy5zdGF0ZS5zaG93QXBwc31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNhbGxQbGFjZWQ9e3RoaXMub25DYWxsUGxhY2VkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVkUmlnaHRQYW5lbFBoYXNlQnV0dG9ucz17ZXhjbHVkZWRSaWdodFBhbmVsUGhhc2VCdXR0b25zfVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxNYWluU3BsaXQgcGFuZWw9e3JpZ2h0UGFuZWx9IHJlc2l6ZU5vdGlmaWVyPXt0aGlzLnByb3BzLnJlc2l6ZU5vdGlmaWVyfT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X1Jvb21WaWV3X2JvZHlcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBtYWluU3BsaXRCb2R5IH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvTWFpblNwbGl0PlxuICAgICAgICAgICAgICAgICAgICA8L0Vycm9yQm91bmRhcnk+XG4gICAgICAgICAgICAgICAgPC9tYWluPlxuICAgICAgICAgICAgPC9Sb29tQ29udGV4dC5Qcm92aWRlcj5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbmNvbnN0IFJvb21WaWV3V2l0aE1hdHJpeENsaWVudCA9IHdpdGhNYXRyaXhDbGllbnRIT0MoUm9vbVZpZXcpO1xuZXhwb3J0IGRlZmF1bHQgUm9vbVZpZXdXaXRoTWF0cml4Q2xpZW50O1xuIl19