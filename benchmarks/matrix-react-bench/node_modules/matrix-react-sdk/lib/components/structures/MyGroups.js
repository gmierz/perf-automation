"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireDefault(require("react"));

var sdk = _interopRequireWildcard(require("../../index"));

var _languageHandler = require("../../languageHandler");

var _SdkConfig = _interopRequireDefault(require("../../SdkConfig"));

var _dispatcher = _interopRequireDefault(require("../../dispatcher/dispatcher"));

var _AccessibleButton = _interopRequireDefault(require("../views/elements/AccessibleButton"));

var _MatrixClientContext = _interopRequireDefault(require("../../contexts/MatrixClientContext"));

var _AutoHideScrollbar = _interopRequireDefault(require("./AutoHideScrollbar"));

var _replaceableComponent = require("../../utils/replaceableComponent");

var _dec, _class, _class2, _temp;

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

let MyGroups = (_dec = (0, _replaceableComponent.replaceableComponent)("structures.MyGroups"), _dec(_class = (_temp = _class2 = class MyGroups extends _react.default.Component {
  constructor(...args) {
    super(...args);
    (0, _defineProperty2.default)(this, "state", {
      groups: null,
      error: null
    });
    (0, _defineProperty2.default)(this, "_onCreateGroupClick", () => {
      _dispatcher.default.dispatch({
        action: 'view_create_group'
      });
    });
  }

  componentDidMount() {
    this._fetch();
  }

  _fetch() {
    this.context.getJoinedGroups().then(result => {
      this.setState({
        groups: result.groups,
        error: null
      });
    }, err => {
      if (err.errcode === 'M_GUEST_ACCESS_FORBIDDEN') {
        // Indicate that the guest isn't in any groups (which should be true)
        this.setState({
          groups: [],
          error: null
        });
        return;
      }

      this.setState({
        groups: null,
        error: err
      });
    });
  }

  render() {
    const brand = _SdkConfig.default.get().brand;

    const Loader = sdk.getComponent("elements.Spinner");
    const SimpleRoomHeader = sdk.getComponent('rooms.SimpleRoomHeader');
    const GroupTile = sdk.getComponent("groups.GroupTile");
    let content;
    let contentHeader;

    if (this.state.groups) {
      const groupNodes = [];
      this.state.groups.forEach(g => {
        groupNodes.push( /*#__PURE__*/_react.default.createElement(GroupTile, {
          key: g,
          groupId: g
        }));
      });
      contentHeader = groupNodes.length > 0 ? /*#__PURE__*/_react.default.createElement("h3", null, (0, _languageHandler._t)('Your Communities')) : /*#__PURE__*/_react.default.createElement("div", null);
      content = groupNodes.length > 0 ? /*#__PURE__*/_react.default.createElement(_AutoHideScrollbar.default, {
        className: "mx_MyGroups_scrollable"
      }, /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_MyGroups_microcopy"
      }, /*#__PURE__*/_react.default.createElement("p", null, (0, _languageHandler._t)("Did you know: you can use communities to filter your %(brand)s experience!", {
        brand
      })), /*#__PURE__*/_react.default.createElement("p", null, (0, _languageHandler._t)("You can click on an avatar in the " + "filter panel at any time to see only the rooms and people associated " + "with that community."))), /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_MyGroups_joinedGroups"
      }, groupNodes)) : /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_MyGroups_placeholder"
      }, (0, _languageHandler._t)("You're not currently a member of any communities."));
    } else if (this.state.error) {
      content = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_MyGroups_error"
      }, (0, _languageHandler._t)('Error whilst fetching joined communities'));
    } else {
      content = /*#__PURE__*/_react.default.createElement(Loader, null);
    }

    return /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_MyGroups"
    }, /*#__PURE__*/_react.default.createElement(SimpleRoomHeader, {
      title: (0, _languageHandler._t)("Communities"),
      icon: require("../../../res/img/icons-groups.svg")
    }), /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_MyGroups_header"
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_MyGroups_headerCard"
    }, /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
      className: "mx_MyGroups_headerCard_button",
      onClick: this._onCreateGroupClick
    }), /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_MyGroups_headerCard_content"
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_MyGroups_headerCard_header"
    }, (0, _languageHandler._t)('Create a new community')), (0, _languageHandler._t)('Create a community to group together users and rooms! ' + 'Build a custom homepage to mark out your space in the Matrix universe.')))), /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_MyGroups_content"
    }, contentHeader, content));
  }

}, (0, _defineProperty2.default)(_class2, "contextType", _MatrixClientContext.default), _temp)) || _class);
exports.default = MyGroups;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3N0cnVjdHVyZXMvTXlHcm91cHMuanMiXSwibmFtZXMiOlsiTXlHcm91cHMiLCJSZWFjdCIsIkNvbXBvbmVudCIsImdyb3VwcyIsImVycm9yIiwiZGlzIiwiZGlzcGF0Y2giLCJhY3Rpb24iLCJjb21wb25lbnREaWRNb3VudCIsIl9mZXRjaCIsImNvbnRleHQiLCJnZXRKb2luZWRHcm91cHMiLCJ0aGVuIiwicmVzdWx0Iiwic2V0U3RhdGUiLCJlcnIiLCJlcnJjb2RlIiwicmVuZGVyIiwiYnJhbmQiLCJTZGtDb25maWciLCJnZXQiLCJMb2FkZXIiLCJzZGsiLCJnZXRDb21wb25lbnQiLCJTaW1wbGVSb29tSGVhZGVyIiwiR3JvdXBUaWxlIiwiY29udGVudCIsImNvbnRlbnRIZWFkZXIiLCJzdGF0ZSIsImdyb3VwTm9kZXMiLCJmb3JFYWNoIiwiZyIsInB1c2giLCJsZW5ndGgiLCJyZXF1aXJlIiwiX29uQ3JlYXRlR3JvdXBDbGljayIsIk1hdHJpeENsaWVudENvbnRleHQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBa0JBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7Ozs7OztJQUdxQkEsUSxXQURwQixnREFBcUIscUJBQXJCLEMsbUNBQUQsTUFDcUJBLFFBRHJCLFNBQ3NDQyxlQUFNQyxTQUQ1QyxDQUNzRDtBQUFBO0FBQUE7QUFBQSxpREFHMUM7QUFDSkMsTUFBQUEsTUFBTSxFQUFFLElBREo7QUFFSkMsTUFBQUEsS0FBSyxFQUFFO0FBRkgsS0FIMEM7QUFBQSwrREFZNUIsTUFBTTtBQUN4QkMsMEJBQUlDLFFBQUosQ0FBYTtBQUFFQyxRQUFBQSxNQUFNLEVBQUU7QUFBVixPQUFiO0FBQ0gsS0FkaUQ7QUFBQTs7QUFRbERDLEVBQUFBLGlCQUFpQixHQUFHO0FBQ2hCLFNBQUtDLE1BQUw7QUFDSDs7QUFNREEsRUFBQUEsTUFBTSxHQUFHO0FBQ0wsU0FBS0MsT0FBTCxDQUFhQyxlQUFiLEdBQStCQyxJQUEvQixDQUFxQ0MsTUFBRCxJQUFZO0FBQzVDLFdBQUtDLFFBQUwsQ0FBYztBQUFFWCxRQUFBQSxNQUFNLEVBQUVVLE1BQU0sQ0FBQ1YsTUFBakI7QUFBeUJDLFFBQUFBLEtBQUssRUFBRTtBQUFoQyxPQUFkO0FBQ0gsS0FGRCxFQUVJVyxHQUFELElBQVM7QUFDUixVQUFJQSxHQUFHLENBQUNDLE9BQUosS0FBZ0IsMEJBQXBCLEVBQWdEO0FBQzVDO0FBQ0EsYUFBS0YsUUFBTCxDQUFjO0FBQUVYLFVBQUFBLE1BQU0sRUFBRSxFQUFWO0FBQWNDLFVBQUFBLEtBQUssRUFBRTtBQUFyQixTQUFkO0FBQ0E7QUFDSDs7QUFDRCxXQUFLVSxRQUFMLENBQWM7QUFBRVgsUUFBQUEsTUFBTSxFQUFFLElBQVY7QUFBZ0JDLFFBQUFBLEtBQUssRUFBRVc7QUFBdkIsT0FBZDtBQUNILEtBVEQ7QUFVSDs7QUFFREUsRUFBQUEsTUFBTSxHQUFHO0FBQ0wsVUFBTUMsS0FBSyxHQUFHQyxtQkFBVUMsR0FBVixHQUFnQkYsS0FBOUI7O0FBQ0EsVUFBTUcsTUFBTSxHQUFHQyxHQUFHLENBQUNDLFlBQUosQ0FBaUIsa0JBQWpCLENBQWY7QUFDQSxVQUFNQyxnQkFBZ0IsR0FBR0YsR0FBRyxDQUFDQyxZQUFKLENBQWlCLHdCQUFqQixDQUF6QjtBQUNBLFVBQU1FLFNBQVMsR0FBR0gsR0FBRyxDQUFDQyxZQUFKLENBQWlCLGtCQUFqQixDQUFsQjtBQUVBLFFBQUlHLE9BQUo7QUFDQSxRQUFJQyxhQUFKOztBQUNBLFFBQUksS0FBS0MsS0FBTCxDQUFXekIsTUFBZixFQUF1QjtBQUNuQixZQUFNMEIsVUFBVSxHQUFHLEVBQW5CO0FBQ0EsV0FBS0QsS0FBTCxDQUFXekIsTUFBWCxDQUFrQjJCLE9BQWxCLENBQTJCQyxDQUFELElBQU87QUFDN0JGLFFBQUFBLFVBQVUsQ0FBQ0csSUFBWCxlQUFnQiw2QkFBQyxTQUFEO0FBQVcsVUFBQSxHQUFHLEVBQUVELENBQWhCO0FBQW1CLFVBQUEsT0FBTyxFQUFFQTtBQUE1QixVQUFoQjtBQUNILE9BRkQ7QUFHQUosTUFBQUEsYUFBYSxHQUFHRSxVQUFVLENBQUNJLE1BQVgsR0FBb0IsQ0FBcEIsZ0JBQXdCLHlDQUFNLHlCQUFHLGtCQUFILENBQU4sQ0FBeEIsZ0JBQThELHlDQUE5RTtBQUNBUCxNQUFBQSxPQUFPLEdBQUdHLFVBQVUsQ0FBQ0ksTUFBWCxHQUFvQixDQUFwQixnQkFDTiw2QkFBQywwQkFBRDtBQUFtQixRQUFBLFNBQVMsRUFBQztBQUE3QixzQkFDSTtBQUFLLFFBQUEsU0FBUyxFQUFDO0FBQWYsc0JBQ0ksd0NBQ00seUJBQ0UsNEVBREYsRUFFRTtBQUFFZixRQUFBQTtBQUFGLE9BRkYsQ0FETixDQURKLGVBT0ksd0NBQ00seUJBQ0UsdUNBQ0EsdUVBREEsR0FFQSxzQkFIRixDQUROLENBUEosQ0FESixlQWdCSTtBQUFLLFFBQUEsU0FBUyxFQUFDO0FBQWYsU0FDTVcsVUFETixDQWhCSixDQURNLGdCQXFCTjtBQUFLLFFBQUEsU0FBUyxFQUFDO0FBQWYsU0FDTSx5QkFDRSxtREFERixDQUROLENBckJKO0FBMEJILEtBaENELE1BZ0NPLElBQUksS0FBS0QsS0FBTCxDQUFXeEIsS0FBZixFQUFzQjtBQUN6QnNCLE1BQUFBLE9BQU8sZ0JBQUc7QUFBSyxRQUFBLFNBQVMsRUFBQztBQUFmLFNBQ0oseUJBQUcsMENBQUgsQ0FESSxDQUFWO0FBR0gsS0FKTSxNQUlBO0FBQ0hBLE1BQUFBLE9BQU8sZ0JBQUcsNkJBQUMsTUFBRCxPQUFWO0FBQ0g7O0FBRUQsd0JBQU87QUFBSyxNQUFBLFNBQVMsRUFBQztBQUFmLG9CQUNILDZCQUFDLGdCQUFEO0FBQWtCLE1BQUEsS0FBSyxFQUFFLHlCQUFHLGFBQUgsQ0FBekI7QUFBNEMsTUFBQSxJQUFJLEVBQUVRLE9BQU8sQ0FBQyxtQ0FBRDtBQUF6RCxNQURHLGVBRUg7QUFBSyxNQUFBLFNBQVMsRUFBQztBQUFmLG9CQUNJO0FBQUssTUFBQSxTQUFTLEVBQUM7QUFBZixvQkFDSSw2QkFBQyx5QkFBRDtBQUFrQixNQUFBLFNBQVMsRUFBQywrQkFBNUI7QUFBNEQsTUFBQSxPQUFPLEVBQUUsS0FBS0M7QUFBMUUsTUFESixlQUVJO0FBQUssTUFBQSxTQUFTLEVBQUM7QUFBZixvQkFDSTtBQUFLLE1BQUEsU0FBUyxFQUFDO0FBQWYsT0FDTSx5QkFBRyx3QkFBSCxDQUROLENBREosRUFJTSx5QkFDRSwyREFDQSx3RUFGRixDQUpOLENBRkosQ0FESixDQUZHLGVBaUNIO0FBQUssTUFBQSxTQUFTLEVBQUM7QUFBZixPQUNNUixhQUROLEVBRU1ELE9BRk4sQ0FqQ0csQ0FBUDtBQXNDSDs7QUFuSGlELEMsd0RBQzdCVSw0QiIsInNvdXJjZXNDb250ZW50IjpbIi8qXG5Db3B5cmlnaHQgMjAxNyBWZWN0b3IgQ3JlYXRpb25zIEx0ZFxuQ29weXJpZ2h0IDIwMTkgTWljaGFlbCBUZWxhdHluc2tpIDw3dDNjaGd1eUBnbWFpbC5jb20+XG5Db3B5cmlnaHQgMjAyMCBUaGUgTWF0cml4Lm9yZyBGb3VuZGF0aW9uIEMuSS5DLlxuXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xueW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG5cbiAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcblxuVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG5TZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG5saW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiovXG5cbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgKiBhcyBzZGsgZnJvbSAnLi4vLi4vaW5kZXgnO1xuaW1wb3J0IHsgX3QgfSBmcm9tICcuLi8uLi9sYW5ndWFnZUhhbmRsZXInO1xuaW1wb3J0IFNka0NvbmZpZyBmcm9tICcuLi8uLi9TZGtDb25maWcnO1xuaW1wb3J0IGRpcyBmcm9tICcuLi8uLi9kaXNwYXRjaGVyL2Rpc3BhdGNoZXInO1xuaW1wb3J0IEFjY2Vzc2libGVCdXR0b24gZnJvbSAnLi4vdmlld3MvZWxlbWVudHMvQWNjZXNzaWJsZUJ1dHRvbic7XG5pbXBvcnQgTWF0cml4Q2xpZW50Q29udGV4dCBmcm9tIFwiLi4vLi4vY29udGV4dHMvTWF0cml4Q2xpZW50Q29udGV4dFwiO1xuaW1wb3J0IEF1dG9IaWRlU2Nyb2xsYmFyIGZyb20gXCIuL0F1dG9IaWRlU2Nyb2xsYmFyXCI7XG5pbXBvcnQgeyByZXBsYWNlYWJsZUNvbXBvbmVudCB9IGZyb20gXCIuLi8uLi91dGlscy9yZXBsYWNlYWJsZUNvbXBvbmVudFwiO1xuXG5AcmVwbGFjZWFibGVDb21wb25lbnQoXCJzdHJ1Y3R1cmVzLk15R3JvdXBzXCIpXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNeUdyb3VwcyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgc3RhdGljIGNvbnRleHRUeXBlID0gTWF0cml4Q2xpZW50Q29udGV4dDtcblxuICAgIHN0YXRlID0ge1xuICAgICAgICBncm91cHM6IG51bGwsXG4gICAgICAgIGVycm9yOiBudWxsLFxuICAgIH07XG5cbiAgICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgICAgdGhpcy5fZmV0Y2goKTtcbiAgICB9XG5cbiAgICBfb25DcmVhdGVHcm91cENsaWNrID0gKCkgPT4ge1xuICAgICAgICBkaXMuZGlzcGF0Y2goeyBhY3Rpb246ICd2aWV3X2NyZWF0ZV9ncm91cCcgfSk7XG4gICAgfTtcblxuICAgIF9mZXRjaCgpIHtcbiAgICAgICAgdGhpcy5jb250ZXh0LmdldEpvaW5lZEdyb3VwcygpLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGdyb3VwczogcmVzdWx0Lmdyb3VwcywgZXJyb3I6IG51bGwgfSk7XG4gICAgICAgIH0sIChlcnIpID0+IHtcbiAgICAgICAgICAgIGlmIChlcnIuZXJyY29kZSA9PT0gJ01fR1VFU1RfQUNDRVNTX0ZPUkJJRERFTicpIHtcbiAgICAgICAgICAgICAgICAvLyBJbmRpY2F0ZSB0aGF0IHRoZSBndWVzdCBpc24ndCBpbiBhbnkgZ3JvdXBzICh3aGljaCBzaG91bGQgYmUgdHJ1ZSlcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgZ3JvdXBzOiBbXSwgZXJyb3I6IG51bGwgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGdyb3VwczogbnVsbCwgZXJyb3I6IGVyciB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBjb25zdCBicmFuZCA9IFNka0NvbmZpZy5nZXQoKS5icmFuZDtcbiAgICAgICAgY29uc3QgTG9hZGVyID0gc2RrLmdldENvbXBvbmVudChcImVsZW1lbnRzLlNwaW5uZXJcIik7XG4gICAgICAgIGNvbnN0IFNpbXBsZVJvb21IZWFkZXIgPSBzZGsuZ2V0Q29tcG9uZW50KCdyb29tcy5TaW1wbGVSb29tSGVhZGVyJyk7XG4gICAgICAgIGNvbnN0IEdyb3VwVGlsZSA9IHNkay5nZXRDb21wb25lbnQoXCJncm91cHMuR3JvdXBUaWxlXCIpO1xuXG4gICAgICAgIGxldCBjb250ZW50O1xuICAgICAgICBsZXQgY29udGVudEhlYWRlcjtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuZ3JvdXBzKSB7XG4gICAgICAgICAgICBjb25zdCBncm91cE5vZGVzID0gW107XG4gICAgICAgICAgICB0aGlzLnN0YXRlLmdyb3Vwcy5mb3JFYWNoKChnKSA9PiB7XG4gICAgICAgICAgICAgICAgZ3JvdXBOb2Rlcy5wdXNoKDxHcm91cFRpbGUga2V5PXtnfSBncm91cElkPXtnfSAvPik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnRlbnRIZWFkZXIgPSBncm91cE5vZGVzLmxlbmd0aCA+IDAgPyA8aDM+eyBfdCgnWW91ciBDb21tdW5pdGllcycpIH08L2gzPiA6IDxkaXYgLz47XG4gICAgICAgICAgICBjb250ZW50ID0gZ3JvdXBOb2Rlcy5sZW5ndGggPiAwID9cbiAgICAgICAgICAgICAgICA8QXV0b0hpZGVTY3JvbGxiYXIgY2xhc3NOYW1lPVwibXhfTXlHcm91cHNfc2Nyb2xsYWJsZVwiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X015R3JvdXBzX21pY3JvY29weVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBfdChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJEaWQgeW91IGtub3c6IHlvdSBjYW4gdXNlIGNvbW11bml0aWVzIHRvIGZpbHRlciB5b3VyICUoYnJhbmQpcyBleHBlcmllbmNlIVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IGJyYW5kIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKSB9XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3A+XG4gICAgICAgICAgICAgICAgICAgICAgICA8cD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IF90KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIllvdSBjYW4gY2xpY2sgb24gYW4gYXZhdGFyIGluIHRoZSBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZmlsdGVyIHBhbmVsIGF0IGFueSB0aW1lIHRvIHNlZSBvbmx5IHRoZSByb29tcyBhbmQgcGVvcGxlIGFzc29jaWF0ZWQgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIndpdGggdGhhdCBjb21tdW5pdHkuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKSB9XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3A+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X015R3JvdXBzX2pvaW5lZEdyb3Vwc1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgeyBncm91cE5vZGVzIH1cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9BdXRvSGlkZVNjcm9sbGJhcj4gOlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfTXlHcm91cHNfcGxhY2Vob2xkZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgeyBfdChcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiWW91J3JlIG5vdCBjdXJyZW50bHkgYSBtZW1iZXIgb2YgYW55IGNvbW11bml0aWVzLlwiLFxuICAgICAgICAgICAgICAgICAgICApIH1cbiAgICAgICAgICAgICAgICA8L2Rpdj47XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0ZS5lcnJvcikge1xuICAgICAgICAgICAgY29udGVudCA9IDxkaXYgY2xhc3NOYW1lPVwibXhfTXlHcm91cHNfZXJyb3JcIj5cbiAgICAgICAgICAgICAgICB7IF90KCdFcnJvciB3aGlsc3QgZmV0Y2hpbmcgam9pbmVkIGNvbW11bml0aWVzJykgfVxuICAgICAgICAgICAgPC9kaXY+O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29udGVudCA9IDxMb2FkZXIgLz47XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJteF9NeUdyb3Vwc1wiPlxuICAgICAgICAgICAgPFNpbXBsZVJvb21IZWFkZXIgdGl0bGU9e190KFwiQ29tbXVuaXRpZXNcIil9IGljb249e3JlcXVpcmUoXCIuLi8uLi8uLi9yZXMvaW1nL2ljb25zLWdyb3Vwcy5zdmdcIil9IC8+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nbXhfTXlHcm91cHNfaGVhZGVyJz5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X015R3JvdXBzX2hlYWRlckNhcmRcIj5cbiAgICAgICAgICAgICAgICAgICAgPEFjY2Vzc2libGVCdXR0b24gY2xhc3NOYW1lPSdteF9NeUdyb3Vwc19oZWFkZXJDYXJkX2J1dHRvbicgb25DbGljaz17dGhpcy5fb25DcmVhdGVHcm91cENsaWNrfSAvPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X015R3JvdXBzX2hlYWRlckNhcmRfY29udGVudFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJteF9NeUdyb3Vwc19oZWFkZXJDYXJkX2hlYWRlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgX3QoJ0NyZWF0ZSBhIG5ldyBjb21tdW5pdHknKSB9XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHsgX3QoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0NyZWF0ZSBhIGNvbW11bml0eSB0byBncm91cCB0b2dldGhlciB1c2VycyBhbmQgcm9vbXMhICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdCdWlsZCBhIGN1c3RvbSBob21lcGFnZSB0byBtYXJrIG91dCB5b3VyIHNwYWNlIGluIHRoZSBNYXRyaXggdW5pdmVyc2UuJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICkgfVxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICB7IC8qPGRpdiBjbGFzc05hbWU9XCJteF9NeUdyb3Vwc19qb2luQm94IG14X015R3JvdXBzX2hlYWRlckNhcmRcIj5cbiAgICAgICAgICAgICAgICAgICAgPEFjY2Vzc2libGVCdXR0b24gY2xhc3NOYW1lPSdteF9NeUdyb3Vwc19oZWFkZXJDYXJkX2J1dHRvbicgb25DbGljaz17dGhpcy5fb25Kb2luR3JvdXBDbGlja30+XG4gICAgICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz17cmVxdWlyZShcIi4uLy4uLy4uL3Jlcy9pbWcvaWNvbnMtY3JlYXRlLXJvb20uc3ZnXCIpfSB3aWR0aD1cIjUwXCIgaGVpZ2h0PVwiNTBcIiAvPlxuICAgICAgICAgICAgICAgICAgICA8L0FjY2Vzc2libGVCdXR0b24+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfTXlHcm91cHNfaGVhZGVyQ2FyZF9jb250ZW50XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X015R3JvdXBzX2hlYWRlckNhcmRfaGVhZGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBfdCgnSm9pbiBhbiBleGlzdGluZyBjb21tdW5pdHknKSB9XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHsgX3QoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1RvIGpvaW4gYW4gZXhpc3RpbmcgY29tbXVuaXR5IHlvdVxcJ2xsIGhhdmUgdG8gJytcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAna25vdyBpdHMgY29tbXVuaXR5IGlkZW50aWZpZXI7IHRoaXMgd2lsbCBsb29rICcrXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3NvbWV0aGluZyBsaWtlIDxpPitleGFtcGxlOm1hdHJpeC5vcmc8L2k+LicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge30sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeyAnaSc6IChzdWIpID0+IDxpPnsgc3ViIH08L2k+IH0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PiovIH1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJteF9NeUdyb3Vwc19jb250ZW50XCI+XG4gICAgICAgICAgICAgICAgeyBjb250ZW50SGVhZGVyIH1cbiAgICAgICAgICAgICAgICB7IGNvbnRlbnQgfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PjtcbiAgICB9XG59XG4iXX0=