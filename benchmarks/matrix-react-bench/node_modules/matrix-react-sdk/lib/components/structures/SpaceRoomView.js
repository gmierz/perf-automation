"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireWildcard(require("react"));

var _event = require("matrix-js-sdk/src/@types/event");

var _partials = require("matrix-js-sdk/src/@types/partials");

var _MatrixClientContext = _interopRequireDefault(require("../../contexts/MatrixClientContext"));

var _RoomAvatar = _interopRequireDefault(require("../views/avatars/RoomAvatar"));

var _languageHandler = require("../../languageHandler");

var _AccessibleButton = _interopRequireDefault(require("../views/elements/AccessibleButton"));

var _RoomName = _interopRequireDefault(require("../views/elements/RoomName"));

var _RoomTopic = _interopRequireDefault(require("../views/elements/RoomTopic"));

var _InlineSpinner = _interopRequireDefault(require("../views/elements/InlineSpinner"));

var _RoomInvite = require("../../RoomInvite");

var _useRoomMembers = require("../../hooks/useRoomMembers");

var _createRoom = _interopRequireDefault(require("../../createRoom"));

var _Field = _interopRequireDefault(require("../views/elements/Field"));

var _useEventEmitter = require("../../hooks/useEventEmitter");

var _Validation = _interopRequireDefault(require("../views/elements/Validation"));

var Email = _interopRequireWildcard(require("../../email"));

var _dispatcher = _interopRequireDefault(require("../../dispatcher/dispatcher"));

var _actions = require("../../dispatcher/actions");

var _MainSplit = _interopRequireDefault(require("./MainSplit"));

var _ErrorBoundary = _interopRequireDefault(require("../views/elements/ErrorBoundary"));

var _RightPanel = _interopRequireDefault(require("./RightPanel"));

var _RightPanelStore = _interopRequireDefault(require("../../stores/RightPanelStore"));

var _RightPanelStorePhases = require("../../stores/RightPanelStorePhases");

var _useStateArray = require("../../hooks/useStateArray");

var _SpacePublicShare = _interopRequireDefault(require("../views/spaces/SpacePublicShare"));

var _space = require("../../utils/space");

var _SpaceHierarchy = _interopRequireWildcard(require("./SpaceHierarchy"));

var _MemberAvatar = _interopRequireDefault(require("../views/avatars/MemberAvatar"));

var _SpaceStore = _interopRequireDefault(require("../../stores/spaces/SpaceStore"));

var _FacePile = _interopRequireDefault(require("../views/elements/FacePile"));

var _AddExistingToSpaceDialog = require("../views/dialogs/AddExistingToSpaceDialog");

var _ContextMenu = require("./ContextMenu");

var _IconizedContextMenu = _interopRequireWildcard(require("../views/context_menus/IconizedContextMenu"));

var _AccessibleTooltipButton = _interopRequireDefault(require("../views/elements/AccessibleTooltipButton"));

var _BetaCard = require("../views/beta/BetaCard");

var _UserSettingsDialog = require("../views/dialogs/UserSettingsDialog");

var _membership = require("../../utils/membership");

var _SpaceCreateMenu = require("../views/spaces/SpaceCreateMenu");

var _CreateSpaceFromCommunityDialog = require("../views/dialogs/CreateSpaceFromCommunityDialog");

var _useAsyncMemo = require("../../hooks/useAsyncMemo");

var _Spinner = _interopRequireDefault(require("../views/elements/Spinner"));

var _GroupAvatar = _interopRequireDefault(require("../views/avatars/GroupAvatar"));

var _useDispatcher = require("../../hooks/useDispatcher");

var _useRoomState = require("../../hooks/useRoomState");

var _logger = require("matrix-js-sdk/src/logger");

var _UIComponents = require("../../customisations/helpers/UIComponents");

var _UIFeature = require("../../settings/UIFeature");

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

/*
Copyright 2021 The Matrix.org Foundation C.I.C.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
var Phase;

(function (Phase) {
  Phase[Phase["Landing"] = 0] = "Landing";
  Phase[Phase["PublicCreateRooms"] = 1] = "PublicCreateRooms";
  Phase[Phase["PublicShare"] = 2] = "PublicShare";
  Phase[Phase["PrivateScope"] = 3] = "PrivateScope";
  Phase[Phase["PrivateInvite"] = 4] = "PrivateInvite";
  Phase[Phase["PrivateCreateRooms"] = 5] = "PrivateCreateRooms";
  Phase[Phase["PrivateExistingRooms"] = 6] = "PrivateExistingRooms";
})(Phase || (Phase = {}));

const RoomMemberCount = ({
  room,
  children
}) => {
  const members = (0, _useRoomMembers.useRoomMembers)(room);
  const count = members.length;
  if (children) return children(count);
  return count;
};

const useMyRoomMembership = room => {
  const [membership, setMembership] = (0, _react.useState)(room.getMyMembership());
  (0, _useEventEmitter.useEventEmitter)(room, "Room.myMembership", () => {
    setMembership(room.getMyMembership());
  });
  return membership;
};

const SpaceInfo = ({
  space
}) => {
  // summary will begin as undefined whilst loading and go null if it fails to load.
  const summary = (0, _useAsyncMemo.useAsyncMemo)(async () => {
    if (space.getMyMembership() !== "invite") return;

    try {
      return space.client.getRoomSummary(space.roomId);
    } catch (e) {
      return null;
    }
  }, [space]);
  const joinRule = (0, _useRoomState.useRoomState)(space, state => state.getJoinRule());
  const membership = useMyRoomMembership(space);
  let visibilitySection;

  if (joinRule === "public") {
    visibilitySection = /*#__PURE__*/_react.default.createElement("span", {
      className: "mx_SpaceRoomView_info_public"
    }, (0, _languageHandler._t)("Public space"));
  } else {
    visibilitySection = /*#__PURE__*/_react.default.createElement("span", {
      className: "mx_SpaceRoomView_info_private"
    }, (0, _languageHandler._t)("Private space"));
  }

  let memberSection;

  if (membership === "invite" && summary) {
    // Don't trust local state and instead use the summary API
    memberSection = /*#__PURE__*/_react.default.createElement("span", {
      className: "mx_SpaceRoomView_info_memberCount"
    }, (0, _languageHandler._t)("%(count)s members", {
      count: summary.num_joined_members
    }));
  } else if (summary !== undefined) {
    // summary is not still loading
    memberSection = /*#__PURE__*/_react.default.createElement(RoomMemberCount, {
      room: space
    }, count => count > 0 ? /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
      kind: "link",
      className: "mx_SpaceRoomView_info_memberCount",
      onClick: () => {
        _dispatcher.default.dispatch({
          action: _actions.Action.SetRightPanelPhase,
          phase: _RightPanelStorePhases.RightPanelPhases.RoomMemberList,
          refireParams: {
            space
          }
        });
      }
    }, (0, _languageHandler._t)("%(count)s members", {
      count
    })) : null);
  }

  return /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SpaceRoomView_info"
  }, visibilitySection, memberSection);
};

const onPreferencesClick = () => {
  _dispatcher.default.dispatch({
    action: _actions.Action.ViewUserSettings,
    initialTabId: _UserSettingsDialog.UserTab.Preferences
  });
}; // XXX: temporary community migration component


const GroupTile = ({
  groupId
}) => {
  const cli = (0, _react.useContext)(_MatrixClientContext.default);
  const groupSummary = (0, _useAsyncMemo.useAsyncMemo)(() => cli.getGroupSummary(groupId), [cli, groupId]);
  if (!groupSummary) return /*#__PURE__*/_react.default.createElement(_Spinner.default, null);
  return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement(_GroupAvatar.default, {
    groupId: groupId,
    groupName: groupSummary.profile.name,
    groupAvatarUrl: groupSummary.profile.avatar_url,
    width: 16,
    height: 16,
    resizeMethod: "crop"
  }), groupSummary.profile.name);
};

const SpacePreview = ({
  space,
  onJoinButtonClicked,
  onRejectButtonClicked
}) => {
  var _space$currentState$g;

  const cli = (0, _react.useContext)(_MatrixClientContext.default);
  const myMembership = useMyRoomMembership(space);
  (0, _useDispatcher.useDispatcher)(_dispatcher.default, payload => {
    if (payload.action === _actions.Action.JoinRoomError && payload.roomId === space.roomId) {
      setBusy(false); // stop the spinner, join failed
    }
  });
  const [busy, setBusy] = (0, _react.useState)(false);
  const spacesEnabled = _SpaceStore.default.spacesEnabled;
  const joinRule = (0, _useRoomState.useRoomState)(space, state => state.getJoinRule());

  const cannotJoin = (0, _membership.getEffectiveMembership)(myMembership) === _membership.EffectiveMembership.Leave && joinRule !== _partials.JoinRule.Public;

  let inviterSection;
  let joinButtons;

  if (myMembership === "join") {
    // XXX remove this when spaces leaves Beta
    joinButtons = /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
      kind: "danger_outline",
      onClick: () => {
        _dispatcher.default.dispatch({
          action: "leave_room",
          room_id: space.roomId
        });
      }
    }, (0, _languageHandler._t)("Leave"));
  } else if (myMembership === "invite") {
    var _space$getMember, _space$getMember$even;

    const inviteSender = (_space$getMember = space.getMember(cli.getUserId())) === null || _space$getMember === void 0 ? void 0 : (_space$getMember$even = _space$getMember.events.member) === null || _space$getMember$even === void 0 ? void 0 : _space$getMember$even.getSender();
    const inviter = inviteSender && space.getMember(inviteSender);

    if (inviteSender) {
      inviterSection = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_SpaceRoomView_preview_inviter"
      }, /*#__PURE__*/_react.default.createElement(_MemberAvatar.default, {
        member: inviter,
        fallbackUserId: inviteSender,
        width: 32,
        height: 32
      }), /*#__PURE__*/_react.default.createElement("div", null, /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_SpaceRoomView_preview_inviter_name"
      }, (0, _languageHandler._t)("<inviter/> invites you", {}, {
        inviter: () => /*#__PURE__*/_react.default.createElement("b", null, (inviter === null || inviter === void 0 ? void 0 : inviter.name) || inviteSender)
      })), inviter ? /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_SpaceRoomView_preview_inviter_mxid"
      }, inviteSender) : null));
    }

    joinButtons = /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
      kind: "secondary",
      onClick: () => {
        setBusy(true);
        onRejectButtonClicked();
      }
    }, (0, _languageHandler._t)("Reject")), /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
      kind: "primary",
      onClick: () => {
        setBusy(true);
        onJoinButtonClicked();
      },
      disabled: !spacesEnabled
    }, (0, _languageHandler._t)("Accept")));
  } else {
    joinButtons = /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
      kind: "primary",
      onClick: () => {
        onJoinButtonClicked();

        if (!cli.isGuest()) {
          // user will be shown a modal that won't fire a room join error
          setBusy(true);
        }
      },
      disabled: !spacesEnabled || cannotJoin
    }, (0, _languageHandler._t)("Join"));
  }

  if (busy) {
    joinButtons = /*#__PURE__*/_react.default.createElement(_InlineSpinner.default, null);
  }

  let footer;

  if (!spacesEnabled) {
    footer = /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_SpaceRoomView_preview_spaceBetaPrompt"
    }, myMembership === "join" ? (0, _languageHandler._t)("To view this Space, hide communities in your <a>preferences</a>", {}, {
      a: sub => /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
        onClick: onPreferencesClick,
        kind: "link"
      }, sub)
    }) : (0, _languageHandler._t)("To join this Space, hide communities in your <a>preferences</a>", {}, {
      a: sub => /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
        onClick: onPreferencesClick,
        kind: "link"
      }, sub)
    }));
  } else if (cannotJoin) {
    footer = /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_SpaceRoomView_preview_spaceBetaPrompt"
    }, (0, _languageHandler._t)("To view %(spaceName)s, you need an invite", {
      spaceName: space.name
    }));
  }

  let migratedCommunitySection;
  const createContent = (_space$currentState$g = space.currentState.getStateEvents(_event.EventType.RoomCreate, "")) === null || _space$currentState$g === void 0 ? void 0 : _space$currentState$g.getContent();

  if (createContent[_CreateSpaceFromCommunityDialog.CreateEventField]) {
    migratedCommunitySection = /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_SpaceRoomView_preview_migratedCommunity"
    }, (0, _languageHandler._t)("Created from <Community />", {}, {
      Community: () => /*#__PURE__*/_react.default.createElement(GroupTile, {
        groupId: createContent[_CreateSpaceFromCommunityDialog.CreateEventField]
      })
    }));
  }

  return /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SpaceRoomView_preview"
  }, migratedCommunitySection, inviterSection, /*#__PURE__*/_react.default.createElement(_RoomAvatar.default, {
    room: space,
    height: 80,
    width: 80,
    viewAvatarOnClick: true
  }), /*#__PURE__*/_react.default.createElement("h1", {
    className: "mx_SpaceRoomView_preview_name"
  }, /*#__PURE__*/_react.default.createElement(_RoomName.default, {
    room: space
  })), /*#__PURE__*/_react.default.createElement(SpaceInfo, {
    space: space
  }), /*#__PURE__*/_react.default.createElement(_RoomTopic.default, {
    room: space
  }, (topic, ref) => /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SpaceRoomView_preview_topic",
    ref: ref
  }, topic)), space.getJoinRule() === "public" && /*#__PURE__*/_react.default.createElement(_FacePile.default, {
    room: space
  }), /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SpaceRoomView_preview_joinButtons"
  }, joinButtons), footer);
};

const SpaceLandingAddButton = ({
  space
}) => {
  const [menuDisplayed, handle, openMenu, closeMenu] = (0, _ContextMenu.useContextMenu)();
  let contextMenu;

  if (menuDisplayed) {
    const rect = handle.current.getBoundingClientRect();
    contextMenu = /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.default, {
      left: rect.left + window.pageXOffset + 0,
      top: rect.bottom + window.pageYOffset + 8,
      chevronFace: _ContextMenu.ChevronFace.None,
      onFinished: closeMenu,
      className: "mx_RoomTile_contextMenu",
      compact: true
    }, /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOptionList, {
      first: true
    }, /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
      label: (0, _languageHandler._t)("Create new room"),
      iconClassName: "mx_RoomList_iconPlus",
      onClick: async e => {
        e.preventDefault();
        e.stopPropagation();
        closeMenu();

        if (await (0, _space.showCreateNewRoom)(space)) {
          _dispatcher.default.fire(_actions.Action.UpdateSpaceHierarchy);
        }
      }
    }), /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
      label: (0, _languageHandler._t)("Add existing room"),
      iconClassName: "mx_RoomList_iconHash",
      onClick: e => {
        e.preventDefault();
        e.stopPropagation();
        closeMenu();
        (0, _space.showAddExistingRooms)(space);
      }
    }), /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
      label: (0, _languageHandler._t)("Add space"),
      iconClassName: "mx_RoomList_iconPlus",
      onClick: e => {
        e.preventDefault();
        e.stopPropagation();
        closeMenu();
        (0, _space.showCreateNewSubspace)(space);
      }
    }, /*#__PURE__*/_react.default.createElement(_BetaCard.BetaPill, null))));
  }

  return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement(_ContextMenu.ContextMenuButton, {
    kind: "primary",
    inputRef: handle,
    onClick: openMenu,
    isExpanded: menuDisplayed,
    label: (0, _languageHandler._t)("Add")
  }, (0, _languageHandler._t)("Add")), contextMenu);
};

const SpaceLanding = ({
  space
}) => {
  const cli = (0, _react.useContext)(_MatrixClientContext.default);
  const myMembership = useMyRoomMembership(space);
  const userId = cli.getUserId();
  let inviteButton;

  if ((myMembership === "join" && space.canInvite(userId) || space.getJoinRule() === _partials.JoinRule.Public) && (0, _UIComponents.shouldShowComponent)(_UIFeature.UIComponent.InviteUsers)) {
    inviteButton = /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
      kind: "primary",
      className: "mx_SpaceRoomView_landing_inviteButton",
      onClick: () => {
        (0, _space.showSpaceInvite)(space);
      }
    }, (0, _languageHandler._t)("Invite"));
  }

  const canAddRooms = myMembership === "join" && space.currentState.maySendStateEvent(_event.EventType.SpaceChild, userId);
  let addRoomButton;

  if (canAddRooms) {
    addRoomButton = /*#__PURE__*/_react.default.createElement(SpaceLandingAddButton, {
      space: space
    });
  }

  let settingsButton;

  if ((0, _space.shouldShowSpaceSettings)(space)) {
    settingsButton = /*#__PURE__*/_react.default.createElement(_AccessibleTooltipButton.default, {
      className: "mx_SpaceRoomView_landing_settingsButton",
      onClick: () => {
        (0, _space.showSpaceSettings)(space);
      },
      title: (0, _languageHandler._t)("Settings")
    });
  }

  const onMembersClick = () => {
    _dispatcher.default.dispatch({
      action: _actions.Action.SetRightPanelPhase,
      phase: _RightPanelStorePhases.RightPanelPhases.RoomMemberList,
      refireParams: {
        space
      }
    });
  };

  return /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SpaceRoomView_landing"
  }, /*#__PURE__*/_react.default.createElement(_SpaceCreateMenu.SpaceFeedbackPrompt, null), /*#__PURE__*/_react.default.createElement(_RoomAvatar.default, {
    room: space,
    height: 80,
    width: 80,
    viewAvatarOnClick: true
  }), /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SpaceRoomView_landing_name"
  }, /*#__PURE__*/_react.default.createElement(_RoomName.default, {
    room: space
  }, name => {
    const tags = {
      name: () => /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_SpaceRoomView_landing_nameRow"
      }, /*#__PURE__*/_react.default.createElement("h1", null, name))
    };
    return (0, _languageHandler._t)("Welcome to <name/>", {}, tags);
  })), /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SpaceRoomView_landing_info"
  }, /*#__PURE__*/_react.default.createElement(SpaceInfo, {
    space: space
  }), /*#__PURE__*/_react.default.createElement(_FacePile.default, {
    room: space,
    onlyKnownUsers: false,
    numShown: 7,
    onClick: onMembersClick
  }), inviteButton, settingsButton), /*#__PURE__*/_react.default.createElement(_RoomTopic.default, {
    room: space
  }, (topic, ref) => /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SpaceRoomView_landing_topic",
    ref: ref
  }, topic)), /*#__PURE__*/_react.default.createElement(_SpaceHierarchy.default, {
    space: space,
    showRoom: _SpaceHierarchy.showRoom,
    additionalButtons: addRoomButton
  }));
};

const SpaceSetupFirstRooms = ({
  space,
  title,
  description,
  onFinished
}) => {
  const [busy, setBusy] = (0, _react.useState)(false);
  const [error, setError] = (0, _react.useState)("");
  const numFields = 3;
  const placeholders = [(0, _languageHandler._t)("General"), (0, _languageHandler._t)("Random"), (0, _languageHandler._t)("Support")];
  const [roomNames, setRoomName] = (0, _useStateArray.useStateArray)(numFields, [(0, _languageHandler._t)("General"), (0, _languageHandler._t)("Random"), ""]);
  const fields = new Array(numFields).fill(0).map((x, i) => {
    const name = "roomName" + i;
    return /*#__PURE__*/_react.default.createElement(_Field.default, {
      key: name,
      name: name,
      type: "text",
      label: (0, _languageHandler._t)("Room name"),
      placeholder: placeholders[i],
      value: roomNames[i],
      onChange: ev => setRoomName(i, ev.target.value),
      autoFocus: i === 2,
      disabled: busy,
      autoComplete: "off"
    });
  });

  const onNextClick = async ev => {
    ev.preventDefault();
    if (busy) return;
    setError("");
    setBusy(true);

    try {
      const isPublic = space.getJoinRule() === _partials.JoinRule.Public;

      const filteredRoomNames = roomNames.map(name => name.trim()).filter(Boolean);
      const roomIds = await Promise.all(filteredRoomNames.map(name => {
        return (0, _createRoom.default)({
          createOpts: {
            preset: isPublic ? _partials.Preset.PublicChat : _partials.Preset.PrivateChat,
            name
          },
          spinner: false,
          encryption: false,
          andView: false,
          inlineErrors: true,
          parentSpace: space,
          joinRule: !isPublic ? _partials.JoinRule.Restricted : undefined,
          suggested: true
        });
      }));
      onFinished(roomIds[0]);
    } catch (e) {
      _logger.logger.error("Failed to create initial space rooms", e);

      setError((0, _languageHandler._t)("Failed to create initial space rooms"));
    }

    setBusy(false);
  };

  let onClick = ev => {
    ev.preventDefault();
    onFinished();
  };

  let buttonLabel = (0, _languageHandler._t)("Skip for now");

  if (roomNames.some(name => name.trim())) {
    onClick = onNextClick;
    buttonLabel = busy ? (0, _languageHandler._t)("Creating rooms...") : (0, _languageHandler._t)("Continue");
  }

  return /*#__PURE__*/_react.default.createElement("div", null, /*#__PURE__*/_react.default.createElement("h1", null, title), /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SpaceRoomView_description"
  }, description), error && /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SpaceRoomView_errorText"
  }, error), /*#__PURE__*/_react.default.createElement("form", {
    onSubmit: onClick,
    id: "mx_SpaceSetupFirstRooms"
  }, fields), /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SpaceRoomView_buttons"
  }, /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
    kind: "primary",
    disabled: busy,
    onClick: onClick,
    element: "input",
    type: "submit",
    form: "mx_SpaceSetupFirstRooms",
    value: buttonLabel
  })));
};

const SpaceAddExistingRooms = ({
  space,
  onFinished
}) => {
  return /*#__PURE__*/_react.default.createElement("div", null, /*#__PURE__*/_react.default.createElement("h1", null, (0, _languageHandler._t)("What do you want to organise?")), /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SpaceRoomView_description"
  }, (0, _languageHandler._t)("Pick rooms or conversations to add. This is just a space for you, " + "no one will be informed. You can add more later.")), /*#__PURE__*/_react.default.createElement(_AddExistingToSpaceDialog.AddExistingToSpace, {
    space: space,
    emptySelectionButton: /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
      kind: "primary",
      onClick: onFinished
    }, (0, _languageHandler._t)("Skip for now")),
    filterPlaceholder: (0, _languageHandler._t)("Search for rooms or spaces"),
    onFinished: onFinished,
    roomsRenderer: _AddExistingToSpaceDialog.defaultRoomsRenderer,
    spacesRenderer: _AddExistingToSpaceDialog.defaultSpacesRenderer,
    dmsRenderer: _AddExistingToSpaceDialog.defaultDmsRenderer
  }));
};

const SpaceSetupPublicShare = ({
  justCreatedOpts,
  space,
  onFinished,
  firstRoomId
}) => {
  var _justCreatedOpts$crea;

  return /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SpaceRoomView_publicShare"
  }, /*#__PURE__*/_react.default.createElement("h1", null, (0, _languageHandler._t)("Share %(name)s", {
    name: (justCreatedOpts === null || justCreatedOpts === void 0 ? void 0 : (_justCreatedOpts$crea = justCreatedOpts.createOpts) === null || _justCreatedOpts$crea === void 0 ? void 0 : _justCreatedOpts$crea.name) || space.name
  })), /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SpaceRoomView_description"
  }, (0, _languageHandler._t)("It's just you at the moment, it will be even better with others.")), /*#__PURE__*/_react.default.createElement(_SpacePublicShare.default, {
    space: space
  }), /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SpaceRoomView_buttons"
  }, /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
    kind: "primary",
    onClick: onFinished
  }, firstRoomId ? (0, _languageHandler._t)("Go to my first room") : (0, _languageHandler._t)("Go to my space"))));
};

const SpaceSetupPrivateScope = ({
  space,
  justCreatedOpts,
  onFinished
}) => {
  var _justCreatedOpts$crea2;

  return /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SpaceRoomView_privateScope"
  }, /*#__PURE__*/_react.default.createElement("h1", null, (0, _languageHandler._t)("Who are you working with?")), /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SpaceRoomView_description"
  }, (0, _languageHandler._t)("Make sure the right people have access to %(name)s", {
    name: (justCreatedOpts === null || justCreatedOpts === void 0 ? void 0 : (_justCreatedOpts$crea2 = justCreatedOpts.createOpts) === null || _justCreatedOpts$crea2 === void 0 ? void 0 : _justCreatedOpts$crea2.name) || space.name
  })), /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
    className: "mx_SpaceRoomView_privateScope_justMeButton",
    onClick: () => {
      onFinished(false);
    }
  }, /*#__PURE__*/_react.default.createElement("h3", null, (0, _languageHandler._t)("Just me")), /*#__PURE__*/_react.default.createElement("div", null, (0, _languageHandler._t)("A private space to organise your rooms"))), /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
    className: "mx_SpaceRoomView_privateScope_meAndMyTeammatesButton",
    onClick: () => {
      onFinished(true);
    }
  }, /*#__PURE__*/_react.default.createElement("h3", null, (0, _languageHandler._t)("Me and my teammates")), /*#__PURE__*/_react.default.createElement("div", null, (0, _languageHandler._t)("A private space for you and your teammates"))));
};

const validateEmailRules = (0, _Validation.default)({
  rules: [{
    key: "email",
    test: ({
      value
    }) => !value || Email.looksValid(value),
    invalid: () => (0, _languageHandler._t)("Doesn't look like a valid email address")
  }]
});

const SpaceSetupPrivateInvite = ({
  space,
  onFinished
}) => {
  const [busy, setBusy] = (0, _react.useState)(false);
  const [error, setError] = (0, _react.useState)("");
  const numFields = 3;
  const fieldRefs = [(0, _react.useRef)(), (0, _react.useRef)(), (0, _react.useRef)()];
  const [emailAddresses, setEmailAddress] = (0, _useStateArray.useStateArray)(numFields, "");
  const fields = new Array(numFields).fill(0).map((x, i) => {
    const name = "emailAddress" + i;
    return /*#__PURE__*/_react.default.createElement(_Field.default, {
      key: name,
      name: name,
      type: "text",
      label: (0, _languageHandler._t)("Email address"),
      placeholder: (0, _languageHandler._t)("Email"),
      value: emailAddresses[i],
      onChange: ev => setEmailAddress(i, ev.target.value),
      ref: fieldRefs[i],
      onValidate: validateEmailRules,
      autoFocus: i === 0,
      disabled: busy
    });
  });

  const onNextClick = async ev => {
    ev.preventDefault();
    if (busy) return;
    setError("");

    for (let i = 0; i < fieldRefs.length; i++) {
      const fieldRef = fieldRefs[i];
      const valid = await fieldRef.current.validate({
        allowEmpty: true
      });

      if (valid === false) {
        // true/null are allowed
        fieldRef.current.focus();
        fieldRef.current.validate({
          allowEmpty: true,
          focused: true
        });
        return;
      }
    }

    setBusy(true);
    const targetIds = emailAddresses.map(name => name.trim()).filter(Boolean);

    try {
      const result = await (0, _RoomInvite.inviteMultipleToRoom)(space.roomId, targetIds);
      const failedUsers = Object.keys(result.states).filter(a => result.states[a] === "error");

      if (failedUsers.length > 0) {
        _logger.logger.log("Failed to invite users to space: ", result);

        setError((0, _languageHandler._t)("Failed to invite the following users to your space: %(csvUsers)s", {
          csvUsers: failedUsers.join(", ")
        }));
      } else {
        onFinished();
      }
    } catch (err) {
      _logger.logger.error("Failed to invite users to space: ", err);

      setError((0, _languageHandler._t)("We couldn't invite those users. Please check the users you want to invite and try again."));
    }

    setBusy(false);
  };

  let onClick = ev => {
    ev.preventDefault();
    onFinished();
  };

  let buttonLabel = (0, _languageHandler._t)("Skip for now");

  if (emailAddresses.some(name => name.trim())) {
    onClick = onNextClick;
    buttonLabel = busy ? (0, _languageHandler._t)("Inviting...") : (0, _languageHandler._t)("Continue");
  }

  return /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SpaceRoomView_inviteTeammates"
  }, /*#__PURE__*/_react.default.createElement("h1", null, (0, _languageHandler._t)("Invite your teammates")), /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SpaceRoomView_description"
  }, (0, _languageHandler._t)("Make sure the right people have access. You can invite more later.")), /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SpaceRoomView_inviteTeammates_betaDisclaimer"
  }, (0, _languageHandler._t)("<b>This is an experimental feature.</b> For now, " + "new users receiving an invite will have to open the invite on <link/> to actually join.", {}, {
    b: sub => /*#__PURE__*/_react.default.createElement("b", null, sub),
    link: () => /*#__PURE__*/_react.default.createElement("a", {
      href: "https://app.element.io/",
      rel: "noreferrer noopener",
      target: "_blank"
    }, "app.element.io")
  })), error && /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SpaceRoomView_errorText"
  }, error), /*#__PURE__*/_react.default.createElement("form", {
    onSubmit: onClick,
    id: "mx_SpaceSetupPrivateInvite"
  }, fields), /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SpaceRoomView_inviteTeammates_buttons"
  }, /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
    className: "mx_SpaceRoomView_inviteTeammates_inviteDialogButton",
    onClick: () => (0, _RoomInvite.showRoomInviteDialog)(space.roomId)
  }, (0, _languageHandler._t)("Invite by username"))), /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SpaceRoomView_buttons"
  }, /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
    kind: "primary",
    disabled: busy,
    onClick: onClick,
    element: "input",
    type: "submit",
    form: "mx_SpaceSetupPrivateInvite",
    value: buttonLabel
  })));
};

class SpaceRoomView extends _react.default.PureComponent {
  constructor(props, context) {
    var _this$props$space$cur;

    super(props, context);
    (0, _defineProperty2.default)(this, "creator", void 0);
    (0, _defineProperty2.default)(this, "dispatcherRef", void 0);
    (0, _defineProperty2.default)(this, "rightPanelStoreToken", void 0);
    (0, _defineProperty2.default)(this, "onMyMembership", (room, myMembership) => {
      if (room.roomId === this.props.space.roomId) {
        this.setState({
          myMembership
        });
      }
    });
    (0, _defineProperty2.default)(this, "onRightPanelStoreUpdate", () => {
      this.setState({
        showRightPanel: _RightPanelStore.default.getSharedInstance().isOpenForRoom
      });
    });
    (0, _defineProperty2.default)(this, "onAction", payload => {
      if (payload.action === "view_room" && payload.room_id === this.props.space.roomId) {
        this.setState({
          phase: Phase.Landing
        });
        return;
      }

      if (payload.action !== _actions.Action.ViewUser && payload.action !== "view_3pid_invite") return;

      if (payload.action === _actions.Action.ViewUser && payload.member) {
        _dispatcher.default.dispatch({
          action: _actions.Action.SetRightPanelPhase,
          phase: _RightPanelStorePhases.RightPanelPhases.SpaceMemberInfo,
          refireParams: {
            space: this.props.space,
            member: payload.member
          }
        });
      } else if (payload.action === "view_3pid_invite" && payload.event) {
        _dispatcher.default.dispatch({
          action: _actions.Action.SetRightPanelPhase,
          phase: _RightPanelStorePhases.RightPanelPhases.Space3pidMemberInfo,
          refireParams: {
            space: this.props.space,
            event: payload.event
          }
        });
      } else {
        _dispatcher.default.dispatch({
          action: _actions.Action.SetRightPanelPhase,
          phase: _RightPanelStorePhases.RightPanelPhases.SpaceMemberList,
          refireParams: {
            space: this.props.space
          }
        });
      }
    });
    (0, _defineProperty2.default)(this, "goToFirstRoom", async () => {
      if (this.state.firstRoomId) {
        _dispatcher.default.dispatch({
          action: "view_room",
          room_id: this.state.firstRoomId
        });

        return;
      }

      this.setState({
        phase: Phase.Landing
      });
    });
    let phase = Phase.Landing;
    this.creator = (_this$props$space$cur = this.props.space.currentState.getStateEvents(_event.EventType.RoomCreate, "")) === null || _this$props$space$cur === void 0 ? void 0 : _this$props$space$cur.getSender();
    const showSetup = this.props.justCreatedOpts && this.context.getUserId() === this.creator;

    if (showSetup) {
      phase = this.props.justCreatedOpts.createOpts.preset === _partials.Preset.PublicChat ? Phase.PublicCreateRooms : Phase.PrivateScope;
    }

    this.state = {
      phase,
      showRightPanel: _RightPanelStore.default.getSharedInstance().isOpenForRoom,
      myMembership: this.props.space.getMyMembership()
    };
    this.dispatcherRef = _dispatcher.default.register(this.onAction);
    this.rightPanelStoreToken = _RightPanelStore.default.getSharedInstance().addListener(this.onRightPanelStoreUpdate);
    this.context.on("Room.myMembership", this.onMyMembership);
  }

  componentWillUnmount() {
    _dispatcher.default.unregister(this.dispatcherRef);

    this.rightPanelStoreToken.remove();
    this.context.off("Room.myMembership", this.onMyMembership);
  }

  renderBody() {
    var _this$props$justCreat, _this$props$justCreat2;

    switch (this.state.phase) {
      case Phase.Landing:
        if (this.state.myMembership === "join" && _SpaceStore.default.spacesEnabled) {
          return /*#__PURE__*/_react.default.createElement(SpaceLanding, {
            space: this.props.space
          });
        } else {
          return /*#__PURE__*/_react.default.createElement(SpacePreview, {
            space: this.props.space,
            onJoinButtonClicked: this.props.onJoinButtonClicked,
            onRejectButtonClicked: this.props.onRejectButtonClicked
          });
        }

      case Phase.PublicCreateRooms:
        return /*#__PURE__*/_react.default.createElement(SpaceSetupFirstRooms, {
          space: this.props.space,
          title: (0, _languageHandler._t)("What are some things you want to discuss in %(spaceName)s?", {
            spaceName: ((_this$props$justCreat = this.props.justCreatedOpts) === null || _this$props$justCreat === void 0 ? void 0 : (_this$props$justCreat2 = _this$props$justCreat.createOpts) === null || _this$props$justCreat2 === void 0 ? void 0 : _this$props$justCreat2.name) || this.props.space.name
          }),
          description: (0, _languageHandler._t)("Let's create a room for each of them.") + "\n" + (0, _languageHandler._t)("You can add more later too, including already existing ones."),
          onFinished: firstRoomId => this.setState({
            phase: Phase.PublicShare,
            firstRoomId
          })
        });

      case Phase.PublicShare:
        return /*#__PURE__*/_react.default.createElement(SpaceSetupPublicShare, {
          justCreatedOpts: this.props.justCreatedOpts,
          space: this.props.space,
          onFinished: this.goToFirstRoom,
          firstRoomId: this.state.firstRoomId
        });

      case Phase.PrivateScope:
        return /*#__PURE__*/_react.default.createElement(SpaceSetupPrivateScope, {
          space: this.props.space,
          justCreatedOpts: this.props.justCreatedOpts,
          onFinished: invite => {
            this.setState({
              phase: invite ? Phase.PrivateCreateRooms : Phase.PrivateExistingRooms
            });
          }
        });

      case Phase.PrivateInvite:
        return /*#__PURE__*/_react.default.createElement(SpaceSetupPrivateInvite, {
          space: this.props.space,
          onFinished: () => this.setState({
            phase: Phase.Landing
          })
        });

      case Phase.PrivateCreateRooms:
        return /*#__PURE__*/_react.default.createElement(SpaceSetupFirstRooms, {
          space: this.props.space,
          title: (0, _languageHandler._t)("What projects are your team working on?"),
          description: (0, _languageHandler._t)("We'll create rooms for each of them. " + "You can add more later too, including already existing ones."),
          onFinished: firstRoomId => this.setState({
            phase: Phase.PrivateInvite,
            firstRoomId
          })
        });

      case Phase.PrivateExistingRooms:
        return /*#__PURE__*/_react.default.createElement(SpaceAddExistingRooms, {
          space: this.props.space,
          onFinished: () => this.setState({
            phase: Phase.Landing
          })
        });
    }
  }

  render() {
    const rightPanel = this.state.showRightPanel && this.state.phase === Phase.Landing ? /*#__PURE__*/_react.default.createElement(_RightPanel.default, {
      room: this.props.space,
      resizeNotifier: this.props.resizeNotifier
    }) : null;
    return /*#__PURE__*/_react.default.createElement("main", {
      className: "mx_SpaceRoomView"
    }, /*#__PURE__*/_react.default.createElement(_ErrorBoundary.default, null, /*#__PURE__*/_react.default.createElement(_MainSplit.default, {
      panel: rightPanel,
      resizeNotifier: this.props.resizeNotifier
    }, this.renderBody())));
  }

}

exports.default = SpaceRoomView;
(0, _defineProperty2.default)(SpaceRoomView, "contextType", _MatrixClientContext.default);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3N0cnVjdHVyZXMvU3BhY2VSb29tVmlldy50c3giXSwibmFtZXMiOlsiUGhhc2UiLCJSb29tTWVtYmVyQ291bnQiLCJyb29tIiwiY2hpbGRyZW4iLCJtZW1iZXJzIiwiY291bnQiLCJsZW5ndGgiLCJ1c2VNeVJvb21NZW1iZXJzaGlwIiwibWVtYmVyc2hpcCIsInNldE1lbWJlcnNoaXAiLCJnZXRNeU1lbWJlcnNoaXAiLCJTcGFjZUluZm8iLCJzcGFjZSIsInN1bW1hcnkiLCJjbGllbnQiLCJnZXRSb29tU3VtbWFyeSIsInJvb21JZCIsImUiLCJqb2luUnVsZSIsInN0YXRlIiwiZ2V0Sm9pblJ1bGUiLCJ2aXNpYmlsaXR5U2VjdGlvbiIsIm1lbWJlclNlY3Rpb24iLCJudW1fam9pbmVkX21lbWJlcnMiLCJ1bmRlZmluZWQiLCJkZWZhdWx0RGlzcGF0Y2hlciIsImRpc3BhdGNoIiwiYWN0aW9uIiwiQWN0aW9uIiwiU2V0UmlnaHRQYW5lbFBoYXNlIiwicGhhc2UiLCJSaWdodFBhbmVsUGhhc2VzIiwiUm9vbU1lbWJlckxpc3QiLCJyZWZpcmVQYXJhbXMiLCJvblByZWZlcmVuY2VzQ2xpY2siLCJWaWV3VXNlclNldHRpbmdzIiwiaW5pdGlhbFRhYklkIiwiVXNlclRhYiIsIlByZWZlcmVuY2VzIiwiR3JvdXBUaWxlIiwiZ3JvdXBJZCIsImNsaSIsIk1hdHJpeENsaWVudENvbnRleHQiLCJncm91cFN1bW1hcnkiLCJnZXRHcm91cFN1bW1hcnkiLCJwcm9maWxlIiwibmFtZSIsImF2YXRhcl91cmwiLCJTcGFjZVByZXZpZXciLCJvbkpvaW5CdXR0b25DbGlja2VkIiwib25SZWplY3RCdXR0b25DbGlja2VkIiwibXlNZW1iZXJzaGlwIiwicGF5bG9hZCIsIkpvaW5Sb29tRXJyb3IiLCJzZXRCdXN5IiwiYnVzeSIsInNwYWNlc0VuYWJsZWQiLCJTcGFjZVN0b3JlIiwiY2Fubm90Sm9pbiIsIkVmZmVjdGl2ZU1lbWJlcnNoaXAiLCJMZWF2ZSIsIkpvaW5SdWxlIiwiUHVibGljIiwiaW52aXRlclNlY3Rpb24iLCJqb2luQnV0dG9ucyIsImRpcyIsInJvb21faWQiLCJpbnZpdGVTZW5kZXIiLCJnZXRNZW1iZXIiLCJnZXRVc2VySWQiLCJldmVudHMiLCJtZW1iZXIiLCJnZXRTZW5kZXIiLCJpbnZpdGVyIiwiaXNHdWVzdCIsImZvb3RlciIsImEiLCJzdWIiLCJzcGFjZU5hbWUiLCJtaWdyYXRlZENvbW11bml0eVNlY3Rpb24iLCJjcmVhdGVDb250ZW50IiwiY3VycmVudFN0YXRlIiwiZ2V0U3RhdGVFdmVudHMiLCJFdmVudFR5cGUiLCJSb29tQ3JlYXRlIiwiZ2V0Q29udGVudCIsIkNyZWF0ZUV2ZW50RmllbGQiLCJDb21tdW5pdHkiLCJ0b3BpYyIsInJlZiIsIlNwYWNlTGFuZGluZ0FkZEJ1dHRvbiIsIm1lbnVEaXNwbGF5ZWQiLCJoYW5kbGUiLCJvcGVuTWVudSIsImNsb3NlTWVudSIsImNvbnRleHRNZW51IiwicmVjdCIsImN1cnJlbnQiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJsZWZ0Iiwid2luZG93IiwicGFnZVhPZmZzZXQiLCJib3R0b20iLCJwYWdlWU9mZnNldCIsIkNoZXZyb25GYWNlIiwiTm9uZSIsInByZXZlbnREZWZhdWx0Iiwic3RvcFByb3BhZ2F0aW9uIiwiZmlyZSIsIlVwZGF0ZVNwYWNlSGllcmFyY2h5IiwiU3BhY2VMYW5kaW5nIiwidXNlcklkIiwiaW52aXRlQnV0dG9uIiwiY2FuSW52aXRlIiwiVUlDb21wb25lbnQiLCJJbnZpdGVVc2VycyIsImNhbkFkZFJvb21zIiwibWF5U2VuZFN0YXRlRXZlbnQiLCJTcGFjZUNoaWxkIiwiYWRkUm9vbUJ1dHRvbiIsInNldHRpbmdzQnV0dG9uIiwib25NZW1iZXJzQ2xpY2siLCJ0YWdzIiwic2hvd1Jvb20iLCJTcGFjZVNldHVwRmlyc3RSb29tcyIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJvbkZpbmlzaGVkIiwiZXJyb3IiLCJzZXRFcnJvciIsIm51bUZpZWxkcyIsInBsYWNlaG9sZGVycyIsInJvb21OYW1lcyIsInNldFJvb21OYW1lIiwiZmllbGRzIiwiQXJyYXkiLCJmaWxsIiwibWFwIiwieCIsImkiLCJldiIsInRhcmdldCIsInZhbHVlIiwib25OZXh0Q2xpY2siLCJpc1B1YmxpYyIsImZpbHRlcmVkUm9vbU5hbWVzIiwidHJpbSIsImZpbHRlciIsIkJvb2xlYW4iLCJyb29tSWRzIiwiUHJvbWlzZSIsImFsbCIsImNyZWF0ZU9wdHMiLCJwcmVzZXQiLCJQcmVzZXQiLCJQdWJsaWNDaGF0IiwiUHJpdmF0ZUNoYXQiLCJzcGlubmVyIiwiZW5jcnlwdGlvbiIsImFuZFZpZXciLCJpbmxpbmVFcnJvcnMiLCJwYXJlbnRTcGFjZSIsIlJlc3RyaWN0ZWQiLCJzdWdnZXN0ZWQiLCJsb2dnZXIiLCJvbkNsaWNrIiwiYnV0dG9uTGFiZWwiLCJzb21lIiwiU3BhY2VBZGRFeGlzdGluZ1Jvb21zIiwiZGVmYXVsdFJvb21zUmVuZGVyZXIiLCJkZWZhdWx0U3BhY2VzUmVuZGVyZXIiLCJkZWZhdWx0RG1zUmVuZGVyZXIiLCJTcGFjZVNldHVwUHVibGljU2hhcmUiLCJqdXN0Q3JlYXRlZE9wdHMiLCJmaXJzdFJvb21JZCIsIlNwYWNlU2V0dXBQcml2YXRlU2NvcGUiLCJ2YWxpZGF0ZUVtYWlsUnVsZXMiLCJydWxlcyIsImtleSIsInRlc3QiLCJFbWFpbCIsImxvb2tzVmFsaWQiLCJpbnZhbGlkIiwiU3BhY2VTZXR1cFByaXZhdGVJbnZpdGUiLCJmaWVsZFJlZnMiLCJlbWFpbEFkZHJlc3NlcyIsInNldEVtYWlsQWRkcmVzcyIsImZpZWxkUmVmIiwidmFsaWQiLCJ2YWxpZGF0ZSIsImFsbG93RW1wdHkiLCJmb2N1cyIsImZvY3VzZWQiLCJ0YXJnZXRJZHMiLCJyZXN1bHQiLCJmYWlsZWRVc2VycyIsIk9iamVjdCIsImtleXMiLCJzdGF0ZXMiLCJsb2ciLCJjc3ZVc2VycyIsImpvaW4iLCJlcnIiLCJiIiwibGluayIsIlNwYWNlUm9vbVZpZXciLCJSZWFjdCIsIlB1cmVDb21wb25lbnQiLCJjb25zdHJ1Y3RvciIsInByb3BzIiwiY29udGV4dCIsInNldFN0YXRlIiwic2hvd1JpZ2h0UGFuZWwiLCJSaWdodFBhbmVsU3RvcmUiLCJnZXRTaGFyZWRJbnN0YW5jZSIsImlzT3BlbkZvclJvb20iLCJMYW5kaW5nIiwiVmlld1VzZXIiLCJTcGFjZU1lbWJlckluZm8iLCJldmVudCIsIlNwYWNlM3BpZE1lbWJlckluZm8iLCJTcGFjZU1lbWJlckxpc3QiLCJjcmVhdG9yIiwic2hvd1NldHVwIiwiUHVibGljQ3JlYXRlUm9vbXMiLCJQcml2YXRlU2NvcGUiLCJkaXNwYXRjaGVyUmVmIiwicmVnaXN0ZXIiLCJvbkFjdGlvbiIsInJpZ2h0UGFuZWxTdG9yZVRva2VuIiwiYWRkTGlzdGVuZXIiLCJvblJpZ2h0UGFuZWxTdG9yZVVwZGF0ZSIsIm9uIiwib25NeU1lbWJlcnNoaXAiLCJjb21wb25lbnRXaWxsVW5tb3VudCIsInVucmVnaXN0ZXIiLCJyZW1vdmUiLCJvZmYiLCJyZW5kZXJCb2R5IiwiUHVibGljU2hhcmUiLCJnb1RvRmlyc3RSb29tIiwiaW52aXRlIiwiUHJpdmF0ZUNyZWF0ZVJvb21zIiwiUHJpdmF0ZUV4aXN0aW5nUm9vbXMiLCJQcml2YXRlSW52aXRlIiwicmVuZGVyIiwicmlnaHRQYW5lbCIsInJlc2l6ZU5vdGlmaWVyIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQWdCQTs7QUFDQTs7QUFDQTs7QUFJQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFFQTs7QUFDQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUFRQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFNQTs7QUFDQTs7QUFJQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFDQTs7QUFDQTs7Ozs7O0FBdEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtJQXlGS0EsSzs7V0FBQUEsSztBQUFBQSxFQUFBQSxLLENBQUFBLEs7QUFBQUEsRUFBQUEsSyxDQUFBQSxLO0FBQUFBLEVBQUFBLEssQ0FBQUEsSztBQUFBQSxFQUFBQSxLLENBQUFBLEs7QUFBQUEsRUFBQUEsSyxDQUFBQSxLO0FBQUFBLEVBQUFBLEssQ0FBQUEsSztBQUFBQSxFQUFBQSxLLENBQUFBLEs7R0FBQUEsSyxLQUFBQSxLOztBQVVMLE1BQU1DLGVBQWUsR0FBRyxDQUFDO0FBQUVDLEVBQUFBLElBQUY7QUFBUUMsRUFBQUE7QUFBUixDQUFELEtBQXdCO0FBQzVDLFFBQU1DLE9BQU8sR0FBRyxvQ0FBZUYsSUFBZixDQUFoQjtBQUNBLFFBQU1HLEtBQUssR0FBR0QsT0FBTyxDQUFDRSxNQUF0QjtBQUVBLE1BQUlILFFBQUosRUFBYyxPQUFPQSxRQUFRLENBQUNFLEtBQUQsQ0FBZjtBQUNkLFNBQU9BLEtBQVA7QUFDSCxDQU5EOztBQVFBLE1BQU1FLG1CQUFtQixHQUFJTCxJQUFELElBQWdCO0FBQ3hDLFFBQU0sQ0FBQ00sVUFBRCxFQUFhQyxhQUFiLElBQThCLHFCQUFTUCxJQUFJLENBQUNRLGVBQUwsRUFBVCxDQUFwQztBQUNBLHdDQUFnQlIsSUFBaEIsRUFBc0IsbUJBQXRCLEVBQTJDLE1BQU07QUFDN0NPLElBQUFBLGFBQWEsQ0FBQ1AsSUFBSSxDQUFDUSxlQUFMLEVBQUQsQ0FBYjtBQUNILEdBRkQ7QUFHQSxTQUFPRixVQUFQO0FBQ0gsQ0FORDs7QUFRQSxNQUFNRyxTQUFTLEdBQUcsQ0FBQztBQUFFQyxFQUFBQTtBQUFGLENBQUQsS0FBZ0M7QUFDOUM7QUFDQSxRQUFNQyxPQUFPLEdBQUcsZ0NBQWEsWUFBWTtBQUNyQyxRQUFJRCxLQUFLLENBQUNGLGVBQU4sT0FBNEIsUUFBaEMsRUFBMEM7O0FBQzFDLFFBQUk7QUFDQSxhQUFPRSxLQUFLLENBQUNFLE1BQU4sQ0FBYUMsY0FBYixDQUE0QkgsS0FBSyxDQUFDSSxNQUFsQyxDQUFQO0FBQ0gsS0FGRCxDQUVFLE9BQU9DLENBQVAsRUFBVTtBQUNSLGFBQU8sSUFBUDtBQUNIO0FBQ0osR0FQZSxFQU9iLENBQUNMLEtBQUQsQ0FQYSxDQUFoQjtBQVFBLFFBQU1NLFFBQVEsR0FBRyxnQ0FBYU4sS0FBYixFQUFvQk8sS0FBSyxJQUFJQSxLQUFLLENBQUNDLFdBQU4sRUFBN0IsQ0FBakI7QUFDQSxRQUFNWixVQUFVLEdBQUdELG1CQUFtQixDQUFDSyxLQUFELENBQXRDO0FBRUEsTUFBSVMsaUJBQUo7O0FBQ0EsTUFBSUgsUUFBUSxLQUFLLFFBQWpCLEVBQTJCO0FBQ3ZCRyxJQUFBQSxpQkFBaUIsZ0JBQUc7QUFBTSxNQUFBLFNBQVMsRUFBQztBQUFoQixPQUNkLHlCQUFHLGNBQUgsQ0FEYyxDQUFwQjtBQUdILEdBSkQsTUFJTztBQUNIQSxJQUFBQSxpQkFBaUIsZ0JBQUc7QUFBTSxNQUFBLFNBQVMsRUFBQztBQUFoQixPQUNkLHlCQUFHLGVBQUgsQ0FEYyxDQUFwQjtBQUdIOztBQUVELE1BQUlDLGFBQUo7O0FBQ0EsTUFBSWQsVUFBVSxLQUFLLFFBQWYsSUFBMkJLLE9BQS9CLEVBQXdDO0FBQ3BDO0FBQ0FTLElBQUFBLGFBQWEsZ0JBQUc7QUFBTSxNQUFBLFNBQVMsRUFBQztBQUFoQixPQUNWLHlCQUFHLG1CQUFILEVBQXdCO0FBQUVqQixNQUFBQSxLQUFLLEVBQUVRLE9BQU8sQ0FBQ1U7QUFBakIsS0FBeEIsQ0FEVSxDQUFoQjtBQUdILEdBTEQsTUFLTyxJQUFJVixPQUFPLEtBQUtXLFNBQWhCLEVBQTJCO0FBQUU7QUFDaENGLElBQUFBLGFBQWEsZ0JBQUcsNkJBQUMsZUFBRDtBQUFpQixNQUFBLElBQUksRUFBRVY7QUFBdkIsT0FDVFAsS0FBRCxJQUFXQSxLQUFLLEdBQUcsQ0FBUixnQkFDVCw2QkFBQyx5QkFBRDtBQUNJLE1BQUEsSUFBSSxFQUFDLE1BRFQ7QUFFSSxNQUFBLFNBQVMsRUFBQyxtQ0FGZDtBQUdJLE1BQUEsT0FBTyxFQUFFLE1BQU07QUFDWG9CLDRCQUFrQkMsUUFBbEIsQ0FBc0Q7QUFDbERDLFVBQUFBLE1BQU0sRUFBRUMsZ0JBQU9DLGtCQURtQztBQUVsREMsVUFBQUEsS0FBSyxFQUFFQyx3Q0FBaUJDLGNBRjBCO0FBR2xEQyxVQUFBQSxZQUFZLEVBQUU7QUFBRXJCLFlBQUFBO0FBQUY7QUFIb0MsU0FBdEQ7QUFLSDtBQVRMLE9BV00seUJBQUcsbUJBQUgsRUFBd0I7QUFBRVAsTUFBQUE7QUFBRixLQUF4QixDQVhOLENBRFMsR0FjVCxJQWZRLENBQWhCO0FBaUJIOztBQUVELHNCQUFPO0FBQUssSUFBQSxTQUFTLEVBQUM7QUFBZixLQUNEZ0IsaUJBREMsRUFFREMsYUFGQyxDQUFQO0FBSUgsQ0F0REQ7O0FBd0RBLE1BQU1ZLGtCQUFrQixHQUFHLE1BQU07QUFDN0JULHNCQUFrQkMsUUFBbEIsQ0FBMkI7QUFDdkJDLElBQUFBLE1BQU0sRUFBRUMsZ0JBQU9PLGdCQURRO0FBRXZCQyxJQUFBQSxZQUFZLEVBQUVDLDRCQUFRQztBQUZDLEdBQTNCO0FBSUgsQ0FMRCxDLENBT0E7OztBQUNBLE1BQU1DLFNBQVMsR0FBRyxDQUFDO0FBQUVDLEVBQUFBO0FBQUYsQ0FBRCxLQUFzQztBQUNwRCxRQUFNQyxHQUFHLEdBQUcsdUJBQVdDLDRCQUFYLENBQVo7QUFDQSxRQUFNQyxZQUFZLEdBQUcsZ0NBQTRCLE1BQU1GLEdBQUcsQ0FBQ0csZUFBSixDQUFvQkosT0FBcEIsQ0FBbEMsRUFBZ0UsQ0FBQ0MsR0FBRCxFQUFNRCxPQUFOLENBQWhFLENBQXJCO0FBRUEsTUFBSSxDQUFDRyxZQUFMLEVBQW1CLG9CQUFPLDZCQUFDLGdCQUFELE9BQVA7QUFFbkIsc0JBQU8seUVBQ0gsNkJBQUMsb0JBQUQ7QUFDSSxJQUFBLE9BQU8sRUFBRUgsT0FEYjtBQUVJLElBQUEsU0FBUyxFQUFFRyxZQUFZLENBQUNFLE9BQWIsQ0FBcUJDLElBRnBDO0FBR0ksSUFBQSxjQUFjLEVBQUVILFlBQVksQ0FBQ0UsT0FBYixDQUFxQkUsVUFIekM7QUFJSSxJQUFBLEtBQUssRUFBRSxFQUpYO0FBS0ksSUFBQSxNQUFNLEVBQUUsRUFMWjtBQU1JLElBQUEsWUFBWSxFQUFDO0FBTmpCLElBREcsRUFTREosWUFBWSxDQUFDRSxPQUFiLENBQXFCQyxJQVRwQixDQUFQO0FBV0gsQ0FqQkQ7O0FBeUJBLE1BQU1FLFlBQVksR0FBRyxDQUFDO0FBQUVwQyxFQUFBQSxLQUFGO0FBQVNxQyxFQUFBQSxtQkFBVDtBQUE4QkMsRUFBQUE7QUFBOUIsQ0FBRCxLQUErRTtBQUFBOztBQUNoRyxRQUFNVCxHQUFHLEdBQUcsdUJBQVdDLDRCQUFYLENBQVo7QUFDQSxRQUFNUyxZQUFZLEdBQUc1QyxtQkFBbUIsQ0FBQ0ssS0FBRCxDQUF4QztBQUNBLG9DQUFjYSxtQkFBZCxFQUFpQzJCLE9BQU8sSUFBSTtBQUN4QyxRQUFJQSxPQUFPLENBQUN6QixNQUFSLEtBQW1CQyxnQkFBT3lCLGFBQTFCLElBQTJDRCxPQUFPLENBQUNwQyxNQUFSLEtBQW1CSixLQUFLLENBQUNJLE1BQXhFLEVBQWdGO0FBQzVFc0MsTUFBQUEsT0FBTyxDQUFDLEtBQUQsQ0FBUCxDQUQ0RSxDQUM1RDtBQUNuQjtBQUNKLEdBSkQ7QUFNQSxRQUFNLENBQUNDLElBQUQsRUFBT0QsT0FBUCxJQUFrQixxQkFBUyxLQUFULENBQXhCO0FBRUEsUUFBTUUsYUFBYSxHQUFHQyxvQkFBV0QsYUFBakM7QUFFQSxRQUFNdEMsUUFBUSxHQUFHLGdDQUFhTixLQUFiLEVBQW9CTyxLQUFLLElBQUlBLEtBQUssQ0FBQ0MsV0FBTixFQUE3QixDQUFqQjs7QUFDQSxRQUFNc0MsVUFBVSxHQUFHLHdDQUF1QlAsWUFBdkIsTUFBeUNRLGdDQUFvQkMsS0FBN0QsSUFDWjFDLFFBQVEsS0FBSzJDLG1CQUFTQyxNQUQ3Qjs7QUFHQSxNQUFJQyxjQUFKO0FBQ0EsTUFBSUMsV0FBSjs7QUFDQSxNQUFJYixZQUFZLEtBQUssTUFBckIsRUFBNkI7QUFDekI7QUFDQWEsSUFBQUEsV0FBVyxnQkFDUCw2QkFBQyx5QkFBRDtBQUNJLE1BQUEsSUFBSSxFQUFDLGdCQURUO0FBRUksTUFBQSxPQUFPLEVBQUUsTUFBTTtBQUNYQyw0QkFBSXZDLFFBQUosQ0FBYTtBQUNUQyxVQUFBQSxNQUFNLEVBQUUsWUFEQztBQUVUdUMsVUFBQUEsT0FBTyxFQUFFdEQsS0FBSyxDQUFDSTtBQUZOLFNBQWI7QUFJSDtBQVBMLE9BU00seUJBQUcsT0FBSCxDQVROLENBREo7QUFhSCxHQWZELE1BZU8sSUFBSW1DLFlBQVksS0FBSyxRQUFyQixFQUErQjtBQUFBOztBQUNsQyxVQUFNZ0IsWUFBWSx1QkFBR3ZELEtBQUssQ0FBQ3dELFNBQU4sQ0FBZ0IzQixHQUFHLENBQUM0QixTQUFKLEVBQWhCLENBQUgsOEVBQUcsaUJBQWtDQyxNQUFsQyxDQUF5Q0MsTUFBNUMsMERBQUcsc0JBQWlEQyxTQUFqRCxFQUFyQjtBQUNBLFVBQU1DLE9BQU8sR0FBR04sWUFBWSxJQUFJdkQsS0FBSyxDQUFDd0QsU0FBTixDQUFnQkQsWUFBaEIsQ0FBaEM7O0FBRUEsUUFBSUEsWUFBSixFQUFrQjtBQUNkSixNQUFBQSxjQUFjLGdCQUFHO0FBQUssUUFBQSxTQUFTLEVBQUM7QUFBZixzQkFDYiw2QkFBQyxxQkFBRDtBQUFjLFFBQUEsTUFBTSxFQUFFVSxPQUF0QjtBQUErQixRQUFBLGNBQWMsRUFBRU4sWUFBL0M7QUFBNkQsUUFBQSxLQUFLLEVBQUUsRUFBcEU7QUFBd0UsUUFBQSxNQUFNLEVBQUU7QUFBaEYsUUFEYSxlQUViLHVEQUNJO0FBQUssUUFBQSxTQUFTLEVBQUM7QUFBZixTQUNNLHlCQUFHLHdCQUFILEVBQTZCLEVBQTdCLEVBQWlDO0FBQy9CTSxRQUFBQSxPQUFPLEVBQUUsbUJBQU0sd0NBQUssQ0FBQUEsT0FBTyxTQUFQLElBQUFBLE9BQU8sV0FBUCxZQUFBQSxPQUFPLENBQUUzQixJQUFULEtBQWlCcUIsWUFBdEI7QUFEZ0IsT0FBakMsQ0FETixDQURKLEVBTU1NLE9BQU8sZ0JBQUc7QUFBSyxRQUFBLFNBQVMsRUFBQztBQUFmLFNBQ05OLFlBRE0sQ0FBSCxHQUVBLElBUmIsQ0FGYSxDQUFqQjtBQWFIOztBQUVESCxJQUFBQSxXQUFXLGdCQUFHLHlFQUNWLDZCQUFDLHlCQUFEO0FBQ0ksTUFBQSxJQUFJLEVBQUMsV0FEVDtBQUVJLE1BQUEsT0FBTyxFQUFFLE1BQU07QUFDWFYsUUFBQUEsT0FBTyxDQUFDLElBQUQsQ0FBUDtBQUNBSixRQUFBQSxxQkFBcUI7QUFDeEI7QUFMTCxPQU9NLHlCQUFHLFFBQUgsQ0FQTixDQURVLGVBVVYsNkJBQUMseUJBQUQ7QUFDSSxNQUFBLElBQUksRUFBQyxTQURUO0FBRUksTUFBQSxPQUFPLEVBQUUsTUFBTTtBQUNYSSxRQUFBQSxPQUFPLENBQUMsSUFBRCxDQUFQO0FBQ0FMLFFBQUFBLG1CQUFtQjtBQUN0QixPQUxMO0FBTUksTUFBQSxRQUFRLEVBQUUsQ0FBQ087QUFOZixPQVFNLHlCQUFHLFFBQUgsQ0FSTixDQVZVLENBQWQ7QUFxQkgsR0F6Q00sTUF5Q0E7QUFDSFEsSUFBQUEsV0FBVyxnQkFDUCw2QkFBQyx5QkFBRDtBQUNJLE1BQUEsSUFBSSxFQUFDLFNBRFQ7QUFFSSxNQUFBLE9BQU8sRUFBRSxNQUFNO0FBQ1hmLFFBQUFBLG1CQUFtQjs7QUFDbkIsWUFBSSxDQUFDUixHQUFHLENBQUNpQyxPQUFKLEVBQUwsRUFBb0I7QUFDaEI7QUFDQXBCLFVBQUFBLE9BQU8sQ0FBQyxJQUFELENBQVA7QUFDSDtBQUNKLE9BUkw7QUFTSSxNQUFBLFFBQVEsRUFBRSxDQUFDRSxhQUFELElBQWtCRTtBQVRoQyxPQVdNLHlCQUFHLE1BQUgsQ0FYTixDQURKO0FBZUg7O0FBRUQsTUFBSUgsSUFBSixFQUFVO0FBQ05TLElBQUFBLFdBQVcsZ0JBQUcsNkJBQUMsc0JBQUQsT0FBZDtBQUNIOztBQUVELE1BQUlXLE1BQUo7O0FBQ0EsTUFBSSxDQUFDbkIsYUFBTCxFQUFvQjtBQUNoQm1CLElBQUFBLE1BQU0sZ0JBQUc7QUFBSyxNQUFBLFNBQVMsRUFBQztBQUFmLE9BQ0h4QixZQUFZLEtBQUssTUFBakIsR0FDSSx5QkFBRyxpRUFBSCxFQUFzRSxFQUF0RSxFQUEwRTtBQUN4RXlCLE1BQUFBLENBQUMsRUFBRUMsR0FBRyxpQkFBSSw2QkFBQyx5QkFBRDtBQUFrQixRQUFBLE9BQU8sRUFBRTNDLGtCQUEzQjtBQUErQyxRQUFBLElBQUksRUFBQztBQUFwRCxTQUE2RDJDLEdBQTdEO0FBRDhELEtBQTFFLENBREosR0FJSSx5QkFBRyxpRUFBSCxFQUFzRSxFQUF0RSxFQUEwRTtBQUN4RUQsTUFBQUEsQ0FBQyxFQUFFQyxHQUFHLGlCQUFJLDZCQUFDLHlCQUFEO0FBQWtCLFFBQUEsT0FBTyxFQUFFM0Msa0JBQTNCO0FBQStDLFFBQUEsSUFBSSxFQUFDO0FBQXBELFNBQTZEMkMsR0FBN0Q7QUFEOEQsS0FBMUUsQ0FMRCxDQUFUO0FBVUgsR0FYRCxNQVdPLElBQUluQixVQUFKLEVBQWdCO0FBQ25CaUIsSUFBQUEsTUFBTSxnQkFBRztBQUFLLE1BQUEsU0FBUyxFQUFDO0FBQWYsT0FDSCx5QkFBRywyQ0FBSCxFQUFnRDtBQUM5Q0csTUFBQUEsU0FBUyxFQUFFbEUsS0FBSyxDQUFDa0M7QUFENkIsS0FBaEQsQ0FERyxDQUFUO0FBS0g7O0FBRUQsTUFBSWlDLHdCQUFKO0FBQ0EsUUFBTUMsYUFBYSw0QkFBR3BFLEtBQUssQ0FBQ3FFLFlBQU4sQ0FBbUJDLGNBQW5CLENBQWtDQyxpQkFBVUMsVUFBNUMsRUFBd0QsRUFBeEQsQ0FBSCwwREFBRyxzQkFBNkRDLFVBQTdELEVBQXRCOztBQUNBLE1BQUlMLGFBQWEsQ0FBQ00sZ0RBQUQsQ0FBakIsRUFBcUM7QUFDakNQLElBQUFBLHdCQUF3QixnQkFBRztBQUFLLE1BQUEsU0FBUyxFQUFDO0FBQWYsT0FDckIseUJBQUcsNEJBQUgsRUFBaUMsRUFBakMsRUFBcUM7QUFDbkNRLE1BQUFBLFNBQVMsRUFBRSxtQkFBTSw2QkFBQyxTQUFEO0FBQVcsUUFBQSxPQUFPLEVBQUVQLGFBQWEsQ0FBQ00sZ0RBQUQ7QUFBakM7QUFEa0IsS0FBckMsQ0FEcUIsQ0FBM0I7QUFLSDs7QUFFRCxzQkFBTztBQUFLLElBQUEsU0FBUyxFQUFDO0FBQWYsS0FDRFAsd0JBREMsRUFFRGhCLGNBRkMsZUFHSCw2QkFBQyxtQkFBRDtBQUFZLElBQUEsSUFBSSxFQUFFbkQsS0FBbEI7QUFBeUIsSUFBQSxNQUFNLEVBQUUsRUFBakM7QUFBcUMsSUFBQSxLQUFLLEVBQUUsRUFBNUM7QUFBZ0QsSUFBQSxpQkFBaUIsRUFBRTtBQUFuRSxJQUhHLGVBSUg7QUFBSSxJQUFBLFNBQVMsRUFBQztBQUFkLGtCQUNJLDZCQUFDLGlCQUFEO0FBQVUsSUFBQSxJQUFJLEVBQUVBO0FBQWhCLElBREosQ0FKRyxlQU9ILDZCQUFDLFNBQUQ7QUFBVyxJQUFBLEtBQUssRUFBRUE7QUFBbEIsSUFQRyxlQVFILDZCQUFDLGtCQUFEO0FBQVcsSUFBQSxJQUFJLEVBQUVBO0FBQWpCLEtBQ00sQ0FBQzRFLEtBQUQsRUFBUUMsR0FBUixrQkFDRTtBQUFLLElBQUEsU0FBUyxFQUFDLGdDQUFmO0FBQWdELElBQUEsR0FBRyxFQUFFQTtBQUFyRCxLQUNNRCxLQUROLENBRlIsQ0FSRyxFQWVENUUsS0FBSyxDQUFDUSxXQUFOLE9BQXdCLFFBQXhCLGlCQUFvQyw2QkFBQyxpQkFBRDtBQUFVLElBQUEsSUFBSSxFQUFFUjtBQUFoQixJQWZuQyxlQWdCSDtBQUFLLElBQUEsU0FBUyxFQUFDO0FBQWYsS0FDTW9ELFdBRE4sQ0FoQkcsRUFtQkRXLE1BbkJDLENBQVA7QUFxQkgsQ0FwSkQ7O0FBc0pBLE1BQU1lLHFCQUFxQixHQUFHLENBQUM7QUFBRTlFLEVBQUFBO0FBQUYsQ0FBRCxLQUFlO0FBQ3pDLFFBQU0sQ0FBQytFLGFBQUQsRUFBZ0JDLE1BQWhCLEVBQXdCQyxRQUF4QixFQUFrQ0MsU0FBbEMsSUFBK0Msa0NBQXJEO0FBRUEsTUFBSUMsV0FBSjs7QUFDQSxNQUFJSixhQUFKLEVBQW1CO0FBQ2YsVUFBTUssSUFBSSxHQUFHSixNQUFNLENBQUNLLE9BQVAsQ0FBZUMscUJBQWYsRUFBYjtBQUNBSCxJQUFBQSxXQUFXLGdCQUFHLDZCQUFDLDRCQUFEO0FBQ1YsTUFBQSxJQUFJLEVBQUVDLElBQUksQ0FBQ0csSUFBTCxHQUFZQyxNQUFNLENBQUNDLFdBQW5CLEdBQWlDLENBRDdCO0FBRVYsTUFBQSxHQUFHLEVBQUVMLElBQUksQ0FBQ00sTUFBTCxHQUFjRixNQUFNLENBQUNHLFdBQXJCLEdBQW1DLENBRjlCO0FBR1YsTUFBQSxXQUFXLEVBQUVDLHlCQUFZQyxJQUhmO0FBSVYsTUFBQSxVQUFVLEVBQUVYLFNBSkY7QUFLVixNQUFBLFNBQVMsRUFBQyx5QkFMQTtBQU1WLE1BQUEsT0FBTztBQU5HLG9CQVFWLDZCQUFDLGtEQUFEO0FBQStCLE1BQUEsS0FBSztBQUFwQyxvQkFDSSw2QkFBQyw4Q0FBRDtBQUNJLE1BQUEsS0FBSyxFQUFFLHlCQUFHLGlCQUFILENBRFg7QUFFSSxNQUFBLGFBQWEsRUFBQyxzQkFGbEI7QUFHSSxNQUFBLE9BQU8sRUFBRSxNQUFPN0UsQ0FBUCxJQUFhO0FBQ2xCQSxRQUFBQSxDQUFDLENBQUN5RixjQUFGO0FBQ0F6RixRQUFBQSxDQUFDLENBQUMwRixlQUFGO0FBQ0FiLFFBQUFBLFNBQVM7O0FBRVQsWUFBSSxNQUFNLDhCQUFrQmxGLEtBQWxCLENBQVYsRUFBb0M7QUFDaENhLDhCQUFrQm1GLElBQWxCLENBQXVCaEYsZ0JBQU9pRixvQkFBOUI7QUFDSDtBQUNKO0FBWEwsTUFESixlQWNJLDZCQUFDLDhDQUFEO0FBQ0ksTUFBQSxLQUFLLEVBQUUseUJBQUcsbUJBQUgsQ0FEWDtBQUVJLE1BQUEsYUFBYSxFQUFDLHNCQUZsQjtBQUdJLE1BQUEsT0FBTyxFQUFHNUYsQ0FBRCxJQUFPO0FBQ1pBLFFBQUFBLENBQUMsQ0FBQ3lGLGNBQUY7QUFDQXpGLFFBQUFBLENBQUMsQ0FBQzBGLGVBQUY7QUFDQWIsUUFBQUEsU0FBUztBQUNULHlDQUFxQmxGLEtBQXJCO0FBQ0g7QUFSTCxNQWRKLGVBd0JJLDZCQUFDLDhDQUFEO0FBQ0ksTUFBQSxLQUFLLEVBQUUseUJBQUcsV0FBSCxDQURYO0FBRUksTUFBQSxhQUFhLEVBQUMsc0JBRmxCO0FBR0ksTUFBQSxPQUFPLEVBQUdLLENBQUQsSUFBTztBQUNaQSxRQUFBQSxDQUFDLENBQUN5RixjQUFGO0FBQ0F6RixRQUFBQSxDQUFDLENBQUMwRixlQUFGO0FBQ0FiLFFBQUFBLFNBQVM7QUFDVCwwQ0FBc0JsRixLQUF0QjtBQUNIO0FBUkwsb0JBVUksNkJBQUMsa0JBQUQsT0FWSixDQXhCSixDQVJVLENBQWQ7QUE4Q0g7O0FBRUQsc0JBQU8seUVBQ0gsNkJBQUMsOEJBQUQ7QUFDSSxJQUFBLElBQUksRUFBQyxTQURUO0FBRUksSUFBQSxRQUFRLEVBQUVnRixNQUZkO0FBR0ksSUFBQSxPQUFPLEVBQUVDLFFBSGI7QUFJSSxJQUFBLFVBQVUsRUFBRUYsYUFKaEI7QUFLSSxJQUFBLEtBQUssRUFBRSx5QkFBRyxLQUFIO0FBTFgsS0FPTSx5QkFBRyxLQUFILENBUE4sQ0FERyxFQVVESSxXQVZDLENBQVA7QUFZSCxDQWxFRDs7QUFvRUEsTUFBTWUsWUFBWSxHQUFHLENBQUM7QUFBRWxHLEVBQUFBO0FBQUYsQ0FBRCxLQUFnQztBQUNqRCxRQUFNNkIsR0FBRyxHQUFHLHVCQUFXQyw0QkFBWCxDQUFaO0FBQ0EsUUFBTVMsWUFBWSxHQUFHNUMsbUJBQW1CLENBQUNLLEtBQUQsQ0FBeEM7QUFDQSxRQUFNbUcsTUFBTSxHQUFHdEUsR0FBRyxDQUFDNEIsU0FBSixFQUFmO0FBRUEsTUFBSTJDLFlBQUo7O0FBQ0EsTUFBSSxDQUFFN0QsWUFBWSxLQUFLLE1BQWpCLElBQTJCdkMsS0FBSyxDQUFDcUcsU0FBTixDQUFnQkYsTUFBaEIsQ0FBNUIsSUFBd0RuRyxLQUFLLENBQUNRLFdBQU4sT0FBd0J5QyxtQkFBU0MsTUFBMUYsS0FDQSx1Q0FBb0JvRCx1QkFBWUMsV0FBaEMsQ0FESixFQUVFO0FBQ0VILElBQUFBLFlBQVksZ0JBQ1IsNkJBQUMseUJBQUQ7QUFDSSxNQUFBLElBQUksRUFBQyxTQURUO0FBRUksTUFBQSxTQUFTLEVBQUMsdUNBRmQ7QUFHSSxNQUFBLE9BQU8sRUFBRSxNQUFNO0FBQ1gsb0NBQWdCcEcsS0FBaEI7QUFDSDtBQUxMLE9BT00seUJBQUcsUUFBSCxDQVBOLENBREo7QUFXSDs7QUFFRCxRQUFNd0csV0FBVyxHQUFHakUsWUFBWSxLQUFLLE1BQWpCLElBQTJCdkMsS0FBSyxDQUFDcUUsWUFBTixDQUFtQm9DLGlCQUFuQixDQUFxQ2xDLGlCQUFVbUMsVUFBL0MsRUFBMkRQLE1BQTNELENBQS9DO0FBRUEsTUFBSVEsYUFBSjs7QUFDQSxNQUFJSCxXQUFKLEVBQWlCO0FBQ2JHLElBQUFBLGFBQWEsZ0JBQUcsNkJBQUMscUJBQUQ7QUFBdUIsTUFBQSxLQUFLLEVBQUUzRztBQUE5QixNQUFoQjtBQUNIOztBQUVELE1BQUk0RyxjQUFKOztBQUNBLE1BQUksb0NBQXdCNUcsS0FBeEIsQ0FBSixFQUFvQztBQUNoQzRHLElBQUFBLGNBQWMsZ0JBQUcsNkJBQUMsZ0NBQUQ7QUFDYixNQUFBLFNBQVMsRUFBQyx5Q0FERztBQUViLE1BQUEsT0FBTyxFQUFFLE1BQU07QUFDWCxzQ0FBa0I1RyxLQUFsQjtBQUNILE9BSlk7QUFLYixNQUFBLEtBQUssRUFBRSx5QkFBRyxVQUFIO0FBTE0sTUFBakI7QUFPSDs7QUFFRCxRQUFNNkcsY0FBYyxHQUFHLE1BQU07QUFDekJoRyx3QkFBa0JDLFFBQWxCLENBQXNEO0FBQ2xEQyxNQUFBQSxNQUFNLEVBQUVDLGdCQUFPQyxrQkFEbUM7QUFFbERDLE1BQUFBLEtBQUssRUFBRUMsd0NBQWlCQyxjQUYwQjtBQUdsREMsTUFBQUEsWUFBWSxFQUFFO0FBQUVyQixRQUFBQTtBQUFGO0FBSG9DLEtBQXREO0FBS0gsR0FORDs7QUFRQSxzQkFBTztBQUFLLElBQUEsU0FBUyxFQUFDO0FBQWYsa0JBQ0gsNkJBQUMsb0NBQUQsT0FERyxlQUVILDZCQUFDLG1CQUFEO0FBQVksSUFBQSxJQUFJLEVBQUVBLEtBQWxCO0FBQXlCLElBQUEsTUFBTSxFQUFFLEVBQWpDO0FBQXFDLElBQUEsS0FBSyxFQUFFLEVBQTVDO0FBQWdELElBQUEsaUJBQWlCLEVBQUU7QUFBbkUsSUFGRyxlQUdIO0FBQUssSUFBQSxTQUFTLEVBQUM7QUFBZixrQkFDSSw2QkFBQyxpQkFBRDtBQUFVLElBQUEsSUFBSSxFQUFFQTtBQUFoQixLQUNPa0MsSUFBRCxJQUFVO0FBQ1IsVUFBTTRFLElBQUksR0FBRztBQUFFNUUsTUFBQUEsSUFBSSxFQUFFLG1CQUFNO0FBQUssUUFBQSxTQUFTLEVBQUM7QUFBZixzQkFDdkIseUNBQU1BLElBQU4sQ0FEdUI7QUFBZCxLQUFiO0FBR0EsV0FBTyx5QkFBRyxvQkFBSCxFQUF5QixFQUF6QixFQUE2QjRFLElBQTdCLENBQVA7QUFDSCxHQU5MLENBREosQ0FIRyxlQWFIO0FBQUssSUFBQSxTQUFTLEVBQUM7QUFBZixrQkFDSSw2QkFBQyxTQUFEO0FBQVcsSUFBQSxLQUFLLEVBQUU5RztBQUFsQixJQURKLGVBRUksNkJBQUMsaUJBQUQ7QUFBVSxJQUFBLElBQUksRUFBRUEsS0FBaEI7QUFBdUIsSUFBQSxjQUFjLEVBQUUsS0FBdkM7QUFBOEMsSUFBQSxRQUFRLEVBQUUsQ0FBeEQ7QUFBMkQsSUFBQSxPQUFPLEVBQUU2RztBQUFwRSxJQUZKLEVBR01ULFlBSE4sRUFJTVEsY0FKTixDQWJHLGVBbUJILDZCQUFDLGtCQUFEO0FBQVcsSUFBQSxJQUFJLEVBQUU1RztBQUFqQixLQUNNLENBQUM0RSxLQUFELEVBQVFDLEdBQVIsa0JBQ0U7QUFBSyxJQUFBLFNBQVMsRUFBQyxnQ0FBZjtBQUFnRCxJQUFBLEdBQUcsRUFBRUE7QUFBckQsS0FDTUQsS0FETixDQUZSLENBbkJHLGVBMkJILDZCQUFDLHVCQUFEO0FBQWdCLElBQUEsS0FBSyxFQUFFNUUsS0FBdkI7QUFBOEIsSUFBQSxRQUFRLEVBQUUrRyx3QkFBeEM7QUFBa0QsSUFBQSxpQkFBaUIsRUFBRUo7QUFBckUsSUEzQkcsQ0FBUDtBQTZCSCxDQTdFRDs7QUErRUEsTUFBTUssb0JBQW9CLEdBQUcsQ0FBQztBQUFFaEgsRUFBQUEsS0FBRjtBQUFTaUgsRUFBQUEsS0FBVDtBQUFnQkMsRUFBQUEsV0FBaEI7QUFBNkJDLEVBQUFBO0FBQTdCLENBQUQsS0FBK0M7QUFDeEUsUUFBTSxDQUFDeEUsSUFBRCxFQUFPRCxPQUFQLElBQWtCLHFCQUFTLEtBQVQsQ0FBeEI7QUFDQSxRQUFNLENBQUMwRSxLQUFELEVBQVFDLFFBQVIsSUFBb0IscUJBQVMsRUFBVCxDQUExQjtBQUNBLFFBQU1DLFNBQVMsR0FBRyxDQUFsQjtBQUNBLFFBQU1DLFlBQVksR0FBRyxDQUFDLHlCQUFHLFNBQUgsQ0FBRCxFQUFnQix5QkFBRyxRQUFILENBQWhCLEVBQThCLHlCQUFHLFNBQUgsQ0FBOUIsQ0FBckI7QUFDQSxRQUFNLENBQUNDLFNBQUQsRUFBWUMsV0FBWixJQUEyQixrQ0FBY0gsU0FBZCxFQUF5QixDQUFDLHlCQUFHLFNBQUgsQ0FBRCxFQUFnQix5QkFBRyxRQUFILENBQWhCLEVBQThCLEVBQTlCLENBQXpCLENBQWpDO0FBQ0EsUUFBTUksTUFBTSxHQUFHLElBQUlDLEtBQUosQ0FBVUwsU0FBVixFQUFxQk0sSUFBckIsQ0FBMEIsQ0FBMUIsRUFBNkJDLEdBQTdCLENBQWlDLENBQUNDLENBQUQsRUFBSUMsQ0FBSixLQUFVO0FBQ3RELFVBQU03RixJQUFJLEdBQUcsYUFBYTZGLENBQTFCO0FBQ0Esd0JBQU8sNkJBQUMsY0FBRDtBQUNILE1BQUEsR0FBRyxFQUFFN0YsSUFERjtBQUVILE1BQUEsSUFBSSxFQUFFQSxJQUZIO0FBR0gsTUFBQSxJQUFJLEVBQUMsTUFIRjtBQUlILE1BQUEsS0FBSyxFQUFFLHlCQUFHLFdBQUgsQ0FKSjtBQUtILE1BQUEsV0FBVyxFQUFFcUYsWUFBWSxDQUFDUSxDQUFELENBTHRCO0FBTUgsTUFBQSxLQUFLLEVBQUVQLFNBQVMsQ0FBQ08sQ0FBRCxDQU5iO0FBT0gsTUFBQSxRQUFRLEVBQUVDLEVBQUUsSUFBSVAsV0FBVyxDQUFDTSxDQUFELEVBQUlDLEVBQUUsQ0FBQ0MsTUFBSCxDQUFVQyxLQUFkLENBUHhCO0FBUUgsTUFBQSxTQUFTLEVBQUVILENBQUMsS0FBSyxDQVJkO0FBU0gsTUFBQSxRQUFRLEVBQUVwRixJQVRQO0FBVUgsTUFBQSxZQUFZLEVBQUM7QUFWVixNQUFQO0FBWUgsR0FkYyxDQUFmOztBQWdCQSxRQUFNd0YsV0FBVyxHQUFHLE1BQU9ILEVBQVAsSUFBYztBQUM5QkEsSUFBQUEsRUFBRSxDQUFDbEMsY0FBSDtBQUNBLFFBQUluRCxJQUFKLEVBQVU7QUFDVjBFLElBQUFBLFFBQVEsQ0FBQyxFQUFELENBQVI7QUFDQTNFLElBQUFBLE9BQU8sQ0FBQyxJQUFELENBQVA7O0FBQ0EsUUFBSTtBQUNBLFlBQU0wRixRQUFRLEdBQUdwSSxLQUFLLENBQUNRLFdBQU4sT0FBd0J5QyxtQkFBU0MsTUFBbEQ7O0FBQ0EsWUFBTW1GLGlCQUFpQixHQUFHYixTQUFTLENBQUNLLEdBQVYsQ0FBYzNGLElBQUksSUFBSUEsSUFBSSxDQUFDb0csSUFBTCxFQUF0QixFQUFtQ0MsTUFBbkMsQ0FBMENDLE9BQTFDLENBQTFCO0FBQ0EsWUFBTUMsT0FBTyxHQUFHLE1BQU1DLE9BQU8sQ0FBQ0MsR0FBUixDQUFZTixpQkFBaUIsQ0FBQ1IsR0FBbEIsQ0FBc0IzRixJQUFJLElBQUk7QUFDNUQsZUFBTyx5QkFBVztBQUNkMEcsVUFBQUEsVUFBVSxFQUFFO0FBQ1JDLFlBQUFBLE1BQU0sRUFBRVQsUUFBUSxHQUFHVSxpQkFBT0MsVUFBVixHQUF1QkQsaUJBQU9FLFdBRHRDO0FBRVI5RyxZQUFBQTtBQUZRLFdBREU7QUFLZCtHLFVBQUFBLE9BQU8sRUFBRSxLQUxLO0FBTWRDLFVBQUFBLFVBQVUsRUFBRSxLQU5FO0FBT2RDLFVBQUFBLE9BQU8sRUFBRSxLQVBLO0FBUWRDLFVBQUFBLFlBQVksRUFBRSxJQVJBO0FBU2RDLFVBQUFBLFdBQVcsRUFBRXJKLEtBVEM7QUFVZE0sVUFBQUEsUUFBUSxFQUFFLENBQUM4SCxRQUFELEdBQVluRixtQkFBU3FHLFVBQXJCLEdBQWtDMUksU0FWOUI7QUFXZDJJLFVBQUFBLFNBQVMsRUFBRTtBQVhHLFNBQVgsQ0FBUDtBQWFILE9BZGlDLENBQVosQ0FBdEI7QUFlQXBDLE1BQUFBLFVBQVUsQ0FBQ3NCLE9BQU8sQ0FBQyxDQUFELENBQVIsQ0FBVjtBQUNILEtBbkJELENBbUJFLE9BQU9wSSxDQUFQLEVBQVU7QUFDUm1KLHFCQUFPcEMsS0FBUCxDQUFhLHNDQUFiLEVBQXFEL0csQ0FBckQ7O0FBQ0FnSCxNQUFBQSxRQUFRLENBQUMseUJBQUcsc0NBQUgsQ0FBRCxDQUFSO0FBQ0g7O0FBQ0QzRSxJQUFBQSxPQUFPLENBQUMsS0FBRCxDQUFQO0FBQ0gsR0E3QkQ7O0FBK0JBLE1BQUkrRyxPQUFPLEdBQUl6QixFQUFELElBQVE7QUFDbEJBLElBQUFBLEVBQUUsQ0FBQ2xDLGNBQUg7QUFDQXFCLElBQUFBLFVBQVU7QUFDYixHQUhEOztBQUlBLE1BQUl1QyxXQUFXLEdBQUcseUJBQUcsY0FBSCxDQUFsQjs7QUFDQSxNQUFJbEMsU0FBUyxDQUFDbUMsSUFBVixDQUFlekgsSUFBSSxJQUFJQSxJQUFJLENBQUNvRyxJQUFMLEVBQXZCLENBQUosRUFBeUM7QUFDckNtQixJQUFBQSxPQUFPLEdBQUd0QixXQUFWO0FBQ0F1QixJQUFBQSxXQUFXLEdBQUcvRyxJQUFJLEdBQUcseUJBQUcsbUJBQUgsQ0FBSCxHQUE2Qix5QkFBRyxVQUFILENBQS9DO0FBQ0g7O0FBRUQsc0JBQU8sdURBQ0gseUNBQU1zRSxLQUFOLENBREcsZUFFSDtBQUFLLElBQUEsU0FBUyxFQUFDO0FBQWYsS0FBZ0RDLFdBQWhELENBRkcsRUFJREUsS0FBSyxpQkFBSTtBQUFLLElBQUEsU0FBUyxFQUFDO0FBQWYsS0FBOENBLEtBQTlDLENBSlIsZUFLSDtBQUFNLElBQUEsUUFBUSxFQUFFcUMsT0FBaEI7QUFBeUIsSUFBQSxFQUFFLEVBQUM7QUFBNUIsS0FDTS9CLE1BRE4sQ0FMRyxlQVNIO0FBQUssSUFBQSxTQUFTLEVBQUM7QUFBZixrQkFDSSw2QkFBQyx5QkFBRDtBQUNJLElBQUEsSUFBSSxFQUFDLFNBRFQ7QUFFSSxJQUFBLFFBQVEsRUFBRS9FLElBRmQ7QUFHSSxJQUFBLE9BQU8sRUFBRThHLE9BSGI7QUFJSSxJQUFBLE9BQU8sRUFBQyxPQUpaO0FBS0ksSUFBQSxJQUFJLEVBQUMsUUFMVDtBQU1JLElBQUEsSUFBSSxFQUFDLHlCQU5UO0FBT0ksSUFBQSxLQUFLLEVBQUVDO0FBUFgsSUFESixDQVRHLENBQVA7QUFxQkgsQ0FwRkQ7O0FBc0ZBLE1BQU1FLHFCQUFxQixHQUFHLENBQUM7QUFBRTVKLEVBQUFBLEtBQUY7QUFBU21ILEVBQUFBO0FBQVQsQ0FBRCxLQUEyQjtBQUNyRCxzQkFBTyx1REFDSCx5Q0FBTSx5QkFBRywrQkFBSCxDQUFOLENBREcsZUFFSDtBQUFLLElBQUEsU0FBUyxFQUFDO0FBQWYsS0FDTSx5QkFBRyx1RUFDRCxrREFERixDQUROLENBRkcsZUFPSCw2QkFBQyw0Q0FBRDtBQUNJLElBQUEsS0FBSyxFQUFFbkgsS0FEWDtBQUVJLElBQUEsb0JBQW9CLGVBQ2hCLDZCQUFDLHlCQUFEO0FBQWtCLE1BQUEsSUFBSSxFQUFDLFNBQXZCO0FBQWlDLE1BQUEsT0FBTyxFQUFFbUg7QUFBMUMsT0FDTSx5QkFBRyxjQUFILENBRE4sQ0FIUjtBQU9JLElBQUEsaUJBQWlCLEVBQUUseUJBQUcsNEJBQUgsQ0FQdkI7QUFRSSxJQUFBLFVBQVUsRUFBRUEsVUFSaEI7QUFTSSxJQUFBLGFBQWEsRUFBRTBDLDhDQVRuQjtBQVVJLElBQUEsY0FBYyxFQUFFQywrQ0FWcEI7QUFXSSxJQUFBLFdBQVcsRUFBRUM7QUFYakIsSUFQRyxDQUFQO0FBcUJILENBdEJEOztBQTRCQSxNQUFNQyxxQkFBcUIsR0FBRyxDQUFDO0FBQUVDLEVBQUFBLGVBQUY7QUFBbUJqSyxFQUFBQSxLQUFuQjtBQUEwQm1ILEVBQUFBLFVBQTFCO0FBQXNDK0MsRUFBQUE7QUFBdEMsQ0FBRCxLQUFzRjtBQUFBOztBQUNoSCxzQkFBTztBQUFLLElBQUEsU0FBUyxFQUFDO0FBQWYsa0JBQ0gseUNBQU0seUJBQUcsZ0JBQUgsRUFBcUI7QUFDdkJoSSxJQUFBQSxJQUFJLEVBQUUsQ0FBQStILGVBQWUsU0FBZixJQUFBQSxlQUFlLFdBQWYscUNBQUFBLGVBQWUsQ0FBRXJCLFVBQWpCLGdGQUE2QjFHLElBQTdCLEtBQXFDbEMsS0FBSyxDQUFDa0M7QUFEMUIsR0FBckIsQ0FBTixDQURHLGVBSUg7QUFBSyxJQUFBLFNBQVMsRUFBQztBQUFmLEtBQ00seUJBQUcsa0VBQUgsQ0FETixDQUpHLGVBUUgsNkJBQUMseUJBQUQ7QUFBa0IsSUFBQSxLQUFLLEVBQUVsQztBQUF6QixJQVJHLGVBVUg7QUFBSyxJQUFBLFNBQVMsRUFBQztBQUFmLGtCQUNJLDZCQUFDLHlCQUFEO0FBQWtCLElBQUEsSUFBSSxFQUFDLFNBQXZCO0FBQWlDLElBQUEsT0FBTyxFQUFFbUg7QUFBMUMsS0FDTStDLFdBQVcsR0FBRyx5QkFBRyxxQkFBSCxDQUFILEdBQStCLHlCQUFHLGdCQUFILENBRGhELENBREosQ0FWRyxDQUFQO0FBZ0JILENBakJEOztBQW1CQSxNQUFNQyxzQkFBc0IsR0FBRyxDQUFDO0FBQUVuSyxFQUFBQSxLQUFGO0FBQVNpSyxFQUFBQSxlQUFUO0FBQTBCOUMsRUFBQUE7QUFBMUIsQ0FBRCxLQUE0QztBQUFBOztBQUN2RSxzQkFBTztBQUFLLElBQUEsU0FBUyxFQUFDO0FBQWYsa0JBQ0gseUNBQU0seUJBQUcsMkJBQUgsQ0FBTixDQURHLGVBRUg7QUFBSyxJQUFBLFNBQVMsRUFBQztBQUFmLEtBQ00seUJBQUcsb0RBQUgsRUFBeUQ7QUFDdkRqRixJQUFBQSxJQUFJLEVBQUUsQ0FBQStILGVBQWUsU0FBZixJQUFBQSxlQUFlLFdBQWYsc0NBQUFBLGVBQWUsQ0FBRXJCLFVBQWpCLGtGQUE2QjFHLElBQTdCLEtBQXFDbEMsS0FBSyxDQUFDa0M7QUFETSxHQUF6RCxDQUROLENBRkcsZUFRSCw2QkFBQyx5QkFBRDtBQUNJLElBQUEsU0FBUyxFQUFDLDRDQURkO0FBRUksSUFBQSxPQUFPLEVBQUUsTUFBTTtBQUFFaUYsTUFBQUEsVUFBVSxDQUFDLEtBQUQsQ0FBVjtBQUFvQjtBQUZ6QyxrQkFJSSx5Q0FBTSx5QkFBRyxTQUFILENBQU4sQ0FKSixlQUtJLDBDQUFPLHlCQUFHLHdDQUFILENBQVAsQ0FMSixDQVJHLGVBZUgsNkJBQUMseUJBQUQ7QUFDSSxJQUFBLFNBQVMsRUFBQyxzREFEZDtBQUVJLElBQUEsT0FBTyxFQUFFLE1BQU07QUFBRUEsTUFBQUEsVUFBVSxDQUFDLElBQUQsQ0FBVjtBQUFtQjtBQUZ4QyxrQkFJSSx5Q0FBTSx5QkFBRyxxQkFBSCxDQUFOLENBSkosZUFLSSwwQ0FBTyx5QkFBRyw0Q0FBSCxDQUFQLENBTEosQ0FmRyxDQUFQO0FBdUJILENBeEJEOztBQTBCQSxNQUFNaUQsa0JBQWtCLEdBQUcseUJBQWU7QUFDdENDLEVBQUFBLEtBQUssRUFBRSxDQUFDO0FBQ0pDLElBQUFBLEdBQUcsRUFBRSxPQUREO0FBRUpDLElBQUFBLElBQUksRUFBRSxDQUFDO0FBQUVyQyxNQUFBQTtBQUFGLEtBQUQsS0FBZSxDQUFDQSxLQUFELElBQVVzQyxLQUFLLENBQUNDLFVBQU4sQ0FBaUJ2QyxLQUFqQixDQUYzQjtBQUdKd0MsSUFBQUEsT0FBTyxFQUFFLE1BQU0seUJBQUcseUNBQUg7QUFIWCxHQUFEO0FBRCtCLENBQWYsQ0FBM0I7O0FBUUEsTUFBTUMsdUJBQXVCLEdBQUcsQ0FBQztBQUFFM0ssRUFBQUEsS0FBRjtBQUFTbUgsRUFBQUE7QUFBVCxDQUFELEtBQTJCO0FBQ3ZELFFBQU0sQ0FBQ3hFLElBQUQsRUFBT0QsT0FBUCxJQUFrQixxQkFBUyxLQUFULENBQXhCO0FBQ0EsUUFBTSxDQUFDMEUsS0FBRCxFQUFRQyxRQUFSLElBQW9CLHFCQUFTLEVBQVQsQ0FBMUI7QUFDQSxRQUFNQyxTQUFTLEdBQUcsQ0FBbEI7QUFDQSxRQUFNc0QsU0FBNkIsR0FBRyxDQUFDLG9CQUFELEVBQVcsb0JBQVgsRUFBcUIsb0JBQXJCLENBQXRDO0FBQ0EsUUFBTSxDQUFDQyxjQUFELEVBQWlCQyxlQUFqQixJQUFvQyxrQ0FBY3hELFNBQWQsRUFBeUIsRUFBekIsQ0FBMUM7QUFDQSxRQUFNSSxNQUFNLEdBQUcsSUFBSUMsS0FBSixDQUFVTCxTQUFWLEVBQXFCTSxJQUFyQixDQUEwQixDQUExQixFQUE2QkMsR0FBN0IsQ0FBaUMsQ0FBQ0MsQ0FBRCxFQUFJQyxDQUFKLEtBQVU7QUFDdEQsVUFBTTdGLElBQUksR0FBRyxpQkFBaUI2RixDQUE5QjtBQUNBLHdCQUFPLDZCQUFDLGNBQUQ7QUFDSCxNQUFBLEdBQUcsRUFBRTdGLElBREY7QUFFSCxNQUFBLElBQUksRUFBRUEsSUFGSDtBQUdILE1BQUEsSUFBSSxFQUFDLE1BSEY7QUFJSCxNQUFBLEtBQUssRUFBRSx5QkFBRyxlQUFILENBSko7QUFLSCxNQUFBLFdBQVcsRUFBRSx5QkFBRyxPQUFILENBTFY7QUFNSCxNQUFBLEtBQUssRUFBRTJJLGNBQWMsQ0FBQzlDLENBQUQsQ0FObEI7QUFPSCxNQUFBLFFBQVEsRUFBRUMsRUFBRSxJQUFJOEMsZUFBZSxDQUFDL0MsQ0FBRCxFQUFJQyxFQUFFLENBQUNDLE1BQUgsQ0FBVUMsS0FBZCxDQVA1QjtBQVFILE1BQUEsR0FBRyxFQUFFMEMsU0FBUyxDQUFDN0MsQ0FBRCxDQVJYO0FBU0gsTUFBQSxVQUFVLEVBQUVxQyxrQkFUVDtBQVVILE1BQUEsU0FBUyxFQUFFckMsQ0FBQyxLQUFLLENBVmQ7QUFXSCxNQUFBLFFBQVEsRUFBRXBGO0FBWFAsTUFBUDtBQWFILEdBZmMsQ0FBZjs7QUFpQkEsUUFBTXdGLFdBQVcsR0FBRyxNQUFPSCxFQUFQLElBQWM7QUFDOUJBLElBQUFBLEVBQUUsQ0FBQ2xDLGNBQUg7QUFDQSxRQUFJbkQsSUFBSixFQUFVO0FBQ1YwRSxJQUFBQSxRQUFRLENBQUMsRUFBRCxDQUFSOztBQUNBLFNBQUssSUFBSVUsQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBRzZDLFNBQVMsQ0FBQ2xMLE1BQTlCLEVBQXNDcUksQ0FBQyxFQUF2QyxFQUEyQztBQUN2QyxZQUFNZ0QsUUFBUSxHQUFHSCxTQUFTLENBQUM3QyxDQUFELENBQTFCO0FBQ0EsWUFBTWlELEtBQUssR0FBRyxNQUFNRCxRQUFRLENBQUMxRixPQUFULENBQWlCNEYsUUFBakIsQ0FBMEI7QUFBRUMsUUFBQUEsVUFBVSxFQUFFO0FBQWQsT0FBMUIsQ0FBcEI7O0FBRUEsVUFBSUYsS0FBSyxLQUFLLEtBQWQsRUFBcUI7QUFBRTtBQUNuQkQsUUFBQUEsUUFBUSxDQUFDMUYsT0FBVCxDQUFpQjhGLEtBQWpCO0FBQ0FKLFFBQUFBLFFBQVEsQ0FBQzFGLE9BQVQsQ0FBaUI0RixRQUFqQixDQUEwQjtBQUFFQyxVQUFBQSxVQUFVLEVBQUUsSUFBZDtBQUFvQkUsVUFBQUEsT0FBTyxFQUFFO0FBQTdCLFNBQTFCO0FBQ0E7QUFDSDtBQUNKOztBQUVEMUksSUFBQUEsT0FBTyxDQUFDLElBQUQsQ0FBUDtBQUNBLFVBQU0ySSxTQUFTLEdBQUdSLGNBQWMsQ0FBQ2hELEdBQWYsQ0FBbUIzRixJQUFJLElBQUlBLElBQUksQ0FBQ29HLElBQUwsRUFBM0IsRUFBd0NDLE1BQXhDLENBQStDQyxPQUEvQyxDQUFsQjs7QUFDQSxRQUFJO0FBQ0EsWUFBTThDLE1BQU0sR0FBRyxNQUFNLHNDQUFxQnRMLEtBQUssQ0FBQ0ksTUFBM0IsRUFBbUNpTCxTQUFuQyxDQUFyQjtBQUVBLFlBQU1FLFdBQVcsR0FBR0MsTUFBTSxDQUFDQyxJQUFQLENBQVlILE1BQU0sQ0FBQ0ksTUFBbkIsRUFBMkJuRCxNQUEzQixDQUFrQ3ZFLENBQUMsSUFBSXNILE1BQU0sQ0FBQ0ksTUFBUCxDQUFjMUgsQ0FBZCxNQUFxQixPQUE1RCxDQUFwQjs7QUFDQSxVQUFJdUgsV0FBVyxDQUFDN0wsTUFBWixHQUFxQixDQUF6QixFQUE0QjtBQUN4QjhKLHVCQUFPbUMsR0FBUCxDQUFXLG1DQUFYLEVBQWdETCxNQUFoRDs7QUFDQWpFLFFBQUFBLFFBQVEsQ0FBQyx5QkFBRyxrRUFBSCxFQUF1RTtBQUM1RXVFLFVBQUFBLFFBQVEsRUFBRUwsV0FBVyxDQUFDTSxJQUFaLENBQWlCLElBQWpCO0FBRGtFLFNBQXZFLENBQUQsQ0FBUjtBQUdILE9BTEQsTUFLTztBQUNIMUUsUUFBQUEsVUFBVTtBQUNiO0FBQ0osS0FaRCxDQVlFLE9BQU8yRSxHQUFQLEVBQVk7QUFDVnRDLHFCQUFPcEMsS0FBUCxDQUFhLG1DQUFiLEVBQWtEMEUsR0FBbEQ7O0FBQ0F6RSxNQUFBQSxRQUFRLENBQUMseUJBQUcsMEZBQUgsQ0FBRCxDQUFSO0FBQ0g7O0FBQ0QzRSxJQUFBQSxPQUFPLENBQUMsS0FBRCxDQUFQO0FBQ0gsR0FsQ0Q7O0FBb0NBLE1BQUkrRyxPQUFPLEdBQUl6QixFQUFELElBQVE7QUFDbEJBLElBQUFBLEVBQUUsQ0FBQ2xDLGNBQUg7QUFDQXFCLElBQUFBLFVBQVU7QUFDYixHQUhEOztBQUlBLE1BQUl1QyxXQUFXLEdBQUcseUJBQUcsY0FBSCxDQUFsQjs7QUFDQSxNQUFJbUIsY0FBYyxDQUFDbEIsSUFBZixDQUFvQnpILElBQUksSUFBSUEsSUFBSSxDQUFDb0csSUFBTCxFQUE1QixDQUFKLEVBQThDO0FBQzFDbUIsSUFBQUEsT0FBTyxHQUFHdEIsV0FBVjtBQUNBdUIsSUFBQUEsV0FBVyxHQUFHL0csSUFBSSxHQUFHLHlCQUFHLGFBQUgsQ0FBSCxHQUF1Qix5QkFBRyxVQUFILENBQXpDO0FBQ0g7O0FBRUQsc0JBQU87QUFBSyxJQUFBLFNBQVMsRUFBQztBQUFmLGtCQUNILHlDQUFNLHlCQUFHLHVCQUFILENBQU4sQ0FERyxlQUVIO0FBQUssSUFBQSxTQUFTLEVBQUM7QUFBZixLQUNNLHlCQUFHLG9FQUFILENBRE4sQ0FGRyxlQU1IO0FBQUssSUFBQSxTQUFTLEVBQUM7QUFBZixLQUNNLHlCQUFHLHNEQUNELHlGQURGLEVBQzZGLEVBRDdGLEVBQ2lHO0FBQy9Gb0osSUFBQUEsQ0FBQyxFQUFFOUgsR0FBRyxpQkFBSSx3Q0FBS0EsR0FBTCxDQURxRjtBQUUvRitILElBQUFBLElBQUksRUFBRSxtQkFBTTtBQUFHLE1BQUEsSUFBSSxFQUFDLHlCQUFSO0FBQWtDLE1BQUEsR0FBRyxFQUFDLHFCQUF0QztBQUE0RCxNQUFBLE1BQU0sRUFBQztBQUFuRTtBQUZtRixHQURqRyxDQUROLENBTkcsRUFnQkQ1RSxLQUFLLGlCQUFJO0FBQUssSUFBQSxTQUFTLEVBQUM7QUFBZixLQUE4Q0EsS0FBOUMsQ0FoQlIsZUFpQkg7QUFBTSxJQUFBLFFBQVEsRUFBRXFDLE9BQWhCO0FBQXlCLElBQUEsRUFBRSxFQUFDO0FBQTVCLEtBQ00vQixNQUROLENBakJHLGVBcUJIO0FBQUssSUFBQSxTQUFTLEVBQUM7QUFBZixrQkFDSSw2QkFBQyx5QkFBRDtBQUNJLElBQUEsU0FBUyxFQUFDLHFEQURkO0FBRUksSUFBQSxPQUFPLEVBQUUsTUFBTSxzQ0FBcUIxSCxLQUFLLENBQUNJLE1BQTNCO0FBRm5CLEtBSU0seUJBQUcsb0JBQUgsQ0FKTixDQURKLENBckJHLGVBOEJIO0FBQUssSUFBQSxTQUFTLEVBQUM7QUFBZixrQkFDSSw2QkFBQyx5QkFBRDtBQUNJLElBQUEsSUFBSSxFQUFDLFNBRFQ7QUFFSSxJQUFBLFFBQVEsRUFBRXVDLElBRmQ7QUFHSSxJQUFBLE9BQU8sRUFBRThHLE9BSGI7QUFJSSxJQUFBLE9BQU8sRUFBQyxPQUpaO0FBS0ksSUFBQSxJQUFJLEVBQUMsUUFMVDtBQU1JLElBQUEsSUFBSSxFQUFDLDRCQU5UO0FBT0ksSUFBQSxLQUFLLEVBQUVDO0FBUFgsSUFESixDQTlCRyxDQUFQO0FBMENILENBL0dEOztBQWlIZSxNQUFNdUMsYUFBTixTQUE0QkMsZUFBTUMsYUFBbEMsQ0FBZ0U7QUFPM0VDLEVBQUFBLFdBQVcsQ0FBQ0MsS0FBRCxFQUFRQyxPQUFSLEVBQWlCO0FBQUE7O0FBQ3hCLFVBQU1ELEtBQU4sRUFBYUMsT0FBYjtBQUR3QjtBQUFBO0FBQUE7QUFBQSwwREE4QkgsQ0FBQ2hOLElBQUQsRUFBYWlELFlBQWIsS0FBc0M7QUFDM0QsVUFBSWpELElBQUksQ0FBQ2MsTUFBTCxLQUFnQixLQUFLaU0sS0FBTCxDQUFXck0sS0FBWCxDQUFpQkksTUFBckMsRUFBNkM7QUFDekMsYUFBS21NLFFBQUwsQ0FBYztBQUFFaEssVUFBQUE7QUFBRixTQUFkO0FBQ0g7QUFDSixLQWxDMkI7QUFBQSxtRUFvQ00sTUFBTTtBQUNwQyxXQUFLZ0ssUUFBTCxDQUFjO0FBQ1ZDLFFBQUFBLGNBQWMsRUFBRUMseUJBQWdCQyxpQkFBaEIsR0FBb0NDO0FBRDFDLE9BQWQ7QUFHSCxLQXhDMkI7QUFBQSxvREEwQ1JuSyxPQUFELElBQTRCO0FBQzNDLFVBQUlBLE9BQU8sQ0FBQ3pCLE1BQVIsS0FBbUIsV0FBbkIsSUFBa0N5QixPQUFPLENBQUNjLE9BQVIsS0FBb0IsS0FBSytJLEtBQUwsQ0FBV3JNLEtBQVgsQ0FBaUJJLE1BQTNFLEVBQW1GO0FBQy9FLGFBQUttTSxRQUFMLENBQWM7QUFBRXJMLFVBQUFBLEtBQUssRUFBRTlCLEtBQUssQ0FBQ3dOO0FBQWYsU0FBZDtBQUNBO0FBQ0g7O0FBRUQsVUFBSXBLLE9BQU8sQ0FBQ3pCLE1BQVIsS0FBbUJDLGdCQUFPNkwsUUFBMUIsSUFBc0NySyxPQUFPLENBQUN6QixNQUFSLEtBQW1CLGtCQUE3RCxFQUFpRjs7QUFFakYsVUFBSXlCLE9BQU8sQ0FBQ3pCLE1BQVIsS0FBbUJDLGdCQUFPNkwsUUFBMUIsSUFBc0NySyxPQUFPLENBQUNtQixNQUFsRCxFQUEwRDtBQUN0RDlDLDRCQUFrQkMsUUFBbEIsQ0FBc0Q7QUFDbERDLFVBQUFBLE1BQU0sRUFBRUMsZ0JBQU9DLGtCQURtQztBQUVsREMsVUFBQUEsS0FBSyxFQUFFQyx3Q0FBaUIyTCxlQUYwQjtBQUdsRHpMLFVBQUFBLFlBQVksRUFBRTtBQUNWckIsWUFBQUEsS0FBSyxFQUFFLEtBQUtxTSxLQUFMLENBQVdyTSxLQURSO0FBRVYyRCxZQUFBQSxNQUFNLEVBQUVuQixPQUFPLENBQUNtQjtBQUZOO0FBSG9DLFNBQXREO0FBUUgsT0FURCxNQVNPLElBQUluQixPQUFPLENBQUN6QixNQUFSLEtBQW1CLGtCQUFuQixJQUF5Q3lCLE9BQU8sQ0FBQ3VLLEtBQXJELEVBQTREO0FBQy9EbE0sNEJBQWtCQyxRQUFsQixDQUFzRDtBQUNsREMsVUFBQUEsTUFBTSxFQUFFQyxnQkFBT0Msa0JBRG1DO0FBRWxEQyxVQUFBQSxLQUFLLEVBQUVDLHdDQUFpQjZMLG1CQUYwQjtBQUdsRDNMLFVBQUFBLFlBQVksRUFBRTtBQUNWckIsWUFBQUEsS0FBSyxFQUFFLEtBQUtxTSxLQUFMLENBQVdyTSxLQURSO0FBRVYrTSxZQUFBQSxLQUFLLEVBQUV2SyxPQUFPLENBQUN1SztBQUZMO0FBSG9DLFNBQXREO0FBUUgsT0FUTSxNQVNBO0FBQ0hsTSw0QkFBa0JDLFFBQWxCLENBQXNEO0FBQ2xEQyxVQUFBQSxNQUFNLEVBQUVDLGdCQUFPQyxrQkFEbUM7QUFFbERDLFVBQUFBLEtBQUssRUFBRUMsd0NBQWlCOEwsZUFGMEI7QUFHbEQ1TCxVQUFBQSxZQUFZLEVBQUU7QUFBRXJCLFlBQUFBLEtBQUssRUFBRSxLQUFLcU0sS0FBTCxDQUFXck07QUFBcEI7QUFIb0MsU0FBdEQ7QUFLSDtBQUNKLEtBM0UyQjtBQUFBLHlEQTZFSixZQUFZO0FBQ2hDLFVBQUksS0FBS08sS0FBTCxDQUFXMkosV0FBZixFQUE0QjtBQUN4QnJKLDRCQUFrQkMsUUFBbEIsQ0FBMkI7QUFDdkJDLFVBQUFBLE1BQU0sRUFBRSxXQURlO0FBRXZCdUMsVUFBQUEsT0FBTyxFQUFFLEtBQUsvQyxLQUFMLENBQVcySjtBQUZHLFNBQTNCOztBQUlBO0FBQ0g7O0FBRUQsV0FBS3FDLFFBQUwsQ0FBYztBQUFFckwsUUFBQUEsS0FBSyxFQUFFOUIsS0FBSyxDQUFDd047QUFBZixPQUFkO0FBQ0gsS0F2RjJCO0FBR3hCLFFBQUkxTCxLQUFLLEdBQUc5QixLQUFLLENBQUN3TixPQUFsQjtBQUVBLFNBQUtNLE9BQUwsNEJBQWUsS0FBS2IsS0FBTCxDQUFXck0sS0FBWCxDQUFpQnFFLFlBQWpCLENBQThCQyxjQUE5QixDQUE2Q0MsaUJBQVVDLFVBQXZELEVBQW1FLEVBQW5FLENBQWYsMERBQWUsc0JBQXdFWixTQUF4RSxFQUFmO0FBQ0EsVUFBTXVKLFNBQVMsR0FBRyxLQUFLZCxLQUFMLENBQVdwQyxlQUFYLElBQThCLEtBQUtxQyxPQUFMLENBQWE3SSxTQUFiLE9BQTZCLEtBQUt5SixPQUFsRjs7QUFFQSxRQUFJQyxTQUFKLEVBQWU7QUFDWGpNLE1BQUFBLEtBQUssR0FBRyxLQUFLbUwsS0FBTCxDQUFXcEMsZUFBWCxDQUEyQnJCLFVBQTNCLENBQXNDQyxNQUF0QyxLQUFpREMsaUJBQU9DLFVBQXhELEdBQ0YzSixLQUFLLENBQUNnTyxpQkFESixHQUN3QmhPLEtBQUssQ0FBQ2lPLFlBRHRDO0FBRUg7O0FBRUQsU0FBSzlNLEtBQUwsR0FBYTtBQUNUVyxNQUFBQSxLQURTO0FBRVRzTCxNQUFBQSxjQUFjLEVBQUVDLHlCQUFnQkMsaUJBQWhCLEdBQW9DQyxhQUYzQztBQUdUcEssTUFBQUEsWUFBWSxFQUFFLEtBQUs4SixLQUFMLENBQVdyTSxLQUFYLENBQWlCRixlQUFqQjtBQUhMLEtBQWI7QUFNQSxTQUFLd04sYUFBTCxHQUFxQnpNLG9CQUFrQjBNLFFBQWxCLENBQTJCLEtBQUtDLFFBQWhDLENBQXJCO0FBQ0EsU0FBS0Msb0JBQUwsR0FBNEJoQix5QkFBZ0JDLGlCQUFoQixHQUFvQ2dCLFdBQXBDLENBQWdELEtBQUtDLHVCQUFyRCxDQUE1QjtBQUNBLFNBQUtyQixPQUFMLENBQWFzQixFQUFiLENBQWdCLG1CQUFoQixFQUFxQyxLQUFLQyxjQUExQztBQUNIOztBQUVEQyxFQUFBQSxvQkFBb0IsR0FBRztBQUNuQmpOLHdCQUFrQmtOLFVBQWxCLENBQTZCLEtBQUtULGFBQWxDOztBQUNBLFNBQUtHLG9CQUFMLENBQTBCTyxNQUExQjtBQUNBLFNBQUsxQixPQUFMLENBQWEyQixHQUFiLENBQWlCLG1CQUFqQixFQUFzQyxLQUFLSixjQUEzQztBQUNIOztBQTZET0ssRUFBQUEsVUFBVSxHQUFHO0FBQUE7O0FBQ2pCLFlBQVEsS0FBSzNOLEtBQUwsQ0FBV1csS0FBbkI7QUFDSSxXQUFLOUIsS0FBSyxDQUFDd04sT0FBWDtBQUNJLFlBQUksS0FBS3JNLEtBQUwsQ0FBV2dDLFlBQVgsS0FBNEIsTUFBNUIsSUFBc0NNLG9CQUFXRCxhQUFyRCxFQUFvRTtBQUNoRSw4QkFBTyw2QkFBQyxZQUFEO0FBQWMsWUFBQSxLQUFLLEVBQUUsS0FBS3lKLEtBQUwsQ0FBV3JNO0FBQWhDLFlBQVA7QUFDSCxTQUZELE1BRU87QUFDSCw4QkFBTyw2QkFBQyxZQUFEO0FBQ0gsWUFBQSxLQUFLLEVBQUUsS0FBS3FNLEtBQUwsQ0FBV3JNLEtBRGY7QUFFSCxZQUFBLG1CQUFtQixFQUFFLEtBQUtxTSxLQUFMLENBQVdoSyxtQkFGN0I7QUFHSCxZQUFBLHFCQUFxQixFQUFFLEtBQUtnSyxLQUFMLENBQVcvSjtBQUgvQixZQUFQO0FBS0g7O0FBQ0wsV0FBS2xELEtBQUssQ0FBQ2dPLGlCQUFYO0FBQ0ksNEJBQU8sNkJBQUMsb0JBQUQ7QUFDSCxVQUFBLEtBQUssRUFBRSxLQUFLZixLQUFMLENBQVdyTSxLQURmO0FBRUgsVUFBQSxLQUFLLEVBQUUseUJBQUcsNERBQUgsRUFBaUU7QUFDcEVrRSxZQUFBQSxTQUFTLEVBQUUsK0JBQUttSSxLQUFMLENBQVdwQyxlQUFYLDBHQUE0QnJCLFVBQTVCLGtGQUF3QzFHLElBQXhDLEtBQWdELEtBQUttSyxLQUFMLENBQVdyTSxLQUFYLENBQWlCa0M7QUFEUixXQUFqRSxDQUZKO0FBS0gsVUFBQSxXQUFXLEVBQ1AseUJBQUcsdUNBQUgsSUFBOEMsSUFBOUMsR0FDQSx5QkFBRyw4REFBSCxDQVBEO0FBU0gsVUFBQSxVQUFVLEVBQUdnSSxXQUFELElBQXlCLEtBQUtxQyxRQUFMLENBQWM7QUFBRXJMLFlBQUFBLEtBQUssRUFBRTlCLEtBQUssQ0FBQytPLFdBQWY7QUFBNEJqRSxZQUFBQTtBQUE1QixXQUFkO0FBVGxDLFVBQVA7O0FBV0osV0FBSzlLLEtBQUssQ0FBQytPLFdBQVg7QUFDSSw0QkFBTyw2QkFBQyxxQkFBRDtBQUNILFVBQUEsZUFBZSxFQUFFLEtBQUs5QixLQUFMLENBQVdwQyxlQUR6QjtBQUVILFVBQUEsS0FBSyxFQUFFLEtBQUtvQyxLQUFMLENBQVdyTSxLQUZmO0FBR0gsVUFBQSxVQUFVLEVBQUUsS0FBS29PLGFBSGQ7QUFJSCxVQUFBLFdBQVcsRUFBRSxLQUFLN04sS0FBTCxDQUFXMko7QUFKckIsVUFBUDs7QUFPSixXQUFLOUssS0FBSyxDQUFDaU8sWUFBWDtBQUNJLDRCQUFPLDZCQUFDLHNCQUFEO0FBQ0gsVUFBQSxLQUFLLEVBQUUsS0FBS2hCLEtBQUwsQ0FBV3JNLEtBRGY7QUFFSCxVQUFBLGVBQWUsRUFBRSxLQUFLcU0sS0FBTCxDQUFXcEMsZUFGekI7QUFHSCxVQUFBLFVBQVUsRUFBR29FLE1BQUQsSUFBcUI7QUFDN0IsaUJBQUs5QixRQUFMLENBQWM7QUFBRXJMLGNBQUFBLEtBQUssRUFBRW1OLE1BQU0sR0FBR2pQLEtBQUssQ0FBQ2tQLGtCQUFULEdBQThCbFAsS0FBSyxDQUFDbVA7QUFBbkQsYUFBZDtBQUNIO0FBTEUsVUFBUDs7QUFPSixXQUFLblAsS0FBSyxDQUFDb1AsYUFBWDtBQUNJLDRCQUFPLDZCQUFDLHVCQUFEO0FBQ0gsVUFBQSxLQUFLLEVBQUUsS0FBS25DLEtBQUwsQ0FBV3JNLEtBRGY7QUFFSCxVQUFBLFVBQVUsRUFBRSxNQUFNLEtBQUt1TSxRQUFMLENBQWM7QUFBRXJMLFlBQUFBLEtBQUssRUFBRTlCLEtBQUssQ0FBQ3dOO0FBQWYsV0FBZDtBQUZmLFVBQVA7O0FBSUosV0FBS3hOLEtBQUssQ0FBQ2tQLGtCQUFYO0FBQ0ksNEJBQU8sNkJBQUMsb0JBQUQ7QUFDSCxVQUFBLEtBQUssRUFBRSxLQUFLakMsS0FBTCxDQUFXck0sS0FEZjtBQUVILFVBQUEsS0FBSyxFQUFFLHlCQUFHLHlDQUFILENBRko7QUFHSCxVQUFBLFdBQVcsRUFBRSx5QkFBRywwQ0FDWiw4REFEUyxDQUhWO0FBS0gsVUFBQSxVQUFVLEVBQUdrSyxXQUFELElBQXlCLEtBQUtxQyxRQUFMLENBQWM7QUFBRXJMLFlBQUFBLEtBQUssRUFBRTlCLEtBQUssQ0FBQ29QLGFBQWY7QUFBOEJ0RSxZQUFBQTtBQUE5QixXQUFkO0FBTGxDLFVBQVA7O0FBT0osV0FBSzlLLEtBQUssQ0FBQ21QLG9CQUFYO0FBQ0ksNEJBQU8sNkJBQUMscUJBQUQ7QUFDSCxVQUFBLEtBQUssRUFBRSxLQUFLbEMsS0FBTCxDQUFXck0sS0FEZjtBQUVILFVBQUEsVUFBVSxFQUFFLE1BQU0sS0FBS3VNLFFBQUwsQ0FBYztBQUFFckwsWUFBQUEsS0FBSyxFQUFFOUIsS0FBSyxDQUFDd047QUFBZixXQUFkO0FBRmYsVUFBUDtBQXJEUjtBQTBESDs7QUFFRDZCLEVBQUFBLE1BQU0sR0FBRztBQUNMLFVBQU1DLFVBQVUsR0FBRyxLQUFLbk8sS0FBTCxDQUFXaU0sY0FBWCxJQUE2QixLQUFLak0sS0FBTCxDQUFXVyxLQUFYLEtBQXFCOUIsS0FBSyxDQUFDd04sT0FBeEQsZ0JBQ2IsNkJBQUMsbUJBQUQ7QUFBWSxNQUFBLElBQUksRUFBRSxLQUFLUCxLQUFMLENBQVdyTSxLQUE3QjtBQUFvQyxNQUFBLGNBQWMsRUFBRSxLQUFLcU0sS0FBTCxDQUFXc0M7QUFBL0QsTUFEYSxHQUViLElBRk47QUFJQSx3QkFBTztBQUFNLE1BQUEsU0FBUyxFQUFDO0FBQWhCLG9CQUNILDZCQUFDLHNCQUFELHFCQUNJLDZCQUFDLGtCQUFEO0FBQVcsTUFBQSxLQUFLLEVBQUVELFVBQWxCO0FBQThCLE1BQUEsY0FBYyxFQUFFLEtBQUtyQyxLQUFMLENBQVdzQztBQUF6RCxPQUNNLEtBQUtULFVBQUwsRUFETixDQURKLENBREcsQ0FBUDtBQU9IOztBQXpLMEU7Ozs4QkFBMURqQyxhLGlCQUNJbkssNEIiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuQ29weXJpZ2h0IDIwMjEgVGhlIE1hdHJpeC5vcmcgRm91bmRhdGlvbiBDLkkuQy5cblxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbnlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbllvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuXG4gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cblVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbmRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxubGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4qL1xuXG5pbXBvcnQgUmVhY3QsIHsgUmVmT2JqZWN0LCB1c2VDb250ZXh0LCB1c2VSZWYsIHVzZVN0YXRlIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBFdmVudFR5cGUgfSBmcm9tIFwibWF0cml4LWpzLXNkay9zcmMvQHR5cGVzL2V2ZW50XCI7XG5pbXBvcnQgeyBKb2luUnVsZSwgUHJlc2V0IH0gZnJvbSBcIm1hdHJpeC1qcy1zZGsvc3JjL0B0eXBlcy9wYXJ0aWFsc1wiO1xuaW1wb3J0IHsgUm9vbSB9IGZyb20gXCJtYXRyaXgtanMtc2RrL3NyYy9tb2RlbHMvcm9vbVwiO1xuaW1wb3J0IHsgRXZlbnRTdWJzY3JpcHRpb24gfSBmcm9tIFwiZmJlbWl0dGVyXCI7XG5cbmltcG9ydCBNYXRyaXhDbGllbnRDb250ZXh0IGZyb20gXCIuLi8uLi9jb250ZXh0cy9NYXRyaXhDbGllbnRDb250ZXh0XCI7XG5pbXBvcnQgUm9vbUF2YXRhciBmcm9tIFwiLi4vdmlld3MvYXZhdGFycy9Sb29tQXZhdGFyXCI7XG5pbXBvcnQgeyBfdCB9IGZyb20gXCIuLi8uLi9sYW5ndWFnZUhhbmRsZXJcIjtcbmltcG9ydCBBY2Nlc3NpYmxlQnV0dG9uIGZyb20gXCIuLi92aWV3cy9lbGVtZW50cy9BY2Nlc3NpYmxlQnV0dG9uXCI7XG5pbXBvcnQgUm9vbU5hbWUgZnJvbSBcIi4uL3ZpZXdzL2VsZW1lbnRzL1Jvb21OYW1lXCI7XG5pbXBvcnQgUm9vbVRvcGljIGZyb20gXCIuLi92aWV3cy9lbGVtZW50cy9Sb29tVG9waWNcIjtcbmltcG9ydCBJbmxpbmVTcGlubmVyIGZyb20gXCIuLi92aWV3cy9lbGVtZW50cy9JbmxpbmVTcGlubmVyXCI7XG5pbXBvcnQgeyBpbnZpdGVNdWx0aXBsZVRvUm9vbSwgc2hvd1Jvb21JbnZpdGVEaWFsb2cgfSBmcm9tIFwiLi4vLi4vUm9vbUludml0ZVwiO1xuaW1wb3J0IHsgdXNlUm9vbU1lbWJlcnMgfSBmcm9tIFwiLi4vLi4vaG9va3MvdXNlUm9vbU1lbWJlcnNcIjtcbmltcG9ydCBjcmVhdGVSb29tLCB7IElPcHRzIH0gZnJvbSBcIi4uLy4uL2NyZWF0ZVJvb21cIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vdmlld3MvZWxlbWVudHMvRmllbGRcIjtcbmltcG9ydCB7IHVzZUV2ZW50RW1pdHRlciB9IGZyb20gXCIuLi8uLi9ob29rcy91c2VFdmVudEVtaXR0ZXJcIjtcbmltcG9ydCB3aXRoVmFsaWRhdGlvbiBmcm9tIFwiLi4vdmlld3MvZWxlbWVudHMvVmFsaWRhdGlvblwiO1xuaW1wb3J0ICogYXMgRW1haWwgZnJvbSBcIi4uLy4uL2VtYWlsXCI7XG5pbXBvcnQgZGVmYXVsdERpc3BhdGNoZXIgZnJvbSBcIi4uLy4uL2Rpc3BhdGNoZXIvZGlzcGF0Y2hlclwiO1xuaW1wb3J0IGRpcyBmcm9tIFwiLi4vLi4vZGlzcGF0Y2hlci9kaXNwYXRjaGVyXCI7XG5pbXBvcnQgeyBBY3Rpb24gfSBmcm9tIFwiLi4vLi4vZGlzcGF0Y2hlci9hY3Rpb25zXCI7XG5pbXBvcnQgUmVzaXplTm90aWZpZXIgZnJvbSBcIi4uLy4uL3V0aWxzL1Jlc2l6ZU5vdGlmaWVyXCI7XG5pbXBvcnQgTWFpblNwbGl0IGZyb20gJy4vTWFpblNwbGl0JztcbmltcG9ydCBFcnJvckJvdW5kYXJ5IGZyb20gXCIuLi92aWV3cy9lbGVtZW50cy9FcnJvckJvdW5kYXJ5XCI7XG5pbXBvcnQgeyBBY3Rpb25QYXlsb2FkIH0gZnJvbSBcIi4uLy4uL2Rpc3BhdGNoZXIvcGF5bG9hZHNcIjtcbmltcG9ydCBSaWdodFBhbmVsIGZyb20gXCIuL1JpZ2h0UGFuZWxcIjtcbmltcG9ydCBSaWdodFBhbmVsU3RvcmUgZnJvbSBcIi4uLy4uL3N0b3Jlcy9SaWdodFBhbmVsU3RvcmVcIjtcbmltcG9ydCB7IFJpZ2h0UGFuZWxQaGFzZXMgfSBmcm9tIFwiLi4vLi4vc3RvcmVzL1JpZ2h0UGFuZWxTdG9yZVBoYXNlc1wiO1xuaW1wb3J0IHsgU2V0UmlnaHRQYW5lbFBoYXNlUGF5bG9hZCB9IGZyb20gXCIuLi8uLi9kaXNwYXRjaGVyL3BheWxvYWRzL1NldFJpZ2h0UGFuZWxQaGFzZVBheWxvYWRcIjtcbmltcG9ydCB7IHVzZVN0YXRlQXJyYXkgfSBmcm9tIFwiLi4vLi4vaG9va3MvdXNlU3RhdGVBcnJheVwiO1xuaW1wb3J0IFNwYWNlUHVibGljU2hhcmUgZnJvbSBcIi4uL3ZpZXdzL3NwYWNlcy9TcGFjZVB1YmxpY1NoYXJlXCI7XG5pbXBvcnQge1xuICAgIHNob3VsZFNob3dTcGFjZVNldHRpbmdzLFxuICAgIHNob3dBZGRFeGlzdGluZ1Jvb21zLFxuICAgIHNob3dDcmVhdGVOZXdSb29tLFxuICAgIHNob3dDcmVhdGVOZXdTdWJzcGFjZSxcbiAgICBzaG93U3BhY2VJbnZpdGUsXG4gICAgc2hvd1NwYWNlU2V0dGluZ3MsXG59IGZyb20gXCIuLi8uLi91dGlscy9zcGFjZVwiO1xuaW1wb3J0IFNwYWNlSGllcmFyY2h5LCB7IHNob3dSb29tIH0gZnJvbSBcIi4vU3BhY2VIaWVyYXJjaHlcIjtcbmltcG9ydCBNZW1iZXJBdmF0YXIgZnJvbSBcIi4uL3ZpZXdzL2F2YXRhcnMvTWVtYmVyQXZhdGFyXCI7XG5pbXBvcnQgU3BhY2VTdG9yZSBmcm9tIFwiLi4vLi4vc3RvcmVzL3NwYWNlcy9TcGFjZVN0b3JlXCI7XG5pbXBvcnQgRmFjZVBpbGUgZnJvbSBcIi4uL3ZpZXdzL2VsZW1lbnRzL0ZhY2VQaWxlXCI7XG5pbXBvcnQge1xuICAgIEFkZEV4aXN0aW5nVG9TcGFjZSxcbiAgICBkZWZhdWx0RG1zUmVuZGVyZXIsXG4gICAgZGVmYXVsdFJvb21zUmVuZGVyZXIsXG4gICAgZGVmYXVsdFNwYWNlc1JlbmRlcmVyLFxufSBmcm9tIFwiLi4vdmlld3MvZGlhbG9ncy9BZGRFeGlzdGluZ1RvU3BhY2VEaWFsb2dcIjtcbmltcG9ydCB7IENoZXZyb25GYWNlLCBDb250ZXh0TWVudUJ1dHRvbiwgdXNlQ29udGV4dE1lbnUgfSBmcm9tIFwiLi9Db250ZXh0TWVudVwiO1xuaW1wb3J0IEljb25pemVkQ29udGV4dE1lbnUsIHtcbiAgICBJY29uaXplZENvbnRleHRNZW51T3B0aW9uLFxuICAgIEljb25pemVkQ29udGV4dE1lbnVPcHRpb25MaXN0LFxufSBmcm9tIFwiLi4vdmlld3MvY29udGV4dF9tZW51cy9JY29uaXplZENvbnRleHRNZW51XCI7XG5pbXBvcnQgQWNjZXNzaWJsZVRvb2x0aXBCdXR0b24gZnJvbSBcIi4uL3ZpZXdzL2VsZW1lbnRzL0FjY2Vzc2libGVUb29sdGlwQnV0dG9uXCI7XG5pbXBvcnQgeyBCZXRhUGlsbCB9IGZyb20gXCIuLi92aWV3cy9iZXRhL0JldGFDYXJkXCI7XG5pbXBvcnQgeyBVc2VyVGFiIH0gZnJvbSBcIi4uL3ZpZXdzL2RpYWxvZ3MvVXNlclNldHRpbmdzRGlhbG9nXCI7XG5pbXBvcnQgeyBFZmZlY3RpdmVNZW1iZXJzaGlwLCBnZXRFZmZlY3RpdmVNZW1iZXJzaGlwIH0gZnJvbSBcIi4uLy4uL3V0aWxzL21lbWJlcnNoaXBcIjtcbmltcG9ydCB7IFNwYWNlRmVlZGJhY2tQcm9tcHQgfSBmcm9tIFwiLi4vdmlld3Mvc3BhY2VzL1NwYWNlQ3JlYXRlTWVudVwiO1xuaW1wb3J0IHsgQ3JlYXRlRXZlbnRGaWVsZCwgSUdyb3VwU3VtbWFyeSB9IGZyb20gXCIuLi92aWV3cy9kaWFsb2dzL0NyZWF0ZVNwYWNlRnJvbUNvbW11bml0eURpYWxvZ1wiO1xuaW1wb3J0IHsgdXNlQXN5bmNNZW1vIH0gZnJvbSBcIi4uLy4uL2hvb2tzL3VzZUFzeW5jTWVtb1wiO1xuaW1wb3J0IFNwaW5uZXIgZnJvbSBcIi4uL3ZpZXdzL2VsZW1lbnRzL1NwaW5uZXJcIjtcbmltcG9ydCBHcm91cEF2YXRhciBmcm9tIFwiLi4vdmlld3MvYXZhdGFycy9Hcm91cEF2YXRhclwiO1xuaW1wb3J0IHsgdXNlRGlzcGF0Y2hlciB9IGZyb20gXCIuLi8uLi9ob29rcy91c2VEaXNwYXRjaGVyXCI7XG5pbXBvcnQgeyB1c2VSb29tU3RhdGUgfSBmcm9tIFwiLi4vLi4vaG9va3MvdXNlUm9vbVN0YXRlXCI7XG5cbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gXCJtYXRyaXgtanMtc2RrL3NyYy9sb2dnZXJcIjtcbmltcG9ydCB7IHNob3VsZFNob3dDb21wb25lbnQgfSBmcm9tIFwiLi4vLi4vY3VzdG9taXNhdGlvbnMvaGVscGVycy9VSUNvbXBvbmVudHNcIjtcbmltcG9ydCB7IFVJQ29tcG9uZW50IH0gZnJvbSBcIi4uLy4uL3NldHRpbmdzL1VJRmVhdHVyZVwiO1xuXG5pbnRlcmZhY2UgSVByb3BzIHtcbiAgICBzcGFjZTogUm9vbTtcbiAgICBqdXN0Q3JlYXRlZE9wdHM/OiBJT3B0cztcbiAgICByZXNpemVOb3RpZmllcjogUmVzaXplTm90aWZpZXI7XG4gICAgb25Kb2luQnV0dG9uQ2xpY2tlZCgpOiB2b2lkO1xuICAgIG9uUmVqZWN0QnV0dG9uQ2xpY2tlZCgpOiB2b2lkO1xufVxuXG5pbnRlcmZhY2UgSVN0YXRlIHtcbiAgICBwaGFzZTogUGhhc2U7XG4gICAgZmlyc3RSb29tSWQ/OiBzdHJpbmc7IC8vIGludGVybmFsIHN0YXRlIGZvciB0aGUgY3JlYXRpb24gd2l6YXJkXG4gICAgc2hvd1JpZ2h0UGFuZWw6IGJvb2xlYW47XG4gICAgbXlNZW1iZXJzaGlwOiBzdHJpbmc7XG59XG5cbmVudW0gUGhhc2Uge1xuICAgIExhbmRpbmcsXG4gICAgUHVibGljQ3JlYXRlUm9vbXMsXG4gICAgUHVibGljU2hhcmUsXG4gICAgUHJpdmF0ZVNjb3BlLFxuICAgIFByaXZhdGVJbnZpdGUsXG4gICAgUHJpdmF0ZUNyZWF0ZVJvb21zLFxuICAgIFByaXZhdGVFeGlzdGluZ1Jvb21zLFxufVxuXG5jb25zdCBSb29tTWVtYmVyQ291bnQgPSAoeyByb29tLCBjaGlsZHJlbiB9KSA9PiB7XG4gICAgY29uc3QgbWVtYmVycyA9IHVzZVJvb21NZW1iZXJzKHJvb20pO1xuICAgIGNvbnN0IGNvdW50ID0gbWVtYmVycy5sZW5ndGg7XG5cbiAgICBpZiAoY2hpbGRyZW4pIHJldHVybiBjaGlsZHJlbihjb3VudCk7XG4gICAgcmV0dXJuIGNvdW50O1xufTtcblxuY29uc3QgdXNlTXlSb29tTWVtYmVyc2hpcCA9IChyb29tOiBSb29tKSA9PiB7XG4gICAgY29uc3QgW21lbWJlcnNoaXAsIHNldE1lbWJlcnNoaXBdID0gdXNlU3RhdGUocm9vbS5nZXRNeU1lbWJlcnNoaXAoKSk7XG4gICAgdXNlRXZlbnRFbWl0dGVyKHJvb20sIFwiUm9vbS5teU1lbWJlcnNoaXBcIiwgKCkgPT4ge1xuICAgICAgICBzZXRNZW1iZXJzaGlwKHJvb20uZ2V0TXlNZW1iZXJzaGlwKCkpO1xuICAgIH0pO1xuICAgIHJldHVybiBtZW1iZXJzaGlwO1xufTtcblxuY29uc3QgU3BhY2VJbmZvID0gKHsgc3BhY2UgfTogeyBzcGFjZTogUm9vbSB9KSA9PiB7XG4gICAgLy8gc3VtbWFyeSB3aWxsIGJlZ2luIGFzIHVuZGVmaW5lZCB3aGlsc3QgbG9hZGluZyBhbmQgZ28gbnVsbCBpZiBpdCBmYWlscyB0byBsb2FkLlxuICAgIGNvbnN0IHN1bW1hcnkgPSB1c2VBc3luY01lbW8oYXN5bmMgKCkgPT4ge1xuICAgICAgICBpZiAoc3BhY2UuZ2V0TXlNZW1iZXJzaGlwKCkgIT09IFwiaW52aXRlXCIpIHJldHVybjtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBzcGFjZS5jbGllbnQuZ2V0Um9vbVN1bW1hcnkoc3BhY2Uucm9vbUlkKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9LCBbc3BhY2VdKTtcbiAgICBjb25zdCBqb2luUnVsZSA9IHVzZVJvb21TdGF0ZShzcGFjZSwgc3RhdGUgPT4gc3RhdGUuZ2V0Sm9pblJ1bGUoKSk7XG4gICAgY29uc3QgbWVtYmVyc2hpcCA9IHVzZU15Um9vbU1lbWJlcnNoaXAoc3BhY2UpO1xuXG4gICAgbGV0IHZpc2liaWxpdHlTZWN0aW9uO1xuICAgIGlmIChqb2luUnVsZSA9PT0gXCJwdWJsaWNcIikge1xuICAgICAgICB2aXNpYmlsaXR5U2VjdGlvbiA9IDxzcGFuIGNsYXNzTmFtZT1cIm14X1NwYWNlUm9vbVZpZXdfaW5mb19wdWJsaWNcIj5cbiAgICAgICAgICAgIHsgX3QoXCJQdWJsaWMgc3BhY2VcIikgfVxuICAgICAgICA8L3NwYW4+O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZpc2liaWxpdHlTZWN0aW9uID0gPHNwYW4gY2xhc3NOYW1lPVwibXhfU3BhY2VSb29tVmlld19pbmZvX3ByaXZhdGVcIj5cbiAgICAgICAgICAgIHsgX3QoXCJQcml2YXRlIHNwYWNlXCIpIH1cbiAgICAgICAgPC9zcGFuPjtcbiAgICB9XG5cbiAgICBsZXQgbWVtYmVyU2VjdGlvbjtcbiAgICBpZiAobWVtYmVyc2hpcCA9PT0gXCJpbnZpdGVcIiAmJiBzdW1tYXJ5KSB7XG4gICAgICAgIC8vIERvbid0IHRydXN0IGxvY2FsIHN0YXRlIGFuZCBpbnN0ZWFkIHVzZSB0aGUgc3VtbWFyeSBBUElcbiAgICAgICAgbWVtYmVyU2VjdGlvbiA9IDxzcGFuIGNsYXNzTmFtZT1cIm14X1NwYWNlUm9vbVZpZXdfaW5mb19tZW1iZXJDb3VudFwiPlxuICAgICAgICAgICAgeyBfdChcIiUoY291bnQpcyBtZW1iZXJzXCIsIHsgY291bnQ6IHN1bW1hcnkubnVtX2pvaW5lZF9tZW1iZXJzIH0pIH1cbiAgICAgICAgPC9zcGFuPjtcbiAgICB9IGVsc2UgaWYgKHN1bW1hcnkgIT09IHVuZGVmaW5lZCkgeyAvLyBzdW1tYXJ5IGlzIG5vdCBzdGlsbCBsb2FkaW5nXG4gICAgICAgIG1lbWJlclNlY3Rpb24gPSA8Um9vbU1lbWJlckNvdW50IHJvb209e3NwYWNlfT5cbiAgICAgICAgICAgIHsgKGNvdW50KSA9PiBjb3VudCA+IDAgPyAoXG4gICAgICAgICAgICAgICAgPEFjY2Vzc2libGVCdXR0b25cbiAgICAgICAgICAgICAgICAgICAga2luZD1cImxpbmtcIlxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJteF9TcGFjZVJvb21WaWV3X2luZm9fbWVtYmVyQ291bnRcIlxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0RGlzcGF0Y2hlci5kaXNwYXRjaDxTZXRSaWdodFBhbmVsUGhhc2VQYXlsb2FkPih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBBY3Rpb24uU2V0UmlnaHRQYW5lbFBoYXNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBoYXNlOiBSaWdodFBhbmVsUGhhc2VzLlJvb21NZW1iZXJMaXN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmlyZVBhcmFtczogeyBzcGFjZSB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICB7IF90KFwiJShjb3VudClzIG1lbWJlcnNcIiwgeyBjb3VudCB9KSB9XG4gICAgICAgICAgICAgICAgPC9BY2Nlc3NpYmxlQnV0dG9uPlxuICAgICAgICAgICAgKSA6IG51bGwgfVxuICAgICAgICA8L1Jvb21NZW1iZXJDb3VudD47XG4gICAgfVxuXG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwibXhfU3BhY2VSb29tVmlld19pbmZvXCI+XG4gICAgICAgIHsgdmlzaWJpbGl0eVNlY3Rpb24gfVxuICAgICAgICB7IG1lbWJlclNlY3Rpb24gfVxuICAgIDwvZGl2Pjtcbn07XG5cbmNvbnN0IG9uUHJlZmVyZW5jZXNDbGljayA9ICgpID0+IHtcbiAgICBkZWZhdWx0RGlzcGF0Y2hlci5kaXNwYXRjaCh7XG4gICAgICAgIGFjdGlvbjogQWN0aW9uLlZpZXdVc2VyU2V0dGluZ3MsXG4gICAgICAgIGluaXRpYWxUYWJJZDogVXNlclRhYi5QcmVmZXJlbmNlcyxcbiAgICB9KTtcbn07XG5cbi8vIFhYWDogdGVtcG9yYXJ5IGNvbW11bml0eSBtaWdyYXRpb24gY29tcG9uZW50XG5jb25zdCBHcm91cFRpbGUgPSAoeyBncm91cElkIH06IHsgZ3JvdXBJZDogc3RyaW5nIH0pID0+IHtcbiAgICBjb25zdCBjbGkgPSB1c2VDb250ZXh0KE1hdHJpeENsaWVudENvbnRleHQpO1xuICAgIGNvbnN0IGdyb3VwU3VtbWFyeSA9IHVzZUFzeW5jTWVtbzxJR3JvdXBTdW1tYXJ5PigoKSA9PiBjbGkuZ2V0R3JvdXBTdW1tYXJ5KGdyb3VwSWQpLCBbY2xpLCBncm91cElkXSk7XG5cbiAgICBpZiAoIWdyb3VwU3VtbWFyeSkgcmV0dXJuIDxTcGlubmVyIC8+O1xuXG4gICAgcmV0dXJuIDw+XG4gICAgICAgIDxHcm91cEF2YXRhclxuICAgICAgICAgICAgZ3JvdXBJZD17Z3JvdXBJZH1cbiAgICAgICAgICAgIGdyb3VwTmFtZT17Z3JvdXBTdW1tYXJ5LnByb2ZpbGUubmFtZX1cbiAgICAgICAgICAgIGdyb3VwQXZhdGFyVXJsPXtncm91cFN1bW1hcnkucHJvZmlsZS5hdmF0YXJfdXJsfVxuICAgICAgICAgICAgd2lkdGg9ezE2fVxuICAgICAgICAgICAgaGVpZ2h0PXsxNn1cbiAgICAgICAgICAgIHJlc2l6ZU1ldGhvZD0nY3JvcCdcbiAgICAgICAgLz5cbiAgICAgICAgeyBncm91cFN1bW1hcnkucHJvZmlsZS5uYW1lIH1cbiAgICA8Lz47XG59O1xuXG5pbnRlcmZhY2UgSVNwYWNlUHJldmlld1Byb3BzIHtcbiAgICBzcGFjZTogUm9vbTtcbiAgICBvbkpvaW5CdXR0b25DbGlja2VkKCk6IHZvaWQ7XG4gICAgb25SZWplY3RCdXR0b25DbGlja2VkKCk6IHZvaWQ7XG59XG5cbmNvbnN0IFNwYWNlUHJldmlldyA9ICh7IHNwYWNlLCBvbkpvaW5CdXR0b25DbGlja2VkLCBvblJlamVjdEJ1dHRvbkNsaWNrZWQgfTogSVNwYWNlUHJldmlld1Byb3BzKSA9PiB7XG4gICAgY29uc3QgY2xpID0gdXNlQ29udGV4dChNYXRyaXhDbGllbnRDb250ZXh0KTtcbiAgICBjb25zdCBteU1lbWJlcnNoaXAgPSB1c2VNeVJvb21NZW1iZXJzaGlwKHNwYWNlKTtcbiAgICB1c2VEaXNwYXRjaGVyKGRlZmF1bHREaXNwYXRjaGVyLCBwYXlsb2FkID0+IHtcbiAgICAgICAgaWYgKHBheWxvYWQuYWN0aW9uID09PSBBY3Rpb24uSm9pblJvb21FcnJvciAmJiBwYXlsb2FkLnJvb21JZCA9PT0gc3BhY2Uucm9vbUlkKSB7XG4gICAgICAgICAgICBzZXRCdXN5KGZhbHNlKTsgLy8gc3RvcCB0aGUgc3Bpbm5lciwgam9pbiBmYWlsZWRcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3QgW2J1c3ksIHNldEJ1c3ldID0gdXNlU3RhdGUoZmFsc2UpO1xuXG4gICAgY29uc3Qgc3BhY2VzRW5hYmxlZCA9IFNwYWNlU3RvcmUuc3BhY2VzRW5hYmxlZDtcblxuICAgIGNvbnN0IGpvaW5SdWxlID0gdXNlUm9vbVN0YXRlKHNwYWNlLCBzdGF0ZSA9PiBzdGF0ZS5nZXRKb2luUnVsZSgpKTtcbiAgICBjb25zdCBjYW5ub3RKb2luID0gZ2V0RWZmZWN0aXZlTWVtYmVyc2hpcChteU1lbWJlcnNoaXApID09PSBFZmZlY3RpdmVNZW1iZXJzaGlwLkxlYXZlXG4gICAgICAgICYmIGpvaW5SdWxlICE9PSBKb2luUnVsZS5QdWJsaWM7XG5cbiAgICBsZXQgaW52aXRlclNlY3Rpb247XG4gICAgbGV0IGpvaW5CdXR0b25zO1xuICAgIGlmIChteU1lbWJlcnNoaXAgPT09IFwiam9pblwiKSB7XG4gICAgICAgIC8vIFhYWCByZW1vdmUgdGhpcyB3aGVuIHNwYWNlcyBsZWF2ZXMgQmV0YVxuICAgICAgICBqb2luQnV0dG9ucyA9IChcbiAgICAgICAgICAgIDxBY2Nlc3NpYmxlQnV0dG9uXG4gICAgICAgICAgICAgICAga2luZD1cImRhbmdlcl9vdXRsaW5lXCJcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGRpcy5kaXNwYXRjaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb246IFwibGVhdmVfcm9vbVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcm9vbV9pZDogc3BhY2Uucm9vbUlkLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHsgX3QoXCJMZWF2ZVwiKSB9XG4gICAgICAgICAgICA8L0FjY2Vzc2libGVCdXR0b24+XG4gICAgICAgICk7XG4gICAgfSBlbHNlIGlmIChteU1lbWJlcnNoaXAgPT09IFwiaW52aXRlXCIpIHtcbiAgICAgICAgY29uc3QgaW52aXRlU2VuZGVyID0gc3BhY2UuZ2V0TWVtYmVyKGNsaS5nZXRVc2VySWQoKSk/LmV2ZW50cy5tZW1iZXI/LmdldFNlbmRlcigpO1xuICAgICAgICBjb25zdCBpbnZpdGVyID0gaW52aXRlU2VuZGVyICYmIHNwYWNlLmdldE1lbWJlcihpbnZpdGVTZW5kZXIpO1xuXG4gICAgICAgIGlmIChpbnZpdGVTZW5kZXIpIHtcbiAgICAgICAgICAgIGludml0ZXJTZWN0aW9uID0gPGRpdiBjbGFzc05hbWU9XCJteF9TcGFjZVJvb21WaWV3X3ByZXZpZXdfaW52aXRlclwiPlxuICAgICAgICAgICAgICAgIDxNZW1iZXJBdmF0YXIgbWVtYmVyPXtpbnZpdGVyfSBmYWxsYmFja1VzZXJJZD17aW52aXRlU2VuZGVyfSB3aWR0aD17MzJ9IGhlaWdodD17MzJ9IC8+XG4gICAgICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJteF9TcGFjZVJvb21WaWV3X3ByZXZpZXdfaW52aXRlcl9uYW1lXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICB7IF90KFwiPGludml0ZXIvPiBpbnZpdGVzIHlvdVwiLCB7fSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludml0ZXI6ICgpID0+IDxiPnsgaW52aXRlcj8ubmFtZSB8fCBpbnZpdGVTZW5kZXIgfTwvYj4sXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSB9XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICB7IGludml0ZXIgPyA8ZGl2IGNsYXNzTmFtZT1cIm14X1NwYWNlUm9vbVZpZXdfcHJldmlld19pbnZpdGVyX214aWRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHsgaW52aXRlU2VuZGVyIH1cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+IDogbnVsbCB9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj47XG4gICAgICAgIH1cblxuICAgICAgICBqb2luQnV0dG9ucyA9IDw+XG4gICAgICAgICAgICA8QWNjZXNzaWJsZUJ1dHRvblxuICAgICAgICAgICAgICAgIGtpbmQ9XCJzZWNvbmRhcnlcIlxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgc2V0QnVzeSh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgb25SZWplY3RCdXR0b25DbGlja2VkKCk7XG4gICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7IF90KFwiUmVqZWN0XCIpIH1cbiAgICAgICAgICAgIDwvQWNjZXNzaWJsZUJ1dHRvbj5cbiAgICAgICAgICAgIDxBY2Nlc3NpYmxlQnV0dG9uXG4gICAgICAgICAgICAgICAga2luZD1cInByaW1hcnlcIlxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgc2V0QnVzeSh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgb25Kb2luQnV0dG9uQ2xpY2tlZCgpO1xuICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgZGlzYWJsZWQ9eyFzcGFjZXNFbmFibGVkfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHsgX3QoXCJBY2NlcHRcIikgfVxuICAgICAgICAgICAgPC9BY2Nlc3NpYmxlQnV0dG9uPlxuICAgICAgICA8Lz47XG4gICAgfSBlbHNlIHtcbiAgICAgICAgam9pbkJ1dHRvbnMgPSAoXG4gICAgICAgICAgICA8QWNjZXNzaWJsZUJ1dHRvblxuICAgICAgICAgICAgICAgIGtpbmQ9XCJwcmltYXJ5XCJcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIG9uSm9pbkJ1dHRvbkNsaWNrZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjbGkuaXNHdWVzdCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB1c2VyIHdpbGwgYmUgc2hvd24gYSBtb2RhbCB0aGF0IHdvbid0IGZpcmUgYSByb29tIGpvaW4gZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldEJ1c3kodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgIGRpc2FibGVkPXshc3BhY2VzRW5hYmxlZCB8fCBjYW5ub3RKb2lufVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHsgX3QoXCJKb2luXCIpIH1cbiAgICAgICAgICAgIDwvQWNjZXNzaWJsZUJ1dHRvbj5cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoYnVzeSkge1xuICAgICAgICBqb2luQnV0dG9ucyA9IDxJbmxpbmVTcGlubmVyIC8+O1xuICAgIH1cblxuICAgIGxldCBmb290ZXI7XG4gICAgaWYgKCFzcGFjZXNFbmFibGVkKSB7XG4gICAgICAgIGZvb3RlciA9IDxkaXYgY2xhc3NOYW1lPVwibXhfU3BhY2VSb29tVmlld19wcmV2aWV3X3NwYWNlQmV0YVByb21wdFwiPlxuICAgICAgICAgICAgeyBteU1lbWJlcnNoaXAgPT09IFwiam9pblwiXG4gICAgICAgICAgICAgICAgPyBfdChcIlRvIHZpZXcgdGhpcyBTcGFjZSwgaGlkZSBjb21tdW5pdGllcyBpbiB5b3VyIDxhPnByZWZlcmVuY2VzPC9hPlwiLCB7fSwge1xuICAgICAgICAgICAgICAgICAgICBhOiBzdWIgPT4gPEFjY2Vzc2libGVCdXR0b24gb25DbGljaz17b25QcmVmZXJlbmNlc0NsaWNrfSBraW5kPVwibGlua1wiPnsgc3ViIH08L0FjY2Vzc2libGVCdXR0b24+LFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgOiBfdChcIlRvIGpvaW4gdGhpcyBTcGFjZSwgaGlkZSBjb21tdW5pdGllcyBpbiB5b3VyIDxhPnByZWZlcmVuY2VzPC9hPlwiLCB7fSwge1xuICAgICAgICAgICAgICAgICAgICBhOiBzdWIgPT4gPEFjY2Vzc2libGVCdXR0b24gb25DbGljaz17b25QcmVmZXJlbmNlc0NsaWNrfSBraW5kPVwibGlua1wiPnsgc3ViIH08L0FjY2Vzc2libGVCdXR0b24+LFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgIDwvZGl2PjtcbiAgICB9IGVsc2UgaWYgKGNhbm5vdEpvaW4pIHtcbiAgICAgICAgZm9vdGVyID0gPGRpdiBjbGFzc05hbWU9XCJteF9TcGFjZVJvb21WaWV3X3ByZXZpZXdfc3BhY2VCZXRhUHJvbXB0XCI+XG4gICAgICAgICAgICB7IF90KFwiVG8gdmlldyAlKHNwYWNlTmFtZSlzLCB5b3UgbmVlZCBhbiBpbnZpdGVcIiwge1xuICAgICAgICAgICAgICAgIHNwYWNlTmFtZTogc3BhY2UubmFtZSxcbiAgICAgICAgICAgIH0pIH1cbiAgICAgICAgPC9kaXY+O1xuICAgIH1cblxuICAgIGxldCBtaWdyYXRlZENvbW11bml0eVNlY3Rpb246IEpTWC5FbGVtZW50O1xuICAgIGNvbnN0IGNyZWF0ZUNvbnRlbnQgPSBzcGFjZS5jdXJyZW50U3RhdGUuZ2V0U3RhdGVFdmVudHMoRXZlbnRUeXBlLlJvb21DcmVhdGUsIFwiXCIpPy5nZXRDb250ZW50KCk7XG4gICAgaWYgKGNyZWF0ZUNvbnRlbnRbQ3JlYXRlRXZlbnRGaWVsZF0pIHtcbiAgICAgICAgbWlncmF0ZWRDb21tdW5pdHlTZWN0aW9uID0gPGRpdiBjbGFzc05hbWU9XCJteF9TcGFjZVJvb21WaWV3X3ByZXZpZXdfbWlncmF0ZWRDb21tdW5pdHlcIj5cbiAgICAgICAgICAgIHsgX3QoXCJDcmVhdGVkIGZyb20gPENvbW11bml0eSAvPlwiLCB7fSwge1xuICAgICAgICAgICAgICAgIENvbW11bml0eTogKCkgPT4gPEdyb3VwVGlsZSBncm91cElkPXtjcmVhdGVDb250ZW50W0NyZWF0ZUV2ZW50RmllbGRdfSAvPixcbiAgICAgICAgICAgIH0pIH1cbiAgICAgICAgPC9kaXY+O1xuICAgIH1cblxuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cIm14X1NwYWNlUm9vbVZpZXdfcHJldmlld1wiPlxuICAgICAgICB7IG1pZ3JhdGVkQ29tbXVuaXR5U2VjdGlvbiB9XG4gICAgICAgIHsgaW52aXRlclNlY3Rpb24gfVxuICAgICAgICA8Um9vbUF2YXRhciByb29tPXtzcGFjZX0gaGVpZ2h0PXs4MH0gd2lkdGg9ezgwfSB2aWV3QXZhdGFyT25DbGljaz17dHJ1ZX0gLz5cbiAgICAgICAgPGgxIGNsYXNzTmFtZT1cIm14X1NwYWNlUm9vbVZpZXdfcHJldmlld19uYW1lXCI+XG4gICAgICAgICAgICA8Um9vbU5hbWUgcm9vbT17c3BhY2V9IC8+XG4gICAgICAgIDwvaDE+XG4gICAgICAgIDxTcGFjZUluZm8gc3BhY2U9e3NwYWNlfSAvPlxuICAgICAgICA8Um9vbVRvcGljIHJvb209e3NwYWNlfT5cbiAgICAgICAgICAgIHsgKHRvcGljLCByZWYpID0+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJteF9TcGFjZVJvb21WaWV3X3ByZXZpZXdfdG9waWNcIiByZWY9e3JlZn0+XG4gICAgICAgICAgICAgICAgICAgIHsgdG9waWMgfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgfVxuICAgICAgICA8L1Jvb21Ub3BpYz5cbiAgICAgICAgeyBzcGFjZS5nZXRKb2luUnVsZSgpID09PSBcInB1YmxpY1wiICYmIDxGYWNlUGlsZSByb29tPXtzcGFjZX0gLz4gfVxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X1NwYWNlUm9vbVZpZXdfcHJldmlld19qb2luQnV0dG9uc1wiPlxuICAgICAgICAgICAgeyBqb2luQnV0dG9ucyB9XG4gICAgICAgIDwvZGl2PlxuICAgICAgICB7IGZvb3RlciB9XG4gICAgPC9kaXY+O1xufTtcblxuY29uc3QgU3BhY2VMYW5kaW5nQWRkQnV0dG9uID0gKHsgc3BhY2UgfSkgPT4ge1xuICAgIGNvbnN0IFttZW51RGlzcGxheWVkLCBoYW5kbGUsIG9wZW5NZW51LCBjbG9zZU1lbnVdID0gdXNlQ29udGV4dE1lbnUoKTtcblxuICAgIGxldCBjb250ZXh0TWVudTtcbiAgICBpZiAobWVudURpc3BsYXllZCkge1xuICAgICAgICBjb25zdCByZWN0ID0gaGFuZGxlLmN1cnJlbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIGNvbnRleHRNZW51ID0gPEljb25pemVkQ29udGV4dE1lbnVcbiAgICAgICAgICAgIGxlZnQ9e3JlY3QubGVmdCArIHdpbmRvdy5wYWdlWE9mZnNldCArIDB9XG4gICAgICAgICAgICB0b3A9e3JlY3QuYm90dG9tICsgd2luZG93LnBhZ2VZT2Zmc2V0ICsgOH1cbiAgICAgICAgICAgIGNoZXZyb25GYWNlPXtDaGV2cm9uRmFjZS5Ob25lfVxuICAgICAgICAgICAgb25GaW5pc2hlZD17Y2xvc2VNZW51fVxuICAgICAgICAgICAgY2xhc3NOYW1lPVwibXhfUm9vbVRpbGVfY29udGV4dE1lbnVcIlxuICAgICAgICAgICAgY29tcGFjdFxuICAgICAgICA+XG4gICAgICAgICAgICA8SWNvbml6ZWRDb250ZXh0TWVudU9wdGlvbkxpc3QgZmlyc3Q+XG4gICAgICAgICAgICAgICAgPEljb25pemVkQ29udGV4dE1lbnVPcHRpb25cbiAgICAgICAgICAgICAgICAgICAgbGFiZWw9e190KFwiQ3JlYXRlIG5ldyByb29tXCIpfVxuICAgICAgICAgICAgICAgICAgICBpY29uQ2xhc3NOYW1lPVwibXhfUm9vbUxpc3RfaWNvblBsdXNcIlxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXthc3luYyAoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlTWVudSgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXdhaXQgc2hvd0NyZWF0ZU5ld1Jvb20oc3BhY2UpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdERpc3BhdGNoZXIuZmlyZShBY3Rpb24uVXBkYXRlU3BhY2VIaWVyYXJjaHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPEljb25pemVkQ29udGV4dE1lbnVPcHRpb25cbiAgICAgICAgICAgICAgICAgICAgbGFiZWw9e190KFwiQWRkIGV4aXN0aW5nIHJvb21cIil9XG4gICAgICAgICAgICAgICAgICAgIGljb25DbGFzc05hbWU9XCJteF9Sb29tTGlzdF9pY29uSGFzaFwiXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eyhlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VNZW51KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaG93QWRkRXhpc3RpbmdSb29tcyhzcGFjZSk7XG4gICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8SWNvbml6ZWRDb250ZXh0TWVudU9wdGlvblxuICAgICAgICAgICAgICAgICAgICBsYWJlbD17X3QoXCJBZGQgc3BhY2VcIil9XG4gICAgICAgICAgICAgICAgICAgIGljb25DbGFzc05hbWU9XCJteF9Sb29tTGlzdF9pY29uUGx1c1wiXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eyhlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VNZW51KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaG93Q3JlYXRlTmV3U3Vic3BhY2Uoc3BhY2UpO1xuICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPEJldGFQaWxsIC8+XG4gICAgICAgICAgICAgICAgPC9JY29uaXplZENvbnRleHRNZW51T3B0aW9uPlxuICAgICAgICAgICAgPC9JY29uaXplZENvbnRleHRNZW51T3B0aW9uTGlzdD5cbiAgICAgICAgPC9JY29uaXplZENvbnRleHRNZW51PjtcbiAgICB9XG5cbiAgICByZXR1cm4gPD5cbiAgICAgICAgPENvbnRleHRNZW51QnV0dG9uXG4gICAgICAgICAgICBraW5kPVwicHJpbWFyeVwiXG4gICAgICAgICAgICBpbnB1dFJlZj17aGFuZGxlfVxuICAgICAgICAgICAgb25DbGljaz17b3Blbk1lbnV9XG4gICAgICAgICAgICBpc0V4cGFuZGVkPXttZW51RGlzcGxheWVkfVxuICAgICAgICAgICAgbGFiZWw9e190KFwiQWRkXCIpfVxuICAgICAgICA+XG4gICAgICAgICAgICB7IF90KFwiQWRkXCIpIH1cbiAgICAgICAgPC9Db250ZXh0TWVudUJ1dHRvbj5cbiAgICAgICAgeyBjb250ZXh0TWVudSB9XG4gICAgPC8+O1xufTtcblxuY29uc3QgU3BhY2VMYW5kaW5nID0gKHsgc3BhY2UgfTogeyBzcGFjZTogUm9vbSB9KSA9PiB7XG4gICAgY29uc3QgY2xpID0gdXNlQ29udGV4dChNYXRyaXhDbGllbnRDb250ZXh0KTtcbiAgICBjb25zdCBteU1lbWJlcnNoaXAgPSB1c2VNeVJvb21NZW1iZXJzaGlwKHNwYWNlKTtcbiAgICBjb25zdCB1c2VySWQgPSBjbGkuZ2V0VXNlcklkKCk7XG5cbiAgICBsZXQgaW52aXRlQnV0dG9uO1xuICAgIGlmICgoKG15TWVtYmVyc2hpcCA9PT0gXCJqb2luXCIgJiYgc3BhY2UuY2FuSW52aXRlKHVzZXJJZCkpIHx8IHNwYWNlLmdldEpvaW5SdWxlKCkgPT09IEpvaW5SdWxlLlB1YmxpYykgJiZcbiAgICAgICAgc2hvdWxkU2hvd0NvbXBvbmVudChVSUNvbXBvbmVudC5JbnZpdGVVc2VycylcbiAgICApIHtcbiAgICAgICAgaW52aXRlQnV0dG9uID0gKFxuICAgICAgICAgICAgPEFjY2Vzc2libGVCdXR0b25cbiAgICAgICAgICAgICAgICBraW5kPVwicHJpbWFyeVwiXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXhfU3BhY2VSb29tVmlld19sYW5kaW5nX2ludml0ZUJ1dHRvblwiXG4gICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzaG93U3BhY2VJbnZpdGUoc3BhY2UpO1xuICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgeyBfdChcIkludml0ZVwiKSB9XG4gICAgICAgICAgICA8L0FjY2Vzc2libGVCdXR0b24+XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgY29uc3QgY2FuQWRkUm9vbXMgPSBteU1lbWJlcnNoaXAgPT09IFwiam9pblwiICYmIHNwYWNlLmN1cnJlbnRTdGF0ZS5tYXlTZW5kU3RhdGVFdmVudChFdmVudFR5cGUuU3BhY2VDaGlsZCwgdXNlcklkKTtcblxuICAgIGxldCBhZGRSb29tQnV0dG9uO1xuICAgIGlmIChjYW5BZGRSb29tcykge1xuICAgICAgICBhZGRSb29tQnV0dG9uID0gPFNwYWNlTGFuZGluZ0FkZEJ1dHRvbiBzcGFjZT17c3BhY2V9IC8+O1xuICAgIH1cblxuICAgIGxldCBzZXR0aW5nc0J1dHRvbjtcbiAgICBpZiAoc2hvdWxkU2hvd1NwYWNlU2V0dGluZ3Moc3BhY2UpKSB7XG4gICAgICAgIHNldHRpbmdzQnV0dG9uID0gPEFjY2Vzc2libGVUb29sdGlwQnV0dG9uXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJteF9TcGFjZVJvb21WaWV3X2xhbmRpbmdfc2V0dGluZ3NCdXR0b25cIlxuICAgICAgICAgICAgb25DbGljaz17KCkgPT4ge1xuICAgICAgICAgICAgICAgIHNob3dTcGFjZVNldHRpbmdzKHNwYWNlKTtcbiAgICAgICAgICAgIH19XG4gICAgICAgICAgICB0aXRsZT17X3QoXCJTZXR0aW5nc1wiKX1cbiAgICAgICAgLz47XG4gICAgfVxuXG4gICAgY29uc3Qgb25NZW1iZXJzQ2xpY2sgPSAoKSA9PiB7XG4gICAgICAgIGRlZmF1bHREaXNwYXRjaGVyLmRpc3BhdGNoPFNldFJpZ2h0UGFuZWxQaGFzZVBheWxvYWQ+KHtcbiAgICAgICAgICAgIGFjdGlvbjogQWN0aW9uLlNldFJpZ2h0UGFuZWxQaGFzZSxcbiAgICAgICAgICAgIHBoYXNlOiBSaWdodFBhbmVsUGhhc2VzLlJvb21NZW1iZXJMaXN0LFxuICAgICAgICAgICAgcmVmaXJlUGFyYW1zOiB7IHNwYWNlIH0sXG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJteF9TcGFjZVJvb21WaWV3X2xhbmRpbmdcIj5cbiAgICAgICAgPFNwYWNlRmVlZGJhY2tQcm9tcHQgLz5cbiAgICAgICAgPFJvb21BdmF0YXIgcm9vbT17c3BhY2V9IGhlaWdodD17ODB9IHdpZHRoPXs4MH0gdmlld0F2YXRhck9uQ2xpY2s9e3RydWV9IC8+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfU3BhY2VSb29tVmlld19sYW5kaW5nX25hbWVcIj5cbiAgICAgICAgICAgIDxSb29tTmFtZSByb29tPXtzcGFjZX0+XG4gICAgICAgICAgICAgICAgeyAobmFtZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0YWdzID0geyBuYW1lOiAoKSA9PiA8ZGl2IGNsYXNzTmFtZT1cIm14X1NwYWNlUm9vbVZpZXdfbGFuZGluZ19uYW1lUm93XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8aDE+eyBuYW1lIH08L2gxPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj4gfTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90KFwiV2VsY29tZSB0byA8bmFtZS8+XCIsIHt9LCB0YWdzKSBhcyBKU1guRWxlbWVudDtcbiAgICAgICAgICAgICAgICB9IH1cbiAgICAgICAgICAgIDwvUm9vbU5hbWU+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X1NwYWNlUm9vbVZpZXdfbGFuZGluZ19pbmZvXCI+XG4gICAgICAgICAgICA8U3BhY2VJbmZvIHNwYWNlPXtzcGFjZX0gLz5cbiAgICAgICAgICAgIDxGYWNlUGlsZSByb29tPXtzcGFjZX0gb25seUtub3duVXNlcnM9e2ZhbHNlfSBudW1TaG93bj17N30gb25DbGljaz17b25NZW1iZXJzQ2xpY2t9IC8+XG4gICAgICAgICAgICB7IGludml0ZUJ1dHRvbiB9XG4gICAgICAgICAgICB7IHNldHRpbmdzQnV0dG9uIH1cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxSb29tVG9waWMgcm9vbT17c3BhY2V9PlxuICAgICAgICAgICAgeyAodG9waWMsIHJlZikgPT4gKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfU3BhY2VSb29tVmlld19sYW5kaW5nX3RvcGljXCIgcmVmPXtyZWZ9PlxuICAgICAgICAgICAgICAgICAgICB7IHRvcGljIH1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICkgfVxuICAgICAgICA8L1Jvb21Ub3BpYz5cblxuICAgICAgICA8U3BhY2VIaWVyYXJjaHkgc3BhY2U9e3NwYWNlfSBzaG93Um9vbT17c2hvd1Jvb219IGFkZGl0aW9uYWxCdXR0b25zPXthZGRSb29tQnV0dG9ufSAvPlxuICAgIDwvZGl2Pjtcbn07XG5cbmNvbnN0IFNwYWNlU2V0dXBGaXJzdFJvb21zID0gKHsgc3BhY2UsIHRpdGxlLCBkZXNjcmlwdGlvbiwgb25GaW5pc2hlZCB9KSA9PiB7XG4gICAgY29uc3QgW2J1c3ksIHNldEJ1c3ldID0gdXNlU3RhdGUoZmFsc2UpO1xuICAgIGNvbnN0IFtlcnJvciwgc2V0RXJyb3JdID0gdXNlU3RhdGUoXCJcIik7XG4gICAgY29uc3QgbnVtRmllbGRzID0gMztcbiAgICBjb25zdCBwbGFjZWhvbGRlcnMgPSBbX3QoXCJHZW5lcmFsXCIpLCBfdChcIlJhbmRvbVwiKSwgX3QoXCJTdXBwb3J0XCIpXTtcbiAgICBjb25zdCBbcm9vbU5hbWVzLCBzZXRSb29tTmFtZV0gPSB1c2VTdGF0ZUFycmF5KG51bUZpZWxkcywgW190KFwiR2VuZXJhbFwiKSwgX3QoXCJSYW5kb21cIiksIFwiXCJdKTtcbiAgICBjb25zdCBmaWVsZHMgPSBuZXcgQXJyYXkobnVtRmllbGRzKS5maWxsKDApLm1hcCgoeCwgaSkgPT4ge1xuICAgICAgICBjb25zdCBuYW1lID0gXCJyb29tTmFtZVwiICsgaTtcbiAgICAgICAgcmV0dXJuIDxGaWVsZFxuICAgICAgICAgICAga2V5PXtuYW1lfVxuICAgICAgICAgICAgbmFtZT17bmFtZX1cbiAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgIGxhYmVsPXtfdChcIlJvb20gbmFtZVwiKX1cbiAgICAgICAgICAgIHBsYWNlaG9sZGVyPXtwbGFjZWhvbGRlcnNbaV19XG4gICAgICAgICAgICB2YWx1ZT17cm9vbU5hbWVzW2ldfVxuICAgICAgICAgICAgb25DaGFuZ2U9e2V2ID0+IHNldFJvb21OYW1lKGksIGV2LnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgICBhdXRvRm9jdXM9e2kgPT09IDJ9XG4gICAgICAgICAgICBkaXNhYmxlZD17YnVzeX1cbiAgICAgICAgICAgIGF1dG9Db21wbGV0ZT1cIm9mZlwiXG4gICAgICAgIC8+O1xuICAgIH0pO1xuXG4gICAgY29uc3Qgb25OZXh0Q2xpY2sgPSBhc3luYyAoZXYpID0+IHtcbiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgaWYgKGJ1c3kpIHJldHVybjtcbiAgICAgICAgc2V0RXJyb3IoXCJcIik7XG4gICAgICAgIHNldEJ1c3kodHJ1ZSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBpc1B1YmxpYyA9IHNwYWNlLmdldEpvaW5SdWxlKCkgPT09IEpvaW5SdWxlLlB1YmxpYztcbiAgICAgICAgICAgIGNvbnN0IGZpbHRlcmVkUm9vbU5hbWVzID0gcm9vbU5hbWVzLm1hcChuYW1lID0+IG5hbWUudHJpbSgpKS5maWx0ZXIoQm9vbGVhbik7XG4gICAgICAgICAgICBjb25zdCByb29tSWRzID0gYXdhaXQgUHJvbWlzZS5hbGwoZmlsdGVyZWRSb29tTmFtZXMubWFwKG5hbWUgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBjcmVhdGVSb29tKHtcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlT3B0czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJlc2V0OiBpc1B1YmxpYyA/IFByZXNldC5QdWJsaWNDaGF0IDogUHJlc2V0LlByaXZhdGVDaGF0LFxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgc3Bpbm5lcjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVuY3J5cHRpb246IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBhbmRWaWV3OiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgaW5saW5lRXJyb3JzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBwYXJlbnRTcGFjZTogc3BhY2UsXG4gICAgICAgICAgICAgICAgICAgIGpvaW5SdWxlOiAhaXNQdWJsaWMgPyBKb2luUnVsZS5SZXN0cmljdGVkIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICBzdWdnZXN0ZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBvbkZpbmlzaGVkKHJvb21JZHNbMF0pO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gY3JlYXRlIGluaXRpYWwgc3BhY2Ugcm9vbXNcIiwgZSk7XG4gICAgICAgICAgICBzZXRFcnJvcihfdChcIkZhaWxlZCB0byBjcmVhdGUgaW5pdGlhbCBzcGFjZSByb29tc1wiKSk7XG4gICAgICAgIH1cbiAgICAgICAgc2V0QnVzeShmYWxzZSk7XG4gICAgfTtcblxuICAgIGxldCBvbkNsaWNrID0gKGV2KSA9PiB7XG4gICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIG9uRmluaXNoZWQoKTtcbiAgICB9O1xuICAgIGxldCBidXR0b25MYWJlbCA9IF90KFwiU2tpcCBmb3Igbm93XCIpO1xuICAgIGlmIChyb29tTmFtZXMuc29tZShuYW1lID0+IG5hbWUudHJpbSgpKSkge1xuICAgICAgICBvbkNsaWNrID0gb25OZXh0Q2xpY2s7XG4gICAgICAgIGJ1dHRvbkxhYmVsID0gYnVzeSA/IF90KFwiQ3JlYXRpbmcgcm9vbXMuLi5cIikgOiBfdChcIkNvbnRpbnVlXCIpO1xuICAgIH1cblxuICAgIHJldHVybiA8ZGl2PlxuICAgICAgICA8aDE+eyB0aXRsZSB9PC9oMT5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJteF9TcGFjZVJvb21WaWV3X2Rlc2NyaXB0aW9uXCI+eyBkZXNjcmlwdGlvbiB9PC9kaXY+XG5cbiAgICAgICAgeyBlcnJvciAmJiA8ZGl2IGNsYXNzTmFtZT1cIm14X1NwYWNlUm9vbVZpZXdfZXJyb3JUZXh0XCI+eyBlcnJvciB9PC9kaXY+IH1cbiAgICAgICAgPGZvcm0gb25TdWJtaXQ9e29uQ2xpY2t9IGlkPVwibXhfU3BhY2VTZXR1cEZpcnN0Um9vbXNcIj5cbiAgICAgICAgICAgIHsgZmllbGRzIH1cbiAgICAgICAgPC9mb3JtPlxuXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfU3BhY2VSb29tVmlld19idXR0b25zXCI+XG4gICAgICAgICAgICA8QWNjZXNzaWJsZUJ1dHRvblxuICAgICAgICAgICAgICAgIGtpbmQ9XCJwcmltYXJ5XCJcbiAgICAgICAgICAgICAgICBkaXNhYmxlZD17YnVzeX1cbiAgICAgICAgICAgICAgICBvbkNsaWNrPXtvbkNsaWNrfVxuICAgICAgICAgICAgICAgIGVsZW1lbnQ9XCJpbnB1dFwiXG4gICAgICAgICAgICAgICAgdHlwZT1cInN1Ym1pdFwiXG4gICAgICAgICAgICAgICAgZm9ybT1cIm14X1NwYWNlU2V0dXBGaXJzdFJvb21zXCJcbiAgICAgICAgICAgICAgICB2YWx1ZT17YnV0dG9uTGFiZWx9XG4gICAgICAgICAgICAvPlxuICAgICAgICA8L2Rpdj5cbiAgICA8L2Rpdj47XG59O1xuXG5jb25zdCBTcGFjZUFkZEV4aXN0aW5nUm9vbXMgPSAoeyBzcGFjZSwgb25GaW5pc2hlZCB9KSA9PiB7XG4gICAgcmV0dXJuIDxkaXY+XG4gICAgICAgIDxoMT57IF90KFwiV2hhdCBkbyB5b3Ugd2FudCB0byBvcmdhbmlzZT9cIikgfTwvaDE+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfU3BhY2VSb29tVmlld19kZXNjcmlwdGlvblwiPlxuICAgICAgICAgICAgeyBfdChcIlBpY2sgcm9vbXMgb3IgY29udmVyc2F0aW9ucyB0byBhZGQuIFRoaXMgaXMganVzdCBhIHNwYWNlIGZvciB5b3UsIFwiICtcbiAgICAgICAgICAgICAgICBcIm5vIG9uZSB3aWxsIGJlIGluZm9ybWVkLiBZb3UgY2FuIGFkZCBtb3JlIGxhdGVyLlwiKSB9XG4gICAgICAgIDwvZGl2PlxuXG4gICAgICAgIDxBZGRFeGlzdGluZ1RvU3BhY2VcbiAgICAgICAgICAgIHNwYWNlPXtzcGFjZX1cbiAgICAgICAgICAgIGVtcHR5U2VsZWN0aW9uQnV0dG9uPXtcbiAgICAgICAgICAgICAgICA8QWNjZXNzaWJsZUJ1dHRvbiBraW5kPVwicHJpbWFyeVwiIG9uQ2xpY2s9e29uRmluaXNoZWR9PlxuICAgICAgICAgICAgICAgICAgICB7IF90KFwiU2tpcCBmb3Igbm93XCIpIH1cbiAgICAgICAgICAgICAgICA8L0FjY2Vzc2libGVCdXR0b24+XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaWx0ZXJQbGFjZWhvbGRlcj17X3QoXCJTZWFyY2ggZm9yIHJvb21zIG9yIHNwYWNlc1wiKX1cbiAgICAgICAgICAgIG9uRmluaXNoZWQ9e29uRmluaXNoZWR9XG4gICAgICAgICAgICByb29tc1JlbmRlcmVyPXtkZWZhdWx0Um9vbXNSZW5kZXJlcn1cbiAgICAgICAgICAgIHNwYWNlc1JlbmRlcmVyPXtkZWZhdWx0U3BhY2VzUmVuZGVyZXJ9XG4gICAgICAgICAgICBkbXNSZW5kZXJlcj17ZGVmYXVsdERtc1JlbmRlcmVyfVxuICAgICAgICAvPlxuICAgIDwvZGl2Pjtcbn07XG5cbmludGVyZmFjZSBJU3BhY2VTZXR1cFB1YmxpY1NoYXJlUHJvcHMgZXh0ZW5kcyBQaWNrPElQcm9wcyAmIElTdGF0ZSwgXCJqdXN0Q3JlYXRlZE9wdHNcIiB8IFwic3BhY2VcIiB8IFwiZmlyc3RSb29tSWRcIj4ge1xuICAgIG9uRmluaXNoZWQoKTogdm9pZDtcbn1cblxuY29uc3QgU3BhY2VTZXR1cFB1YmxpY1NoYXJlID0gKHsganVzdENyZWF0ZWRPcHRzLCBzcGFjZSwgb25GaW5pc2hlZCwgZmlyc3RSb29tSWQgfTogSVNwYWNlU2V0dXBQdWJsaWNTaGFyZVByb3BzKSA9PiB7XG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwibXhfU3BhY2VSb29tVmlld19wdWJsaWNTaGFyZVwiPlxuICAgICAgICA8aDE+eyBfdChcIlNoYXJlICUobmFtZSlzXCIsIHtcbiAgICAgICAgICAgIG5hbWU6IGp1c3RDcmVhdGVkT3B0cz8uY3JlYXRlT3B0cz8ubmFtZSB8fCBzcGFjZS5uYW1lLFxuICAgICAgICB9KSB9PC9oMT5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJteF9TcGFjZVJvb21WaWV3X2Rlc2NyaXB0aW9uXCI+XG4gICAgICAgICAgICB7IF90KFwiSXQncyBqdXN0IHlvdSBhdCB0aGUgbW9tZW50LCBpdCB3aWxsIGJlIGV2ZW4gYmV0dGVyIHdpdGggb3RoZXJzLlwiKSB9XG4gICAgICAgIDwvZGl2PlxuXG4gICAgICAgIDxTcGFjZVB1YmxpY1NoYXJlIHNwYWNlPXtzcGFjZX0gLz5cblxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X1NwYWNlUm9vbVZpZXdfYnV0dG9uc1wiPlxuICAgICAgICAgICAgPEFjY2Vzc2libGVCdXR0b24ga2luZD1cInByaW1hcnlcIiBvbkNsaWNrPXtvbkZpbmlzaGVkfT5cbiAgICAgICAgICAgICAgICB7IGZpcnN0Um9vbUlkID8gX3QoXCJHbyB0byBteSBmaXJzdCByb29tXCIpIDogX3QoXCJHbyB0byBteSBzcGFjZVwiKSB9XG4gICAgICAgICAgICA8L0FjY2Vzc2libGVCdXR0b24+XG4gICAgICAgIDwvZGl2PlxuICAgIDwvZGl2Pjtcbn07XG5cbmNvbnN0IFNwYWNlU2V0dXBQcml2YXRlU2NvcGUgPSAoeyBzcGFjZSwganVzdENyZWF0ZWRPcHRzLCBvbkZpbmlzaGVkIH0pID0+IHtcbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJteF9TcGFjZVJvb21WaWV3X3ByaXZhdGVTY29wZVwiPlxuICAgICAgICA8aDE+eyBfdChcIldobyBhcmUgeW91IHdvcmtpbmcgd2l0aD9cIikgfTwvaDE+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfU3BhY2VSb29tVmlld19kZXNjcmlwdGlvblwiPlxuICAgICAgICAgICAgeyBfdChcIk1ha2Ugc3VyZSB0aGUgcmlnaHQgcGVvcGxlIGhhdmUgYWNjZXNzIHRvICUobmFtZSlzXCIsIHtcbiAgICAgICAgICAgICAgICBuYW1lOiBqdXN0Q3JlYXRlZE9wdHM/LmNyZWF0ZU9wdHM/Lm5hbWUgfHwgc3BhY2UubmFtZSxcbiAgICAgICAgICAgIH0pIH1cbiAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgPEFjY2Vzc2libGVCdXR0b25cbiAgICAgICAgICAgIGNsYXNzTmFtZT1cIm14X1NwYWNlUm9vbVZpZXdfcHJpdmF0ZVNjb3BlX2p1c3RNZUJ1dHRvblwiXG4gICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB7IG9uRmluaXNoZWQoZmFsc2UpOyB9fVxuICAgICAgICA+XG4gICAgICAgICAgICA8aDM+eyBfdChcIkp1c3QgbWVcIikgfTwvaDM+XG4gICAgICAgICAgICA8ZGl2PnsgX3QoXCJBIHByaXZhdGUgc3BhY2UgdG8gb3JnYW5pc2UgeW91ciByb29tc1wiKSB9PC9kaXY+XG4gICAgICAgIDwvQWNjZXNzaWJsZUJ1dHRvbj5cbiAgICAgICAgPEFjY2Vzc2libGVCdXR0b25cbiAgICAgICAgICAgIGNsYXNzTmFtZT1cIm14X1NwYWNlUm9vbVZpZXdfcHJpdmF0ZVNjb3BlX21lQW5kTXlUZWFtbWF0ZXNCdXR0b25cIlxuICAgICAgICAgICAgb25DbGljaz17KCkgPT4geyBvbkZpbmlzaGVkKHRydWUpOyB9fVxuICAgICAgICA+XG4gICAgICAgICAgICA8aDM+eyBfdChcIk1lIGFuZCBteSB0ZWFtbWF0ZXNcIikgfTwvaDM+XG4gICAgICAgICAgICA8ZGl2PnsgX3QoXCJBIHByaXZhdGUgc3BhY2UgZm9yIHlvdSBhbmQgeW91ciB0ZWFtbWF0ZXNcIikgfTwvZGl2PlxuICAgICAgICA8L0FjY2Vzc2libGVCdXR0b24+XG4gICAgPC9kaXY+O1xufTtcblxuY29uc3QgdmFsaWRhdGVFbWFpbFJ1bGVzID0gd2l0aFZhbGlkYXRpb24oe1xuICAgIHJ1bGVzOiBbe1xuICAgICAgICBrZXk6IFwiZW1haWxcIixcbiAgICAgICAgdGVzdDogKHsgdmFsdWUgfSkgPT4gIXZhbHVlIHx8IEVtYWlsLmxvb2tzVmFsaWQodmFsdWUpLFxuICAgICAgICBpbnZhbGlkOiAoKSA9PiBfdChcIkRvZXNuJ3QgbG9vayBsaWtlIGEgdmFsaWQgZW1haWwgYWRkcmVzc1wiKSxcbiAgICB9XSxcbn0pO1xuXG5jb25zdCBTcGFjZVNldHVwUHJpdmF0ZUludml0ZSA9ICh7IHNwYWNlLCBvbkZpbmlzaGVkIH0pID0+IHtcbiAgICBjb25zdCBbYnVzeSwgc2V0QnVzeV0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gICAgY29uc3QgW2Vycm9yLCBzZXRFcnJvcl0gPSB1c2VTdGF0ZShcIlwiKTtcbiAgICBjb25zdCBudW1GaWVsZHMgPSAzO1xuICAgIGNvbnN0IGZpZWxkUmVmczogUmVmT2JqZWN0PEZpZWxkPltdID0gW3VzZVJlZigpLCB1c2VSZWYoKSwgdXNlUmVmKCldO1xuICAgIGNvbnN0IFtlbWFpbEFkZHJlc3Nlcywgc2V0RW1haWxBZGRyZXNzXSA9IHVzZVN0YXRlQXJyYXkobnVtRmllbGRzLCBcIlwiKTtcbiAgICBjb25zdCBmaWVsZHMgPSBuZXcgQXJyYXkobnVtRmllbGRzKS5maWxsKDApLm1hcCgoeCwgaSkgPT4ge1xuICAgICAgICBjb25zdCBuYW1lID0gXCJlbWFpbEFkZHJlc3NcIiArIGk7XG4gICAgICAgIHJldHVybiA8RmllbGRcbiAgICAgICAgICAgIGtleT17bmFtZX1cbiAgICAgICAgICAgIG5hbWU9e25hbWV9XG4gICAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICBsYWJlbD17X3QoXCJFbWFpbCBhZGRyZXNzXCIpfVxuICAgICAgICAgICAgcGxhY2Vob2xkZXI9e190KFwiRW1haWxcIil9XG4gICAgICAgICAgICB2YWx1ZT17ZW1haWxBZGRyZXNzZXNbaV19XG4gICAgICAgICAgICBvbkNoYW5nZT17ZXYgPT4gc2V0RW1haWxBZGRyZXNzKGksIGV2LnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgICByZWY9e2ZpZWxkUmVmc1tpXX1cbiAgICAgICAgICAgIG9uVmFsaWRhdGU9e3ZhbGlkYXRlRW1haWxSdWxlc31cbiAgICAgICAgICAgIGF1dG9Gb2N1cz17aSA9PT0gMH1cbiAgICAgICAgICAgIGRpc2FibGVkPXtidXN5fVxuICAgICAgICAvPjtcbiAgICB9KTtcblxuICAgIGNvbnN0IG9uTmV4dENsaWNrID0gYXN5bmMgKGV2KSA9PiB7XG4gICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGlmIChidXN5KSByZXR1cm47XG4gICAgICAgIHNldEVycm9yKFwiXCIpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZpZWxkUmVmcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgZmllbGRSZWYgPSBmaWVsZFJlZnNbaV07XG4gICAgICAgICAgICBjb25zdCB2YWxpZCA9IGF3YWl0IGZpZWxkUmVmLmN1cnJlbnQudmFsaWRhdGUoeyBhbGxvd0VtcHR5OiB0cnVlIH0pO1xuXG4gICAgICAgICAgICBpZiAodmFsaWQgPT09IGZhbHNlKSB7IC8vIHRydWUvbnVsbCBhcmUgYWxsb3dlZFxuICAgICAgICAgICAgICAgIGZpZWxkUmVmLmN1cnJlbnQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICBmaWVsZFJlZi5jdXJyZW50LnZhbGlkYXRlKHsgYWxsb3dFbXB0eTogdHJ1ZSwgZm9jdXNlZDogdHJ1ZSB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBzZXRCdXN5KHRydWUpO1xuICAgICAgICBjb25zdCB0YXJnZXRJZHMgPSBlbWFpbEFkZHJlc3Nlcy5tYXAobmFtZSA9PiBuYW1lLnRyaW0oKSkuZmlsdGVyKEJvb2xlYW4pO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgaW52aXRlTXVsdGlwbGVUb1Jvb20oc3BhY2Uucm9vbUlkLCB0YXJnZXRJZHMpO1xuXG4gICAgICAgICAgICBjb25zdCBmYWlsZWRVc2VycyA9IE9iamVjdC5rZXlzKHJlc3VsdC5zdGF0ZXMpLmZpbHRlcihhID0+IHJlc3VsdC5zdGF0ZXNbYV0gPT09IFwiZXJyb3JcIik7XG4gICAgICAgICAgICBpZiAoZmFpbGVkVXNlcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGxvZ2dlci5sb2coXCJGYWlsZWQgdG8gaW52aXRlIHVzZXJzIHRvIHNwYWNlOiBcIiwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICBzZXRFcnJvcihfdChcIkZhaWxlZCB0byBpbnZpdGUgdGhlIGZvbGxvd2luZyB1c2VycyB0byB5b3VyIHNwYWNlOiAlKGNzdlVzZXJzKXNcIiwge1xuICAgICAgICAgICAgICAgICAgICBjc3ZVc2VyczogZmFpbGVkVXNlcnMuam9pbihcIiwgXCIpLFxuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgb25GaW5pc2hlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBpbnZpdGUgdXNlcnMgdG8gc3BhY2U6IFwiLCBlcnIpO1xuICAgICAgICAgICAgc2V0RXJyb3IoX3QoXCJXZSBjb3VsZG4ndCBpbnZpdGUgdGhvc2UgdXNlcnMuIFBsZWFzZSBjaGVjayB0aGUgdXNlcnMgeW91IHdhbnQgdG8gaW52aXRlIGFuZCB0cnkgYWdhaW4uXCIpKTtcbiAgICAgICAgfVxuICAgICAgICBzZXRCdXN5KGZhbHNlKTtcbiAgICB9O1xuXG4gICAgbGV0IG9uQ2xpY2sgPSAoZXYpID0+IHtcbiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgb25GaW5pc2hlZCgpO1xuICAgIH07XG4gICAgbGV0IGJ1dHRvbkxhYmVsID0gX3QoXCJTa2lwIGZvciBub3dcIik7XG4gICAgaWYgKGVtYWlsQWRkcmVzc2VzLnNvbWUobmFtZSA9PiBuYW1lLnRyaW0oKSkpIHtcbiAgICAgICAgb25DbGljayA9IG9uTmV4dENsaWNrO1xuICAgICAgICBidXR0b25MYWJlbCA9IGJ1c3kgPyBfdChcIkludml0aW5nLi4uXCIpIDogX3QoXCJDb250aW51ZVwiKTtcbiAgICB9XG5cbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJteF9TcGFjZVJvb21WaWV3X2ludml0ZVRlYW1tYXRlc1wiPlxuICAgICAgICA8aDE+eyBfdChcIkludml0ZSB5b3VyIHRlYW1tYXRlc1wiKSB9PC9oMT5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJteF9TcGFjZVJvb21WaWV3X2Rlc2NyaXB0aW9uXCI+XG4gICAgICAgICAgICB7IF90KFwiTWFrZSBzdXJlIHRoZSByaWdodCBwZW9wbGUgaGF2ZSBhY2Nlc3MuIFlvdSBjYW4gaW52aXRlIG1vcmUgbGF0ZXIuXCIpIH1cbiAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJteF9TcGFjZVJvb21WaWV3X2ludml0ZVRlYW1tYXRlc19iZXRhRGlzY2xhaW1lclwiPlxuICAgICAgICAgICAgeyBfdChcIjxiPlRoaXMgaXMgYW4gZXhwZXJpbWVudGFsIGZlYXR1cmUuPC9iPiBGb3Igbm93LCBcIiArXG4gICAgICAgICAgICAgICAgXCJuZXcgdXNlcnMgcmVjZWl2aW5nIGFuIGludml0ZSB3aWxsIGhhdmUgdG8gb3BlbiB0aGUgaW52aXRlIG9uIDxsaW5rLz4gdG8gYWN0dWFsbHkgam9pbi5cIiwge30sIHtcbiAgICAgICAgICAgICAgICBiOiBzdWIgPT4gPGI+eyBzdWIgfTwvYj4sXG4gICAgICAgICAgICAgICAgbGluazogKCkgPT4gPGEgaHJlZj1cImh0dHBzOi8vYXBwLmVsZW1lbnQuaW8vXCIgcmVsPVwibm9yZWZlcnJlciBub29wZW5lclwiIHRhcmdldD1cIl9ibGFua1wiPlxuICAgICAgICAgICAgICAgICAgICBhcHAuZWxlbWVudC5pb1xuICAgICAgICAgICAgICAgIDwvYT4sXG4gICAgICAgICAgICB9KSB9XG4gICAgICAgIDwvZGl2PlxuXG4gICAgICAgIHsgZXJyb3IgJiYgPGRpdiBjbGFzc05hbWU9XCJteF9TcGFjZVJvb21WaWV3X2Vycm9yVGV4dFwiPnsgZXJyb3IgfTwvZGl2PiB9XG4gICAgICAgIDxmb3JtIG9uU3VibWl0PXtvbkNsaWNrfSBpZD1cIm14X1NwYWNlU2V0dXBQcml2YXRlSW52aXRlXCI+XG4gICAgICAgICAgICB7IGZpZWxkcyB9XG4gICAgICAgIDwvZm9ybT5cblxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X1NwYWNlUm9vbVZpZXdfaW52aXRlVGVhbW1hdGVzX2J1dHRvbnNcIj5cbiAgICAgICAgICAgIDxBY2Nlc3NpYmxlQnV0dG9uXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXhfU3BhY2VSb29tVmlld19pbnZpdGVUZWFtbWF0ZXNfaW52aXRlRGlhbG9nQnV0dG9uXCJcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBzaG93Um9vbUludml0ZURpYWxvZyhzcGFjZS5yb29tSWQpfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHsgX3QoXCJJbnZpdGUgYnkgdXNlcm5hbWVcIikgfVxuICAgICAgICAgICAgPC9BY2Nlc3NpYmxlQnV0dG9uPlxuICAgICAgICA8L2Rpdj5cblxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X1NwYWNlUm9vbVZpZXdfYnV0dG9uc1wiPlxuICAgICAgICAgICAgPEFjY2Vzc2libGVCdXR0b25cbiAgICAgICAgICAgICAgICBraW5kPVwicHJpbWFyeVwiXG4gICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2J1c3l9XG4gICAgICAgICAgICAgICAgb25DbGljaz17b25DbGlja31cbiAgICAgICAgICAgICAgICBlbGVtZW50PVwiaW5wdXRcIlxuICAgICAgICAgICAgICAgIHR5cGU9XCJzdWJtaXRcIlxuICAgICAgICAgICAgICAgIGZvcm09XCJteF9TcGFjZVNldHVwUHJpdmF0ZUludml0ZVwiXG4gICAgICAgICAgICAgICAgdmFsdWU9e2J1dHRvbkxhYmVsfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgPC9kaXY+XG4gICAgPC9kaXY+O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU3BhY2VSb29tVmlldyBleHRlbmRzIFJlYWN0LlB1cmVDb21wb25lbnQ8SVByb3BzLCBJU3RhdGU+IHtcbiAgICBzdGF0aWMgY29udGV4dFR5cGUgPSBNYXRyaXhDbGllbnRDb250ZXh0O1xuXG4gICAgcHJpdmF0ZSByZWFkb25seSBjcmVhdG9yOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSByZWFkb25seSBkaXNwYXRjaGVyUmVmOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSByZWFkb25seSByaWdodFBhbmVsU3RvcmVUb2tlbjogRXZlbnRTdWJzY3JpcHRpb247XG5cbiAgICBjb25zdHJ1Y3Rvcihwcm9wcywgY29udGV4dCkge1xuICAgICAgICBzdXBlcihwcm9wcywgY29udGV4dCk7XG5cbiAgICAgICAgbGV0IHBoYXNlID0gUGhhc2UuTGFuZGluZztcblxuICAgICAgICB0aGlzLmNyZWF0b3IgPSB0aGlzLnByb3BzLnNwYWNlLmN1cnJlbnRTdGF0ZS5nZXRTdGF0ZUV2ZW50cyhFdmVudFR5cGUuUm9vbUNyZWF0ZSwgXCJcIik/LmdldFNlbmRlcigpO1xuICAgICAgICBjb25zdCBzaG93U2V0dXAgPSB0aGlzLnByb3BzLmp1c3RDcmVhdGVkT3B0cyAmJiB0aGlzLmNvbnRleHQuZ2V0VXNlcklkKCkgPT09IHRoaXMuY3JlYXRvcjtcblxuICAgICAgICBpZiAoc2hvd1NldHVwKSB7XG4gICAgICAgICAgICBwaGFzZSA9IHRoaXMucHJvcHMuanVzdENyZWF0ZWRPcHRzLmNyZWF0ZU9wdHMucHJlc2V0ID09PSBQcmVzZXQuUHVibGljQ2hhdFxuICAgICAgICAgICAgICAgID8gUGhhc2UuUHVibGljQ3JlYXRlUm9vbXMgOiBQaGFzZS5Qcml2YXRlU2NvcGU7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgcGhhc2UsXG4gICAgICAgICAgICBzaG93UmlnaHRQYW5lbDogUmlnaHRQYW5lbFN0b3JlLmdldFNoYXJlZEluc3RhbmNlKCkuaXNPcGVuRm9yUm9vbSxcbiAgICAgICAgICAgIG15TWVtYmVyc2hpcDogdGhpcy5wcm9wcy5zcGFjZS5nZXRNeU1lbWJlcnNoaXAoKSxcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLmRpc3BhdGNoZXJSZWYgPSBkZWZhdWx0RGlzcGF0Y2hlci5yZWdpc3Rlcih0aGlzLm9uQWN0aW9uKTtcbiAgICAgICAgdGhpcy5yaWdodFBhbmVsU3RvcmVUb2tlbiA9IFJpZ2h0UGFuZWxTdG9yZS5nZXRTaGFyZWRJbnN0YW5jZSgpLmFkZExpc3RlbmVyKHRoaXMub25SaWdodFBhbmVsU3RvcmVVcGRhdGUpO1xuICAgICAgICB0aGlzLmNvbnRleHQub24oXCJSb29tLm15TWVtYmVyc2hpcFwiLCB0aGlzLm9uTXlNZW1iZXJzaGlwKTtcbiAgICB9XG5cbiAgICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICAgICAgZGVmYXVsdERpc3BhdGNoZXIudW5yZWdpc3Rlcih0aGlzLmRpc3BhdGNoZXJSZWYpO1xuICAgICAgICB0aGlzLnJpZ2h0UGFuZWxTdG9yZVRva2VuLnJlbW92ZSgpO1xuICAgICAgICB0aGlzLmNvbnRleHQub2ZmKFwiUm9vbS5teU1lbWJlcnNoaXBcIiwgdGhpcy5vbk15TWVtYmVyc2hpcCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvbk15TWVtYmVyc2hpcCA9IChyb29tOiBSb29tLCBteU1lbWJlcnNoaXA6IHN0cmluZykgPT4ge1xuICAgICAgICBpZiAocm9vbS5yb29tSWQgPT09IHRoaXMucHJvcHMuc3BhY2Uucm9vbUlkKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgbXlNZW1iZXJzaGlwIH0pO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25SaWdodFBhbmVsU3RvcmVVcGRhdGUgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgc2hvd1JpZ2h0UGFuZWw6IFJpZ2h0UGFuZWxTdG9yZS5nZXRTaGFyZWRJbnN0YW5jZSgpLmlzT3BlbkZvclJvb20sXG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uQWN0aW9uID0gKHBheWxvYWQ6IEFjdGlvblBheWxvYWQpID0+IHtcbiAgICAgICAgaWYgKHBheWxvYWQuYWN0aW9uID09PSBcInZpZXdfcm9vbVwiICYmIHBheWxvYWQucm9vbV9pZCA9PT0gdGhpcy5wcm9wcy5zcGFjZS5yb29tSWQpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBwaGFzZTogUGhhc2UuTGFuZGluZyB9KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwYXlsb2FkLmFjdGlvbiAhPT0gQWN0aW9uLlZpZXdVc2VyICYmIHBheWxvYWQuYWN0aW9uICE9PSBcInZpZXdfM3BpZF9pbnZpdGVcIikgcmV0dXJuO1xuXG4gICAgICAgIGlmIChwYXlsb2FkLmFjdGlvbiA9PT0gQWN0aW9uLlZpZXdVc2VyICYmIHBheWxvYWQubWVtYmVyKSB7XG4gICAgICAgICAgICBkZWZhdWx0RGlzcGF0Y2hlci5kaXNwYXRjaDxTZXRSaWdodFBhbmVsUGhhc2VQYXlsb2FkPih7XG4gICAgICAgICAgICAgICAgYWN0aW9uOiBBY3Rpb24uU2V0UmlnaHRQYW5lbFBoYXNlLFxuICAgICAgICAgICAgICAgIHBoYXNlOiBSaWdodFBhbmVsUGhhc2VzLlNwYWNlTWVtYmVySW5mbyxcbiAgICAgICAgICAgICAgICByZWZpcmVQYXJhbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc3BhY2U6IHRoaXMucHJvcHMuc3BhY2UsXG4gICAgICAgICAgICAgICAgICAgIG1lbWJlcjogcGF5bG9hZC5tZW1iZXIsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKHBheWxvYWQuYWN0aW9uID09PSBcInZpZXdfM3BpZF9pbnZpdGVcIiAmJiBwYXlsb2FkLmV2ZW50KSB7XG4gICAgICAgICAgICBkZWZhdWx0RGlzcGF0Y2hlci5kaXNwYXRjaDxTZXRSaWdodFBhbmVsUGhhc2VQYXlsb2FkPih7XG4gICAgICAgICAgICAgICAgYWN0aW9uOiBBY3Rpb24uU2V0UmlnaHRQYW5lbFBoYXNlLFxuICAgICAgICAgICAgICAgIHBoYXNlOiBSaWdodFBhbmVsUGhhc2VzLlNwYWNlM3BpZE1lbWJlckluZm8sXG4gICAgICAgICAgICAgICAgcmVmaXJlUGFyYW1zOiB7XG4gICAgICAgICAgICAgICAgICAgIHNwYWNlOiB0aGlzLnByb3BzLnNwYWNlLFxuICAgICAgICAgICAgICAgICAgICBldmVudDogcGF5bG9hZC5ldmVudCxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkZWZhdWx0RGlzcGF0Y2hlci5kaXNwYXRjaDxTZXRSaWdodFBhbmVsUGhhc2VQYXlsb2FkPih7XG4gICAgICAgICAgICAgICAgYWN0aW9uOiBBY3Rpb24uU2V0UmlnaHRQYW5lbFBoYXNlLFxuICAgICAgICAgICAgICAgIHBoYXNlOiBSaWdodFBhbmVsUGhhc2VzLlNwYWNlTWVtYmVyTGlzdCxcbiAgICAgICAgICAgICAgICByZWZpcmVQYXJhbXM6IHsgc3BhY2U6IHRoaXMucHJvcHMuc3BhY2UgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHByaXZhdGUgZ29Ub0ZpcnN0Um9vbSA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuZmlyc3RSb29tSWQpIHtcbiAgICAgICAgICAgIGRlZmF1bHREaXNwYXRjaGVyLmRpc3BhdGNoKHtcbiAgICAgICAgICAgICAgICBhY3Rpb246IFwidmlld19yb29tXCIsXG4gICAgICAgICAgICAgICAgcm9vbV9pZDogdGhpcy5zdGF0ZS5maXJzdFJvb21JZCxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHBoYXNlOiBQaGFzZS5MYW5kaW5nIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIHJlbmRlckJvZHkoKSB7XG4gICAgICAgIHN3aXRjaCAodGhpcy5zdGF0ZS5waGFzZSkge1xuICAgICAgICAgICAgY2FzZSBQaGFzZS5MYW5kaW5nOlxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlLm15TWVtYmVyc2hpcCA9PT0gXCJqb2luXCIgJiYgU3BhY2VTdG9yZS5zcGFjZXNFbmFibGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiA8U3BhY2VMYW5kaW5nIHNwYWNlPXt0aGlzLnByb3BzLnNwYWNlfSAvPjtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gPFNwYWNlUHJldmlld1xuICAgICAgICAgICAgICAgICAgICAgICAgc3BhY2U9e3RoaXMucHJvcHMuc3BhY2V9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkpvaW5CdXR0b25DbGlja2VkPXt0aGlzLnByb3BzLm9uSm9pbkJ1dHRvbkNsaWNrZWR9XG4gICAgICAgICAgICAgICAgICAgICAgICBvblJlamVjdEJ1dHRvbkNsaWNrZWQ9e3RoaXMucHJvcHMub25SZWplY3RCdXR0b25DbGlja2VkfVxuICAgICAgICAgICAgICAgICAgICAvPjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFBoYXNlLlB1YmxpY0NyZWF0ZVJvb21zOlxuICAgICAgICAgICAgICAgIHJldHVybiA8U3BhY2VTZXR1cEZpcnN0Um9vbXNcbiAgICAgICAgICAgICAgICAgICAgc3BhY2U9e3RoaXMucHJvcHMuc3BhY2V9XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlPXtfdChcIldoYXQgYXJlIHNvbWUgdGhpbmdzIHlvdSB3YW50IHRvIGRpc2N1c3MgaW4gJShzcGFjZU5hbWUpcz9cIiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3BhY2VOYW1lOiB0aGlzLnByb3BzLmp1c3RDcmVhdGVkT3B0cz8uY3JlYXRlT3B0cz8ubmFtZSB8fCB0aGlzLnByb3BzLnNwYWNlLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17XG4gICAgICAgICAgICAgICAgICAgICAgICBfdChcIkxldCdzIGNyZWF0ZSBhIHJvb20gZm9yIGVhY2ggb2YgdGhlbS5cIikgKyBcIlxcblwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90KFwiWW91IGNhbiBhZGQgbW9yZSBsYXRlciB0b28sIGluY2x1ZGluZyBhbHJlYWR5IGV4aXN0aW5nIG9uZXMuXCIpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgb25GaW5pc2hlZD17KGZpcnN0Um9vbUlkOiBzdHJpbmcpID0+IHRoaXMuc2V0U3RhdGUoeyBwaGFzZTogUGhhc2UuUHVibGljU2hhcmUsIGZpcnN0Um9vbUlkIH0pfVxuICAgICAgICAgICAgICAgIC8+O1xuICAgICAgICAgICAgY2FzZSBQaGFzZS5QdWJsaWNTaGFyZTpcbiAgICAgICAgICAgICAgICByZXR1cm4gPFNwYWNlU2V0dXBQdWJsaWNTaGFyZVxuICAgICAgICAgICAgICAgICAgICBqdXN0Q3JlYXRlZE9wdHM9e3RoaXMucHJvcHMuanVzdENyZWF0ZWRPcHRzfVxuICAgICAgICAgICAgICAgICAgICBzcGFjZT17dGhpcy5wcm9wcy5zcGFjZX1cbiAgICAgICAgICAgICAgICAgICAgb25GaW5pc2hlZD17dGhpcy5nb1RvRmlyc3RSb29tfVxuICAgICAgICAgICAgICAgICAgICBmaXJzdFJvb21JZD17dGhpcy5zdGF0ZS5maXJzdFJvb21JZH1cbiAgICAgICAgICAgICAgICAvPjtcblxuICAgICAgICAgICAgY2FzZSBQaGFzZS5Qcml2YXRlU2NvcGU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDxTcGFjZVNldHVwUHJpdmF0ZVNjb3BlXG4gICAgICAgICAgICAgICAgICAgIHNwYWNlPXt0aGlzLnByb3BzLnNwYWNlfVxuICAgICAgICAgICAgICAgICAgICBqdXN0Q3JlYXRlZE9wdHM9e3RoaXMucHJvcHMuanVzdENyZWF0ZWRPcHRzfVxuICAgICAgICAgICAgICAgICAgICBvbkZpbmlzaGVkPXsoaW52aXRlOiBib29sZWFuKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgcGhhc2U6IGludml0ZSA/IFBoYXNlLlByaXZhdGVDcmVhdGVSb29tcyA6IFBoYXNlLlByaXZhdGVFeGlzdGluZ1Jvb21zIH0pO1xuICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgIC8+O1xuICAgICAgICAgICAgY2FzZSBQaGFzZS5Qcml2YXRlSW52aXRlOlxuICAgICAgICAgICAgICAgIHJldHVybiA8U3BhY2VTZXR1cFByaXZhdGVJbnZpdGVcbiAgICAgICAgICAgICAgICAgICAgc3BhY2U9e3RoaXMucHJvcHMuc3BhY2V9XG4gICAgICAgICAgICAgICAgICAgIG9uRmluaXNoZWQ9eygpID0+IHRoaXMuc2V0U3RhdGUoeyBwaGFzZTogUGhhc2UuTGFuZGluZyB9KX1cbiAgICAgICAgICAgICAgICAvPjtcbiAgICAgICAgICAgIGNhc2UgUGhhc2UuUHJpdmF0ZUNyZWF0ZVJvb21zOlxuICAgICAgICAgICAgICAgIHJldHVybiA8U3BhY2VTZXR1cEZpcnN0Um9vbXNcbiAgICAgICAgICAgICAgICAgICAgc3BhY2U9e3RoaXMucHJvcHMuc3BhY2V9XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlPXtfdChcIldoYXQgcHJvamVjdHMgYXJlIHlvdXIgdGVhbSB3b3JraW5nIG9uP1wiKX1cbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb249e190KFwiV2UnbGwgY3JlYXRlIHJvb21zIGZvciBlYWNoIG9mIHRoZW0uIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiWW91IGNhbiBhZGQgbW9yZSBsYXRlciB0b28sIGluY2x1ZGluZyBhbHJlYWR5IGV4aXN0aW5nIG9uZXMuXCIpfVxuICAgICAgICAgICAgICAgICAgICBvbkZpbmlzaGVkPXsoZmlyc3RSb29tSWQ6IHN0cmluZykgPT4gdGhpcy5zZXRTdGF0ZSh7IHBoYXNlOiBQaGFzZS5Qcml2YXRlSW52aXRlLCBmaXJzdFJvb21JZCB9KX1cbiAgICAgICAgICAgICAgICAvPjtcbiAgICAgICAgICAgIGNhc2UgUGhhc2UuUHJpdmF0ZUV4aXN0aW5nUm9vbXM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDxTcGFjZUFkZEV4aXN0aW5nUm9vbXNcbiAgICAgICAgICAgICAgICAgICAgc3BhY2U9e3RoaXMucHJvcHMuc3BhY2V9XG4gICAgICAgICAgICAgICAgICAgIG9uRmluaXNoZWQ9eygpID0+IHRoaXMuc2V0U3RhdGUoeyBwaGFzZTogUGhhc2UuTGFuZGluZyB9KX1cbiAgICAgICAgICAgICAgICAvPjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgcmlnaHRQYW5lbCA9IHRoaXMuc3RhdGUuc2hvd1JpZ2h0UGFuZWwgJiYgdGhpcy5zdGF0ZS5waGFzZSA9PT0gUGhhc2UuTGFuZGluZ1xuICAgICAgICAgICAgPyA8UmlnaHRQYW5lbCByb29tPXt0aGlzLnByb3BzLnNwYWNlfSByZXNpemVOb3RpZmllcj17dGhpcy5wcm9wcy5yZXNpemVOb3RpZmllcn0gLz5cbiAgICAgICAgICAgIDogbnVsbDtcblxuICAgICAgICByZXR1cm4gPG1haW4gY2xhc3NOYW1lPVwibXhfU3BhY2VSb29tVmlld1wiPlxuICAgICAgICAgICAgPEVycm9yQm91bmRhcnk+XG4gICAgICAgICAgICAgICAgPE1haW5TcGxpdCBwYW5lbD17cmlnaHRQYW5lbH0gcmVzaXplTm90aWZpZXI9e3RoaXMucHJvcHMucmVzaXplTm90aWZpZXJ9PlxuICAgICAgICAgICAgICAgICAgICB7IHRoaXMucmVuZGVyQm9keSgpIH1cbiAgICAgICAgICAgICAgICA8L01haW5TcGxpdD5cbiAgICAgICAgICAgIDwvRXJyb3JCb3VuZGFyeT5cbiAgICAgICAgPC9tYWluPjtcbiAgICB9XG59XG4iXX0=