"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.HeaderKind = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireDefault(require("react"));

var _dispatcher = _interopRequireDefault(require("../../../dispatcher/dispatcher"));

var _RightPanelStore = _interopRequireDefault(require("../../../stores/RightPanelStore"));

var _actions = require("../../../dispatcher/actions");

var _replaceableComponent = require("../../../utils/replaceableComponent");

var _dec, _class;

let HeaderKind;
exports.HeaderKind = HeaderKind;

(function (HeaderKind) {
  HeaderKind["Room"] = "room";
  HeaderKind["Group"] = "group";
})(HeaderKind || (exports.HeaderKind = HeaderKind = {}));

let HeaderButtons = (_dec = (0, _replaceableComponent.replaceableComponent)("views.right_panel.HeaderButtons"), _dec(_class = class HeaderButtons extends _react.default.Component {
  constructor(props, kind) {
    super(props);
    (0, _defineProperty2.default)(this, "storeToken", void 0);
    (0, _defineProperty2.default)(this, "dispatcherRef", void 0);

    const rps = _RightPanelStore.default.getSharedInstance();

    this.state = {
      headerKind: kind,
      phase: kind === HeaderKind.Room ? rps.visibleRoomPanelPhase : rps.visibleGroupPanelPhase
    };
  }

  componentDidMount() {
    this.storeToken = _RightPanelStore.default.getSharedInstance().addListener(this.onRightPanelUpdate.bind(this));
    this.dispatcherRef = _dispatcher.default.register(this.onAction.bind(this)); // used by subclasses
  }

  componentWillUnmount() {
    if (this.storeToken) this.storeToken.remove();
    if (this.dispatcherRef) _dispatcher.default.unregister(this.dispatcherRef);
  }

  setPhase(phase, extras) {
    _dispatcher.default.dispatch({
      action: _actions.Action.SetRightPanelPhase,
      phase: phase,
      refireParams: extras
    });
  }

  isPhase(phases) {
    if (Array.isArray(phases)) {
      return phases.includes(this.state.phase);
    } else {
      return phases === this.state.phase;
    }
  }

  onRightPanelUpdate() {
    const rps = _RightPanelStore.default.getSharedInstance();

    if (this.state.headerKind === HeaderKind.Room) {
      this.setState({
        phase: rps.visibleRoomPanelPhase
      });
    } else if (this.state.headerKind === HeaderKind.Group) {
      this.setState({
        phase: rps.visibleGroupPanelPhase
      });
    }
  } // XXX: Make renderButtons a prop


  render() {
    return /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_HeaderButtons"
    }, this.renderButtons());
  }

}) || _class);
exports.default = HeaderButtons;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZpZXdzL3JpZ2h0X3BhbmVsL0hlYWRlckJ1dHRvbnMudHN4Il0sIm5hbWVzIjpbIkhlYWRlcktpbmQiLCJIZWFkZXJCdXR0b25zIiwiUmVhY3QiLCJDb21wb25lbnQiLCJjb25zdHJ1Y3RvciIsInByb3BzIiwia2luZCIsInJwcyIsIlJpZ2h0UGFuZWxTdG9yZSIsImdldFNoYXJlZEluc3RhbmNlIiwic3RhdGUiLCJoZWFkZXJLaW5kIiwicGhhc2UiLCJSb29tIiwidmlzaWJsZVJvb21QYW5lbFBoYXNlIiwidmlzaWJsZUdyb3VwUGFuZWxQaGFzZSIsImNvbXBvbmVudERpZE1vdW50Iiwic3RvcmVUb2tlbiIsImFkZExpc3RlbmVyIiwib25SaWdodFBhbmVsVXBkYXRlIiwiYmluZCIsImRpc3BhdGNoZXJSZWYiLCJkaXMiLCJyZWdpc3RlciIsIm9uQWN0aW9uIiwiY29tcG9uZW50V2lsbFVubW91bnQiLCJyZW1vdmUiLCJ1bnJlZ2lzdGVyIiwic2V0UGhhc2UiLCJleHRyYXMiLCJkaXNwYXRjaCIsImFjdGlvbiIsIkFjdGlvbiIsIlNldFJpZ2h0UGFuZWxQaGFzZSIsInJlZmlyZVBhcmFtcyIsImlzUGhhc2UiLCJwaGFzZXMiLCJBcnJheSIsImlzQXJyYXkiLCJpbmNsdWRlcyIsInNldFN0YXRlIiwiR3JvdXAiLCJyZW5kZXIiLCJyZW5kZXJCdXR0b25zIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQW9CQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFNQTs7OztJQUVZQSxVOzs7V0FBQUEsVTtBQUFBQSxFQUFBQSxVO0FBQUFBLEVBQUFBLFU7R0FBQUEsVSwwQkFBQUEsVTs7SUFha0JDLGEsV0FEN0IsZ0RBQXFCLGlDQUFyQixDLGdCQUFELE1BQzhCQSxhQUQ5QixTQUM0REMsZUFBTUMsU0FEbEUsQ0FDZ0c7QUFJNUZDLEVBQUFBLFdBQVcsQ0FBQ0MsS0FBRCxFQUFvQkMsSUFBcEIsRUFBc0M7QUFDN0MsVUFBTUQsS0FBTjtBQUQ2QztBQUFBOztBQUc3QyxVQUFNRSxHQUFHLEdBQUdDLHlCQUFnQkMsaUJBQWhCLEVBQVo7O0FBQ0EsU0FBS0MsS0FBTCxHQUFhO0FBQ1RDLE1BQUFBLFVBQVUsRUFBRUwsSUFESDtBQUVUTSxNQUFBQSxLQUFLLEVBQUVOLElBQUksS0FBS04sVUFBVSxDQUFDYSxJQUFwQixHQUEyQk4sR0FBRyxDQUFDTyxxQkFBL0IsR0FBdURQLEdBQUcsQ0FBQ1E7QUFGekQsS0FBYjtBQUlIOztBQUVNQyxFQUFBQSxpQkFBaUIsR0FBRztBQUN2QixTQUFLQyxVQUFMLEdBQWtCVCx5QkFBZ0JDLGlCQUFoQixHQUFvQ1MsV0FBcEMsQ0FBZ0QsS0FBS0Msa0JBQUwsQ0FBd0JDLElBQXhCLENBQTZCLElBQTdCLENBQWhELENBQWxCO0FBQ0EsU0FBS0MsYUFBTCxHQUFxQkMsb0JBQUlDLFFBQUosQ0FBYSxLQUFLQyxRQUFMLENBQWNKLElBQWQsQ0FBbUIsSUFBbkIsQ0FBYixDQUFyQixDQUZ1QixDQUVzQztBQUNoRTs7QUFFTUssRUFBQUEsb0JBQW9CLEdBQUc7QUFDMUIsUUFBSSxLQUFLUixVQUFULEVBQXFCLEtBQUtBLFVBQUwsQ0FBZ0JTLE1BQWhCO0FBQ3JCLFFBQUksS0FBS0wsYUFBVCxFQUF3QkMsb0JBQUlLLFVBQUosQ0FBZSxLQUFLTixhQUFwQjtBQUMzQjs7QUFJTU8sRUFBQUEsUUFBUSxDQUFDaEIsS0FBRCxFQUEwQmlCLE1BQTFCLEVBQTRFO0FBQ3ZGUCx3QkFBSVEsUUFBSixDQUF3QztBQUNwQ0MsTUFBQUEsTUFBTSxFQUFFQyxnQkFBT0Msa0JBRHFCO0FBRXBDckIsTUFBQUEsS0FBSyxFQUFFQSxLQUY2QjtBQUdwQ3NCLE1BQUFBLFlBQVksRUFBRUw7QUFIc0IsS0FBeEM7QUFLSDs7QUFFTU0sRUFBQUEsT0FBTyxDQUFDQyxNQUFELEVBQTRCO0FBQ3RDLFFBQUlDLEtBQUssQ0FBQ0MsT0FBTixDQUFjRixNQUFkLENBQUosRUFBMkI7QUFDdkIsYUFBT0EsTUFBTSxDQUFDRyxRQUFQLENBQWdCLEtBQUs3QixLQUFMLENBQVdFLEtBQTNCLENBQVA7QUFDSCxLQUZELE1BRU87QUFDSCxhQUFPd0IsTUFBTSxLQUFLLEtBQUsxQixLQUFMLENBQVdFLEtBQTdCO0FBQ0g7QUFDSjs7QUFFT08sRUFBQUEsa0JBQWtCLEdBQUc7QUFDekIsVUFBTVosR0FBRyxHQUFHQyx5QkFBZ0JDLGlCQUFoQixFQUFaOztBQUNBLFFBQUksS0FBS0MsS0FBTCxDQUFXQyxVQUFYLEtBQTBCWCxVQUFVLENBQUNhLElBQXpDLEVBQStDO0FBQzNDLFdBQUsyQixRQUFMLENBQWM7QUFBRTVCLFFBQUFBLEtBQUssRUFBRUwsR0FBRyxDQUFDTztBQUFiLE9BQWQ7QUFDSCxLQUZELE1BRU8sSUFBSSxLQUFLSixLQUFMLENBQVdDLFVBQVgsS0FBMEJYLFVBQVUsQ0FBQ3lDLEtBQXpDLEVBQWdEO0FBQ25ELFdBQUtELFFBQUwsQ0FBYztBQUFFNUIsUUFBQUEsS0FBSyxFQUFFTCxHQUFHLENBQUNRO0FBQWIsT0FBZDtBQUNIO0FBQ0osR0FqRDJGLENBbUQ1Rjs7O0FBR08yQixFQUFBQSxNQUFNLEdBQUc7QUFDWix3QkFBTztBQUFLLE1BQUEsU0FBUyxFQUFDO0FBQWYsT0FDRCxLQUFLQyxhQUFMLEVBREMsQ0FBUDtBQUdIOztBQTFEMkYsQyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG5Db3B5cmlnaHQgMjAxNSwgMjAxNiBPcGVuTWFya2V0IEx0ZFxuQ29weXJpZ2h0IDIwMTcgVmVjdG9yIENyZWF0aW9ucyBMdGRcbkNvcHlyaWdodCAyMDE3IE5ldyBWZWN0b3IgTHRkXG5Db3B5cmlnaHQgMjAxOCBOZXcgVmVjdG9yIEx0ZFxuQ29weXJpZ2h0IDIwMTkgVGhlIE1hdHJpeC5vcmcgRm91bmRhdGlvbiBDLkkuQy5cblxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbnlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbllvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuXG4gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cblVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbmRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxubGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4qL1xuXG5pbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IGRpcyBmcm9tICcuLi8uLi8uLi9kaXNwYXRjaGVyL2Rpc3BhdGNoZXInO1xuaW1wb3J0IFJpZ2h0UGFuZWxTdG9yZSBmcm9tIFwiLi4vLi4vLi4vc3RvcmVzL1JpZ2h0UGFuZWxTdG9yZVwiO1xuaW1wb3J0IHsgUmlnaHRQYW5lbFBoYXNlcyB9IGZyb20gXCIuLi8uLi8uLi9zdG9yZXMvUmlnaHRQYW5lbFN0b3JlUGhhc2VzXCI7XG5pbXBvcnQgeyBBY3Rpb24gfSBmcm9tICcuLi8uLi8uLi9kaXNwYXRjaGVyL2FjdGlvbnMnO1xuaW1wb3J0IHtcbiAgICBTZXRSaWdodFBhbmVsUGhhc2VQYXlsb2FkLFxuICAgIFNldFJpZ2h0UGFuZWxQaGFzZVJlZmlyZVBhcmFtcyxcbn0gZnJvbSAnLi4vLi4vLi4vZGlzcGF0Y2hlci9wYXlsb2Fkcy9TZXRSaWdodFBhbmVsUGhhc2VQYXlsb2FkJztcbmltcG9ydCB0eXBlIHsgRXZlbnRTdWJzY3JpcHRpb24gfSBmcm9tIFwiZmJlbWl0dGVyXCI7XG5pbXBvcnQgeyByZXBsYWNlYWJsZUNvbXBvbmVudCB9IGZyb20gXCIuLi8uLi8uLi91dGlscy9yZXBsYWNlYWJsZUNvbXBvbmVudFwiO1xuXG5leHBvcnQgZW51bSBIZWFkZXJLaW5kIHtcbiAgUm9vbSA9IFwicm9vbVwiLFxuICBHcm91cCA9IFwiZ3JvdXBcIixcbn1cblxuaW50ZXJmYWNlIElTdGF0ZSB7XG4gICAgaGVhZGVyS2luZDogSGVhZGVyS2luZDtcbiAgICBwaGFzZTogUmlnaHRQYW5lbFBoYXNlcztcbn1cblxuaW50ZXJmYWNlIElQcm9wcyB7fVxuXG5AcmVwbGFjZWFibGVDb21wb25lbnQoXCJ2aWV3cy5yaWdodF9wYW5lbC5IZWFkZXJCdXR0b25zXCIpXG5leHBvcnQgZGVmYXVsdCBhYnN0cmFjdCBjbGFzcyBIZWFkZXJCdXR0b25zPFAgPSB7fT4gZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8SVByb3BzICYgUCwgSVN0YXRlPiB7XG4gICAgcHJpdmF0ZSBzdG9yZVRva2VuOiBFdmVudFN1YnNjcmlwdGlvbjtcbiAgICBwcml2YXRlIGRpc3BhdGNoZXJSZWY6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKHByb3BzOiBJUHJvcHMgJiBQLCBraW5kOiBIZWFkZXJLaW5kKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcblxuICAgICAgICBjb25zdCBycHMgPSBSaWdodFBhbmVsU3RvcmUuZ2V0U2hhcmVkSW5zdGFuY2UoKTtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgICAgIGhlYWRlcktpbmQ6IGtpbmQsXG4gICAgICAgICAgICBwaGFzZToga2luZCA9PT0gSGVhZGVyS2luZC5Sb29tID8gcnBzLnZpc2libGVSb29tUGFuZWxQaGFzZSA6IHJwcy52aXNpYmxlR3JvdXBQYW5lbFBoYXNlLFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHB1YmxpYyBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgICAgdGhpcy5zdG9yZVRva2VuID0gUmlnaHRQYW5lbFN0b3JlLmdldFNoYXJlZEluc3RhbmNlKCkuYWRkTGlzdGVuZXIodGhpcy5vblJpZ2h0UGFuZWxVcGRhdGUuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuZGlzcGF0Y2hlclJlZiA9IGRpcy5yZWdpc3Rlcih0aGlzLm9uQWN0aW9uLmJpbmQodGhpcykpOyAvLyB1c2VkIGJ5IHN1YmNsYXNzZXNcbiAgICB9XG5cbiAgICBwdWJsaWMgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgICAgIGlmICh0aGlzLnN0b3JlVG9rZW4pIHRoaXMuc3RvcmVUb2tlbi5yZW1vdmUoKTtcbiAgICAgICAgaWYgKHRoaXMuZGlzcGF0Y2hlclJlZikgZGlzLnVucmVnaXN0ZXIodGhpcy5kaXNwYXRjaGVyUmVmKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgYWJzdHJhY3Qgb25BY3Rpb24ocGF5bG9hZCk7XG5cbiAgICBwdWJsaWMgc2V0UGhhc2UocGhhc2U6IFJpZ2h0UGFuZWxQaGFzZXMsIGV4dHJhcz86IFBhcnRpYWw8U2V0UmlnaHRQYW5lbFBoYXNlUmVmaXJlUGFyYW1zPikge1xuICAgICAgICBkaXMuZGlzcGF0Y2g8U2V0UmlnaHRQYW5lbFBoYXNlUGF5bG9hZD4oe1xuICAgICAgICAgICAgYWN0aW9uOiBBY3Rpb24uU2V0UmlnaHRQYW5lbFBoYXNlLFxuICAgICAgICAgICAgcGhhc2U6IHBoYXNlLFxuICAgICAgICAgICAgcmVmaXJlUGFyYW1zOiBleHRyYXMsXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHB1YmxpYyBpc1BoYXNlKHBoYXNlczogc3RyaW5nIHwgc3RyaW5nW10pIHtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocGhhc2VzKSkge1xuICAgICAgICAgICAgcmV0dXJuIHBoYXNlcy5pbmNsdWRlcyh0aGlzLnN0YXRlLnBoYXNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBwaGFzZXMgPT09IHRoaXMuc3RhdGUucGhhc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIG9uUmlnaHRQYW5lbFVwZGF0ZSgpIHtcbiAgICAgICAgY29uc3QgcnBzID0gUmlnaHRQYW5lbFN0b3JlLmdldFNoYXJlZEluc3RhbmNlKCk7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmhlYWRlcktpbmQgPT09IEhlYWRlcktpbmQuUm9vbSkge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHBoYXNlOiBycHMudmlzaWJsZVJvb21QYW5lbFBoYXNlIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdGUuaGVhZGVyS2luZCA9PT0gSGVhZGVyS2luZC5Hcm91cCkge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHBoYXNlOiBycHMudmlzaWJsZUdyb3VwUGFuZWxQaGFzZSB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIFhYWDogTWFrZSByZW5kZXJCdXR0b25zIGEgcHJvcFxuICAgIHB1YmxpYyBhYnN0cmFjdCByZW5kZXJCdXR0b25zKCk6IEpTWC5FbGVtZW50O1xuXG4gICAgcHVibGljIHJlbmRlcigpIHtcbiAgICAgICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwibXhfSGVhZGVyQnV0dG9uc1wiPlxuICAgICAgICAgICAgeyB0aGlzLnJlbmRlckJ1dHRvbnMoKSB9XG4gICAgICAgIDwvZGl2PjtcbiAgICB9XG59XG4iXX0=