"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.Member = exports.KIND_INVITE = exports.KIND_DM = exports.KIND_CALL_TRANSFER = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireWildcard(require("react"));

var _classnames = _interopRequireDefault(require("classnames"));

var _languageHandler = require("../../../languageHandler");

var _MatrixClientPeg = require("../../../MatrixClientPeg");

var _Permalinks = require("../../../utils/permalinks/Permalinks");

var _DMRoomMap = _interopRequireDefault(require("../../../utils/DMRoomMap"));

var _SdkConfig = _interopRequireDefault(require("../../../SdkConfig"));

var Email = _interopRequireWildcard(require("../../../email"));

var _IdentityServerUtils = require("../../../utils/IdentityServerUtils");

var _UrlUtils = require("../../../utils/UrlUtils");

var _dispatcher = _interopRequireDefault(require("../../../dispatcher/dispatcher"));

var _IdentityAuthClient = _interopRequireDefault(require("../../../IdentityAuthClient"));

var _Modal = _interopRequireDefault(require("../../../Modal"));

var _humanize = require("../../../utils/humanize");

var _createRoom = _interopRequireWildcard(require("../../../createRoom"));

var _RoomInvite = require("../../../RoomInvite");

var _Keyboard = require("../../../Keyboard");

var _actions = require("../../../dispatcher/actions");

var _models = require("../../../stores/room-list/models");

var _RoomListStore = _interopRequireDefault(require("../../../stores/room-list/RoomListStore"));

var _CommunityPrototypeStore = require("../../../stores/CommunityPrototypeStore");

var _SettingsStore = _interopRequireDefault(require("../../../settings/SettingsStore"));

var _UIFeature = require("../../../settings/UIFeature");

var _CountlyAnalytics = _interopRequireDefault(require("../../../CountlyAnalytics"));

var _replaceableComponent = require("../../../utils/replaceableComponent");

var _Media = require("../../../customisations/Media");

var _UserAddress = require("../../../UserAddress");

var _BaseAvatar = _interopRequireDefault(require("../avatars/BaseAvatar"));

var _AccessibleButton = _interopRequireDefault(require("../elements/AccessibleButton"));

var _strings = require("../../../utils/strings");

var _AccessibleTooltipButton = _interopRequireDefault(require("../elements/AccessibleTooltipButton"));

var ContextMenu = _interopRequireWildcard(require("../../structures/ContextMenu"));

var _GenericTextContextMenu = _interopRequireDefault(require("../context_menus/GenericTextContextMenu"));

var _Field = _interopRequireDefault(require("../elements/Field"));

var _TabbedView = _interopRequireWildcard(require("../../structures/TabbedView"));

var _DialPad = _interopRequireDefault(require("../voip/DialPad"));

var _QuestionDialog = _interopRequireDefault(require("./QuestionDialog"));

var _Spinner = _interopRequireDefault(require("../elements/Spinner"));

var _BaseDialog = _interopRequireDefault(require("./BaseDialog"));

var _DialPadBackspaceButton = _interopRequireDefault(require("../elements/DialPadBackspaceButton"));

var _SpaceStore = _interopRequireDefault(require("../../../stores/spaces/SpaceStore"));

var _logger = require("matrix-js-sdk/src/logger");

var _dec, _class, _class2, _temp;

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

const KIND_DM = "dm";
exports.KIND_DM = KIND_DM;
const KIND_INVITE = "invite"; // NB. This dialog needs the 'mx_InviteDialog_transferWrapper' wrapper class to have the correct
// padding on the bottom (because all modals have 24px padding on all sides), so this needs to
// be passed when creating the modal

exports.KIND_INVITE = KIND_INVITE;
const KIND_CALL_TRANSFER = "call_transfer";
exports.KIND_CALL_TRANSFER = KIND_CALL_TRANSFER;
const INITIAL_ROOMS_SHOWN = 3; // Number of rooms to show at first

const INCREMENT_ROOMS_SHOWN = 5; // Number of rooms to add when 'show more' is clicked

var TabId; // This is the interface that is expected by various components in the Invite Dialog and RoomInvite.
// It is a bit awkward because it also matches the RoomMember class from the js-sdk with some extra support
// for 3PIDs/email addresses.

(function (TabId) {
  TabId["UserDirectory"] = "users";
  TabId["DialPad"] = "dialpad";
})(TabId || (TabId = {}));

class Member {}

exports.Member = Member;

class DirectoryMember extends Member {
  // eslint-disable-next-line camelcase
  constructor(userDirResult) {
    super();
    (0, _defineProperty2.default)(this, "_userId", void 0);
    (0, _defineProperty2.default)(this, "displayName", void 0);
    (0, _defineProperty2.default)(this, "avatarUrl", void 0);
    this._userId = userDirResult.user_id;
    this.displayName = userDirResult.display_name;
    this.avatarUrl = userDirResult.avatar_url;
  } // These next class members are for the Member interface


  get name() {
    return this.displayName || this._userId;
  }

  get userId() {
    return this._userId;
  }

  getMxcAvatarUrl() {
    return this.avatarUrl;
  }

}

class ThreepidMember extends Member {
  constructor(id) {
    super();
    (0, _defineProperty2.default)(this, "id", void 0);
    this.id = id;
  } // This is a getter that would be falsey on all other implementations. Until we have
  // better type support in the react-sdk we can use this trick to determine the kind
  // of 3PID we're dealing with, if any.


  get isEmail() {
    return this.id.includes('@');
  } // These next class members are for the Member interface


  get name() {
    return this.id;
  }

  get userId() {
    return this.id;
  }

  getMxcAvatarUrl() {
    return null;
  }

}

class DMUserTile extends _react.default.PureComponent {
  constructor(...args) {
    super(...args);
    (0, _defineProperty2.default)(this, "onRemove", e => {
      // Stop the browser from highlighting text
      e.preventDefault();
      e.stopPropagation();
      this.props.onRemove(this.props.member);
    });
  }

  render() {
    const avatarSize = 20;
    const avatar = this.props.member.isEmail ? /*#__PURE__*/_react.default.createElement("img", {
      className: "mx_InviteDialog_userTile_avatar mx_InviteDialog_userTile_threepidAvatar",
      src: require("../../../../res/img/icon-email-pill-avatar.svg"),
      width: avatarSize,
      height: avatarSize
    }) : /*#__PURE__*/_react.default.createElement(_BaseAvatar.default, {
      className: "mx_InviteDialog_userTile_avatar",
      url: this.props.member.getMxcAvatarUrl() ? (0, _Media.mediaFromMxc)(this.props.member.getMxcAvatarUrl()).getSquareThumbnailHttp(avatarSize) : null,
      name: this.props.member.name,
      idName: this.props.member.userId,
      width: avatarSize,
      height: avatarSize
    });
    let closeButton;

    if (this.props.onRemove) {
      closeButton = /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
        className: "mx_InviteDialog_userTile_remove",
        onClick: this.onRemove
      }, /*#__PURE__*/_react.default.createElement("img", {
        src: require("../../../../res/img/icon-pill-remove.svg"),
        alt: (0, _languageHandler._t)('Remove'),
        width: 8,
        height: 8
      }));
    }

    return /*#__PURE__*/_react.default.createElement("span", {
      className: "mx_InviteDialog_userTile"
    }, /*#__PURE__*/_react.default.createElement("span", {
      className: "mx_InviteDialog_userTile_pill"
    }, avatar, /*#__PURE__*/_react.default.createElement("span", {
      className: "mx_InviteDialog_userTile_name"
    }, this.props.member.name)), closeButton);
  }

}

class DMRoomTile extends _react.default.PureComponent {
  constructor(...args) {
    super(...args);
    (0, _defineProperty2.default)(this, "onClick", e => {
      // Stop the browser from highlighting text
      e.preventDefault();
      e.stopPropagation();
      this.props.onToggle(this.props.member);
    });
  }

  highlightName(str) {
    if (!this.props.highlightWord) return str; // We convert things to lowercase for index searching, but pull substrings from
    // the submitted text to preserve case. Note: we don't need to htmlEntities the
    // string because React will safely encode the text for us.

    const lowerStr = str.toLowerCase();
    const filterStr = this.props.highlightWord.toLowerCase();
    const result = [];
    let i = 0;
    let ii;

    while ((ii = lowerStr.indexOf(filterStr, i)) >= 0) {
      // Push any text we missed (first bit/middle of text)
      if (ii > i) {
        // Push any text we aren't highlighting (middle of text match, or beginning of text)
        result.push( /*#__PURE__*/_react.default.createElement("span", {
          key: i + 'begin'
        }, str.substring(i, ii)));
      }

      i = ii; // copy over ii only if we have a match (to preserve i for end-of-text matching)
      // Highlight the word the user entered

      const substr = str.substring(i, filterStr.length + i);
      result.push( /*#__PURE__*/_react.default.createElement("span", {
        className: "mx_InviteDialog_roomTile_highlight",
        key: i + 'bold'
      }, substr));
      i += substr.length;
    } // Push any text we missed (end of text)


    if (i < str.length) {
      result.push( /*#__PURE__*/_react.default.createElement("span", {
        key: i + 'end'
      }, str.substring(i)));
    }

    return result;
  }

  render() {
    let timestamp = null;

    if (this.props.lastActiveTs) {
      const humanTs = (0, _humanize.humanizeTime)(this.props.lastActiveTs);
      timestamp = /*#__PURE__*/_react.default.createElement("span", {
        className: "mx_InviteDialog_roomTile_time"
      }, humanTs);
    }

    const avatarSize = 36;
    const avatar = this.props.member.isEmail ? /*#__PURE__*/_react.default.createElement("img", {
      src: require("../../../../res/img/icon-email-pill-avatar.svg"),
      width: avatarSize,
      height: avatarSize
    }) : /*#__PURE__*/_react.default.createElement(_BaseAvatar.default, {
      url: this.props.member.getMxcAvatarUrl() ? (0, _Media.mediaFromMxc)(this.props.member.getMxcAvatarUrl()).getSquareThumbnailHttp(avatarSize) : null,
      name: this.props.member.name,
      idName: this.props.member.userId,
      width: avatarSize,
      height: avatarSize
    });
    let checkmark = null;

    if (this.props.isSelected) {
      // To reduce flickering we put the 'selected' room tile above the real avatar
      checkmark = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_InviteDialog_roomTile_selected"
      });
    } // To reduce flickering we put the checkmark on top of the actual avatar (prevents
    // the browser from reloading the image source when the avatar remounts).


    const stackedAvatar = /*#__PURE__*/_react.default.createElement("span", {
      className: "mx_InviteDialog_roomTile_avatarStack"
    }, avatar, checkmark);

    const caption = this.props.member.isEmail ? (0, _languageHandler._t)("Invite by email") : this.highlightName(this.props.member.userId);
    return /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_InviteDialog_roomTile",
      onClick: this.onClick
    }, stackedAvatar, /*#__PURE__*/_react.default.createElement("span", {
      className: "mx_InviteDialog_roomTile_nameStack"
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_InviteDialog_roomTile_name"
    }, this.highlightName(this.props.member.name)), /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_InviteDialog_roomTile_userId"
    }, caption)), timestamp);
  }

}

let InviteDialog = (_dec = (0, _replaceableComponent.replaceableComponent)("views.dialogs.InviteDialog"), _dec(_class = (_temp = _class2 = class InviteDialog extends _react.default.PureComponent {
  // actually number because we're in the browser
  constructor(props) {
    super(props);
    (0, _defineProperty2.default)(this, "closeCopiedTooltip", void 0);
    (0, _defineProperty2.default)(this, "debounceTimer", null);
    (0, _defineProperty2.default)(this, "editorRef", /*#__PURE__*/(0, _react.createRef)());
    (0, _defineProperty2.default)(this, "numberEntryFieldRef", /*#__PURE__*/(0, _react.createRef)());
    (0, _defineProperty2.default)(this, "unmounted", false);
    (0, _defineProperty2.default)(this, "onConsultFirstChange", ev => {
      this.setState({
        consultFirst: ev.target.checked
      });
    });
    (0, _defineProperty2.default)(this, "startDm", async () => {
      this.setState({
        busy: true
      });

      const client = _MatrixClientPeg.MatrixClientPeg.get();

      const targets = this.convertFilter();
      const targetIds = targets.map(t => t.userId); // Check if there is already a DM with these people and reuse it if possible.

      let existingRoom;

      if (targetIds.length === 1) {
        existingRoom = (0, _createRoom.findDMForUser)(client, targetIds[0]);
      } else {
        existingRoom = _DMRoomMap.default.shared().getDMRoomForIdentifiers(targetIds);
      }

      if (existingRoom) {
        _dispatcher.default.dispatch({
          action: _actions.Action.ViewRoom,
          room_id: existingRoom.roomId,
          should_peek: false,
          joining: false
        });

        this.props.onFinished();
        return;
      }

      const createRoomOptions = {
        inlineErrors: true
      }; // XXX: Type out `createRoomOptions`

      if ((0, _createRoom.privateShouldBeEncrypted)()) {
        // Check whether all users have uploaded device keys before.
        // If so, enable encryption in the new room.
        const has3PidMembers = targets.some(t => t instanceof ThreepidMember);

        if (!has3PidMembers) {
          const allHaveDeviceKeys = await (0, _createRoom.canEncryptToAllUsers)(client, targetIds);

          if (allHaveDeviceKeys) {
            createRoomOptions.encryption = true;
          }
        }
      } // Check if it's a traditional DM and create the room if required.
      // TODO: [Canonical DMs] Remove this check and instead just create the multi-person DM


      try {
        const isSelf = targetIds.length === 1 && targetIds[0] === client.getUserId();

        if (targetIds.length === 1 && !isSelf) {
          createRoomOptions.dmUserId = targetIds[0];
        }

        if (targetIds.length > 1) {
          createRoomOptions.createOpts = targetIds.reduce((roomOptions, address) => {
            const type = (0, _UserAddress.getAddressType)(address);

            if (type === 'email') {
              const invite = {
                id_server: client.getIdentityServerUrl(true),
                medium: 'email',
                address
              };
              roomOptions.invite_3pid.push(invite);
            } else if (type === 'mx-user-id') {
              roomOptions.invite.push(address);
            }

            return roomOptions;
          }, {
            invite: [],
            invite_3pid: []
          });
        }

        await (0, _createRoom.default)(createRoomOptions);
        this.props.onFinished();
      } catch (err) {
        _logger.logger.error(err);

        this.setState({
          busy: false,
          errorText: (0, _languageHandler._t)("We couldn't create your DM.")
        });
      }
    });
    (0, _defineProperty2.default)(this, "inviteUsers", async () => {
      const startTime = _CountlyAnalytics.default.getTimestamp();

      this.setState({
        busy: true
      });
      this.convertFilter();
      const targets = this.convertFilter();
      const targetIds = targets.map(t => t.userId);

      const cli = _MatrixClientPeg.MatrixClientPeg.get();

      const room = cli.getRoom(this.props.roomId);

      if (!room) {
        _logger.logger.error("Failed to find the room to invite users to");

        this.setState({
          busy: false,
          errorText: (0, _languageHandler._t)("Something went wrong trying to invite the users.")
        });
        return;
      }

      try {
        const result = await (0, _RoomInvite.inviteMultipleToRoom)(this.props.roomId, targetIds);

        _CountlyAnalytics.default.instance.trackSendInvite(startTime, this.props.roomId, targetIds.length);

        if (!this.shouldAbortAfterInviteError(result, room)) {
          // handles setting error message too
          this.props.onFinished();
        }

        if (cli.isRoomEncrypted(this.props.roomId)) {
          const visibilityEvent = room.currentState.getStateEvents("m.room.history_visibility", "");
          const visibility = visibilityEvent && visibilityEvent.getContent() && visibilityEvent.getContent().history_visibility;

          if (visibility == "world_readable" || visibility == "shared") {
            const invitedUsers = [];

            for (const [addr, state] of Object.entries(result.states)) {
              if (state === "invited" && (0, _UserAddress.getAddressType)(addr) === "mx-user-id") {
                invitedUsers.push(addr);
              }
            }

            _logger.logger.log("Sharing history with", invitedUsers);

            cli.sendSharedHistoryKeys(this.props.roomId, invitedUsers);
          }
        }
      } catch (err) {
        _logger.logger.error(err);

        this.setState({
          busy: false,
          errorText: (0, _languageHandler._t)("We couldn't invite those users. Please check the users you want to invite and try again.")
        });
      }
    });
    (0, _defineProperty2.default)(this, "transferCall", async () => {
      if (this.state.currentTabId == TabId.UserDirectory) {
        this.convertFilter();
        const targets = this.convertFilter();
        const targetIds = targets.map(t => t.userId);

        if (targetIds.length > 1) {
          this.setState({
            errorText: (0, _languageHandler._t)("A call can only be transferred to a single user.")
          });
          return;
        }

        _dispatcher.default.dispatch({
          action: _actions.Action.TransferCallToMatrixID,
          call: this.props.call,
          destination: targetIds[0],
          consultFirst: this.state.consultFirst
        });
      } else {
        _dispatcher.default.dispatch({
          action: _actions.Action.TransferCallToPhoneNumber,
          call: this.props.call,
          destination: this.state.dialPadValue,
          consultFirst: this.state.consultFirst
        });
      }

      this.props.onFinished();
    });
    (0, _defineProperty2.default)(this, "onKeyDown", e => {
      if (this.state.busy) return;
      const value = e.target.value.trim();
      const hasModifiers = e.ctrlKey || e.shiftKey || e.metaKey;

      if (!value && this.state.targets.length > 0 && e.key === _Keyboard.Key.BACKSPACE && !hasModifiers) {
        // when the field is empty and the user hits backspace remove the right-most target
        e.preventDefault();
        this.removeMember(this.state.targets[this.state.targets.length - 1]);
      } else if (value && e.key === _Keyboard.Key.ENTER && !hasModifiers) {
        // when the user hits enter with something in their field try to convert it
        e.preventDefault();
        this.convertFilter();
      } else if (value && e.key === _Keyboard.Key.SPACE && !hasModifiers && value.includes("@") && !value.includes(" ")) {
        // when the user hits space and their input looks like an e-mail/MXID then try to convert it
        e.preventDefault();
        this.convertFilter();
      }
    });
    (0, _defineProperty2.default)(this, "onCancel", () => {
      this.props.onFinished([]);
    });
    (0, _defineProperty2.default)(this, "updateSuggestions", async term => {
      _MatrixClientPeg.MatrixClientPeg.get().searchUserDirectory({
        term
      }).then(async r => {
        if (term !== this.state.filterText) {
          // Discard the results - we were probably too slow on the server-side to make
          // these results useful. This is a race we want to avoid because we could overwrite
          // more accurate results.
          return;
        }

        if (!r.results) r.results = []; // While we're here, try and autocomplete a search result for the mxid itself
        // if there's no matches (and the input looks like a mxid).

        if (term[0] === '@' && term.indexOf(':') > 1) {
          try {
            const profile = await _MatrixClientPeg.MatrixClientPeg.get().getProfileInfo(term);

            if (profile) {
              // If we have a profile, we have enough information to assume that
              // the mxid can be invited - add it to the list. We stick it at the
              // top so it is most obviously presented to the user.
              r.results.splice(0, 0, {
                user_id: term,
                display_name: profile['displayname'],
                avatar_url: profile['avatar_url']
              });
            }
          } catch (e) {
            _logger.logger.warn("Non-fatal error trying to make an invite for a user ID");

            _logger.logger.warn(e); // Add a result anyways, just without a profile. We stick it at the
            // top so it is most obviously presented to the user.


            r.results.splice(0, 0, {
              user_id: term,
              display_name: term,
              avatar_url: null
            });
          }
        }

        this.setState({
          serverResultsMixin: r.results.map(u => ({
            userId: u.user_id,
            user: new DirectoryMember(u)
          }))
        });
      }).catch(e => {
        _logger.logger.error("Error searching user directory:");

        _logger.logger.error(e);

        this.setState({
          serverResultsMixin: []
        }); // clear results because it's moderately fatal
      }); // Whenever we search the directory, also try to search the identity server. It's
      // all debounced the same anyways.


      if (!this.state.canUseIdentityServer) {
        // The user doesn't have an identity server set - warn them of that.
        this.setState({
          tryingIdentityServer: true
        });
        return;
      }

      if (term.indexOf('@') > 0 && Email.looksValid(term) && _SettingsStore.default.getValue(_UIFeature.UIFeature.IdentityServer)) {
        // Start off by suggesting the plain email while we try and resolve it
        // to a real account.
        this.setState({
          // per above: the userId is a lie here - it's just a regular identifier
          threepidResultsMixin: [{
            user: new ThreepidMember(term),
            userId: term
          }]
        });

        try {
          const authClient = new _IdentityAuthClient.default();
          const token = await authClient.getAccessToken();
          if (term !== this.state.filterText) return; // abandon hope

          const lookup = await _MatrixClientPeg.MatrixClientPeg.get().lookupThreePid('email', term, undefined, // callback
          token);
          if (term !== this.state.filterText) return; // abandon hope

          if (!lookup || !lookup.mxid) {
            // We weren't able to find anyone - we're already suggesting the plain email
            // as an alternative, so do nothing.
            return;
          } // We append the user suggestion to give the user an option to click
          // the email anyways, and so we don't cause things to jump around. In
          // theory, the user would see the user pop up and think "ah yes, that
          // person!"


          const profile = await _MatrixClientPeg.MatrixClientPeg.get().getProfileInfo(lookup.mxid);
          if (term !== this.state.filterText || !profile) return; // abandon hope

          this.setState({
            threepidResultsMixin: [...this.state.threepidResultsMixin, {
              user: new DirectoryMember({
                user_id: lookup.mxid,
                display_name: profile.displayname,
                avatar_url: profile.avatar_url
              }),
              userId: lookup.mxid
            }]
          });
        } catch (e) {
          _logger.logger.error("Error searching identity server:");

          _logger.logger.error(e);

          this.setState({
            threepidResultsMixin: []
          }); // clear results because it's moderately fatal
        }
      }
    });
    (0, _defineProperty2.default)(this, "updateFilter", e => {
      const term = e.target.value;
      this.setState({
        filterText: term
      }); // Debounce server lookups to reduce spam. We don't clear the existing server
      // results because they might still be vaguely accurate, likewise for races which
      // could happen here.

      if (this.debounceTimer) {
        clearTimeout(this.debounceTimer);
      }

      this.debounceTimer = setTimeout(() => {
        this.updateSuggestions(term);
      }, 150); // 150ms debounce (human reaction time + some)
    });
    (0, _defineProperty2.default)(this, "showMoreRecents", () => {
      this.setState({
        numRecentsShown: this.state.numRecentsShown + INCREMENT_ROOMS_SHOWN
      });
    });
    (0, _defineProperty2.default)(this, "showMoreSuggestions", () => {
      this.setState({
        numSuggestionsShown: this.state.numSuggestionsShown + INCREMENT_ROOMS_SHOWN
      });
    });
    (0, _defineProperty2.default)(this, "toggleMember", member => {
      if (!this.state.busy) {
        let filterText = this.state.filterText;
        let targets = this.state.targets.map(t => t); // cheap clone for mutation

        const idx = targets.indexOf(member);

        if (idx >= 0) {
          targets.splice(idx, 1);
        } else {
          if (this.props.kind === KIND_CALL_TRANSFER && targets.length > 0) {
            targets = [];
          }

          targets.push(member);
          filterText = ""; // clear the filter when the user accepts a suggestion
        }

        this.setState({
          targets,
          filterText
        });

        if (this.editorRef && this.editorRef.current) {
          this.editorRef.current.focus();
        }
      }
    });
    (0, _defineProperty2.default)(this, "removeMember", member => {
      const targets = this.state.targets.map(t => t); // cheap clone for mutation

      const idx = targets.indexOf(member);

      if (idx >= 0) {
        targets.splice(idx, 1);
        this.setState({
          targets
        });
      }

      if (this.editorRef && this.editorRef.current) {
        this.editorRef.current.focus();
      }
    });
    (0, _defineProperty2.default)(this, "onPaste", async e => {
      if (this.state.filterText) {
        // if the user has already typed something, just let them
        // paste normally.
        return;
      } // Prevent the text being pasted into the input


      e.preventDefault(); // Process it as a list of addresses to add instead

      const text = e.clipboardData.getData("text");
      const possibleMembers = [// If we can avoid hitting the profile endpoint, we should.
      ...this.state.recents, ...this.state.suggestions, ...this.state.serverResultsMixin, ...this.state.threepidResultsMixin];
      const toAdd = [];
      const failed = [];
      const potentialAddresses = text.split(/[\s,]+/).map(p => p.trim()).filter(p => !!p); // filter empty strings

      for (const address of potentialAddresses) {
        const member = possibleMembers.find(m => m.userId === address);

        if (member) {
          toAdd.push(member.user);
          continue;
        }

        if (address.indexOf('@') > 0 && Email.looksValid(address)) {
          toAdd.push(new ThreepidMember(address));
          continue;
        }

        if (address[0] !== '@') {
          failed.push(address); // not a user ID

          continue;
        }

        try {
          const profile = await _MatrixClientPeg.MatrixClientPeg.get().getProfileInfo(address);
          const displayName = profile ? profile.displayname : null;
          const avatarUrl = profile ? profile.avatar_url : null;
          toAdd.push(new DirectoryMember({
            user_id: address,
            display_name: displayName,
            avatar_url: avatarUrl
          }));
        } catch (e) {
          _logger.logger.error("Error looking up profile for " + address);

          _logger.logger.error(e);

          failed.push(address);
        }
      }

      if (this.unmounted) return;

      if (failed.length > 0) {
        _Modal.default.createTrackedDialog('Invite Paste Fail', '', _QuestionDialog.default, {
          title: (0, _languageHandler._t)('Failed to find the following users'),
          description: (0, _languageHandler._t)("The following users might not exist or are invalid, and cannot be invited: %(csvNames)s", {
            csvNames: failed.join(", ")
          }),
          button: (0, _languageHandler._t)('OK')
        });
      }

      this.setState({
        targets: [...this.state.targets, ...toAdd]
      });
    });
    (0, _defineProperty2.default)(this, "onClickInputArea", e => {
      // Stop the browser from highlighting text
      e.preventDefault();
      e.stopPropagation();

      if (this.editorRef && this.editorRef.current) {
        this.editorRef.current.focus();
      }
    });
    (0, _defineProperty2.default)(this, "onUseDefaultIdentityServerClick", e => {
      e.preventDefault(); // Update the IS in account data. Actually using it may trigger terms.
      // eslint-disable-next-line react-hooks/rules-of-hooks

      (0, _IdentityServerUtils.useDefaultIdentityServer)();
      this.setState({
        canUseIdentityServer: true,
        tryingIdentityServer: false
      });
    });
    (0, _defineProperty2.default)(this, "onManageSettingsClick", e => {
      e.preventDefault();

      _dispatcher.default.fire(_actions.Action.ViewUserSettings);

      this.props.onFinished();
    });
    (0, _defineProperty2.default)(this, "onCommunityInviteClick", e => {
      this.props.onFinished();
      (0, _RoomInvite.showCommunityInviteDialog)(_CommunityPrototypeStore.CommunityPrototypeStore.instance.getSelectedCommunityId());
    });
    (0, _defineProperty2.default)(this, "onDialFormSubmit", ev => {
      ev.preventDefault();
      this.transferCall();
    });
    (0, _defineProperty2.default)(this, "onDialChange", ev => {
      this.setState({
        dialPadValue: ev.currentTarget.value
      });
    });
    (0, _defineProperty2.default)(this, "onDigitPress", (digit, ev) => {
      this.setState({
        dialPadValue: this.state.dialPadValue + digit
      }); // Keep the number field focused so that keyboard entry is still available
      // However, don't focus if this wasn't the result of directly clicking on the button,
      // i.e someone using keyboard navigation.

      if (ev.type === "click") {
        var _this$numberEntryFiel;

        (_this$numberEntryFiel = this.numberEntryFieldRef.current) === null || _this$numberEntryFiel === void 0 ? void 0 : _this$numberEntryFiel.focus();
      }
    });
    (0, _defineProperty2.default)(this, "onDeletePress", ev => {
      if (this.state.dialPadValue.length === 0) return;
      this.setState({
        dialPadValue: this.state.dialPadValue.slice(0, -1)
      }); // Keep the number field focused so that keyboard entry is still available
      // However, don't focus if this wasn't the result of directly clicking on the button,
      // i.e someone using keyboard navigation.

      if (ev.type === "click") {
        var _this$numberEntryFiel2;

        (_this$numberEntryFiel2 = this.numberEntryFieldRef.current) === null || _this$numberEntryFiel2 === void 0 ? void 0 : _this$numberEntryFiel2.focus();
      }
    });
    (0, _defineProperty2.default)(this, "onTabChange", tabId => {
      this.setState({
        currentTabId: tabId
      });
    });
    (0, _defineProperty2.default)(this, "onCopyClick", async e => {
      e.preventDefault();
      const target = e.target; // copy target before we go async and React throws it away

      const successful = await (0, _strings.copyPlaintext)((0, _Permalinks.makeUserPermalink)(_MatrixClientPeg.MatrixClientPeg.get().getUserId()));
      const buttonRect = target.getBoundingClientRect();
      const {
        close
      } = ContextMenu.createMenu(_GenericTextContextMenu.default, _objectSpread(_objectSpread({}, (0, ContextMenu.toRightOf)(buttonRect, 2)), {}, {
        message: successful ? (0, _languageHandler._t)("Copied!") : (0, _languageHandler._t)("Failed to copy")
      })); // Drop a reference to this close handler for componentWillUnmount

      this.closeCopiedTooltip = target.onmouseleave = close;
    });

    if (props.kind === KIND_INVITE && !props.roomId) {
      throw new Error("When using KIND_INVITE a roomId is required for an InviteDialog");
    } else if (props.kind === KIND_CALL_TRANSFER && !props.call) {
      throw new Error("When using KIND_CALL_TRANSFER a call is required for an InviteDialog");
    }

    const alreadyInvited = new Set([_MatrixClientPeg.MatrixClientPeg.get().getUserId(), _SdkConfig.default.get()['welcomeUserId']]);

    if (props.roomId) {
      const room = _MatrixClientPeg.MatrixClientPeg.get().getRoom(props.roomId);

      if (!room) throw new Error("Room ID given to InviteDialog does not look like a room");
      room.getMembersWithMembership('invite').forEach(m => alreadyInvited.add(m.userId));
      room.getMembersWithMembership('join').forEach(m => alreadyInvited.add(m.userId)); // add banned users, so we don't try to invite them

      room.getMembersWithMembership('ban').forEach(m => alreadyInvited.add(m.userId));

      _CountlyAnalytics.default.instance.trackBeginInvite(props.roomId);
    }

    this.state = {
      targets: [],
      // array of Member objects (see interface above)
      filterText: this.props.initialText,
      recents: InviteDialog.buildRecents(alreadyInvited),
      numRecentsShown: INITIAL_ROOMS_SHOWN,
      suggestions: this.buildSuggestions(alreadyInvited),
      numSuggestionsShown: INITIAL_ROOMS_SHOWN,
      serverResultsMixin: [],
      threepidResultsMixin: [],
      canUseIdentityServer: !!_MatrixClientPeg.MatrixClientPeg.get().getIdentityServerUrl(),
      tryingIdentityServer: false,
      consultFirst: false,
      dialPadValue: '',
      currentTabId: TabId.UserDirectory,
      // These two flags are used for the 'Go' button to communicate what is going on.
      busy: false,
      errorText: null
    };
  }

  componentDidMount() {
    if (this.props.initialText) {
      this.updateSuggestions(this.props.initialText);
    }
  }

  componentWillUnmount() {
    this.unmounted = true; // if the Copied tooltip is open then get rid of it, there are ways to close the modal which wouldn't close
    // the tooltip otherwise, such as pressing Escape or clicking X really quickly

    if (this.closeCopiedTooltip) this.closeCopiedTooltip();
  }

  static buildRecents(excludedTargetIds) {
    const rooms = _DMRoomMap.default.shared().getUniqueRoomsWithIndividuals(); // map of userId => js-sdk Room
    // Also pull in all the rooms tagged as DefaultTagID.DM so we don't miss anything. Sometimes the
    // room list doesn't tag the room for the DMRoomMap, but does for the room list.


    const dmTaggedRooms = _RoomListStore.default.instance.orderedLists[_models.DefaultTagID.DM] || [];

    const myUserId = _MatrixClientPeg.MatrixClientPeg.get().getUserId();

    for (const dmRoom of dmTaggedRooms) {
      const otherMembers = dmRoom.getJoinedMembers().filter(u => u.userId !== myUserId);

      for (const member of otherMembers) {
        if (rooms[member.userId]) continue; // already have a room

        _logger.logger.warn(`Adding DM room for ${member.userId} as ${dmRoom.roomId} from tag, not DM map`);

        rooms[member.userId] = dmRoom;
      }
    }

    const recents = [];

    for (const userId in rooms) {
      // Filter out user IDs that are already in the room / should be excluded
      if (excludedTargetIds.has(userId)) {
        _logger.logger.warn(`[Invite:Recents] Excluding ${userId} from recents`);

        continue;
      }

      const room = rooms[userId];
      const member = room.getMember(userId);

      if (!member) {
        // just skip people who don't have memberships for some reason
        _logger.logger.warn(`[Invite:Recents] ${userId} is missing a member object in their own DM (${room.roomId})`);

        continue;
      } // Find the last timestamp for a message event


      const searchTypes = ["m.room.message", "m.room.encrypted", "m.sticker"];
      const maxSearchEvents = 20; // to prevent traversing history

      let lastEventTs = 0;

      if (room.timeline && room.timeline.length) {
        for (let i = room.timeline.length - 1; i >= 0; i--) {
          const ev = room.timeline[i];

          if (searchTypes.includes(ev.getType())) {
            lastEventTs = ev.getTs();
            break;
          }

          if (room.timeline.length - i > maxSearchEvents) break;
        }
      }

      if (!lastEventTs) {
        // something weird is going on with this room
        _logger.logger.warn(`[Invite:Recents] ${userId} (${room.roomId}) has a weird last timestamp: ${lastEventTs}`);

        continue;
      }

      recents.push({
        userId,
        user: member,
        lastActive: lastEventTs
      });
    }

    if (!recents) _logger.logger.warn("[Invite:Recents] No recents to suggest!"); // Sort the recents by last active to save us time later

    recents.sort((a, b) => b.lastActive - a.lastActive);
    return recents;
  }

  buildSuggestions(excludedTargetIds) {
    const maxConsideredMembers = 200;

    const joinedRooms = _MatrixClientPeg.MatrixClientPeg.get().getRooms().filter(r => r.getMyMembership() === 'join' && r.getJoinedMemberCount() <= maxConsideredMembers); // Generates { userId: {member, rooms[]} }


    const memberRooms = joinedRooms.reduce((members, room) => {
      // Filter out DMs (we'll handle these in the recents section)
      if (_DMRoomMap.default.shared().getUserIdForRoomId(room.roomId)) {
        return members; // Do nothing
      }

      const joinedMembers = room.getJoinedMembers().filter(u => !excludedTargetIds.has(u.userId));

      for (const member of joinedMembers) {
        // Filter out user IDs that are already in the room / should be excluded
        if (excludedTargetIds.has(member.userId)) {
          continue;
        }

        if (!members[member.userId]) {
          members[member.userId] = {
            member: member,
            // Track the room size of the 'picked' member so we can use the profile of
            // the smallest room (likely a DM).
            pickedMemberRoomSize: room.getJoinedMemberCount(),
            rooms: []
          };
        }

        members[member.userId].rooms.push(room);

        if (room.getJoinedMemberCount() < members[member.userId].pickedMemberRoomSize) {
          members[member.userId].member = member;
          members[member.userId].pickedMemberRoomSize = room.getJoinedMemberCount();
        }
      }

      return members;
    }, {}); // Generates { userId: {member, numRooms, score} }

    const memberScores = Object.values(memberRooms).reduce((scores, entry) => {
      const numMembersTotal = entry.rooms.reduce((c, r) => c + r.getJoinedMemberCount(), 0);
      const maxRange = maxConsideredMembers * entry.rooms.length;
      scores[entry.member.userId] = {
        member: entry.member,
        numRooms: entry.rooms.length,
        score: Math.max(0, Math.pow(1 - numMembersTotal / maxRange, 5))
      };
      return scores;
    }, {}); // Now that we have scores for being in rooms, boost those people who have sent messages
    // recently, as a way to improve the quality of suggestions. We do this by checking every
    // room to see who has sent a message in the last few hours, and giving them a score
    // which correlates to the freshness of their message. In theory, this results in suggestions
    // which are closer to "continue this conversation" rather than "this person exists".

    const trueJoinedRooms = _MatrixClientPeg.MatrixClientPeg.get().getRooms().filter(r => r.getMyMembership() === 'join');

    const now = new Date().getTime();
    const earliestAgeConsidered = now - 60 * 60 * 1000; // 1 hour ago

    const maxMessagesConsidered = 50; // so we don't iterate over a huge amount of traffic

    const lastSpoke = {}; // userId: timestamp

    const lastSpokeMembers = {}; // userId: room member

    for (const room of trueJoinedRooms) {
      // Skip low priority rooms and DMs
      const isDm = _DMRoomMap.default.shared().getUserIdForRoomId(room.roomId);

      if (Object.keys(room.tags).includes("m.lowpriority") || isDm) {
        continue;
      }

      const events = room.getLiveTimeline().getEvents(); // timelines are most recent last

      for (let i = events.length - 1; i >= Math.max(0, events.length - maxMessagesConsidered); i--) {
        const ev = events[i];

        if (excludedTargetIds.has(ev.getSender())) {
          continue;
        }

        if (ev.getTs() <= earliestAgeConsidered) {
          break; // give up: all events from here on out are too old
        }

        if (!lastSpoke[ev.getSender()] || lastSpoke[ev.getSender()] < ev.getTs()) {
          lastSpoke[ev.getSender()] = ev.getTs();
          lastSpokeMembers[ev.getSender()] = room.getMember(ev.getSender());
        }
      }
    }

    for (const userId in lastSpoke) {
      const ts = lastSpoke[userId];
      const member = lastSpokeMembers[userId];
      if (!member) continue; // skip people we somehow don't have profiles for
      // Scores from being in a room give a 'good' score of about 1.0-1.5, so for our
      // boost we'll try and award at least +1.0 for making the list, with +4.0 being
      // an approximate maximum for being selected.

      const distanceFromNow = Math.abs(now - ts); // abs to account for slight future messages

      const inverseTime = now - earliestAgeConsidered - distanceFromNow;
      const scoreBoost = Math.max(1, inverseTime / (15 * 60 * 1000)); // 15min segments to keep scores sane

      let record = memberScores[userId];
      if (!record) record = memberScores[userId] = {
        score: 0
      };
      record.member = member;
      record.score += scoreBoost;
    }

    const members = Object.values(memberScores);
    members.sort((a, b) => {
      if (a.score === b.score) {
        if (a.numRooms === b.numRooms) {
          return (0, _strings.compare)(a.member.userId, b.member.userId);
        }

        return b.numRooms - a.numRooms;
      }

      return b.score - a.score;
    });
    return members.map(m => ({
      userId: m.member.userId,
      user: m.member
    }));
  }

  shouldAbortAfterInviteError(result, room) {
    this.setState({
      busy: false
    });
    const userMap = new Map(this.state.targets.map(member => [member.userId, member]));
    return !(0, _RoomInvite.showAnyInviteErrors)(result.states, room, result.inviter, userMap);
  }

  convertFilter() {
    // Check to see if there's anything to convert first
    if (!this.state.filterText || !this.state.filterText.includes('@')) return this.state.targets || [];
    let newMember;

    if (this.state.filterText.startsWith('@')) {
      // Assume mxid
      newMember = new DirectoryMember({
        user_id: this.state.filterText,
        display_name: null,
        avatar_url: null
      });
    } else if (_SettingsStore.default.getValue(_UIFeature.UIFeature.IdentityServer)) {
      // Assume email
      newMember = new ThreepidMember(this.state.filterText);
    }

    const newTargets = [...(this.state.targets || []), newMember];
    this.setState({
      targets: newTargets,
      filterText: ''
    });
    return newTargets;
  }

  renderSection(kind) {
    let sourceMembers = kind === 'recents' ? this.state.recents : this.state.suggestions;
    let showNum = kind === 'recents' ? this.state.numRecentsShown : this.state.numSuggestionsShown;
    const showMoreFn = kind === 'recents' ? this.showMoreRecents.bind(this) : this.showMoreSuggestions.bind(this);

    const lastActive = m => kind === 'recents' ? m.lastActive : null;

    let sectionName = kind === 'recents' ? (0, _languageHandler._t)("Recent Conversations") : (0, _languageHandler._t)("Suggestions");
    let sectionSubname = null;

    if (kind === 'suggestions' && _CommunityPrototypeStore.CommunityPrototypeStore.instance.getSelectedCommunityId()) {
      const communityName = _CommunityPrototypeStore.CommunityPrototypeStore.instance.getSelectedCommunityName();

      sectionSubname = (0, _languageHandler._t)("May include members not in %(communityName)s", {
        communityName
      });
    }

    if (this.props.kind === KIND_INVITE) {
      sectionName = kind === 'recents' ? (0, _languageHandler._t)("Recently Direct Messaged") : (0, _languageHandler._t)("Suggestions");
    } // Mix in the server results if we have any, but only if we're searching. We track the additional
    // members separately because we want to filter sourceMembers but trust the mixin arrays to have
    // the right members in them.


    let priorityAdditionalMembers = []; // Shows up before our own suggestions, higher quality

    let otherAdditionalMembers = []; // Shows up after our own suggestions, lower quality

    const hasMixins = this.state.serverResultsMixin || this.state.threepidResultsMixin;

    if (this.state.filterText && hasMixins && kind === 'suggestions') {
      // We don't want to duplicate members though, so just exclude anyone we've already seen.
      // The type of u is a pain to define but members of both mixins have the 'userId' property
      const notAlreadyExists = u => {
        return !sourceMembers.some(m => m.userId === u.userId) && !priorityAdditionalMembers.some(m => m.userId === u.userId) && !otherAdditionalMembers.some(m => m.userId === u.userId);
      };

      otherAdditionalMembers = this.state.serverResultsMixin.filter(notAlreadyExists);
      priorityAdditionalMembers = this.state.threepidResultsMixin.filter(notAlreadyExists);
    }

    const hasAdditionalMembers = priorityAdditionalMembers.length > 0 || otherAdditionalMembers.length > 0; // Hide the section if there's nothing to filter by

    if (sourceMembers.length === 0 && !hasAdditionalMembers) return null; // Do some simple filtering on the input before going much further. If we get no results, say so.

    if (this.state.filterText) {
      const filterBy = this.state.filterText.toLowerCase();
      sourceMembers = sourceMembers.filter(m => m.user.name.toLowerCase().includes(filterBy) || m.userId.toLowerCase().includes(filterBy));

      if (sourceMembers.length === 0 && !hasAdditionalMembers) {
        return /*#__PURE__*/_react.default.createElement("div", {
          className: "mx_InviteDialog_section"
        }, /*#__PURE__*/_react.default.createElement("h3", null, sectionName), /*#__PURE__*/_react.default.createElement("p", null, (0, _languageHandler._t)("No results")));
      }
    } // Now we mix in the additional members. Again, we presume these have already been filtered. We
    // also assume they are more relevant than our suggestions and prepend them to the list.


    sourceMembers = [...priorityAdditionalMembers, ...sourceMembers, ...otherAdditionalMembers]; // If we're going to hide one member behind 'show more', just use up the space of the button
    // with the member's tile instead.

    if (showNum === sourceMembers.length - 1) showNum++; // .slice() will return an incomplete array but won't error on us if we go too far

    const toRender = sourceMembers.slice(0, showNum);
    const hasMore = toRender.length < sourceMembers.length;
    let showMore = null;

    if (hasMore) {
      showMore = /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
        onClick: showMoreFn,
        kind: "link"
      }, (0, _languageHandler._t)("Show more"));
    }

    const tiles = toRender.map(r => /*#__PURE__*/_react.default.createElement(DMRoomTile, {
      member: r.user,
      lastActiveTs: lastActive(r),
      key: r.userId,
      onToggle: this.toggleMember,
      highlightWord: this.state.filterText,
      isSelected: this.state.targets.some(t => t.userId === r.userId)
    }));
    return /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_InviteDialog_section"
    }, /*#__PURE__*/_react.default.createElement("h3", null, sectionName), sectionSubname ? /*#__PURE__*/_react.default.createElement("p", {
      className: "mx_InviteDialog_subname"
    }, sectionSubname) : null, tiles, showMore);
  }

  renderEditor() {
    const hasPlaceholder = this.props.kind == KIND_CALL_TRANSFER && this.state.targets.length === 0 && this.state.filterText.length === 0;
    const targets = this.state.targets.map(t => /*#__PURE__*/_react.default.createElement(DMUserTile, {
      member: t,
      onRemove: !this.state.busy && this.removeMember,
      key: t.userId
    }));

    const input = /*#__PURE__*/_react.default.createElement("input", {
      type: "text",
      onKeyDown: this.onKeyDown,
      onChange: this.updateFilter,
      value: this.state.filterText,
      ref: this.editorRef,
      onPaste: this.onPaste,
      autoFocus: true,
      disabled: this.state.busy || this.props.kind == KIND_CALL_TRANSFER && this.state.targets.length > 0,
      autoComplete: "off",
      placeholder: hasPlaceholder ? (0, _languageHandler._t)("Search") : null
    });

    return /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_InviteDialog_editor",
      onClick: this.onClickInputArea
    }, targets, input);
  }

  renderIdentityServerWarning() {
    if (!this.state.tryingIdentityServer || this.state.canUseIdentityServer || !_SettingsStore.default.getValue(_UIFeature.UIFeature.IdentityServer)) {
      return null;
    }

    const defaultIdentityServerUrl = (0, _IdentityServerUtils.getDefaultIdentityServerUrl)();

    if (defaultIdentityServerUrl) {
      return /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_AddressPickerDialog_identityServer"
      }, (0, _languageHandler._t)("Use an identity server to invite by email. " + "<default>Use the default (%(defaultIdentityServerName)s)</default> " + "or manage in <settings>Settings</settings>.", {
        defaultIdentityServerName: (0, _UrlUtils.abbreviateUrl)(defaultIdentityServerUrl)
      }, {
        default: sub => /*#__PURE__*/_react.default.createElement("a", {
          href: "#",
          onClick: this.onUseDefaultIdentityServerClick
        }, sub),
        settings: sub => /*#__PURE__*/_react.default.createElement("a", {
          href: "#",
          onClick: this.onManageSettingsClick
        }, sub)
      }));
    } else {
      return /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_AddressPickerDialog_identityServer"
      }, (0, _languageHandler._t)("Use an identity server to invite by email. " + "Manage in <settings>Settings</settings>.", {}, {
        settings: sub => /*#__PURE__*/_react.default.createElement("a", {
          href: "#",
          onClick: this.onManageSettingsClick
        }, sub)
      }));
    }
  }

  async onLinkClick(e) {
    e.preventDefault();
    (0, _strings.selectText)(e.target);
  }

  render() {
    let spinner = null;

    if (this.state.busy) {
      spinner = /*#__PURE__*/_react.default.createElement(_Spinner.default, {
        w: 20,
        h: 20
      });
    }

    let title;
    let helpText;
    let buttonText;
    let goButtonFn;
    let consultConnectSection;
    let extraSection;
    let footer;

    let keySharingWarning = /*#__PURE__*/_react.default.createElement("span", null);

    const identityServersEnabled = _SettingsStore.default.getValue(_UIFeature.UIFeature.IdentityServer);

    const hasSelection = this.state.targets.length > 0 || this.state.filterText && this.state.filterText.includes('@');

    const cli = _MatrixClientPeg.MatrixClientPeg.get();

    const userId = cli.getUserId();

    if (this.props.kind === KIND_DM) {
      title = (0, _languageHandler._t)("Direct Messages");

      if (identityServersEnabled) {
        helpText = (0, _languageHandler._t)("Start a conversation with someone using their name, email address or username (like <userId/>).", {}, {
          userId: () => {
            return /*#__PURE__*/_react.default.createElement("a", {
              href: (0, _Permalinks.makeUserPermalink)(userId),
              rel: "noreferrer noopener",
              target: "_blank"
            }, userId);
          }
        });
      } else {
        helpText = (0, _languageHandler._t)("Start a conversation with someone using their name or username (like <userId/>).", {}, {
          userId: () => {
            return /*#__PURE__*/_react.default.createElement("a", {
              href: (0, _Permalinks.makeUserPermalink)(userId),
              rel: "noreferrer noopener",
              target: "_blank"
            }, userId);
          }
        });
      }

      if (_CommunityPrototypeStore.CommunityPrototypeStore.instance.getSelectedCommunityId()) {
        const communityName = _CommunityPrototypeStore.CommunityPrototypeStore.instance.getSelectedCommunityName();

        const inviteText = (0, _languageHandler._t)("This won't invite them to %(communityName)s. " + "To invite someone to %(communityName)s, click <a>here</a>", {
          communityName
        }, {
          userId: () => {
            return /*#__PURE__*/_react.default.createElement("a", {
              href: (0, _Permalinks.makeUserPermalink)(userId),
              rel: "noreferrer noopener",
              target: "_blank"
            }, userId);
          },
          a: sub => {
            return /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
              kind: "link",
              onClick: this.onCommunityInviteClick
            }, sub);
          }
        });
        helpText = /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, helpText, " ", inviteText);
      }

      buttonText = (0, _languageHandler._t)("Go");
      goButtonFn = this.startDm;
      extraSection = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_InviteDialog_section_hidden_suggestions_disclaimer"
      }, /*#__PURE__*/_react.default.createElement("span", null, (0, _languageHandler._t)("Some suggestions may be hidden for privacy.")), /*#__PURE__*/_react.default.createElement("p", null, (0, _languageHandler._t)("If you can't see who you're looking for, send them your invite link below.")));
      const link = (0, _Permalinks.makeUserPermalink)(_MatrixClientPeg.MatrixClientPeg.get().getUserId());
      footer = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_InviteDialog_footer"
      }, /*#__PURE__*/_react.default.createElement("h3", null, (0, _languageHandler._t)("Or send invite link")), /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_InviteDialog_footer_link"
      }, /*#__PURE__*/_react.default.createElement("a", {
        href: link,
        onClick: this.onLinkClick
      }, link), /*#__PURE__*/_react.default.createElement(_AccessibleTooltipButton.default, {
        title: (0, _languageHandler._t)("Copy"),
        onClick: this.onCopyClick,
        className: "mx_InviteDialog_footer_link_copy"
      }, /*#__PURE__*/_react.default.createElement("div", null))));
    } else if (this.props.kind === KIND_INVITE) {
      var _MatrixClientPeg$get;

      const room = (_MatrixClientPeg$get = _MatrixClientPeg.MatrixClientPeg.get()) === null || _MatrixClientPeg$get === void 0 ? void 0 : _MatrixClientPeg$get.getRoom(this.props.roomId);
      const isSpace = _SpaceStore.default.spacesEnabled && (room === null || room === void 0 ? void 0 : room.isSpaceRoom());
      title = isSpace ? (0, _languageHandler._t)("Invite to %(spaceName)s", {
        spaceName: room.name || (0, _languageHandler._t)("Unnamed Space")
      }) : (0, _languageHandler._t)("Invite to %(roomName)s", {
        roomName: room.name || (0, _languageHandler._t)("Unnamed Room")
      });
      let helpTextUntranslated;

      if (isSpace) {
        if (identityServersEnabled) {
          helpTextUntranslated = (0, _languageHandler._td)("Invite someone using their name, email address, username " + "(like <userId/>) or <a>share this space</a>.");
        } else {
          helpTextUntranslated = (0, _languageHandler._td)("Invite someone using their name, username " + "(like <userId/>) or <a>share this space</a>.");
        }
      } else {
        if (identityServersEnabled) {
          helpTextUntranslated = (0, _languageHandler._td)("Invite someone using their name, email address, username " + "(like <userId/>) or <a>share this room</a>.");
        } else {
          helpTextUntranslated = (0, _languageHandler._td)("Invite someone using their name, username " + "(like <userId/>) or <a>share this room</a>.");
        }
      }

      helpText = (0, _languageHandler._t)(helpTextUntranslated, {}, {
        userId: () => /*#__PURE__*/_react.default.createElement("a", {
          href: (0, _Permalinks.makeUserPermalink)(userId),
          rel: "noreferrer noopener",
          target: "_blank"
        }, userId),
        a: sub => /*#__PURE__*/_react.default.createElement("a", {
          href: (0, _Permalinks.makeRoomPermalink)(this.props.roomId),
          rel: "noreferrer noopener",
          target: "_blank"
        }, sub)
      });
      buttonText = (0, _languageHandler._t)("Invite");
      goButtonFn = this.inviteUsers;

      if (cli.isRoomEncrypted(this.props.roomId)) {
        const room = cli.getRoom(this.props.roomId);
        const visibilityEvent = room.currentState.getStateEvents("m.room.history_visibility", "");
        const visibility = visibilityEvent && visibilityEvent.getContent() && visibilityEvent.getContent().history_visibility;

        if (visibility === "world_readable" || visibility === "shared") {
          keySharingWarning = /*#__PURE__*/_react.default.createElement("p", {
            className: "mx_InviteDialog_helpText"
          }, /*#__PURE__*/_react.default.createElement("img", {
            src: require("../../../../res/img/element-icons/info.svg"),
            width: 14,
            height: 14
          }), " " + (0, _languageHandler._t)("Invited people will be able to read old messages."));
        }
      }
    } else if (this.props.kind === KIND_CALL_TRANSFER) {
      title = (0, _languageHandler._t)("Transfer");
      consultConnectSection = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_InviteDialog_transferConsultConnect"
      }, /*#__PURE__*/_react.default.createElement("label", null, /*#__PURE__*/_react.default.createElement("input", {
        type: "checkbox",
        checked: this.state.consultFirst,
        onChange: this.onConsultFirstChange
      }), (0, _languageHandler._t)("Consult first")), /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
        kind: "secondary",
        onClick: this.onCancel,
        className: "mx_InviteDialog_transferConsultConnect_pushRight"
      }, (0, _languageHandler._t)("Cancel")), /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
        kind: "primary",
        onClick: this.transferCall,
        className: "mx_InviteDialog_transferButton",
        disabled: !hasSelection && this.state.dialPadValue === ''
      }, (0, _languageHandler._t)("Transfer")));
    } else {
      _logger.logger.error("Unknown kind of InviteDialog: " + this.props.kind);
    }

    const goButton = this.props.kind == KIND_CALL_TRANSFER ? null : /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
      kind: "primary",
      onClick: goButtonFn,
      className: "mx_InviteDialog_goButton",
      disabled: this.state.busy || !hasSelection
    }, buttonText);

    const usersSection = /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement("p", {
      className: "mx_InviteDialog_helpText"
    }, helpText), /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_InviteDialog_addressBar"
    }, this.renderEditor(), /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_InviteDialog_buttonAndSpinner"
    }, goButton, spinner)), keySharingWarning, this.renderIdentityServerWarning(), /*#__PURE__*/_react.default.createElement("div", {
      className: "error"
    }, this.state.errorText), /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_InviteDialog_userSections"
    }, this.renderSection('recents'), this.renderSection('suggestions'), extraSection), footer);

    let dialogContent;

    if (this.props.kind === KIND_CALL_TRANSFER) {
      const tabs = [];
      tabs.push(new _TabbedView.Tab(TabId.UserDirectory, (0, _languageHandler._td)("User Directory"), 'mx_InviteDialog_userDirectoryIcon', usersSection));

      const backspaceButton = /*#__PURE__*/_react.default.createElement(_DialPadBackspaceButton.default, {
        onBackspacePress: this.onDeletePress
      }); // Only show the backspace button if the field has content


      let dialPadField;

      if (this.state.dialPadValue.length !== 0) {
        dialPadField = /*#__PURE__*/_react.default.createElement(_Field.default, {
          ref: this.numberEntryFieldRef,
          className: "mx_InviteDialog_dialPadField",
          id: "dialpad_number",
          value: this.state.dialPadValue,
          autoFocus: true,
          onChange: this.onDialChange,
          postfixComponent: backspaceButton
        });
      } else {
        dialPadField = /*#__PURE__*/_react.default.createElement(_Field.default, {
          ref: this.numberEntryFieldRef,
          className: "mx_InviteDialog_dialPadField",
          id: "dialpad_number",
          value: this.state.dialPadValue,
          autoFocus: true,
          onChange: this.onDialChange
        });
      }

      const dialPadSection = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_InviteDialog_dialPad"
      }, /*#__PURE__*/_react.default.createElement("form", {
        onSubmit: this.onDialFormSubmit
      }, dialPadField), /*#__PURE__*/_react.default.createElement(_DialPad.default, {
        hasDial: false,
        onDigitPress: this.onDigitPress,
        onDeletePress: this.onDeletePress
      }));

      tabs.push(new _TabbedView.Tab(TabId.DialPad, (0, _languageHandler._td)("Dial pad"), 'mx_InviteDialog_dialPadIcon', dialPadSection));
      dialogContent = /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement(_TabbedView.default, {
        tabs: tabs,
        initialTabId: this.state.currentTabId,
        tabLocation: _TabbedView.TabLocation.TOP,
        onChange: this.onTabChange
      }), consultConnectSection);
    } else {
      dialogContent = /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, usersSection, consultConnectSection);
    }

    return /*#__PURE__*/_react.default.createElement(_BaseDialog.default, {
      className: (0, _classnames.default)({
        mx_InviteDialog_transfer: this.props.kind === KIND_CALL_TRANSFER,
        mx_InviteDialog_other: this.props.kind !== KIND_CALL_TRANSFER,
        mx_InviteDialog_hasFooter: !!footer
      }),
      hasCancel: true,
      onFinished: this.props.onFinished,
      title: title
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_InviteDialog_content"
    }, dialogContent));
  }

}, (0, _defineProperty2.default)(_class2, "defaultProps", {
  kind: KIND_DM,
  initialText: ""
}), _temp)) || _class);
exports.default = InviteDialog;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZpZXdzL2RpYWxvZ3MvSW52aXRlRGlhbG9nLnRzeCJdLCJuYW1lcyI6WyJLSU5EX0RNIiwiS0lORF9JTlZJVEUiLCJLSU5EX0NBTExfVFJBTlNGRVIiLCJJTklUSUFMX1JPT01TX1NIT1dOIiwiSU5DUkVNRU5UX1JPT01TX1NIT1dOIiwiVGFiSWQiLCJNZW1iZXIiLCJEaXJlY3RvcnlNZW1iZXIiLCJjb25zdHJ1Y3RvciIsInVzZXJEaXJSZXN1bHQiLCJfdXNlcklkIiwidXNlcl9pZCIsImRpc3BsYXlOYW1lIiwiZGlzcGxheV9uYW1lIiwiYXZhdGFyVXJsIiwiYXZhdGFyX3VybCIsIm5hbWUiLCJ1c2VySWQiLCJnZXRNeGNBdmF0YXJVcmwiLCJUaHJlZXBpZE1lbWJlciIsImlkIiwiaXNFbWFpbCIsImluY2x1ZGVzIiwiRE1Vc2VyVGlsZSIsIlJlYWN0IiwiUHVyZUNvbXBvbmVudCIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInN0b3BQcm9wYWdhdGlvbiIsInByb3BzIiwib25SZW1vdmUiLCJtZW1iZXIiLCJyZW5kZXIiLCJhdmF0YXJTaXplIiwiYXZhdGFyIiwicmVxdWlyZSIsImdldFNxdWFyZVRodW1ibmFpbEh0dHAiLCJjbG9zZUJ1dHRvbiIsIkRNUm9vbVRpbGUiLCJvblRvZ2dsZSIsImhpZ2hsaWdodE5hbWUiLCJzdHIiLCJoaWdobGlnaHRXb3JkIiwibG93ZXJTdHIiLCJ0b0xvd2VyQ2FzZSIsImZpbHRlclN0ciIsInJlc3VsdCIsImkiLCJpaSIsImluZGV4T2YiLCJwdXNoIiwic3Vic3RyaW5nIiwic3Vic3RyIiwibGVuZ3RoIiwidGltZXN0YW1wIiwibGFzdEFjdGl2ZVRzIiwiaHVtYW5UcyIsImNoZWNrbWFyayIsImlzU2VsZWN0ZWQiLCJzdGFja2VkQXZhdGFyIiwiY2FwdGlvbiIsIm9uQ2xpY2siLCJJbnZpdGVEaWFsb2ciLCJldiIsInNldFN0YXRlIiwiY29uc3VsdEZpcnN0IiwidGFyZ2V0IiwiY2hlY2tlZCIsImJ1c3kiLCJjbGllbnQiLCJNYXRyaXhDbGllbnRQZWciLCJnZXQiLCJ0YXJnZXRzIiwiY29udmVydEZpbHRlciIsInRhcmdldElkcyIsIm1hcCIsInQiLCJleGlzdGluZ1Jvb20iLCJETVJvb21NYXAiLCJzaGFyZWQiLCJnZXRETVJvb21Gb3JJZGVudGlmaWVycyIsImRpcyIsImRpc3BhdGNoIiwiYWN0aW9uIiwiQWN0aW9uIiwiVmlld1Jvb20iLCJyb29tX2lkIiwicm9vbUlkIiwic2hvdWxkX3BlZWsiLCJqb2luaW5nIiwib25GaW5pc2hlZCIsImNyZWF0ZVJvb21PcHRpb25zIiwiaW5saW5lRXJyb3JzIiwiaGFzM1BpZE1lbWJlcnMiLCJzb21lIiwiYWxsSGF2ZURldmljZUtleXMiLCJlbmNyeXB0aW9uIiwiaXNTZWxmIiwiZ2V0VXNlcklkIiwiZG1Vc2VySWQiLCJjcmVhdGVPcHRzIiwicmVkdWNlIiwicm9vbU9wdGlvbnMiLCJhZGRyZXNzIiwidHlwZSIsImludml0ZSIsImlkX3NlcnZlciIsImdldElkZW50aXR5U2VydmVyVXJsIiwibWVkaXVtIiwiaW52aXRlXzNwaWQiLCJlcnIiLCJsb2dnZXIiLCJlcnJvciIsImVycm9yVGV4dCIsInN0YXJ0VGltZSIsIkNvdW50bHlBbmFseXRpY3MiLCJnZXRUaW1lc3RhbXAiLCJjbGkiLCJyb29tIiwiZ2V0Um9vbSIsImluc3RhbmNlIiwidHJhY2tTZW5kSW52aXRlIiwic2hvdWxkQWJvcnRBZnRlckludml0ZUVycm9yIiwiaXNSb29tRW5jcnlwdGVkIiwidmlzaWJpbGl0eUV2ZW50IiwiY3VycmVudFN0YXRlIiwiZ2V0U3RhdGVFdmVudHMiLCJ2aXNpYmlsaXR5IiwiZ2V0Q29udGVudCIsImhpc3RvcnlfdmlzaWJpbGl0eSIsImludml0ZWRVc2VycyIsImFkZHIiLCJzdGF0ZSIsIk9iamVjdCIsImVudHJpZXMiLCJzdGF0ZXMiLCJsb2ciLCJzZW5kU2hhcmVkSGlzdG9yeUtleXMiLCJjdXJyZW50VGFiSWQiLCJVc2VyRGlyZWN0b3J5IiwiVHJhbnNmZXJDYWxsVG9NYXRyaXhJRCIsImNhbGwiLCJkZXN0aW5hdGlvbiIsIlRyYW5zZmVyQ2FsbFRvUGhvbmVOdW1iZXIiLCJkaWFsUGFkVmFsdWUiLCJ2YWx1ZSIsInRyaW0iLCJoYXNNb2RpZmllcnMiLCJjdHJsS2V5Iiwic2hpZnRLZXkiLCJtZXRhS2V5Iiwia2V5IiwiS2V5IiwiQkFDS1NQQUNFIiwicmVtb3ZlTWVtYmVyIiwiRU5URVIiLCJTUEFDRSIsInRlcm0iLCJzZWFyY2hVc2VyRGlyZWN0b3J5IiwidGhlbiIsInIiLCJmaWx0ZXJUZXh0IiwicmVzdWx0cyIsInByb2ZpbGUiLCJnZXRQcm9maWxlSW5mbyIsInNwbGljZSIsIndhcm4iLCJzZXJ2ZXJSZXN1bHRzTWl4aW4iLCJ1IiwidXNlciIsImNhdGNoIiwiY2FuVXNlSWRlbnRpdHlTZXJ2ZXIiLCJ0cnlpbmdJZGVudGl0eVNlcnZlciIsIkVtYWlsIiwibG9va3NWYWxpZCIsIlNldHRpbmdzU3RvcmUiLCJnZXRWYWx1ZSIsIlVJRmVhdHVyZSIsIklkZW50aXR5U2VydmVyIiwidGhyZWVwaWRSZXN1bHRzTWl4aW4iLCJhdXRoQ2xpZW50IiwiSWRlbnRpdHlBdXRoQ2xpZW50IiwidG9rZW4iLCJnZXRBY2Nlc3NUb2tlbiIsImxvb2t1cCIsImxvb2t1cFRocmVlUGlkIiwidW5kZWZpbmVkIiwibXhpZCIsImRpc3BsYXluYW1lIiwiZGVib3VuY2VUaW1lciIsImNsZWFyVGltZW91dCIsInNldFRpbWVvdXQiLCJ1cGRhdGVTdWdnZXN0aW9ucyIsIm51bVJlY2VudHNTaG93biIsIm51bVN1Z2dlc3Rpb25zU2hvd24iLCJpZHgiLCJraW5kIiwiZWRpdG9yUmVmIiwiY3VycmVudCIsImZvY3VzIiwidGV4dCIsImNsaXBib2FyZERhdGEiLCJnZXREYXRhIiwicG9zc2libGVNZW1iZXJzIiwicmVjZW50cyIsInN1Z2dlc3Rpb25zIiwidG9BZGQiLCJmYWlsZWQiLCJwb3RlbnRpYWxBZGRyZXNzZXMiLCJzcGxpdCIsInAiLCJmaWx0ZXIiLCJmaW5kIiwibSIsInVubW91bnRlZCIsIk1vZGFsIiwiY3JlYXRlVHJhY2tlZERpYWxvZyIsIlF1ZXN0aW9uRGlhbG9nIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsImNzdk5hbWVzIiwiam9pbiIsImJ1dHRvbiIsImZpcmUiLCJWaWV3VXNlclNldHRpbmdzIiwiQ29tbXVuaXR5UHJvdG90eXBlU3RvcmUiLCJnZXRTZWxlY3RlZENvbW11bml0eUlkIiwidHJhbnNmZXJDYWxsIiwiY3VycmVudFRhcmdldCIsImRpZ2l0IiwibnVtYmVyRW50cnlGaWVsZFJlZiIsInNsaWNlIiwidGFiSWQiLCJzdWNjZXNzZnVsIiwiYnV0dG9uUmVjdCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImNsb3NlIiwiQ29udGV4dE1lbnUiLCJjcmVhdGVNZW51IiwiR2VuZXJpY1RleHRDb250ZXh0TWVudSIsIm1lc3NhZ2UiLCJjbG9zZUNvcGllZFRvb2x0aXAiLCJvbm1vdXNlbGVhdmUiLCJFcnJvciIsImFscmVhZHlJbnZpdGVkIiwiU2V0IiwiU2RrQ29uZmlnIiwiZ2V0TWVtYmVyc1dpdGhNZW1iZXJzaGlwIiwiZm9yRWFjaCIsImFkZCIsInRyYWNrQmVnaW5JbnZpdGUiLCJpbml0aWFsVGV4dCIsImJ1aWxkUmVjZW50cyIsImJ1aWxkU3VnZ2VzdGlvbnMiLCJjb21wb25lbnREaWRNb3VudCIsImNvbXBvbmVudFdpbGxVbm1vdW50IiwiZXhjbHVkZWRUYXJnZXRJZHMiLCJyb29tcyIsImdldFVuaXF1ZVJvb21zV2l0aEluZGl2aWR1YWxzIiwiZG1UYWdnZWRSb29tcyIsIlJvb21MaXN0U3RvcmUiLCJvcmRlcmVkTGlzdHMiLCJEZWZhdWx0VGFnSUQiLCJETSIsIm15VXNlcklkIiwiZG1Sb29tIiwib3RoZXJNZW1iZXJzIiwiZ2V0Sm9pbmVkTWVtYmVycyIsImhhcyIsImdldE1lbWJlciIsInNlYXJjaFR5cGVzIiwibWF4U2VhcmNoRXZlbnRzIiwibGFzdEV2ZW50VHMiLCJ0aW1lbGluZSIsImdldFR5cGUiLCJnZXRUcyIsImxhc3RBY3RpdmUiLCJzb3J0IiwiYSIsImIiLCJtYXhDb25zaWRlcmVkTWVtYmVycyIsImpvaW5lZFJvb21zIiwiZ2V0Um9vbXMiLCJnZXRNeU1lbWJlcnNoaXAiLCJnZXRKb2luZWRNZW1iZXJDb3VudCIsIm1lbWJlclJvb21zIiwibWVtYmVycyIsImdldFVzZXJJZEZvclJvb21JZCIsImpvaW5lZE1lbWJlcnMiLCJwaWNrZWRNZW1iZXJSb29tU2l6ZSIsIm1lbWJlclNjb3JlcyIsInZhbHVlcyIsInNjb3JlcyIsImVudHJ5IiwibnVtTWVtYmVyc1RvdGFsIiwiYyIsIm1heFJhbmdlIiwibnVtUm9vbXMiLCJzY29yZSIsIk1hdGgiLCJtYXgiLCJwb3ciLCJ0cnVlSm9pbmVkUm9vbXMiLCJub3ciLCJEYXRlIiwiZ2V0VGltZSIsImVhcmxpZXN0QWdlQ29uc2lkZXJlZCIsIm1heE1lc3NhZ2VzQ29uc2lkZXJlZCIsImxhc3RTcG9rZSIsImxhc3RTcG9rZU1lbWJlcnMiLCJpc0RtIiwia2V5cyIsInRhZ3MiLCJldmVudHMiLCJnZXRMaXZlVGltZWxpbmUiLCJnZXRFdmVudHMiLCJnZXRTZW5kZXIiLCJ0cyIsImRpc3RhbmNlRnJvbU5vdyIsImFicyIsImludmVyc2VUaW1lIiwic2NvcmVCb29zdCIsInJlY29yZCIsInVzZXJNYXAiLCJNYXAiLCJpbnZpdGVyIiwibmV3TWVtYmVyIiwic3RhcnRzV2l0aCIsIm5ld1RhcmdldHMiLCJyZW5kZXJTZWN0aW9uIiwic291cmNlTWVtYmVycyIsInNob3dOdW0iLCJzaG93TW9yZUZuIiwic2hvd01vcmVSZWNlbnRzIiwiYmluZCIsInNob3dNb3JlU3VnZ2VzdGlvbnMiLCJzZWN0aW9uTmFtZSIsInNlY3Rpb25TdWJuYW1lIiwiY29tbXVuaXR5TmFtZSIsImdldFNlbGVjdGVkQ29tbXVuaXR5TmFtZSIsInByaW9yaXR5QWRkaXRpb25hbE1lbWJlcnMiLCJvdGhlckFkZGl0aW9uYWxNZW1iZXJzIiwiaGFzTWl4aW5zIiwibm90QWxyZWFkeUV4aXN0cyIsImhhc0FkZGl0aW9uYWxNZW1iZXJzIiwiZmlsdGVyQnkiLCJ0b1JlbmRlciIsImhhc01vcmUiLCJzaG93TW9yZSIsInRpbGVzIiwidG9nZ2xlTWVtYmVyIiwicmVuZGVyRWRpdG9yIiwiaGFzUGxhY2Vob2xkZXIiLCJpbnB1dCIsIm9uS2V5RG93biIsInVwZGF0ZUZpbHRlciIsIm9uUGFzdGUiLCJvbkNsaWNrSW5wdXRBcmVhIiwicmVuZGVySWRlbnRpdHlTZXJ2ZXJXYXJuaW5nIiwiZGVmYXVsdElkZW50aXR5U2VydmVyVXJsIiwiZGVmYXVsdElkZW50aXR5U2VydmVyTmFtZSIsImRlZmF1bHQiLCJzdWIiLCJvblVzZURlZmF1bHRJZGVudGl0eVNlcnZlckNsaWNrIiwic2V0dGluZ3MiLCJvbk1hbmFnZVNldHRpbmdzQ2xpY2siLCJvbkxpbmtDbGljayIsInNwaW5uZXIiLCJoZWxwVGV4dCIsImJ1dHRvblRleHQiLCJnb0J1dHRvbkZuIiwiY29uc3VsdENvbm5lY3RTZWN0aW9uIiwiZXh0cmFTZWN0aW9uIiwiZm9vdGVyIiwia2V5U2hhcmluZ1dhcm5pbmciLCJpZGVudGl0eVNlcnZlcnNFbmFibGVkIiwiaGFzU2VsZWN0aW9uIiwiaW52aXRlVGV4dCIsIm9uQ29tbXVuaXR5SW52aXRlQ2xpY2siLCJzdGFydERtIiwibGluayIsIm9uQ29weUNsaWNrIiwiaXNTcGFjZSIsIlNwYWNlU3RvcmUiLCJzcGFjZXNFbmFibGVkIiwiaXNTcGFjZVJvb20iLCJzcGFjZU5hbWUiLCJyb29tTmFtZSIsImhlbHBUZXh0VW50cmFuc2xhdGVkIiwiaW52aXRlVXNlcnMiLCJvbkNvbnN1bHRGaXJzdENoYW5nZSIsIm9uQ2FuY2VsIiwiZ29CdXR0b24iLCJ1c2Vyc1NlY3Rpb24iLCJkaWFsb2dDb250ZW50IiwidGFicyIsIlRhYiIsImJhY2tzcGFjZUJ1dHRvbiIsIm9uRGVsZXRlUHJlc3MiLCJkaWFsUGFkRmllbGQiLCJvbkRpYWxDaGFuZ2UiLCJkaWFsUGFkU2VjdGlvbiIsIm9uRGlhbEZvcm1TdWJtaXQiLCJvbkRpZ2l0UHJlc3MiLCJEaWFsUGFkIiwiVGFiTG9jYXRpb24iLCJUT1AiLCJvblRhYkNoYW5nZSIsIm14X0ludml0ZURpYWxvZ190cmFuc2ZlciIsIm14X0ludml0ZURpYWxvZ19vdGhlciIsIm14X0ludml0ZURpYWxvZ19oYXNGb290ZXIiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBZ0JBOztBQUNBOztBQUVBOztBQUNBOztBQUNBOztBQUNBOztBQUVBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUtBOztBQU1BOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUdBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBOzs7Ozs7Ozs7Ozs7QUFXTyxNQUFNQSxPQUFPLEdBQUcsSUFBaEI7O0FBQ0EsTUFBTUMsV0FBVyxHQUFHLFFBQXBCLEMsQ0FDUDtBQUNBO0FBQ0E7OztBQUNPLE1BQU1DLGtCQUFrQixHQUFHLGVBQTNCOztBQUVQLE1BQU1DLG1CQUFtQixHQUFHLENBQTVCLEMsQ0FBK0I7O0FBQy9CLE1BQU1DLHFCQUFxQixHQUFHLENBQTlCLEMsQ0FBaUM7O0lBRTVCQyxLLEVBS0w7QUFDQTtBQUNBOztXQVBLQSxLO0FBQUFBLEVBQUFBLEs7QUFBQUEsRUFBQUEsSztHQUFBQSxLLEtBQUFBLEs7O0FBUUUsTUFBZUMsTUFBZixDQUFzQjs7OztBQW9CN0IsTUFBTUMsZUFBTixTQUE4QkQsTUFBOUIsQ0FBcUM7QUFLakM7QUFDQUUsRUFBQUEsV0FBVyxDQUFDQyxhQUFELEVBQWlGO0FBQ3hGO0FBRHdGO0FBQUE7QUFBQTtBQUV4RixTQUFLQyxPQUFMLEdBQWVELGFBQWEsQ0FBQ0UsT0FBN0I7QUFDQSxTQUFLQyxXQUFMLEdBQW1CSCxhQUFhLENBQUNJLFlBQWpDO0FBQ0EsU0FBS0MsU0FBTCxHQUFpQkws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QUEsU0FBUyxFQUFFLHlCQUFXO0FBQ2xCcUMsUUFBQUEsd0JBQXdCLEVBQUUsS0FBSzNYLEtBQUwsQ0FBV3VLLElBQVgsS0FBb0JsTSxrQkFENUI7QUFFbEJ1WixRQUFBQSxxQkFBcUIsRUFBRSxLQUFLNVgsS0FBTCxDQUFXdUssSUFBWCxLQUFvQmxNLGtCQUZ6QjtBQUdsQndaLFFBQUFBLHlCQUF5QixFQUFFLENBQUMsQ0FBQ3JDO0FBSFgsT0FBWCxDQURmO0FBTUksTUFBQSxTQUFTLEVBQUUsSUFOZjtBQU9JLE1BQUEsVUFBVSxFQUFFLEtBQUt4VixLQUFMLENBQVc2RCxVQVAzQjtBQVFJLE1BQUEsS0FBSyxFQUFFZ0k7QUFSWCxvQkFVSTtBQUFLLE1BQUEsU0FBUyxFQUFDO0FBQWYsT0FDTWdMLGFBRE4sQ0FWSixDQURKO0FBZ0JIOztBQW50Q2lHLEMseURBQzVFO0FBQ2xCdE0sRUFBQUEsSUFBSSxFQUFFcE0sT0FEWTtBQUVsQjJQLEVBQUFBLFdBQVcsRUFBRTtBQUZLLEMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuQ29weXJpZ2h0IDIwMTksIDIwMjAgVGhlIE1hdHJpeC5vcmcgRm91bmRhdGlvbiBDLkkuQy5cblxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbnlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbllvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuXG4gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cblVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbmRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxubGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4qL1xuXG5pbXBvcnQgUmVhY3QsIHsgY3JlYXRlUmVmIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IGNsYXNzTmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XG5cbmltcG9ydCB7IF90LCBfdGQgfSBmcm9tIFwiLi4vLi4vLi4vbGFuZ3VhZ2VIYW5kbGVyXCI7XG5pbXBvcnQgeyBNYXRyaXhDbGllbnRQZWcgfSBmcm9tIFwiLi4vLi4vLi4vTWF0cml4Q2xpZW50UGVnXCI7XG5pbXBvcnQgeyBtYWtlUm9vbVBlcm1hbGluaywgbWFrZVVzZXJQZXJtYWxpbmsgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvcGVybWFsaW5rcy9QZXJtYWxpbmtzXCI7XG5pbXBvcnQgRE1Sb29tTWFwIGZyb20gXCIuLi8uLi8uLi91dGlscy9ETVJvb21NYXBcIjtcbmltcG9ydCB7IFJvb21NZW1iZXIgfSBmcm9tIFwibWF0cml4LWpzLXNkay9zcmMvbW9kZWxzL3Jvb20tbWVtYmVyXCI7XG5pbXBvcnQgU2RrQ29uZmlnIGZyb20gXCIuLi8uLi8uLi9TZGtDb25maWdcIjtcbmltcG9ydCAqIGFzIEVtYWlsIGZyb20gXCIuLi8uLi8uLi9lbWFpbFwiO1xuaW1wb3J0IHsgZ2V0RGVmYXVsdElkZW50aXR5U2VydmVyVXJsLCB1c2VEZWZhdWx0SWRlbnRpdHlTZXJ2ZXIgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvSWRlbnRpdHlTZXJ2ZXJVdGlsc1wiO1xuaW1wb3J0IHsgYWJicmV2aWF0ZVVybCB9IGZyb20gXCIuLi8uLi8uLi91dGlscy9VcmxVdGlsc1wiO1xuaW1wb3J0IGRpcyBmcm9tIFwiLi4vLi4vLi4vZGlzcGF0Y2hlci9kaXNwYXRjaGVyXCI7XG5pbXBvcnQgSWRlbnRpdHlBdXRoQ2xpZW50IGZyb20gXCIuLi8uLi8uLi9JZGVudGl0eUF1dGhDbGllbnRcIjtcbmltcG9ydCBNb2RhbCBmcm9tIFwiLi4vLi4vLi4vTW9kYWxcIjtcbmltcG9ydCB7IGh1bWFuaXplVGltZSB9IGZyb20gXCIuLi8uLi8uLi91dGlscy9odW1hbml6ZVwiO1xuaW1wb3J0IGNyZWF0ZVJvb20sIHtcbiAgICBjYW5FbmNyeXB0VG9BbGxVc2VycyxcbiAgICBmaW5kRE1Gb3JVc2VyLFxuICAgIHByaXZhdGVTaG91bGRCZUVuY3J5cHRlZCxcbn0gZnJvbSBcIi4uLy4uLy4uL2NyZWF0ZVJvb21cIjtcbmltcG9ydCB7XG4gICAgSUludml0ZVJlc3VsdCxcbiAgICBpbnZpdGVNdWx0aXBsZVRvUm9vbSxcbiAgICBzaG93QW55SW52aXRlRXJyb3JzLFxuICAgIHNob3dDb21tdW5pdHlJbnZpdGVEaWFsb2csXG59IGZyb20gXCIuLi8uLi8uLi9Sb29tSW52aXRlXCI7XG5pbXBvcnQgeyBLZXkgfSBmcm9tIFwiLi4vLi4vLi4vS2V5Ym9hcmRcIjtcbmltcG9ydCB7IEFjdGlvbiB9IGZyb20gXCIuLi8uLi8uLi9kaXNwYXRjaGVyL2FjdGlvbnNcIjtcbmltcG9ydCB7IERlZmF1bHRUYWdJRCB9IGZyb20gXCIuLi8uLi8uLi9zdG9yZXMvcm9vbS1saXN0L21vZGVsc1wiO1xuaW1wb3J0IFJvb21MaXN0U3RvcmUgZnJvbSBcIi4uLy4uLy4uL3N0b3Jlcy9yb29tLWxpc3QvUm9vbUxpc3RTdG9yZVwiO1xuaW1wb3J0IHsgQ29tbXVuaXR5UHJvdG90eXBlU3RvcmUgfSBmcm9tIFwiLi4vLi4vLi4vc3RvcmVzL0NvbW11bml0eVByb3RvdHlwZVN0b3JlXCI7XG5pbXBvcnQgU2V0dGluZ3NTdG9yZSBmcm9tIFwiLi4vLi4vLi4vc2V0dGluZ3MvU2V0dGluZ3NTdG9yZVwiO1xuaW1wb3J0IHsgVUlGZWF0dXJlIH0gZnJvbSBcIi4uLy4uLy4uL3NldHRpbmdzL1VJRmVhdHVyZVwiO1xuaW1wb3J0IENvdW50bHlBbmFseXRpY3MgZnJvbSBcIi4uLy4uLy4uL0NvdW50bHlBbmFseXRpY3NcIjtcbmltcG9ydCB7IFJvb20gfSBmcm9tIFwibWF0cml4LWpzLXNkay9zcmMvbW9kZWxzL3Jvb21cIjtcbmltcG9ydCB7IE1hdHJpeENhbGwgfSBmcm9tICdtYXRyaXgtanMtc2RrL3NyYy93ZWJydGMvY2FsbCc7XG5pbXBvcnQgeyByZXBsYWNlYWJsZUNvbXBvbmVudCB9IGZyb20gXCIuLi8uLi8uLi91dGlscy9yZXBsYWNlYWJsZUNvbXBvbmVudFwiO1xuaW1wb3J0IHsgbWVkaWFGcm9tTXhjIH0gZnJvbSBcIi4uLy4uLy4uL2N1c3RvbWlzYXRpb25zL01lZGlhXCI7XG5pbXBvcnQgeyBnZXRBZGRyZXNzVHlwZSB9IGZyb20gXCIuLi8uLi8uLi9Vc2VyQWRkcmVzc1wiO1xuaW1wb3J0IEJhc2VBdmF0YXIgZnJvbSAnLi4vYXZhdGFycy9CYXNlQXZhdGFyJztcbmltcG9ydCBBY2Nlc3NpYmxlQnV0dG9uLCB7IEJ1dHRvbkV2ZW50IH0gZnJvbSAnLi4vZWxlbWVudHMvQWNjZXNzaWJsZUJ1dHRvbic7XG5pbXBvcnQgeyBjb21wYXJlIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvc3RyaW5ncyc7XG5pbXBvcnQgeyBJSW52aXRlM1BJRCB9IGZyb20gXCJtYXRyaXgtanMtc2RrL3NyYy9AdHlwZXMvcmVxdWVzdHNcIjtcbmltcG9ydCBBY2Nlc3NpYmxlVG9vbHRpcEJ1dHRvbiBmcm9tIFwiLi4vZWxlbWVudHMvQWNjZXNzaWJsZVRvb2x0aXBCdXR0b25cIjtcbmltcG9ydCB7IGNvcHlQbGFpbnRleHQsIHNlbGVjdFRleHQgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvc3RyaW5nc1wiO1xuaW1wb3J0ICogYXMgQ29udGV4dE1lbnUgZnJvbSBcIi4uLy4uL3N0cnVjdHVyZXMvQ29udGV4dE1lbnVcIjtcbmltcG9ydCB7IHRvUmlnaHRPZiB9IGZyb20gXCIuLi8uLi9zdHJ1Y3R1cmVzL0NvbnRleHRNZW51XCI7XG5pbXBvcnQgR2VuZXJpY1RleHRDb250ZXh0TWVudSBmcm9tIFwiLi4vY29udGV4dF9tZW51cy9HZW5lcmljVGV4dENvbnRleHRNZW51XCI7XG5pbXBvcnQgeyBUcmFuc2ZlckNhbGxQYXlsb2FkIH0gZnJvbSAnLi4vLi4vLi4vZGlzcGF0Y2hlci9wYXlsb2Fkcy9UcmFuc2ZlckNhbGxQYXlsb2FkJztcbmltcG9ydCBGaWVsZCBmcm9tICcuLi9lbGVtZW50cy9GaWVsZCc7XG5pbXBvcnQgVGFiYmVkVmlldywgeyBUYWIsIFRhYkxvY2F0aW9uIH0gZnJvbSAnLi4vLi4vc3RydWN0dXJlcy9UYWJiZWRWaWV3JztcbmltcG9ydCBEaWFscGFkIGZyb20gJy4uL3ZvaXAvRGlhbFBhZCc7XG5pbXBvcnQgUXVlc3Rpb25EaWFsb2cgZnJvbSBcIi4vUXVlc3Rpb25EaWFsb2dcIjtcbmltcG9ydCBTcGlubmVyIGZyb20gXCIuLi9lbGVtZW50cy9TcGlubmVyXCI7XG5pbXBvcnQgQmFzZURpYWxvZyBmcm9tIFwiLi9CYXNlRGlhbG9nXCI7XG5pbXBvcnQgRGlhbFBhZEJhY2tzcGFjZUJ1dHRvbiBmcm9tIFwiLi4vZWxlbWVudHMvRGlhbFBhZEJhY2tzcGFjZUJ1dHRvblwiO1xuaW1wb3J0IFNwYWNlU3RvcmUgZnJvbSBcIi4uLy4uLy4uL3N0b3Jlcy9zcGFjZXMvU3BhY2VTdG9yZVwiO1xuXG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tIFwibWF0cml4LWpzLXNkay9zcmMvbG9nZ2VyXCI7XG5cbi8vIHdlIGhhdmUgYSBudW1iZXIgb2YgdHlwZXMgZGVmaW5lZCBmcm9tIHRoZSBNYXRyaXggc3BlYyB3aGljaCBjYW4ndCByZWFzb25hYmx5IGJlIGFsdGVyZWQgaGVyZS5cbi8qIGVzbGludC1kaXNhYmxlIGNhbWVsY2FzZSAqL1xuXG5pbnRlcmZhY2UgSVJlY2VudFVzZXIge1xuICAgIHVzZXJJZDogc3RyaW5nO1xuICAgIHVzZXI6IFJvb21NZW1iZXI7XG4gICAgbGFzdEFjdGl2ZTogbnVtYmVyO1xufVxuXG5leHBvcnQgY29uc3QgS0lORF9ETSA9IFwiZG1cIjtcbmV4cG9ydCBjb25zdCBLSU5EX0lOVklURSA9IFwiaW52aXRlXCI7XG4vLyBOQi4gVGhpcyBkaWFsb2cgbmVlZHMgdGhlICdteF9JbnZpdGVEaWFsb2dfdHJhbnNmZXJXcmFwcGVyJyB3cmFwcGVyIGNsYXNzIHRvIGhhdmUgdGhlIGNvcnJlY3Rcbi8vIHBhZGRpbmcgb24gdGhlIGJvdHRvbSAoYmVjYXVzZSBhbGwgbW9kYWxzIGhhdmUgMjRweCBwYWRkaW5nIG9uIGFsbCBzaWRlcyksIHNvIHRoaXMgbmVlZHMgdG9cbi8vIGJlIHBhc3NlZCB3aGVuIGNyZWF0aW5nIHRoZSBtb2RhbFxuZXhwb3J0IGNvbnN0IEtJTkRfQ0FMTF9UUkFOU0ZFUiA9IFwiY2FsbF90cmFuc2ZlclwiO1xuXG5jb25zdCBJTklUSUFMX1JPT01TX1NIT1dOID0gMzsgLy8gTnVtYmVyIG9mIHJvb21zIHRvIHNob3cgYXQgZmlyc3RcbmNvbnN0IElOQ1JFTUVOVF9ST09NU19TSE9XTiA9IDU7IC8vIE51bWJlciBvZiByb29tcyB0byBhZGQgd2hlbiAnc2hvdyBtb3JlJyBpcyBjbGlja2VkXG5cbmVudW0gVGFiSWQge1xuICAgIFVzZXJEaXJlY3RvcnkgPSAndXNlcnMnLFxuICAgIERpYWxQYWQgPSAnZGlhbHBhZCcsXG59XG5cbi8vIFRoaXMgaXMgdGhlIGludGVyZmFjZSB0aGF0IGlzIGV4cGVjdGVkIGJ5IHZhcmlvdXMgY29tcG9uZW50cyBpbiB0aGUgSW52aXRlIERpYWxvZyBhbmQgUm9vbUludml0ZS5cbi8vIEl0IGlzIGEgYml0IGF3a3dhcmQgYmVjYXVzZSBpdCBhbHNvIG1hdGNoZXMgdGhlIFJvb21NZW1iZXIgY2xhc3MgZnJvbSB0aGUganMtc2RrIHdpdGggc29tZSBleHRyYSBzdXBwb3J0XG4vLyBmb3IgM1BJRHMvZW1haWwgYWRkcmVzc2VzLlxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIE1lbWJlciB7XG4gICAgLyoqXG4gICAgICogVGhlIGRpc3BsYXkgbmFtZSBvZiB0aGlzIE1lbWJlci4gRm9yIHVzZXJzIHRoaXMgc2hvdWxkIGJlIHRoZWlyIHByb2ZpbGUncyBkaXNwbGF5XG4gICAgICogbmFtZSBvciB1c2VyIElEIGlmIG5vbmUgc2V0LiBGb3IgM1BJRHMgdGhpcyBzaG91bGQgYmUgdGhlIDNQSUQgYWRkcmVzcyAoZW1haWwpLlxuICAgICAqL1xuICAgIHB1YmxpYyBhYnN0cmFjdCBnZXQgbmFtZSgpOiBzdHJpbmc7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgSUQgb2YgdGhpcyBNZW1iZXIuIEZvciB1c2VycyB0aGlzIHNob3VsZCBiZSB0aGVpciB1c2VyIElELiBGb3IgM1BJRHMgdGhpcyBzaG91bGRcbiAgICAgKiBiZSB0aGUgM1BJRCBhZGRyZXNzIChlbWFpbCkuXG4gICAgICovXG4gICAgcHVibGljIGFic3RyYWN0IGdldCB1c2VySWQoKTogc3RyaW5nO1xuXG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgTVhDIFVSTCBvZiB0aGlzIE1lbWJlcidzIGF2YXRhci4gRm9yIHVzZXJzIHRoaXMgc2hvdWxkIGJlIHRoZWlyIHByb2ZpbGUnc1xuICAgICAqIGF2YXRhciBNWEMgVVJMIG9yIG51bGwgaWYgbm9uZSBzZXQuIEZvciAzUElEcyB0aGlzIHNob3VsZCBhbHdheXMgYmUgbnVsbC5cbiAgICAgKi9cbiAgICBwdWJsaWMgYWJzdHJhY3QgZ2V0TXhjQXZhdGFyVXJsKCk6IHN0cmluZztcbn1cblxuY2xhc3MgRGlyZWN0b3J5TWVtYmVyIGV4dGVuZHMgTWVtYmVyIHtcbiAgICBwcml2YXRlIHJlYWRvbmx5IF91c2VySWQ6IHN0cmluZztcbiAgICBwcml2YXRlIHJlYWRvbmx5IGRpc3BsYXlOYW1lPzogc3RyaW5nO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgYXZhdGFyVXJsPzogc3RyaW5nO1xuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNhbWVsY2FzZVxuICAgIGNvbnN0cnVjdG9yKHVzZXJEaXJSZXN1bHQ6IHsgdXNlcl9pZDogc3RyaW5nLCBkaXNwbGF5X25hbWU/OiBzdHJpbmcsIGF2YXRhcl91cmw/OiBzdHJpbmcgfSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLl91c2VySWQgPSB1c2VyRGlyUmVzdWx0LnVzZXJfaWQ7XG4gICAgICAgIHRoaXMuZGlzcGxheU5hbWUgPSB1c2VyRGlyUmVzdWx0LmRpc3BsYXlfbmFtZTtcbiAgICAgICAgdGhpcy5hdmF0YXJVcmwgPSB1c2VyRGlyUmVzdWx0LmF2YXRhcl91cmw7XG4gICAgfVxuXG4gICAgLy8gVGhlc2UgbmV4dCBjbGFzcyBtZW1iZXJzIGFyZSBmb3IgdGhlIE1lbWJlciBpbnRlcmZhY2VcbiAgICBnZXQgbmFtZSgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5kaXNwbGF5TmFtZSB8fCB0aGlzLl91c2VySWQ7XG4gICAgfVxuXG4gICAgZ2V0IHVzZXJJZCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5fdXNlcklkO1xuICAgIH1cblxuICAgIGdldE14Y0F2YXRhclVybCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5hdmF0YXJVcmw7XG4gICAgfVxufVxuXG5jbGFzcyBUaHJlZXBpZE1lbWJlciBleHRlbmRzIE1lbWJlciB7XG4gICAgcHJpdmF0ZSByZWFkb25seSBpZDogc3RyaW5nO1xuXG4gICAgY29uc3RydWN0b3IoaWQ6IHN0cmluZykge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmlkID0gaWQ7XG4gICAgfVxuXG4gICAgLy8gVGhpcyBpcyBhIGdldHRlciB0aGF0IHdvdWxkIGJlIGZhbHNleSBvbiBhbGwgb3RoZXIgaW1wbGVtZW50YXRpb25zLiBVbnRpbCB3ZSBoYXZlXG4gICAgLy8gYmV0dGVyIHR5cGUgc3VwcG9ydCBpbiB0aGUgcmVhY3Qtc2RrIHdlIGNhbiB1c2UgdGhpcyB0cmljayB0byBkZXRlcm1pbmUgdGhlIGtpbmRcbiAgICAvLyBvZiAzUElEIHdlJ3JlIGRlYWxpbmcgd2l0aCwgaWYgYW55LlxuICAgIGdldCBpc0VtYWlsKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5pZC5pbmNsdWRlcygnQCcpO1xuICAgIH1cblxuICAgIC8vIFRoZXNlIG5leHQgY2xhc3MgbWVtYmVycyBhcmUgZm9yIHRoZSBNZW1iZXIgaW50ZXJmYWNlXG4gICAgZ2V0IG5hbWUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaWQ7XG4gICAgfVxuXG4gICAgZ2V0IHVzZXJJZCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5pZDtcbiAgICB9XG5cbiAgICBnZXRNeGNBdmF0YXJVcmwoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufVxuXG5pbnRlcmZhY2UgSURNVXNlclRpbGVQcm9wcyB7XG4gICAgbWVtYmVyOiBNZW1iZXI7XG4gICAgb25SZW1vdmUobWVtYmVyOiBNZW1iZXIpOiB2b2lkO1xufVxuXG5jbGFzcyBETVVzZXJUaWxlIGV4dGVuZHMgUmVhY3QuUHVyZUNvbXBvbmVudDxJRE1Vc2VyVGlsZVByb3BzPiB7XG4gICAgcHJpdmF0ZSBvblJlbW92ZSA9IChlKSA9PiB7XG4gICAgICAgIC8vIFN0b3AgdGhlIGJyb3dzZXIgZnJvbSBoaWdobGlnaHRpbmcgdGV4dFxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgdGhpcy5wcm9wcy5vblJlbW92ZSh0aGlzLnByb3BzLm1lbWJlcik7XG4gICAgfTtcblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgYXZhdGFyU2l6ZSA9IDIwO1xuICAgICAgICBjb25zdCBhdmF0YXIgPSAodGhpcy5wcm9wcy5tZW1iZXIgYXMgVGhyZWVwaWRNZW1iZXIpLmlzRW1haWxcbiAgICAgICAgICAgID8gPGltZ1xuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT0nbXhfSW52aXRlRGlhbG9nX3VzZXJUaWxlX2F2YXRhciBteF9JbnZpdGVEaWFsb2dfdXNlclRpbGVfdGhyZWVwaWRBdmF0YXInXG4gICAgICAgICAgICAgICAgc3JjPXtyZXF1aXJlKFwiLi4vLi4vLi4vLi4vcmVzL2ltZy9pY29uLWVtYWlsLXBpbGwtYXZhdGFyLnN2Z1wiKX1cbiAgICAgICAgICAgICAgICB3aWR0aD17YXZhdGFyU2l6ZX1cbiAgICAgICAgICAgICAgICBoZWlnaHQ9e2F2YXRhclNpemV9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgOiA8QmFzZUF2YXRhclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT0nbXhfSW52aXRlRGlhbG9nX3VzZXJUaWxlX2F2YXRhcidcbiAgICAgICAgICAgICAgICB1cmw9e3RoaXMucHJvcHMubWVtYmVyLmdldE14Y0F2YXRhclVybCgpXG4gICAgICAgICAgICAgICAgICAgID8gbWVkaWFGcm9tTXhjKHRoaXMucHJvcHMubWVtYmVyLmdldE14Y0F2YXRhclVybCgpKS5nZXRTcXVhcmVUaHVtYm5haWxIdHRwKGF2YXRhclNpemUpXG4gICAgICAgICAgICAgICAgICAgIDogbnVsbH1cbiAgICAgICAgICAgICAgICBuYW1lPXt0aGlzLnByb3BzLm1lbWJlci5uYW1lfVxuICAgICAgICAgICAgICAgIGlkTmFtZT17dGhpcy5wcm9wcy5tZW1iZXIudXNlcklkfVxuICAgICAgICAgICAgICAgIHdpZHRoPXthdmF0YXJTaXplfVxuICAgICAgICAgICAgICAgIGhlaWdodD17YXZhdGFyU2l6ZX0gLz47XG5cbiAgICAgICAgbGV0IGNsb3NlQnV0dG9uO1xuICAgICAgICBpZiAodGhpcy5wcm9wcy5vblJlbW92ZSkge1xuICAgICAgICAgICAgY2xvc2VCdXR0b24gPSAoXG4gICAgICAgICAgICAgICAgPEFjY2Vzc2libGVCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPSdteF9JbnZpdGVEaWFsb2dfdXNlclRpbGVfcmVtb3ZlJ1xuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uUmVtb3ZlfVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPGltZ1xuICAgICAgICAgICAgICAgICAgICAgICAgc3JjPXtyZXF1aXJlKFwiLi4vLi4vLi4vLi4vcmVzL2ltZy9pY29uLXBpbGwtcmVtb3ZlLnN2Z1wiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGFsdD17X3QoJ1JlbW92ZScpfVxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9ezh9XG4gICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ9ezh9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC9BY2Nlc3NpYmxlQnV0dG9uPlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9J214X0ludml0ZURpYWxvZ191c2VyVGlsZSc+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSdteF9JbnZpdGVEaWFsb2dfdXNlclRpbGVfcGlsbCc+XG4gICAgICAgICAgICAgICAgICAgIHsgYXZhdGFyIH1cbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSdteF9JbnZpdGVEaWFsb2dfdXNlclRpbGVfbmFtZSc+eyB0aGlzLnByb3BzLm1lbWJlci5uYW1lIH08L3NwYW4+XG4gICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgIHsgY2xvc2VCdXR0b24gfVxuICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICApO1xuICAgIH1cbn1cblxuaW50ZXJmYWNlIElETVJvb21UaWxlUHJvcHMge1xuICAgIG1lbWJlcjogTWVtYmVyO1xuICAgIGxhc3RBY3RpdmVUczogbnVtYmVyO1xuICAgIG9uVG9nZ2xlKG1lbWJlcjogTWVtYmVyKTogdm9pZDtcbiAgICBoaWdobGlnaHRXb3JkOiBzdHJpbmc7XG4gICAgaXNTZWxlY3RlZDogYm9vbGVhbjtcbn1cblxuY2xhc3MgRE1Sb29tVGlsZSBleHRlbmRzIFJlYWN0LlB1cmVDb21wb25lbnQ8SURNUm9vbVRpbGVQcm9wcz4ge1xuICAgIHByaXZhdGUgb25DbGljayA9IChlKSA9PiB7XG4gICAgICAgIC8vIFN0b3AgdGhlIGJyb3dzZXIgZnJvbSBoaWdobGlnaHRpbmcgdGV4dFxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgdGhpcy5wcm9wcy5vblRvZ2dsZSh0aGlzLnByb3BzLm1lbWJlcik7XG4gICAgfTtcblxuICAgIHByaXZhdGUgaGlnaGxpZ2h0TmFtZShzdHI6IHN0cmluZykge1xuICAgICAgICBpZiAoIXRoaXMucHJvcHMuaGlnaGxpZ2h0V29yZCkgcmV0dXJuIHN0cjtcblxuICAgICAgICAvLyBXZSBjb252ZXJ0IHRoaW5ncyB0byBsb3dlcmNhc2UgZm9yIGluZGV4IHNlYXJjaGluZywgYnV0IHB1bGwgc3Vic3RyaW5ncyBmcm9tXG4gICAgICAgIC8vIHRoZSBzdWJtaXR0ZWQgdGV4dCB0byBwcmVzZXJ2ZSBjYXNlLiBOb3RlOiB3ZSBkb24ndCBuZWVkIHRvIGh0bWxFbnRpdGllcyB0aGVcbiAgICAgICAgLy8gc3RyaW5nIGJlY2F1c2UgUmVhY3Qgd2lsbCBzYWZlbHkgZW5jb2RlIHRoZSB0ZXh0IGZvciB1cy5cbiAgICAgICAgY29uc3QgbG93ZXJTdHIgPSBzdHIudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgY29uc3QgZmlsdGVyU3RyID0gdGhpcy5wcm9wcy5oaWdobGlnaHRXb3JkLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gW107XG5cbiAgICAgICAgbGV0IGkgPSAwO1xuICAgICAgICBsZXQgaWk7XG4gICAgICAgIHdoaWxlICgoaWkgPSBsb3dlclN0ci5pbmRleE9mKGZpbHRlclN0ciwgaSkpID49IDApIHtcbiAgICAgICAgICAgIC8vIFB1c2ggYW55IHRleHQgd2UgbWlzc2VkIChmaXJzdCBiaXQvbWlkZGxlIG9mIHRleHQpXG4gICAgICAgICAgICBpZiAoaWkgPiBpKSB7XG4gICAgICAgICAgICAgICAgLy8gUHVzaCBhbnkgdGV4dCB3ZSBhcmVuJ3QgaGlnaGxpZ2h0aW5nIChtaWRkbGUgb2YgdGV4dCBtYXRjaCwgb3IgYmVnaW5uaW5nIG9mIHRleHQpXG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goPHNwYW4ga2V5PXtpICsgJ2JlZ2luJ30+eyBzdHIuc3Vic3RyaW5nKGksIGlpKSB9PC9zcGFuPik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGkgPSBpaTsgLy8gY29weSBvdmVyIGlpIG9ubHkgaWYgd2UgaGF2ZSBhIG1hdGNoICh0byBwcmVzZXJ2ZSBpIGZvciBlbmQtb2YtdGV4dCBtYXRjaGluZylcblxuICAgICAgICAgICAgLy8gSGlnaGxpZ2h0IHRoZSB3b3JkIHRoZSB1c2VyIGVudGVyZWRcbiAgICAgICAgICAgIGNvbnN0IHN1YnN0ciA9IHN0ci5zdWJzdHJpbmcoaSwgZmlsdGVyU3RyLmxlbmd0aCArIGkpO1xuICAgICAgICAgICAgcmVzdWx0LnB1c2goPHNwYW4gY2xhc3NOYW1lPSdteF9JbnZpdGVEaWFsb2dfcm9vbVRpbGVfaGlnaGxpZ2h0JyBrZXk9e2kgKyAnYm9sZCd9Pnsgc3Vic3RyIH08L3NwYW4+KTtcbiAgICAgICAgICAgIGkgKz0gc3Vic3RyLmxlbmd0aDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFB1c2ggYW55IHRleHQgd2UgbWlzc2VkIChlbmQgb2YgdGV4dClcbiAgICAgICAgaWYgKGkgPCBzdHIubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXN1bHQucHVzaCg8c3BhbiBrZXk9e2kgKyAnZW5kJ30+eyBzdHIuc3Vic3RyaW5nKGkpIH08L3NwYW4+KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBsZXQgdGltZXN0YW1wID0gbnVsbDtcbiAgICAgICAgaWYgKHRoaXMucHJvcHMubGFzdEFjdGl2ZVRzKSB7XG4gICAgICAgICAgICBjb25zdCBodW1hblRzID0gaHVtYW5pemVUaW1lKHRoaXMucHJvcHMubGFzdEFjdGl2ZVRzKTtcbiAgICAgICAgICAgIHRpbWVzdGFtcCA9IDxzcGFuIGNsYXNzTmFtZT0nbXhfSW52aXRlRGlhbG9nX3Jvb21UaWxlX3RpbWUnPnsgaHVtYW5UcyB9PC9zcGFuPjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGF2YXRhclNpemUgPSAzNjtcbiAgICAgICAgY29uc3QgYXZhdGFyID0gKHRoaXMucHJvcHMubWVtYmVyIGFzIFRocmVlcGlkTWVtYmVyKS5pc0VtYWlsXG4gICAgICAgICAgICA/IDxpbWdcbiAgICAgICAgICAgICAgICBzcmM9e3JlcXVpcmUoXCIuLi8uLi8uLi8uLi9yZXMvaW1nL2ljb24tZW1haWwtcGlsbC1hdmF0YXIuc3ZnXCIpfVxuICAgICAgICAgICAgICAgIHdpZHRoPXthdmF0YXJTaXplfVxuICAgICAgICAgICAgICAgIGhlaWdodD17YXZhdGFyU2l6ZX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA6IDxCYXNlQXZhdGFyXG4gICAgICAgICAgICAgICAgdXJsPXt0aGlzLnByb3BzLm1lbWJlci5nZXRNeGNBdmF0YXJVcmwoKVxuICAgICAgICAgICAgICAgICAgICA/IG1lZGlhRnJvbU14Yyh0aGlzLnByb3BzLm1lbWJlci5nZXRNeGNBdmF0YXJVcmwoKSkuZ2V0U3F1YXJlVGh1bWJuYWlsSHR0cChhdmF0YXJTaXplKVxuICAgICAgICAgICAgICAgICAgICA6IG51bGx9XG4gICAgICAgICAgICAgICAgbmFtZT17dGhpcy5wcm9wcy5tZW1iZXIubmFtZX1cbiAgICAgICAgICAgICAgICBpZE5hbWU9e3RoaXMucHJvcHMubWVtYmVyLnVzZXJJZH1cbiAgICAgICAgICAgICAgICB3aWR0aD17YXZhdGFyU2l6ZX1cbiAgICAgICAgICAgICAgICBoZWlnaHQ9e2F2YXRhclNpemV9IC8+O1xuXG4gICAgICAgIGxldCBjaGVja21hcmsgPSBudWxsO1xuICAgICAgICBpZiAodGhpcy5wcm9wcy5pc1NlbGVjdGVkKSB7XG4gICAgICAgICAgICAvLyBUbyByZWR1Y2UgZmxpY2tlcmluZyB3ZSBwdXQgdGhlICdzZWxlY3RlZCcgcm9vbSB0aWxlIGFib3ZlIHRoZSByZWFsIGF2YXRhclxuICAgICAgICAgICAgY2hlY2ttYXJrID0gPGRpdiBjbGFzc05hbWU9J214X0ludml0ZURpYWxvZ19yb29tVGlsZV9zZWxlY3RlZCcgLz47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUbyByZWR1Y2UgZmxpY2tlcmluZyB3ZSBwdXQgdGhlIGNoZWNrbWFyayBvbiB0b3Agb2YgdGhlIGFjdHVhbCBhdmF0YXIgKHByZXZlbnRzXG4gICAgICAgIC8vIHRoZSBicm93c2VyIGZyb20gcmVsb2FkaW5nIHRoZSBpbWFnZSBzb3VyY2Ugd2hlbiB0aGUgYXZhdGFyIHJlbW91bnRzKS5cbiAgICAgICAgY29uc3Qgc3RhY2tlZEF2YXRhciA9IChcbiAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT0nbXhfSW52aXRlRGlhbG9nX3Jvb21UaWxlX2F2YXRhclN0YWNrJz5cbiAgICAgICAgICAgICAgICB7IGF2YXRhciB9XG4gICAgICAgICAgICAgICAgeyBjaGVja21hcmsgfVxuICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IGNhcHRpb24gPSAodGhpcy5wcm9wcy5tZW1iZXIgYXMgVGhyZWVwaWRNZW1iZXIpLmlzRW1haWxcbiAgICAgICAgICAgID8gX3QoXCJJbnZpdGUgYnkgZW1haWxcIilcbiAgICAgICAgICAgIDogdGhpcy5oaWdobGlnaHROYW1lKHRoaXMucHJvcHMubWVtYmVyLnVzZXJJZCk7XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdteF9JbnZpdGVEaWFsb2dfcm9vbVRpbGUnIG9uQ2xpY2s9e3RoaXMub25DbGlja30+XG4gICAgICAgICAgICAgICAgeyBzdGFja2VkQXZhdGFyIH1cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJteF9JbnZpdGVEaWFsb2dfcm9vbVRpbGVfbmFtZVN0YWNrXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdteF9JbnZpdGVEaWFsb2dfcm9vbVRpbGVfbmFtZSc+eyB0aGlzLmhpZ2hsaWdodE5hbWUodGhpcy5wcm9wcy5tZW1iZXIubmFtZSkgfTwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nbXhfSW52aXRlRGlhbG9nX3Jvb21UaWxlX3VzZXJJZCc+eyBjYXB0aW9uIH08L2Rpdj5cbiAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgeyB0aW1lc3RhbXAgfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5pbnRlcmZhY2UgSUludml0ZURpYWxvZ1Byb3BzIHtcbiAgICAvLyBUYWtlcyBhbiBhcnJheSBvZiB1c2VyIElEcy9lbWFpbHMgdG8gaW52aXRlLlxuICAgIG9uRmluaXNoZWQ6ICh0b0ludml0ZT86IHN0cmluZ1tdKSA9PiB2b2lkO1xuXG4gICAgLy8gVGhlIGtpbmQgb2YgaW52aXRlIGJlaW5nIHBlcmZvcm1lZC4gQXNzdW1lZCB0byBiZSBLSU5EX0RNIGlmXG4gICAgLy8gbm90IHByb3ZpZGVkLlxuICAgIGtpbmQ6IHN0cmluZztcblxuICAgIC8vIFRoZSByb29tIElEIHRoaXMgZGlhbG9nIGlzIGZvci4gT25seSByZXF1aXJlZCBmb3IgS0lORF9JTlZJVEUuXG4gICAgcm9vbUlkOiBzdHJpbmc7XG5cbiAgICAvLyBUaGUgY2FsbCB0byB0cmFuc2Zlci4gT25seSByZXF1aXJlZCBmb3IgS0lORF9DQUxMX1RSQU5TRkVSLlxuICAgIGNhbGw6IE1hdHJpeENhbGw7XG5cbiAgICAvLyBJbml0aWFsIHZhbHVlIHRvIHBvcHVsYXRlIHRoZSBmaWx0ZXIgd2l0aFxuICAgIGluaXRpYWxUZXh0OiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBJSW52aXRlRGlhbG9nU3RhdGUge1xuICAgIHRhcmdldHM6IE1lbWJlcltdOyAvLyBhcnJheSBvZiBNZW1iZXIgb2JqZWN0cyAoc2VlIGludGVyZmFjZSBhYm92ZSlcbiAgICBmaWx0ZXJUZXh0OiBzdHJpbmc7XG4gICAgcmVjZW50czogeyB1c2VyOiBNZW1iZXIsIHVzZXJJZDogc3RyaW5nIH1bXTtcbiAgICBudW1SZWNlbnRzU2hvd246IG51bWJlcjtcbiAgICBzdWdnZXN0aW9uczogeyB1c2VyOiBNZW1iZXIsIHVzZXJJZDogc3RyaW5nIH1bXTtcbiAgICBudW1TdWdnZXN0aW9uc1Nob3duOiBudW1iZXI7XG4gICAgc2VydmVyUmVzdWx0c01peGluOiB7IHVzZXI6IE1lbWJlciwgdXNlcklkOiBzdHJpbmcgfVtdO1xuICAgIHRocmVlcGlkUmVzdWx0c01peGluOiB7IHVzZXI6IE1lbWJlciwgdXNlcklkOiBzdHJpbmd9W107XG4gICAgY2FuVXNlSWRlbnRpdHlTZXJ2ZXI6IGJvb2xlYW47XG4gICAgdHJ5aW5nSWRlbnRpdHlTZXJ2ZXI6IGJvb2xlYW47XG4gICAgY29uc3VsdEZpcnN0OiBib29sZWFuO1xuICAgIGRpYWxQYWRWYWx1ZTogc3RyaW5nO1xuICAgIGN1cnJlbnRUYWJJZDogVGFiSWQ7XG5cbiAgICAvLyBUaGVzZSB0d28gZmxhZ3MgYXJlIHVzZWQgZm9yIHRoZSAnR28nIGJ1dHRvbiB0byBjb21tdW5pY2F0ZSB3aGF0IGlzIGdvaW5nIG9uLlxuICAgIGJ1c3k6IGJvb2xlYW47XG4gICAgZXJyb3JUZXh0OiBzdHJpbmc7XG59XG5cbkByZXBsYWNlYWJsZUNvbXBvbmVudChcInZpZXdzLmRpYWxvZ3MuSW52aXRlRGlhbG9nXCIpXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBJbnZpdGVEaWFsb2cgZXh0ZW5kcyBSZWFjdC5QdXJlQ29tcG9uZW50PElJbnZpdGVEaWFsb2dQcm9wcywgSUludml0ZURpYWxvZ1N0YXRlPiB7XG4gICAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICAgICAga2luZDogS0lORF9ETSxcbiAgICAgICAgaW5pdGlhbFRleHQ6IFwiXCIsXG4gICAgfTtcblxuICAgIHByaXZhdGUgY2xvc2VDb3BpZWRUb29sdGlwOiAoKSA9PiB2b2lkO1xuICAgIHByaXZhdGUgZGVib3VuY2VUaW1lcjogbnVtYmVyID0gbnVsbDsgLy8gYWN0dWFsbHkgbnVtYmVyIGJlY2F1c2Ugd2UncmUgaW4gdGhlIGJyb3dzZXJcbiAgICBwcml2YXRlIGVkaXRvclJlZiA9IGNyZWF0ZVJlZjxIVE1MSW5wdXRFbGVtZW50PigpO1xuICAgIHByaXZhdGUgbnVtYmVyRW50cnlGaWVsZFJlZjogUmVhY3QuUmVmT2JqZWN0PEZpZWxkPiA9IGNyZWF0ZVJlZigpO1xuICAgIHByaXZhdGUgdW5tb3VudGVkID0gZmFsc2U7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgICBzdXBlcihwcm9wcyk7XG5cbiAgICAgICAgaWYgKChwcm9wcy5raW5kID09PSBLSU5EX0lOVklURSkgJiYgIXByb3BzLnJvb21JZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiV2hlbiB1c2luZyBLSU5EX0lOVklURSBhIHJvb21JZCBpcyByZXF1aXJlZCBmb3IgYW4gSW52aXRlRGlhbG9nXCIpO1xuICAgICAgICB9IGVsc2UgaWYgKHByb3BzLmtpbmQgPT09IEtJTkRfQ0FMTF9UUkFOU0ZFUiAmJiAhcHJvcHMuY2FsbCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiV2hlbiB1c2luZyBLSU5EX0NBTExfVFJBTlNGRVIgYSBjYWxsIGlzIHJlcXVpcmVkIGZvciBhbiBJbnZpdGVEaWFsb2dcIik7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBhbHJlYWR5SW52aXRlZCA9IG5ldyBTZXQoW01hdHJpeENsaWVudFBlZy5nZXQoKS5nZXRVc2VySWQoKSwgU2RrQ29uZmlnLmdldCgpWyd3ZWxjb21lVXNlcklkJ11dKTtcbiAgICAgICAgaWYgKHByb3BzLnJvb21JZCkge1xuICAgICAgICAgICAgY29uc3Qgcm9vbSA9IE1hdHJpeENsaWVudFBlZy5nZXQoKS5nZXRSb29tKHByb3BzLnJvb21JZCk7XG4gICAgICAgICAgICBpZiAoIXJvb20pIHRocm93IG5ldyBFcnJvcihcIlJvb20gSUQgZ2l2ZW4gdG8gSW52aXRlRGlhbG9nIGRvZXMgbm90IGxvb2sgbGlrZSBhIHJvb21cIik7XG4gICAgICAgICAgICByb29tLmdldE1lbWJlcnNXaXRoTWVtYmVyc2hpcCgnaW52aXRlJykuZm9yRWFjaChtID0+IGFscmVhZHlJbnZpdGVkLmFkZChtLnVzZXJJZCkpO1xuICAgICAgICAgICAgcm9vbS5nZXRNZW1iZXJzV2l0aE1lbWJlcnNoaXAoJ2pvaW4nKS5mb3JFYWNoKG0gPT4gYWxyZWFkeUludml0ZWQuYWRkKG0udXNlcklkKSk7XG4gICAgICAgICAgICAvLyBhZGQgYmFubmVkIHVzZXJzLCBzbyB3ZSBkb24ndCB0cnkgdG8gaW52aXRlIHRoZW1cbiAgICAgICAgICAgIHJvb20uZ2V0TWVtYmVyc1dpdGhNZW1iZXJzaGlwKCdiYW4nKS5mb3JFYWNoKG0gPT4gYWxyZWFkeUludml0ZWQuYWRkKG0udXNlcklkKSk7XG5cbiAgICAgICAgICAgIENvdW50bHlBbmFseXRpY3MuaW5zdGFuY2UudHJhY2tCZWdpbkludml0ZShwcm9wcy5yb29tSWQpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgICAgIHRhcmdldHM6IFtdLCAvLyBhcnJheSBvZiBNZW1iZXIgb2JqZWN0cyAoc2VlIGludGVyZmFjZSBhYm92ZSlcbiAgICAgICAgICAgIGZpbHRlclRleHQ6IHRoaXMucHJvcHMuaW5pdGlhbFRleHQsXG4gICAgICAgICAgICByZWNlbnRzOiBJbnZpdGVEaWFsb2cuYnVpbGRSZWNlbnRzKGFscmVhZHlJbnZpdGVkKSxcbiAgICAgICAgICAgIG51bVJlY2VudHNTaG93bjogSU5JVElBTF9ST09NU19TSE9XTixcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zOiB0aGlzLmJ1aWxkU3VnZ2VzdGlvbnMoYWxyZWFkeUludml0ZWQpLFxuICAgICAgICAgICAgbnVtU3VnZ2VzdGlvbnNTaG93bjogSU5JVElBTF9ST09NU19TSE9XTixcbiAgICAgICAgICAgIHNlcnZlclJlc3VsdHNNaXhpbjogW10sXG4gICAgICAgICAgICB0aHJlZXBpZFJlc3VsdHNNaXhpbjogW10sXG4gICAgICAgICAgICBjYW5Vc2VJZGVudGl0eVNlcnZlcjogISFNYXRyaXhDbGllbnRQZWcuZ2V0KCkuZ2V0SWRlbnRpdHlTZXJ2ZXJVcmwoKSxcbiAgICAgICAgICAgIHRyeWluZ0lkZW50aXR5U2VydmVyOiBmYWxzZSxcbiAgICAgICAgICAgIGNvbnN1bHRGaXJzdDogZmFsc2UsXG4gICAgICAgICAgICBkaWFsUGFkVmFsdWU6ICcnLFxuICAgICAgICAgICAgY3VycmVudFRhYklkOiBUYWJJZC5Vc2VyRGlyZWN0b3J5LFxuXG4gICAgICAgICAgICAvLyBUaGVzZSB0d28gZmxhZ3MgYXJlIHVzZWQgZm9yIHRoZSAnR28nIGJ1dHRvbiB0byBjb21tdW5pY2F0ZSB3aGF0IGlzIGdvaW5nIG9uLlxuICAgICAgICAgICAgYnVzeTogZmFsc2UsXG4gICAgICAgICAgICBlcnJvclRleHQ6IG51bGwsXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICAgIGlmICh0aGlzLnByb3BzLmluaXRpYWxUZXh0KSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN1Z2dlc3Rpb25zKHRoaXMucHJvcHMuaW5pdGlhbFRleHQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgICAgIHRoaXMudW5tb3VudGVkID0gdHJ1ZTtcbiAgICAgICAgLy8gaWYgdGhlIENvcGllZCB0b29sdGlwIGlzIG9wZW4gdGhlbiBnZXQgcmlkIG9mIGl0LCB0aGVyZSBhcmUgd2F5cyB0byBjbG9zZSB0aGUgbW9kYWwgd2hpY2ggd291bGRuJ3QgY2xvc2VcbiAgICAgICAgLy8gdGhlIHRvb2x0aXAgb3RoZXJ3aXNlLCBzdWNoIGFzIHByZXNzaW5nIEVzY2FwZSBvciBjbGlja2luZyBYIHJlYWxseSBxdWlja2x5XG4gICAgICAgIGlmICh0aGlzLmNsb3NlQ29waWVkVG9vbHRpcCkgdGhpcy5jbG9zZUNvcGllZFRvb2x0aXAoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIG9uQ29uc3VsdEZpcnN0Q2hhbmdlID0gKGV2KSA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBjb25zdWx0Rmlyc3Q6IGV2LnRhcmdldC5jaGVja2VkIH0pO1xuICAgIH07XG5cbiAgICBwdWJsaWMgc3RhdGljIGJ1aWxkUmVjZW50cyhleGNsdWRlZFRhcmdldElkczogU2V0PHN0cmluZz4pOiBJUmVjZW50VXNlcltdIHtcbiAgICAgICAgY29uc3Qgcm9vbXMgPSBETVJvb21NYXAuc2hhcmVkKCkuZ2V0VW5pcXVlUm9vbXNXaXRoSW5kaXZpZHVhbHMoKTsgLy8gbWFwIG9mIHVzZXJJZCA9PiBqcy1zZGsgUm9vbVxuXG4gICAgICAgIC8vIEFsc28gcHVsbCBpbiBhbGwgdGhlIHJvb21zIHRhZ2dlZCBhcyBEZWZhdWx0VGFnSUQuRE0gc28gd2UgZG9uJ3QgbWlzcyBhbnl0aGluZy4gU29tZXRpbWVzIHRoZVxuICAgICAgICAvLyByb29tIGxpc3QgZG9lc24ndCB0YWcgdGhlIHJvb20gZm9yIHRoZSBETVJvb21NYXAsIGJ1dCBkb2VzIGZvciB0aGUgcm9vbSBsaXN0LlxuICAgICAgICBjb25zdCBkbVRhZ2dlZFJvb21zID0gUm9vbUxpc3RTdG9yZS5pbnN0YW5jZS5vcmRlcmVkTGlzdHNbRGVmYXVsdFRhZ0lELkRNXSB8fCBbXTtcbiAgICAgICAgY29uc3QgbXlVc2VySWQgPSBNYXRyaXhDbGllbnRQZWcuZ2V0KCkuZ2V0VXNlcklkKCk7XG4gICAgICAgIGZvciAoY29uc3QgZG1Sb29tIG9mIGRtVGFnZ2VkUm9vbXMpIHtcbiAgICAgICAgICAgIGNvbnN0IG90aGVyTWVtYmVycyA9IGRtUm9vbS5nZXRKb2luZWRNZW1iZXJzKCkuZmlsdGVyKHUgPT4gdS51c2VySWQgIT09IG15VXNlcklkKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbWVtYmVyIG9mIG90aGVyTWVtYmVycykge1xuICAgICAgICAgICAgICAgIGlmIChyb29tc1ttZW1iZXIudXNlcklkXSkgY29udGludWU7IC8vIGFscmVhZHkgaGF2ZSBhIHJvb21cblxuICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuKGBBZGRpbmcgRE0gcm9vbSBmb3IgJHttZW1iZXIudXNlcklkfSBhcyAke2RtUm9vbS5yb29tSWR9IGZyb20gdGFnLCBub3QgRE0gbWFwYCk7XG4gICAgICAgICAgICAgICAgcm9vbXNbbWVtYmVyLnVzZXJJZF0gPSBkbVJvb207XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByZWNlbnRzID0gW107XG4gICAgICAgIGZvciAoY29uc3QgdXNlcklkIGluIHJvb21zKSB7XG4gICAgICAgICAgICAvLyBGaWx0ZXIgb3V0IHVzZXIgSURzIHRoYXQgYXJlIGFscmVhZHkgaW4gdGhlIHJvb20gLyBzaG91bGQgYmUgZXhjbHVkZWRcbiAgICAgICAgICAgIGlmIChleGNsdWRlZFRhcmdldElkcy5oYXModXNlcklkKSkge1xuICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuKGBbSW52aXRlOlJlY2VudHNdIEV4Y2x1ZGluZyAke3VzZXJJZH0gZnJvbSByZWNlbnRzYCk7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHJvb20gPSByb29tc1t1c2VySWRdO1xuICAgICAgICAgICAgY29uc3QgbWVtYmVyID0gcm9vbS5nZXRNZW1iZXIodXNlcklkKTtcbiAgICAgICAgICAgIGlmICghbWVtYmVyKSB7XG4gICAgICAgICAgICAgICAgLy8ganVzdCBza2lwIHBlb3BsZSB3aG8gZG9uJ3QgaGF2ZSBtZW1iZXJzaGlwcyBmb3Igc29tZSByZWFzb25cbiAgICAgICAgICAgICAgICBsb2dnZXIud2FybihgW0ludml0ZTpSZWNlbnRzXSAke3VzZXJJZH0gaXMgbWlzc2luZyBhIG1lbWJlciBvYmplY3QgaW4gdGhlaXIgb3duIERNICgke3Jvb20ucm9vbUlkfSlgKTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRmluZCB0aGUgbGFzdCB0aW1lc3RhbXAgZm9yIGEgbWVzc2FnZSBldmVudFxuICAgICAgICAgICAgY29uc3Qgc2VhcmNoVHlwZXMgPSBbXCJtLnJvb20ubWVzc2FnZVwiLCBcIm0ucm9vbS5lbmNyeXB0ZWRcIiwgXCJtLnN0aWNrZXJcIl07XG4gICAgICAgICAgICBjb25zdCBtYXhTZWFyY2hFdmVudHMgPSAyMDsgLy8gdG8gcHJldmVudCB0cmF2ZXJzaW5nIGhpc3RvcnlcbiAgICAgICAgICAgIGxldCBsYXN0RXZlbnRUcyA9IDA7XG4gICAgICAgICAgICBpZiAocm9vbS50aW1lbGluZSAmJiByb29tLnRpbWVsaW5lLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSByb29tLnRpbWVsaW5lLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGV2ID0gcm9vbS50aW1lbGluZVtpXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlYXJjaFR5cGVzLmluY2x1ZGVzKGV2LmdldFR5cGUoKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RFdmVudFRzID0gZXYuZ2V0VHMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChyb29tLnRpbWVsaW5lLmxlbmd0aCAtIGkgPiBtYXhTZWFyY2hFdmVudHMpIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghbGFzdEV2ZW50VHMpIHtcbiAgICAgICAgICAgICAgICAvLyBzb21ldGhpbmcgd2VpcmQgaXMgZ29pbmcgb24gd2l0aCB0aGlzIHJvb21cbiAgICAgICAgICAgICAgICBsb2dnZXIud2FybihgW0ludml0ZTpSZWNlbnRzXSAke3VzZXJJZH0gKCR7cm9vbS5yb29tSWR9KSBoYXMgYSB3ZWlyZCBsYXN0IHRpbWVzdGFtcDogJHtsYXN0RXZlbnRUc31gKTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmVjZW50cy5wdXNoKHsgdXNlcklkLCB1c2VyOiBtZW1iZXIsIGxhc3RBY3RpdmU6IGxhc3RFdmVudFRzIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcmVjZW50cykgbG9nZ2VyLndhcm4oXCJbSW52aXRlOlJlY2VudHNdIE5vIHJlY2VudHMgdG8gc3VnZ2VzdCFcIik7XG5cbiAgICAgICAgLy8gU29ydCB0aGUgcmVjZW50cyBieSBsYXN0IGFjdGl2ZSB0byBzYXZlIHVzIHRpbWUgbGF0ZXJcbiAgICAgICAgcmVjZW50cy5zb3J0KChhLCBiKSA9PiBiLmxhc3RBY3RpdmUgLSBhLmxhc3RBY3RpdmUpO1xuXG4gICAgICAgIHJldHVybiByZWNlbnRzO1xuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGRTdWdnZXN0aW9ucyhleGNsdWRlZFRhcmdldElkczogU2V0PHN0cmluZz4pOiB7dXNlcklkOiBzdHJpbmcsIHVzZXI6IFJvb21NZW1iZXJ9W10ge1xuICAgICAgICBjb25zdCBtYXhDb25zaWRlcmVkTWVtYmVycyA9IDIwMDtcbiAgICAgICAgY29uc3Qgam9pbmVkUm9vbXMgPSBNYXRyaXhDbGllbnRQZWcuZ2V0KCkuZ2V0Um9vbXMoKVxuICAgICAgICAgICAgLmZpbHRlcihyID0+IHIuZ2V0TXlNZW1iZXJzaGlwKCkgPT09ICdqb2luJyAmJiByLmdldEpvaW5lZE1lbWJlckNvdW50KCkgPD0gbWF4Q29uc2lkZXJlZE1lbWJlcnMpO1xuXG4gICAgICAgIC8vIEdlbmVyYXRlcyB7IHVzZXJJZDoge21lbWJlciwgcm9vbXNbXX0gfVxuICAgICAgICBjb25zdCBtZW1iZXJSb29tcyA9IGpvaW5lZFJvb21zLnJlZHVjZSgobWVtYmVycywgcm9vbSkgPT4ge1xuICAgICAgICAgICAgLy8gRmlsdGVyIG91dCBETXMgKHdlJ2xsIGhhbmRsZSB0aGVzZSBpbiB0aGUgcmVjZW50cyBzZWN0aW9uKVxuICAgICAgICAgICAgaWYgKERNUm9vbU1hcC5zaGFyZWQoKS5nZXRVc2VySWRGb3JSb29tSWQocm9vbS5yb29tSWQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1lbWJlcnM7IC8vIERvIG5vdGhpbmdcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3Qgam9pbmVkTWVtYmVycyA9IHJvb20uZ2V0Sm9pbmVkTWVtYmVycygpLmZpbHRlcih1ID0+ICFleGNsdWRlZFRhcmdldElkcy5oYXModS51c2VySWQpKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbWVtYmVyIG9mIGpvaW5lZE1lbWJlcnMpIHtcbiAgICAgICAgICAgICAgICAvLyBGaWx0ZXIgb3V0IHVzZXIgSURzIHRoYXQgYXJlIGFscmVhZHkgaW4gdGhlIHJvb20gLyBzaG91bGQgYmUgZXhjbHVkZWRcbiAgICAgICAgICAgICAgICBpZiAoZXhjbHVkZWRUYXJnZXRJZHMuaGFzKG1lbWJlci51c2VySWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICghbWVtYmVyc1ttZW1iZXIudXNlcklkXSkge1xuICAgICAgICAgICAgICAgICAgICBtZW1iZXJzW21lbWJlci51c2VySWRdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVtYmVyOiBtZW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUcmFjayB0aGUgcm9vbSBzaXplIG9mIHRoZSAncGlja2VkJyBtZW1iZXIgc28gd2UgY2FuIHVzZSB0aGUgcHJvZmlsZSBvZlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHNtYWxsZXN0IHJvb20gKGxpa2VseSBhIERNKS5cbiAgICAgICAgICAgICAgICAgICAgICAgIHBpY2tlZE1lbWJlclJvb21TaXplOiByb29tLmdldEpvaW5lZE1lbWJlckNvdW50KCksXG4gICAgICAgICAgICAgICAgICAgICAgICByb29tczogW10sXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbWVtYmVyc1ttZW1iZXIudXNlcklkXS5yb29tcy5wdXNoKHJvb20pO1xuXG4gICAgICAgICAgICAgICAgaWYgKHJvb20uZ2V0Sm9pbmVkTWVtYmVyQ291bnQoKSA8IG1lbWJlcnNbbWVtYmVyLnVzZXJJZF0ucGlja2VkTWVtYmVyUm9vbVNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgbWVtYmVyc1ttZW1iZXIudXNlcklkXS5tZW1iZXIgPSBtZW1iZXI7XG4gICAgICAgICAgICAgICAgICAgIG1lbWJlcnNbbWVtYmVyLnVzZXJJZF0ucGlja2VkTWVtYmVyUm9vbVNpemUgPSByb29tLmdldEpvaW5lZE1lbWJlckNvdW50KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG1lbWJlcnM7XG4gICAgICAgIH0sIHt9KTtcblxuICAgICAgICAvLyBHZW5lcmF0ZXMgeyB1c2VySWQ6IHttZW1iZXIsIG51bVJvb21zLCBzY29yZX0gfVxuICAgICAgICBjb25zdCBtZW1iZXJTY29yZXMgPSBPYmplY3QudmFsdWVzKG1lbWJlclJvb21zKS5yZWR1Y2UoKHNjb3JlcywgZW50cnk6IHttZW1iZXI6IFJvb21NZW1iZXIsIHJvb21zOiBSb29tW119KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBudW1NZW1iZXJzVG90YWwgPSBlbnRyeS5yb29tcy5yZWR1Y2UoKGMsIHIpID0+IGMgKyByLmdldEpvaW5lZE1lbWJlckNvdW50KCksIDApO1xuICAgICAgICAgICAgY29uc3QgbWF4UmFuZ2UgPSBtYXhDb25zaWRlcmVkTWVtYmVycyAqIGVudHJ5LnJvb21zLmxlbmd0aDtcbiAgICAgICAgICAgIHNjb3Jlc1tlbnRyeS5tZW1iZXIudXNlcklkXSA9IHtcbiAgICAgICAgICAgICAgICBtZW1iZXI6IGVudHJ5Lm1lbWJlcixcbiAgICAgICAgICAgICAgICBudW1Sb29tczogZW50cnkucm9vbXMubGVuZ3RoLFxuICAgICAgICAgICAgICAgIHNjb3JlOiBNYXRoLm1heCgwLCBNYXRoLnBvdygxIC0gKG51bU1lbWJlcnNUb3RhbCAvIG1heFJhbmdlKSwgNSkpLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBzY29yZXM7XG4gICAgICAgIH0sIHt9KTtcblxuICAgICAgICAvLyBOb3cgdGhhdCB3ZSBoYXZlIHNjb3JlcyBmb3IgYmVpbmcgaW4gcm9vbXMsIGJvb3N0IHRob3NlIHBlb3BsZSB3aG8gaGF2ZSBzZW50IG1lc3NhZ2VzXG4gICAgICAgIC8vIHJlY2VudGx5LCBhcyBhIHdheSB0byBpbXByb3ZlIHRoZSBxdWFsaXR5IG9mIHN1Z2dlc3Rpb25zLiBXZSBkbyB0aGlzIGJ5IGNoZWNraW5nIGV2ZXJ5XG4gICAgICAgIC8vIHJvb20gdG8gc2VlIHdobyBoYXMgc2VudCBhIG1lc3NhZ2UgaW4gdGhlIGxhc3QgZmV3IGhvdXJzLCBhbmQgZ2l2aW5nIHRoZW0gYSBzY29yZVxuICAgICAgICAvLyB3aGljaCBjb3JyZWxhdGVzIHRvIHRoZSBmcmVzaG5lc3Mgb2YgdGhlaXIgbWVzc2FnZS4gSW4gdGhlb3J5LCB0aGlzIHJlc3VsdHMgaW4gc3VnZ2VzdGlvbnNcbiAgICAgICAgLy8gd2hpY2ggYXJlIGNsb3NlciB0byBcImNvbnRpbnVlIHRoaXMgY29udmVyc2F0aW9uXCIgcmF0aGVyIHRoYW4gXCJ0aGlzIHBlcnNvbiBleGlzdHNcIi5cbiAgICAgICAgY29uc3QgdHJ1ZUpvaW5lZFJvb21zID0gTWF0cml4Q2xpZW50UGVnLmdldCgpLmdldFJvb21zKCkuZmlsdGVyKHIgPT4gci5nZXRNeU1lbWJlcnNoaXAoKSA9PT0gJ2pvaW4nKTtcbiAgICAgICAgY29uc3Qgbm93ID0gKG5ldyBEYXRlKCkpLmdldFRpbWUoKTtcbiAgICAgICAgY29uc3QgZWFybGllc3RBZ2VDb25zaWRlcmVkID0gbm93IC0gKDYwICogNjAgKiAxMDAwKTsgLy8gMSBob3VyIGFnb1xuICAgICAgICBjb25zdCBtYXhNZXNzYWdlc0NvbnNpZGVyZWQgPSA1MDsgLy8gc28gd2UgZG9uJ3QgaXRlcmF0ZSBvdmVyIGEgaHVnZSBhbW91bnQgb2YgdHJhZmZpY1xuICAgICAgICBjb25zdCBsYXN0U3Bva2UgPSB7fTsgLy8gdXNlcklkOiB0aW1lc3RhbXBcbiAgICAgICAgY29uc3QgbGFzdFNwb2tlTWVtYmVycyA9IHt9OyAvLyB1c2VySWQ6IHJvb20gbWVtYmVyXG4gICAgICAgIGZvciAoY29uc3Qgcm9vbSBvZiB0cnVlSm9pbmVkUm9vbXMpIHtcbiAgICAgICAgICAgIC8vIFNraXAgbG93IHByaW9yaXR5IHJvb21zIGFuZCBETXNcbiAgICAgICAgICAgIGNvbnN0IGlzRG0gPSBETVJvb21NYXAuc2hhcmVkKCkuZ2V0VXNlcklkRm9yUm9vbUlkKHJvb20ucm9vbUlkKTtcbiAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhyb29tLnRhZ3MpLmluY2x1ZGVzKFwibS5sb3dwcmlvcml0eVwiKSB8fCBpc0RtKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGV2ZW50cyA9IHJvb20uZ2V0TGl2ZVRpbWVsaW5lKCkuZ2V0RXZlbnRzKCk7IC8vIHRpbWVsaW5lcyBhcmUgbW9zdCByZWNlbnQgbGFzdFxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IGV2ZW50cy5sZW5ndGggLSAxOyBpID49IE1hdGgubWF4KDAsIGV2ZW50cy5sZW5ndGggLSBtYXhNZXNzYWdlc0NvbnNpZGVyZWQpOyBpLS0pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBldiA9IGV2ZW50c1tpXTtcbiAgICAgICAgICAgICAgICBpZiAoZXhjbHVkZWRUYXJnZXRJZHMuaGFzKGV2LmdldFNlbmRlcigpKSkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGV2LmdldFRzKCkgPD0gZWFybGllc3RBZ2VDb25zaWRlcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrOyAvLyBnaXZlIHVwOiBhbGwgZXZlbnRzIGZyb20gaGVyZSBvbiBvdXQgYXJlIHRvbyBvbGRcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoIWxhc3RTcG9rZVtldi5nZXRTZW5kZXIoKV0gfHwgbGFzdFNwb2tlW2V2LmdldFNlbmRlcigpXSA8IGV2LmdldFRzKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgbGFzdFNwb2tlW2V2LmdldFNlbmRlcigpXSA9IGV2LmdldFRzKCk7XG4gICAgICAgICAgICAgICAgICAgIGxhc3RTcG9rZU1lbWJlcnNbZXYuZ2V0U2VuZGVyKCldID0gcm9vbS5nZXRNZW1iZXIoZXYuZ2V0U2VuZGVyKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IHVzZXJJZCBpbiBsYXN0U3Bva2UpIHtcbiAgICAgICAgICAgIGNvbnN0IHRzID0gbGFzdFNwb2tlW3VzZXJJZF07XG4gICAgICAgICAgICBjb25zdCBtZW1iZXIgPSBsYXN0U3Bva2VNZW1iZXJzW3VzZXJJZF07XG4gICAgICAgICAgICBpZiAoIW1lbWJlcikgY29udGludWU7IC8vIHNraXAgcGVvcGxlIHdlIHNvbWVob3cgZG9uJ3QgaGF2ZSBwcm9maWxlcyBmb3JcblxuICAgICAgICAgICAgLy8gU2NvcmVzIGZyb20gYmVpbmcgaW4gYSByb29tIGdpdmUgYSAnZ29vZCcgc2NvcmUgb2YgYWJvdXQgMS4wLTEuNSwgc28gZm9yIG91clxuICAgICAgICAgICAgLy8gYm9vc3Qgd2UnbGwgdHJ5IGFuZCBhd2FyZCBhdCBsZWFzdCArMS4wIGZvciBtYWtpbmcgdGhlIGxpc3QsIHdpdGggKzQuMCBiZWluZ1xuICAgICAgICAgICAgLy8gYW4gYXBwcm94aW1hdGUgbWF4aW11bSBmb3IgYmVpbmcgc2VsZWN0ZWQuXG4gICAgICAgICAgICBjb25zdCBkaXN0YW5jZUZyb21Ob3cgPSBNYXRoLmFicyhub3cgLSB0cyk7IC8vIGFicyB0byBhY2NvdW50IGZvciBzbGlnaHQgZnV0dXJlIG1lc3NhZ2VzXG4gICAgICAgICAgICBjb25zdCBpbnZlcnNlVGltZSA9IChub3cgLSBlYXJsaWVzdEFnZUNvbnNpZGVyZWQpIC0gZGlzdGFuY2VGcm9tTm93O1xuICAgICAgICAgICAgY29uc3Qgc2NvcmVCb29zdCA9IE1hdGgubWF4KDEsIGludmVyc2VUaW1lIC8gKDE1ICogNjAgKiAxMDAwKSk7IC8vIDE1bWluIHNlZ21lbnRzIHRvIGtlZXAgc2NvcmVzIHNhbmVcblxuICAgICAgICAgICAgbGV0IHJlY29yZCA9IG1lbWJlclNjb3Jlc1t1c2VySWRdO1xuICAgICAgICAgICAgaWYgKCFyZWNvcmQpIHJlY29yZCA9IG1lbWJlclNjb3Jlc1t1c2VySWRdID0geyBzY29yZTogMCB9O1xuICAgICAgICAgICAgcmVjb3JkLm1lbWJlciA9IG1lbWJlcjtcbiAgICAgICAgICAgIHJlY29yZC5zY29yZSArPSBzY29yZUJvb3N0O1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbWVtYmVycyA9IE9iamVjdC52YWx1ZXMobWVtYmVyU2NvcmVzKTtcbiAgICAgICAgbWVtYmVycy5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgICAgICBpZiAoYS5zY29yZSA9PT0gYi5zY29yZSkge1xuICAgICAgICAgICAgICAgIGlmIChhLm51bVJvb21zID09PSBiLm51bVJvb21zKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb21wYXJlKGEubWVtYmVyLnVzZXJJZCwgYi5tZW1iZXIudXNlcklkKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gYi5udW1Sb29tcyAtIGEubnVtUm9vbXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYi5zY29yZSAtIGEuc2NvcmU7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBtZW1iZXJzLm1hcChtID0+ICh7IHVzZXJJZDogbS5tZW1iZXIudXNlcklkLCB1c2VyOiBtLm1lbWJlciB9KSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzaG91bGRBYm9ydEFmdGVySW52aXRlRXJyb3IocmVzdWx0OiBJSW52aXRlUmVzdWx0LCByb29tOiBSb29tKTogYm9vbGVhbiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBidXN5OiBmYWxzZSB9KTtcbiAgICAgICAgY29uc3QgdXNlck1hcCA9IG5ldyBNYXA8c3RyaW5nLCBNZW1iZXI+KHRoaXMuc3RhdGUudGFyZ2V0cy5tYXAobWVtYmVyID0+IFttZW1iZXIudXNlcklkLCBtZW1iZXJdKSk7XG4gICAgICAgIHJldHVybiAhc2hvd0FueUludml0ZUVycm9ycyhyZXN1bHQuc3RhdGVzLCByb29tLCByZXN1bHQuaW52aXRlciwgdXNlck1hcCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjb252ZXJ0RmlsdGVyKCk6IE1lbWJlcltdIHtcbiAgICAgICAgLy8gQ2hlY2sgdG8gc2VlIGlmIHRoZXJlJ3MgYW55dGhpbmcgdG8gY29udmVydCBmaXJzdFxuICAgICAgICBpZiAoIXRoaXMuc3RhdGUuZmlsdGVyVGV4dCB8fCAhdGhpcy5zdGF0ZS5maWx0ZXJUZXh0LmluY2x1ZGVzKCdAJykpIHJldHVybiB0aGlzLnN0YXRlLnRhcmdldHMgfHwgW107XG5cbiAgICAgICAgbGV0IG5ld01lbWJlcjogTWVtYmVyO1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5maWx0ZXJUZXh0LnN0YXJ0c1dpdGgoJ0AnKSkge1xuICAgICAgICAgICAgLy8gQXNzdW1lIG14aWRcbiAgICAgICAgICAgIG5ld01lbWJlciA9IG5ldyBEaXJlY3RvcnlNZW1iZXIoeyB1c2VyX2lkOiB0aGlzLnN0YXRlLmZpbHRlclRleHQsIGRpc3BsYXlfbmFtZTogbnVsbCwgYXZhdGFyX3VybDogbnVsbCB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChTZXR0aW5nc1N0b3JlLmdldFZhbHVlKFVJRmVhdHVyZS5JZGVudGl0eVNlcnZlcikpIHtcbiAgICAgICAgICAgIC8vIEFzc3VtZSBlbWFpbFxuICAgICAgICAgICAgbmV3TWVtYmVyID0gbmV3IFRocmVlcGlkTWVtYmVyKHRoaXMuc3RhdGUuZmlsdGVyVGV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbmV3VGFyZ2V0cyA9IFsuLi4odGhpcy5zdGF0ZS50YXJnZXRzIHx8IFtdKSwgbmV3TWVtYmVyXTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHRhcmdldHM6IG5ld1RhcmdldHMsIGZpbHRlclRleHQ6ICcnIH0pO1xuICAgICAgICByZXR1cm4gbmV3VGFyZ2V0cztcbiAgICB9XG5cbiAgICBwcml2YXRlIHN0YXJ0RG0gPSBhc3luYyAoKSA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBidXN5OiB0cnVlIH0pO1xuICAgICAgICBjb25zdCBjbGllbnQgPSBNYXRyaXhDbGllbnRQZWcuZ2V0KCk7XG4gICAgICAgIGNvbnN0IHRhcmdldHMgPSB0aGlzLmNvbnZlcnRGaWx0ZXIoKTtcbiAgICAgICAgY29uc3QgdGFyZ2V0SWRzID0gdGFyZ2V0cy5tYXAodCA9PiB0LnVzZXJJZCk7XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlcmUgaXMgYWxyZWFkeSBhIERNIHdpdGggdGhlc2UgcGVvcGxlIGFuZCByZXVzZSBpdCBpZiBwb3NzaWJsZS5cbiAgICAgICAgbGV0IGV4aXN0aW5nUm9vbTogUm9vbTtcbiAgICAgICAgaWYgKHRhcmdldElkcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIGV4aXN0aW5nUm9vbSA9IGZpbmRETUZvclVzZXIoY2xpZW50LCB0YXJnZXRJZHNbMF0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZXhpc3RpbmdSb29tID0gRE1Sb29tTWFwLnNoYXJlZCgpLmdldERNUm9vbUZvcklkZW50aWZpZXJzKHRhcmdldElkcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV4aXN0aW5nUm9vbSkge1xuICAgICAgICAgICAgZGlzLmRpc3BhdGNoKHtcbiAgICAgICAgICAgICAgICBhY3Rpb246IEFjdGlvbi5WaWV3Um9vbSxcbiAgICAgICAgICAgICAgICByb29tX2lkOiBleGlzdGluZ1Jvb20ucm9vbUlkLFxuICAgICAgICAgICAgICAgIHNob3VsZF9wZWVrOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBqb2luaW5nOiBmYWxzZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5wcm9wcy5vbkZpbmlzaGVkKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjcmVhdGVSb29tT3B0aW9ucyA9IHsgaW5saW5lRXJyb3JzOiB0cnVlIH0gYXMgYW55OyAvLyBYWFg6IFR5cGUgb3V0IGBjcmVhdGVSb29tT3B0aW9uc2BcblxuICAgICAgICBpZiAocHJpdmF0ZVNob3VsZEJlRW5jcnlwdGVkKCkpIHtcbiAgICAgICAgICAgIC8vIENoZWNrIHdoZXRoZXIgYWxsIHVzZXJzIGhhdmUgdXBsb2FkZWQgZGV2aWNlIGtleXMgYmVmb3JlLlxuICAgICAgICAgICAgLy8gSWYgc28sIGVuYWJsZSBlbmNyeXB0aW9uIGluIHRoZSBuZXcgcm9vbS5cbiAgICAgICAgICAgIGNvbnN0IGhhczNQaWRNZW1iZXJzID0gdGFyZ2V0cy5zb21lKHQgPT4gdCBpbnN0YW5jZW9mIFRocmVlcGlkTWVtYmVyKTtcbiAgICAgICAgICAgIGlmICghaGFzM1BpZE1lbWJlcnMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBhbGxIYXZlRGV2aWNlS2V5cyA9IGF3YWl0IGNhbkVuY3J5cHRUb0FsbFVzZXJzKGNsaWVudCwgdGFyZ2V0SWRzKTtcbiAgICAgICAgICAgICAgICBpZiAoYWxsSGF2ZURldmljZUtleXMpIHtcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlUm9vbU9wdGlvbnMuZW5jcnlwdGlvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgaXQncyBhIHRyYWRpdGlvbmFsIERNIGFuZCBjcmVhdGUgdGhlIHJvb20gaWYgcmVxdWlyZWQuXG4gICAgICAgIC8vIFRPRE86IFtDYW5vbmljYWwgRE1zXSBSZW1vdmUgdGhpcyBjaGVjayBhbmQgaW5zdGVhZCBqdXN0IGNyZWF0ZSB0aGUgbXVsdGktcGVyc29uIERNXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBpc1NlbGYgPSB0YXJnZXRJZHMubGVuZ3RoID09PSAxICYmIHRhcmdldElkc1swXSA9PT0gY2xpZW50LmdldFVzZXJJZCgpO1xuICAgICAgICAgICAgaWYgKHRhcmdldElkcy5sZW5ndGggPT09IDEgJiYgIWlzU2VsZikge1xuICAgICAgICAgICAgICAgIGNyZWF0ZVJvb21PcHRpb25zLmRtVXNlcklkID0gdGFyZ2V0SWRzWzBdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGFyZ2V0SWRzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICBjcmVhdGVSb29tT3B0aW9ucy5jcmVhdGVPcHRzID0gdGFyZ2V0SWRzLnJlZHVjZShcbiAgICAgICAgICAgICAgICAgICAgKHJvb21PcHRpb25zLCBhZGRyZXNzKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0eXBlID0gZ2V0QWRkcmVzc1R5cGUoYWRkcmVzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gJ2VtYWlsJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGludml0ZTogSUludml0ZTNQSUQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3NlcnZlcjogY2xpZW50LmdldElkZW50aXR5U2VydmVyVXJsKHRydWUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZWRpdW06ICdlbWFpbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3MsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb29tT3B0aW9ucy5pbnZpdGVfM3BpZC5wdXNoKGludml0ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdteC11c2VyLWlkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvb21PcHRpb25zLmludml0ZS5wdXNoKGFkZHJlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJvb21PcHRpb25zO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB7IGludml0ZTogW10sIGludml0ZV8zcGlkOiBbXSB9LFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGF3YWl0IGNyZWF0ZVJvb20oY3JlYXRlUm9vbU9wdGlvbnMpO1xuICAgICAgICAgICAgdGhpcy5wcm9wcy5vbkZpbmlzaGVkKCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGVycik7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICBidXN5OiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvclRleHQ6IF90KFwiV2UgY291bGRuJ3QgY3JlYXRlIHlvdXIgRE0uXCIpLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBpbnZpdGVVc2VycyA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3Qgc3RhcnRUaW1lID0gQ291bnRseUFuYWx5dGljcy5nZXRUaW1lc3RhbXAoKTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGJ1c3k6IHRydWUgfSk7XG4gICAgICAgIHRoaXMuY29udmVydEZpbHRlcigpO1xuICAgICAgICBjb25zdCB0YXJnZXRzID0gdGhpcy5jb252ZXJ0RmlsdGVyKCk7XG4gICAgICAgIGNvbnN0IHRhcmdldElkcyA9IHRhcmdldHMubWFwKHQgPT4gdC51c2VySWQpO1xuXG4gICAgICAgIGNvbnN0IGNsaSA9IE1hdHJpeENsaWVudFBlZy5nZXQoKTtcbiAgICAgICAgY29uc3Qgcm9vbSA9IGNsaS5nZXRSb29tKHRoaXMucHJvcHMucm9vbUlkKTtcbiAgICAgICAgaWYgKCFyb29tKSB7XG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gZmluZCB0aGUgcm9vbSB0byBpbnZpdGUgdXNlcnMgdG9cIik7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICBidXN5OiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvclRleHQ6IF90KFwiU29tZXRoaW5nIHdlbnQgd3JvbmcgdHJ5aW5nIHRvIGludml0ZSB0aGUgdXNlcnMuXCIpLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgaW52aXRlTXVsdGlwbGVUb1Jvb20odGhpcy5wcm9wcy5yb29tSWQsIHRhcmdldElkcyk7XG4gICAgICAgICAgICBDb3VudGx5QW5hbHl0aWNzLmluc3RhbmNlLnRyYWNrU2VuZEludml0ZShzdGFydFRpbWUsIHRoaXMucHJvcHMucm9vbUlkLCB0YXJnZXRJZHMubGVuZ3RoKTtcbiAgICAgICAgICAgIGlmICghdGhpcy5zaG91bGRBYm9ydEFmdGVySW52aXRlRXJyb3IocmVzdWx0LCByb29tKSkgeyAvLyBoYW5kbGVzIHNldHRpbmcgZXJyb3IgbWVzc2FnZSB0b29cbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLm9uRmluaXNoZWQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGNsaS5pc1Jvb21FbmNyeXB0ZWQodGhpcy5wcm9wcy5yb29tSWQpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdmlzaWJpbGl0eUV2ZW50ID0gcm9vbS5jdXJyZW50U3RhdGUuZ2V0U3RhdGVFdmVudHMoXG4gICAgICAgICAgICAgICAgICAgIFwibS5yb29tLmhpc3RvcnlfdmlzaWJpbGl0eVwiLCBcIlwiLFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgY29uc3QgdmlzaWJpbGl0eSA9IHZpc2liaWxpdHlFdmVudCAmJiB2aXNpYmlsaXR5RXZlbnQuZ2V0Q29udGVudCgpICYmXG4gICAgICAgICAgICAgICAgICAgIHZpc2liaWxpdHlFdmVudC5nZXRDb250ZW50KCkuaGlzdG9yeV92aXNpYmlsaXR5O1xuICAgICAgICAgICAgICAgIGlmICh2aXNpYmlsaXR5ID09IFwid29ybGRfcmVhZGFibGVcIiB8fCB2aXNpYmlsaXR5ID09IFwic2hhcmVkXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW52aXRlZFVzZXJzID0gW107XG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgW2FkZHIsIHN0YXRlXSBvZiBPYmplY3QuZW50cmllcyhyZXN1bHQuc3RhdGVzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlID09PSBcImludml0ZWRcIiAmJiBnZXRBZGRyZXNzVHlwZShhZGRyKSA9PT0gXCJteC11c2VyLWlkXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnZpdGVkVXNlcnMucHVzaChhZGRyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsb2dnZXIubG9nKFwiU2hhcmluZyBoaXN0b3J5IHdpdGhcIiwgaW52aXRlZFVzZXJzKTtcbiAgICAgICAgICAgICAgICAgICAgY2xpLnNlbmRTaGFyZWRIaXN0b3J5S2V5cyhcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMucm9vbUlkLCBpbnZpdGVkVXNlcnMsXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihlcnIpO1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgYnVzeTogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3JUZXh0OiBfdChcbiAgICAgICAgICAgICAgICAgICAgXCJXZSBjb3VsZG4ndCBpbnZpdGUgdGhvc2UgdXNlcnMuIFBsZWFzZSBjaGVjayB0aGUgdXNlcnMgeW91IHdhbnQgdG8gaW52aXRlIGFuZCB0cnkgYWdhaW4uXCIsXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHByaXZhdGUgdHJhbnNmZXJDYWxsID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5jdXJyZW50VGFiSWQgPT0gVGFiSWQuVXNlckRpcmVjdG9yeSkge1xuICAgICAgICAgICAgdGhpcy5jb252ZXJ0RmlsdGVyKCk7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXRzID0gdGhpcy5jb252ZXJ0RmlsdGVyKCk7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXRJZHMgPSB0YXJnZXRzLm1hcCh0ID0+IHQudXNlcklkKTtcbiAgICAgICAgICAgIGlmICh0YXJnZXRJZHMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICBlcnJvclRleHQ6IF90KFwiQSBjYWxsIGNhbiBvbmx5IGJlIHRyYW5zZmVycmVkIHRvIGEgc2luZ2xlIHVzZXIuXCIpLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZGlzLmRpc3BhdGNoKHtcbiAgICAgICAgICAgICAgICBhY3Rpb246IEFjdGlvbi5UcmFuc2ZlckNhbGxUb01hdHJpeElELFxuICAgICAgICAgICAgICAgIGNhbGw6IHRoaXMucHJvcHMuY2FsbCxcbiAgICAgICAgICAgICAgICBkZXN0aW5hdGlvbjogdGFyZ2V0SWRzWzBdLFxuICAgICAgICAgICAgICAgIGNvbnN1bHRGaXJzdDogdGhpcy5zdGF0ZS5jb25zdWx0Rmlyc3QsXG4gICAgICAgICAgICB9IGFzIFRyYW5zZmVyQ2FsbFBheWxvYWQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGlzLmRpc3BhdGNoKHtcbiAgICAgICAgICAgICAgICBhY3Rpb246IEFjdGlvbi5UcmFuc2ZlckNhbGxUb1Bob25lTnVtYmVyLFxuICAgICAgICAgICAgICAgIGNhbGw6IHRoaXMucHJvcHMuY2FsbCxcbiAgICAgICAgICAgICAgICBkZXN0aW5hdGlvbjogdGhpcy5zdGF0ZS5kaWFsUGFkVmFsdWUsXG4gICAgICAgICAgICAgICAgY29uc3VsdEZpcnN0OiB0aGlzLnN0YXRlLmNvbnN1bHRGaXJzdCxcbiAgICAgICAgICAgIH0gYXMgVHJhbnNmZXJDYWxsUGF5bG9hZCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcm9wcy5vbkZpbmlzaGVkKCk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25LZXlEb3duID0gKGUpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuYnVzeSkgcmV0dXJuO1xuICAgICAgICBjb25zdCB2YWx1ZSA9IGUudGFyZ2V0LnZhbHVlLnRyaW0oKTtcbiAgICAgICAgY29uc3QgaGFzTW9kaWZpZXJzID0gZS5jdHJsS2V5IHx8IGUuc2hpZnRLZXkgfHwgZS5tZXRhS2V5O1xuICAgICAgICBpZiAoIXZhbHVlICYmIHRoaXMuc3RhdGUudGFyZ2V0cy5sZW5ndGggPiAwICYmIGUua2V5ID09PSBLZXkuQkFDS1NQQUNFICYmICFoYXNNb2RpZmllcnMpIHtcbiAgICAgICAgICAgIC8vIHdoZW4gdGhlIGZpZWxkIGlzIGVtcHR5IGFuZCB0aGUgdXNlciBoaXRzIGJhY2tzcGFjZSByZW1vdmUgdGhlIHJpZ2h0LW1vc3QgdGFyZ2V0XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZU1lbWJlcih0aGlzLnN0YXRlLnRhcmdldHNbdGhpcy5zdGF0ZS50YXJnZXRzLmxlbmd0aCAtIDFdKTtcbiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSAmJiBlLmtleSA9PT0gS2V5LkVOVEVSICYmICFoYXNNb2RpZmllcnMpIHtcbiAgICAgICAgICAgIC8vIHdoZW4gdGhlIHVzZXIgaGl0cyBlbnRlciB3aXRoIHNvbWV0aGluZyBpbiB0aGVpciBmaWVsZCB0cnkgdG8gY29udmVydCBpdFxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5jb252ZXJ0RmlsdGVyKCk7XG4gICAgICAgIH0gZWxzZSBpZiAodmFsdWUgJiYgZS5rZXkgPT09IEtleS5TUEFDRSAmJiAhaGFzTW9kaWZpZXJzICYmIHZhbHVlLmluY2x1ZGVzKFwiQFwiKSAmJiAhdmFsdWUuaW5jbHVkZXMoXCIgXCIpKSB7XG4gICAgICAgICAgICAvLyB3aGVuIHRoZSB1c2VyIGhpdHMgc3BhY2UgYW5kIHRoZWlyIGlucHV0IGxvb2tzIGxpa2UgYW4gZS1tYWlsL01YSUQgdGhlbiB0cnkgdG8gY29udmVydCBpdFxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5jb252ZXJ0RmlsdGVyKCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkNhbmNlbCA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5wcm9wcy5vbkZpbmlzaGVkKFtdKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSB1cGRhdGVTdWdnZXN0aW9ucyA9IGFzeW5jICh0ZXJtKSA9PiB7XG4gICAgICAgIE1hdHJpeENsaWVudFBlZy5nZXQoKS5zZWFyY2hVc2VyRGlyZWN0b3J5KHsgdGVybSB9KS50aGVuKGFzeW5jIHIgPT4ge1xuICAgICAgICAgICAgaWYgKHRlcm0gIT09IHRoaXMuc3RhdGUuZmlsdGVyVGV4dCkge1xuICAgICAgICAgICAgICAgIC8vIERpc2NhcmQgdGhlIHJlc3VsdHMgLSB3ZSB3ZXJlIHByb2JhYmx5IHRvbyBzbG93IG9uIHRoZSBzZXJ2ZXItc2lkZSB0byBtYWtlXG4gICAgICAgICAgICAgICAgLy8gdGhlc2UgcmVzdWx0cyB1c2VmdWwuIFRoaXMgaXMgYSByYWNlIHdlIHdhbnQgdG8gYXZvaWQgYmVjYXVzZSB3ZSBjb3VsZCBvdmVyd3JpdGVcbiAgICAgICAgICAgICAgICAvLyBtb3JlIGFjY3VyYXRlIHJlc3VsdHMuXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIXIucmVzdWx0cykgci5yZXN1bHRzID0gW107XG5cbiAgICAgICAgICAgIC8vIFdoaWxlIHdlJ3JlIGhlcmUsIHRyeSBhbmQgYXV0b2NvbXBsZXRlIGEgc2VhcmNoIHJlc3VsdCBmb3IgdGhlIG14aWQgaXRzZWxmXG4gICAgICAgICAgICAvLyBpZiB0aGVyZSdzIG5vIG1hdGNoZXMgKGFuZCB0aGUgaW5wdXQgbG9va3MgbGlrZSBhIG14aWQpLlxuICAgICAgICAgICAgaWYgKHRlcm1bMF0gPT09ICdAJyAmJiB0ZXJtLmluZGV4T2YoJzonKSA+IDEpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9maWxlID0gYXdhaXQgTWF0cml4Q2xpZW50UGVnLmdldCgpLmdldFByb2ZpbGVJbmZvKHRlcm0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJvZmlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgd2UgaGF2ZSBhIHByb2ZpbGUsIHdlIGhhdmUgZW5vdWdoIGluZm9ybWF0aW9uIHRvIGFzc3VtZSB0aGF0XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgbXhpZCBjYW4gYmUgaW52aXRlZCAtIGFkZCBpdCB0byB0aGUgbGlzdC4gV2Ugc3RpY2sgaXQgYXQgdGhlXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0b3Agc28gaXQgaXMgbW9zdCBvYnZpb3VzbHkgcHJlc2VudGVkIHRvIHRoZSB1c2VyLlxuICAgICAgICAgICAgICAgICAgICAgICAgci5yZXN1bHRzLnNwbGljZSgwLCAwLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcl9pZDogdGVybSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5X25hbWU6IHByb2ZpbGVbJ2Rpc3BsYXluYW1lJ10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXZhdGFyX3VybDogcHJvZmlsZVsnYXZhdGFyX3VybCddLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuKFwiTm9uLWZhdGFsIGVycm9yIHRyeWluZyB0byBtYWtlIGFuIGludml0ZSBmb3IgYSB1c2VyIElEXCIpO1xuICAgICAgICAgICAgICAgICAgICBsb2dnZXIud2FybihlKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBBZGQgYSByZXN1bHQgYW55d2F5cywganVzdCB3aXRob3V0IGEgcHJvZmlsZS4gV2Ugc3RpY2sgaXQgYXQgdGhlXG4gICAgICAgICAgICAgICAgICAgIC8vIHRvcCBzbyBpdCBpcyBtb3N0IG9idmlvdXNseSBwcmVzZW50ZWQgdG8gdGhlIHVzZXIuXG4gICAgICAgICAgICAgICAgICAgIHIucmVzdWx0cy5zcGxpY2UoMCwgMCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcl9pZDogdGVybSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlfbmFtZTogdGVybSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF2YXRhcl91cmw6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgc2VydmVyUmVzdWx0c01peGluOiByLnJlc3VsdHMubWFwKHUgPT4gKHtcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiB1LnVzZXJfaWQsXG4gICAgICAgICAgICAgICAgICAgIHVzZXI6IG5ldyBEaXJlY3RvcnlNZW1iZXIodSksXG4gICAgICAgICAgICAgICAgfSkpLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pLmNhdGNoKGUgPT4ge1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKFwiRXJyb3Igc2VhcmNoaW5nIHVzZXIgZGlyZWN0b3J5OlwiKTtcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihlKTtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBzZXJ2ZXJSZXN1bHRzTWl4aW46IFtdIH0pOyAvLyBjbGVhciByZXN1bHRzIGJlY2F1c2UgaXQncyBtb2RlcmF0ZWx5IGZhdGFsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFdoZW5ldmVyIHdlIHNlYXJjaCB0aGUgZGlyZWN0b3J5LCBhbHNvIHRyeSB0byBzZWFyY2ggdGhlIGlkZW50aXR5IHNlcnZlci4gSXQnc1xuICAgICAgICAvLyBhbGwgZGVib3VuY2VkIHRoZSBzYW1lIGFueXdheXMuXG4gICAgICAgIGlmICghdGhpcy5zdGF0ZS5jYW5Vc2VJZGVudGl0eVNlcnZlcikge1xuICAgICAgICAgICAgLy8gVGhlIHVzZXIgZG9lc24ndCBoYXZlIGFuIGlkZW50aXR5IHNlcnZlciBzZXQgLSB3YXJuIHRoZW0gb2YgdGhhdC5cbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyB0cnlpbmdJZGVudGl0eVNlcnZlcjogdHJ1ZSB9KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGVybS5pbmRleE9mKCdAJykgPiAwICYmIEVtYWlsLmxvb2tzVmFsaWQodGVybSkgJiYgU2V0dGluZ3NTdG9yZS5nZXRWYWx1ZShVSUZlYXR1cmUuSWRlbnRpdHlTZXJ2ZXIpKSB7XG4gICAgICAgICAgICAvLyBTdGFydCBvZmYgYnkgc3VnZ2VzdGluZyB0aGUgcGxhaW4gZW1haWwgd2hpbGUgd2UgdHJ5IGFuZCByZXNvbHZlIGl0XG4gICAgICAgICAgICAvLyB0byBhIHJlYWwgYWNjb3VudC5cbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgIC8vIHBlciBhYm92ZTogdGhlIHVzZXJJZCBpcyBhIGxpZSBoZXJlIC0gaXQncyBqdXN0IGEgcmVndWxhciBpZGVudGlmaWVyXG4gICAgICAgICAgICAgICAgdGhyZWVwaWRSZXN1bHRzTWl4aW46IFt7IHVzZXI6IG5ldyBUaHJlZXBpZE1lbWJlcih0ZXJtKSwgdXNlcklkOiB0ZXJtIH1dLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGF1dGhDbGllbnQgPSBuZXcgSWRlbnRpdHlBdXRoQ2xpZW50KCk7XG4gICAgICAgICAgICAgICAgY29uc3QgdG9rZW4gPSBhd2FpdCBhdXRoQ2xpZW50LmdldEFjY2Vzc1Rva2VuKCk7XG4gICAgICAgICAgICAgICAgaWYgKHRlcm0gIT09IHRoaXMuc3RhdGUuZmlsdGVyVGV4dCkgcmV0dXJuOyAvLyBhYmFuZG9uIGhvcGVcblxuICAgICAgICAgICAgICAgIGNvbnN0IGxvb2t1cCA9IGF3YWl0IE1hdHJpeENsaWVudFBlZy5nZXQoKS5sb29rdXBUaHJlZVBpZChcbiAgICAgICAgICAgICAgICAgICAgJ2VtYWlsJyxcbiAgICAgICAgICAgICAgICAgICAgdGVybSxcbiAgICAgICAgICAgICAgICAgICAgdW5kZWZpbmVkLCAvLyBjYWxsYmFja1xuICAgICAgICAgICAgICAgICAgICB0b2tlbixcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGlmICh0ZXJtICE9PSB0aGlzLnN0YXRlLmZpbHRlclRleHQpIHJldHVybjsgLy8gYWJhbmRvbiBob3BlXG5cbiAgICAgICAgICAgICAgICBpZiAoIWxvb2t1cCB8fCAhbG9va3VwLm14aWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gV2Ugd2VyZW4ndCBhYmxlIHRvIGZpbmQgYW55b25lIC0gd2UncmUgYWxyZWFkeSBzdWdnZXN0aW5nIHRoZSBwbGFpbiBlbWFpbFxuICAgICAgICAgICAgICAgICAgICAvLyBhcyBhbiBhbHRlcm5hdGl2ZSwgc28gZG8gbm90aGluZy5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFdlIGFwcGVuZCB0aGUgdXNlciBzdWdnZXN0aW9uIHRvIGdpdmUgdGhlIHVzZXIgYW4gb3B0aW9uIHRvIGNsaWNrXG4gICAgICAgICAgICAgICAgLy8gdGhlIGVtYWlsIGFueXdheXMsIGFuZCBzbyB3ZSBkb24ndCBjYXVzZSB0aGluZ3MgdG8ganVtcCBhcm91bmQuIEluXG4gICAgICAgICAgICAgICAgLy8gdGhlb3J5LCB0aGUgdXNlciB3b3VsZCBzZWUgdGhlIHVzZXIgcG9wIHVwIGFuZCB0aGluayBcImFoIHllcywgdGhhdFxuICAgICAgICAgICAgICAgIC8vIHBlcnNvbiFcIlxuICAgICAgICAgICAgICAgIGNvbnN0IHByb2ZpbGUgPSBhd2FpdCBNYXRyaXhDbGllbnRQZWcuZ2V0KCkuZ2V0UHJvZmlsZUluZm8obG9va3VwLm14aWQpO1xuICAgICAgICAgICAgICAgIGlmICh0ZXJtICE9PSB0aGlzLnN0YXRlLmZpbHRlclRleHQgfHwgIXByb2ZpbGUpIHJldHVybjsgLy8gYWJhbmRvbiBob3BlXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIHRocmVlcGlkUmVzdWx0c01peGluOiBbLi4udGhpcy5zdGF0ZS50aHJlZXBpZFJlc3VsdHNNaXhpbiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcjogbmV3IERpcmVjdG9yeU1lbWJlcih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcl9pZDogbG9va3VwLm14aWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheV9uYW1lOiBwcm9maWxlLmRpc3BsYXluYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF2YXRhcl91cmw6IHByb2ZpbGUuYXZhdGFyX3VybCxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBsb29rdXAubXhpZCxcbiAgICAgICAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKFwiRXJyb3Igc2VhcmNoaW5nIGlkZW50aXR5IHNlcnZlcjpcIik7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGUpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyB0aHJlZXBpZFJlc3VsdHNNaXhpbjogW10gfSk7IC8vIGNsZWFyIHJlc3VsdHMgYmVjYXVzZSBpdCdzIG1vZGVyYXRlbHkgZmF0YWxcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwcml2YXRlIHVwZGF0ZUZpbHRlciA9IChlKSA9PiB7XG4gICAgICAgIGNvbnN0IHRlcm0gPSBlLnRhcmdldC52YWx1ZTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGZpbHRlclRleHQ6IHRlcm0gfSk7XG5cbiAgICAgICAgLy8gRGVib3VuY2Ugc2VydmVyIGxvb2t1cHMgdG8gcmVkdWNlIHNwYW0uIFdlIGRvbid0IGNsZWFyIHRoZSBleGlzdGluZyBzZXJ2ZXJcbiAgICAgICAgLy8gcmVzdWx0cyBiZWNhdXNlIHRoZXkgbWlnaHQgc3RpbGwgYmUgdmFndWVseSBhY2N1cmF0ZSwgbGlrZXdpc2UgZm9yIHJhY2VzIHdoaWNoXG4gICAgICAgIC8vIGNvdWxkIGhhcHBlbiBoZXJlLlxuICAgICAgICBpZiAodGhpcy5kZWJvdW5jZVRpbWVyKSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5kZWJvdW5jZVRpbWVyKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRlYm91bmNlVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3VnZ2VzdGlvbnModGVybSk7XG4gICAgICAgIH0sIDE1MCk7IC8vIDE1MG1zIGRlYm91bmNlIChodW1hbiByZWFjdGlvbiB0aW1lICsgc29tZSlcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBzaG93TW9yZVJlY2VudHMgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBudW1SZWNlbnRzU2hvd246IHRoaXMuc3RhdGUubnVtUmVjZW50c1Nob3duICsgSU5DUkVNRU5UX1JPT01TX1NIT1dOIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIHNob3dNb3JlU3VnZ2VzdGlvbnMgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBudW1TdWdnZXN0aW9uc1Nob3duOiB0aGlzLnN0YXRlLm51bVN1Z2dlc3Rpb25zU2hvd24gKyBJTkNSRU1FTlRfUk9PTVNfU0hPV04gfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgdG9nZ2xlTWVtYmVyID0gKG1lbWJlcjogTWVtYmVyKSA9PiB7XG4gICAgICAgIGlmICghdGhpcy5zdGF0ZS5idXN5KSB7XG4gICAgICAgICAgICBsZXQgZmlsdGVyVGV4dCA9IHRoaXMuc3RhdGUuZmlsdGVyVGV4dDtcbiAgICAgICAgICAgIGxldCB0YXJnZXRzID0gdGhpcy5zdGF0ZS50YXJnZXRzLm1hcCh0ID0+IHQpOyAvLyBjaGVhcCBjbG9uZSBmb3IgbXV0YXRpb25cbiAgICAgICAgICAgIGNvbnN0IGlkeCA9IHRhcmdldHMuaW5kZXhPZihtZW1iZXIpO1xuICAgICAgICAgICAgaWYgKGlkeCA+PSAwKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0cy5zcGxpY2UoaWR4LCAxKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMua2luZCA9PT0gS0lORF9DQUxMX1RSQU5TRkVSICYmIHRhcmdldHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRzID0gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRhcmdldHMucHVzaChtZW1iZXIpO1xuICAgICAgICAgICAgICAgIGZpbHRlclRleHQgPSBcIlwiOyAvLyBjbGVhciB0aGUgZmlsdGVyIHdoZW4gdGhlIHVzZXIgYWNjZXB0cyBhIHN1Z2dlc3Rpb25cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyB0YXJnZXRzLCBmaWx0ZXJUZXh0IH0pO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5lZGl0b3JSZWYgJiYgdGhpcy5lZGl0b3JSZWYuY3VycmVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yUmVmLmN1cnJlbnQuZm9jdXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwcml2YXRlIHJlbW92ZU1lbWJlciA9IChtZW1iZXI6IE1lbWJlcikgPT4ge1xuICAgICAgICBjb25zdCB0YXJnZXRzID0gdGhpcy5zdGF0ZS50YXJnZXRzLm1hcCh0ID0+IHQpOyAvLyBjaGVhcCBjbG9uZSBmb3IgbXV0YXRpb25cbiAgICAgICAgY29uc3QgaWR4ID0gdGFyZ2V0cy5pbmRleE9mKG1lbWJlcik7XG4gICAgICAgIGlmIChpZHggPj0gMCkge1xuICAgICAgICAgICAgdGFyZ2V0cy5zcGxpY2UoaWR4LCAxKTtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyB0YXJnZXRzIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuZWRpdG9yUmVmICYmIHRoaXMuZWRpdG9yUmVmLmN1cnJlbnQpIHtcbiAgICAgICAgICAgIHRoaXMuZWRpdG9yUmVmLmN1cnJlbnQuZm9jdXMoKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwcml2YXRlIG9uUGFzdGUgPSBhc3luYyAoZSkgPT4ge1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5maWx0ZXJUZXh0KSB7XG4gICAgICAgICAgICAvLyBpZiB0aGUgdXNlciBoYXMgYWxyZWFkeSB0eXBlZCBzb21ldGhpbmcsIGp1c3QgbGV0IHRoZW1cbiAgICAgICAgICAgIC8vIHBhc3RlIG5vcm1hbGx5LlxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUHJldmVudCB0aGUgdGV4dCBiZWluZyBwYXN0ZWQgaW50byB0aGUgaW5wdXRcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIC8vIFByb2Nlc3MgaXQgYXMgYSBsaXN0IG9mIGFkZHJlc3NlcyB0byBhZGQgaW5zdGVhZFxuICAgICAgICBjb25zdCB0ZXh0ID0gZS5jbGlwYm9hcmREYXRhLmdldERhdGEoXCJ0ZXh0XCIpO1xuICAgICAgICBjb25zdCBwb3NzaWJsZU1lbWJlcnMgPSBbXG4gICAgICAgICAgICAvLyBJZiB3ZSBjYW4gYXZvaWQgaGl0dGluZyB0aGUgcHJvZmlsZSBlbmRwb2ludCwgd2Ugc2hvdWxkLlxuICAgICAgICAgICAgLi4udGhpcy5zdGF0ZS5yZWNlbnRzLFxuICAgICAgICAgICAgLi4udGhpcy5zdGF0ZS5zdWdnZXN0aW9ucyxcbiAgICAgICAgICAgIC4uLnRoaXMuc3RhdGUuc2VydmVyUmVzdWx0c01peGluLFxuICAgICAgICAgICAgLi4udGhpcy5zdGF0ZS50aHJlZXBpZFJlc3VsdHNNaXhpbixcbiAgICAgICAgXTtcbiAgICAgICAgY29uc3QgdG9BZGQgPSBbXTtcbiAgICAgICAgY29uc3QgZmFpbGVkID0gW107XG4gICAgICAgIGNvbnN0IHBvdGVudGlhbEFkZHJlc3NlcyA9IHRleHQuc3BsaXQoL1tcXHMsXSsvKS5tYXAocCA9PiBwLnRyaW0oKSkuZmlsdGVyKHAgPT4gISFwKTsgLy8gZmlsdGVyIGVtcHR5IHN0cmluZ3NcbiAgICAgICAgZm9yIChjb25zdCBhZGRyZXNzIG9mIHBvdGVudGlhbEFkZHJlc3Nlcykge1xuICAgICAgICAgICAgY29uc3QgbWVtYmVyID0gcG9zc2libGVNZW1iZXJzLmZpbmQobSA9PiBtLnVzZXJJZCA9PT0gYWRkcmVzcyk7XG4gICAgICAgICAgICBpZiAobWVtYmVyKSB7XG4gICAgICAgICAgICAgICAgdG9BZGQucHVzaChtZW1iZXIudXNlcik7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChhZGRyZXNzLmluZGV4T2YoJ0AnKSA+IDAgJiYgRW1haWwubG9va3NWYWxpZChhZGRyZXNzKSkge1xuICAgICAgICAgICAgICAgIHRvQWRkLnB1c2gobmV3IFRocmVlcGlkTWVtYmVyKGFkZHJlc3MpKTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGFkZHJlc3NbMF0gIT09ICdAJykge1xuICAgICAgICAgICAgICAgIGZhaWxlZC5wdXNoKGFkZHJlc3MpOyAvLyBub3QgYSB1c2VyIElEXG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcHJvZmlsZSA9IGF3YWl0IE1hdHJpeENsaWVudFBlZy5nZXQoKS5nZXRQcm9maWxlSW5mbyhhZGRyZXNzKTtcbiAgICAgICAgICAgICAgICBjb25zdCBkaXNwbGF5TmFtZSA9IHByb2ZpbGUgPyBwcm9maWxlLmRpc3BsYXluYW1lIDogbnVsbDtcbiAgICAgICAgICAgICAgICBjb25zdCBhdmF0YXJVcmwgPSBwcm9maWxlID8gcHJvZmlsZS5hdmF0YXJfdXJsIDogbnVsbDtcbiAgICAgICAgICAgICAgICB0b0FkZC5wdXNoKG5ldyBEaXJlY3RvcnlNZW1iZXIoe1xuICAgICAgICAgICAgICAgICAgICB1c2VyX2lkOiBhZGRyZXNzLFxuICAgICAgICAgICAgICAgICAgICBkaXNwbGF5X25hbWU6IGRpc3BsYXlOYW1lLFxuICAgICAgICAgICAgICAgICAgICBhdmF0YXJfdXJsOiBhdmF0YXJVcmwsXG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihcIkVycm9yIGxvb2tpbmcgdXAgcHJvZmlsZSBmb3IgXCIgKyBhZGRyZXNzKTtcbiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoZSk7XG4gICAgICAgICAgICAgICAgZmFpbGVkLnB1c2goYWRkcmVzcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudW5tb3VudGVkKSByZXR1cm47XG5cbiAgICAgICAgaWYgKGZhaWxlZC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBNb2RhbC5jcmVhdGVUcmFja2VkRGlhbG9nKCdJbnZpdGUgUGFzdGUgRmFpbCcsICcnLCBRdWVzdGlvbkRpYWxvZywge1xuICAgICAgICAgICAgICAgIHRpdGxlOiBfdCgnRmFpbGVkIHRvIGZpbmQgdGhlIGZvbGxvd2luZyB1c2VycycpLFxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBfdChcbiAgICAgICAgICAgICAgICAgICAgXCJUaGUgZm9sbG93aW5nIHVzZXJzIG1pZ2h0IG5vdCBleGlzdCBvciBhcmUgaW52YWxpZCwgYW5kIGNhbm5vdCBiZSBpbnZpdGVkOiAlKGNzdk5hbWVzKXNcIixcbiAgICAgICAgICAgICAgICAgICAgeyBjc3ZOYW1lczogZmFpbGVkLmpvaW4oXCIsIFwiKSB9LFxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgYnV0dG9uOiBfdCgnT0snKSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHRhcmdldHM6IFsuLi50aGlzLnN0YXRlLnRhcmdldHMsIC4uLnRvQWRkXSB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkNsaWNrSW5wdXRBcmVhID0gKGUpID0+IHtcbiAgICAgICAgLy8gU3RvcCB0aGUgYnJvd3NlciBmcm9tIGhpZ2hsaWdodGluZyB0ZXh0XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgICBpZiAodGhpcy5lZGl0b3JSZWYgJiYgdGhpcy5lZGl0b3JSZWYuY3VycmVudCkge1xuICAgICAgICAgICAgdGhpcy5lZGl0b3JSZWYuY3VycmVudC5mb2N1cygpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25Vc2VEZWZhdWx0SWRlbnRpdHlTZXJ2ZXJDbGljayA9IChlKSA9PiB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAvLyBVcGRhdGUgdGhlIElTIGluIGFjY291bnQgZGF0YS4gQWN0dWFsbHkgdXNpbmcgaXQgbWF5IHRyaWdnZXIgdGVybXMuXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9ydWxlcy1vZi1ob29rc1xuICAgICAgICB1c2VEZWZhdWx0SWRlbnRpdHlTZXJ2ZXIoKTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGNhblVzZUlkZW50aXR5U2VydmVyOiB0cnVlLCB0cnlpbmdJZGVudGl0eVNlcnZlcjogZmFsc2UgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25NYW5hZ2VTZXR0aW5nc0NsaWNrID0gKGUpID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBkaXMuZmlyZShBY3Rpb24uVmlld1VzZXJTZXR0aW5ncyk7XG4gICAgICAgIHRoaXMucHJvcHMub25GaW5pc2hlZCgpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uQ29tbXVuaXR5SW52aXRlQ2xpY2sgPSAoZSkgPT4ge1xuICAgICAgICB0aGlzLnByb3BzLm9uRmluaXNoZWQoKTtcbiAgICAgICAgc2hvd0NvbW11bml0eUludml0ZURpYWxvZyhDb21tdW5pdHlQcm90b3R5cGVTdG9yZS5pbnN0YW5jZS5nZXRTZWxlY3RlZENvbW11bml0eUlkKCkpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIHJlbmRlclNlY3Rpb24oa2luZDogXCJyZWNlbnRzXCJ8XCJzdWdnZXN0aW9uc1wiKSB7XG4gICAgICAgIGxldCBzb3VyY2VNZW1iZXJzID0ga2luZCA9PT0gJ3JlY2VudHMnID8gdGhpcy5zdGF0ZS5yZWNlbnRzIDogdGhpcy5zdGF0ZS5zdWdnZXN0aW9ucztcbiAgICAgICAgbGV0IHNob3dOdW0gPSBraW5kID09PSAncmVjZW50cycgPyB0aGlzLnN0YXRlLm51bVJlY2VudHNTaG93biA6IHRoaXMuc3RhdGUubnVtU3VnZ2VzdGlvbnNTaG93bjtcbiAgICAgICAgY29uc3Qgc2hvd01vcmVGbiA9IGtpbmQgPT09ICdyZWNlbnRzJyA/IHRoaXMuc2hvd01vcmVSZWNlbnRzLmJpbmQodGhpcykgOiB0aGlzLnNob3dNb3JlU3VnZ2VzdGlvbnMuYmluZCh0aGlzKTtcbiAgICAgICAgY29uc3QgbGFzdEFjdGl2ZSA9IChtKSA9PiBraW5kID09PSAncmVjZW50cycgPyBtLmxhc3RBY3RpdmUgOiBudWxsO1xuICAgICAgICBsZXQgc2VjdGlvbk5hbWUgPSBraW5kID09PSAncmVjZW50cycgPyBfdChcIlJlY2VudCBDb252ZXJzYXRpb25zXCIpIDogX3QoXCJTdWdnZXN0aW9uc1wiKTtcbiAgICAgICAgbGV0IHNlY3Rpb25TdWJuYW1lID0gbnVsbDtcblxuICAgICAgICBpZiAoa2luZCA9PT0gJ3N1Z2dlc3Rpb25zJyAmJiBDb21tdW5pdHlQcm90b3R5cGVTdG9yZS5pbnN0YW5jZS5nZXRTZWxlY3RlZENvbW11bml0eUlkKCkpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbW11bml0eU5hbWUgPSBDb21tdW5pdHlQcm90b3R5cGVTdG9yZS5pbnN0YW5jZS5nZXRTZWxlY3RlZENvbW11bml0eU5hbWUoKTtcbiAgICAgICAgICAgIHNlY3Rpb25TdWJuYW1lID0gX3QoXCJNYXkgaW5jbHVkZSBtZW1iZXJzIG5vdCBpbiAlKGNvbW11bml0eU5hbWUpc1wiLCB7IGNvbW11bml0eU5hbWUgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5wcm9wcy5raW5kID09PSBLSU5EX0lOVklURSkge1xuICAgICAgICAgICAgc2VjdGlvbk5hbWUgPSBraW5kID09PSAncmVjZW50cycgPyBfdChcIlJlY2VudGx5IERpcmVjdCBNZXNzYWdlZFwiKSA6IF90KFwiU3VnZ2VzdGlvbnNcIik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBNaXggaW4gdGhlIHNlcnZlciByZXN1bHRzIGlmIHdlIGhhdmUgYW55LCBidXQgb25seSBpZiB3ZSdyZSBzZWFyY2hpbmcuIFdlIHRyYWNrIHRoZSBhZGRpdGlvbmFsXG4gICAgICAgIC8vIG1lbWJlcnMgc2VwYXJhdGVseSBiZWNhdXNlIHdlIHdhbnQgdG8gZmlsdGVyIHNvdXJjZU1lbWJlcnMgYnV0IHRydXN0IHRoZSBtaXhpbiBhcnJheXMgdG8gaGF2ZVxuICAgICAgICAvLyB0aGUgcmlnaHQgbWVtYmVycyBpbiB0aGVtLlxuICAgICAgICBsZXQgcHJpb3JpdHlBZGRpdGlvbmFsTWVtYmVycyA9IFtdOyAvLyBTaG93cyB1cCBiZWZvcmUgb3VyIG93biBzdWdnZXN0aW9ucywgaGlnaGVyIHF1YWxpdHlcbiAgICAgICAgbGV0IG90aGVyQWRkaXRpb25hbE1lbWJlcnMgPSBbXTsgLy8gU2hvd3MgdXAgYWZ0ZXIgb3VyIG93biBzdWdnZXN0aW9ucywgbG93ZXIgcXVhbGl0eVxuICAgICAgICBjb25zdCBoYXNNaXhpbnMgPSB0aGlzLnN0YXRlLnNlcnZlclJlc3VsdHNNaXhpbiB8fCB0aGlzLnN0YXRlLnRocmVlcGlkUmVzdWx0c01peGluO1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5maWx0ZXJUZXh0ICYmIGhhc01peGlucyAmJiBraW5kID09PSAnc3VnZ2VzdGlvbnMnKSB7XG4gICAgICAgICAgICAvLyBXZSBkb24ndCB3YW50IHRvIGR1cGxpY2F0ZSBtZW1iZXJzIHRob3VnaCwgc28ganVzdCBleGNsdWRlIGFueW9uZSB3ZSd2ZSBhbHJlYWR5IHNlZW4uXG4gICAgICAgICAgICAvLyBUaGUgdHlwZSBvZiB1IGlzIGEgcGFpbiB0byBkZWZpbmUgYnV0IG1lbWJlcnMgb2YgYm90aCBtaXhpbnMgaGF2ZSB0aGUgJ3VzZXJJZCcgcHJvcGVydHlcbiAgICAgICAgICAgIGNvbnN0IG5vdEFscmVhZHlFeGlzdHMgPSAodTogYW55KTogYm9vbGVhbiA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICFzb3VyY2VNZW1iZXJzLnNvbWUobSA9PiBtLnVzZXJJZCA9PT0gdS51c2VySWQpXG4gICAgICAgICAgICAgICAgICAgICYmICFwcmlvcml0eUFkZGl0aW9uYWxNZW1iZXJzLnNvbWUobSA9PiBtLnVzZXJJZCA9PT0gdS51c2VySWQpXG4gICAgICAgICAgICAgICAgICAgICYmICFvdGhlckFkZGl0aW9uYWxNZW1iZXJzLnNvbWUobSA9PiBtLnVzZXJJZCA9PT0gdS51c2VySWQpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgb3RoZXJBZGRpdGlvbmFsTWVtYmVycyA9IHRoaXMuc3RhdGUuc2VydmVyUmVzdWx0c01peGluLmZpbHRlcihub3RBbHJlYWR5RXhpc3RzKTtcbiAgICAgICAgICAgIHByaW9yaXR5QWRkaXRpb25hbE1lbWJlcnMgPSB0aGlzLnN0YXRlLnRocmVlcGlkUmVzdWx0c01peGluLmZpbHRlcihub3RBbHJlYWR5RXhpc3RzKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBoYXNBZGRpdGlvbmFsTWVtYmVycyA9IHByaW9yaXR5QWRkaXRpb25hbE1lbWJlcnMubGVuZ3RoID4gMCB8fCBvdGhlckFkZGl0aW9uYWxNZW1iZXJzLmxlbmd0aCA+IDA7XG5cbiAgICAgICAgLy8gSGlkZSB0aGUgc2VjdGlvbiBpZiB0aGVyZSdzIG5vdGhpbmcgdG8gZmlsdGVyIGJ5XG4gICAgICAgIGlmIChzb3VyY2VNZW1iZXJzLmxlbmd0aCA9PT0gMCAmJiAhaGFzQWRkaXRpb25hbE1lbWJlcnMpIHJldHVybiBudWxsO1xuXG4gICAgICAgIC8vIERvIHNvbWUgc2ltcGxlIGZpbHRlcmluZyBvbiB0aGUgaW5wdXQgYmVmb3JlIGdvaW5nIG11Y2ggZnVydGhlci4gSWYgd2UgZ2V0IG5vIHJlc3VsdHMsIHNheSBzby5cbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuZmlsdGVyVGV4dCkge1xuICAgICAgICAgICAgY29uc3QgZmlsdGVyQnkgPSB0aGlzLnN0YXRlLmZpbHRlclRleHQudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIHNvdXJjZU1lbWJlcnMgPSBzb3VyY2VNZW1iZXJzXG4gICAgICAgICAgICAgICAgLmZpbHRlcihtID0+IG0udXNlci5uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoZmlsdGVyQnkpIHx8IG0udXNlcklkLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoZmlsdGVyQnkpKTtcblxuICAgICAgICAgICAgaWYgKHNvdXJjZU1lbWJlcnMubGVuZ3RoID09PSAwICYmICFoYXNBZGRpdGlvbmFsTWVtYmVycykge1xuICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdteF9JbnZpdGVEaWFsb2dfc2VjdGlvbic+XG4gICAgICAgICAgICAgICAgICAgICAgICA8aDM+eyBzZWN0aW9uTmFtZSB9PC9oMz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxwPnsgX3QoXCJObyByZXN1bHRzXCIpIH08L3A+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBOb3cgd2UgbWl4IGluIHRoZSBhZGRpdGlvbmFsIG1lbWJlcnMuIEFnYWluLCB3ZSBwcmVzdW1lIHRoZXNlIGhhdmUgYWxyZWFkeSBiZWVuIGZpbHRlcmVkLiBXZVxuICAgICAgICAvLyBhbHNvIGFzc3VtZSB0aGV5IGFyZSBtb3JlIHJlbGV2YW50IHRoYW4gb3VyIHN1Z2dlc3Rpb25zIGFuZCBwcmVwZW5kIHRoZW0gdG8gdGhlIGxpc3QuXG4gICAgICAgIHNvdXJjZU1lbWJlcnMgPSBbLi4ucHJpb3JpdHlBZGRpdGlvbmFsTWVtYmVycywgLi4uc291cmNlTWVtYmVycywgLi4ub3RoZXJBZGRpdGlvbmFsTWVtYmVyc107XG5cbiAgICAgICAgLy8gSWYgd2UncmUgZ29pbmcgdG8gaGlkZSBvbmUgbWVtYmVyIGJlaGluZCAnc2hvdyBtb3JlJywganVzdCB1c2UgdXAgdGhlIHNwYWNlIG9mIHRoZSBidXR0b25cbiAgICAgICAgLy8gd2l0aCB0aGUgbWVtYmVyJ3MgdGlsZSBpbnN0ZWFkLlxuICAgICAgICBpZiAoc2hvd051bSA9PT0gc291cmNlTWVtYmVycy5sZW5ndGggLSAxKSBzaG93TnVtKys7XG5cbiAgICAgICAgLy8gLnNsaWNlKCkgd2lsbCByZXR1cm4gYW4gaW5jb21wbGV0ZSBhcnJheSBidXQgd29uJ3QgZXJyb3Igb24gdXMgaWYgd2UgZ28gdG9vIGZhclxuICAgICAgICBjb25zdCB0b1JlbmRlciA9IHNvdXJjZU1lbWJlcnMuc2xpY2UoMCwgc2hvd051bSk7XG4gICAgICAgIGNvbnN0IGhhc01vcmUgPSB0b1JlbmRlci5sZW5ndGggPCBzb3VyY2VNZW1iZXJzLmxlbmd0aDtcblxuICAgICAgICBsZXQgc2hvd01vcmUgPSBudWxsO1xuICAgICAgICBpZiAoaGFzTW9yZSkge1xuICAgICAgICAgICAgc2hvd01vcmUgPSAoXG4gICAgICAgICAgICAgICAgPEFjY2Vzc2libGVCdXR0b24gb25DbGljaz17c2hvd01vcmVGbn0ga2luZD1cImxpbmtcIj5cbiAgICAgICAgICAgICAgICAgICAgeyBfdChcIlNob3cgbW9yZVwiKSB9XG4gICAgICAgICAgICAgICAgPC9BY2Nlc3NpYmxlQnV0dG9uPlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHRpbGVzID0gdG9SZW5kZXIubWFwKHIgPT4gKFxuICAgICAgICAgICAgPERNUm9vbVRpbGVcbiAgICAgICAgICAgICAgICBtZW1iZXI9e3IudXNlcn1cbiAgICAgICAgICAgICAgICBsYXN0QWN0aXZlVHM9e2xhc3RBY3RpdmUocil9XG4gICAgICAgICAgICAgICAga2V5PXtyLnVzZXJJZH1cbiAgICAgICAgICAgICAgICBvblRvZ2dsZT17dGhpcy50b2dnbGVNZW1iZXJ9XG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0V29yZD17dGhpcy5zdGF0ZS5maWx0ZXJUZXh0fVxuICAgICAgICAgICAgICAgIGlzU2VsZWN0ZWQ9e3RoaXMuc3RhdGUudGFyZ2V0cy5zb21lKHQgPT4gdC51c2VySWQgPT09IHIudXNlcklkKX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICkpO1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J214X0ludml0ZURpYWxvZ19zZWN0aW9uJz5cbiAgICAgICAgICAgICAgICA8aDM+eyBzZWN0aW9uTmFtZSB9PC9oMz5cbiAgICAgICAgICAgICAgICB7IHNlY3Rpb25TdWJuYW1lID8gPHAgY2xhc3NOYW1lPVwibXhfSW52aXRlRGlhbG9nX3N1Ym5hbWVcIj57IHNlY3Rpb25TdWJuYW1lIH08L3A+IDogbnVsbCB9XG4gICAgICAgICAgICAgICAgeyB0aWxlcyB9XG4gICAgICAgICAgICAgICAgeyBzaG93TW9yZSB9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlbmRlckVkaXRvcigpIHtcbiAgICAgICAgY29uc3QgaGFzUGxhY2Vob2xkZXIgPSAoXG4gICAgICAgICAgICB0aGlzLnByb3BzLmtpbmQgPT0gS0lORF9DQUxMX1RSQU5TRkVSICYmXG4gICAgICAgICAgICB0aGlzLnN0YXRlLnRhcmdldHMubGVuZ3RoID09PSAwICYmXG4gICAgICAgICAgICB0aGlzLnN0YXRlLmZpbHRlclRleHQubGVuZ3RoID09PSAwXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IHRhcmdldHMgPSB0aGlzLnN0YXRlLnRhcmdldHMubWFwKHQgPT4gKFxuICAgICAgICAgICAgPERNVXNlclRpbGUgbWVtYmVyPXt0fSBvblJlbW92ZT17IXRoaXMuc3RhdGUuYnVzeSAmJiB0aGlzLnJlbW92ZU1lbWJlcn0ga2V5PXt0LnVzZXJJZH0gLz5cbiAgICAgICAgKSk7XG4gICAgICAgIGNvbnN0IGlucHV0ID0gKFxuICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICAgICAgICAgIG9uS2V5RG93bj17dGhpcy5vbktleURvd259XG4gICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMudXBkYXRlRmlsdGVyfVxuICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLmZpbHRlclRleHR9XG4gICAgICAgICAgICAgICAgcmVmPXt0aGlzLmVkaXRvclJlZn1cbiAgICAgICAgICAgICAgICBvblBhc3RlPXt0aGlzLm9uUGFzdGV9XG4gICAgICAgICAgICAgICAgYXV0b0ZvY3VzPXt0cnVlfVxuICAgICAgICAgICAgICAgIGRpc2FibGVkPXt0aGlzLnN0YXRlLmJ1c3kgfHwgKHRoaXMucHJvcHMua2luZCA9PSBLSU5EX0NBTExfVFJBTlNGRVIgJiYgdGhpcy5zdGF0ZS50YXJnZXRzLmxlbmd0aCA+IDApfVxuICAgICAgICAgICAgICAgIGF1dG9Db21wbGV0ZT1cIm9mZlwiXG4gICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e2hhc1BsYWNlaG9sZGVyID8gX3QoXCJTZWFyY2hcIikgOiBudWxsfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdteF9JbnZpdGVEaWFsb2dfZWRpdG9yJyBvbkNsaWNrPXt0aGlzLm9uQ2xpY2tJbnB1dEFyZWF9PlxuICAgICAgICAgICAgICAgIHsgdGFyZ2V0cyB9XG4gICAgICAgICAgICAgICAgeyBpbnB1dCB9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlbmRlcklkZW50aXR5U2VydmVyV2FybmluZygpIHtcbiAgICAgICAgaWYgKCF0aGlzLnN0YXRlLnRyeWluZ0lkZW50aXR5U2VydmVyIHx8IHRoaXMuc3RhdGUuY2FuVXNlSWRlbnRpdHlTZXJ2ZXIgfHxcbiAgICAgICAgICAgICFTZXR0aW5nc1N0b3JlLmdldFZhbHVlKFVJRmVhdHVyZS5JZGVudGl0eVNlcnZlcilcbiAgICAgICAgKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGRlZmF1bHRJZGVudGl0eVNlcnZlclVybCA9IGdldERlZmF1bHRJZGVudGl0eVNlcnZlclVybCgpO1xuICAgICAgICBpZiAoZGVmYXVsdElkZW50aXR5U2VydmVyVXJsKSB7XG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfQWRkcmVzc1BpY2tlckRpYWxvZ19pZGVudGl0eVNlcnZlclwiPnsgX3QoXG4gICAgICAgICAgICAgICAgICAgIFwiVXNlIGFuIGlkZW50aXR5IHNlcnZlciB0byBpbnZpdGUgYnkgZW1haWwuIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCI8ZGVmYXVsdD5Vc2UgdGhlIGRlZmF1bHQgKCUoZGVmYXVsdElkZW50aXR5U2VydmVyTmFtZSlzKTwvZGVmYXVsdD4gXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIm9yIG1hbmFnZSBpbiA8c2V0dGluZ3M+U2V0dGluZ3M8L3NldHRpbmdzPi5cIixcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdElkZW50aXR5U2VydmVyTmFtZTogYWJicmV2aWF0ZVVybChkZWZhdWx0SWRlbnRpdHlTZXJ2ZXJVcmwpLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OiBzdWIgPT4gPGEgaHJlZj1cIiNcIiBvbkNsaWNrPXt0aGlzLm9uVXNlRGVmYXVsdElkZW50aXR5U2VydmVyQ2xpY2t9Pnsgc3ViIH08L2E+LFxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3M6IHN1YiA9PiA8YSBocmVmPVwiI1wiIG9uQ2xpY2s9e3RoaXMub25NYW5hZ2VTZXR0aW5nc0NsaWNrfT57IHN1YiB9PC9hPixcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICApIH08L2Rpdj5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfQWRkcmVzc1BpY2tlckRpYWxvZ19pZGVudGl0eVNlcnZlclwiPnsgX3QoXG4gICAgICAgICAgICAgICAgICAgIFwiVXNlIGFuIGlkZW50aXR5IHNlcnZlciB0byBpbnZpdGUgYnkgZW1haWwuIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJNYW5hZ2UgaW4gPHNldHRpbmdzPlNldHRpbmdzPC9zZXR0aW5ncz4uXCIsXG4gICAgICAgICAgICAgICAgICAgIHt9LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXR0aW5nczogc3ViID0+IDxhIGhyZWY9XCIjXCIgb25DbGljaz17dGhpcy5vbk1hbmFnZVNldHRpbmdzQ2xpY2t9Pnsgc3ViIH08L2E+LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICkgfTwvZGl2PlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgb25EaWFsRm9ybVN1Ym1pdCA9IGV2ID0+IHtcbiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy50cmFuc2ZlckNhbGwoKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkRpYWxDaGFuZ2UgPSBldiA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBkaWFsUGFkVmFsdWU6IGV2LmN1cnJlbnRUYXJnZXQudmFsdWUgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25EaWdpdFByZXNzID0gKGRpZ2l0OiBzdHJpbmcsIGV2OiBCdXR0b25FdmVudCkgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgZGlhbFBhZFZhbHVlOiB0aGlzLnN0YXRlLmRpYWxQYWRWYWx1ZSArIGRpZ2l0IH0pO1xuXG4gICAgICAgIC8vIEtlZXAgdGhlIG51bWJlciBmaWVsZCBmb2N1c2VkIHNvIHRoYXQga2V5Ym9hcmQgZW50cnkgaXMgc3RpbGwgYXZhaWxhYmxlXG4gICAgICAgIC8vIEhvd2V2ZXIsIGRvbid0IGZvY3VzIGlmIHRoaXMgd2Fzbid0IHRoZSByZXN1bHQgb2YgZGlyZWN0bHkgY2xpY2tpbmcgb24gdGhlIGJ1dHRvbixcbiAgICAgICAgLy8gaS5lIHNvbWVvbmUgdXNpbmcga2V5Ym9hcmQgbmF2aWdhdGlvbi5cbiAgICAgICAgaWYgKGV2LnR5cGUgPT09IFwiY2xpY2tcIikge1xuICAgICAgICAgICAgdGhpcy5udW1iZXJFbnRyeUZpZWxkUmVmLmN1cnJlbnQ/LmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkRlbGV0ZVByZXNzID0gKGV2OiBCdXR0b25FdmVudCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5kaWFsUGFkVmFsdWUubGVuZ3RoID09PSAwKSByZXR1cm47XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBkaWFsUGFkVmFsdWU6IHRoaXMuc3RhdGUuZGlhbFBhZFZhbHVlLnNsaWNlKDAsIC0xKSB9KTtcblxuICAgICAgICAvLyBLZWVwIHRoZSBudW1iZXIgZmllbGQgZm9jdXNlZCBzbyB0aGF0IGtleWJvYXJkIGVudHJ5IGlzIHN0aWxsIGF2YWlsYWJsZVxuICAgICAgICAvLyBIb3dldmVyLCBkb24ndCBmb2N1cyBpZiB0aGlzIHdhc24ndCB0aGUgcmVzdWx0IG9mIGRpcmVjdGx5IGNsaWNraW5nIG9uIHRoZSBidXR0b24sXG4gICAgICAgIC8vIGkuZSBzb21lb25lIHVzaW5nIGtleWJvYXJkIG5hdmlnYXRpb24uXG4gICAgICAgIGlmIChldi50eXBlID09PSBcImNsaWNrXCIpIHtcbiAgICAgICAgICAgIHRoaXMubnVtYmVyRW50cnlGaWVsZFJlZi5jdXJyZW50Py5mb2N1cygpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25UYWJDaGFuZ2UgPSAodGFiSWQ6IFRhYklkKSA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBjdXJyZW50VGFiSWQ6IHRhYklkIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGFzeW5jIG9uTGlua0NsaWNrKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBzZWxlY3RUZXh0KGUudGFyZ2V0KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIG9uQ29weUNsaWNrID0gYXN5bmMgZSA9PiB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgY29uc3QgdGFyZ2V0ID0gZS50YXJnZXQ7IC8vIGNvcHkgdGFyZ2V0IGJlZm9yZSB3ZSBnbyBhc3luYyBhbmQgUmVhY3QgdGhyb3dzIGl0IGF3YXlcblxuICAgICAgICBjb25zdCBzdWNjZXNzZnVsID0gYXdhaXQgY29weVBsYWludGV4dChtYWtlVXNlclBlcm1hbGluayhNYXRyaXhDbGllbnRQZWcuZ2V0KCkuZ2V0VXNlcklkKCkpKTtcbiAgICAgICAgY29uc3QgYnV0dG9uUmVjdCA9IHRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgY29uc3QgeyBjbG9zZSB9ID0gQ29udGV4dE1lbnUuY3JlYXRlTWVudShHZW5lcmljVGV4dENvbnRleHRNZW51LCB7XG4gICAgICAgICAgICAuLi50b1JpZ2h0T2YoYnV0dG9uUmVjdCwgMiksXG4gICAgICAgICAgICBtZXNzYWdlOiBzdWNjZXNzZnVsID8gX3QoXCJDb3BpZWQhXCIpIDogX3QoXCJGYWlsZWQgdG8gY29weVwiKSxcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIERyb3AgYSByZWZlcmVuY2UgdG8gdGhpcyBjbG9zZSBoYW5kbGVyIGZvciBjb21wb25lbnRXaWxsVW5tb3VudFxuICAgICAgICB0aGlzLmNsb3NlQ29waWVkVG9vbHRpcCA9IHRhcmdldC5vbm1vdXNlbGVhdmUgPSBjbG9zZTtcbiAgICB9O1xuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBsZXQgc3Bpbm5lciA9IG51bGw7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmJ1c3kpIHtcbiAgICAgICAgICAgIHNwaW5uZXIgPSA8U3Bpbm5lciB3PXsyMH0gaD17MjB9IC8+O1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHRpdGxlO1xuICAgICAgICBsZXQgaGVscFRleHQ7XG4gICAgICAgIGxldCBidXR0b25UZXh0O1xuICAgICAgICBsZXQgZ29CdXR0b25GbjtcbiAgICAgICAgbGV0IGNvbnN1bHRDb25uZWN0U2VjdGlvbjtcbiAgICAgICAgbGV0IGV4dHJhU2VjdGlvbjtcbiAgICAgICAgbGV0IGZvb3RlcjtcbiAgICAgICAgbGV0IGtleVNoYXJpbmdXYXJuaW5nID0gPHNwYW4gLz47XG5cbiAgICAgICAgY29uc3QgaWRlbnRpdHlTZXJ2ZXJzRW5hYmxlZCA9IFNldHRpbmdzU3RvcmUuZ2V0VmFsdWUoVUlGZWF0dXJlLklkZW50aXR5U2VydmVyKTtcblxuICAgICAgICBjb25zdCBoYXNTZWxlY3Rpb24gPSB0aGlzLnN0YXRlLnRhcmdldHMubGVuZ3RoID4gMFxuICAgICAgICAgICAgfHwgKHRoaXMuc3RhdGUuZmlsdGVyVGV4dCAmJiB0aGlzLnN0YXRlLmZpbHRlclRleHQuaW5jbHVkZXMoJ0AnKSk7XG5cbiAgICAgICAgY29uc3QgY2xpID0gTWF0cml4Q2xpZW50UGVnLmdldCgpO1xuICAgICAgICBjb25zdCB1c2VySWQgPSBjbGkuZ2V0VXNlcklkKCk7XG4gICAgICAgIGlmICh0aGlzLnByb3BzLmtpbmQgPT09IEtJTkRfRE0pIHtcbiAgICAgICAgICAgIHRpdGxlID0gX3QoXCJEaXJlY3QgTWVzc2FnZXNcIik7XG5cbiAgICAgICAgICAgIGlmIChpZGVudGl0eVNlcnZlcnNFbmFibGVkKSB7XG4gICAgICAgICAgICAgICAgaGVscFRleHQgPSBfdChcbiAgICAgICAgICAgICAgICAgICAgXCJTdGFydCBhIGNvbnZlcnNhdGlvbiB3aXRoIHNvbWVvbmUgdXNpbmcgdGhlaXIgbmFtZSwgZW1haWwgYWRkcmVzcyBvciB1c2VybmFtZSAobGlrZSA8dXNlcklkLz4pLlwiLFxuICAgICAgICAgICAgICAgICAgICB7fSxcbiAgICAgICAgICAgICAgICAgICAgeyB1c2VySWQ6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj17bWFrZVVzZXJQZXJtYWxpbmsodXNlcklkKX0gcmVsPVwibm9yZWZlcnJlciBub29wZW5lclwiIHRhcmdldD1cIl9ibGFua1wiPnsgdXNlcklkIH08L2E+XG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9IH0sXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaGVscFRleHQgPSBfdChcbiAgICAgICAgICAgICAgICAgICAgXCJTdGFydCBhIGNvbnZlcnNhdGlvbiB3aXRoIHNvbWVvbmUgdXNpbmcgdGhlaXIgbmFtZSBvciB1c2VybmFtZSAobGlrZSA8dXNlcklkLz4pLlwiLFxuICAgICAgICAgICAgICAgICAgICB7fSxcbiAgICAgICAgICAgICAgICAgICAgeyB1c2VySWQ6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj17bWFrZVVzZXJQZXJtYWxpbmsodXNlcklkKX0gcmVsPVwibm9yZWZlcnJlciBub29wZW5lclwiIHRhcmdldD1cIl9ibGFua1wiPnsgdXNlcklkIH08L2E+XG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9IH0sXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKENvbW11bml0eVByb3RvdHlwZVN0b3JlLmluc3RhbmNlLmdldFNlbGVjdGVkQ29tbXVuaXR5SWQoKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbW11bml0eU5hbWUgPSBDb21tdW5pdHlQcm90b3R5cGVTdG9yZS5pbnN0YW5jZS5nZXRTZWxlY3RlZENvbW11bml0eU5hbWUoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBpbnZpdGVUZXh0ID0gX3QoXG4gICAgICAgICAgICAgICAgICAgIFwiVGhpcyB3b24ndCBpbnZpdGUgdGhlbSB0byAlKGNvbW11bml0eU5hbWUpcy4gXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIlRvIGludml0ZSBzb21lb25lIHRvICUoY29tbXVuaXR5TmFtZSlzLCBjbGljayA8YT5oZXJlPC9hPlwiLFxuICAgICAgICAgICAgICAgICAgICB7IGNvbW11bml0eU5hbWUgfSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhyZWY9e21ha2VVc2VyUGVybWFsaW5rKHVzZXJJZCl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWw9XCJub3JlZmVycmVyIG5vb3BlbmVyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldD1cIl9ibGFua1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID57IHVzZXJJZCB9PC9hPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgYTogKHN1YikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBY2Nlc3NpYmxlQnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBraW5kPVwibGlua1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uQ29tbXVuaXR5SW52aXRlQ2xpY2t9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID57IHN1YiB9PC9BY2Nlc3NpYmxlQnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgaGVscFRleHQgPSA8UmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICAgICAgICAgICAgIHsgaGVscFRleHQgfSB7IGludml0ZVRleHQgfVxuICAgICAgICAgICAgICAgIDwvUmVhY3QuRnJhZ21lbnQ+O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnV0dG9uVGV4dCA9IF90KFwiR29cIik7XG4gICAgICAgICAgICBnb0J1dHRvbkZuID0gdGhpcy5zdGFydERtO1xuICAgICAgICAgICAgZXh0cmFTZWN0aW9uID0gPGRpdiBjbGFzc05hbWU9XCJteF9JbnZpdGVEaWFsb2dfc2VjdGlvbl9oaWRkZW5fc3VnZ2VzdGlvbnNfZGlzY2xhaW1lclwiPlxuICAgICAgICAgICAgICAgIDxzcGFuPnsgX3QoXCJTb21lIHN1Z2dlc3Rpb25zIG1heSBiZSBoaWRkZW4gZm9yIHByaXZhY3kuXCIpIH08L3NwYW4+XG4gICAgICAgICAgICAgICAgPHA+eyBfdChcIklmIHlvdSBjYW4ndCBzZWUgd2hvIHlvdSdyZSBsb29raW5nIGZvciwgc2VuZCB0aGVtIHlvdXIgaW52aXRlIGxpbmsgYmVsb3cuXCIpIH08L3A+XG4gICAgICAgICAgICA8L2Rpdj47XG4gICAgICAgICAgICBjb25zdCBsaW5rID0gbWFrZVVzZXJQZXJtYWxpbmsoTWF0cml4Q2xpZW50UGVnLmdldCgpLmdldFVzZXJJZCgpKTtcbiAgICAgICAgICAgIGZvb3RlciA9IDxkaXYgY2xhc3NOYW1lPVwibXhfSW52aXRlRGlhbG9nX2Zvb3RlclwiPlxuICAgICAgICAgICAgICAgIDxoMz57IF90KFwiT3Igc2VuZCBpbnZpdGUgbGlua1wiKSB9PC9oMz5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X0ludml0ZURpYWxvZ19mb290ZXJfbGlua1wiPlxuICAgICAgICAgICAgICAgICAgICA8YSBocmVmPXtsaW5rfSBvbkNsaWNrPXt0aGlzLm9uTGlua0NsaWNrfT5cbiAgICAgICAgICAgICAgICAgICAgICAgIHsgbGluayB9XG4gICAgICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgICAgICAgICAgPEFjY2Vzc2libGVUb29sdGlwQnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17X3QoXCJDb3B5XCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5vbkNvcHlDbGlja31cbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm14X0ludml0ZURpYWxvZ19mb290ZXJfbGlua19jb3B5XCJcbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiAvPlxuICAgICAgICAgICAgICAgICAgICA8L0FjY2Vzc2libGVUb29sdGlwQnV0dG9uPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+O1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMucHJvcHMua2luZCA9PT0gS0lORF9JTlZJVEUpIHtcbiAgICAgICAgICAgIGNvbnN0IHJvb20gPSBNYXRyaXhDbGllbnRQZWcuZ2V0KCk/LmdldFJvb20odGhpcy5wcm9wcy5yb29tSWQpO1xuICAgICAgICAgICAgY29uc3QgaXNTcGFjZSA9IFNwYWNlU3RvcmUuc3BhY2VzRW5hYmxlZCAmJiByb29tPy5pc1NwYWNlUm9vbSgpO1xuICAgICAgICAgICAgdGl0bGUgPSBpc1NwYWNlXG4gICAgICAgICAgICAgICAgPyBfdChcIkludml0ZSB0byAlKHNwYWNlTmFtZSlzXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgc3BhY2VOYW1lOiByb29tLm5hbWUgfHwgX3QoXCJVbm5hbWVkIFNwYWNlXCIpLFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgOiBfdChcIkludml0ZSB0byAlKHJvb21OYW1lKXNcIiwge1xuICAgICAgICAgICAgICAgICAgICByb29tTmFtZTogcm9vbS5uYW1lIHx8IF90KFwiVW5uYW1lZCBSb29tXCIpLFxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBsZXQgaGVscFRleHRVbnRyYW5zbGF0ZWQ7XG4gICAgICAgICAgICBpZiAoaXNTcGFjZSkge1xuICAgICAgICAgICAgICAgIGlmIChpZGVudGl0eVNlcnZlcnNFbmFibGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGhlbHBUZXh0VW50cmFuc2xhdGVkID0gX3RkKFwiSW52aXRlIHNvbWVvbmUgdXNpbmcgdGhlaXIgbmFtZSwgZW1haWwgYWRkcmVzcywgdXNlcm5hbWUgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCIobGlrZSA8dXNlcklkLz4pIG9yIDxhPnNoYXJlIHRoaXMgc3BhY2U8L2E+LlwiKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBoZWxwVGV4dFVudHJhbnNsYXRlZCA9IF90ZChcIkludml0ZSBzb21lb25lIHVzaW5nIHRoZWlyIG5hbWUsIHVzZXJuYW1lIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiKGxpa2UgPHVzZXJJZC8+KSBvciA8YT5zaGFyZSB0aGlzIHNwYWNlPC9hPi5cIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoaWRlbnRpdHlTZXJ2ZXJzRW5hYmxlZCkge1xuICAgICAgICAgICAgICAgICAgICBoZWxwVGV4dFVudHJhbnNsYXRlZCA9IF90ZChcIkludml0ZSBzb21lb25lIHVzaW5nIHRoZWlyIG5hbWUsIGVtYWlsIGFkZHJlc3MsIHVzZXJuYW1lIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiKGxpa2UgPHVzZXJJZC8+KSBvciA8YT5zaGFyZSB0aGlzIHJvb208L2E+LlwiKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBoZWxwVGV4dFVudHJhbnNsYXRlZCA9IF90ZChcIkludml0ZSBzb21lb25lIHVzaW5nIHRoZWlyIG5hbWUsIHVzZXJuYW1lIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiKGxpa2UgPHVzZXJJZC8+KSBvciA8YT5zaGFyZSB0aGlzIHJvb208L2E+LlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGhlbHBUZXh0ID0gX3QoaGVscFRleHRVbnRyYW5zbGF0ZWQsIHt9LCB7XG4gICAgICAgICAgICAgICAgdXNlcklkOiAoKSA9PlxuICAgICAgICAgICAgICAgICAgICA8YSBocmVmPXttYWtlVXNlclBlcm1hbGluayh1c2VySWQpfSByZWw9XCJub3JlZmVycmVyIG5vb3BlbmVyXCIgdGFyZ2V0PVwiX2JsYW5rXCI+eyB1c2VySWQgfTwvYT4sXG4gICAgICAgICAgICAgICAgYTogKHN1YikgPT5cbiAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj17bWFrZVJvb21QZXJtYWxpbmsodGhpcy5wcm9wcy5yb29tSWQpfSByZWw9XCJub3JlZmVycmVyIG5vb3BlbmVyXCIgdGFyZ2V0PVwiX2JsYW5rXCI+eyBzdWIgfTwvYT4sXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgYnV0dG9uVGV4dCA9IF90KFwiSW52aXRlXCIpO1xuICAgICAgICAgICAgZ29CdXR0b25GbiA9IHRoaXMuaW52aXRlVXNlcnM7XG5cbiAgICAgICAgICAgIGlmIChjbGkuaXNSb29tRW5jcnlwdGVkKHRoaXMucHJvcHMucm9vbUlkKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJvb20gPSBjbGkuZ2V0Um9vbSh0aGlzLnByb3BzLnJvb21JZCk7XG4gICAgICAgICAgICAgICAgY29uc3QgdmlzaWJpbGl0eUV2ZW50ID0gcm9vbS5jdXJyZW50U3RhdGUuZ2V0U3RhdGVFdmVudHMoXG4gICAgICAgICAgICAgICAgICAgIFwibS5yb29tLmhpc3RvcnlfdmlzaWJpbGl0eVwiLCBcIlwiLFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgY29uc3QgdmlzaWJpbGl0eSA9IHZpc2liaWxpdHlFdmVudCAmJiB2aXNpYmlsaXR5RXZlbnQuZ2V0Q29udGVudCgpICYmXG4gICAgICAgICAgICAgICAgICAgIHZpc2liaWxpdHlFdmVudC5nZXRDb250ZW50KCkuaGlzdG9yeV92aXNpYmlsaXR5O1xuICAgICAgICAgICAgICAgIGlmICh2aXNpYmlsaXR5ID09PSBcIndvcmxkX3JlYWRhYmxlXCIgfHwgdmlzaWJpbGl0eSA9PT0gXCJzaGFyZWRcIikge1xuICAgICAgICAgICAgICAgICAgICBrZXlTaGFyaW5nV2FybmluZyA9XG4gICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9J214X0ludml0ZURpYWxvZ19oZWxwVGV4dCc+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGltZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcmM9e3JlcXVpcmUoXCIuLi8uLi8uLi8uLi9yZXMvaW1nL2VsZW1lbnQtaWNvbnMvaW5mby5zdmdcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPXsxNH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0PXsxNH0gLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IFwiIFwiICsgX3QoXCJJbnZpdGVkIHBlb3BsZSB3aWxsIGJlIGFibGUgdG8gcmVhZCBvbGQgbWVzc2FnZXMuXCIpIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvcD47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMucHJvcHMua2luZCA9PT0gS0lORF9DQUxMX1RSQU5TRkVSKSB7XG4gICAgICAgICAgICB0aXRsZSA9IF90KFwiVHJhbnNmZXJcIik7XG5cbiAgICAgICAgICAgIGNvbnN1bHRDb25uZWN0U2VjdGlvbiA9IDxkaXYgY2xhc3NOYW1lPVwibXhfSW52aXRlRGlhbG9nX3RyYW5zZmVyQ29uc3VsdENvbm5lY3RcIj5cbiAgICAgICAgICAgICAgICA8bGFiZWw+XG4gICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBjaGVja2VkPXt0aGlzLnN0YXRlLmNvbnN1bHRGaXJzdH0gb25DaGFuZ2U9e3RoaXMub25Db25zdWx0Rmlyc3RDaGFuZ2V9IC8+XG4gICAgICAgICAgICAgICAgICAgIHsgX3QoXCJDb25zdWx0IGZpcnN0XCIpIH1cbiAgICAgICAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICAgICAgICAgIDxBY2Nlc3NpYmxlQnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIGtpbmQ9XCJzZWNvbmRhcnlcIlxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uQ2FuY2VsfVxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9J214X0ludml0ZURpYWxvZ190cmFuc2ZlckNvbnN1bHRDb25uZWN0X3B1c2hSaWdodCdcbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIHsgX3QoXCJDYW5jZWxcIikgfVxuICAgICAgICAgICAgICAgIDwvQWNjZXNzaWJsZUJ1dHRvbj5cbiAgICAgICAgICAgICAgICA8QWNjZXNzaWJsZUJ1dHRvblxuICAgICAgICAgICAgICAgICAgICBraW5kPVwicHJpbWFyeVwiXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMudHJhbnNmZXJDYWxsfVxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9J214X0ludml0ZURpYWxvZ190cmFuc2ZlckJ1dHRvbidcbiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9eyFoYXNTZWxlY3Rpb24gJiYgdGhpcy5zdGF0ZS5kaWFsUGFkVmFsdWUgPT09ICcnfVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgeyBfdChcIlRyYW5zZmVyXCIpIH1cbiAgICAgICAgICAgICAgICA8L0FjY2Vzc2libGVCdXR0b24+XG4gICAgICAgICAgICA8L2Rpdj47XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoXCJVbmtub3duIGtpbmQgb2YgSW52aXRlRGlhbG9nOiBcIiArIHRoaXMucHJvcHMua2luZCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBnb0J1dHRvbiA9IHRoaXMucHJvcHMua2luZCA9PSBLSU5EX0NBTExfVFJBTlNGRVIgPyBudWxsIDogPEFjY2Vzc2libGVCdXR0b25cbiAgICAgICAgICAgIGtpbmQ9XCJwcmltYXJ5XCJcbiAgICAgICAgICAgIG9uQ2xpY2s9e2dvQnV0dG9uRm59XG4gICAgICAgICAgICBjbGFzc05hbWU9J214X0ludml0ZURpYWxvZ19nb0J1dHRvbidcbiAgICAgICAgICAgIGRpc2FibGVkPXt0aGlzLnN0YXRlLmJ1c3kgfHwgIWhhc1NlbGVjdGlvbn1cbiAgICAgICAgPlxuICAgICAgICAgICAgeyBidXR0b25UZXh0IH1cbiAgICAgICAgPC9BY2Nlc3NpYmxlQnV0dG9uPjtcblxuICAgICAgICBjb25zdCB1c2Vyc1NlY3Rpb24gPSA8UmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9J214X0ludml0ZURpYWxvZ19oZWxwVGV4dCc+eyBoZWxwVGV4dCB9PC9wPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J214X0ludml0ZURpYWxvZ19hZGRyZXNzQmFyJz5cbiAgICAgICAgICAgICAgICB7IHRoaXMucmVuZGVyRWRpdG9yKCkgfVxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdteF9JbnZpdGVEaWFsb2dfYnV0dG9uQW5kU3Bpbm5lcic+XG4gICAgICAgICAgICAgICAgICAgIHsgZ29CdXR0b24gfVxuICAgICAgICAgICAgICAgICAgICB7IHNwaW5uZXIgfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICB7IGtleVNoYXJpbmdXYXJuaW5nIH1cbiAgICAgICAgICAgIHsgdGhpcy5yZW5kZXJJZGVudGl0eVNlcnZlcldhcm5pbmcoKSB9XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZXJyb3InPnsgdGhpcy5zdGF0ZS5lcnJvclRleHQgfTwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J214X0ludml0ZURpYWxvZ191c2VyU2VjdGlvbnMnPlxuICAgICAgICAgICAgICAgIHsgdGhpcy5yZW5kZXJTZWN0aW9uKCdyZWNlbnRzJykgfVxuICAgICAgICAgICAgICAgIHsgdGhpcy5yZW5kZXJTZWN0aW9uKCdzdWdnZXN0aW9ucycpIH1cbiAgICAgICAgICAgICAgICB7IGV4dHJhU2VjdGlvbiB9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIHsgZm9vdGVyIH1cbiAgICAgICAgPC9SZWFjdC5GcmFnbWVudD47XG5cbiAgICAgICAgbGV0IGRpYWxvZ0NvbnRlbnQ7XG4gICAgICAgIGlmICh0aGlzLnByb3BzLmtpbmQgPT09IEtJTkRfQ0FMTF9UUkFOU0ZFUikge1xuICAgICAgICAgICAgY29uc3QgdGFicyA9IFtdO1xuICAgICAgICAgICAgdGFicy5wdXNoKG5ldyBUYWIoXG4gICAgICAgICAgICAgICAgVGFiSWQuVXNlckRpcmVjdG9yeSwgX3RkKFwiVXNlciBEaXJlY3RvcnlcIiksICdteF9JbnZpdGVEaWFsb2dfdXNlckRpcmVjdG9yeUljb24nLCB1c2Vyc1NlY3Rpb24sXG4gICAgICAgICAgICApKTtcblxuICAgICAgICAgICAgY29uc3QgYmFja3NwYWNlQnV0dG9uID0gKFxuICAgICAgICAgICAgICAgIDxEaWFsUGFkQmFja3NwYWNlQnV0dG9uIG9uQmFja3NwYWNlUHJlc3M9e3RoaXMub25EZWxldGVQcmVzc30gLz5cbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIE9ubHkgc2hvdyB0aGUgYmFja3NwYWNlIGJ1dHRvbiBpZiB0aGUgZmllbGQgaGFzIGNvbnRlbnRcbiAgICAgICAgICAgIGxldCBkaWFsUGFkRmllbGQ7XG4gICAgICAgICAgICBpZiAodGhpcy5zdGF0ZS5kaWFsUGFkVmFsdWUubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgZGlhbFBhZEZpZWxkID0gPEZpZWxkXG4gICAgICAgICAgICAgICAgICAgIHJlZj17dGhpcy5udW1iZXJFbnRyeUZpZWxkUmVmfVxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJteF9JbnZpdGVEaWFsb2dfZGlhbFBhZEZpZWxkXCJcbiAgICAgICAgICAgICAgICAgICAgaWQ9XCJkaWFscGFkX251bWJlclwiXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLmRpYWxQYWRWYWx1ZX1cbiAgICAgICAgICAgICAgICAgICAgYXV0b0ZvY3VzPXt0cnVlfVxuICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkRpYWxDaGFuZ2V9XG4gICAgICAgICAgICAgICAgICAgIHBvc3RmaXhDb21wb25lbnQ9e2JhY2tzcGFjZUJ1dHRvbn1cbiAgICAgICAgICAgICAgICAvPjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZGlhbFBhZEZpZWxkID0gPEZpZWxkXG4gICAgICAgICAgICAgICAgICAgIHJlZj17dGhpcy5udW1iZXJFbnRyeUZpZWxkUmVmfVxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJteF9JbnZpdGVEaWFsb2dfZGlhbFBhZEZpZWxkXCJcbiAgICAgICAgICAgICAgICAgICAgaWQ9XCJkaWFscGFkX251bWJlclwiXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLmRpYWxQYWRWYWx1ZX1cbiAgICAgICAgICAgICAgICAgICAgYXV0b0ZvY3VzPXt0cnVlfVxuICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkRpYWxDaGFuZ2V9XG4gICAgICAgICAgICAgICAgLz47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGRpYWxQYWRTZWN0aW9uID0gPGRpdiBjbGFzc05hbWU9XCJteF9JbnZpdGVEaWFsb2dfZGlhbFBhZFwiPlxuICAgICAgICAgICAgICAgIDxmb3JtIG9uU3VibWl0PXt0aGlzLm9uRGlhbEZvcm1TdWJtaXR9PlxuICAgICAgICAgICAgICAgICAgICB7IGRpYWxQYWRGaWVsZCB9XG4gICAgICAgICAgICAgICAgPC9mb3JtPlxuICAgICAgICAgICAgICAgIDxEaWFscGFkXG4gICAgICAgICAgICAgICAgICAgIGhhc0RpYWw9e2ZhbHNlfVxuICAgICAgICAgICAgICAgICAgICBvbkRpZ2l0UHJlc3M9e3RoaXMub25EaWdpdFByZXNzfVxuICAgICAgICAgICAgICAgICAgICBvbkRlbGV0ZVByZXNzPXt0aGlzLm9uRGVsZXRlUHJlc3N9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDwvZGl2PjtcbiAgICAgICAgICAgIHRhYnMucHVzaChuZXcgVGFiKFRhYklkLkRpYWxQYWQsIF90ZChcIkRpYWwgcGFkXCIpLCAnbXhfSW52aXRlRGlhbG9nX2RpYWxQYWRJY29uJywgZGlhbFBhZFNlY3Rpb24pKTtcbiAgICAgICAgICAgIGRpYWxvZ0NvbnRlbnQgPSA8UmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICAgICAgICAgPFRhYmJlZFZpZXdcbiAgICAgICAgICAgICAgICAgICAgdGFicz17dGFic31cbiAgICAgICAgICAgICAgICAgICAgaW5pdGlhbFRhYklkPXt0aGlzLnN0YXRlLmN1cnJlbnRUYWJJZH1cbiAgICAgICAgICAgICAgICAgICAgdGFiTG9jYXRpb249e1RhYkxvY2F0aW9uLlRPUH1cbiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25UYWJDaGFuZ2V9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICB7IGNvbnN1bHRDb25uZWN0U2VjdGlvbiB9XG4gICAgICAgICAgICA8L1JlYWN0LkZyYWdtZW50PjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRpYWxvZ0NvbnRlbnQgPSA8UmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICAgICAgICAgeyB1c2Vyc1NlY3Rpb24gfVxuICAgICAgICAgICAgICAgIHsgY29uc3VsdENvbm5lY3RTZWN0aW9uIH1cbiAgICAgICAgICAgIDwvUmVhY3QuRnJhZ21lbnQ+O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxCYXNlRGlhbG9nXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbGFzc05hbWVzKHtcbiAgICAgICAgICAgICAgICAgICAgbXhfSW52aXRlRGlhbG9nX3RyYW5zZmVyOiB0aGlzLnByb3BzLmtpbmQgPT09IEtJTkRfQ0FMTF9UUkFOU0ZFUixcbiAgICAgICAgICAgICAgICAgICAgbXhfSW52aXRlRGlhbG9nX290aGVyOiB0aGlzLnByb3BzLmtpbmQgIT09IEtJTkRfQ0FMTF9UUkFOU0ZFUixcbiAgICAgICAgICAgICAgICAgICAgbXhfSW52aXRlRGlhbG9nX2hhc0Zvb3RlcjogISFmb290ZXIsXG4gICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgICAgaGFzQ2FuY2VsPXt0cnVlfVxuICAgICAgICAgICAgICAgIG9uRmluaXNoZWQ9e3RoaXMucHJvcHMub25GaW5pc2hlZH1cbiAgICAgICAgICAgICAgICB0aXRsZT17dGl0bGV9XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J214X0ludml0ZURpYWxvZ19jb250ZW50Jz5cbiAgICAgICAgICAgICAgICAgICAgeyBkaWFsb2dDb250ZW50IH1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvQmFzZURpYWxvZz5cbiAgICAgICAgKTtcbiAgICB9XG59XG4iXX0=