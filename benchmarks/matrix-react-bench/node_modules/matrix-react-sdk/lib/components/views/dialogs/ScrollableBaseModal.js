"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireDefault(require("react"));

var _MatrixClientPeg = require("../../../MatrixClientPeg");

var _Keyboard = require("../../../Keyboard");

var _MatrixClientContext = _interopRequireDefault(require("../../../contexts/MatrixClientContext"));

var _reactFocusLock = _interopRequireDefault(require("react-focus-lock"));

var _languageHandler = require("../../../languageHandler");

var _AccessibleButton = _interopRequireDefault(require("../elements/AccessibleButton"));

/*
Copyright 2021 The Matrix.org Foundation C.I.C.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

/**
 * Scrollable dialog base from Compound (Web Components).
 */
class ScrollableBaseModal extends _react.default.PureComponent {
  constructor(props) {
    super(props);
    (0, _defineProperty2.default)(this, "onKeyDown", e => {
      if (e.key === _Keyboard.Key.ESCAPE) {
        e.stopPropagation();
        e.preventDefault();
        this.cancel();
      }
    });
    (0, _defineProperty2.default)(this, "onCancel", () => {
      this.cancel();
    });
    (0, _defineProperty2.default)(this, "onSubmit", e => {
      e.stopPropagation();
      e.preventDefault();
      if (!this.state.canSubmit) return; // pretend the submit button was disabled

      this.submit();
    });
  }

  get matrixClient() {
    return _MatrixClientPeg.MatrixClientPeg.get();
  }

  render() {
    return /*#__PURE__*/_react.default.createElement(_MatrixClientContext.default.Provider, {
      value: this.matrixClient
    }, /*#__PURE__*/_react.default.createElement(_reactFocusLock.default, {
      returnFocus: true,
      lockProps: {
        onKeyDown: this.onKeyDown,
        role: "dialog",
        ["aria-labelledby"]: "mx_CompoundDialog_title",
        // Like BaseDialog, we'll just point this at the whole content
        ["aria-describedby"]: "mx_CompoundDialog_content"
      },
      className: "mx_CompoundDialog mx_ScrollableBaseDialog"
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_CompoundDialog_header"
    }, /*#__PURE__*/_react.default.createElement("h1", null, this.state.title), /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
      onClick: this.onCancel,
      className: "mx_CompoundDialog_cancelButton",
      "aria-label": (0, _languageHandler._t)("Close dialog")
    })), /*#__PURE__*/_react.default.createElement("form", {
      onSubmit: this.onSubmit
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_CompoundDialog_content"
    }, this.renderContent()), /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_CompoundDialog_footer"
    }, /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
      onClick: this.onCancel,
      kind: "primary_outline"
    }, (0, _languageHandler._t)("Cancel")), /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
      onClick: this.onSubmit,
      kind: "primary",
      disabled: !this.state.canSubmit,
      type: "submit",
      element: "button",
      className: "mx_Dialog_nonDialogButton"
    }, this.state.actionLabel)))));
  }

}

exports.default = ScrollableBaseModal;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZpZXdzL2RpYWxvZ3MvU2Nyb2xsYWJsZUJhc2VNb2RhbC50c3giXSwibmFtZXMiOlsiU2Nyb2xsYWJsZUJhc2VNb2RhbCIsIlJlYWN0IiwiUHVyZUNvbXBvbmVudCIsImNvbnN0cnVjdG9yIiwicHJvcHMiLCJlIiwia2V5IiwiS2V5IiwiRVNDQVBFIiwic3RvcFByb3BhZ2F0aW9uIiwicHJldmVudERlZmF1bHQiLCJjYW5jZWwiLCJzdGF0ZSIsImNhblN1Ym1pdCIsInN1Ym1pdCIsIm1hdHJpeENsaWVudCIsIk1hdHJpeENsaWVudFBlZyIsImdldCIsInJlbmRlciIsIm9uS2V5RG93biIsInJvbGUiLCJ0aXRsZSIsIm9uQ2FuY2VsIiwib25TdWJtaXQiLCJyZW5kZXJDb250ZW50IiwiYWN0aW9uTGFiZWwiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBZ0JBOztBQUVBOztBQUNBOztBQUVBOztBQUNBOztBQUNBOztBQUNBOztBQXhCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBa0JBO0FBQ0E7QUFDQTtBQUNlLE1BQWVBLG1CQUFmLFNBQ0hDLGVBQU1DLGFBREgsQ0FDaUM7QUFDbENDLEVBQUFBLFdBQVcsQ0FBQ0MsS0FBRCxFQUFnQjtBQUNqQyxVQUFNQSxLQUFOO0FBRGlDLHFEQVFoQkMsQ0FBRCxJQUFrRDtBQUNsRSxVQUFJQSxDQUFDLENBQUNDLEdBQUYsS0FBVUMsY0FBSUMsTUFBbEIsRUFBMEI7QUFDdEJILFFBQUFBLENBQUMsQ0FBQ0ksZUFBRjtBQUNBSixRQUFBQSxDQUFDLENBQUNLLGNBQUY7QUFDQSxhQUFLQyxNQUFMO0FBQ0g7QUFDSixLQWRvQztBQUFBLG9EQWdCbEIsTUFBTTtBQUNyQixXQUFLQSxNQUFMO0FBQ0gsS0FsQm9DO0FBQUEsb0RBb0JqQk4sQ0FBRCxJQUErQjtBQUM5Q0EsTUFBQUEsQ0FBQyxDQUFDSSxlQUFGO0FBQ0FKLE1BQUFBLENBQUMsQ0FBQ0ssY0FBRjtBQUNBLFVBQUksQ0FBQyxLQUFLRSxLQUFMLENBQVdDLFNBQWhCLEVBQTJCLE9BSG1CLENBR1g7O0FBQ25DLFdBQUtDLE1BQUw7QUFDSCxLQXpCb0M7QUFFcEM7O0FBRXlCLE1BQVpDLFlBQVksR0FBaUI7QUFDdkMsV0FBT0MsaUNBQWdCQyxHQUFoQixFQUFQO0FBQ0g7O0FBeUJNQyxFQUFBQSxNQUFNLEdBQWdCO0FBQ3pCLHdCQUNJLDZCQUFDLDRCQUFELENBQXFCLFFBQXJCO0FBQThCLE1BQUEsS0FBSyxFQUFFLEtBQUtIO0FBQTFDLG9CQUNJLDZCQUFDLHVCQUFEO0FBQ0ksTUFBQSxXQUFXLEVBQUUsSUFEakI7QUFFSSxNQUFBLFNBQVMsRUFBRTtBQUNQSSxRQUFBQSxTQUFTLEVBQUUsS0FBS0EsU0FEVDtBQUVQQyxRQUFBQSxJQUFJLEVBQUUsUUFGQztBQUdQLFNBQUMsaUJBQUQsR0FBcUIseUJBSGQ7QUFLUDtBQUNBLFNBQUMsa0JBQUQsR0FBc0I7QUFOZixPQUZmO0FBVUksTUFBQSxTQUFTLEVBQUM7QUFWZCxvQkFZSTtBQUFLLE1BQUEsU0FBUyxFQUFDO0FBQWYsb0JBQ0kseUNBQU0sS0FBS1IsS0FBTCxDQUFXUyxLQUFqQixDQURKLGVBRUksNkJBQUMseUJBQUQ7QUFDSSxNQUFBLE9BQU8sRUFBRSxLQUFLQyxRQURsQjtBQUVJLE1BQUEsU0FBUyxFQUFDLGdDQUZkO0FBR0ksb0JBQVkseUJBQUcsY0FBSDtBQUhoQixNQUZKLENBWkosZUFvQkk7QUFBTSxNQUFBLFFBQVEsRUFBRSxLQUFLQztBQUFyQixvQkFDSTtBQUFLLE1BQUEsU0FBUyxFQUFDO0FBQWYsT0FDTSxLQUFLQyxhQUFMLEVBRE4sQ0FESixlQUlJO0FBQUssTUFBQSxTQUFTLEVBQUM7QUFBZixvQkFDSSw2QkFBQyx5QkFBRDtBQUFrQixNQUFBLE9BQU8sRUFBRSxLQUFLRixRQUFoQztBQUEwQyxNQUFBLElBQUksRUFBQztBQUEvQyxPQUNNLHlCQUFHLFFBQUgsQ0FETixDQURKLGVBSUksNkJBQUMseUJBQUQ7QUFDSSxNQUFBLE9BQU8sRUFBRSxLQUFLQyxRQURsQjtBQUVJLE1BQUEsSUFBSSxFQUFDLFNBRlQ7QUFHSSxNQUFBLFFBQVEsRUFBRSxDQUFDLEtBQUtYLEtBQUwsQ0FBV0MsU0FIMUI7QUFJSSxNQUFBLElBQUksRUFBQyxRQUpUO0FBS0ksTUFBQSxPQUFPLEVBQUMsUUFMWjtBQU1JLE1BQUEsU0FBUyxFQUFDO0FBTmQsT0FRTSxLQUFLRCxLQUFMLENBQVdhLFdBUmpCLENBSkosQ0FKSixDQXBCSixDQURKLENBREo7QUE2Q0g7O0FBOUUyQyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG5Db3B5cmlnaHQgMjAyMSBUaGUgTWF0cml4Lm9yZyBGb3VuZGF0aW9uIEMuSS5DLlxuXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xueW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG5cbiAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcblxuVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG5TZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG5saW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiovXG5cbmltcG9ydCBSZWFjdCwgeyBGb3JtRXZlbnQgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IE1hdHJpeENsaWVudCB9IGZyb20gXCJtYXRyaXgtanMtc2RrL3NyYy9jbGllbnRcIjtcbmltcG9ydCB7IE1hdHJpeENsaWVudFBlZyB9IGZyb20gXCIuLi8uLi8uLi9NYXRyaXhDbGllbnRQZWdcIjtcbmltcG9ydCB7IEtleSB9IGZyb20gXCIuLi8uLi8uLi9LZXlib2FyZFwiO1xuaW1wb3J0IHsgSURpYWxvZ1Byb3BzIH0gZnJvbSBcIi4vSURpYWxvZ1Byb3BzXCI7XG5pbXBvcnQgTWF0cml4Q2xpZW50Q29udGV4dCBmcm9tIFwiLi4vLi4vLi4vY29udGV4dHMvTWF0cml4Q2xpZW50Q29udGV4dFwiO1xuaW1wb3J0IEZvY3VzTG9jayBmcm9tIFwicmVhY3QtZm9jdXMtbG9ja1wiO1xuaW1wb3J0IHsgX3QgfSBmcm9tIFwiLi4vLi4vLi4vbGFuZ3VhZ2VIYW5kbGVyXCI7XG5pbXBvcnQgQWNjZXNzaWJsZUJ1dHRvbiBmcm9tIFwiLi4vZWxlbWVudHMvQWNjZXNzaWJsZUJ1dHRvblwiO1xuXG5leHBvcnQgaW50ZXJmYWNlIElTY3JvbGxhYmxlQmFzZVN0YXRlIHtcbiAgICBjYW5TdWJtaXQ6IGJvb2xlYW47XG4gICAgdGl0bGU6IHN0cmluZztcbiAgICBhY3Rpb25MYWJlbDogc3RyaW5nO1xufVxuXG4vKipcbiAqIFNjcm9sbGFibGUgZGlhbG9nIGJhc2UgZnJvbSBDb21wb3VuZCAoV2ViIENvbXBvbmVudHMpLlxuICovXG5leHBvcnQgZGVmYXVsdCBhYnN0cmFjdCBjbGFzcyBTY3JvbGxhYmxlQmFzZU1vZGFsPFRQcm9wcyBleHRlbmRzIElEaWFsb2dQcm9wcywgVFN0YXRlIGV4dGVuZHMgSVNjcm9sbGFibGVCYXNlU3RhdGU+XG4gICAgZXh0ZW5kcyBSZWFjdC5QdXJlQ29tcG9uZW50PFRQcm9wcywgVFN0YXRlPiB7XG4gICAgcHJvdGVjdGVkIGNvbnN0cnVjdG9yKHByb3BzOiBUUHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBnZXQgbWF0cml4Q2xpZW50KCk6IE1hdHJpeENsaWVudCB7XG4gICAgICAgIHJldHVybiBNYXRyaXhDbGllbnRQZWcuZ2V0KCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvbktleURvd24gPSAoZTogS2V5Ym9hcmRFdmVudCB8IFJlYWN0LktleWJvYXJkRXZlbnQpOiB2b2lkID0+IHtcbiAgICAgICAgaWYgKGUua2V5ID09PSBLZXkuRVNDQVBFKSB7XG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5jYW5jZWwoKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwcml2YXRlIG9uQ2FuY2VsID0gKCkgPT4ge1xuICAgICAgICB0aGlzLmNhbmNlbCgpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uU3VibWl0ID0gKGU6IE1vdXNlRXZlbnQgfCBGb3JtRXZlbnQpID0+IHtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBpZiAoIXRoaXMuc3RhdGUuY2FuU3VibWl0KSByZXR1cm47IC8vIHByZXRlbmQgdGhlIHN1Ym1pdCBidXR0b24gd2FzIGRpc2FibGVkXG4gICAgICAgIHRoaXMuc3VibWl0KCk7XG4gICAgfTtcblxuICAgIHByb3RlY3RlZCBhYnN0cmFjdCBjYW5jZWwoKTogdm9pZDtcbiAgICBwcm90ZWN0ZWQgYWJzdHJhY3Qgc3VibWl0KCk6IHZvaWQ7XG4gICAgcHJvdGVjdGVkIGFic3RyYWN0IHJlbmRlckNvbnRlbnQoKTogUmVhY3QuUmVhY3ROb2RlO1xuXG4gICAgcHVibGljIHJlbmRlcigpOiBKU1guRWxlbWVudCB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8TWF0cml4Q2xpZW50Q29udGV4dC5Qcm92aWRlciB2YWx1ZT17dGhpcy5tYXRyaXhDbGllbnR9PlxuICAgICAgICAgICAgICAgIDxGb2N1c0xvY2tcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuRm9jdXM9e3RydWV9XG4gICAgICAgICAgICAgICAgICAgIGxvY2tQcm9wcz17e1xuICAgICAgICAgICAgICAgICAgICAgICAgb25LZXlEb3duOiB0aGlzLm9uS2V5RG93bixcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvbGU6IFwiZGlhbG9nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBbXCJhcmlhLWxhYmVsbGVkYnlcIl06IFwibXhfQ29tcG91bmREaWFsb2dfdGl0bGVcIixcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTGlrZSBCYXNlRGlhbG9nLCB3ZSdsbCBqdXN0IHBvaW50IHRoaXMgYXQgdGhlIHdob2xlIGNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIFtcImFyaWEtZGVzY3JpYmVkYnlcIl06IFwibXhfQ29tcG91bmREaWFsb2dfY29udGVudFwiLFxuICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJteF9Db21wb3VuZERpYWxvZyBteF9TY3JvbGxhYmxlQmFzZURpYWxvZ1wiXG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X0NvbXBvdW5kRGlhbG9nX2hlYWRlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGgxPnsgdGhpcy5zdGF0ZS50aXRsZSB9PC9oMT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxBY2Nlc3NpYmxlQnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5vbkNhbmNlbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJteF9Db21wb3VuZERpYWxvZ19jYW5jZWxCdXR0b25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyaWEtbGFiZWw9e190KFwiQ2xvc2UgZGlhbG9nXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxmb3JtIG9uU3VibWl0PXt0aGlzLm9uU3VibWl0fT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfQ29tcG91bmREaWFsb2dfY29udGVudFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGhpcy5yZW5kZXJDb250ZW50KCkgfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X0NvbXBvdW5kRGlhbG9nX2Zvb3RlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBY2Nlc3NpYmxlQnV0dG9uIG9uQ2xpY2s9e3RoaXMub25DYW5jZWx9IGtpbmQ9XCJwcmltYXJ5X291dGxpbmVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBfdChcIkNhbmNlbFwiKSB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9BY2Nlc3NpYmxlQnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBY2Nlc3NpYmxlQnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMub25TdWJtaXR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtpbmQ9XCJwcmltYXJ5XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9eyF0aGlzLnN0YXRlLmNhblN1Ym1pdH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInN1Ym1pdFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQ9XCJidXR0b25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJteF9EaWFsb2dfbm9uRGlhbG9nQnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGhpcy5zdGF0ZS5hY3Rpb25MYWJlbCB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9BY2Nlc3NpYmxlQnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZm9ybT5cbiAgICAgICAgICAgICAgICA8L0ZvY3VzTG9jaz5cbiAgICAgICAgICAgIDwvTWF0cml4Q2xpZW50Q29udGV4dC5Qcm92aWRlcj5cbiAgICAgICAgKTtcbiAgICB9XG59XG4iXX0=