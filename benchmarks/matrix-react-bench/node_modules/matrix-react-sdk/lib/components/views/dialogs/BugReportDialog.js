"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireDefault(require("react"));

var _SdkConfig = _interopRequireDefault(require("../../../SdkConfig"));

var _Modal = _interopRequireDefault(require("../../../Modal"));

var _languageHandler = require("../../../languageHandler");

var _submitRageshake = _interopRequireWildcard(require("../../../rageshake/submit-rageshake"));

var _AccessibleButton = _interopRequireDefault(require("../elements/AccessibleButton"));

var _replaceableComponent = require("../../../utils/replaceableComponent");

var _QuestionDialog = _interopRequireDefault(require("./QuestionDialog"));

var _BaseDialog = _interopRequireDefault(require("./BaseDialog"));

var _Field = _interopRequireDefault(require("../elements/Field"));

var _Spinner = _interopRequireDefault(require("../elements/Spinner"));

var _DialogButtons = _interopRequireDefault(require("../elements/DialogButtons"));

var _sentry = require("../../../sentry");

var _dec, _class;

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

let BugReportDialog = (_dec = (0, _replaceableComponent.replaceableComponent)("views.dialogs.BugReportDialog"), _dec(_class = class BugReportDialog extends _react.default.Component {
  constructor(props) {
    super(props);
    (0, _defineProperty2.default)(this, "unmounted", void 0);
    (0, _defineProperty2.default)(this, "onCancel", () => {
      this.props.onFinished(false);
    });
    (0, _defineProperty2.default)(this, "onSubmit", () => {
      if ((!this.state.text || !this.state.text.trim()) && (!this.state.issueUrl || !this.state.issueUrl.trim())) {
        this.setState({
          err: (0, _languageHandler._t)("Please tell us what went wrong or, better, create a GitHub issue that describes the problem.")
        });
        return;
      }

      const userText = (this.state.text.length > 0 ? this.state.text + '\n\n' : '') + 'Issue: ' + (this.state.issueUrl.length > 0 ? this.state.issueUrl : 'No issue link given');
      this.setState({
        busy: true,
        progress: null,
        err: null
      });
      this.sendProgressCallback((0, _languageHandler._t)("Preparing to send logs"));
      (0, _submitRageshake.default)(_SdkConfig.default.get().bug_report_endpoint_url, {
        userText,
        sendLogs: true,
        progressCallback: this.sendProgressCallback,
        label: this.props.label
      }).then(() => {
        if (!this.unmounted) {
          this.props.onFinished(false); // N.B. first param is passed to piwik and so doesn't want i18n

          _Modal.default.createTrackedDialog('Bug report sent', '', _QuestionDialog.default, {
            title: (0, _languageHandler._t)('Logs sent'),
            description: (0, _languageHandler._t)('Thank you!'),
            hasCancelButton: false
          });
        }
      }, err => {
        if (!this.unmounted) {
          this.setState({
            busy: false,
            progress: null,
            err: (0, _languageHandler._t)("Failed to send logs: ") + `${err.message}`
          });
        }
      });
      (0, _sentry.sendSentryReport)(this.state.text, this.state.issueUrl, this.props.error);
    });
    (0, _defineProperty2.default)(this, "onDownload", async () => {
      this.setState({
        downloadBusy: true
      });
      this.downloadProgressCallback((0, _languageHandler._t)("Preparing to download logs"));

      try {
        await (0, _submitRageshake.downloadBugReport)({
          sendLogs: true,
          progressCallback: this.downloadProgressCallback,
          label: this.props.label
        });
        this.setState({
          downloadBusy: false,
          downloadProgress: null
        });
      } catch (err) {
        if (!this.unmounted) {
          this.setState({
            downloadBusy: false,
            downloadProgress: (0, _languageHandler._t)("Failed to send logs: ") + `${err.message}`
          });
        }
      }
    });
    (0, _defineProperty2.default)(this, "onTextChange", ev => {
      this.setState({
        text: ev.currentTarget.value
      });
    });
    (0, _defineProperty2.default)(this, "onIssueUrlChange", ev => {
      this.setState({
        issueUrl: ev.currentTarget.value
      });
    });
    (0, _defineProperty2.default)(this, "sendProgressCallback", progress => {
      if (this.unmounted) {
        return;
      }

      this.setState({
        progress
      });
    });
    (0, _defineProperty2.default)(this, "downloadProgressCallback", downloadProgress => {
      if (this.unmounted) {
        return;
      }

      this.setState({
        downloadProgress
      });
    });
    this.state = {
      sendLogs: true,
      busy: false,
      err: null,
      issueUrl: "",
      text: props.initialText || "",
      progress: null,
      downloadBusy: false,
      downloadProgress: null
    };
    this.unmounted = false;
  }

  componentWillUnmount() {
    this.unmounted = true;
  }

  render() {
    let error = null;

    if (this.state.err) {
      error = /*#__PURE__*/_react.default.createElement("div", {
        className: "error"
      }, this.state.err);
    }

    let progress = null;

    if (this.state.busy) {
      progress = /*#__PURE__*/_react.default.createElement("div", {
        className: "progress"
      }, /*#__PURE__*/_react.default.createElement(_Spinner.default, null), this.state.progress, " ...");
    }

    let warning;

    if (window.Modernizr && Object.values(window.Modernizr).some(support => support === false)) {
      warning = /*#__PURE__*/_react.default.createElement("p", null, /*#__PURE__*/_react.default.createElement("b", null, (0, _languageHandler._t)("Reminder: Your browser is unsupported, so your experience may be unpredictable.")));
    }

    return /*#__PURE__*/_react.default.createElement(_BaseDialog.default, {
      className: "mx_BugReportDialog",
      onFinished: this.onCancel,
      title: (0, _languageHandler._t)('Submit debug logs'),
      contentId: "mx_Dialog_content"
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_Dialog_content",
      id: "mx_Dialog_content"
    }, warning, /*#__PURE__*/_react.default.createElement("p", null, (0, _languageHandler._t)("Debug logs contain application usage data including your " + "username, the IDs or aliases of the rooms or groups you " + "have visited, which UI elements you last interacted with, " + "and the usernames of other users. They do not contain messages.")), /*#__PURE__*/_react.default.createElement("p", null, /*#__PURE__*/_react.default.createElement("b", null, (0, _languageHandler._t)("Before submitting logs, you must <a>create a GitHub issue</a> to describe your problem.", {}, {
      a: sub => /*#__PURE__*/_react.default.createElement("a", {
        target: "_blank",
        href: "https://github.com/vector-im/element-web/issues/new/choose"
      }, sub)
    }))), /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_BugReportDialog_download"
    }, /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
      onClick: this.onDownload,
      kind: "link",
      disabled: this.state.downloadBusy
    }, (0, _languageHandler._t)("Download logs")), this.state.downloadProgress && /*#__PURE__*/_react.default.createElement("span", null, this.state.downloadProgress, " ...")), /*#__PURE__*/_react.default.createElement(_Field.default, {
      type: "text",
      className: "mx_BugReportDialog_field_input",
      label: (0, _languageHandler._t)("GitHub issue"),
      onChange: this.onIssueUrlChange,
      value: this.state.issueUrl,
      placeholder: "https://github.com/vector-im/element-web/issues/..."
    }), /*#__PURE__*/_react.default.createElement(_Field.default, {
      className: "mx_BugReportDialog_field_input",
      element: "textarea",
      label: (0, _languageHandler._t)("Notes"),
      rows: 5,
      onChange: this.onTextChange,
      value: this.state.text,
      placeholder: (0, _languageHandler._t)("If there is additional context that would help in " + "analysing the issue, such as what you were doing at " + "the time, room IDs, user IDs, etc., " + "please include those things here.")
    }), progress, error), /*#__PURE__*/_react.default.createElement(_DialogButtons.default, {
      primaryButton: (0, _languageHandler._t)("Send logs"),
      onPrimaryButtonClick: this.onSubmit,
      focus: true,
      onCancel: this.onCancel,
      disabled: this.state.busy
    }));
  }

}) || _class);
exports.default = BugReportDialog;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZpZXdzL2RpYWxvZ3MvQnVnUmVwb3J0RGlhbG9nLnRzeCJdLCJuYW1lcyI6WyJCdWdSZXBvcnREaWFsb2ciLCJSZWFjdCIsIkNvbXBvbmVudCIsImNvbnN0cnVjdG9yIiwicHJvcHMiLCJvbkZpbmlzaGVkIiwic3RhdGUiLCJ0ZXh0IiwidHJpbSIsImlzc3VlVXJsIiwic2V0U3RhdGUiLCJlcnIiLCJ1c2VyVGV4dCIsImxlbmd0aCIsImJ1c3kiLCJwcm9ncmVzcyIsInNlbmRQcm9ncmVzc0NhbGxiYWNrIiwiU2RrQ29uZmlnIiwiZ2V0IiwiYnVnX3JlcG9ydF9lbmRwb2ludF91cmwiLCJzZW5kTG9ncyIsInByb2dyZXNzQ2FsbGJhY2siLCJsYWJlbCIsInRoZW4iLCJ1bm1vdW50ZWQiLCJNb2RhbCIsImNyZWF0ZVRyYWNrZWREaWFsb2ciLCJRdWVzdGlvbkRpYWxvZyIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJoYXNDYW5jZWxCdXR0b24iLCJtZXNzYWdlIiwiZXJyb3IiLCJkb3dubG9hZEJ1c3kiLCJkb3dubG9hZFByb2dyZXNzQ2FsbGJhY2siLCJkb3dubG9hZFByb2dyZXNzIiwiZXYiLCJjdXJyZW50VGFyZ2V0IiwidmFsdWUiLCJpbml0aWFsVGV4dCIsImNvbXBvbmVudFdpbGxVbm1vdW50IiwicmVuZGVyIiwid2FybmluZyIsIndpbmRvdyIsIk1vZGVybml6ciIsIk9iamVjdCIsInZhbHVlcyIsInNvbWUiLCJzdXBwb3J0Iiwib25DYW5jZWwiLCJhIiwic3ViIiwib25Eb3dubG9hZCIsIm9uSXNzdWVVcmxDaGFuZ2UiLCJvblRleHRDaGFuZ2UiLCJvblN1Ym1pdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFtQkE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7Ozs7O0lBcUJxQkEsZSxXQURwQixnREFBcUIs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QUsvQyxLQUFMLENBQVdHLFFBTHRCO0FBTUksTUFBQSxXQUFXLEVBQUM7QUFOaEIsTUFoQ0osZUF3Q0ksNkJBQUMsY0FBRDtBQUNJLE1BQUEsU0FBUyxFQUFDLGdDQURkO0FBRUksTUFBQSxPQUFPLEVBQUMsVUFGWjtBQUdJLE1BQUEsS0FBSyxFQUFFLHlCQUFHLE9BQUgsQ0FIWDtBQUlJLE1BQUEsSUFBSSxFQUFFLENBSlY7QUFLSSxNQUFBLFFBQVEsRUFBRSxLQUFLNkMsWUFMbkI7QUFNSSxNQUFBLEtBQUssRUFBRSxLQUFLaEQsS0FBTCxDQUFXQyxJQU50QjtBQU9JLE1BQUEsV0FBVyxFQUFFLHlCQUNULHVEQUNBLHNEQURBLEdBRUEsc0NBRkEsR0FHQSxtQ0FKUztBQVBqQixNQXhDSixFQXNETVEsUUF0RE4sRUF1RE1pQixLQXZETixDQU5KLGVBK0RJLDZCQUFDLHNCQUFEO0FBQWUsTUFBQSxhQUFhLEVBQUUseUJBQUcsV0FBSCxDQUE5QjtBQUNJLE1BQUEsb0JBQW9CLEVBQUUsS0FBS3VCLFFBRC9CO0FBRUksTUFBQSxLQUFLLEVBQUUsSUFGWDtBQUdJLE1BQUEsUUFBUSxFQUFFLEtBQUtOLFFBSG5CO0FBSUksTUFBQSxRQUFRLEVBQUUsS0FBSzNDLEtBQUwsQ0FBV1E7QUFKekIsTUEvREosQ0FESjtBQXdFSDs7QUFyTndFLEMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuQ29weXJpZ2h0IDIwMTcgT3Blbk1hcmtldCBMdGRcbkNvcHlyaWdodCAyMDE4IE5ldyBWZWN0b3IgTHRkXG5Db3B5cmlnaHQgMjAxOSBNaWNoYWVsIFRlbGF0eW5za2kgPDd0M2NoZ3V5QGdtYWlsLmNvbT5cbkNvcHlyaWdodCAyMDE5IFRoZSBNYXRyaXgub3JnIEZvdW5kYXRpb24gQy5JLkMuXG5cbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG55b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG5Zb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcblxuICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuXG5Vbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG5kaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG5XSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cblNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbmxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuKi9cblxuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBTZGtDb25maWcgZnJvbSAnLi4vLi4vLi4vU2RrQ29uZmlnJztcbmltcG9ydCBNb2RhbCBmcm9tICcuLi8uLi8uLi9Nb2RhbCc7XG5pbXBvcnQgeyBfdCB9IGZyb20gJy4uLy4uLy4uL2xhbmd1YWdlSGFuZGxlcic7XG5pbXBvcnQgc2VuZEJ1Z1JlcG9ydCwgeyBkb3dubG9hZEJ1Z1JlcG9ydCB9IGZyb20gJy4uLy4uLy4uL3JhZ2VzaGFrZS9zdWJtaXQtcmFnZXNoYWtlJztcbmltcG9ydCBBY2Nlc3NpYmxlQnV0dG9uIGZyb20gXCIuLi9lbGVtZW50cy9BY2Nlc3NpYmxlQnV0dG9uXCI7XG5pbXBvcnQgeyByZXBsYWNlYWJsZUNvbXBvbmVudCB9IGZyb20gXCIuLi8uLi8uLi91dGlscy9yZXBsYWNlYWJsZUNvbXBvbmVudFwiO1xuaW1wb3J0IFF1ZXN0aW9uRGlhbG9nIGZyb20gXCIuL1F1ZXN0aW9uRGlhbG9nXCI7XG5pbXBvcnQgQmFzZURpYWxvZyBmcm9tIFwiLi9CYXNlRGlhbG9nXCI7XG5pbXBvcnQgRmllbGQgZnJvbSAnLi4vZWxlbWVudHMvRmllbGQnO1xuaW1wb3J0IFNwaW5uZXIgZnJvbSBcIi4uL2VsZW1lbnRzL1NwaW5uZXJcIjtcbmltcG9ydCBEaWFsb2dCdXR0b25zIGZyb20gXCIuLi9lbGVtZW50cy9EaWFsb2dCdXR0b25zXCI7XG5pbXBvcnQgeyBzZW5kU2VudHJ5UmVwb3J0IH0gZnJvbSBcIi4uLy4uLy4uL3NlbnRyeVwiO1xuXG5pbnRlcmZhY2UgSVByb3BzIHtcbiAgICBvbkZpbmlzaGVkOiAoc3VjY2VzczogYm9vbGVhbikgPT4gdm9pZDtcbiAgICBpbml0aWFsVGV4dD86IHN0cmluZztcbiAgICBsYWJlbD86IHN0cmluZztcbiAgICBlcnJvcj86IEVycm9yO1xufVxuXG5pbnRlcmZhY2UgSVN0YXRlIHtcbiAgICBzZW5kTG9nczogYm9vbGVhbjtcbiAgICBidXN5OiBib29sZWFuO1xuICAgIGVycjogc3RyaW5nO1xuICAgIGlzc3VlVXJsOiBzdHJpbmc7XG4gICAgdGV4dDogc3RyaW5nO1xuICAgIHByb2dyZXNzOiBzdHJpbmc7XG4gICAgZG93bmxvYWRCdXN5OiBib29sZWFuO1xuICAgIGRvd25sb2FkUHJvZ3Jlc3M6IHN0cmluZztcbn1cblxuQHJlcGxhY2VhYmxlQ29tcG9uZW50KFwidmlld3MuZGlhbG9ncy5CdWdSZXBvcnREaWFsb2dcIilcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEJ1Z1JlcG9ydERpYWxvZyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxJUHJvcHMsIElTdGF0ZT4ge1xuICAgIHByaXZhdGUgdW5tb3VudGVkOiBib29sZWFuO1xuXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgc2VuZExvZ3M6IHRydWUsXG4gICAgICAgICAgICBidXN5OiBmYWxzZSxcbiAgICAgICAgICAgIGVycjogbnVsbCxcbiAgICAgICAgICAgIGlzc3VlVXJsOiBcIlwiLFxuICAgICAgICAgICAgdGV4dDogcHJvcHMuaW5pdGlhbFRleHQgfHwgXCJcIixcbiAgICAgICAgICAgIHByb2dyZXNzOiBudWxsLFxuICAgICAgICAgICAgZG93bmxvYWRCdXN5OiBmYWxzZSxcbiAgICAgICAgICAgIGRvd25sb2FkUHJvZ3Jlc3M6IG51bGwsXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMudW5tb3VudGVkID0gZmFsc2U7XG4gICAgfVxuXG4gICAgcHVibGljIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgICAgICB0aGlzLnVubW91bnRlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvbkNhbmNlbCA9ICgpOiB2b2lkID0+IHtcbiAgICAgICAgdGhpcy5wcm9wcy5vbkZpbmlzaGVkKGZhbHNlKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvblN1Ym1pdCA9ICgpOiB2b2lkID0+IHtcbiAgICAgICAgaWYgKCghdGhpcy5zdGF0ZS50ZXh0IHx8ICF0aGlzLnN0YXRlLnRleHQudHJpbSgpKSAmJiAoIXRoaXMuc3RhdGUuaXNzdWVVcmwgfHwgIXRoaXMuc3RhdGUuaXNzdWVVcmwudHJpbSgpKSkge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgZXJyOiBfdChcIlBsZWFzZSB0ZWxsIHVzIHdoYXQgd2VudCB3cm9uZyBvciwgYmV0dGVyLCBjcmVhdGUgYSBHaXRIdWIgaXNzdWUgdGhhdCBkZXNjcmliZXMgdGhlIHByb2JsZW0uXCIpLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB1c2VyVGV4dCA9XG4gICAgICAgICAgICAodGhpcy5zdGF0ZS50ZXh0Lmxlbmd0aCA+IDAgPyB0aGlzLnN0YXRlLnRleHQgKyAnXFxuXFxuJzogJycpICsgJ0lzc3VlOiAnICtcbiAgICAgICAgICAgICh0aGlzLnN0YXRlLmlzc3VlVXJsLmxlbmd0aCA+IDAgPyB0aGlzLnN0YXRlLmlzc3VlVXJsIDogJ05vIGlzc3VlIGxpbmsgZ2l2ZW4nKTtcblxuICAgICAgICB0aGlzLnNldFN0YXRlKHsgYnVzeTogdHJ1ZSwgcHJvZ3Jlc3M6IG51bGwsIGVycjogbnVsbCB9KTtcbiAgICAgICAgdGhpcy5zZW5kUHJvZ3Jlc3NDYWxsYmFjayhfdChcIlByZXBhcmluZyB0byBzZW5kIGxvZ3NcIikpO1xuXG4gICAgICAgIHNlbmRCdWdSZXBvcnQoU2RrQ29uZmlnLmdldCgpLmJ1Z19yZXBvcnRfZW5kcG9pbnRfdXJsLCB7XG4gICAgICAgICAgICB1c2VyVGV4dCxcbiAgICAgICAgICAgIHNlbmRMb2dzOiB0cnVlLFxuICAgICAgICAgICAgcHJvZ3Jlc3NDYWxsYmFjazogdGhpcy5zZW5kUHJvZ3Jlc3NDYWxsYmFjayxcbiAgICAgICAgICAgIGxhYmVsOiB0aGlzLnByb3BzLmxhYmVsLFxuICAgICAgICB9KS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIGlmICghdGhpcy51bm1vdW50ZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLm9uRmluaXNoZWQoZmFsc2UpO1xuICAgICAgICAgICAgICAgIC8vIE4uQi4gZmlyc3QgcGFyYW0gaXMgcGFzc2VkIHRvIHBpd2lrIGFuZCBzbyBkb2Vzbid0IHdhbnQgaTE4blxuICAgICAgICAgICAgICAgIE1vZGFsLmNyZWF0ZVRyYWNrZWREaWFsb2coJ0J1ZyByZXBvcnQgc2VudCcsICcnLCBRdWVzdGlvbkRpYWxvZywge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogX3QoJ0xvZ3Mgc2VudCcpLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogX3QoJ1RoYW5rIHlvdSEnKSxcbiAgICAgICAgICAgICAgICAgICAgaGFzQ2FuY2VsQnV0dG9uOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgKGVycikgPT4ge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnVubW91bnRlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICBidXN5OiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3M6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIGVycjogX3QoXCJGYWlsZWQgdG8gc2VuZCBsb2dzOiBcIikgKyBgJHtlcnIubWVzc2FnZX1gLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBzZW5kU2VudHJ5UmVwb3J0KHRoaXMuc3RhdGUudGV4dCwgdGhpcy5zdGF0ZS5pc3N1ZVVybCwgdGhpcy5wcm9wcy5lcnJvcik7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25Eb3dubG9hZCA9IGFzeW5jICgpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGRvd25sb2FkQnVzeTogdHJ1ZSB9KTtcbiAgICAgICAgdGhpcy5kb3dubG9hZFByb2dyZXNzQ2FsbGJhY2soX3QoXCJQcmVwYXJpbmcgdG8gZG93bmxvYWQgbG9nc1wiKSk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IGRvd25sb2FkQnVnUmVwb3J0KHtcbiAgICAgICAgICAgICAgICBzZW5kTG9nczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBwcm9ncmVzc0NhbGxiYWNrOiB0aGlzLmRvd25sb2FkUHJvZ3Jlc3NDYWxsYmFjayxcbiAgICAgICAgICAgICAgICBsYWJlbDogdGhpcy5wcm9wcy5sYWJlbCxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICBkb3dubG9hZEJ1c3k6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGRvd25sb2FkUHJvZ3Jlc3M6IG51bGwsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMudW5tb3VudGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIGRvd25sb2FkQnVzeTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGRvd25sb2FkUHJvZ3Jlc3M6IF90KFwiRmFpbGVkIHRvIHNlbmQgbG9nczogXCIpICsgYCR7ZXJyLm1lc3NhZ2V9YCxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwcml2YXRlIG9uVGV4dENoYW5nZSA9IChldjogUmVhY3QuRm9ybUV2ZW50PEhUTUxUZXh0QXJlYUVsZW1lbnQ+KTogdm9pZCA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyB0ZXh0OiBldi5jdXJyZW50VGFyZ2V0LnZhbHVlIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uSXNzdWVVcmxDaGFuZ2UgPSAoZXY6IFJlYWN0LkZvcm1FdmVudDxIVE1MSW5wdXRFbGVtZW50Pik6IHZvaWQgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgaXNzdWVVcmw6IGV2LmN1cnJlbnRUYXJnZXQudmFsdWUgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgc2VuZFByb2dyZXNzQ2FsbGJhY2sgPSAocHJvZ3Jlc3M6IHN0cmluZyk6IHZvaWQgPT4ge1xuICAgICAgICBpZiAodGhpcy51bm1vdW50ZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldFN0YXRlKHsgcHJvZ3Jlc3MgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgZG93bmxvYWRQcm9ncmVzc0NhbGxiYWNrID0gKGRvd25sb2FkUHJvZ3Jlc3M6IHN0cmluZyk6IHZvaWQgPT4ge1xuICAgICAgICBpZiAodGhpcy51bm1vdW50ZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldFN0YXRlKHsgZG93bmxvYWRQcm9ncmVzcyB9KTtcbiAgICB9O1xuXG4gICAgcHVibGljIHJlbmRlcigpIHtcbiAgICAgICAgbGV0IGVycm9yID0gbnVsbDtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuZXJyKSB7XG4gICAgICAgICAgICBlcnJvciA9IDxkaXYgY2xhc3NOYW1lPVwiZXJyb3JcIj5cbiAgICAgICAgICAgICAgICB7IHRoaXMuc3RhdGUuZXJyIH1cbiAgICAgICAgICAgIDwvZGl2PjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBwcm9ncmVzcyA9IG51bGw7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmJ1c3kpIHtcbiAgICAgICAgICAgIHByb2dyZXNzID0gKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicHJvZ3Jlc3NcIj5cbiAgICAgICAgICAgICAgICAgICAgPFNwaW5uZXIgLz5cbiAgICAgICAgICAgICAgICAgICAgeyB0aGlzLnN0YXRlLnByb2dyZXNzIH0gLi4uXG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHdhcm5pbmc7XG4gICAgICAgIGlmICh3aW5kb3cuTW9kZXJuaXpyICYmIE9iamVjdC52YWx1ZXMod2luZG93Lk1vZGVybml6cikuc29tZShzdXBwb3J0ID0+IHN1cHBvcnQgPT09IGZhbHNlKSkge1xuICAgICAgICAgICAgd2FybmluZyA9IDxwPjxiPlxuICAgICAgICAgICAgICAgIHsgX3QoXCJSZW1pbmRlcjogWW91ciBicm93c2VyIGlzIHVuc3VwcG9ydGVkLCBzbyB5b3VyIGV4cGVyaWVuY2UgbWF5IGJlIHVucHJlZGljdGFibGUuXCIpIH1cbiAgICAgICAgICAgIDwvYj48L3A+O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxCYXNlRGlhbG9nXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXhfQnVnUmVwb3J0RGlhbG9nXCJcbiAgICAgICAgICAgICAgICBvbkZpbmlzaGVkPXt0aGlzLm9uQ2FuY2VsfVxuICAgICAgICAgICAgICAgIHRpdGxlPXtfdCgnU3VibWl0IGRlYnVnIGxvZ3MnKX1cbiAgICAgICAgICAgICAgICBjb250ZW50SWQ9J214X0RpYWxvZ19jb250ZW50J1xuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfRGlhbG9nX2NvbnRlbnRcIiBpZD0nbXhfRGlhbG9nX2NvbnRlbnQnPlxuICAgICAgICAgICAgICAgICAgICB7IHdhcm5pbmcgfVxuICAgICAgICAgICAgICAgICAgICA8cD5cbiAgICAgICAgICAgICAgICAgICAgICAgIHsgX3QoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJEZWJ1ZyBsb2dzIGNvbnRhaW4gYXBwbGljYXRpb24gdXNhZ2UgZGF0YSBpbmNsdWRpbmcgeW91ciBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VybmFtZSwgdGhlIElEcyBvciBhbGlhc2VzIG9mIHRoZSByb29tcyBvciBncm91cHMgeW91IFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImhhdmUgdmlzaXRlZCwgd2hpY2ggVUkgZWxlbWVudHMgeW91IGxhc3QgaW50ZXJhY3RlZCB3aXRoLCBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhbmQgdGhlIHVzZXJuYW1lcyBvZiBvdGhlciB1c2Vycy4gVGhleSBkbyBub3QgY29udGFpbiBtZXNzYWdlcy5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICkgfVxuICAgICAgICAgICAgICAgICAgICA8L3A+XG4gICAgICAgICAgICAgICAgICAgIDxwPjxiPlxuICAgICAgICAgICAgICAgICAgICAgICAgeyBfdChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkJlZm9yZSBzdWJtaXR0aW5nIGxvZ3MsIHlvdSBtdXN0IDxhPmNyZWF0ZSBhIEdpdEh1YiBpc3N1ZTwvYT4gdG8gZGVzY3JpYmUgeW91ciBwcm9ibGVtLlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTogKHN1YikgPT4gPGFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldD1cIl9ibGFua1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBocmVmPVwiaHR0cHM6Ly9naXRodWIuY29tL3ZlY3Rvci1pbS9lbGVtZW50LXdlYi9pc3N1ZXMvbmV3L2Nob29zZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgc3ViIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9hPixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgKSB9XG4gICAgICAgICAgICAgICAgICAgIDwvYj48L3A+XG5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJteF9CdWdSZXBvcnREaWFsb2dfZG93bmxvYWRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxBY2Nlc3NpYmxlQnV0dG9uIG9uQ2xpY2s9e3RoaXMub25Eb3dubG9hZH0ga2luZD1cImxpbmtcIiBkaXNhYmxlZD17dGhpcy5zdGF0ZS5kb3dubG9hZEJ1c3l9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgX3QoXCJEb3dubG9hZCBsb2dzXCIpIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvQWNjZXNzaWJsZUJ1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHsgdGhpcy5zdGF0ZS5kb3dubG9hZFByb2dyZXNzICYmIDxzcGFuPnsgdGhpcy5zdGF0ZS5kb3dubG9hZFByb2dyZXNzIH0gLi4uPC9zcGFuPiB9XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXhfQnVnUmVwb3J0RGlhbG9nX2ZpZWxkX2lucHV0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXtfdChcIkdpdEh1YiBpc3N1ZVwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uSXNzdWVVcmxDaGFuZ2V9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17dGhpcy5zdGF0ZS5pc3N1ZVVybH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiaHR0cHM6Ly9naXRodWIuY29tL3ZlY3Rvci1pbS9lbGVtZW50LXdlYi9pc3N1ZXMvLi4uXCJcbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJteF9CdWdSZXBvcnREaWFsb2dfZmllbGRfaW5wdXRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudD1cInRleHRhcmVhXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXtfdChcIk5vdGVzXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgcm93cz17NX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uVGV4dENoYW5nZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLnRleHR9XG4gICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17X3QoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJJZiB0aGVyZSBpcyBhZGRpdGlvbmFsIGNvbnRleHQgdGhhdCB3b3VsZCBoZWxwIGluIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFuYWx5c2luZyB0aGUgaXNzdWUsIHN1Y2ggYXMgd2hhdCB5b3Ugd2VyZSBkb2luZyBhdCBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aGUgdGltZSwgcm9vbSBJRHMsIHVzZXIgSURzLCBldGMuLCBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwbGVhc2UgaW5jbHVkZSB0aG9zZSB0aGluZ3MgaGVyZS5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIHsgcHJvZ3Jlc3MgfVxuICAgICAgICAgICAgICAgICAgICB7IGVycm9yIH1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8RGlhbG9nQnV0dG9ucyBwcmltYXJ5QnV0dG9uPXtfdChcIlNlbmQgbG9nc1wiKX1cbiAgICAgICAgICAgICAgICAgICAgb25QcmltYXJ5QnV0dG9uQ2xpY2s9e3RoaXMub25TdWJtaXR9XG4gICAgICAgICAgICAgICAgICAgIGZvY3VzPXt0cnVlfVxuICAgICAgICAgICAgICAgICAgICBvbkNhbmNlbD17dGhpcy5vbkNhbmNlbH1cbiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e3RoaXMuc3RhdGUuYnVzeX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9CYXNlRGlhbG9nPlxuICAgICAgICApO1xuICAgIH1cbn1cbiJdfQ==