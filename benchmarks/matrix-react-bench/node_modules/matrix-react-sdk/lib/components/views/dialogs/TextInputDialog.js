"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireWildcard(require("react"));

var _Field = _interopRequireDefault(require("../elements/Field"));

var _languageHandler = require("../../../languageHandler");

var _replaceableComponent = require("../../../utils/replaceableComponent");

var _BaseDialog = _interopRequireDefault(require("./BaseDialog"));

var _DialogButtons = _interopRequireDefault(require("../elements/DialogButtons"));

var _dec, _class, _class2, _temp;

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

let TextInputDialog = (_dec = (0, _replaceableComponent.replaceableComponent)("views.dialogs.TextInputDialog"), _dec(_class = (_temp = _class2 = class TextInputDialog extends _react.default.Component {
  constructor(props) {
    super(props);
    (0, _defineProperty2.default)(this, "field", /*#__PURE__*/(0, _react.createRef)());
    (0, _defineProperty2.default)(this, "onOk", async ev => {
      ev.preventDefault();

      if (this.props.validator) {
        this.setState({
          busy: true
        });
        await this.field.current.validate({
          allowEmpty: false
        });

        if (!this.field.current.state.valid) {
          this.field.current.focus();
          this.field.current.validate({
            allowEmpty: false,
            focused: true
          });
          this.setState({
            busy: false
          });
          return;
        }
      }

      this.props.onFinished(true, this.state.value);
    });
    (0, _defineProperty2.default)(this, "onCancel", () => {
      this.props.onFinished(false);
    });
    (0, _defineProperty2.default)(this, "onChange", ev => {
      this.setState({
        value: ev.target.value
      });
    });
    (0, _defineProperty2.default)(this, "onValidate", async fieldState => {
      const result = await this.props.validator(fieldState);
      this.setState({
        valid: result.valid
      });
      return result;
    });
    this.state = {
      value: this.props.value,
      busy: false,
      valid: false
    };
  }

  componentDidMount() {
    if (this.props.focus) {
      // Set the cursor at the end of the text input
      // this._field.current.value = this.props.value;
      this.field.current.focus();
    }
  }

  render() {
    return /*#__PURE__*/_react.default.createElement(_BaseDialog.default, {
      className: "mx_TextInputDialog",
      onFinished: this.props.onFinished,
      title: this.props.title,
      fixedWidth: this.props.fixedWidth
    }, /*#__PURE__*/_react.default.createElement("form", {
      onSubmit: this.onOk
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_Dialog_content"
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_TextInputDialog_label"
    }, /*#__PURE__*/_react.default.createElement("label", {
      htmlFor: "textinput"
    }, " ", this.props.description, " ")), /*#__PURE__*/_react.default.createElement("div", null, /*#__PURE__*/_react.default.createElement(_Field.default, {
      className: "mx_TextInputDialog_input",
      ref: this.field,
      type: "text",
      label: this.props.placeholder,
      value: this.state.value,
      onChange: this.onChange,
      onValidate: this.props.validator ? this.onValidate : undefined
    })))), /*#__PURE__*/_react.default.createElement(_DialogButtons.default, {
      primaryButton: this.state.busy ? (0, _languageHandler._t)(this.props.busyMessage) : this.props.button,
      disabled: this.state.busy,
      onPrimaryButtonClick: this.onOk,
      onCancel: this.onCancel,
      hasCancel: this.props.hasCancel
    }));
  }

}, (0, _defineProperty2.default)(_class2, "defaultProps", {
  title: "",
  value: "",
  description: "",
  busyMessage: (0, _languageHandler._td)("Loading..."),
  focus: true,
  hasCancel: true
}), _temp)) || _class);
exports.default = TextInputDialog;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZpZXdzL2RpYWxvZ3MvVGV4dElucHV0RGlhbG9nLnRzeCJdLCJuYW1lcyI6WyJUZXh0SW5wdXREaWFsb2ciLCJSZWFjdCIsIkNvbXBvbmVudCIsImNvbnN0cnVjdG9yIiwicHJvcHMiLCJldiIsInByZXZlbnREZWZhdWx0IiwidmFsaWRhdG9yIiwic2V0U3RhdGUiLCJidXN5IiwiZmllbGQiLCJjdXJyZW50IiwidmFsaWRhdGUiLCJhbGxvd0VtcHR5Iiwic3RhdGUiLCJ2YWxpZCIsImZvY3VzIiwiZm9jdXNlZCIsIm9uRmluaXNoZWQiLCJ2YWx1ZSIsInRhcmdldCIsImZpZWxkU3RhdGUiLCJyZXN1bHQiLCJjb21wb25lbnREaWRNb3VudCIsInJlbmRlciIsInRpdGxlIiwiZml4ZWRXaWR0aCIsIm9uT2siLCJkZXNjcmlwdGlvbiIsInBsYWNlaG9sZGVyIiwib25DaGFuZ2UiLCJvblZhbGlkYXRlIiwidW5kZWZpbmVkIiwiYnVzeU1lc3NhZ2UiLCJidXR0b24iLCJvbkNhbmNlbCIsImhhc0NhbmNlbCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFnQkE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7O0FBQ0E7Ozs7Ozs7O0lBdUJxQkEsZSxXQURwQixnREFBcUIsK0JBQXJCLEMsbUNBQUQsTUFDcUJBLGVBRHJCLFNBQzZDQyxlQUFNQyxTQURuRCxDQUM2RTtBQVl6RUMsRUFBQUEsV0FBVyxDQUFDQyxLQUFELEVBQWdCO0FBQ3ZCLFVBQU1BLEtBQU47QUFEdUIsOERBWFgsdUJBV1c7QUFBQSxnREFrQlosTUFBT0MsRUFBUCxJQUE4QztBQUN6REEsTUFBQUEsRUFBRSxDQUFDQyxjQUFIOztBQUNBLFVBQUksS0FBS0YsS0FBTCxDQUFXRyxTQUFmLEVBQTBCO0FBQ3RCLGFBQUtDLFFBQUwsQ0FBYztBQUFFQyxVQUFBQSxJQUFJLEVBQUU7QUFBUixTQUFkO0FBQ0EsY0FBTSxLQUFLQyxLQUFMLENBQVdDLE9BQVgsQ0FBbUJDLFFBQW5CLENBQTRCO0FBQUVDLFVBQUFBLFVBQVUsRUFBRTtBQUFkLFNBQTVCLENBQU47O0FBRUEsWUFBSSxDQUFDLEtBQUtILEtBQUwsQ0FBV0MsT0FBWCxDQUFtQkcsS0FBbkIsQ0FBeUJDLEtBQTlCLEVBQXFDO0FBQ2pDLGVBQUtMLEtBQUwsQ0FBV0MsT0FBWCxDQUFtQkssS0FBbkI7QUFDQSxlQUFLTixLQUFMLENBQVdDLE9BQVgsQ0FBbUJDLFFBQW5CLENBQTRCO0FBQUVDLFlBQUFBLFVBQVUsRUFBRSxLQUFkO0FBQXFCSSxZQUFBQSxPQUFPLEVBQUU7QUFBOUIsV0FBNUI7QUFDQSxlQUFLVCxRQUFMLENBQWM7QUFBRUMsWUFBQUEsSUFBSSxFQUFFO0FBQVIsV0FBZDtBQUNBO0FBQ0g7QUFDSjs7QUFDRCxXQUFLTCxLQUFMLENBQVdjLFVBQVgsQ0FBc0IsSUFBdEIsRUFBNEIsS0FBS0osS0FBTCxDQUFXSyxLQUF2QztBQUNILEtBaEMwQjtBQUFBLG9EQWtDUixNQUFZO0FBQzNCLFdBQUtmLEtBQUwsQ0FBV2MsVUFBWCxDQUFzQixLQUF0QjtBQUNILEtBcEMwQjtBQUFBLG9EQXNDUGIsRUFBRCxJQUE2QztBQUM1RCxXQUFLRyxRQUFMLENBQWM7QUFDVlcsUUFBQUEsS0FBSyxFQUFFZCxFQUFFLENBQUNlLE1BQUgsQ0FBVUQ7QUFEUCxPQUFkO0FBR0gsS0ExQzBCO0FBQUEsc0RBNENOLE1BQU9FLFVBQVAsSUFBK0Q7QUFDaEYsWUFBTUMsTUFBTSxHQUFHLE1BQU0sS0FBS2xCLEtBQUwsQ0FBV0csU0FBWCxDQUFxQmMsVUFBckIsQ0FBckI7QUFDQSxXQUFLYixRQUFMLENBQWM7QUFDVk8sUUFBQUEsS0FBSyxFQUFFTyxNQUFNLENBQUNQO0FBREosT0FBZDtBQUdBLGFBQU9PLE1BQVA7QUFDSCxLQWxEMEI7QUFHdkIsU0FBS1IsS0FBTCxHQUFhO0FBQ1RLLE1BQUFBLEtBQUssRUFBRSxLQUFLZixLQUFMLENBQVdlLEtBRFQ7QUFFVFYsTUFBQUEsSUFBSSxFQUFFLEtBRkc7QUFHVE0sTUFBQUEsS0FBSyxFQUFFO0FBSEUsS0FBYjtBQUtIOztBQUVNUSxFQUFBQSxpQkFBaUIsR0FBUztBQUM3QixRQUFJLEtBQUtuQixLQUFMLENBQVdZLEtBQWYsRUFBc0I7QUFDbEI7QUFDQTtBQUNBLFdBQUtOLEtBQUwsQ0FBV0MsT0FBWCxDQUFtQkssS0FBbkI7QUFDSDtBQUNKOztBQW9DTVEsRUFBQUEsTUFBTSxHQUFnQjtBQUN6Qix3QkFDSSw2QkFBQyxtQkFBRDtBQUNJLE1BQUEsU0FBUyxFQUFDLG9CQURkO0FBRUksTUFBQSxVQUFVLEVBQUUsS0FBS3BCLEtBQUwsQ0FBV2MsVUFGM0I7QUFHSSxNQUFBLEtBQUssRUFBRSxLQUFLZCxLQUFMLENBQVdxQixLQUh0QjtBQUlJLE1BQUEsVUFBVSxFQUFFLEtBQUtyQixLQUFMLENBQVdzQjtBQUozQixvQkFNSTtBQUFNLE1BQUEsUUFBUSxFQUFFLEtBQUtDO0FBQXJCLG9CQUNJO0FBQUssTUFBQSxTQUFTLEVBQUM7QUFBZixvQkFDSTtBQUFLLE1BQUEsU0FBUyxFQUFDO0FBQWYsb0JBQ0k7QUFBTyxNQUFBLE9BQU8sRUFBQztBQUFmLFlBQThCLEtBQUt2QixLQUFMLENBQVd3QixXQUF6QyxNQURKLENBREosZUFJSSx1REFDSSw2QkFBQyxjQUFEO0FBQ0ksTUFBQSxTQUFTLEVBQUMsMEJBRGQ7QUFFSSxNQUFBLEdBQUcsRUFBRSxLQUFLbEIsS0FGZDtBQUdJLE1BQUEsSUFBSSxFQUFDLE1BSFQ7QUFJSSxNQUFBLEtBQUssRUFBRSxLQUFLTixLQUFMLENBQVd5QixXQUp0QjtBQUtJLE1BQUEsS0FBSyxFQUFFLEtBQUtmLEtBQUwsQ0FBV0ssS0FMdEI7QUFNSSxNQUFBLFFBQVEsRUFBRSxLQUFLVyxRQU5uQjtBQU9JLE1BQUEsVUFBVSxFQUFFLEtBQUsxQixLQUFMLENBQVdHLFNBQVgsR0FBdUIsS0FBS3dCLFVBQTVCLEdBQXlDQztBQVB6RCxNQURKLENBSkosQ0FESixDQU5KLGVBd0JJLDZCQUFDLHNCQUFEO0FBQ0ksTUFBQSxhQUFhLEVBQUUsS0FBS2xCLEtBQUwsQ0FBV0wsSUFBWCxHQUFrQix5QkFBRyxLQUFLTCxLQUFMLENBQVc2QixXQUFkLENBQWxCLEdBQStDLEtBQUs3QixLQUFMLENBQVc4QixNQUQ3RTtBQUVJLE1BQUEsUUFBUSxFQUFFLEtBQUtwQixLQUFMLENBQVdMLElBRnpCO0FBR0ksTUFBQSxvQkFBb0IsRUFBRSxLQUFLa0IsSUFIL0I7QUFJSSxNQUFBLFFBQVEsRUFBRSxLQUFLUSxRQUpuQjtBQUtJLE1BQUEsU0FBUyxFQUFFLEtBQUsvQixLQUFMLENBQVdnQztBQUwxQixNQXhCSixDQURKO0FBa0NIOztBQW5Hd0UsQyx5REFHNUM7QUFDekJYLEVBQUFBLEtBQUssRUFBRSxFQURrQjtBQUV6Qk4sRUFBQUEsS0FBSyxFQUFFLEVBRmtCO0FBR3pCUyxFQUFBQSxXQUFXLEVBQUUsRUFIWTtBQUl6QkssRUFBQUEsV0FBVyxFQUFFLDBCQUFJLFlBQUosQ0FKWTtBQUt6QmpCLEVBQUFBLEtBQUssRUFBRSxJQUxrQjtBQU16Qm9CLEVBQUFBLFNBQVMsRUFBRTtBQU5jLEMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuQ29weXJpZ2h0IDIwMTUsIDIwMTYgT3Blbk1hcmtldCBMdGRcblxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbnlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbllvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuXG4gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cblVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbmRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxubGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4qL1xuXG5pbXBvcnQgUmVhY3QsIHsgQ2hhbmdlRXZlbnQsIGNyZWF0ZVJlZiB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vZWxlbWVudHMvRmllbGRcIjtcbmltcG9ydCB7IF90LCBfdGQgfSBmcm9tICcuLi8uLi8uLi9sYW5ndWFnZUhhbmRsZXInO1xuaW1wb3J0IHsgcmVwbGFjZWFibGVDb21wb25lbnQgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvcmVwbGFjZWFibGVDb21wb25lbnRcIjtcbmltcG9ydCB7IElGaWVsZFN0YXRlLCBJVmFsaWRhdGlvblJlc3VsdCB9IGZyb20gXCIuLi9lbGVtZW50cy9WYWxpZGF0aW9uXCI7XG5pbXBvcnQgQmFzZURpYWxvZyBmcm9tIFwiLi9CYXNlRGlhbG9nXCI7XG5pbXBvcnQgRGlhbG9nQnV0dG9ucyBmcm9tIFwiLi4vZWxlbWVudHMvRGlhbG9nQnV0dG9uc1wiO1xuaW1wb3J0IHsgSURpYWxvZ1Byb3BzIH0gZnJvbSBcIi4vSURpYWxvZ1Byb3BzXCI7XG5cbmludGVyZmFjZSBJUHJvcHMgZXh0ZW5kcyBJRGlhbG9nUHJvcHMge1xuICAgIHRpdGxlPzogc3RyaW5nO1xuICAgIGRlc2NyaXB0aW9uPzogUmVhY3QuUmVhY3ROb2RlO1xuICAgIHZhbHVlPzogc3RyaW5nO1xuICAgIHBsYWNlaG9sZGVyPzogc3RyaW5nO1xuICAgIGJ1dHRvbj86IHN0cmluZztcbiAgICBidXN5TWVzc2FnZT86IHN0cmluZzsgLy8gcGFzcyBfdGQgc3RyaW5nXG4gICAgZm9jdXM/OiBib29sZWFuO1xuICAgIGhhc0NhbmNlbD86IGJvb2xlYW47XG4gICAgdmFsaWRhdG9yPzogKGZpZWxkU3RhdGU6IElGaWVsZFN0YXRlKSA9PiBJVmFsaWRhdGlvblJlc3VsdDsgLy8gcmVzdWx0IG9mIHdpdGhWYWxpZGF0aW9uXG4gICAgZml4ZWRXaWR0aD86IGJvb2xlYW47XG59XG5cbmludGVyZmFjZSBJU3RhdGUge1xuICAgIHZhbHVlOiBzdHJpbmc7XG4gICAgYnVzeTogYm9vbGVhbjtcbiAgICB2YWxpZDogYm9vbGVhbjtcbn1cblxuQHJlcGxhY2VhYmxlQ29tcG9uZW50KFwidmlld3MuZGlhbG9ncy5UZXh0SW5wdXREaWFsb2dcIilcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRleHRJbnB1dERpYWxvZyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxJUHJvcHMsIElTdGF0ZT4ge1xuICAgIHByaXZhdGUgZmllbGQgPSBjcmVhdGVSZWY8RmllbGQ+KCk7XG5cbiAgICBwdWJsaWMgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICAgICAgdGl0bGU6IFwiXCIsXG4gICAgICAgIHZhbHVlOiBcIlwiLFxuICAgICAgICBkZXNjcmlwdGlvbjogXCJcIixcbiAgICAgICAgYnVzeU1lc3NhZ2U6IF90ZChcIkxvYWRpbmcuLi5cIiksXG4gICAgICAgIGZvY3VzOiB0cnVlLFxuICAgICAgICBoYXNDYW5jZWw6IHRydWUsXG4gICAgfTtcblxuICAgIGNvbnN0cnVjdG9yKHByb3BzOiBJUHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICB2YWx1ZTogdGhpcy5wcm9wcy52YWx1ZSxcbiAgICAgICAgICAgIGJ1c3k6IGZhbHNlLFxuICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHB1YmxpYyBjb21wb25lbnREaWRNb3VudCgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMucHJvcHMuZm9jdXMpIHtcbiAgICAgICAgICAgIC8vIFNldCB0aGUgY3Vyc29yIGF0IHRoZSBlbmQgb2YgdGhlIHRleHQgaW5wdXRcbiAgICAgICAgICAgIC8vIHRoaXMuX2ZpZWxkLmN1cnJlbnQudmFsdWUgPSB0aGlzLnByb3BzLnZhbHVlO1xuICAgICAgICAgICAgdGhpcy5maWVsZC5jdXJyZW50LmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIG9uT2sgPSBhc3luYyAoZXY6IFJlYWN0LkZvcm1FdmVudCk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBpZiAodGhpcy5wcm9wcy52YWxpZGF0b3IpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBidXN5OiB0cnVlIH0pO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5maWVsZC5jdXJyZW50LnZhbGlkYXRlKHsgYWxsb3dFbXB0eTogZmFsc2UgfSk7XG5cbiAgICAgICAgICAgIGlmICghdGhpcy5maWVsZC5jdXJyZW50LnN0YXRlLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZC5jdXJyZW50LmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZC5jdXJyZW50LnZhbGlkYXRlKHsgYWxsb3dFbXB0eTogZmFsc2UsIGZvY3VzZWQ6IHRydWUgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGJ1c3k6IGZhbHNlIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByb3BzLm9uRmluaXNoZWQodHJ1ZSwgdGhpcy5zdGF0ZS52YWx1ZSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25DYW5jZWwgPSAoKTogdm9pZCA9PiB7XG4gICAgICAgIHRoaXMucHJvcHMub25GaW5pc2hlZChmYWxzZSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25DaGFuZ2UgPSAoZXY6IENoYW5nZUV2ZW50PEhUTUxJbnB1dEVsZW1lbnQ+KTogdm9pZCA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgdmFsdWU6IGV2LnRhcmdldC52YWx1ZSxcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25WYWxpZGF0ZSA9IGFzeW5jIChmaWVsZFN0YXRlOiBJRmllbGRTdGF0ZSk6IFByb21pc2U8SVZhbGlkYXRpb25SZXN1bHQ+ID0+IHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5wcm9wcy52YWxpZGF0b3IoZmllbGRTdGF0ZSk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgdmFsaWQ6IHJlc3VsdC52YWxpZCxcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcblxuICAgIHB1YmxpYyByZW5kZXIoKTogSlNYLkVsZW1lbnQge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPEJhc2VEaWFsb2dcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJteF9UZXh0SW5wdXREaWFsb2dcIlxuICAgICAgICAgICAgICAgIG9uRmluaXNoZWQ9e3RoaXMucHJvcHMub25GaW5pc2hlZH1cbiAgICAgICAgICAgICAgICB0aXRsZT17dGhpcy5wcm9wcy50aXRsZX1cbiAgICAgICAgICAgICAgICBmaXhlZFdpZHRoPXt0aGlzLnByb3BzLmZpeGVkV2lkdGh9XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPGZvcm0gb25TdWJtaXQ9e3RoaXMub25Pa30+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfRGlhbG9nX2NvbnRlbnRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfVGV4dElucHV0RGlhbG9nX2xhYmVsXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGh0bWxGb3I9XCJ0ZXh0aW5wdXRcIj4geyB0aGlzLnByb3BzLmRlc2NyaXB0aW9uIH0gPC9sYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXhfVGV4dElucHV0RGlhbG9nX2lucHV0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmPXt0aGlzLmZpZWxkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXt0aGlzLnByb3BzLnBsYWNlaG9sZGVyfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17dGhpcy5zdGF0ZS52YWx1ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25DaGFuZ2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uVmFsaWRhdGU9e3RoaXMucHJvcHMudmFsaWRhdG9yID8gdGhpcy5vblZhbGlkYXRlIDogdW5kZWZpbmVkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9mb3JtPlxuICAgICAgICAgICAgICAgIDxEaWFsb2dCdXR0b25zXG4gICAgICAgICAgICAgICAgICAgIHByaW1hcnlCdXR0b249e3RoaXMuc3RhdGUuYnVzeSA/IF90KHRoaXMucHJvcHMuYnVzeU1lc3NhZ2UpIDogdGhpcy5wcm9wcy5idXR0b259XG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXt0aGlzLnN0YXRlLmJ1c3l9XG4gICAgICAgICAgICAgICAgICAgIG9uUHJpbWFyeUJ1dHRvbkNsaWNrPXt0aGlzLm9uT2t9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2FuY2VsPXt0aGlzLm9uQ2FuY2VsfVxuICAgICAgICAgICAgICAgICAgICBoYXNDYW5jZWw9e3RoaXMucHJvcHMuaGFzQ2FuY2VsfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8L0Jhc2VEaWFsb2c+XG4gICAgICAgICk7XG4gICAgfVxufVxuIl19