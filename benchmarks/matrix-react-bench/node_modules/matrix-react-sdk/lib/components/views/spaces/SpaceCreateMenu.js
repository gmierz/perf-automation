"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.createSpace = exports.SpaceFeedbackPrompt = exports.SpaceCreateForm = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireWildcard(require("react"));

var _classnames = _interopRequireDefault(require("classnames"));

var _event = require("matrix-js-sdk/src/@types/event");

var _partials = require("matrix-js-sdk/src/@types/partials");

var _languageHandler = require("../../../languageHandler");

var _AccessibleTooltipButton = _interopRequireDefault(require("../elements/AccessibleTooltipButton"));

var _ContextMenu = _interopRequireWildcard(require("../../structures/ContextMenu"));

var _createRoom = _interopRequireDefault(require("../../../createRoom"));

var _MatrixClientContext = _interopRequireDefault(require("../../../contexts/MatrixClientContext"));

var _SpaceBasicSettings = require("./SpaceBasicSettings");

var _AccessibleButton = _interopRequireDefault(require("../elements/AccessibleButton"));

var _Field = _interopRequireDefault(require("../elements/Field"));

var _Validation = _interopRequireDefault(require("../elements/Validation"));

var _RoomAliasField = _interopRequireDefault(require("../elements/RoomAliasField"));

var _SdkConfig = _interopRequireDefault(require("../../../SdkConfig"));

var _Modal = _interopRequireDefault(require("../../../Modal"));

var _GenericFeatureFeedbackDialog = _interopRequireDefault(require("../dialogs/GenericFeatureFeedbackDialog"));

var _SettingsStore = _interopRequireDefault(require("../../../settings/SettingsStore"));

var _dispatcher = _interopRequireDefault(require("../../../dispatcher/dispatcher"));

var _actions = require("../../../dispatcher/actions");

var _UserSettingsDialog = require("../dialogs/UserSettingsDialog");

var _Keyboard = require("../../../Keyboard");

var _logger = require("matrix-js-sdk/src/logger");

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

const createSpace = async (name, isPublic, alias, topic, avatar, createOpts = {}, otherOpts = {}) => {
  return (0, _createRoom.default)(_objectSpread({
    createOpts: _objectSpread({
      name,
      preset: isPublic ? _partials.Preset.PublicChat : _partials.Preset.PrivateChat,
      power_level_content_override: {
        // Only allow Admins to write to the timeline to prevent hidden sync spam
        events_default: 100,
        invite: isPublic ? 0 : 50
      },
      room_alias_name: isPublic && alias ? alias.substr(1, alias.indexOf(":") - 1) : undefined,
      topic
    }, createOpts),
    avatar,
    roomType: _event.RoomType.Space,
    historyVisibility: isPublic ? _partials.HistoryVisibility.WorldReadable : _partials.HistoryVisibility.Invited,
    spinner: false,
    encryption: false,
    andView: true,
    inlineErrors: true
  }, otherOpts));
};

exports.createSpace = createSpace;

const SpaceCreateMenuType = ({
  title,
  description,
  className,
  onClick
}) => {
  return /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
    className: (0, _classnames.default)("mx_SpaceCreateMenuType", className),
    onClick: onClick
  }, /*#__PURE__*/_react.default.createElement("h3", null, title), /*#__PURE__*/_react.default.createElement("span", null, description));
};

var Visibility;

(function (Visibility) {
  Visibility[Visibility["Public"] = 0] = "Public";
  Visibility[Visibility["Private"] = 1] = "Private";
})(Visibility || (Visibility = {}));

const spaceNameValidator = (0, _Validation.default)({
  rules: [{
    key: "required",
    test: async ({
      value
    }) => !!value,
    invalid: () => (0, _languageHandler._t)("Please enter a name for the space")
  }]
});

const nameToLocalpart = name => {
  return name.trim().toLowerCase().replace(/\s+/g, "-").replace(/[^a-z0-9_-]+/gi, "");
}; // XXX: Temporary for the Spaces release only


const SpaceFeedbackPrompt = ({
  onClick
}) => {
  if (!_SdkConfig.default.get().bug_report_endpoint_url) return null;
  return /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SpaceFeedbackPrompt"
  }, /*#__PURE__*/_react.default.createElement("span", {
    className: "mx_SpaceFeedbackPrompt_text"
  }, (0, _languageHandler._t)("Spaces are a new feature.")), /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
    kind: "link",
    onClick: () => {
      if (onClick) onClick();

      _Modal.default.createTrackedDialog("Spaces Feedback", "", _GenericFeatureFeedbackDialog.default, {
        title: (0, _languageHandler._t)("Spaces feedback"),
        subheading: (0, _languageHandler._t)("Thank you for trying Spaces. " + "Your feedback will help inform the next versions."),
        rageshakeLabel: "spaces-feedback",
        rageshakeData: Object.fromEntries(["Spaces.allRoomsInHome", "Spaces.enabledMetaSpaces"].map(k => [k, _SettingsStore.default.getValue(k)]))
      });
    }
  }, (0, _languageHandler._t)("Give feedback.")));
};

exports.SpaceFeedbackPrompt = SpaceFeedbackPrompt;

const SpaceCreateForm = ({
  busy,
  onSubmit,
  avatarUrl,
  setAvatar,
  name,
  setName,
  nameFieldRef,
  alias,
  aliasFieldRef,
  setAlias,
  showAliasField,
  topic,
  setTopic,
  children
}) => {
  const cli = (0, _react.useContext)(_MatrixClientContext.default);
  const domain = cli.getDomain();

  const onKeyDown = ev => {
    if (ev.key === _Keyboard.Key.ENTER) {
      onSubmit(ev);
    }
  };

  return /*#__PURE__*/_react.default.createElement("form", {
    className: "mx_SpaceBasicSettings",
    onSubmit: onSubmit
  }, /*#__PURE__*/_react.default.createElement(_SpaceBasicSettings.SpaceAvatar, {
    avatarUrl: avatarUrl,
    setAvatar: setAvatar,
    avatarDisabled: busy
  }), /*#__PURE__*/_react.default.createElement(_Field.default, {
    name: "spaceName",
    label: (0, _languageHandler._t)("Name"),
    autoFocus: true,
    value: name,
    onChange: ev => {
      const newName = ev.target.value;

      if (!alias || alias === `#${nameToLocalpart(name)}:${domain}`) {
        var _aliasFieldRef$curren;

        setAlias(`#${nameToLocalpart(newName)}:${domain}`);
        (_aliasFieldRef$curren = aliasFieldRef.current) === null || _aliasFieldRef$curren === void 0 ? void 0 : _aliasFieldRef$curren.validate({
          allowEmpty: true
        });
      }

      setName(newName);
    },
    onKeyDown: onKeyDown,
    ref: nameFieldRef,
    onValidate: spaceNameValidator,
    disabled: busy,
    autoComplete: "off"
  }), showAliasField ? /*#__PURE__*/_react.default.createElement(_RoomAliasField.default, {
    ref: aliasFieldRef,
    onChange: setAlias,
    domain: domain,
    value: alias,
    placeholder: name ? nameToLocalpart(name) : (0, _languageHandler._t)("e.g. my-space"),
    label: (0, _languageHandler._t)("Address"),
    disabled: busy,
    onKeyDown: onKeyDown
  }) : null, /*#__PURE__*/_react.default.createElement(_Field.default, {
    name: "spaceTopic",
    element: "textarea",
    label: (0, _languageHandler._t)("Description"),
    value: topic,
    onChange: ev => setTopic(ev.target.value),
    rows: 3,
    disabled: busy
  }), children);
};

exports.SpaceCreateForm = SpaceCreateForm;

const SpaceCreateMenu = ({
  onFinished
}) => {
  const [visibility, setVisibility] = (0, _react.useState)(null);
  const [busy, setBusy] = (0, _react.useState)(false);
  const [name, setName] = (0, _react.useState)("");
  const spaceNameField = (0, _react.useRef)();
  const [alias, setAlias] = (0, _react.useState)("");
  const spaceAliasField = (0, _react.useRef)();
  const [avatar, setAvatar] = (0, _react.useState)(null);
  const [topic, setTopic] = (0, _react.useState)("");

  const onSpaceCreateClick = async e => {
    e.preventDefault();
    if (busy) return;
    setBusy(true); // require & validate the space name field

    if (!(await spaceNameField.current.validate({
      allowEmpty: false
    }))) {
      spaceNameField.current.focus();
      spaceNameField.current.validate({
        allowEmpty: false,
        focused: true
      });
      setBusy(false);
      return;
    }

    if (visibility === Visibility.Public && !(await spaceAliasField.current.validate({
      allowEmpty: false
    }))) {
      spaceAliasField.current.focus();
      spaceAliasField.current.validate({
        allowEmpty: false,
        focused: true
      });
      setBusy(false);
      return;
    }

    try {
      await createSpace(name, visibility === Visibility.Public, alias, topic, avatar);
      onFinished();
    } catch (e) {
      _logger.logger.error(e);
    }
  };

  let body;

  if (visibility === null) {
    const onCreateSpaceFromCommunityClick = () => {
      _dispatcher.default.dispatch({
        action: _actions.Action.ViewUserSettings,
        initialTabId: _UserSettingsDialog.UserTab.Preferences
      });

      onFinished();
    };

    body = /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement("h2", null, (0, _languageHandler._t)("Create a space")), /*#__PURE__*/_react.default.createElement("p", null, (0, _languageHandler._t)("Spaces are a new way to group rooms and people."), "\xA0", (0, _languageHandler._t)("What kind of Space do you want to create?"), "\xA0", (0, _languageHandler._t)("You can change this later.")), /*#__PURE__*/_react.default.createElement(SpaceCreateMenuType, {
      title: (0, _languageHandler._t)("Public"),
      description: (0, _languageHandler._t)("Open space for anyone, best for communities"),
      className: "mx_SpaceCreateMenuType_public",
      onClick: () => setVisibility(Visibility.Public)
    }), /*#__PURE__*/_react.default.createElement(SpaceCreateMenuType, {
      title: (0, _languageHandler._t)("Private"),
      description: (0, _languageHandler._t)("Invite only, best for yourself or teams"),
      className: "mx_SpaceCreateMenuType_private",
      onClick: () => setVisibility(Visibility.Private)
    }), /*#__PURE__*/_react.default.createElement("p", null, (0, _languageHandler._t)("You can also make Spaces from <a>communities</a>.", {}, {
      a: sub => /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
        kind: "link",
        onClick: onCreateSpaceFromCommunityClick
      }, sub)
    }), /*#__PURE__*/_react.default.createElement("br", null), (0, _languageHandler._t)("To join a space you'll need an invite.")), /*#__PURE__*/_react.default.createElement(SpaceFeedbackPrompt, {
      onClick: onFinished
    }));
  } else {
    body = /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement(_AccessibleTooltipButton.default, {
      className: "mx_SpaceCreateMenu_back",
      onClick: () => setVisibility(null),
      title: (0, _languageHandler._t)("Go back")
    }), /*#__PURE__*/_react.default.createElement("h2", null, visibility === Visibility.Public ? (0, _languageHandler._t)("Your public space") : (0, _languageHandler._t)("Your private space")), /*#__PURE__*/_react.default.createElement("p", null, (0, _languageHandler._t)("Add some details to help people recognise it."), " ", (0, _languageHandler._t)("You can change these anytime.")), /*#__PURE__*/_react.default.createElement(SpaceCreateForm, {
      busy: busy,
      onSubmit: onSpaceCreateClick,
      setAvatar: setAvatar,
      name: name,
      setName: setName,
      nameFieldRef: spaceNameField,
      topic: topic,
      setTopic: setTopic,
      alias: alias,
      setAlias: setAlias,
      showAliasField: visibility === Visibility.Public,
      aliasFieldRef: spaceAliasField
    }), /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
      kind: "primary",
      onClick: onSpaceCreateClick,
      disabled: busy
    }, busy ? (0, _languageHandler._t)("Creating...") : (0, _languageHandler._t)("Create")));
  }

  return /*#__PURE__*/_react.default.createElement(_ContextMenu.default, {
    left: 72,
    top: 62,
    chevronOffset: 0,
    chevronFace: _ContextMenu.ChevronFace.None,
    onFinished: onFinished,
    wrapperClassName: "mx_SpaceCreateMenu_wrapper",
    managed: false
  }, body);
};

var _default = SpaceCreateMenu;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZpZXdzL3NwYWNlcy9TcGFjZUNyZWF0ZU1lbnUudHN4Il0sIm5hbWVzIjpbImNyZWF0ZVNwYWNlIiwibmFtZSIsImlzUHVibGljIiwiYWxpYXMiLCJ0b3BpYyIsImF2YXRhciIsImNyZWF0ZU9wdHMiLCJvdGhlck9wdHMiLCJwcmVzZXQiLCJQcmVzZXQiLCJQdWJsaWNDaGF0IiwiUHJpdmF0ZUNoYXQiLCJwb3dlcl9sZXZlbF9jb250ZW50X292ZXJyaWRlIiwiZXZlbnRzX2RlZmF1bHQiLCJpbnZpdGUiLCJyb29tX2FsaWFzX25hbWUiLCJzdWJzdHIiLCJpbmRleE9mIiwidW5kZWZpbmVkIiwicm9vbVR5cGUiLCJSb29tVHlwZSIsIlNwYWNlIiwiaGlzdG9yeVZpc2liaWxpdHkiLCJIaXN0b3J5VmlzaWJpbGl0eSIsIldvcmxkUmVhZGFibGUiLCJJbnZpdGVkIiwic3Bpbm5lciIsImVuY3J5cHRpb24iLCJhbmRWaWV3IiwiaW5saW5lRXJyb3JzIiwiU3BhY2VDcmVhdGVNZW51VHlwZSIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJjbGFzc05hbWUiLCJvbkNsaWNrIiwiVmlzaWJpbGl0eSIsInNwYWNlTmFtZVZhbGlkYXRvciIsInJ1bGVzIiwia2V5IiwidGVzdCIsInZhbHVlIiwiaW52YWxpZCIsIm5hbWVUb0xvY2FscGFydCIsInRyaW0iLCJ0b0xvd2VyQ2FzZSIsInJlcGxhY2UiLCJTcGFjZUZlZWRiYWNrUHJvbXB0IiwiU2RrQ29uZmlnIiwiZ2V0IiwiYnVnX3JlcG9ydF9lbmRwb2ludF91cmwiLCJNb2RhbCIsImNyZWF0ZVRyYWNrZWREaWFsb2ciLCJHZW5lcmljRmVhdHVyZUZlZWRiYWNrRGlhbG9nIiwic3ViaGVhZGluZyIsInJhZ2VzaGFrZUxhYmVsIiwicmFnZXNoYWtlRGF0YSIsIk9iamVjdCIsImZyb21FbnRyaWVzIiwibWFwIiwiayIsIlNldHRpbmdzU3RvcmUiLCJnZXRWYWx1ZSIsIlNwYWNlQ3JlYXRlRm9ybSIsImJ1c3kiLCJvblN1Ym1pdCIsImF2YXRhclVybCIsInNldEF2YXRhciIsInNldE5hbWUiLCJuYW1lRmllbGRSZWYiLCJhbGlhc0ZpZWxkUmVmIiwic2V0QWxpYXMiLCJzaG93QWxpYXNGaWVsZCIsInNldFRvcGljIiwiY2hpbGRyZW4iLCJjbGkiLCJNYXRyaXhDbGllbnRDb250ZXh0IiwiZG9tYWluIiwiZ2V0RG9tYWluIiwib25LZXlEb3duIiwiZXYiLCJLZXkiLCJFTlRFUiIsIm5ld05hbWUiLCJ0YXJnZXQiLCJjdXJyZW50IiwidmFsaWRhdGUiLCJhbGxvd0VtcHR5IiwiU3BhY2VDcmVhdGVNZW51Iiwib25GaW5pc2hlZCIsInZpc2liaWxpdHkiLCJzZXRWaXNpYmlsaXR5Iiwic2V0QnVzeSIsInNwYWNlTmFtZUZpZWxkIiwic3BhY2VBbGlhc0ZpZWxkIiwib25TcGFjZUNyZWF0ZUNsaWNrIiwiZSIsInByZXZlbnREZWZhdWx0IiwiZm9jdXMiLCJmb2N1c2VkIiwiUHVibGljIiwibG9nZ2VyIiwiZXJyb3IiLCJib2R5Iiwib25DcmVhdGVTcGFjZUZyb21Db21tdW5pdHlDbGljayIsImRlZmF1bHREaXNwYXRjaGVyIiwiZGlzcGF0Y2giLCJhY3Rpb24iLCJBY3Rpb24iLCJWaWV3VXNlclNldHRpbmdzIiwiaW5pdGlhbFRhYklkIiwiVXNlclRhYiIsIlByZWZlcmVuY2VzIiwiUHJpdmF0ZSIsImEiLCJzdWIiLCJDaGV2cm9uRmFjZSIsIk5vbmUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBZ0JBOztBQUNBOztBQUNBOztBQUVBOztBQUVBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBOzs7Ozs7Ozs7O0FBRU8sTUFBTUEsV0FBVyxHQUFHLE9BQ3ZCQyxJQUR1QixFQUV2QkMsUUFGdUIsRUFHdkJDLEtBSHVCLEVBSXZCQyxLQUp1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O0FBUUksTUFBQSxRQUFRLEVBQUVvRSxRQVJkO0FBU0ksTUFBQSxLQUFLLEVBQUVyRSxLQVRYO0FBVUksTUFBQSxRQUFRLEVBQUVtRSxRQVZkO0FBV0ksTUFBQSxjQUFjLEVBQUVtQixVQUFVLEtBQUt0RCxVQUFVLENBQUNnRSxNQVg5QztBQVlJLE1BQUEsYUFBYSxFQUFFTjtBQVpuQixNQXBCRyxlQW1DSCw2QkFBQyx5QkFBRDtBQUFrQixNQUFBLElBQUksRUFBQyxTQUF2QjtBQUFpQyxNQUFBLE9BQU8sRUFBRUMsa0JBQTFDO0FBQThELE1BQUEsUUFBUSxFQUFFL0I7QUFBeEUsT0FDTUEsSUFBSSxHQUFHLHlCQUFHLGFBQUgsQ0FBSCxHQUF1Qix5QkFBRyxRQUFILENBRGpDLENBbkNHLENBQVA7QUF1Q0g7O0FBRUQsc0JBQU8sNkJBQUMsb0JBQUQ7QUFDSCxJQUFBLElBQUksRUFBRSxFQURIO0FBRUgsSUFBQSxHQUFHLEVBQUUsRUFGRjtBQUdILElBQUEsYUFBYSxFQUFFLENBSFo7QUFJSCxJQUFBLFdBQVcsRUFBRW9ELHlCQUFZQyxJQUp0QjtBQUtILElBQUEsVUFBVSxFQUFFNUIsVUFMVDtBQU1ILElBQUEsZ0JBQWdCLEVBQUMsNEJBTmQ7QUFPSCxJQUFBLE9BQU8sRUFBRTtBQVBOLEtBU0RjLElBVEMsQ0FBUDtBQVdILENBaEpEOztlQWtKZWYsZSIsInNvdXJjZXNDb250ZW50IjpbIi8qXG5Db3B5cmlnaHQgMjAyMSBUaGUgTWF0cml4Lm9yZyBGb3VuZGF0aW9uIEMuSS5DLlxuXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xueW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG5cbiAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcblxuVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG5TZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG5saW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiovXG5cbmltcG9ydCBSZWFjdCwgeyBDb21wb25lbnRQcm9wcywgUmVmT2JqZWN0LCBTeW50aGV0aWNFdmVudCwgS2V5Ym9hcmRFdmVudCwgdXNlQ29udGV4dCwgdXNlUmVmLCB1c2VTdGF0ZSB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IGNsYXNzTmFtZXMgZnJvbSBcImNsYXNzbmFtZXNcIjtcbmltcG9ydCB7IFJvb21UeXBlIH0gZnJvbSBcIm1hdHJpeC1qcy1zZGsvc3JjL0B0eXBlcy9ldmVudFwiO1xuaW1wb3J0IHsgSUNyZWF0ZVJvb21PcHRzIH0gZnJvbSBcIm1hdHJpeC1qcy1zZGsvc3JjL0B0eXBlcy9yZXF1ZXN0c1wiO1xuaW1wb3J0IHsgSGlzdG9yeVZpc2liaWxpdHksIFByZXNldCB9IGZyb20gXCJtYXRyaXgtanMtc2RrL3NyYy9AdHlwZXMvcGFydGlhbHNcIjtcblxuaW1wb3J0IHsgX3QgfSBmcm9tIFwiLi4vLi4vLi4vbGFuZ3VhZ2VIYW5kbGVyXCI7XG5pbXBvcnQgQWNjZXNzaWJsZVRvb2x0aXBCdXR0b24gZnJvbSBcIi4uL2VsZW1lbnRzL0FjY2Vzc2libGVUb29sdGlwQnV0dG9uXCI7XG5pbXBvcnQgQ29udGV4dE1lbnUsIHsgQ2hldnJvbkZhY2UgfSBmcm9tIFwiLi4vLi4vc3RydWN0dXJlcy9Db250ZXh0TWVudVwiO1xuaW1wb3J0IGNyZWF0ZVJvb20sIHsgSU9wdHMgYXMgSUNyZWF0ZU9wdHMgfSBmcm9tIFwiLi4vLi4vLi4vY3JlYXRlUm9vbVwiO1xuaW1wb3J0IE1hdHJpeENsaWVudENvbnRleHQgZnJvbSBcIi4uLy4uLy4uL2NvbnRleHRzL01hdHJpeENsaWVudENvbnRleHRcIjtcbmltcG9ydCBTcGFjZUJhc2ljU2V0dGluZ3MsIHsgU3BhY2VBdmF0YXIgfSBmcm9tIFwiLi9TcGFjZUJhc2ljU2V0dGluZ3NcIjtcbmltcG9ydCBBY2Nlc3NpYmxlQnV0dG9uIGZyb20gXCIuLi9lbGVtZW50cy9BY2Nlc3NpYmxlQnV0dG9uXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcIi4uL2VsZW1lbnRzL0ZpZWxkXCI7XG5pbXBvcnQgd2l0aFZhbGlkYXRpb24gZnJvbSBcIi4uL2VsZW1lbnRzL1ZhbGlkYXRpb25cIjtcbmltcG9ydCBSb29tQWxpYXNGaWVsZCBmcm9tIFwiLi4vZWxlbWVudHMvUm9vbUFsaWFzRmllbGRcIjtcbmltcG9ydCBTZGtDb25maWcgZnJvbSBcIi4uLy4uLy4uL1Nka0NvbmZpZ1wiO1xuaW1wb3J0IE1vZGFsIGZyb20gXCIuLi8uLi8uLi9Nb2RhbFwiO1xuaW1wb3J0IEdlbmVyaWNGZWF0dXJlRmVlZGJhY2tEaWFsb2cgZnJvbSBcIi4uL2RpYWxvZ3MvR2VuZXJpY0ZlYXR1cmVGZWVkYmFja0RpYWxvZ1wiO1xuaW1wb3J0IFNldHRpbmdzU3RvcmUgZnJvbSBcIi4uLy4uLy4uL3NldHRpbmdzL1NldHRpbmdzU3RvcmVcIjtcbmltcG9ydCBkZWZhdWx0RGlzcGF0Y2hlciBmcm9tIFwiLi4vLi4vLi4vZGlzcGF0Y2hlci9kaXNwYXRjaGVyXCI7XG5pbXBvcnQgeyBBY3Rpb24gfSBmcm9tIFwiLi4vLi4vLi4vZGlzcGF0Y2hlci9hY3Rpb25zXCI7XG5pbXBvcnQgeyBVc2VyVGFiIH0gZnJvbSBcIi4uL2RpYWxvZ3MvVXNlclNldHRpbmdzRGlhbG9nXCI7XG5pbXBvcnQgeyBLZXkgfSBmcm9tIFwiLi4vLi4vLi4vS2V5Ym9hcmRcIjtcblxuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSBcIm1hdHJpeC1qcy1zZGsvc3JjL2xvZ2dlclwiO1xuXG5leHBvcnQgY29uc3QgY3JlYXRlU3BhY2UgPSBhc3luYyAoXG4gICAgbmFtZTogc3RyaW5nLFxuICAgIGlzUHVibGljOiBib29sZWFuLFxuICAgIGFsaWFzPzogc3RyaW5nLFxuICAgIHRvcGljPzogc3RyaW5nLFxuICAgIGF2YXRhcj86IHN0cmluZyB8IEZpbGUsXG4gICAgY3JlYXRlT3B0czogUGFydGlhbDxJQ3JlYXRlUm9vbU9wdHM+ID0ge30sXG4gICAgb3RoZXJPcHRzOiBQYXJ0aWFsPE9taXQ8SUNyZWF0ZU9wdHMsIFwiY3JlYXRlT3B0c1wiPj4gPSB7fSxcbikgPT4ge1xuICAgIHJldHVybiBjcmVhdGVSb29tKHtcbiAgICAgICAgY3JlYXRlT3B0czoge1xuICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgIHByZXNldDogaXNQdWJsaWMgPyBQcmVzZXQuUHVibGljQ2hhdCA6IFByZXNldC5Qcml2YXRlQ2hhdCxcbiAgICAgICAgICAgIHBvd2VyX2xldmVsX2NvbnRlbnRfb3ZlcnJpZGU6IHtcbiAgICAgICAgICAgICAgICAvLyBPbmx5IGFsbG93IEFkbWlucyB0byB3cml0ZSB0byB0aGUgdGltZWxpbmUgdG8gcHJldmVudCBoaWRkZW4gc3luYyBzcGFtXG4gICAgICAgICAgICAgICAgZXZlbnRzX2RlZmF1bHQ6IDEwMCxcbiAgICAgICAgICAgICAgICBpbnZpdGU6IGlzUHVibGljID8gMCA6IDUwLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJvb21fYWxpYXNfbmFtZTogaXNQdWJsaWMgJiYgYWxpYXMgPyBhbGlhcy5zdWJzdHIoMSwgYWxpYXMuaW5kZXhPZihcIjpcIikgLSAxKSA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIHRvcGljLFxuICAgICAgICAgICAgLi4uY3JlYXRlT3B0cyxcbiAgICAgICAgfSxcbiAgICAgICAgYXZhdGFyLFxuICAgICAgICByb29tVHlwZTogUm9vbVR5cGUuU3BhY2UsXG4gICAgICAgIGhpc3RvcnlWaXNpYmlsaXR5OiBpc1B1YmxpYyA/IEhpc3RvcnlWaXNpYmlsaXR5LldvcmxkUmVhZGFibGUgOiBIaXN0b3J5VmlzaWJpbGl0eS5JbnZpdGVkLFxuICAgICAgICBzcGlubmVyOiBmYWxzZSxcbiAgICAgICAgZW5jcnlwdGlvbjogZmFsc2UsXG4gICAgICAgIGFuZFZpZXc6IHRydWUsXG4gICAgICAgIGlubGluZUVycm9yczogdHJ1ZSxcbiAgICAgICAgLi4ub3RoZXJPcHRzLFxuICAgIH0pO1xufTtcblxuY29uc3QgU3BhY2VDcmVhdGVNZW51VHlwZSA9ICh7IHRpdGxlLCBkZXNjcmlwdGlvbiwgY2xhc3NOYW1lLCBvbkNsaWNrIH0pID0+IHtcbiAgICByZXR1cm4gKFxuICAgICAgICA8QWNjZXNzaWJsZUJ1dHRvbiBjbGFzc05hbWU9e2NsYXNzTmFtZXMoXCJteF9TcGFjZUNyZWF0ZU1lbnVUeXBlXCIsIGNsYXNzTmFtZSl9IG9uQ2xpY2s9e29uQ2xpY2t9PlxuICAgICAgICAgICAgPGgzPnsgdGl0bGUgfTwvaDM+XG4gICAgICAgICAgICA8c3Bhbj57IGRlc2NyaXB0aW9uIH08L3NwYW4+XG4gICAgICAgIDwvQWNjZXNzaWJsZUJ1dHRvbj5cbiAgICApO1xufTtcblxuZW51bSBWaXNpYmlsaXR5IHtcbiAgICBQdWJsaWMsXG4gICAgUHJpdmF0ZSxcbn1cblxuY29uc3Qgc3BhY2VOYW1lVmFsaWRhdG9yID0gd2l0aFZhbGlkYXRpb24oe1xuICAgIHJ1bGVzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleTogXCJyZXF1aXJlZFwiLFxuICAgICAgICAgICAgdGVzdDogYXN5bmMgKHsgdmFsdWUgfSkgPT4gISF2YWx1ZSxcbiAgICAgICAgICAgIGludmFsaWQ6ICgpID0+IF90KFwiUGxlYXNlIGVudGVyIGEgbmFtZSBmb3IgdGhlIHNwYWNlXCIpLFxuICAgICAgICB9LFxuICAgIF0sXG59KTtcblxuY29uc3QgbmFtZVRvTG9jYWxwYXJ0ID0gKG5hbWU6IHN0cmluZyk6IHN0cmluZyA9PiB7XG4gICAgcmV0dXJuIG5hbWUudHJpbSgpLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXFxzKy9nLCBcIi1cIikucmVwbGFjZSgvW15hLXowLTlfLV0rL2dpLCBcIlwiKTtcbn07XG5cbi8vIFhYWDogVGVtcG9yYXJ5IGZvciB0aGUgU3BhY2VzIHJlbGVhc2Ugb25seVxuZXhwb3J0IGNvbnN0IFNwYWNlRmVlZGJhY2tQcm9tcHQgPSAoeyBvbkNsaWNrIH06IHsgb25DbGljaz86ICgpID0+IHZvaWQgfSkgPT4ge1xuICAgIGlmICghU2RrQ29uZmlnLmdldCgpLmJ1Z19yZXBvcnRfZW5kcG9pbnRfdXJsKSByZXR1cm4gbnVsbDtcblxuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cIm14X1NwYWNlRmVlZGJhY2tQcm9tcHRcIj5cbiAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwibXhfU3BhY2VGZWVkYmFja1Byb21wdF90ZXh0XCI+eyBfdChcIlNwYWNlcyBhcmUgYSBuZXcgZmVhdHVyZS5cIikgfTwvc3Bhbj5cbiAgICAgICAgPEFjY2Vzc2libGVCdXR0b25cbiAgICAgICAgICAgIGtpbmQ9XCJsaW5rXCJcbiAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAob25DbGljaykgb25DbGljaygpO1xuICAgICAgICAgICAgICAgIE1vZGFsLmNyZWF0ZVRyYWNrZWREaWFsb2coXCJTcGFjZXMgRmVlZGJhY2tcIiwgXCJcIiwgR2VuZXJpY0ZlYXR1cmVGZWVkYmFja0RpYWxvZywge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogX3QoXCJTcGFjZXMgZmVlZGJhY2tcIiksXG4gICAgICAgICAgICAgICAgICAgIHN1YmhlYWRpbmc6IF90KFwiVGhhbmsgeW91IGZvciB0cnlpbmcgU3BhY2VzLiBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIllvdXIgZmVlZGJhY2sgd2lsbCBoZWxwIGluZm9ybSB0aGUgbmV4dCB2ZXJzaW9ucy5cIiksXG4gICAgICAgICAgICAgICAgICAgIHJhZ2VzaGFrZUxhYmVsOiBcInNwYWNlcy1mZWVkYmFja1wiLFxuICAgICAgICAgICAgICAgICAgICByYWdlc2hha2VEYXRhOiBPYmplY3QuZnJvbUVudHJpZXMoW1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJTcGFjZXMuYWxsUm9vbXNJbkhvbWVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiU3BhY2VzLmVuYWJsZWRNZXRhU3BhY2VzXCIsXG4gICAgICAgICAgICAgICAgICAgIF0ubWFwKGsgPT4gW2ssIFNldHRpbmdzU3RvcmUuZ2V0VmFsdWUoayldKSksXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9fVxuICAgICAgICA+XG4gICAgICAgICAgICB7IF90KFwiR2l2ZSBmZWVkYmFjay5cIikgfVxuICAgICAgICA8L0FjY2Vzc2libGVCdXR0b24+XG4gICAgPC9kaXY+O1xufTtcblxudHlwZSBCUHJvcHMgPSBPbWl0PENvbXBvbmVudFByb3BzPHR5cGVvZiBTcGFjZUJhc2ljU2V0dGluZ3M+LCBcIm5hbWVEaXNhYmxlZFwiIHwgXCJ0b3BpY0Rpc2FibGVkXCIgfCBcImF2YXRhckRpc2FibGVkXCI+O1xuaW50ZXJmYWNlIElTcGFjZUNyZWF0ZUZvcm1Qcm9wcyBleHRlbmRzIEJQcm9wcyB7XG4gICAgYnVzeTogYm9vbGVhbjtcbiAgICBhbGlhczogc3RyaW5nO1xuICAgIG5hbWVGaWVsZFJlZjogUmVmT2JqZWN0PEZpZWxkPjtcbiAgICBhbGlhc0ZpZWxkUmVmOiBSZWZPYmplY3Q8Um9vbUFsaWFzRmllbGQ+O1xuICAgIHNob3dBbGlhc0ZpZWxkPzogYm9vbGVhbjtcbiAgICBvblN1Ym1pdChlOiBTeW50aGV0aWNFdmVudCk6IHZvaWQ7XG4gICAgc2V0QWxpYXMoYWxpYXM6IHN0cmluZyk6IHZvaWQ7XG59XG5cbmV4cG9ydCBjb25zdCBTcGFjZUNyZWF0ZUZvcm06IFJlYWN0LkZDPElTcGFjZUNyZWF0ZUZvcm1Qcm9wcz4gPSAoe1xuICAgIGJ1c3ksXG4gICAgb25TdWJtaXQsXG4gICAgYXZhdGFyVXJsLFxuICAgIHNldEF2YXRhcixcbiAgICBuYW1lLFxuICAgIHNldE5hbWUsXG4gICAgbmFtZUZpZWxkUmVmLFxuICAgIGFsaWFzLFxuICAgIGFsaWFzRmllbGRSZWYsXG4gICAgc2V0QWxpYXMsXG4gICAgc2hvd0FsaWFzRmllbGQsXG4gICAgdG9waWMsXG4gICAgc2V0VG9waWMsXG4gICAgY2hpbGRyZW4sXG59KSA9PiB7XG4gICAgY29uc3QgY2xpID0gdXNlQ29udGV4dChNYXRyaXhDbGllbnRDb250ZXh0KTtcbiAgICBjb25zdCBkb21haW4gPSBjbGkuZ2V0RG9tYWluKCk7XG5cbiAgICBjb25zdCBvbktleURvd24gPSAoZXY6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgICAgaWYgKGV2LmtleSA9PT0gS2V5LkVOVEVSKSB7XG4gICAgICAgICAgICBvblN1Ym1pdChldik7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcmV0dXJuIDxmb3JtIGNsYXNzTmFtZT1cIm14X1NwYWNlQmFzaWNTZXR0aW5nc1wiIG9uU3VibWl0PXtvblN1Ym1pdH0+XG4gICAgICAgIDxTcGFjZUF2YXRhciBhdmF0YXJVcmw9e2F2YXRhclVybH0gc2V0QXZhdGFyPXtzZXRBdmF0YXJ9IGF2YXRhckRpc2FibGVkPXtidXN5fSAvPlxuXG4gICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgbmFtZT1cInNwYWNlTmFtZVwiXG4gICAgICAgICAgICBsYWJlbD17X3QoXCJOYW1lXCIpfVxuICAgICAgICAgICAgYXV0b0ZvY3VzPXt0cnVlfVxuICAgICAgICAgICAgdmFsdWU9e25hbWV9XG4gICAgICAgICAgICBvbkNoYW5nZT17ZXYgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld05hbWUgPSBldi50YXJnZXQudmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKCFhbGlhcyB8fCBhbGlhcyA9PT0gYCMke25hbWVUb0xvY2FscGFydChuYW1lKX06JHtkb21haW59YCkge1xuICAgICAgICAgICAgICAgICAgICBzZXRBbGlhcyhgIyR7bmFtZVRvTG9jYWxwYXJ0KG5ld05hbWUpfToke2RvbWFpbn1gKTtcbiAgICAgICAgICAgICAgICAgICAgYWxpYXNGaWVsZFJlZi5jdXJyZW50Py52YWxpZGF0ZSh7IGFsbG93RW1wdHk6IHRydWUgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNldE5hbWUobmV3TmFtZSk7XG4gICAgICAgICAgICB9fVxuICAgICAgICAgICAgb25LZXlEb3duPXtvbktleURvd259XG4gICAgICAgICAgICByZWY9e25hbWVGaWVsZFJlZn1cbiAgICAgICAgICAgIG9uVmFsaWRhdGU9e3NwYWNlTmFtZVZhbGlkYXRvcn1cbiAgICAgICAgICAgIGRpc2FibGVkPXtidXN5fVxuICAgICAgICAgICAgYXV0b0NvbXBsZXRlPVwib2ZmXCJcbiAgICAgICAgLz5cblxuICAgICAgICB7IHNob3dBbGlhc0ZpZWxkXG4gICAgICAgICAgICA/IDxSb29tQWxpYXNGaWVsZFxuICAgICAgICAgICAgICAgIHJlZj17YWxpYXNGaWVsZFJlZn1cbiAgICAgICAgICAgICAgICBvbkNoYW5nZT17c2V0QWxpYXN9XG4gICAgICAgICAgICAgICAgZG9tYWluPXtkb21haW59XG4gICAgICAgICAgICAgICAgdmFsdWU9e2FsaWFzfVxuICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXtuYW1lID8gbmFtZVRvTG9jYWxwYXJ0KG5hbWUpIDogX3QoXCJlLmcuIG15LXNwYWNlXCIpfVxuICAgICAgICAgICAgICAgIGxhYmVsPXtfdChcIkFkZHJlc3NcIil9XG4gICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2J1c3l9XG4gICAgICAgICAgICAgICAgb25LZXlEb3duPXtvbktleURvd259XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgOiBudWxsXG4gICAgICAgIH1cblxuICAgICAgICA8RmllbGRcbiAgICAgICAgICAgIG5hbWU9XCJzcGFjZVRvcGljXCJcbiAgICAgICAgICAgIGVsZW1lbnQ9XCJ0ZXh0YXJlYVwiXG4gICAgICAgICAgICBsYWJlbD17X3QoXCJEZXNjcmlwdGlvblwiKX1cbiAgICAgICAgICAgIHZhbHVlPXt0b3BpY31cbiAgICAgICAgICAgIG9uQ2hhbmdlPXtldiA9PiBzZXRUb3BpYyhldi50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgcm93cz17M31cbiAgICAgICAgICAgIGRpc2FibGVkPXtidXN5fVxuICAgICAgICAvPlxuXG4gICAgICAgIHsgY2hpbGRyZW4gfVxuICAgIDwvZm9ybT47XG59O1xuXG5jb25zdCBTcGFjZUNyZWF0ZU1lbnUgPSAoeyBvbkZpbmlzaGVkIH0pID0+IHtcbiAgICBjb25zdCBbdmlzaWJpbGl0eSwgc2V0VmlzaWJpbGl0eV0gPSB1c2VTdGF0ZTxWaXNpYmlsaXR5PihudWxsKTtcbiAgICBjb25zdCBbYnVzeSwgc2V0QnVzeV0gPSB1c2VTdGF0ZTxib29sZWFuPihmYWxzZSk7XG5cbiAgICBjb25zdCBbbmFtZSwgc2V0TmFtZV0gPSB1c2VTdGF0ZShcIlwiKTtcbiAgICBjb25zdCBzcGFjZU5hbWVGaWVsZCA9IHVzZVJlZjxGaWVsZD4oKTtcbiAgICBjb25zdCBbYWxpYXMsIHNldEFsaWFzXSA9IHVzZVN0YXRlKFwiXCIpO1xuICAgIGNvbnN0IHNwYWNlQWxpYXNGaWVsZCA9IHVzZVJlZjxSb29tQWxpYXNGaWVsZD4oKTtcbiAgICBjb25zdCBbYXZhdGFyLCBzZXRBdmF0YXJdID0gdXNlU3RhdGU8RmlsZT4obnVsbCk7XG4gICAgY29uc3QgW3RvcGljLCBzZXRUb3BpY10gPSB1c2VTdGF0ZTxzdHJpbmc+KFwiXCIpO1xuXG4gICAgY29uc3Qgb25TcGFjZUNyZWF0ZUNsaWNrID0gYXN5bmMgKGUpID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBpZiAoYnVzeSkgcmV0dXJuO1xuXG4gICAgICAgIHNldEJ1c3kodHJ1ZSk7XG4gICAgICAgIC8vIHJlcXVpcmUgJiB2YWxpZGF0ZSB0aGUgc3BhY2UgbmFtZSBmaWVsZFxuICAgICAgICBpZiAoIShhd2FpdCBzcGFjZU5hbWVGaWVsZC5jdXJyZW50LnZhbGlkYXRlKHsgYWxsb3dFbXB0eTogZmFsc2UgfSkpKSB7XG4gICAgICAgICAgICBzcGFjZU5hbWVGaWVsZC5jdXJyZW50LmZvY3VzKCk7XG4gICAgICAgICAgICBzcGFjZU5hbWVGaWVsZC5jdXJyZW50LnZhbGlkYXRlKHsgYWxsb3dFbXB0eTogZmFsc2UsIGZvY3VzZWQ6IHRydWUgfSk7XG4gICAgICAgICAgICBzZXRCdXN5KGZhbHNlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh2aXNpYmlsaXR5ID09PSBWaXNpYmlsaXR5LlB1YmxpYyAmJiAhKGF3YWl0IHNwYWNlQWxpYXNGaWVsZC5jdXJyZW50LnZhbGlkYXRlKHsgYWxsb3dFbXB0eTogZmFsc2UgfSkpKSB7XG4gICAgICAgICAgICBzcGFjZUFsaWFzRmllbGQuY3VycmVudC5mb2N1cygpO1xuICAgICAgICAgICAgc3BhY2VBbGlhc0ZpZWxkLmN1cnJlbnQudmFsaWRhdGUoeyBhbGxvd0VtcHR5OiBmYWxzZSwgZm9jdXNlZDogdHJ1ZSB9KTtcbiAgICAgICAgICAgIHNldEJ1c3koZmFsc2UpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IGNyZWF0ZVNwYWNlKFxuICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgICAgdmlzaWJpbGl0eSA9PT0gVmlzaWJpbGl0eS5QdWJsaWMsXG4gICAgICAgICAgICAgICAgYWxpYXMsXG4gICAgICAgICAgICAgICAgdG9waWMsXG4gICAgICAgICAgICAgICAgYXZhdGFyLFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgb25GaW5pc2hlZCgpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoZSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgbGV0IGJvZHk7XG4gICAgaWYgKHZpc2liaWxpdHkgPT09IG51bGwpIHtcbiAgICAgICAgY29uc3Qgb25DcmVhdGVTcGFjZUZyb21Db21tdW5pdHlDbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgIGRlZmF1bHREaXNwYXRjaGVyLmRpc3BhdGNoKHtcbiAgICAgICAgICAgICAgICBhY3Rpb246IEFjdGlvbi5WaWV3VXNlclNldHRpbmdzLFxuICAgICAgICAgICAgICAgIGluaXRpYWxUYWJJZDogVXNlclRhYi5QcmVmZXJlbmNlcyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgb25GaW5pc2hlZCgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGJvZHkgPSA8UmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICAgICA8aDI+eyBfdChcIkNyZWF0ZSBhIHNwYWNlXCIpIH08L2gyPlxuICAgICAgICAgICAgPHA+XG4gICAgICAgICAgICAgICAgeyBfdChcIlNwYWNlcyBhcmUgYSBuZXcgd2F5IHRvIGdyb3VwIHJvb21zIGFuZCBwZW9wbGUuXCIpIH1cbiAgICAgICAgICAgICAgICAmbmJzcDtcbiAgICAgICAgICAgICAgICB7IF90KFwiV2hhdCBraW5kIG9mIFNwYWNlIGRvIHlvdSB3YW50IHRvIGNyZWF0ZT9cIikgfVxuICAgICAgICAgICAgICAgICZuYnNwO1xuICAgICAgICAgICAgICAgIHsgX3QoXCJZb3UgY2FuIGNoYW5nZSB0aGlzIGxhdGVyLlwiKSB9XG4gICAgICAgICAgICA8L3A+XG5cbiAgICAgICAgICAgIDxTcGFjZUNyZWF0ZU1lbnVUeXBlXG4gICAgICAgICAgICAgICAgdGl0bGU9e190KFwiUHVibGljXCIpfVxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uPXtfdChcIk9wZW4gc3BhY2UgZm9yIGFueW9uZSwgYmVzdCBmb3IgY29tbXVuaXRpZXNcIil9XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXhfU3BhY2VDcmVhdGVNZW51VHlwZV9wdWJsaWNcIlxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHNldFZpc2liaWxpdHkoVmlzaWJpbGl0eS5QdWJsaWMpfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDxTcGFjZUNyZWF0ZU1lbnVUeXBlXG4gICAgICAgICAgICAgICAgdGl0bGU9e190KFwiUHJpdmF0ZVwiKX1cbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17X3QoXCJJbnZpdGUgb25seSwgYmVzdCBmb3IgeW91cnNlbGYgb3IgdGVhbXNcIil9XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXhfU3BhY2VDcmVhdGVNZW51VHlwZV9wcml2YXRlXCJcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBzZXRWaXNpYmlsaXR5KFZpc2liaWxpdHkuUHJpdmF0ZSl9XG4gICAgICAgICAgICAvPlxuXG4gICAgICAgICAgICA8cD5cbiAgICAgICAgICAgICAgICB7IF90KFwiWW91IGNhbiBhbHNvIG1ha2UgU3BhY2VzIGZyb20gPGE+Y29tbXVuaXRpZXM8L2E+LlwiLCB7fSwge1xuICAgICAgICAgICAgICAgICAgICBhOiBzdWIgPT4gPEFjY2Vzc2libGVCdXR0b24ga2luZD1cImxpbmtcIiBvbkNsaWNrPXtvbkNyZWF0ZVNwYWNlRnJvbUNvbW11bml0eUNsaWNrfT5cbiAgICAgICAgICAgICAgICAgICAgICAgIHsgc3ViIH1cbiAgICAgICAgICAgICAgICAgICAgPC9BY2Nlc3NpYmxlQnV0dG9uPixcbiAgICAgICAgICAgICAgICB9KSB9XG4gICAgICAgICAgICAgICAgPGJyIC8+XG4gICAgICAgICAgICAgICAgeyBfdChcIlRvIGpvaW4gYSBzcGFjZSB5b3UnbGwgbmVlZCBhbiBpbnZpdGUuXCIpIH1cbiAgICAgICAgICAgIDwvcD5cblxuICAgICAgICAgICAgPFNwYWNlRmVlZGJhY2tQcm9tcHQgb25DbGljaz17b25GaW5pc2hlZH0gLz5cbiAgICAgICAgPC9SZWFjdC5GcmFnbWVudD47XG4gICAgfSBlbHNlIHtcbiAgICAgICAgYm9keSA9IDxSZWFjdC5GcmFnbWVudD5cbiAgICAgICAgICAgIDxBY2Nlc3NpYmxlVG9vbHRpcEJ1dHRvblxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm14X1NwYWNlQ3JlYXRlTWVudV9iYWNrXCJcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBzZXRWaXNpYmlsaXR5KG51bGwpfVxuICAgICAgICAgICAgICAgIHRpdGxlPXtfdChcIkdvIGJhY2tcIil9XG4gICAgICAgICAgICAvPlxuXG4gICAgICAgICAgICA8aDI+XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB2aXNpYmlsaXR5ID09PSBWaXNpYmlsaXR5LlB1YmxpYyA/IF90KFwiWW91ciBwdWJsaWMgc3BhY2VcIikgOiBfdChcIllvdXIgcHJpdmF0ZSBzcGFjZVwiKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIDwvaDI+XG4gICAgICAgICAgICA8cD5cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIF90KFwiQWRkIHNvbWUgZGV0YWlscyB0byBoZWxwIHBlb3BsZSByZWNvZ25pc2UgaXQuXCIpXG4gICAgICAgICAgICAgICAgfSB7XG4gICAgICAgICAgICAgICAgICAgIF90KFwiWW91IGNhbiBjaGFuZ2UgdGhlc2UgYW55dGltZS5cIilcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICA8L3A+XG5cbiAgICAgICAgICAgIDxTcGFjZUNyZWF0ZUZvcm1cbiAgICAgICAgICAgICAgICBidXN5PXtidXN5fVxuICAgICAgICAgICAgICAgIG9uU3VibWl0PXtvblNwYWNlQ3JlYXRlQ2xpY2t9XG4gICAgICAgICAgICAgICAgc2V0QXZhdGFyPXtzZXRBdmF0YXJ9XG4gICAgICAgICAgICAgICAgbmFtZT17bmFtZX1cbiAgICAgICAgICAgICAgICBzZXROYW1lPXtzZXROYW1lfVxuICAgICAgICAgICAgICAgIG5hbWVGaWVsZFJlZj17c3BhY2VOYW1lRmllbGR9XG4gICAgICAgICAgICAgICAgdG9waWM9e3RvcGljfVxuICAgICAgICAgICAgICAgIHNldFRvcGljPXtzZXRUb3BpY31cbiAgICAgICAgICAgICAgICBhbGlhcz17YWxpYXN9XG4gICAgICAgICAgICAgICAgc2V0QWxpYXM9e3NldEFsaWFzfVxuICAgICAgICAgICAgICAgIHNob3dBbGlhc0ZpZWxkPXt2aXNpYmlsaXR5ID09PSBWaXNpYmlsaXR5LlB1YmxpY31cbiAgICAgICAgICAgICAgICBhbGlhc0ZpZWxkUmVmPXtzcGFjZUFsaWFzRmllbGR9XG4gICAgICAgICAgICAvPlxuXG4gICAgICAgICAgICA8QWNjZXNzaWJsZUJ1dHRvbiBraW5kPVwicHJpbWFyeVwiIG9uQ2xpY2s9e29uU3BhY2VDcmVhdGVDbGlja30gZGlzYWJsZWQ9e2J1c3l9PlxuICAgICAgICAgICAgICAgIHsgYnVzeSA/IF90KFwiQ3JlYXRpbmcuLi5cIikgOiBfdChcIkNyZWF0ZVwiKSB9XG4gICAgICAgICAgICA8L0FjY2Vzc2libGVCdXR0b24+XG4gICAgICAgIDwvUmVhY3QuRnJhZ21lbnQ+O1xuICAgIH1cblxuICAgIHJldHVybiA8Q29udGV4dE1lbnVcbiAgICAgICAgbGVmdD17NzJ9XG4gICAgICAgIHRvcD17NjJ9XG4gICAgICAgIGNoZXZyb25PZmZzZXQ9ezB9XG4gICAgICAgIGNoZXZyb25GYWNlPXtDaGV2cm9uRmFjZS5Ob25lfVxuICAgICAgICBvbkZpbmlzaGVkPXtvbkZpbmlzaGVkfVxuICAgICAgICB3cmFwcGVyQ2xhc3NOYW1lPVwibXhfU3BhY2VDcmVhdGVNZW51X3dyYXBwZXJcIlxuICAgICAgICBtYW5hZ2VkPXtmYWxzZX1cbiAgICA+XG4gICAgICAgIHsgYm9keSB9XG4gICAgPC9Db250ZXh0TWVudT47XG59O1xuXG5leHBvcnQgZGVmYXVsdCBTcGFjZUNyZWF0ZU1lbnU7XG4iXX0=