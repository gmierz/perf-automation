"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.contextMenuBelow = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireWildcard(require("react"));

var _classnames = _interopRequireDefault(require("classnames"));

var _RovingTabIndex = require("../../../accessibility/RovingTabIndex");

var _AccessibleButton = _interopRequireDefault(require("../../views/elements/AccessibleButton"));

var _dispatcher = _interopRequireDefault(require("../../../dispatcher/dispatcher"));

var _actions = require("../../../dispatcher/actions");

var _Keyboard = require("../../../Keyboard");

var _ActiveRoomObserver = _interopRequireDefault(require("../../../ActiveRoomObserver"));

var _languageHandler = require("../../../languageHandler");

var _ContextMenu = require("../../structures/ContextMenu");

var _models = require("../../../stores/room-list/models");

var _MessagePreviewStore = require("../../../stores/room-list/MessagePreviewStore");

var _DecoratedRoomAvatar = _interopRequireDefault(require("../avatars/DecoratedRoomAvatar"));

var _RoomNotifs = require("../../../RoomNotifs");

var _MatrixClientPeg = require("../../../MatrixClientPeg");

var _NotificationBadge = _interopRequireDefault(require("./NotificationBadge"));

var _RoomListStore = _interopRequireDefault(require("../../../stores/room-list/RoomListStore"));

var _RoomListActions = _interopRequireDefault(require("../../../actions/RoomListActions"));

var _RoomNotificationStateStore = require("../../../stores/notifications/RoomNotificationStateStore");

var _NotificationState = require("../../../stores/notifications/NotificationState");

var _AccessibleTooltipButton = _interopRequireDefault(require("../elements/AccessibleTooltipButton"));

var _EchoChamber = require("../../../stores/local-echo/EchoChamber");

var _RoomEchoChamber = require("../../../stores/local-echo/RoomEchoChamber");

var _GenericEchoChamber = require("../../../stores/local-echo/GenericEchoChamber");

var _IconizedContextMenu = _interopRequireWildcard(require("../context_menus/IconizedContextMenu"));

var _CommunityPrototypeStore = require("../../../stores/CommunityPrototypeStore");

var _replaceableComponent = require("../../../utils/replaceableComponent");

var _logger = require("matrix-js-sdk/src/logger");

var _dec, _class;

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

const messagePreviewId = roomId => `mx_RoomTile_messagePreview_${roomId}`;

const contextMenuBelow = elementRect => {
  // align the context menu's icons with the icon which opened the context menu
  const left = elementRect.left + window.pageXOffset - 9;
  const top = elementRect.bottom + window.pageYOffset + 17;
  const chevronFace = _ContextMenu.ChevronFace.None;
  return {
    left,
    top,
    chevronFace
  };
};

exports.contextMenuBelow = contextMenuBelow;
let RoomTile = (_dec = (0, _replaceableComponent.replaceableComponent)("views.rooms.RoomTile"), _dec(_class = class RoomTile extends _react.default.PureComponent {
  constructor(props) {
    super(props);
    (0, _defineProperty2.default)(this, "dispatcherRef", void 0);
    (0, _defineProperty2.default)(this, "roomTileRef", /*#__PURE__*/(0, _react.createRef)());
    (0, _defineProperty2.default)(this, "notificationState", void 0);
    (0, _defineProperty2.default)(this, "roomProps", void 0);
    (0, _defineProperty2.default)(this, "onRoomNameUpdate", room => {
      this.forceUpdate();
    });
    (0, _defineProperty2.default)(this, "onNotificationUpdate", () => {
      this.forceUpdate(); // notification state changed - update
    });
    (0, _defineProperty2.default)(this, "onRoomPropertyUpdate", property => {
      if (property === _RoomEchoChamber.CachedRoomKey.NotificationVolume) this.onNotificationUpdate(); // else ignore - not important for this tile
    });
    (0, _defineProperty2.default)(this, "onAction", payload => {
      if (payload.action === "view_room" && payload.room_id === this.props.room.roomId && payload.show_room_tile) {
        setImmediate(() => {
          this.scrollIntoView();
        });
      }
    });
    (0, _defineProperty2.default)(this, "onCommunityUpdate", roomId => {
      if (roomId !== this.props.room.roomId) return;
      this.forceUpdate(); // we don't have anything to actually update
    });
    (0, _defineProperty2.default)(this, "onRoomPreviewChanged", room => {
      if (this.props.room && room.roomId === this.props.room.roomId) {
        this.generatePreview();
      }
    });
    (0, _defineProperty2.default)(this, "scrollIntoView", () => {
      if (!this.roomTileRef.current) return;
      this.roomTileRef.current.scrollIntoView({
        block: "nearest",
        behavior: "auto"
      });
    });
    (0, _defineProperty2.default)(this, "onTileClick", ev => {
      ev.preventDefault();
      ev.stopPropagation();

      _dispatcher.default.dispatch({
        action: _actions.Action.ViewRoom,
        show_room_tile: true,
        // make sure the room is visible in the list
        room_id: this.props.room.roomId,
        clear_search: ev && (ev.key === _Keyboard.Key.ENTER || ev.key === _Keyboard.Key.SPACE)
      });
    });
    (0, _defineProperty2.default)(this, "onActiveRoomUpdate", isActive => {
      this.setState({
        selected: isActive
      });
    });
    (0, _defineProperty2.default)(this, "onNotificationsMenuOpenClick", ev => {
      ev.preventDefault();
      ev.stopPropagation();
      const target = ev.target;
      this.setState({
        notificationsMenuPosition: target.getBoundingClientRect()
      });
    });
    (0, _defineProperty2.default)(this, "onCloseNotificationsMenu", () => {
      this.setState({
        notificationsMenuPosition: null
      });
    });
    (0, _defineProperty2.default)(this, "onGeneralMenuOpenClick", ev => {
      ev.preventDefault();
      ev.stopPropagation();
      const target = ev.target;
      this.setState({
        generalMenuPosition: target.getBoundingClientRect()
      });
    });
    (0, _defineProperty2.default)(this, "onContextMenu", ev => {
      // If we don't have a context menu to show, ignore the action.
      if (!this.showContextMenu) return;
      ev.preventDefault();
      ev.stopPropagation();
      this.setState({
        generalMenuPosition: {
          left: ev.clientX,
          bottom: ev.clientY
        }
      });
    });
    (0, _defineProperty2.default)(this, "onCloseGeneralMenu", () => {
      this.setState({
        generalMenuPosition: null
      });
    });
    (0, _defineProperty2.default)(this, "onTagRoom", (ev, tagId) => {
      ev.preventDefault();
      ev.stopPropagation();

      if (tagId === _models.DefaultTagID.Favourite || tagId === _models.DefaultTagID.LowPriority) {
        const inverseTag = tagId === _models.DefaultTagID.Favourite ? _models.DefaultTagID.LowPriority : _models.DefaultTagID.Favourite;

        const isApplied = _RoomListStore.default.instance.getTagsForRoom(this.props.room).includes(tagId);

        const removeTag = isApplied ? tagId : inverseTag;
        const addTag = isApplied ? null : tagId;

        _dispatcher.default.dispatch(_RoomListActions.default.tagRoom(_MatrixClientPeg.MatrixClientPeg.get(), this.props.room, removeTag, addTag, undefined, 0));
      } else {
        _logger.logger.warn(`Unexpected tag ${tagId} applied to ${this.props.room.roomId}`);
      }

      if (ev.key === _Keyboard.Key.ENTER) {
        // Implements https://www.w3.org/TR/wai-aria-practices/#keyboard-interaction-12
        this.setState({
          generalMenuPosition: null
        }); // hide the menu
      }
    });
    (0, _defineProperty2.default)(this, "onLeaveRoomClick", ev => {
      ev.preventDefault();
      ev.stopPropagation();

      _dispatcher.default.dispatch({
        action: 'leave_room',
        room_id: this.props.room.roomId
      });

      this.setState({
        generalMenuPosition: null
      }); // hide the menu
    });
    (0, _defineProperty2.default)(this, "onForgetRoomClick", ev => {
      ev.preventDefault();
      ev.stopPropagation();

      _dispatcher.default.dispatch({
        action: 'forget_room',
        room_id: this.props.room.roomId
      });

      this.setState({
        generalMenuPosition: null
      }); // hide the menu
    });
    (0, _defineProperty2.default)(this, "onOpenRoomSettings", ev => {
      ev.preventDefault();
      ev.stopPropagation();

      _dispatcher.default.dispatch({
        action: 'open_room_settings',
        room_id: this.props.room.roomId
      });

      this.setState({
        generalMenuPosition: null
      }); // hide the menu
    });
    (0, _defineProperty2.default)(this, "onCopyRoomClick", ev => {
      ev.preventDefault();
      ev.stopPropagation();

      _dispatcher.default.dispatch({
        action: 'copy_room',
        room_id: this.props.room.roomId
      });

      this.setState({
        generalMenuPosition: null
      }); // hide the menu
    });
    (0, _defineProperty2.default)(this, "onInviteClick", ev => {
      ev.preventDefault();
      ev.stopPropagation();

      _dispatcher.default.dispatch({
        action: 'view_invite',
        roomId: this.props.room.roomId
      });

      this.setState({
        generalMenuPosition: null
      }); // hide the menu
    });
    (0, _defineProperty2.default)(this, "onClickAllNotifs", ev => this.saveNotifState(ev, _RoomNotifs.RoomNotifState.AllMessages));
    (0, _defineProperty2.default)(this, "onClickAlertMe", ev => this.saveNotifState(ev, _RoomNotifs.RoomNotifState.AllMessagesLoud));
    (0, _defineProperty2.default)(this, "onClickMentions", ev => this.saveNotifState(ev, _RoomNotifs.RoomNotifState.MentionsOnly));
    (0, _defineProperty2.default)(this, "onClickMute", ev => this.saveNotifState(ev, _RoomNotifs.RoomNotifState.Mute));
    this.state = {
      selected: _ActiveRoomObserver.default.activeRoomId === this.props.room.roomId,
      notificationsMenuPosition: null,
      generalMenuPosition: null,
      // generatePreview() will return nothing if the user has previews disabled
      messagePreview: ""
    };
    this.generatePreview();
    this.notificationState = _RoomNotificationStateStore.RoomNotificationStateStore.instance.getRoomState(this.props.room);
    this.roomProps = _EchoChamber.EchoChamber.forRoom(this.props.room);
  }

  get showContextMenu() {
    return this.props.tag !== _models.DefaultTagID.Invite;
  }

  get showMessagePreview() {
    return !this.props.isMinimized && this.props.showMessagePreview;
  }

  componentDidUpdate(prevProps, prevState) {
    var _prevProps$room, _this$props$room;

    const showMessageChanged = prevProps.showMessagePreview !== this.props.showMessagePreview;
    const minimizedChanged = prevProps.isMinimized !== this.props.isMinimized;

    if (showMessageChanged || minimizedChanged) {
      this.generatePreview();
    }

    if (((_prevProps$room = prevProps.room) === null || _prevProps$room === void 0 ? void 0 : _prevProps$room.roomId) !== ((_this$props$room = this.props.room) === null || _this$props$room === void 0 ? void 0 : _this$props$room.roomId)) {
      var _prevProps$room2, _this$props$room2, _prevProps$room3, _this$props$room3;

      _MessagePreviewStore.MessagePreviewStore.instance.off(_MessagePreviewStore.MessagePreviewStore.getPreviewChangedEventName(prevProps.room), this.onRoomPreviewChanged);

      _MessagePreviewStore.MessagePreviewStore.instance.on(_MessagePreviewStore.MessagePreviewStore.getPreviewChangedEventName(this.props.room), this.onRoomPreviewChanged);

      _CommunityPrototypeStore.CommunityPrototypeStore.instance.off(_CommunityPrototypeStore.CommunityPrototypeStore.getUpdateEventName((_prevProps$room2 = prevProps.room) === null || _prevProps$room2 === void 0 ? void 0 : _prevProps$room2.roomId), this.onCommunityUpdate);

      _CommunityPrototypeStore.CommunityPrototypeStore.instance.on(_CommunityPrototypeStore.CommunityPrototypeStore.getUpdateEventName((_this$props$room2 = this.props.room) === null || _this$props$room2 === void 0 ? void 0 : _this$props$room2.roomId), this.onCommunityUpdate);

      (_prevProps$room3 = prevProps.room) === null || _prevProps$room3 === void 0 ? void 0 : _prevProps$room3.off("Room.name", this.onRoomNameUpdate);
      (_this$props$room3 = this.props.room) === null || _this$props$room3 === void 0 ? void 0 : _this$props$room3.on("Room.name", this.onRoomNameUpdate);
    }
  }

  componentDidMount() {
    var _this$props$room4;

    // when we're first rendered (or our sublist is expanded) make sure we are visible if we're active
    if (this.state.selected) {
      this.scrollIntoView();
    }

    _ActiveRoomObserver.default.addListener(this.props.room.roomId, this.onActiveRoomUpdate);

    this.dispatcherRef = _dispatcher.default.register(this.onAction);

    _MessagePreviewStore.MessagePreviewStore.instance.on(_MessagePreviewStore.MessagePreviewStore.getPreviewChangedEventName(this.props.room), this.onRoomPreviewChanged);

    this.notificationState.on(_NotificationState.NOTIFICATION_STATE_UPDATE, this.onNotificationUpdate);
    this.roomProps.on(_GenericEchoChamber.PROPERTY_UPDATED, this.onRoomPropertyUpdate);
    (_this$props$room4 = this.props.room) === null || _this$props$room4 === void 0 ? void 0 : _this$props$room4.on("Room.name", this.onRoomNameUpdate);

    _CommunityPrototypeStore.CommunityPrototypeStore.instance.on(_CommunityPrototypeStore.CommunityPrototypeStore.getUpdateEventName(this.props.room.roomId), this.onCommunityUpdate);
  }

  componentWillUnmount() {
    if (this.props.room) {
      _ActiveRoomObserver.default.removeListener(this.props.room.roomId, this.onActiveRoomUpdate);

      _MessagePreviewStore.MessagePreviewStore.instance.off(_MessagePreviewStore.MessagePreviewStore.getPreviewChangedEventName(this.props.room), this.onRoomPreviewChanged);

      _CommunityPrototypeStore.CommunityPrototypeStore.instance.off(_CommunityPrototypeStore.CommunityPrototypeStore.getUpdateEventName(this.props.room.roomId), this.onCommunityUpdate);

      this.props.room.off("Room.name", this.onRoomNameUpdate);
    }

    _ActiveRoomObserver.default.removeListener(this.props.room.roomId, this.onActiveRoomUpdate);

    _dispatcher.default.unregister(this.dispatcherRef);

    this.notificationState.off(_NotificationState.NOTIFICATION_STATE_UPDATE, this.onNotificationUpdate);
    this.roomProps.off(_GenericEchoChamber.PROPERTY_UPDATED, this.onRoomPropertyUpdate);

    _CommunityPrototypeStore.CommunityPrototypeStore.instance.off(_CommunityPrototypeStore.CommunityPrototypeStore.getUpdateEventName(this.props.room.roomId), this.onCommunityUpdate);
  }

  async generatePreview() {
    if (!this.showMessagePreview) {
      return null;
    }

    const messagePreview = await _MessagePreviewStore.MessagePreviewStore.instance.getPreviewForRoom(this.props.room, this.props.tag);
    this.setState({
      messagePreview
    });
  }

  async saveNotifState(ev, newState) {
    ev.preventDefault();
    ev.stopPropagation();
    if (_MatrixClientPeg.MatrixClientPeg.get().isGuest()) return;
    this.roomProps.notificationVolume = newState;
    const key = ev.key;

    if (key === _Keyboard.Key.ENTER) {
      // Implements https://www.w3.org/TR/wai-aria-practices/#keyboard-interaction-12
      this.setState({
        notificationsMenuPosition: null
      }); // hide the menu
    }
  }

  renderNotificationsMenu(isActive) {
    if (_MatrixClientPeg.MatrixClientPeg.get().isGuest() || this.props.tag === _models.DefaultTagID.Archived || !this.showContextMenu || this.props.isMinimized) {
      // the menu makes no sense in these cases so do not show one
      return null;
    }

    const state = this.roomProps.notificationVolume;
    let contextMenu = null;

    if (this.state.notificationsMenuPosition) {
      contextMenu = /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.default, (0, _extends2.default)({}, contextMenuBelow(this.state.notificationsMenuPosition), {
        onFinished: this.onCloseNotificationsMenu,
        className: "mx_RoomTile_contextMenu",
        compact: true
      }), /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOptionList, {
        first: true
      }, /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuRadio, {
        label: (0, _languageHandler._t)("Use default"),
        active: state === _RoomNotifs.RoomNotifState.AllMessages,
        iconClassName: "mx_RoomTile_iconBell",
        onClick: this.onClickAllNotifs
      }), /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuRadio, {
        label: (0, _languageHandler._t)("All messages"),
        active: state === _RoomNotifs.RoomNotifState.AllMessagesLoud,
        iconClassName: "mx_RoomTile_iconBellDot",
        onClick: this.onClickAlertMe
      }), /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuRadio, {
        label: (0, _languageHandler._t)("Mentions & Keywords"),
        active: state === _RoomNotifs.RoomNotifState.MentionsOnly,
        iconClassName: "mx_RoomTile_iconBellMentions",
        onClick: this.onClickMentions
      }), /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuRadio, {
        label: (0, _languageHandler._t)("None"),
        active: state === _RoomNotifs.RoomNotifState.Mute,
        iconClassName: "mx_RoomTile_iconBellCrossed",
        onClick: this.onClickMute
      })));
    }

    const classes = (0, _classnames.default)("mx_RoomTile_notificationsButton", {
      // Show bell icon for the default case too.
      mx_RoomTile_iconBell: state === _RoomNotifs.RoomNotifState.AllMessages,
      mx_RoomTile_iconBellDot: state === _RoomNotifs.RoomNotifState.AllMessagesLoud,
      mx_RoomTile_iconBellMentions: state === _RoomNotifs.RoomNotifState.MentionsOnly,
      mx_RoomTile_iconBellCrossed: state === _RoomNotifs.RoomNotifState.Mute,
      // Only show the icon by default if the room is overridden to muted.
      // TODO: [FTUE Notifications] Probably need to detect global mute state
      mx_RoomTile_notificationsButton_show: state === _RoomNotifs.RoomNotifState.Mute
    });
    return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement(_ContextMenu.ContextMenuTooltipButton, {
      className: classes,
      onClick: this.onNotificationsMenuOpenClick,
      title: (0, _languageHandler._t)("Notification options"),
      isExpanded: !!this.state.notificationsMenuPosition,
      tabIndex: isActive ? 0 : -1
    }), contextMenu);
  }

  renderGeneralMenu() {
    if (!this.showContextMenu) return null; // no menu to show

    let contextMenu = null;

    if (this.state.generalMenuPosition && this.props.tag === _models.DefaultTagID.Archived) {
      contextMenu = /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.default, (0, _extends2.default)({}, contextMenuBelow(this.state.generalMenuPosition), {
        onFinished: this.onCloseGeneralMenu,
        className: "mx_RoomTile_contextMenu",
        compact: true
      }), /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOptionList, {
        red: true
      }, /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
        iconClassName: "mx_RoomTile_iconSignOut",
        label: (0, _languageHandler._t)("Forget Room"),
        onClick: this.onForgetRoomClick
      })));
    } else if (this.state.generalMenuPosition) {
      const roomTags = _RoomListStore.default.instance.getTagsForRoom(this.props.room);

      const isFavorite = roomTags.includes(_models.DefaultTagID.Favourite);
      const favouriteLabel = isFavorite ? (0, _languageHandler._t)("Favourited") : (0, _languageHandler._t)("Favourite");
      const isLowPriority = roomTags.includes(_models.DefaultTagID.LowPriority);
      const lowPriorityLabel = (0, _languageHandler._t)("Low Priority");

      const userId = _MatrixClientPeg.MatrixClientPeg.get().getUserId();

      const canInvite = this.props.room.canInvite(userId);
      contextMenu = /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.default, (0, _extends2.default)({}, contextMenuBelow(this.state.generalMenuPosition), {
        onFinished: this.onCloseGeneralMenu,
        className: "mx_RoomTile_contextMenu",
        compact: true
      }), /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOptionList, null, /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuCheckbox, {
        onClick: e => this.onTagRoom(e, _models.DefaultTagID.Favourite),
        active: isFavorite,
        label: favouriteLabel,
        iconClassName: "mx_RoomTile_iconStar"
      }), /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuCheckbox, {
        onClick: e => this.onTagRoom(e, _models.DefaultTagID.LowPriority),
        active: isLowPriority,
        label: lowPriorityLabel,
        iconClassName: "mx_RoomTile_iconArrowDown"
      }), canInvite ? /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
        onClick: this.onInviteClick,
        label: (0, _languageHandler._t)("Invite People"),
        iconClassName: "mx_RoomTile_iconInvite"
      }) : null, /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
        onClick: this.onCopyRoomClick,
        label: (0, _languageHandler._t)("Copy Room Link"),
        iconClassName: "mx_RoomTile_iconCopyLink"
      }), /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
        onClick: this.onOpenRoomSettings,
        label: (0, _languageHandler._t)("Settings"),
        iconClassName: "mx_RoomTile_iconSettings"
      })), /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOptionList, {
        red: true
      }, /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
        onClick: this.onLeaveRoomClick,
        label: (0, _languageHandler._t)("Leave Room"),
        iconClassName: "mx_RoomTile_iconSignOut"
      })));
    }

    return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement(_ContextMenu.ContextMenuTooltipButton, {
      className: "mx_RoomTile_menuButton",
      onClick: this.onGeneralMenuOpenClick,
      title: (0, _languageHandler._t)("Room options"),
      isExpanded: !!this.state.generalMenuPosition
    }), contextMenu);
  }

  render() {
    const classes = (0, _classnames.default)({
      'mx_RoomTile': true,
      'mx_RoomTile_selected': this.state.selected,
      'mx_RoomTile_hasMenuOpen': !!(this.state.generalMenuPosition || this.state.notificationsMenuPosition),
      'mx_RoomTile_minimized': this.props.isMinimized
    });
    let roomProfile = {
      displayName: null,
      avatarMxc: null
    };

    if (this.props.tag === _models.DefaultTagID.Invite) {
      roomProfile = _CommunityPrototypeStore.CommunityPrototypeStore.instance.getInviteProfile(this.props.room.roomId);
    }

    let name = roomProfile.displayName || this.props.room.name;
    if (typeof name !== 'string') name = '';
    name = name.replace(":", ":\u200b"); // add a zero-width space to allow linewrapping after the colon

    const roomAvatar = /*#__PURE__*/_react.default.createElement(_DecoratedRoomAvatar.default, {
      room: this.props.room,
      avatarSize: 32,
      displayBadge: this.props.isMinimized,
      oobData: {
        avatarUrl: roomProfile.avatarMxc
      }
    });

    let badge;

    if (!this.props.isMinimized && this.notificationState) {
      // aria-hidden because we summarise the unread count/highlight status in a manual aria-label below
      badge = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_RoomTile_badgeContainer",
        "aria-hidden": "true"
      }, /*#__PURE__*/_react.default.createElement(_NotificationBadge.default, {
        notification: this.notificationState,
        forceCount: false,
        roomId: this.props.room.roomId
      }));
    }

    let messagePreview = null;

    if (this.showMessagePreview && this.state.messagePreview) {
      messagePreview = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_RoomTile_messagePreview",
        id: messagePreviewId(this.props.room.roomId),
        title: this.state.messagePreview
      }, this.state.messagePreview);
    }

    const nameClasses = (0, _classnames.default)({
      "mx_RoomTile_name": true,
      "mx_RoomTile_nameWithPreview": !!messagePreview,
      "mx_RoomTile_nameHasUnreadEvents": this.notificationState.isUnread
    });

    let nameContainer = /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_RoomTile_nameContainer"
    }, /*#__PURE__*/_react.default.createElement("div", {
      title: name,
      className: nameClasses,
      tabIndex: -1,
      dir: "auto"
    }, name), messagePreview);

    if (this.props.isMinimized) nameContainer = null;
    let ariaLabel = name; // The following labels are written in such a fashion to increase screen reader efficiency (speed).

    if (this.props.tag === _models.DefaultTagID.Invite) {// append nothing
    } else if (this.notificationState.hasMentions) {
      ariaLabel += " " + (0, _languageHandler._t)("%(count)s unread messages including mentions.", {
        count: this.notificationState.count
      });
    } else if (this.notificationState.hasUnreadCount) {
      ariaLabel += " " + (0, _languageHandler._t)("%(count)s unread messages.", {
        count: this.notificationState.count
      });
    } else if (this.notificationState.isUnread) {
      ariaLabel += " " + (0, _languageHandler._t)("Unread messages.");
    }

    let ariaDescribedBy;

    if (this.showMessagePreview) {
      ariaDescribedBy = messagePreviewId(this.props.room.roomId);
    }

    const props = {};
    let Button = _AccessibleButton.default;

    if (this.props.isMinimized) {
      Button = _AccessibleTooltipButton.default;
      props.title = name; // force the tooltip to hide whilst we are showing the context menu

      props.forceHide = !!this.state.generalMenuPosition;
    }

    return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement(_RovingTabIndex.RovingTabIndexWrapper, {
      inputRef: this.roomTileRef
    }, ({
      onFocus,
      isActive,
      ref
    }) => /*#__PURE__*/_react.default.createElement(Button, (0, _extends2.default)({}, props, {
      onFocus: onFocus,
      tabIndex: isActive ? 0 : -1,
      inputRef: ref,
      className: classes,
      onClick: this.onTileClick,
      onContextMenu: this.onContextMenu,
      role: "treeitem",
      "aria-label": ariaLabel,
      "aria-selected": this.state.selected,
      "aria-describedby": ariaDescribedBy
    }), roomAvatar, nameContainer, badge, this.renderGeneralMenu(), this.renderNotificationsMenu(isActive))));
  }

}) || _class);
exports.default = RoomTile;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZpZXdzL3Jvb21zL1Jvb21UaWxlLnRzeCJdLCJuYW1lcyI6WyJtZXNzYWdlUHJldmlld0lkIiwicm9vbUlkIiwiY29udGV4dE1lbnVCZWxvdyIsImVsZW1lbnRSZWN0IiwibGVmdCIsIndpbmRvdyIsInBhZ2VYT2Zmc2V0IiwidG9wIiwiYm90dG9tIiwicGFnZVlPZmZzZXQiLCJjaGV2cm9uRmFjZSIsIkNoZXZyb25GYWNlIiwiTm9uZSIsIlJvb21UaWxlIiwiUmVhY3QiLCJQdXJlQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJwcm9wcyIsInJvb20iLCJmb3JjZVVwZGF0ZSIsInByb3BlcnR5IiwiQ2FjaGVkUm9vbUtleSIsIk5vdGlmaWNhdGlvblZvbHVtZSIsIm9uTm90aWZpY2F0aW9uVXBkYXRlIiwicGF5bG9hZCIsImFjdGlvbiIsInJvb21faWQiLCJzaG93X3Jvb21fdGlsZSIsInNldEltbWVkaWF0ZSIsInNjcm9sbEludG9WaWV3IiwiZ2VuZXJhdGVQcmV2aWV3Iiwicm9vbVRpbGVSZWYiLCJjdXJyZW50IiwiYmxvY2siLCJiZWhhdmlvciIsImV2IiwicHJldmVudERlZmF1bHQiLCJzdG9wUHJvcGFnYXRpb24iLCJkaXMiLCJkaXNwYXRjaCIsIkFjdGlvbiIsIlZpZXdSb29tIiwiY2xlYXJfc2VhcmNoIiwia2V5IiwiS2V5IiwiRU5URVIiLCJTUEFDRSIsImlzQWN0aXZlIiwic2V0U3RhdGUiLCJzZWxlY3RlZCIsInRhcmdldCIsIm5vdGlmaWNhdGlvbnNNZW51UG9zaXRpb24iLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJnZW5lcmFsTWVudVBvc2l0aW9uIiwic2hvd0NvbnRleHRNZW51IiwiY2xpZW50WCIsImNsaWVudFkiLCJ0YWdJZCIsIkRlZmF1bHRUYWdJRCIsIkZhdm91cml0ZSIsIkxvd1ByaW9yaXR5IiwiaW52ZXJzZVRhZyIsImlzQXBwbGllZCIsIlJvb21MaXN0U3RvcmUiLCJpbnN0YW5jZSIsImdldFRhZ3NGb3JSb29tIiwiaW5jbHVkZXMiLCJyZW1vdmVUYWciLCJhZGRUYWciLCJSb29tTGlzdEFjdGlvbnMiLCJ0YWdSb29tIiwiTWF0cml4Q2xpZW50UGVnIiwiZ2V0IiwidW5kZWZpbmVkIiwibG9nZ2VyIiwid2FybiIsInNhdmVOb3RpZlN0YXRlIiwiUm9vbU5vdGlmU3RhdGUiLCJBbGxNZXNzYWdlcyIsIkFsbE1lc3NhZ2VzTG91ZCIsIk1lbnRpb25zT25seSIsIk11dGUiLCJzdGF0ZSIsIkFjdGl2ZVJvb21PYnNlcnZlciIsImFjdGl2ZVJvb21JZCIsIm1lc3NhZ2VQcmV2aWV3Iiwibm90aWZpY2F0aW9uU3RhdGUiLCJSb29tTm90aWZpY2F0aW9uU3RhdGVTdG9yZSIsImdldFJvb21TdGF0ZSIsInJvb21Qcm9wcyIsIkVjaG9DaGFtYmVyIiwiZm9yUm9vbSIsInRhZyIsIkludml0ZSIsInNob3dNZXNzYWdlUHJldmlldyIsImlzTWluaW1pemVkIiwiY29tcG9uZW50RGlkVXBkYXRlIiwicHJldlByb3BzIiwicHJldlN0YXRlIiwic2hvd01lc3NhZ2VDaGFuZ2VkIiwibWluaW1pemVkQ2hhbmdlZCIsIk1lc3NhZ2VQcmV2aWV3U3RvcmUiLCJvZmYiLCJnZXRQcmV2aWV3Q2hhbmdlZEV2ZW50TmFtZSIsIm9uUm9vbVByZXZpZXdDaGFuZ2VkIiwib24iLCJDb21tdW5pdHlQcm90b3R5cGVTdG9yZSIsImdldFVwZGF0ZUV2ZW50TmFtZSIsIm9uQ29tbXVuaXR5VXBkYXRlIiwib25Sb29tTmFtZVVwZGF0ZSIsImNvbXBvbmVudERpZE1vdW50IiwiYWRkTGlzdGVuZXIiLCJvbkFjdGl2ZVJvb21VcGRhdGUiLCJkaXNwYXRjaGVyUmVmIiwiZGVmYXVsdERpc3BhdGNoZXIiLCJyZWdpc3RlciIsIm9uQWN0aW9uIiwiTk9USUZJQ0FUSU9OX1NUQVRFX1VQREFURSIsIlBST1BFUlRZX1VQREFURUQiLCJvblJvb21Qcm9wZXJ0eVVwZGF0ZSIsImNvbXBvbmVudFdpbGxVbm1vdW50IiwicmVtb3ZlTGlzdGVuZXIiLCJ1bnJlZ2lzdGVyIiwiZ2V0UHJldmlld0ZvclJvb20iLCJuZXdTdGF0ZSIsImlzR3Vlc3QiLCJub3RpZmljYXRpb25Wb2x1bWUiLCJyZW5kZXJOb3RpZmljYXRpb25zTWVudSIsIkFyY2hpdmVkIiwiY29udGV4dE1lbnUiLCJvbkNsb3NlTm90aWZpY2F0aW9uc01lbnUiLCJvbkNsaWNrQWxsTm90aWZzIiwib25DbGlja0FsZXJ0TWUiLCJvbkNsaWNrTWVudGlvbnMiLCJvbkNsaWNrTXV0ZSIsImNsYXNzZXMiLCJteF9Sb29tVGlsZV9pY29uQmVsbCIsIm14X1Jvb21UaWxlX2ljb25CZWxsRG90IiwibXhfUm9vbVRpbGVfaWNvbkJlbGxNZW50aW9ucyIsIm14X1Jvb21UaWxlX2ljb25CZWxsQ3Jvc3NlZCIsIm14X1Jvb21UaWxlX25vdGlmaWNhdGlvbnNCdXR0b25fc2hvdyIsIm9uTm90aWZpY2F0aW9uc01lbnVPcGVuQ2xpY2siLCJyZW5kZXJHZW5lcmFsTWVudSIsIm9uQ2xvc2VHZW5lcmFsTWVudSIsIm9uRm9yZ2V0Um9vbUNsaWNrIiwicm9vbVRhZ3MiLCJpc0Zhdm9yaXRlIiwiZmF2b3VyaXRlTGFiZWwiLCJpc0xvd1ByaW9yaXR5IiwibG93UHJpb3JpdHlMYWJlbCIsInVzZXJJZCIsImdldFVzZXJJZCIsImNhbkludml0ZSIsImUiLCJvblRhZ1Jvb20iLCJvbkludml0ZUNsaWNrIiwib25Db3B5Um9vbUNsaWNrIiwib25PcGVuUm9vbVNldHRpbmdzIiwib25MZWF2ZVJvb21DbGljayIsIm9uR2VuZXJhbE1lbnVPcGVuQ2xpY2siLCJyZW5kZXIiLCJyb29tUHJvZmlsZSIsImRpc3BsYXlOYW1lIiwiYXZhdGFyTXhjIiwiZ2V0SW52aXRlUHJvZmlsZSIsIm5hbWUiLCJyZXBsYWNlIiwicm9vbUF2YXRhciIsImF2YXRhclVybCIsImJhZGdlIiwibmFtZUNsYXNzZXMiLCJpc1VucmVhZCIsIm5hbWVDb250YWluZXIiLCJhcmlhTGFiZWwiLCJoYXNNZW50aW9ucyIsImNvdW50IiwiaGFzVW5yZWFkQ291bnQiLCJhcmlhRGVzY3JpYmVkQnkiLCJCdXR0b24iLCJBY2Nlc3NpYmxlQnV0dG9uIiwiQWNjZXNzaWJsZVRvb2x0aXBCdXR0b24iLCJ0aXRsZSIsImZvcmNlSGlkZSIsIm9uRm9jdXMiLCJyZWYiLCJvblRpbGVDbGljayIsIm9uQ29udGV4dE1lbnUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFpQkE7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBTUE7O0FBQ0E7O0FBRUE7Ozs7Ozs7O0FBa0JBLE1BQU1BLGdCQUFnQixHQUFJQyxNQUFELElBQXFCLDhCQUE2QkEsTUFBTyxFQUFsRjs7QUFFTyxNQUFNQyxnQkFBZ0IsR0FBSUMsV0FBRCxJQUFpQztBQUM3RDtBQUNBLFFBQU1DLElBQUksR0FBR0QsV0FBVyxDQUFDQyxJQUFaLEdBQW1CQyxNQUFNLENBQUNDLFdBQTFCLEdBQXdDLENBQXJEO0FBQ0EsUUFBTUMsR0FBRyxHQUFHSixXQUFXLENBQUNLLE1BQVosR0FBcUJILE1BQU0sQ0FBQ0ksV0FBNUIsR0FBMEMsRUFBdEQ7QUFDQSxRQUFNQyxXQUFXLEdBQUdDLHlCQUFZQyxJQUFoQztBQUNBLFNBQU87QUFBRVIsSUFBQUEsSUFBRjtBQUFRRyxJQUFBQSxHQUFSO0FBQWFHLElBQUFBO0FBQWIsR0FBUDtBQUNILENBTk07OztJQVNjRyxRLFdBRHBCLGdEQUFxQixzQkFBckIsQyxnQkFBRCxNQUNxQkEsUUFEckIsU0FDc0NDLGVBQU1DLGFBRDVDLENBQzBFO0FBTXRFQyxFQUFBQSxXQUFXLENBQUNDLEtBQUQsRUFBZ0I7QUFDdkIsVUFBTUEsS0FBTjtBQUR1QjtBQUFBLG9FQUpMLHVCQUlLO0FBQUE7QUFBQTtBQUFBLDREQWlCQ0MsSUFBRCxJQUFnQjtBQUN2QyxXQUFLQyxXQUFMO0FBQ0gsS0FuQjBCO0FBQUEsZ0VBcUJJLE1BQU07QUFDakMsV0FBS0EsV0FBTCxHQURpQyxDQUNiO0FBQ3ZCLEtBdkIwQjtBQUFBLGdFQXlCS0MsUUFBRCxJQUE2QjtBQUN4RCxVQUFJQSxRQUFRLEtBQUtDLCtCQUFjQyxrQkFBL0IsRUFBbUQsS0FBS0Msb0JBQUwsR0FESyxDQUV4RDtBQUNILEtBNUIwQjtBQUFBLG9EQThHUEMsT0FBRCxJQUE0QjtBQUMzQyxVQUFJQSxPQUFPLENBQUNDLE1BQVIsS0FBbUIsV0FBbkIsSUFBa0NELE9BQU8sQ0FBQ0UsT0FBUixLQUFvQixLQUFLVCxLQUFMLENBQVdDLElBQVgsQ0FBZ0JqQixNQUF0RSxJQUFnRnVCLE9BQU8sQ0FBQ0csY0FBNUYsRUFBNEc7QUFDeEdDLFFBQUFBLFlBQVksQ0FBQyxNQUFNO0FBQ2YsZUFBS0MsY0FBTDtBQUNILFNBRlcsQ0FBWjtBQUdIO0FBQ0osS0FwSDBCO0FBQUEsNkRBc0hFNUIsTUFBRCxJQUFvQjtBQUM1QyxVQUFJQSxNQUFNLEtBQUssS0FBS2dCLEtBQUwsQ0FBV0MsSUFBWCxDQUFnQmpCLE1BQS9CLEVBQXVDO0FBQ3ZDLFdBQUtrQixXQUFMLEdBRjRDLENBRXhCO0FBQ3ZCLEtBekgwQjtBQUFBLGdFQTJIS0QsSUFBRCxJQUFnQjtBQUMzQyxVQUFJLEtBQUtELEtBQUwsQ0FBV0MsSUFBWCxJQUFtQkEsSUFBSSxDQUFDakIsTUFBTCxLQUFnQixLQUFLZ0IsS0FBTCxDQUFXQyxJQUFYLENBQWdCakIsTUFBdkQsRUFBK0Q7QUFDM0QsYUFBSzZCLGVBQUw7QUFDSDtBQUNKLEtBL0gwQjtBQUFBLDBEQTBJRixNQUFNO0FBQzNCLFVBQUksQ0FBQyxLQUFLQyxXQUFMLENBQWlCQyxPQUF0QixFQUErQjtBQUMvQixXQUFLRCxXQUFMLENBQWlCQyxPQUFqQixDQUF5QkgsY0FBekIsQ0FBd0M7QUFDcENJLFFBQUFBLEtBQUssRUFBRSxTQUQ2QjtBQUVwQ0MsUUFBQUEsUUFBUSxFQUFFO0FBRjBCLE9BQXhDO0FBSUgsS0FoSjBCO0FBQUEsdURBa0pKQyxFQUFELElBQTZCO0FBQy9DQSxNQUFBQSxFQUFFLENBQUNDLGNBQUg7QUFDQUQsTUFBQUEsRUFBRSxDQUFDRSxlQUFIOztBQUNBQywwQkFBSUMsUUFBSixDQUFhO0FBQ1RkLFFBQUFBLE1BQU0sRUFBRWUsZ0JBQU9DLFFBRE47QUFFVGQsUUFBQUEsY0FBYyxFQUFFLElBRlA7QUFFYTtBQUN0QkQsUUFBQUEsT0FBTyxFQUFFLEtBQUtULEtBQUwsQ0FBV0MsSUFBWCxDQUFnQmpCLE1BSGhCO0FBSVR5QyxRQUFBQSxZQUFZLEVBQUdQLEVBQUUsS0FBS0EsRUFBRSxDQUFDUSxHQUFILEtBQVdDLGNBQUlDLEtBQWYsSUFBd0JWLEVBQUUsQ0FBQ1EsR0FBSCxLQUFXQyxjQUFJRSxLQUE1QztBQUpSLE9BQWI7QUFNSCxLQTNKMEI7QUFBQSw4REE2SkdDLFFBQUQsSUFBdUI7QUFDaEQsV0FBS0MsUUFBTCxDQUFjO0FBQUVDLFFBQUFBLFFBQVEsRUFBRUY7QUFBWixPQUFkO0FBQ0gsS0EvSjBCO0FBQUEsd0VBaUthWixFQUFELElBQTBCO0FBQzdEQSxNQUFBQSxFQUFFLENBQUNDLGNBQUg7QUFDQUQsTUFBQUEsRUFBRSxDQUFDRSxlQUFIO0FBQ0EsWUFBTWEsTUFBTSxHQUFHZixFQUFFLENBQUNlLE1BQWxCO0FBQ0EsV0FBS0YsUUFBTCxDQUFjO0FBQUVHLFFBQUFBLHlCQUF5QixFQUFFRCxNQUFNLENBQUNFLHFCQUFQO0FBQTdCLE9BQWQ7QUFDSCxLQXRLMEI7QUFBQSxvRUF3S1EsTUFBTTtBQUNyQyxXQUFLSixRQUFMLENBQWM7QUFBRUcsUUFBQUEseUJBQXlCLEVBQUU7QUFBN0IsT0FBZDtBQUNILEtBMUswQjtBQUFBLGtFQTRLT2hCLEVBQUQsSUFBMEI7QUFDdkRBLE1BQUFBLEVBQUUsQ0FBQ0MsY0FBSDtBQUNBRCxNQUFBQSxFQUFFLENBQUNFLGVBQUg7QUFDQSxZQUFNYSxNQUFNLEdBQUdmLEVBQUUsQ0FBQ2UsTUFBbEI7QUFDQSxXQUFLRixRQUFMLENBQWM7QUFBRUssUUFBQUEsbUJBQW1CLEVBQUVILE1BQU0sQ0FBQ0UscUJBQVA7QUFBdkIsT0FBZDtBQUNILEtBakwwQjtBQUFBLHlEQW1MRmpCLEVBQUQsSUFBMEI7QUFDOUM7QUFDQSxVQUFJLENBQUMsS0FBS21CLGVBQVYsRUFBMkI7QUFFM0JuQixNQUFBQSxFQUFFLENBQUNDLGNBQUg7QUFDQUQsTUFBQUEsRUFBRSxDQUFDRSxlQUFIO0FBQ0EsV0FBS1csUUFBTCxDQUFjO0FBQ1ZLLFFBQUFBLG1CQUFtQixFQUFFO0FBQ2pCakQsVUFBQUEsSUFBSSxFQUFFK0IsRUFBRSxDQUFDb0IsT0FEUTtBQUVqQi9DLFVBQUFBLE1BQU0sRUFBRTJCLEVBQUUsQ0FBQ3FCO0FBRk07QUFEWCxPQUFkO0FBTUgsS0EvTDBCO0FBQUEsOERBaU1FLE1BQU07QUFDL0IsV0FBS1IsUUFBTCxDQUFjO0FBQUVLLFFBQUFBLG1CQUFtQixFQUFFO0FBQXZCLE9BQWQ7QUFDSCxLQW5NMEI7QUFBQSxxREFxTVAsQ0FBQ2xCLEVBQUQsRUFBa0JzQixLQUFsQixLQUFtQztBQUNuRHRCLE1BQUFBLEVBQUUsQ0FBQ0MsY0FBSDtBQUNBRCxNQUFBQSxFQUFFLENBQUNFLGVBQUg7O0FBRUEsVUFBSW9CLEtBQUssS0FBS0MscUJBQWFDLFNBQXZCLElBQW9DRixLQUFLLEtBQUtDLHFCQUFhRSxXQUEvRCxFQUE0RTtBQUN4RSxjQUFNQyxVQUFVLEdBQUdKLEtBQUssS0FBS0MscUJBQWFDLFNBQXZCLEdBQW1DRCxxQkFBYUUsV0FBaEQsR0FBOERGLHFCQUFhQyxTQUE5Rjs7QUFDQSxjQUFNRyxTQUFTLEdBQUdDLHVCQUFjQyxRQUFkLENBQXVCQyxjQUF2QixDQUFzQyxLQUFLaEQsS0FBTCxDQUFXQyxJQUFqRCxFQUF1RGdELFFBQXZELENBQWdFVCxLQUFoRSxDQUFsQjs7QUFDQSxjQUFNVSxTQUFTLEdBQUdMLFNBQVMsR0FBR0wsS0FBSCxHQUFXSSxVQUF0QztBQUNBLGNBQU1PLE1BQU0sR0FBR04sU0FBUyxHQUFHLElBQUgsR0FBVUwsS0FBbEM7O0FBQ0FuQiw0QkFBSUMsUUFBSixDQUFhOEIseUJBQWdCQyxPQUFoQixDQUNUQyxpQ0FBZ0JDLEdBQWhCLEVBRFMsRUFFVCxLQUFLdkQsS0FBTCxDQUFXQyxJQUZGLEVBR1RpRCxTQUhTLEVBSVRDLE1BSlMsRUFLVEssU0FMUyxFQU1ULENBTlMsQ0FBYjtBQVFILE9BYkQsTUFhTztBQUNIQyx1QkFBT0MsSUFBUCxDQUFhLGtCQUFpQmxCLEtBQU0sZUFBYyxLQUFLeEMsS0FBTCxDQUFXQyxJQUFYLENBQWdCakIsTUFBTyxFQUF6RTtBQUNIOztBQUVELFVBQUtrQyxFQUFELENBQTRCUSxHQUE1QixLQUFvQ0MsY0FBSUMsS0FBNUMsRUFBbUQ7QUFDL0M7QUFDQSxhQUFLRyxRQUFMLENBQWM7QUFBRUssVUFBQUEsbUJBQW1CLEVBQUU7QUFBdkIsU0FBZCxFQUYrQyxDQUVEO0FBQ2pEO0FBQ0osS0E5TjBCO0FBQUEsNERBZ09DbEIsRUFBRCxJQUFxQjtBQUM1Q0EsTUFBQUEsRUFBRSxDQUFDQyxjQUFIO0FBQ0FELE1BQUFBLEVBQUUsQ0FBQ0UsZUFBSDs7QUFFQUMsMEJBQUlDLFFBQUosQ0FBYTtBQUNUZCxRQUFBQSxNQUFNLEVBQUUsWUFEQztBQUVUQyxRQUFBQSxPQUFPLEVBQUUsS0FBS1QsS0FBTCxDQUFXQyxJQUFYLENBQWdCakI7QUFGaEIsT0FBYjs7QUFJQSxXQUFLK0MsUUFBTCxDQUFjO0FBQUVLLFFBQUFBLG1CQUFtQixFQUFFO0FBQXZCLE9BQWQsRUFSNEMsQ0FRRTtBQUNqRCxLQXpPMEI7QUFBQSw2REEyT0VsQixFQUFELElBQXFCO0FBQzdDQSxNQUFBQSxFQUFFLENBQUNDLGNBQUg7QUFDQUQsTUFBQUEsRUFBRSxDQUFDRSxlQUFIOztBQUVBQywwQkFBSUMsUUFBSixDQUFhO0FBQ1RkLFFBQUFBLE1BQU0sRUFBRSxhQURDO0FBRVRDLFFBQUFBLE9BQU8sRUFBRSxLQUFLVCxLQUFMLENBQVdDLElBQVgsQ0FBZ0JqQjtBQUZoQixPQUFiOztBQUlBLFdBQUsrQyxRQUFMLENBQWM7QUFBRUssUUFBQUEsbUJBQW1CLEVBQUU7QUFBdkIsT0FBZCxFQVI2QyxDQVFDO0FBQ2pELEtBcFAwQjtBQUFBLDhEQXNQR2xCLEVBQUQsSUFBcUI7QUFDOUNBLE1BQUFBLEVBQUUsQ0FBQ0MsY0FBSDtBQUNBRCxNQUFBQSxFQUFFLENBQUNFLGVBQUg7O0FBRUFDLDBCQUFJQyxRQUFKLENBQWE7QUFDVGQsUUFBQUEsTUFBTSxFQUFFLG9CQURDO0FBRVRDLFFBQUFBLE9BQU8sRUFBRSxLQUFLVCxLQUFMLENBQVdDLElBQVgsQ0FBZ0JqQjtBQUZoQixPQUFiOztBQUlBLFdBQUsrQyxRQUFMLENBQWM7QUFBRUssUUFBQUEsbUJBQW1CLEVBQUU7QUFBdkIsT0FBZCxFQVI4QyxDQVFBO0FBQ2pELEtBL1AwQjtBQUFBLDJEQWlRQWxCLEVBQUQsSUFBcUI7QUFDM0NBLE1BQUFBLEVBQUUsQ0FBQ0MsY0FBSDtBQUNBRCxNQUFBQSxFQUFFLENBQUNFLGVBQUg7O0FBRUFDLDBCQUFJQyxRQUFKLENBQWE7QUFDVGQsUUFBQUEsTUFBTSxFQUFFLFdBREM7QUFFVEMsUUFBQUEsT0FBTyxFQUFFLEtBQUtULEtBQUwsQ0FBV0MsSUFBWCxDQUFnQmpCO0FBRmhCLE9BQWI7O0FBSUEsV0FBSytDLFFBQUwsQ0FBYztBQUFFSyxRQUFBQSxtQkFBbUIsRUFBRTtBQUF2QixPQUFkLEVBUjJDLENBUUc7QUFDakQsS0ExUTBCO0FBQUEseURBNFFGbEIsRUFBRCxJQUFxQjtBQUN6Q0EsTUFBQUEsRUFBRSxDQUFDQyxjQUFIO0FBQ0FELE1BQUFBLEVBQUUsQ0FBQ0UsZUFBSDs7QUFFQUMsMEJBQUlDLFFBQUosQ0FBYTtBQUNUZCxRQUFBQSxNQUFNLEVBQUUsYUFEQztBQUVUeEIsUUFBQUEsTUFBTSxFQUFFLEtBQUtnQixLQUFMLENBQVdDLElBQVgsQ0FBZ0JqQjtBQUZmLE9BQWI7O0FBSUEsV0FBSytDLFFBQUwsQ0FBYztBQUFFSyxRQUFBQSxtQkFBbUIsRUFBRTtBQUF2QixPQUFkLEVBUnlDLENBUUs7QUFDakQsS0FyUjBCO0FBQUEsNERBcVNBbEIsRUFBRSxJQUFJLEtBQUt5QyxjQUFMLENBQW9CekMsRUFBcEIsRUFBd0IwQywyQkFBZUMsV0FBdkMsQ0FyU047QUFBQSwwREFzU0YzQyxFQUFFLElBQUksS0FBS3lDLGNBQUwsQ0FBb0J6QyxFQUFwQixFQUF3QjBDLDJCQUFlRSxlQUF2QyxDQXRTSjtBQUFBLDJEQXVTRDVDLEVBQUUsSUFBSSxLQUFLeUMsY0FBTCxDQUFvQnpDLEVBQXBCLEVBQXdCMEMsMkJBQWVHLFlBQXZDLENBdlNMO0FBQUEsdURBd1NMN0MsRUFBRSxJQUFJLEtBQUt5QyxjQUFMLENBQW9CekMsRUFBcEIsRUFBd0IwQywyQkFBZUksSUFBdkMsQ0F4U0Q7QUFHdkIsU0FBS0MsS0FBTCxHQUFhO0FBQ1RqQyxNQUFBQSxRQUFRLEVBQUVrQyw0QkFBbUJDLFlBQW5CLEtBQW9DLEtBQUtuRSxLQUFMLENBQVdDLElBQVgsQ0FBZ0JqQixNQURyRDtBQUVUa0QsTUFBQUEseUJBQXlCLEVBQUUsSUFGbEI7QUFHVEUsTUFBQUEsbUJBQW1CLEVBQUUsSUFIWjtBQUtUO0FBQ0FnQyxNQUFBQSxjQUFjLEVBQUU7QUFOUCxLQUFiO0FBUUEsU0FBS3ZELGVBQUw7QUFFQSxTQUFLd0QsaUJBQUwsR0FBeUJDLHVEQUEyQnZCLFFBQTNCLENBQW9Dd0IsWUFBcEMsQ0FBaUQsS0FBS3ZFLEtBQUwsQ0FBV0MsSUFBNUQsQ0FBekI7QUFDQSxTQUFLdUUsU0FBTCxHQUFpQkMseUJBQVlDLE9BQVosQ0FBb0IsS0FBSzFFLEtBQUwsQ0FBV0MsSUFBL0IsQ0FBakI7QUFDSDs7QUFlMEIsTUFBZm9DLGVBQWUsR0FBWTtBQUNuQyxXQUFPLEtBQUtyQyxLQUFMLENBQVcyRSxHQUFYLEtBQW1CbEMscUJBQWFtQyxNQUF2QztBQUNIOztBQUU2QixNQUFsQkMsa0JBQWtCLEdBQVk7QUFDdEMsV0FBTyxDQUFDLEtBQUs3RSxLQUFMLENBQVc4RSxXQUFaLElBQTJCLEtBQUs5RSxLQUFMLENBQVc2RSxrQkFBN0M7QUFDSDs7QUFFTUUsRUFBQUEsa0JBQWtCLENBQUNDLFNBQUQsRUFBOEJDLFNBQTlCLEVBQTJEO0FBQUE7O0FBQ2hGLFVBQU1DLGtCQUFrQixHQUFHRixTQUFTLENBQUNILGtCQUFWLEtBQWlDLEtBQUs3RSxLQUFMLENBQVc2RSxrQkFBdkU7QUFDQSxVQUFNTSxnQkFBZ0IsR0FBR0gsU0FBUyxDQUFDRixXQUFWLEtBQTBCLEtBQUs5RSxLQUFMLENBQVc4RSxXQUE5RDs7QUFDQSxRQUFJSSxrQkFBa0IsSUFBSUMsZ0JBQTFCLEVBQTRDO0FBQ3hDLFdBQUt0RSxlQUFMO0FBQ0g7O0FBQ0QsUUFBSSxvQkFBQW1FLFNBQVMsQ0FBQy9FLElBQVYsb0VBQWdCakIsTUFBaEIsMkJBQTJCLEtBQUtnQixLQUFMLENBQVdDLElBQXRDLHFEQUEyQixpQkFBaUJqQixNQUE1QyxDQUFKLEVBQXdEO0FBQUE7O0FBQ3BEb0csK0NBQW9CckMsUUFBcEIsQ0FBNkJzQyxHQUE3QixDQUNJRCx5Q0FBb0JFLDBCQUFwQixDQUErQ04sU0FBUyxDQUFDL0UsSUFBekQsQ0FESixFQUVJLEtBQUtzRixvQkFGVDs7QUFJQUgsK0NBQW9CckMsUUFBcEIsQ0FBNkJ5QyxFQUE3QixDQUNJSix5Q0FBb0JFLDBCQUFwQixDQUErQyxLQUFLdEYsS0FBTCxDQUFXQyxJQUExRCxDQURKLEVBRUksS0FBS3NGLG9CQUZUOztBQUlBRSx1REFBd0IxQyxRQUF4QixDQUFpQ3NDLEdBQWpDLENBQ0lJLGlEQUF3QkMsa0JBQXhCLHFCQUEyQ1YsU0FBUyxDQUFDL0UsSUFBckQscURBQTJDLGlCQUFnQmpCLE1BQTNELENBREosRUFFSSxLQUFLMkcsaUJBRlQ7O0FBSUFGLHVEQUF3QjFDLFFBQXhCLENBQWlDeUMsRUFBakMsQ0FDSUMsaURBQXdCQyxrQkFBeEIsc0JBQTJDLEtBQUsxRixLQUFMLENBQVdDLElBQXRELHNEQUEyQyxrQkFBaUJqQixNQUE1RCxDQURKLEVBRUksS0FBSzJHLGlCQUZUOztBQUlBLDBCQUFBWCxTQUFTLENBQUMvRSxJQUFWLHNFQUFnQm9GLEdBQWhCLENBQW9CLFdBQXBCLEVBQWlDLEtBQUtPLGdCQUF0QztBQUNBLGdDQUFLNUYsS0FBTCxDQUFXQyxJQUFYLHdFQUFpQnVGLEVBQWpCLENBQW9CLFdBQXBCLEVBQWlDLEtBQUtJLGdCQUF0QztBQUNIO0FBQ0o7O0FBRU1DLEVBQUFBLGlCQUFpQixHQUFHO0FBQUE7O0FBQ3ZCO0FBQ0EsUUFBSSxLQUFLNUIsS0FBTCxDQUFXakMsUUFBZixFQUF5QjtBQUNyQixXQUFLcEIsY0FBTDtBQUNIOztBQUVEc0QsZ0NBQW1CNEIsV0FBbkIsQ0FBK0IsS0FBSzlGLEtBQUwsQ0FBV0MsSUFBWCxDQUFnQmpCLE1BQS9DLEVBQXVELEtBQUsrRyxrQkFBNUQ7O0FBQ0EsU0FBS0MsYUFBTCxHQUFxQkMsb0JBQWtCQyxRQUFsQixDQUEyQixLQUFLQyxRQUFoQyxDQUFyQjs7QUFDQWYsNkNBQW9CckMsUUFBcEIsQ0FBNkJ5QyxFQUE3QixDQUNJSix5Q0FBb0JFLDBCQUFwQixDQUErQyxLQUFLdEYsS0FBTCxDQUFXQyxJQUExRCxDQURKLEVBRUksS0FBS3NGLG9CQUZUOztBQUlBLFNBQUtsQixpQkFBTCxDQUF1Qm1CLEVBQXZCLENBQTBCWSw0Q0FBMUIsRUFBcUQsS0FBSzlGLG9CQUExRDtBQUNBLFNBQUtrRSxTQUFMLENBQWVnQixFQUFmLENBQWtCYSxvQ0FBbEIsRUFBb0MsS0FBS0Msb0JBQXpDO0FBQ0EsOEJBQUt0RyxLQUFMLENBQVdDLElBQVgsd0VBQWlCdUYsRUFBakIsQ0FBb0IsV0FBcEIsRUFBaUMsS0FBS0ksZ0JBQXRDOztBQUNBSCxxREFBd0IxQyxRQUF4QixDQUFpQ3lDLEVBQWpDLENBQ0lDLGlEQUF3QkMsa0JBQXhCLENBQTJDLEtBQUsxRixLQUFMLENBQVdDLElBQVgsQ0FBZ0JqQixNQUEzRCxDQURKLEVBRUksS0FBSzJHLGlCQUZUO0FBSUg7O0FBRU1ZLEVBQUFBLG9CQUFvQixHQUFHO0FBQzFCLFFBQUksS0FBS3ZHLEtBQUwsQ0FBV0MsSUFBZixFQUFxQjtBQUNqQmlFLGtDQUFtQnNDLGNBQW5CLENBQWtDLEtBQUt4RyxLQUFMLENBQVdDLElBQVgsQ0FBZ0JqQixNQUFsRCxFQUEwRCxLQUFLK0csa0JBQS9EOztBQUNBWCwrQ0FBb0JyQyxRQUFwQixDQUE2QnNDLEdBQTdCLENBQ0lELHlDQUFvQkUsMEJBQXBCLENBQStDLEtBQUt0RixLQUFMLENBQVdDLElBQTFELENBREosRUFFSSxLQUFLc0Ysb0JBRlQ7O0FBSUFFLHVEQUF3QjFDLFFBQXhCLENBQWlDc0MsR0FBakMsQ0FDSUksaURBQXdCQyxrQkFBeEIsQ0FBMkMsS0FBSzFGLEtBQUwsQ0FBV0MsSUFBWCxDQUFnQmpCLE1BQTNELENBREosRUFFSSxLQUFLMkcsaUJBRlQ7O0FBSUEsV0FBSzNGLEtBQUwsQ0FBV0MsSUFBWCxDQUFnQm9GLEdBQWhCLENBQW9CLFdBQXBCLEVBQWlDLEtBQUtPLGdCQUF0QztBQUNIOztBQUNEMUIsZ0NBQW1Cc0MsY0FBbkIsQ0FBa0MsS0FBS3hHLEtBQUwsQ0FBV0MsSUFBWCxDQUFnQmpCLE1BQWxELEVBQTBELEtBQUsrRyxrQkFBL0Q7O0FBQ0FFLHdCQUFrQlEsVUFBbEIsQ0FBNkIsS0FBS1QsYUFBbEM7O0FBQ0EsU0FBSzNCLGlCQUFMLENBQXVCZ0IsR0FBdkIsQ0FBMkJlLDRDQUEzQixFQUFzRCxLQUFLOUYsb0JBQTNEO0FBQ0EsU0FBS2tFLFNBQUwsQ0FBZWEsR0FBZixDQUFtQmdCLG9DQUFuQixFQUFxQyxLQUFLQyxvQkFBMUM7O0FBQ0FiLHFEQUF3QjFDLFFBQXhCLENBQWlDc0MsR0FBakMsQ0FDSUksaURBQXdCQyxrQkFBeEIsQ0FBMkMsS0FBSzFGLEtBQUwsQ0FBV0MsSUFBWCxDQUFnQmpCLE1BQTNELENBREosRUFFSSxLQUFLMkcsaUJBRlQ7QUFJSDs7QUFxQjRCLFFBQWY5RSxlQUFlLEdBQUc7QUFDNUIsUUFBSSxDQUFDLEtBQUtnRSxrQkFBVixFQUE4QjtBQUMxQixhQUFPLElBQVA7QUFDSDs7QUFFRCxVQUFNVCxjQUFjLEdBQUcsTUFBTWdCLHlDQUFvQnJDLFFBQXBCLENBQTZCMkQsaUJBQTdCLENBQStDLEtBQUsxRyxLQUFMLENBQVdDLElBQTFELEVBQWdFLEtBQUtELEtBQUwsQ0FBVzJFLEdBQTNFLENBQTdCO0FBQ0EsU0FBSzVDLFFBQUwsQ0FBYztBQUFFcUMsTUFBQUE7QUFBRixLQUFkO0FBQ0g7O0FBK0kyQixRQUFkVCxjQUFjLENBQUN6QyxFQUFELEVBQWtCeUYsUUFBbEIsRUFBNEM7QUFDcEV6RixJQUFBQSxFQUFFLENBQUNDLGNBQUg7QUFDQUQsSUFBQUEsRUFBRSxDQUFDRSxlQUFIO0FBQ0EsUUFBSWtDLGlDQUFnQkMsR0FBaEIsR0FBc0JxRCxPQUF0QixFQUFKLEVBQXFDO0FBRXJDLFNBQUtwQyxTQUFMLENBQWVxQyxrQkFBZixHQUFvQ0YsUUFBcEM7QUFFQSxVQUFNakYsR0FBRyxHQUFJUixFQUFELENBQTRCUSxHQUF4Qzs7QUFDQSxRQUFJQSxHQUFHLEtBQUtDLGNBQUlDLEtBQWhCLEVBQXVCO0FBQ25CO0FBQ0EsV0FBS0csUUFBTCxDQUFjO0FBQUVHLFFBQUFBLHlCQUF5QixFQUFFO0FBQTdCLE9BQWQsRUFGbUIsQ0FFaUM7QUFDdkQ7QUFDSjs7QUFPTzRFLEVBQUFBLHVCQUF1QixDQUFDaEYsUUFBRCxFQUF3QztBQUNuRSxRQUFJd0IsaUNBQWdCQyxHQUFoQixHQUFzQnFELE9BQXRCLE1BQW1DLEtBQUs1RyxLQUFMLENBQVcyRSxHQUFYLEtBQW1CbEMscUJBQWFzRSxRQUFuRSxJQUNBLENBQUMsS0FBSzFFLGVBRE4sSUFDeUIsS0FBS3JDLEtBQUwsQ0FBVzhFLFdBRHhDLEVBRUU7QUFDRTtBQUNBLGFBQU8sSUFBUDtBQUNIOztBQUVELFVBQU1iLEtBQUssR0FBRyxLQUFLTyxTQUFMLENBQWVxQyxrQkFBN0I7QUFFQSxRQUFJRyxXQUFXLEdBQUcsSUFBbEI7O0FBQ0EsUUFBSSxLQUFLL0MsS0FBTCxDQUFXL0IseUJBQWYsRUFBMEM7QUFDdEM4RSxNQUFBQSxXQUFXLGdCQUFHLDZCQUFDLDRCQUFELDZCQUNOL0gsZ0JBQWdCLENBQUMsS0FBS2dGLEtBQUwsQ0FBVy9CLHlCQUFaLENBRFY7QUFFVixRQUFBLFVBQVUsRUFBRSxLQUFLK0Usd0JBRlA7QUFHVixRQUFBLFNBQVMsRUFBQyx5QkFIQTtBQUlWLFFBQUEsT0FBTztBQUpHLHVCQU1WLDZCQUFDLGtEQUFEO0FBQStCLFFBQUEsS0FBSztBQUFwQyxzQkFDSSw2QkFBQyw2Q0FBRDtBQUNJLFFBQUEsS0FBSyxFQUFFLHlCQUFHLGFBQUgsQ0FEWDtBQUVJLFFBQUEsTUFBTSxFQUFFaEQsS0FBSyxLQUFLTCwyQkFBZUMsV0FGckM7QUFHSSxRQUFBLGFBQWEsRUFBQyxzQkFIbEI7QUFJSSxRQUFBLE9BQU8sRUFBRSxLQUFLcUQ7QUFKbEIsUUFESixlQU9JLDZCQUFDLDZDQUFEO0FBQ0ksUUFBQSxLQUFLLEVBQUUseUJBQUcsY0FBSCxDQURYO0FBRUksUUFBQSxNQUFNLEVBQUVqRCxLQUFLLEtBQUtMLDJCQUFlRSxlQUZyQztBQUdJLFFBQUEsYUFBYSxFQUFDLHlCQUhsQjtBQUlJLFFBQUEsT0FBTyxFQUFFLEtBQUtxRDtBQUpsQixRQVBKLGVBYUksNkJBQUMsNkNBQUQ7QUFDSSxRQUFBLEtBQUssRUFBRSx5QkFBRyxxQkFBSCxDQURYO0FBRUksUUFBQSxNQUFNLEVBQUVsRCxLQUFLLEtBQUtMLDJCQUFlRyxZQUZyQztBQUdJLFFBQUEsYUFBYSxFQUFDLDhCQUhsQjtBQUlJLFFBQUEsT0FBTyxFQUFFLEtBQUtxRDtBQUpsQixRQWJKLGVBbUJJLDZCQUFDLDZDQUFEO0FBQ0ksUUFBQSxLQUFLLEVBQUUseUJBQUcsTUFBSCxDQURYO0FBRUksUUFBQSxNQUFNLEVBQUVuRCxLQUFLLEtBQUtMLDJCQUFlSSxJQUZyQztBQUdJLFFBQUEsYUFBYSxFQUFDLDZCQUhsQjtBQUlJLFFBQUEsT0FBTyxFQUFFLEtBQUtxRDtBQUpsQixRQW5CSixDQU5VLENBQWQ7QUFpQ0g7O0FBRUQsVUFBTUMsT0FBTyxHQUFHLHlCQUFXLGlDQUFYLEVBQThDO0FBQzFEO0FBQ0FDLE1BQUFBLG9CQUFvQixFQUFFdEQsS0FBSyxLQUFLTCwyQkFBZUMsV0FGVztBQUcxRDJELE1BQUFBLHVCQUF1QixFQUFFdkQsS0FBSyxLQUFLTCwyQkFBZUUsZUFIUTtBQUkxRDJELE1BQUFBLDRCQUE0QixFQUFFeEQsS0FBSyxLQUFLTCwyQkFBZUcsWUFKRztBQUsxRDJELE1BQUFBLDJCQUEyQixFQUFFekQsS0FBSyxLQUFLTCwyQkFBZUksSUFMSTtBQU8xRDtBQUNBO0FBQ0EyRCxNQUFBQSxvQ0FBb0MsRUFBRTFELEtBQUssS0FBS0wsMkJBQWVJO0FBVEwsS0FBOUMsQ0FBaEI7QUFZQSx3QkFDSSw2QkFBQyxjQUFELENBQU8sUUFBUCxxQkFDSSw2QkFBQyxxQ0FBRDtBQUNJLE1BQUEsU0FBUyxFQUFFc0QsT0FEZjtBQUVJLE1BQUEsT0FBTyxFQUFFLEtBQUtNLDRCQUZsQjtBQUdJLE1BQUEsS0FBSyxFQUFFLHlCQUFHLHNCQUFILENBSFg7QUFJSSxNQUFBLFVBQVUsRUFBRSxDQUFDLENBQUMsS0FBSzNELEtBQUwsQ0FBVy9CLHlCQUo3QjtBQUtJLE1BQUEsUUFBUSxFQUFFSixRQUFRLEdBQUcsQ0FBSCxHQUFPLENBQUM7QUFMOUIsTUFESixFQVFNa0YsV0FSTixDQURKO0FBWUg7O0FBRU9hLEVBQUFBLGlCQUFpQixHQUF1QjtBQUM1QyxRQUFJLENBQUMsS0FBS3hGLGVBQVYsRUFBMkIsT0FBTyxJQUFQLENBRGlCLENBQ0o7O0FBRXhDLFFBQUkyRSxXQUFXLEdBQUcsSUFBbEI7O0FBQ0EsUUFBSSxLQUFLL0MsS0FBTCxDQUFXN0IsbUJBQVgsSUFBa0MsS0FBS3BDLEtBQUwsQ0FBVzJFLEdBQVgsS0FBbUJsQyxxQkFBYXNFLFFBQXRFLEVBQWdGO0FBQzVFQyxNQUFBQSxXQUFXLGdCQUFHLDZCQUFDLDRCQUFELDZCQUNOL0gsZ0JBQWdCLENBQUMsS0FBS2dGLEtBQUwsQ0FBVzdCLG1CQUFaLENBRFY7QUFFVixRQUFBLFVBQVUsRUFBRSxLQUFLMEYsa0JBRlA7QUFHVixRQUFBLFNBQVMsRUFBQyx5QkFIQTtBQUlWLFFBQUEsT0FBTztBQUpHLHVCQU1WLDZCQUFDLGtEQUFEO0FBQStCLFFBQUEsR0FBRztBQUFsQyxzQkFDSSw2QkFBQyw4Q0FBRDtBQUNJLFFBQUEsYUFBYSxFQUFDLHlCQURsQjtBQUVJLFFBQUEsS0FBSyxFQUFFLHlCQUFHLGFBQUgsQ0FGWDtBQUdJLFFBQUEsT0FBTyxFQUFFLEtBQUtDO0FBSGxCLFFBREosQ0FOVSxDQUFkO0FBY0gsS0FmRCxNQWVPLElBQUksS0FBSzlELEtBQUwsQ0FBVzdCLG1CQUFmLEVBQW9DO0FBQ3ZDLFlBQU00RixRQUFRLEdBQUdsRix1QkFBY0MsUUFBZCxDQUF1QkMsY0FBdkIsQ0FBc0MsS0FBS2hELEtBQUwsQ0FBV0MsSUFBakQsQ0FBakI7O0FBRUEsWUFBTWdJLFVBQVUsR0FBR0QsUUFBUSxDQUFDL0UsUUFBVCxDQUFrQlIscUJBQWFDLFNBQS9CLENBQW5CO0FBQ0EsWUFBTXdGLGNBQWMsR0FBR0QsVUFBVSxHQUFHLHlCQUFHLFlBQUgsQ0FBSCxHQUFzQix5QkFBRyxXQUFILENBQXZEO0FBRUEsWUFBTUUsYUFBYSxHQUFHSCxRQUFRLENBQUMvRSxRQUFULENBQWtCUixxQkFBYUUsV0FBL0IsQ0FBdEI7QUFDQSxZQUFNeUYsZ0JBQWdCLEdBQUcseUJBQUcsY0FBSCxDQUF6Qjs7QUFFQSxZQUFNQyxNQUFNLEdBQUcvRSxpQ0FBZ0JDLEdBQWhCLEdBQXNCK0UsU0FBdEIsRUFBZjs7QUFDQSxZQUFNQyxTQUFTLEdBQUcsS0FBS3ZJLEtBQUwsQ0FBV0MsSUFBWCxDQUFnQnNJLFNBQWhCLENBQTBCRixNQUExQixDQUFsQjtBQUNBckIsTUFBQUEsV0FBVyxnQkFBRyw2QkFBQyw0QkFBRCw2QkFDTi9ILGdCQUFnQixDQUFDLEtBQUtnRixLQUFMLENBQVc3QixtQkFBWixDQURWO0FBRVYsUUFBQSxVQUFVLEVBQUUsS0FBSzBGLGtCQUZQO0FBR1YsUUFBQSxTQUFTLEVBQUMseUJBSEE7QUFJVixRQUFBLE9BQU87QUFKRyx1QkFNViw2QkFBQyxrREFBRCxxQkFDSSw2QkFBQyxnREFBRDtBQUNJLFFBQUEsT0FBTyxFQUFHVSxDQUFELElBQU8sS0FBS0MsU0FBTCxDQUFlRCxDQUFmLEVBQWtCL0YscUJBQWFDLFNBQS9CLENBRHBCO0FBRUksUUFBQSxNQUFNLEVBQUV1RixVQUZaO0FBR0ksUUFBQSxLQUFLLEVBQUVDLGNBSFg7QUFJSSxRQUFBLGFBQWEsRUFBQztBQUpsQixRQURKLGVBT0ksNkJBQUMsZ0RBQUQ7QUFDSSxRQUFBLE9BQU8sRUFBR00sQ0FBRCxJQUFPLEtBQUtDLFNBQUwsQ0FBZUQsQ0FBZixFQUFrQi9GLHFCQUFhRSxXQUEvQixDQURwQjtBQUVJLFFBQUEsTUFBTSxFQUFFd0YsYUFGWjtBQUdJLFFBQUEsS0FBSyxFQUFFQyxnQkFIWDtBQUlJLFFBQUEsYUFBYSxFQUFDO0FBSmxCLFFBUEosRUFhTUcsU0FBUyxnQkFDUCw2QkFBQyw4Q0FBRDtBQUNJLFFBQUEsT0FBTyxFQUFFLEtBQUtHLGFBRGxCO0FBRUksUUFBQSxLQUFLLEVBQUUseUJBQUcsZUFBSCxDQUZYO0FBR0ksUUFBQSxhQUFhLEVBQUM7QUFIbEIsUUFETyxHQU1QLElBbkJSLGVBb0JJLDZCQUFDLDhDQUFEO0FBQ0ksUUFBQSxPQUFPLEVBQUUsS0FBS0MsZUFEbEI7QUFFSSxRQUFBLEtBQUssRUFBRSx5QkFBRyxnQkFBSCxDQUZYO0FBR0ksUUFBQSxhQUFhLEVBQUM7QUFIbEIsUUFwQkosZUF5QkksNkJBQUMsOENBQUQ7QUFDSSxRQUFBLE9BQU8sRUFBRSxLQUFLQyxrQkFEbEI7QUFFSSxRQUFBLEtBQUssRUFBRSx5QkFBRyxVQUFILENBRlg7QUFHSSxRQUFBLGFBQWEsRUFBQztBQUhsQixRQXpCSixDQU5VLGVBcUNWLDZCQUFDLGtEQUFEO0FBQStCLFFBQUEsR0FBRztBQUFsQyxzQkFDSSw2QkFBQyw4Q0FBRDtBQUNJLFFBQUEsT0FBTyxFQUFFLEtBQUtDLGdCQURsQjtBQUVJLFFBQUEsS0FBSyxFQUFFLHlCQUFHLFlBQUgsQ0FGWDtBQUdJLFFBQUEsYUFBYSxFQUFDO0FBSGxCLFFBREosQ0FyQ1UsQ0FBZDtBQTZDSDs7QUFFRCx3QkFDSSw2QkFBQyxjQUFELENBQU8sUUFBUCxxQkFDSSw2QkFBQyxxQ0FBRDtBQUNJLE1BQUEsU0FBUyxFQUFDLHdCQURkO0FBRUksTUFBQSxPQUFPLEVBQUUsS0FBS0Msc0JBRmxCO0FBR0ksTUFBQSxLQUFLLEVBQUUseUJBQUcsY0FBSCxDQUhYO0FBSUksTUFBQSxVQUFVLEVBQUUsQ0FBQyxDQUFDLEtBQUs3RSxLQUFMLENBQVc3QjtBQUo3QixNQURKLEVBT000RSxXQVBOLENBREo7QUFXSDs7QUFFTStCLEVBQUFBLE1BQU0sR0FBdUI7QUFDaEMsVUFBTXpCLE9BQU8sR0FBRyx5QkFBVztBQUN2QixxQkFBZSxJQURRO0FBRXZCLDhCQUF3QixLQUFLckQsS0FBTCxDQUFXakMsUUFGWjtBQUd2QixpQ0FBMkIsQ0FBQyxFQUFFLEtBQUtpQyxLQUFMLENBQVc3QixtQkFBWCxJQUFrQyxLQUFLNkIsS0FBTCxDQUFXL0IseUJBQS9DLENBSEw7QUFJdkIsK0JBQXlCLEtBQUtsQyxLQUFMLENBQVc4RTtBQUpiLEtBQVgsQ0FBaEI7QUFPQSxRQUFJa0UsV0FBeUIsR0FBRztBQUFFQyxNQUFBQSxXQUFXLEVBQUUsSUFBZjtBQUFxQkMsTUFBQUEsU0FBUyxFQUFFO0FBQWhDLEtBQWhDOztBQUNBLFFBQUksS0FBS2xKLEtBQUwsQ0FBVzJFLEdBQVgsS0FBbUJsQyxxQkFBYW1DLE1BQXBDLEVBQTRDO0FBQ3hDb0UsTUFBQUEsV0FBVyxHQUFHdkQsaURBQXdCMUMsUUFBeEIsQ0FBaUNvRyxnQkFBakMsQ0FBa0QsS0FBS25KLEtBQUwsQ0FBV0MsSUFBWCxDQUFnQmpCLE1BQWxFLENBQWQ7QUFDSDs7QUFFRCxRQUFJb0ssSUFBSSxHQUFHSixXQUFXLENBQUNDLFdBQVosSUFBMkIsS0FBS2pKLEtBQUwsQ0FBV0MsSUFBWCxDQUFnQm1KLElBQXREO0FBQ0EsUUFBSSxPQUFPQSxJQUFQLEtBQWdCLFFBQXBCLEVBQThCQSxJQUFJLEdBQUcsRUFBUDtBQUM5QkEsSUFBQUEsSUFBSSxHQUFHQSxJQUFJLENBQUNDLE9BQUwsQ0FBYSxHQUFiLEVBQWtCLFNBQWxCLENBQVAsQ0FmZ0MsQ0FlSzs7QUFFckMsVUFBTUMsVUFBVSxnQkFBRyw2QkFBQyw0QkFBRDtBQUNmLE1BQUEsSUFBSSxFQUFFLEtBQUt0SixLQUFMLENBQVdDLElBREY7QUFFZixNQUFBLFVBQVUsRUFBRSxFQUZHO0FBR2YsTUFBQSxZQUFZLEVBQUUsS0FBS0QsS0FBTCxDQUFXOEUsV0FIVjtBQUlmLE1BQUEsT0FBTyxFQUFHO0FBQUV5RSxRQUFBQSxTQUFTLEVBQUVQLFdBQVcsQ0FBQ0U7QUFBekI7QUFKSyxNQUFuQjs7QUFPQSxRQUFJTSxLQUFKOztBQUNBLFFBQUksQ0FBQyxLQUFLeEosS0FBTCxDQUFXOEUsV0FBWixJQUEyQixLQUFLVCxpQkFBcEMsRUFBdUQ7QUFDbkQ7QUFDQW1GLE1BQUFBLEtBQUssZ0JBQ0Q7QUFBSyxRQUFBLFNBQVMsRUFBQyw0QkFBZjtBQUE0Qyx1QkFBWTtBQUF4RCxzQkFDSSw2QkFBQywwQkFBRDtBQUNJLFFBQUEsWUFBWSxFQUFFLEtBQUtuRixpQkFEdkI7QUFFSSxRQUFBLFVBQVUsRUFBRSxLQUZoQjtBQUdJLFFBQUEsTUFBTSxFQUFFLEtBQUtyRSxLQUFMLENBQVdDLElBQVgsQ0FBZ0JqQjtBQUg1QixRQURKLENBREo7QUFTSDs7QUFFRCxRQUFJb0YsY0FBYyxHQUFHLElBQXJCOztBQUNBLFFBQUksS0FBS1Msa0JBQUwsSUFBMkIsS0FBS1osS0FBTCxDQUFXRyxjQUExQyxFQUEwRDtBQUN0REEsTUFBQUEsY0FBYyxnQkFDVjtBQUNJLFFBQUEsU0FBUyxFQUFDLDRCQURkO0FBRUksUUFBQSxFQUFFLEVBQUVyRixnQkFBZ0IsQ0FBQyxLQUFLaUIsS0FBTCxDQUFXQyxJQUFYLENBQWdCakIsTUFBakIsQ0FGeEI7QUFHSSxRQUFBLEtBQUssRUFBRSxLQUFLaUYsS0FBTCxDQUFXRztBQUh0QixTQUtNLEtBQUtILEtBQUwsQ0FBV0csY0FMakIsQ0FESjtBQVNIOztBQUVELFVBQU1xRixXQUFXLEdBQUcseUJBQVc7QUFDM0IsMEJBQW9CLElBRE87QUFFM0IscUNBQStCLENBQUMsQ0FBQ3JGLGNBRk47QUFHM0IseUNBQW1DLEtBQUtDLGlCQUFMLENBQXVCcUY7QUFIL0IsS0FBWCxDQUFwQjs7QUFNQSxRQUFJQyxhQUFhLGdCQUNiO0FBQUssTUFBQSxTQUFTLEVBQUM7QUFBZixvQkFDSTtBQUFLLE1BQUEsS0FBSyxFQUFFUCxJQUFaO0FBQWtCLE1BQUEsU0FBUyxFQUFFSyxXQUE3QjtBQUEwQyxNQUFBLFFBQVEsRUFBRSxDQUFDLENBQXJEO0FBQXdELE1BQUEsR0FBRyxFQUFDO0FBQTVELE9BQ01MLElBRE4sQ0FESixFQUlNaEYsY0FKTixDQURKOztBQVFBLFFBQUksS0FBS3BFLEtBQUwsQ0FBVzhFLFdBQWYsRUFBNEI2RSxhQUFhLEdBQUcsSUFBaEI7QUFFNUIsUUFBSUMsU0FBUyxHQUFHUixJQUFoQixDQW5FZ0MsQ0FvRWhDOztBQUNBLFFBQUksS0FBS3BKLEtBQUwsQ0FBVzJFLEdBQVgsS0FBbUJsQyxxQkFBYW1DLE1BQXBDLEVBQTRDLENBQ3hDO0FBQ0gsS0FGRCxNQUVPLElBQUksS0FBS1AsaUJBQUwsQ0FBdUJ3RixXQUEzQixFQUF3QztBQUMzQ0QsTUFBQUEsU0FBUyxJQUFJLE1BQU0seUJBQUcsK0NBQUgsRUFBb0Q7QUFDbkVFLFFBQUFBLEtBQUssRUFBRSxLQUFLekYsaUJBQUwsQ0FBdUJ5RjtBQURxQyxPQUFwRCxDQUFuQjtBQUdILEtBSk0sTUFJQSxJQUFJLEtBQUt6RixpQkFBTCxDQUF1QjBGLGNBQTNCLEVBQTJDO0FBQzlDSCxNQUFBQSxTQUFTLElBQUksTUFBTSx5QkFBRyw0QkFBSCxFQUFpQztBQUNoREUsUUFBQUEsS0FBSyxFQUFFLEtBQUt6RixpQkFBTCxDQUF1QnlGO0FBRGtCLE9BQWpDLENBQW5CO0FBR0gsS0FKTSxNQUlBLElBQUksS0FBS3pGLGlCQUFMLENBQXVCcUYsUUFBM0IsRUFBcUM7QUFDeENFLE1BQUFBLFNBQVMsSUFBSSxNQUFNLHlCQUFHLGtCQUFILENBQW5CO0FBQ0g7O0FBRUQsUUFBSUksZUFBSjs7QUFDQSxRQUFJLEtBQUtuRixrQkFBVCxFQUE2QjtBQUN6Qm1GLE1BQUFBLGVBQWUsR0FBR2pMLGdCQUFnQixDQUFDLEtBQUtpQixLQUFMLENBQVdDLElBQVgsQ0FBZ0JqQixNQUFqQixDQUFsQztBQUNIOztBQUVELFVBQU1nQixLQUFvRSxHQUFHLEVBQTdFO0FBQ0EsUUFBSWlLLE1BQTBFLEdBQUdDLHlCQUFqRjs7QUFDQSxRQUFJLEtBQUtsSyxLQUFMLENBQVc4RSxXQUFmLEVBQTRCO0FBQ3hCbUYsTUFBQUEsTUFBTSxHQUFHRSxnQ0FBVDtBQUNBbkssTUFBQUEsS0FBSyxDQUFDb0ssS0FBTixHQUFjaEIsSUFBZCxDQUZ3QixDQUd4Qjs7QUFDQXBKLE1BQUFBLEtBQUssQ0FBQ3FLLFNBQU4sR0FBa0IsQ0FBQyxDQUFDLEtBQUtwRyxLQUFMLENBQVc3QixtQkFBL0I7QUFDSDs7QUFFRCx3QkFDSSw2QkFBQyxjQUFELENBQU8sUUFBUCxxQkFDSSw2QkFBQyxxQ0FBRDtBQUF1QixNQUFBLFFBQVEsRUFBRSxLQUFLdEI7QUFBdEMsT0FDTSxDQUFDO0FBQUV3SixNQUFBQSxPQUFGO0FBQVd4SSxNQUFBQSxRQUFYO0FBQXFCeUksTUFBQUE7QUFBckIsS0FBRCxrQkFDRSw2QkFBQyxNQUFELDZCQUNRdkssS0FEUjtBQUVJLE1BQUEsT0FBTyxFQUFFc0ssT0FGYjtBQUdJLE1BQUEsUUFBUSxFQUFFeEksUUFBUSxHQUFHLENBQUgsR0FBTyxDQUFDLENBSDlCO0FBSUksTUFBQSxRQUFRLEVBQUV5SSxHQUpkO0FBS0ksTUFBQSxTQUFTLEVBQUVqRCxPQUxmO0FBTUksTUFBQSxPQUFPLEVBQUUsS0FBS2tELFdBTmxCO0FBT0ksTUFBQSxhQUFhLEVBQUUsS0FBS0MsYUFQeEI7QUFRSSxNQUFBLElBQUksRUFBQyxVQVJUO0FBU0ksb0JBQVliLFNBVGhCO0FBVUksdUJBQWUsS0FBSzNGLEtBQUwsQ0FBV2pDLFFBVjlCO0FBV0ksMEJBQWtCZ0k7QUFYdEIsUUFhTVYsVUFiTixFQWNNSyxhQWROLEVBZU1ILEtBZk4sRUFnQk0sS0FBSzNCLGlCQUFMLEVBaEJOLEVBaUJNLEtBQUtmLHVCQUFMLENBQTZCaEYsUUFBN0IsQ0FqQk4sQ0FGUixDQURKLENBREo7QUEyQkg7O0FBL2tCcUUsQyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG5Db3B5cmlnaHQgMjAxOCBNaWNoYWVsIFRlbGF0eW5za2kgPDd0M2NoZ3V5QGdtYWlsLmNvbT5cbkNvcHlyaWdodCAyMDE1LTIwMTcsIDIwMTktMjAyMSBUaGUgTWF0cml4Lm9yZyBGb3VuZGF0aW9uIEMuSS5DLlxuXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xueW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG5cbiAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcblxuVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG5TZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG5saW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiovXG5cbmltcG9ydCBSZWFjdCwgeyBjcmVhdGVSZWYgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IFJvb20gfSBmcm9tIFwibWF0cml4LWpzLXNkay9zcmMvbW9kZWxzL3Jvb21cIjtcbmltcG9ydCBjbGFzc05hbWVzIGZyb20gXCJjbGFzc25hbWVzXCI7XG5pbXBvcnQgeyBSb3ZpbmdUYWJJbmRleFdyYXBwZXIgfSBmcm9tIFwiLi4vLi4vLi4vYWNjZXNzaWJpbGl0eS9Sb3ZpbmdUYWJJbmRleFwiO1xuaW1wb3J0IEFjY2Vzc2libGVCdXR0b24sIHsgQnV0dG9uRXZlbnQgfSBmcm9tIFwiLi4vLi4vdmlld3MvZWxlbWVudHMvQWNjZXNzaWJsZUJ1dHRvblwiO1xuaW1wb3J0IGRpcyBmcm9tICcuLi8uLi8uLi9kaXNwYXRjaGVyL2Rpc3BhdGNoZXInO1xuaW1wb3J0IGRlZmF1bHREaXNwYXRjaGVyIGZyb20gJy4uLy4uLy4uL2Rpc3BhdGNoZXIvZGlzcGF0Y2hlcic7XG5pbXBvcnQgeyBBY3Rpb24gfSBmcm9tIFwiLi4vLi4vLi4vZGlzcGF0Y2hlci9hY3Rpb25zXCI7XG5pbXBvcnQgeyBLZXkgfSBmcm9tIFwiLi4vLi4vLi4vS2V5Ym9hcmRcIjtcbmltcG9ydCBBY3RpdmVSb29tT2JzZXJ2ZXIgZnJvbSBcIi4uLy4uLy4uL0FjdGl2ZVJvb21PYnNlcnZlclwiO1xuaW1wb3J0IHsgX3QgfSBmcm9tIFwiLi4vLi4vLi4vbGFuZ3VhZ2VIYW5kbGVyXCI7XG5pbXBvcnQgeyBDaGV2cm9uRmFjZSwgQ29udGV4dE1lbnVUb29sdGlwQnV0dG9uIH0gZnJvbSBcIi4uLy4uL3N0cnVjdHVyZXMvQ29udGV4dE1lbnVcIjtcbmltcG9ydCB7IERlZmF1bHRUYWdJRCwgVGFnSUQgfSBmcm9tIFwiLi4vLi4vLi4vc3RvcmVzL3Jvb20tbGlzdC9tb2RlbHNcIjtcbmltcG9ydCB7IE1lc3NhZ2VQcmV2aWV3U3RvcmUgfSBmcm9tIFwiLi4vLi4vLi4vc3RvcmVzL3Jvb20tbGlzdC9NZXNzYWdlUHJldmlld1N0b3JlXCI7XG5pbXBvcnQgRGVjb3JhdGVkUm9vbUF2YXRhciBmcm9tIFwiLi4vYXZhdGFycy9EZWNvcmF0ZWRSb29tQXZhdGFyXCI7XG5pbXBvcnQgeyBSb29tTm90aWZTdGF0ZSB9IGZyb20gXCIuLi8uLi8uLi9Sb29tTm90aWZzXCI7XG5pbXBvcnQgeyBNYXRyaXhDbGllbnRQZWcgfSBmcm9tIFwiLi4vLi4vLi4vTWF0cml4Q2xpZW50UGVnXCI7XG5pbXBvcnQgTm90aWZpY2F0aW9uQmFkZ2UgZnJvbSBcIi4vTm90aWZpY2F0aW9uQmFkZ2VcIjtcbmltcG9ydCBSb29tTGlzdFN0b3JlIGZyb20gXCIuLi8uLi8uLi9zdG9yZXMvcm9vbS1saXN0L1Jvb21MaXN0U3RvcmVcIjtcbmltcG9ydCBSb29tTGlzdEFjdGlvbnMgZnJvbSBcIi4uLy4uLy4uL2FjdGlvbnMvUm9vbUxpc3RBY3Rpb25zXCI7XG5pbXBvcnQgeyBBY3Rpb25QYXlsb2FkIH0gZnJvbSBcIi4uLy4uLy4uL2Rpc3BhdGNoZXIvcGF5bG9hZHNcIjtcbmltcG9ydCB7IFJvb21Ob3RpZmljYXRpb25TdGF0ZVN0b3JlIH0gZnJvbSBcIi4uLy4uLy4uL3N0b3Jlcy9ub3RpZmljYXRpb25zL1Jvb21Ob3RpZmljYXRpb25TdGF0ZVN0b3JlXCI7XG5pbXBvcnQgeyBOT1RJRklDQVRJT05fU1RBVEVfVVBEQVRFLCBOb3RpZmljYXRpb25TdGF0ZSB9IGZyb20gXCIuLi8uLi8uLi9zdG9yZXMvbm90aWZpY2F0aW9ucy9Ob3RpZmljYXRpb25TdGF0ZVwiO1xuaW1wb3J0IEFjY2Vzc2libGVUb29sdGlwQnV0dG9uIGZyb20gXCIuLi9lbGVtZW50cy9BY2Nlc3NpYmxlVG9vbHRpcEJ1dHRvblwiO1xuaW1wb3J0IHsgRWNob0NoYW1iZXIgfSBmcm9tIFwiLi4vLi4vLi4vc3RvcmVzL2xvY2FsLWVjaG8vRWNob0NoYW1iZXJcIjtcbmltcG9ydCB7IENhY2hlZFJvb21LZXksIFJvb21FY2hvQ2hhbWJlciB9IGZyb20gXCIuLi8uLi8uLi9zdG9yZXMvbG9jYWwtZWNoby9Sb29tRWNob0NoYW1iZXJcIjtcbmltcG9ydCB7IFBST1BFUlRZX1VQREFURUQgfSBmcm9tIFwiLi4vLi4vLi4vc3RvcmVzL2xvY2FsLWVjaG8vR2VuZXJpY0VjaG9DaGFtYmVyXCI7XG5pbXBvcnQgSWNvbml6ZWRDb250ZXh0TWVudSwge1xuICAgIEljb25pemVkQ29udGV4dE1lbnVDaGVja2JveCxcbiAgICBJY29uaXplZENvbnRleHRNZW51T3B0aW9uLFxuICAgIEljb25pemVkQ29udGV4dE1lbnVPcHRpb25MaXN0LFxuICAgIEljb25pemVkQ29udGV4dE1lbnVSYWRpbyxcbn0gZnJvbSBcIi4uL2NvbnRleHRfbWVudXMvSWNvbml6ZWRDb250ZXh0TWVudVwiO1xuaW1wb3J0IHsgQ29tbXVuaXR5UHJvdG90eXBlU3RvcmUsIElSb29tUHJvZmlsZSB9IGZyb20gXCIuLi8uLi8uLi9zdG9yZXMvQ29tbXVuaXR5UHJvdG90eXBlU3RvcmVcIjtcbmltcG9ydCB7IHJlcGxhY2VhYmxlQ29tcG9uZW50IH0gZnJvbSBcIi4uLy4uLy4uL3V0aWxzL3JlcGxhY2VhYmxlQ29tcG9uZW50XCI7XG5cbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gXCJtYXRyaXgtanMtc2RrL3NyYy9sb2dnZXJcIjtcblxuaW50ZXJmYWNlIElQcm9wcyB7XG4gICAgcm9vbTogUm9vbTtcbiAgICBzaG93TWVzc2FnZVByZXZpZXc6IGJvb2xlYW47XG4gICAgaXNNaW5pbWl6ZWQ6IGJvb2xlYW47XG4gICAgdGFnOiBUYWdJRDtcbn1cblxudHlwZSBQYXJ0aWFsRE9NUmVjdCA9IFBpY2s8RE9NUmVjdCwgXCJsZWZ0XCIgfCBcImJvdHRvbVwiPjtcblxuaW50ZXJmYWNlIElTdGF0ZSB7XG4gICAgc2VsZWN0ZWQ6IGJvb2xlYW47XG4gICAgbm90aWZpY2F0aW9uc01lbnVQb3NpdGlvbjogUGFydGlhbERPTVJlY3Q7XG4gICAgZ2VuZXJhbE1lbnVQb3NpdGlvbjogUGFydGlhbERPTVJlY3Q7XG4gICAgbWVzc2FnZVByZXZpZXc/OiBzdHJpbmc7XG59XG5cbmNvbnN0IG1lc3NhZ2VQcmV2aWV3SWQgPSAocm9vbUlkOiBzdHJpbmcpID0+IGBteF9Sb29tVGlsZV9tZXNzYWdlUHJldmlld18ke3Jvb21JZH1gO1xuXG5leHBvcnQgY29uc3QgY29udGV4dE1lbnVCZWxvdyA9IChlbGVtZW50UmVjdDogUGFydGlhbERPTVJlY3QpID0+IHtcbiAgICAvLyBhbGlnbiB0aGUgY29udGV4dCBtZW51J3MgaWNvbnMgd2l0aCB0aGUgaWNvbiB3aGljaCBvcGVuZWQgdGhlIGNvbnRleHQgbWVudVxuICAgIGNvbnN0IGxlZnQgPSBlbGVtZW50UmVjdC5sZWZ0ICsgd2luZG93LnBhZ2VYT2Zmc2V0IC0gOTtcbiAgICBjb25zdCB0b3AgPSBlbGVtZW50UmVjdC5ib3R0b20gKyB3aW5kb3cucGFnZVlPZmZzZXQgKyAxNztcbiAgICBjb25zdCBjaGV2cm9uRmFjZSA9IENoZXZyb25GYWNlLk5vbmU7XG4gICAgcmV0dXJuIHsgbGVmdCwgdG9wLCBjaGV2cm9uRmFjZSB9O1xufTtcblxuQHJlcGxhY2VhYmxlQ29tcG9uZW50KFwidmlld3Mucm9vbXMuUm9vbVRpbGVcIilcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJvb21UaWxlIGV4dGVuZHMgUmVhY3QuUHVyZUNvbXBvbmVudDxJUHJvcHMsIElTdGF0ZT4ge1xuICAgIHByaXZhdGUgZGlzcGF0Y2hlclJlZjogc3RyaW5nO1xuICAgIHByaXZhdGUgcm9vbVRpbGVSZWYgPSBjcmVhdGVSZWY8SFRNTERpdkVsZW1lbnQ+KCk7XG4gICAgcHJpdmF0ZSBub3RpZmljYXRpb25TdGF0ZTogTm90aWZpY2F0aW9uU3RhdGU7XG4gICAgcHJpdmF0ZSByb29tUHJvcHM6IFJvb21FY2hvQ2hhbWJlcjtcblxuICAgIGNvbnN0cnVjdG9yKHByb3BzOiBJUHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBzZWxlY3RlZDogQWN0aXZlUm9vbU9ic2VydmVyLmFjdGl2ZVJvb21JZCA9PT0gdGhpcy5wcm9wcy5yb29tLnJvb21JZCxcbiAgICAgICAgICAgIG5vdGlmaWNhdGlvbnNNZW51UG9zaXRpb246IG51bGwsXG4gICAgICAgICAgICBnZW5lcmFsTWVudVBvc2l0aW9uOiBudWxsLFxuXG4gICAgICAgICAgICAvLyBnZW5lcmF0ZVByZXZpZXcoKSB3aWxsIHJldHVybiBub3RoaW5nIGlmIHRoZSB1c2VyIGhhcyBwcmV2aWV3cyBkaXNhYmxlZFxuICAgICAgICAgICAgbWVzc2FnZVByZXZpZXc6IFwiXCIsXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZ2VuZXJhdGVQcmV2aWV3KCk7XG5cbiAgICAgICAgdGhpcy5ub3RpZmljYXRpb25TdGF0ZSA9IFJvb21Ob3RpZmljYXRpb25TdGF0ZVN0b3JlLmluc3RhbmNlLmdldFJvb21TdGF0ZSh0aGlzLnByb3BzLnJvb20pO1xuICAgICAgICB0aGlzLnJvb21Qcm9wcyA9IEVjaG9DaGFtYmVyLmZvclJvb20odGhpcy5wcm9wcy5yb29tKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIG9uUm9vbU5hbWVVcGRhdGUgPSAocm9vbTogUm9vbSkgPT4ge1xuICAgICAgICB0aGlzLmZvcmNlVXBkYXRlKCk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25Ob3RpZmljYXRpb25VcGRhdGUgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuZm9yY2VVcGRhdGUoKTsgLy8gbm90aWZpY2F0aW9uIHN0YXRlIGNoYW5nZWQgLSB1cGRhdGVcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvblJvb21Qcm9wZXJ0eVVwZGF0ZSA9IChwcm9wZXJ0eTogQ2FjaGVkUm9vbUtleSkgPT4ge1xuICAgICAgICBpZiAocHJvcGVydHkgPT09IENhY2hlZFJvb21LZXkuTm90aWZpY2F0aW9uVm9sdW1lKSB0aGlzLm9uTm90aWZpY2F0aW9uVXBkYXRlKCk7XG4gICAgICAgIC8vIGVsc2UgaWdub3JlIC0gbm90IGltcG9ydGFudCBmb3IgdGhpcyB0aWxlXG4gICAgfTtcblxuICAgIHByaXZhdGUgZ2V0IHNob3dDb250ZXh0TWVudSgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMudGFnICE9PSBEZWZhdWx0VGFnSUQuSW52aXRlO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0IHNob3dNZXNzYWdlUHJldmlldygpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuICF0aGlzLnByb3BzLmlzTWluaW1pemVkICYmIHRoaXMucHJvcHMuc2hvd01lc3NhZ2VQcmV2aWV3O1xuICAgIH1cblxuICAgIHB1YmxpYyBjb21wb25lbnREaWRVcGRhdGUocHJldlByb3BzOiBSZWFkb25seTxJUHJvcHM+LCBwcmV2U3RhdGU6IFJlYWRvbmx5PElTdGF0ZT4pIHtcbiAgICAgICAgY29uc3Qgc2hvd01lc3NhZ2VDaGFuZ2VkID0gcHJldlByb3BzLnNob3dNZXNzYWdlUHJldmlldyAhPT0gdGhpcy5wcm9wcy5zaG93TWVzc2FnZVByZXZpZXc7XG4gICAgICAgIGNvbnN0IG1pbmltaXplZENoYW5nZWQgPSBwcmV2UHJvcHMuaXNNaW5pbWl6ZWQgIT09IHRoaXMucHJvcHMuaXNNaW5pbWl6ZWQ7XG4gICAgICAgIGlmIChzaG93TWVzc2FnZUNoYW5nZWQgfHwgbWluaW1pemVkQ2hhbmdlZCkge1xuICAgICAgICAgICAgdGhpcy5nZW5lcmF0ZVByZXZpZXcoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocHJldlByb3BzLnJvb20/LnJvb21JZCAhPT0gdGhpcy5wcm9wcy5yb29tPy5yb29tSWQpIHtcbiAgICAgICAgICAgIE1lc3NhZ2VQcmV2aWV3U3RvcmUuaW5zdGFuY2Uub2ZmKFxuICAgICAgICAgICAgICAgIE1lc3NhZ2VQcmV2aWV3U3RvcmUuZ2V0UHJldmlld0NoYW5nZWRFdmVudE5hbWUocHJldlByb3BzLnJvb20pLFxuICAgICAgICAgICAgICAgIHRoaXMub25Sb29tUHJldmlld0NoYW5nZWQsXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgTWVzc2FnZVByZXZpZXdTdG9yZS5pbnN0YW5jZS5vbihcbiAgICAgICAgICAgICAgICBNZXNzYWdlUHJldmlld1N0b3JlLmdldFByZXZpZXdDaGFuZ2VkRXZlbnROYW1lKHRoaXMucHJvcHMucm9vbSksXG4gICAgICAgICAgICAgICAgdGhpcy5vblJvb21QcmV2aWV3Q2hhbmdlZCxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBDb21tdW5pdHlQcm90b3R5cGVTdG9yZS5pbnN0YW5jZS5vZmYoXG4gICAgICAgICAgICAgICAgQ29tbXVuaXR5UHJvdG90eXBlU3RvcmUuZ2V0VXBkYXRlRXZlbnROYW1lKHByZXZQcm9wcy5yb29tPy5yb29tSWQpLFxuICAgICAgICAgICAgICAgIHRoaXMub25Db21tdW5pdHlVcGRhdGUsXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgQ29tbXVuaXR5UHJvdG90eXBlU3RvcmUuaW5zdGFuY2Uub24oXG4gICAgICAgICAgICAgICAgQ29tbXVuaXR5UHJvdG90eXBlU3RvcmUuZ2V0VXBkYXRlRXZlbnROYW1lKHRoaXMucHJvcHMucm9vbT8ucm9vbUlkKSxcbiAgICAgICAgICAgICAgICB0aGlzLm9uQ29tbXVuaXR5VXBkYXRlLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHByZXZQcm9wcy5yb29tPy5vZmYoXCJSb29tLm5hbWVcIiwgdGhpcy5vblJvb21OYW1lVXBkYXRlKTtcbiAgICAgICAgICAgIHRoaXMucHJvcHMucm9vbT8ub24oXCJSb29tLm5hbWVcIiwgdGhpcy5vblJvb21OYW1lVXBkYXRlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgICAgLy8gd2hlbiB3ZSdyZSBmaXJzdCByZW5kZXJlZCAob3Igb3VyIHN1Ymxpc3QgaXMgZXhwYW5kZWQpIG1ha2Ugc3VyZSB3ZSBhcmUgdmlzaWJsZSBpZiB3ZSdyZSBhY3RpdmVcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuc2VsZWN0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsSW50b1ZpZXcoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIEFjdGl2ZVJvb21PYnNlcnZlci5hZGRMaXN0ZW5lcih0aGlzLnByb3BzLnJvb20ucm9vbUlkLCB0aGlzLm9uQWN0aXZlUm9vbVVwZGF0ZSk7XG4gICAgICAgIHRoaXMuZGlzcGF0Y2hlclJlZiA9IGRlZmF1bHREaXNwYXRjaGVyLnJlZ2lzdGVyKHRoaXMub25BY3Rpb24pO1xuICAgICAgICBNZXNzYWdlUHJldmlld1N0b3JlLmluc3RhbmNlLm9uKFxuICAgICAgICAgICAgTWVzc2FnZVByZXZpZXdTdG9yZS5nZXRQcmV2aWV3Q2hhbmdlZEV2ZW50TmFtZSh0aGlzLnByb3BzLnJvb20pLFxuICAgICAgICAgICAgdGhpcy5vblJvb21QcmV2aWV3Q2hhbmdlZCxcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5ub3RpZmljYXRpb25TdGF0ZS5vbihOT1RJRklDQVRJT05fU1RBVEVfVVBEQVRFLCB0aGlzLm9uTm90aWZpY2F0aW9uVXBkYXRlKTtcbiAgICAgICAgdGhpcy5yb29tUHJvcHMub24oUFJPUEVSVFlfVVBEQVRFRCwgdGhpcy5vblJvb21Qcm9wZXJ0eVVwZGF0ZSk7XG4gICAgICAgIHRoaXMucHJvcHMucm9vbT8ub24oXCJSb29tLm5hbWVcIiwgdGhpcy5vblJvb21OYW1lVXBkYXRlKTtcbiAgICAgICAgQ29tbXVuaXR5UHJvdG90eXBlU3RvcmUuaW5zdGFuY2Uub24oXG4gICAgICAgICAgICBDb21tdW5pdHlQcm90b3R5cGVTdG9yZS5nZXRVcGRhdGVFdmVudE5hbWUodGhpcy5wcm9wcy5yb29tLnJvb21JZCksXG4gICAgICAgICAgICB0aGlzLm9uQ29tbXVuaXR5VXBkYXRlLFxuICAgICAgICApO1xuICAgIH1cblxuICAgIHB1YmxpYyBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICAgICAgaWYgKHRoaXMucHJvcHMucm9vbSkge1xuICAgICAgICAgICAgQWN0aXZlUm9vbU9ic2VydmVyLnJlbW92ZUxpc3RlbmVyKHRoaXMucHJvcHMucm9vbS5yb29tSWQsIHRoaXMub25BY3RpdmVSb29tVXBkYXRlKTtcbiAgICAgICAgICAgIE1lc3NhZ2VQcmV2aWV3U3RvcmUuaW5zdGFuY2Uub2ZmKFxuICAgICAgICAgICAgICAgIE1lc3NhZ2VQcmV2aWV3U3RvcmUuZ2V0UHJldmlld0NoYW5nZWRFdmVudE5hbWUodGhpcy5wcm9wcy5yb29tKSxcbiAgICAgICAgICAgICAgICB0aGlzLm9uUm9vbVByZXZpZXdDaGFuZ2VkLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIENvbW11bml0eVByb3RvdHlwZVN0b3JlLmluc3RhbmNlLm9mZihcbiAgICAgICAgICAgICAgICBDb21tdW5pdHlQcm90b3R5cGVTdG9yZS5nZXRVcGRhdGVFdmVudE5hbWUodGhpcy5wcm9wcy5yb29tLnJvb21JZCksXG4gICAgICAgICAgICAgICAgdGhpcy5vbkNvbW11bml0eVVwZGF0ZSxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aGlzLnByb3BzLnJvb20ub2ZmKFwiUm9vbS5uYW1lXCIsIHRoaXMub25Sb29tTmFtZVVwZGF0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgQWN0aXZlUm9vbU9ic2VydmVyLnJlbW92ZUxpc3RlbmVyKHRoaXMucHJvcHMucm9vbS5yb29tSWQsIHRoaXMub25BY3RpdmVSb29tVXBkYXRlKTtcbiAgICAgICAgZGVmYXVsdERpc3BhdGNoZXIudW5yZWdpc3Rlcih0aGlzLmRpc3BhdGNoZXJSZWYpO1xuICAgICAgICB0aGlzLm5vdGlmaWNhdGlvblN0YXRlLm9mZihOT1RJRklDQVRJT05fU1RBVEVfVVBEQVRFLCB0aGlzLm9uTm90aWZpY2F0aW9uVXBkYXRlKTtcbiAgICAgICAgdGhpcy5yb29tUHJvcHMub2ZmKFBST1BFUlRZX1VQREFURUQsIHRoaXMub25Sb29tUHJvcGVydHlVcGRhdGUpO1xuICAgICAgICBDb21tdW5pdHlQcm90b3R5cGVTdG9yZS5pbnN0YW5jZS5vZmYoXG4gICAgICAgICAgICBDb21tdW5pdHlQcm90b3R5cGVTdG9yZS5nZXRVcGRhdGVFdmVudE5hbWUodGhpcy5wcm9wcy5yb29tLnJvb21JZCksXG4gICAgICAgICAgICB0aGlzLm9uQ29tbXVuaXR5VXBkYXRlLFxuICAgICAgICApO1xuICAgIH1cblxuICAgIHByaXZhdGUgb25BY3Rpb24gPSAocGF5bG9hZDogQWN0aW9uUGF5bG9hZCkgPT4ge1xuICAgICAgICBpZiAocGF5bG9hZC5hY3Rpb24gPT09IFwidmlld19yb29tXCIgJiYgcGF5bG9hZC5yb29tX2lkID09PSB0aGlzLnByb3BzLnJvb20ucm9vbUlkICYmIHBheWxvYWQuc2hvd19yb29tX3RpbGUpIHtcbiAgICAgICAgICAgIHNldEltbWVkaWF0ZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxJbnRvVmlldygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkNvbW11bml0eVVwZGF0ZSA9IChyb29tSWQ6IHN0cmluZykgPT4ge1xuICAgICAgICBpZiAocm9vbUlkICE9PSB0aGlzLnByb3BzLnJvb20ucm9vbUlkKSByZXR1cm47XG4gICAgICAgIHRoaXMuZm9yY2VVcGRhdGUoKTsgLy8gd2UgZG9uJ3QgaGF2ZSBhbnl0aGluZyB0byBhY3R1YWxseSB1cGRhdGVcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvblJvb21QcmV2aWV3Q2hhbmdlZCA9IChyb29tOiBSb29tKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLnByb3BzLnJvb20gJiYgcm9vbS5yb29tSWQgPT09IHRoaXMucHJvcHMucm9vbS5yb29tSWQpIHtcbiAgICAgICAgICAgIHRoaXMuZ2VuZXJhdGVQcmV2aWV3KCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZVByZXZpZXcoKSB7XG4gICAgICAgIGlmICghdGhpcy5zaG93TWVzc2FnZVByZXZpZXcpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbWVzc2FnZVByZXZpZXcgPSBhd2FpdCBNZXNzYWdlUHJldmlld1N0b3JlLmluc3RhbmNlLmdldFByZXZpZXdGb3JSb29tKHRoaXMucHJvcHMucm9vbSwgdGhpcy5wcm9wcy50YWcpO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgbWVzc2FnZVByZXZpZXcgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzY3JvbGxJbnRvVmlldyA9ICgpID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLnJvb21UaWxlUmVmLmN1cnJlbnQpIHJldHVybjtcbiAgICAgICAgdGhpcy5yb29tVGlsZVJlZi5jdXJyZW50LnNjcm9sbEludG9WaWV3KHtcbiAgICAgICAgICAgIGJsb2NrOiBcIm5lYXJlc3RcIixcbiAgICAgICAgICAgIGJlaGF2aW9yOiBcImF1dG9cIixcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25UaWxlQ2xpY2sgPSAoZXY6IFJlYWN0LktleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGRpcy5kaXNwYXRjaCh7XG4gICAgICAgICAgICBhY3Rpb246IEFjdGlvbi5WaWV3Um9vbSxcbiAgICAgICAgICAgIHNob3dfcm9vbV90aWxlOiB0cnVlLCAvLyBtYWtlIHN1cmUgdGhlIHJvb20gaXMgdmlzaWJsZSBpbiB0aGUgbGlzdFxuICAgICAgICAgICAgcm9vbV9pZDogdGhpcy5wcm9wcy5yb29tLnJvb21JZCxcbiAgICAgICAgICAgIGNsZWFyX3NlYXJjaDogKGV2ICYmIChldi5rZXkgPT09IEtleS5FTlRFUiB8fCBldi5rZXkgPT09IEtleS5TUEFDRSkpLFxuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkFjdGl2ZVJvb21VcGRhdGUgPSAoaXNBY3RpdmU6IGJvb2xlYW4pID0+IHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHNlbGVjdGVkOiBpc0FjdGl2ZSB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbk5vdGlmaWNhdGlvbnNNZW51T3BlbkNsaWNrID0gKGV2OiBSZWFjdC5Nb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBjb25zdCB0YXJnZXQgPSBldi50YXJnZXQgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBub3RpZmljYXRpb25zTWVudVBvc2l0aW9uOiB0YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25DbG9zZU5vdGlmaWNhdGlvbnNNZW51ID0gKCkgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgbm90aWZpY2F0aW9uc01lbnVQb3NpdGlvbjogbnVsbCB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkdlbmVyYWxNZW51T3BlbkNsaWNrID0gKGV2OiBSZWFjdC5Nb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBjb25zdCB0YXJnZXQgPSBldi50YXJnZXQgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBnZW5lcmFsTWVudVBvc2l0aW9uOiB0YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25Db250ZXh0TWVudSA9IChldjogUmVhY3QuTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAvLyBJZiB3ZSBkb24ndCBoYXZlIGEgY29udGV4dCBtZW51IHRvIHNob3csIGlnbm9yZSB0aGUgYWN0aW9uLlxuICAgICAgICBpZiAoIXRoaXMuc2hvd0NvbnRleHRNZW51KSByZXR1cm47XG5cbiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgZ2VuZXJhbE1lbnVQb3NpdGlvbjoge1xuICAgICAgICAgICAgICAgIGxlZnQ6IGV2LmNsaWVudFgsXG4gICAgICAgICAgICAgICAgYm90dG9tOiBldi5jbGllbnRZLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25DbG9zZUdlbmVyYWxNZW51ID0gKCkgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgZ2VuZXJhbE1lbnVQb3NpdGlvbjogbnVsbCB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvblRhZ1Jvb20gPSAoZXY6IEJ1dHRvbkV2ZW50LCB0YWdJZDogVGFnSUQpID0+IHtcbiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgaWYgKHRhZ0lkID09PSBEZWZhdWx0VGFnSUQuRmF2b3VyaXRlIHx8IHRhZ0lkID09PSBEZWZhdWx0VGFnSUQuTG93UHJpb3JpdHkpIHtcbiAgICAgICAgICAgIGNvbnN0IGludmVyc2VUYWcgPSB0YWdJZCA9PT0gRGVmYXVsdFRhZ0lELkZhdm91cml0ZSA/IERlZmF1bHRUYWdJRC5Mb3dQcmlvcml0eSA6IERlZmF1bHRUYWdJRC5GYXZvdXJpdGU7XG4gICAgICAgICAgICBjb25zdCBpc0FwcGxpZWQgPSBSb29tTGlzdFN0b3JlLmluc3RhbmNlLmdldFRhZ3NGb3JSb29tKHRoaXMucHJvcHMucm9vbSkuaW5jbHVkZXModGFnSWQpO1xuICAgICAgICAgICAgY29uc3QgcmVtb3ZlVGFnID0gaXNBcHBsaWVkID8gdGFnSWQgOiBpbnZlcnNlVGFnO1xuICAgICAgICAgICAgY29uc3QgYWRkVGFnID0gaXNBcHBsaWVkID8gbnVsbCA6IHRhZ0lkO1xuICAgICAgICAgICAgZGlzLmRpc3BhdGNoKFJvb21MaXN0QWN0aW9ucy50YWdSb29tKFxuICAgICAgICAgICAgICAgIE1hdHJpeENsaWVudFBlZy5nZXQoKSxcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLnJvb20sXG4gICAgICAgICAgICAgICAgcmVtb3ZlVGFnLFxuICAgICAgICAgICAgICAgIGFkZFRhZyxcbiAgICAgICAgICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgMCxcbiAgICAgICAgICAgICkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbG9nZ2VyLndhcm4oYFVuZXhwZWN0ZWQgdGFnICR7dGFnSWR9IGFwcGxpZWQgdG8gJHt0aGlzLnByb3BzLnJvb20ucm9vbUlkfWApO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKChldiBhcyBSZWFjdC5LZXlib2FyZEV2ZW50KS5rZXkgPT09IEtleS5FTlRFUikge1xuICAgICAgICAgICAgLy8gSW1wbGVtZW50cyBodHRwczovL3d3dy53My5vcmcvVFIvd2FpLWFyaWEtcHJhY3RpY2VzLyNrZXlib2FyZC1pbnRlcmFjdGlvbi0xMlxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGdlbmVyYWxNZW51UG9zaXRpb246IG51bGwgfSk7IC8vIGhpZGUgdGhlIG1lbnVcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwcml2YXRlIG9uTGVhdmVSb29tQ2xpY2sgPSAoZXY6IEJ1dHRvbkV2ZW50KSA9PiB7XG4gICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgIGRpcy5kaXNwYXRjaCh7XG4gICAgICAgICAgICBhY3Rpb246ICdsZWF2ZV9yb29tJyxcbiAgICAgICAgICAgIHJvb21faWQ6IHRoaXMucHJvcHMucm9vbS5yb29tSWQsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgZ2VuZXJhbE1lbnVQb3NpdGlvbjogbnVsbCB9KTsgLy8gaGlkZSB0aGUgbWVudVxuICAgIH07XG5cbiAgICBwcml2YXRlIG9uRm9yZ2V0Um9vbUNsaWNrID0gKGV2OiBCdXR0b25FdmVudCkgPT4ge1xuICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgICBkaXMuZGlzcGF0Y2goe1xuICAgICAgICAgICAgYWN0aW9uOiAnZm9yZ2V0X3Jvb20nLFxuICAgICAgICAgICAgcm9vbV9pZDogdGhpcy5wcm9wcy5yb29tLnJvb21JZCxcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBnZW5lcmFsTWVudVBvc2l0aW9uOiBudWxsIH0pOyAvLyBoaWRlIHRoZSBtZW51XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25PcGVuUm9vbVNldHRpbmdzID0gKGV2OiBCdXR0b25FdmVudCkgPT4ge1xuICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgICBkaXMuZGlzcGF0Y2goe1xuICAgICAgICAgICAgYWN0aW9uOiAnb3Blbl9yb29tX3NldHRpbmdzJyxcbiAgICAgICAgICAgIHJvb21faWQ6IHRoaXMucHJvcHMucm9vbS5yb29tSWQsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgZ2VuZXJhbE1lbnVQb3NpdGlvbjogbnVsbCB9KTsgLy8gaGlkZSB0aGUgbWVudVxuICAgIH07XG5cbiAgICBwcml2YXRlIG9uQ29weVJvb21DbGljayA9IChldjogQnV0dG9uRXZlbnQpID0+IHtcbiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgZGlzLmRpc3BhdGNoKHtcbiAgICAgICAgICAgIGFjdGlvbjogJ2NvcHlfcm9vbScsXG4gICAgICAgICAgICByb29tX2lkOiB0aGlzLnByb3BzLnJvb20ucm9vbUlkLFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGdlbmVyYWxNZW51UG9zaXRpb246IG51bGwgfSk7IC8vIGhpZGUgdGhlIG1lbnVcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkludml0ZUNsaWNrID0gKGV2OiBCdXR0b25FdmVudCkgPT4ge1xuICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgICBkaXMuZGlzcGF0Y2goe1xuICAgICAgICAgICAgYWN0aW9uOiAndmlld19pbnZpdGUnLFxuICAgICAgICAgICAgcm9vbUlkOiB0aGlzLnByb3BzLnJvb20ucm9vbUlkLFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGdlbmVyYWxNZW51UG9zaXRpb246IG51bGwgfSk7IC8vIGhpZGUgdGhlIG1lbnVcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBhc3luYyBzYXZlTm90aWZTdGF0ZShldjogQnV0dG9uRXZlbnQsIG5ld1N0YXRlOiBSb29tTm90aWZTdGF0ZSkge1xuICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgaWYgKE1hdHJpeENsaWVudFBlZy5nZXQoKS5pc0d1ZXN0KCkpIHJldHVybjtcblxuICAgICAgICB0aGlzLnJvb21Qcm9wcy5ub3RpZmljYXRpb25Wb2x1bWUgPSBuZXdTdGF0ZTtcblxuICAgICAgICBjb25zdCBrZXkgPSAoZXYgYXMgUmVhY3QuS2V5Ym9hcmRFdmVudCkua2V5O1xuICAgICAgICBpZiAoa2V5ID09PSBLZXkuRU5URVIpIHtcbiAgICAgICAgICAgIC8vIEltcGxlbWVudHMgaHR0cHM6Ly93d3cudzMub3JnL1RSL3dhaS1hcmlhLXByYWN0aWNlcy8ja2V5Ym9hcmQtaW50ZXJhY3Rpb24tMTJcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBub3RpZmljYXRpb25zTWVudVBvc2l0aW9uOiBudWxsIH0pOyAvLyBoaWRlIHRoZSBtZW51XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIG9uQ2xpY2tBbGxOb3RpZnMgPSBldiA9PiB0aGlzLnNhdmVOb3RpZlN0YXRlKGV2LCBSb29tTm90aWZTdGF0ZS5BbGxNZXNzYWdlcyk7XG4gICAgcHJpdmF0ZSBvbkNsaWNrQWxlcnRNZSA9IGV2ID0+IHRoaXMuc2F2ZU5vdGlmU3RhdGUoZXYsIFJvb21Ob3RpZlN0YXRlLkFsbE1lc3NhZ2VzTG91ZCk7XG4gICAgcHJpdmF0ZSBvbkNsaWNrTWVudGlvbnMgPSBldiA9PiB0aGlzLnNhdmVOb3RpZlN0YXRlKGV2LCBSb29tTm90aWZTdGF0ZS5NZW50aW9uc09ubHkpO1xuICAgIHByaXZhdGUgb25DbGlja011dGUgPSBldiA9PiB0aGlzLnNhdmVOb3RpZlN0YXRlKGV2LCBSb29tTm90aWZTdGF0ZS5NdXRlKTtcblxuICAgIHByaXZhdGUgcmVuZGVyTm90aWZpY2F0aW9uc01lbnUoaXNBY3RpdmU6IGJvb2xlYW4pOiBSZWFjdC5SZWFjdEVsZW1lbnQge1xuICAgICAgICBpZiAoTWF0cml4Q2xpZW50UGVnLmdldCgpLmlzR3Vlc3QoKSB8fCB0aGlzLnByb3BzLnRhZyA9PT0gRGVmYXVsdFRhZ0lELkFyY2hpdmVkIHx8XG4gICAgICAgICAgICAhdGhpcy5zaG93Q29udGV4dE1lbnUgfHwgdGhpcy5wcm9wcy5pc01pbmltaXplZFxuICAgICAgICApIHtcbiAgICAgICAgICAgIC8vIHRoZSBtZW51IG1ha2VzIG5vIHNlbnNlIGluIHRoZXNlIGNhc2VzIHNvIGRvIG5vdCBzaG93IG9uZVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzdGF0ZSA9IHRoaXMucm9vbVByb3BzLm5vdGlmaWNhdGlvblZvbHVtZTtcblxuICAgICAgICBsZXQgY29udGV4dE1lbnUgPSBudWxsO1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5ub3RpZmljYXRpb25zTWVudVBvc2l0aW9uKSB7XG4gICAgICAgICAgICBjb250ZXh0TWVudSA9IDxJY29uaXplZENvbnRleHRNZW51XG4gICAgICAgICAgICAgICAgey4uLmNvbnRleHRNZW51QmVsb3codGhpcy5zdGF0ZS5ub3RpZmljYXRpb25zTWVudVBvc2l0aW9uKX1cbiAgICAgICAgICAgICAgICBvbkZpbmlzaGVkPXt0aGlzLm9uQ2xvc2VOb3RpZmljYXRpb25zTWVudX1cbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJteF9Sb29tVGlsZV9jb250ZXh0TWVudVwiXG4gICAgICAgICAgICAgICAgY29tcGFjdFxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxJY29uaXplZENvbnRleHRNZW51T3B0aW9uTGlzdCBmaXJzdD5cbiAgICAgICAgICAgICAgICAgICAgPEljb25pemVkQ29udGV4dE1lbnVSYWRpb1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e190KFwiVXNlIGRlZmF1bHRcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmU9e3N0YXRlID09PSBSb29tTm90aWZTdGF0ZS5BbGxNZXNzYWdlc31cbiAgICAgICAgICAgICAgICAgICAgICAgIGljb25DbGFzc05hbWU9XCJteF9Sb29tVGlsZV9pY29uQmVsbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uQ2xpY2tBbGxOb3RpZnN9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDxJY29uaXplZENvbnRleHRNZW51UmFkaW9cbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXtfdChcIkFsbCBtZXNzYWdlc1wiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZT17c3RhdGUgPT09IFJvb21Ob3RpZlN0YXRlLkFsbE1lc3NhZ2VzTG91ZH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGljb25DbGFzc05hbWU9XCJteF9Sb29tVGlsZV9pY29uQmVsbERvdFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uQ2xpY2tBbGVydE1lfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8SWNvbml6ZWRDb250ZXh0TWVudVJhZGlvXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbD17X3QoXCJNZW50aW9ucyAmIEtleXdvcmRzXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlPXtzdGF0ZSA9PT0gUm9vbU5vdGlmU3RhdGUuTWVudGlvbnNPbmx5fVxuICAgICAgICAgICAgICAgICAgICAgICAgaWNvbkNsYXNzTmFtZT1cIm14X1Jvb21UaWxlX2ljb25CZWxsTWVudGlvbnNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5vbkNsaWNrTWVudGlvbnN9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDxJY29uaXplZENvbnRleHRNZW51UmFkaW9cbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXtfdChcIk5vbmVcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmU9e3N0YXRlID09PSBSb29tTm90aWZTdGF0ZS5NdXRlfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWNvbkNsYXNzTmFtZT1cIm14X1Jvb21UaWxlX2ljb25CZWxsQ3Jvc3NlZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uQ2xpY2tNdXRlfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvSWNvbml6ZWRDb250ZXh0TWVudU9wdGlvbkxpc3Q+XG4gICAgICAgICAgICA8L0ljb25pemVkQ29udGV4dE1lbnU+O1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY2xhc3NlcyA9IGNsYXNzTmFtZXMoXCJteF9Sb29tVGlsZV9ub3RpZmljYXRpb25zQnV0dG9uXCIsIHtcbiAgICAgICAgICAgIC8vIFNob3cgYmVsbCBpY29uIGZvciB0aGUgZGVmYXVsdCBjYXNlIHRvby5cbiAgICAgICAgICAgIG14X1Jvb21UaWxlX2ljb25CZWxsOiBzdGF0ZSA9PT0gUm9vbU5vdGlmU3RhdGUuQWxsTWVzc2FnZXMsXG4gICAgICAgICAgICBteF9Sb29tVGlsZV9pY29uQmVsbERvdDogc3RhdGUgPT09IFJvb21Ob3RpZlN0YXRlLkFsbE1lc3NhZ2VzTG91ZCxcbiAgICAgICAgICAgIG14X1Jvb21UaWxlX2ljb25CZWxsTWVudGlvbnM6IHN0YXRlID09PSBSb29tTm90aWZTdGF0ZS5NZW50aW9uc09ubHksXG4gICAgICAgICAgICBteF9Sb29tVGlsZV9pY29uQmVsbENyb3NzZWQ6IHN0YXRlID09PSBSb29tTm90aWZTdGF0ZS5NdXRlLFxuXG4gICAgICAgICAgICAvLyBPbmx5IHNob3cgdGhlIGljb24gYnkgZGVmYXVsdCBpZiB0aGUgcm9vbSBpcyBvdmVycmlkZGVuIHRvIG11dGVkLlxuICAgICAgICAgICAgLy8gVE9ETzogW0ZUVUUgTm90aWZpY2F0aW9uc10gUHJvYmFibHkgbmVlZCB0byBkZXRlY3QgZ2xvYmFsIG11dGUgc3RhdGVcbiAgICAgICAgICAgIG14X1Jvb21UaWxlX25vdGlmaWNhdGlvbnNCdXR0b25fc2hvdzogc3RhdGUgPT09IFJvb21Ob3RpZlN0YXRlLk11dGUsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8UmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICAgICAgICAgPENvbnRleHRNZW51VG9vbHRpcEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2NsYXNzZXN9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMub25Ob3RpZmljYXRpb25zTWVudU9wZW5DbGlja31cbiAgICAgICAgICAgICAgICAgICAgdGl0bGU9e190KFwiTm90aWZpY2F0aW9uIG9wdGlvbnNcIil9XG4gICAgICAgICAgICAgICAgICAgIGlzRXhwYW5kZWQ9eyEhdGhpcy5zdGF0ZS5ub3RpZmljYXRpb25zTWVudVBvc2l0aW9ufVxuICAgICAgICAgICAgICAgICAgICB0YWJJbmRleD17aXNBY3RpdmUgPyAwIDogLTF9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICB7IGNvbnRleHRNZW51IH1cbiAgICAgICAgICAgIDwvUmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZW5kZXJHZW5lcmFsTWVudSgpOiBSZWFjdC5SZWFjdEVsZW1lbnQge1xuICAgICAgICBpZiAoIXRoaXMuc2hvd0NvbnRleHRNZW51KSByZXR1cm4gbnVsbDsgLy8gbm8gbWVudSB0byBzaG93XG5cbiAgICAgICAgbGV0IGNvbnRleHRNZW51ID0gbnVsbDtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuZ2VuZXJhbE1lbnVQb3NpdGlvbiAmJiB0aGlzLnByb3BzLnRhZyA9PT0gRGVmYXVsdFRhZ0lELkFyY2hpdmVkKSB7XG4gICAgICAgICAgICBjb250ZXh0TWVudSA9IDxJY29uaXplZENvbnRleHRNZW51XG4gICAgICAgICAgICAgICAgey4uLmNvbnRleHRNZW51QmVsb3codGhpcy5zdGF0ZS5nZW5lcmFsTWVudVBvc2l0aW9uKX1cbiAgICAgICAgICAgICAgICBvbkZpbmlzaGVkPXt0aGlzLm9uQ2xvc2VHZW5lcmFsTWVudX1cbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJteF9Sb29tVGlsZV9jb250ZXh0TWVudVwiXG4gICAgICAgICAgICAgICAgY29tcGFjdFxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxJY29uaXplZENvbnRleHRNZW51T3B0aW9uTGlzdCByZWQ+XG4gICAgICAgICAgICAgICAgICAgIDxJY29uaXplZENvbnRleHRNZW51T3B0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICBpY29uQ2xhc3NOYW1lPVwibXhfUm9vbVRpbGVfaWNvblNpZ25PdXRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e190KFwiRm9yZ2V0IFJvb21cIil9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uRm9yZ2V0Um9vbUNsaWNrfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvSWNvbml6ZWRDb250ZXh0TWVudU9wdGlvbkxpc3Q+XG4gICAgICAgICAgICA8L0ljb25pemVkQ29udGV4dE1lbnU+O1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdGUuZ2VuZXJhbE1lbnVQb3NpdGlvbikge1xuICAgICAgICAgICAgY29uc3Qgcm9vbVRhZ3MgPSBSb29tTGlzdFN0b3JlLmluc3RhbmNlLmdldFRhZ3NGb3JSb29tKHRoaXMucHJvcHMucm9vbSk7XG5cbiAgICAgICAgICAgIGNvbnN0IGlzRmF2b3JpdGUgPSByb29tVGFncy5pbmNsdWRlcyhEZWZhdWx0VGFnSUQuRmF2b3VyaXRlKTtcbiAgICAgICAgICAgIGNvbnN0IGZhdm91cml0ZUxhYmVsID0gaXNGYXZvcml0ZSA/IF90KFwiRmF2b3VyaXRlZFwiKSA6IF90KFwiRmF2b3VyaXRlXCIpO1xuXG4gICAgICAgICAgICBjb25zdCBpc0xvd1ByaW9yaXR5ID0gcm9vbVRhZ3MuaW5jbHVkZXMoRGVmYXVsdFRhZ0lELkxvd1ByaW9yaXR5KTtcbiAgICAgICAgICAgIGNvbnN0IGxvd1ByaW9yaXR5TGFiZWwgPSBfdChcIkxvdyBQcmlvcml0eVwiKTtcblxuICAgICAgICAgICAgY29uc3QgdXNlcklkID0gTWF0cml4Q2xpZW50UGVnLmdldCgpLmdldFVzZXJJZCgpO1xuICAgICAgICAgICAgY29uc3QgY2FuSW52aXRlID0gdGhpcy5wcm9wcy5yb29tLmNhbkludml0ZSh1c2VySWQpO1xuICAgICAgICAgICAgY29udGV4dE1lbnUgPSA8SWNvbml6ZWRDb250ZXh0TWVudVxuICAgICAgICAgICAgICAgIHsuLi5jb250ZXh0TWVudUJlbG93KHRoaXMuc3RhdGUuZ2VuZXJhbE1lbnVQb3NpdGlvbil9XG4gICAgICAgICAgICAgICAgb25GaW5pc2hlZD17dGhpcy5vbkNsb3NlR2VuZXJhbE1lbnV9XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXhfUm9vbVRpbGVfY29udGV4dE1lbnVcIlxuICAgICAgICAgICAgICAgIGNvbXBhY3RcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8SWNvbml6ZWRDb250ZXh0TWVudU9wdGlvbkxpc3Q+XG4gICAgICAgICAgICAgICAgICAgIDxJY29uaXplZENvbnRleHRNZW51Q2hlY2tib3hcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eyhlKSA9PiB0aGlzLm9uVGFnUm9vbShlLCBEZWZhdWx0VGFnSUQuRmF2b3VyaXRlKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZT17aXNGYXZvcml0ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXtmYXZvdXJpdGVMYWJlbH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGljb25DbGFzc05hbWU9XCJteF9Sb29tVGlsZV9pY29uU3RhclwiXG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDxJY29uaXplZENvbnRleHRNZW51Q2hlY2tib3hcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eyhlKSA9PiB0aGlzLm9uVGFnUm9vbShlLCBEZWZhdWx0VGFnSUQuTG93UHJpb3JpdHkpfVxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlPXtpc0xvd1ByaW9yaXR5fVxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e2xvd1ByaW9yaXR5TGFiZWx9XG4gICAgICAgICAgICAgICAgICAgICAgICBpY29uQ2xhc3NOYW1lPVwibXhfUm9vbVRpbGVfaWNvbkFycm93RG93blwiXG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIHsgY2FuSW52aXRlID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgPEljb25pemVkQ29udGV4dE1lbnVPcHRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uSW52aXRlQ2xpY2t9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e190KFwiSW52aXRlIFBlb3BsZVwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpY29uQ2xhc3NOYW1lPVwibXhfUm9vbVRpbGVfaWNvbkludml0ZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICApIDogbnVsbCB9XG4gICAgICAgICAgICAgICAgICAgIDxJY29uaXplZENvbnRleHRNZW51T3B0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uQ29weVJvb21DbGlja31cbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXtfdChcIkNvcHkgUm9vbSBMaW5rXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWNvbkNsYXNzTmFtZT1cIm14X1Jvb21UaWxlX2ljb25Db3B5TGlua1wiXG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDxJY29uaXplZENvbnRleHRNZW51T3B0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uT3BlblJvb21TZXR0aW5nc31cbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXtfdChcIlNldHRpbmdzXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWNvbkNsYXNzTmFtZT1cIm14X1Jvb21UaWxlX2ljb25TZXR0aW5nc1wiXG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC9JY29uaXplZENvbnRleHRNZW51T3B0aW9uTGlzdD5cbiAgICAgICAgICAgICAgICA8SWNvbml6ZWRDb250ZXh0TWVudU9wdGlvbkxpc3QgcmVkPlxuICAgICAgICAgICAgICAgICAgICA8SWNvbml6ZWRDb250ZXh0TWVudU9wdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5vbkxlYXZlUm9vbUNsaWNrfVxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e190KFwiTGVhdmUgUm9vbVwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGljb25DbGFzc05hbWU9XCJteF9Sb29tVGlsZV9pY29uU2lnbk91dFwiXG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC9JY29uaXplZENvbnRleHRNZW51T3B0aW9uTGlzdD5cbiAgICAgICAgICAgIDwvSWNvbml6ZWRDb250ZXh0TWVudT47XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPFJlYWN0LkZyYWdtZW50PlxuICAgICAgICAgICAgICAgIDxDb250ZXh0TWVudVRvb2x0aXBCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXhfUm9vbVRpbGVfbWVudUJ1dHRvblwiXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMub25HZW5lcmFsTWVudU9wZW5DbGlja31cbiAgICAgICAgICAgICAgICAgICAgdGl0bGU9e190KFwiUm9vbSBvcHRpb25zXCIpfVxuICAgICAgICAgICAgICAgICAgICBpc0V4cGFuZGVkPXshIXRoaXMuc3RhdGUuZ2VuZXJhbE1lbnVQb3NpdGlvbn1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIHsgY29udGV4dE1lbnUgfVxuICAgICAgICAgICAgPC9SZWFjdC5GcmFnbWVudD5cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgcmVuZGVyKCk6IFJlYWN0LlJlYWN0RWxlbWVudCB7XG4gICAgICAgIGNvbnN0IGNsYXNzZXMgPSBjbGFzc05hbWVzKHtcbiAgICAgICAgICAgICdteF9Sb29tVGlsZSc6IHRydWUsXG4gICAgICAgICAgICAnbXhfUm9vbVRpbGVfc2VsZWN0ZWQnOiB0aGlzLnN0YXRlLnNlbGVjdGVkLFxuICAgICAgICAgICAgJ214X1Jvb21UaWxlX2hhc01lbnVPcGVuJzogISEodGhpcy5zdGF0ZS5nZW5lcmFsTWVudVBvc2l0aW9uIHx8IHRoaXMuc3RhdGUubm90aWZpY2F0aW9uc01lbnVQb3NpdGlvbiksXG4gICAgICAgICAgICAnbXhfUm9vbVRpbGVfbWluaW1pemVkJzogdGhpcy5wcm9wcy5pc01pbmltaXplZCxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbGV0IHJvb21Qcm9maWxlOiBJUm9vbVByb2ZpbGUgPSB7IGRpc3BsYXlOYW1lOiBudWxsLCBhdmF0YXJNeGM6IG51bGwgfTtcbiAgICAgICAgaWYgKHRoaXMucHJvcHMudGFnID09PSBEZWZhdWx0VGFnSUQuSW52aXRlKSB7XG4gICAgICAgICAgICByb29tUHJvZmlsZSA9IENvbW11bml0eVByb3RvdHlwZVN0b3JlLmluc3RhbmNlLmdldEludml0ZVByb2ZpbGUodGhpcy5wcm9wcy5yb29tLnJvb21JZCk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgbmFtZSA9IHJvb21Qcm9maWxlLmRpc3BsYXlOYW1lIHx8IHRoaXMucHJvcHMucm9vbS5uYW1lO1xuICAgICAgICBpZiAodHlwZW9mIG5hbWUgIT09ICdzdHJpbmcnKSBuYW1lID0gJyc7XG4gICAgICAgIG5hbWUgPSBuYW1lLnJlcGxhY2UoXCI6XCIsIFwiOlxcdTIwMGJcIik7IC8vIGFkZCBhIHplcm8td2lkdGggc3BhY2UgdG8gYWxsb3cgbGluZXdyYXBwaW5nIGFmdGVyIHRoZSBjb2xvblxuXG4gICAgICAgIGNvbnN0IHJvb21BdmF0YXIgPSA8RGVjb3JhdGVkUm9vbUF2YXRhclxuICAgICAgICAgICAgcm9vbT17dGhpcy5wcm9wcy5yb29tfVxuICAgICAgICAgICAgYXZhdGFyU2l6ZT17MzJ9XG4gICAgICAgICAgICBkaXNwbGF5QmFkZ2U9e3RoaXMucHJvcHMuaXNNaW5pbWl6ZWR9XG4gICAgICAgICAgICBvb2JEYXRhPXsoeyBhdmF0YXJVcmw6IHJvb21Qcm9maWxlLmF2YXRhck14YyB9KX1cbiAgICAgICAgLz47XG5cbiAgICAgICAgbGV0IGJhZGdlOiBSZWFjdC5SZWFjdE5vZGU7XG4gICAgICAgIGlmICghdGhpcy5wcm9wcy5pc01pbmltaXplZCAmJiB0aGlzLm5vdGlmaWNhdGlvblN0YXRlKSB7XG4gICAgICAgICAgICAvLyBhcmlhLWhpZGRlbiBiZWNhdXNlIHdlIHN1bW1hcmlzZSB0aGUgdW5yZWFkIGNvdW50L2hpZ2hsaWdodCBzdGF0dXMgaW4gYSBtYW51YWwgYXJpYS1sYWJlbCBiZWxvd1xuICAgICAgICAgICAgYmFkZ2UgPSAoXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJteF9Sb29tVGlsZV9iYWRnZUNvbnRhaW5lclwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPlxuICAgICAgICAgICAgICAgICAgICA8Tm90aWZpY2F0aW9uQmFkZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbj17dGhpcy5ub3RpZmljYXRpb25TdGF0ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcmNlQ291bnQ9e2ZhbHNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgcm9vbUlkPXt0aGlzLnByb3BzLnJvb20ucm9vbUlkfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBtZXNzYWdlUHJldmlldyA9IG51bGw7XG4gICAgICAgIGlmICh0aGlzLnNob3dNZXNzYWdlUHJldmlldyAmJiB0aGlzLnN0YXRlLm1lc3NhZ2VQcmV2aWV3KSB7XG4gICAgICAgICAgICBtZXNzYWdlUHJldmlldyA9IChcbiAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm14X1Jvb21UaWxlX21lc3NhZ2VQcmV2aWV3XCJcbiAgICAgICAgICAgICAgICAgICAgaWQ9e21lc3NhZ2VQcmV2aWV3SWQodGhpcy5wcm9wcy5yb29tLnJvb21JZCl9XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlPXt0aGlzLnN0YXRlLm1lc3NhZ2VQcmV2aWV3fVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgeyB0aGlzLnN0YXRlLm1lc3NhZ2VQcmV2aWV3IH1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBuYW1lQ2xhc3NlcyA9IGNsYXNzTmFtZXMoe1xuICAgICAgICAgICAgXCJteF9Sb29tVGlsZV9uYW1lXCI6IHRydWUsXG4gICAgICAgICAgICBcIm14X1Jvb21UaWxlX25hbWVXaXRoUHJldmlld1wiOiAhIW1lc3NhZ2VQcmV2aWV3LFxuICAgICAgICAgICAgXCJteF9Sb29tVGlsZV9uYW1lSGFzVW5yZWFkRXZlbnRzXCI6IHRoaXMubm90aWZpY2F0aW9uU3RhdGUuaXNVbnJlYWQsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGxldCBuYW1lQ29udGFpbmVyID0gKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJteF9Sb29tVGlsZV9uYW1lQ29udGFpbmVyXCI+XG4gICAgICAgICAgICAgICAgPGRpdiB0aXRsZT17bmFtZX0gY2xhc3NOYW1lPXtuYW1lQ2xhc3Nlc30gdGFiSW5kZXg9ey0xfSBkaXI9XCJhdXRvXCI+XG4gICAgICAgICAgICAgICAgICAgIHsgbmFtZSB9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgeyBtZXNzYWdlUHJldmlldyB9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICAgICAgaWYgKHRoaXMucHJvcHMuaXNNaW5pbWl6ZWQpIG5hbWVDb250YWluZXIgPSBudWxsO1xuXG4gICAgICAgIGxldCBhcmlhTGFiZWwgPSBuYW1lO1xuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGxhYmVscyBhcmUgd3JpdHRlbiBpbiBzdWNoIGEgZmFzaGlvbiB0byBpbmNyZWFzZSBzY3JlZW4gcmVhZGVyIGVmZmljaWVuY3kgKHNwZWVkKS5cbiAgICAgICAgaWYgKHRoaXMucHJvcHMudGFnID09PSBEZWZhdWx0VGFnSUQuSW52aXRlKSB7XG4gICAgICAgICAgICAvLyBhcHBlbmQgbm90aGluZ1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMubm90aWZpY2F0aW9uU3RhdGUuaGFzTWVudGlvbnMpIHtcbiAgICAgICAgICAgIGFyaWFMYWJlbCArPSBcIiBcIiArIF90KFwiJShjb3VudClzIHVucmVhZCBtZXNzYWdlcyBpbmNsdWRpbmcgbWVudGlvbnMuXCIsIHtcbiAgICAgICAgICAgICAgICBjb3VudDogdGhpcy5ub3RpZmljYXRpb25TdGF0ZS5jb3VudCxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMubm90aWZpY2F0aW9uU3RhdGUuaGFzVW5yZWFkQ291bnQpIHtcbiAgICAgICAgICAgIGFyaWFMYWJlbCArPSBcIiBcIiArIF90KFwiJShjb3VudClzIHVucmVhZCBtZXNzYWdlcy5cIiwge1xuICAgICAgICAgICAgICAgIGNvdW50OiB0aGlzLm5vdGlmaWNhdGlvblN0YXRlLmNvdW50LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5ub3RpZmljYXRpb25TdGF0ZS5pc1VucmVhZCkge1xuICAgICAgICAgICAgYXJpYUxhYmVsICs9IFwiIFwiICsgX3QoXCJVbnJlYWQgbWVzc2FnZXMuXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGFyaWFEZXNjcmliZWRCeTogc3RyaW5nO1xuICAgICAgICBpZiAodGhpcy5zaG93TWVzc2FnZVByZXZpZXcpIHtcbiAgICAgICAgICAgIGFyaWFEZXNjcmliZWRCeSA9IG1lc3NhZ2VQcmV2aWV3SWQodGhpcy5wcm9wcy5yb29tLnJvb21JZCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBwcm9wczogUGFydGlhbDxSZWFjdC5Db21wb25lbnRQcm9wczx0eXBlb2YgQWNjZXNzaWJsZVRvb2x0aXBCdXR0b24+PiA9IHt9O1xuICAgICAgICBsZXQgQnV0dG9uOiBSZWFjdC5Db21wb25lbnRUeXBlPFJlYWN0LkNvbXBvbmVudFByb3BzPHR5cGVvZiBBY2Nlc3NpYmxlQnV0dG9uPj4gPSBBY2Nlc3NpYmxlQnV0dG9uO1xuICAgICAgICBpZiAodGhpcy5wcm9wcy5pc01pbmltaXplZCkge1xuICAgICAgICAgICAgQnV0dG9uID0gQWNjZXNzaWJsZVRvb2x0aXBCdXR0b247XG4gICAgICAgICAgICBwcm9wcy50aXRsZSA9IG5hbWU7XG4gICAgICAgICAgICAvLyBmb3JjZSB0aGUgdG9vbHRpcCB0byBoaWRlIHdoaWxzdCB3ZSBhcmUgc2hvd2luZyB0aGUgY29udGV4dCBtZW51XG4gICAgICAgICAgICBwcm9wcy5mb3JjZUhpZGUgPSAhIXRoaXMuc3RhdGUuZ2VuZXJhbE1lbnVQb3NpdGlvbjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8UmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICAgICAgICAgPFJvdmluZ1RhYkluZGV4V3JhcHBlciBpbnB1dFJlZj17dGhpcy5yb29tVGlsZVJlZn0+XG4gICAgICAgICAgICAgICAgICAgIHsgKHsgb25Gb2N1cywgaXNBY3RpdmUsIHJlZiB9KSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsuLi5wcm9wc31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkZvY3VzPXtvbkZvY3VzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYkluZGV4PXtpc0FjdGl2ZSA/IDAgOiAtMX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dFJlZj17cmVmfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y2xhc3Nlc31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uVGlsZUNsaWNrfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ29udGV4dE1lbnU9e3RoaXMub25Db250ZXh0TWVudX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb2xlPVwidHJlZWl0ZW1cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyaWEtbGFiZWw9e2FyaWFMYWJlbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmlhLXNlbGVjdGVkPXt0aGlzLnN0YXRlLnNlbGVjdGVkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyaWEtZGVzY3JpYmVkYnk9e2FyaWFEZXNjcmliZWRCeX1cbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHJvb21BdmF0YXIgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgbmFtZUNvbnRhaW5lciB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBiYWRnZSB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0aGlzLnJlbmRlckdlbmVyYWxNZW51KCkgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGhpcy5yZW5kZXJOb3RpZmljYXRpb25zTWVudShpc0FjdGl2ZSkgfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICA8L1JvdmluZ1RhYkluZGV4V3JhcHBlcj5cbiAgICAgICAgICAgIDwvUmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICk7XG4gICAgfVxufVxuIl19