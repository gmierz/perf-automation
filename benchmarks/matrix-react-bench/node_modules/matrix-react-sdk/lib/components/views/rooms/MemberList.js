"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireDefault(require("react"));

var _languageHandler = require("../../../languageHandler");

var _SdkConfig = _interopRequireDefault(require("../../../SdkConfig"));

var _dispatcher = _interopRequireDefault(require("../../../dispatcher/dispatcher"));

var _RoomInvite = require("../../../RoomInvite");

var _MatrixClientPeg = require("../../../MatrixClientPeg");

var _CommunityPrototypeStore = require("../../../stores/CommunityPrototypeStore");

var _BaseCard = _interopRequireDefault(require("../right_panel/BaseCard"));

var _RightPanelStorePhases = require("../../../stores/RightPanelStorePhases");

var _RoomAvatar = _interopRequireDefault(require("../avatars/RoomAvatar"));

var _RoomName = _interopRequireDefault(require("../elements/RoomName"));

var _replaceableComponent = require("../../../utils/replaceableComponent");

var _SettingsStore = _interopRequireDefault(require("../../../settings/SettingsStore"));

var _roomMember = require("matrix-js-sdk/src/models/room-member");

var _TruncatedList = _interopRequireDefault(require("../elements/TruncatedList"));

var _Spinner = _interopRequireDefault(require("../elements/Spinner"));

var _SearchBox = _interopRequireDefault(require("../../structures/SearchBox"));

var _AccessibleButton = _interopRequireDefault(require("../elements/AccessibleButton"));

var _EntityTile = _interopRequireDefault(require("./EntityTile"));

var _MemberTile = _interopRequireDefault(require("./MemberTile"));

var _BaseAvatar = _interopRequireDefault(require("../avatars/BaseAvatar"));

var _lodash = require("lodash");

var _SpaceStore = _interopRequireDefault(require("../../../stores/spaces/SpaceStore"));

var _UIComponents = require("../../../customisations/helpers/UIComponents");

var _UIFeature = require("../../../settings/UIFeature");

var _partials = require("matrix-js-sdk/src/@types/partials");

var _dec, _class;

const INITIAL_LOAD_NUM_MEMBERS = 30;
const INITIAL_LOAD_NUM_INVITED = 5;
const SHOW_MORE_INCREMENT = 100; // Regex applied to filter our punctuation in member names before applying sort, to fuzzy it a little
// matches all ASCII punctuation: !"#$%&'()*+,-./:;<=>?@[\]^_`{|}~

const SORT_REGEX = /[\x21-\x2F\x3A-\x40\x5B-\x60\x7B-\x7E]+/g;
let MemberList = (_dec = (0, _replaceableComponent.replaceableComponent)("views.rooms.MemberList"), _dec(_class = class MemberList extends _react.default.Component {
  // RoomMember -> sortName
  constructor(props) {
    super(props);
    (0, _defineProperty2.default)(this, "showPresence", true);
    (0, _defineProperty2.default)(this, "mounted", false);
    (0, _defineProperty2.default)(this, "collator", void 0);
    (0, _defineProperty2.default)(this, "sortNames", new Map());
    (0, _defineProperty2.default)(this, "onUserPresenceChange", (event, user) => {
      // Attach a SINGLE listener for global presence changes then locate the
      // member tile and re-render it. This is more efficient than every tile
      // ever attaching their own listener.
      const tile = this.refs[user.userId]; // console.log(`Got presence update for ${user.userId}. hasTile=${!!tile}`);

      if (tile) {
        this.updateList(); // reorder the membership list
      }
    });
    (0, _defineProperty2.default)(this, "onRoom", room => {
      if (room.roomId !== this.props.roomId) {
        return;
      } // We listen for room events because when we accept an invite
      // we need to wait till the room is fully populated with state
      // before refreshing the member list else we get a stale list.


      this.showMembersAccordingToMembershipWithLL();
    });
    (0, _defineProperty2.default)(this, "onMyMembership", (room, membership, oldMembership) => {
      if (room.roomId === this.props.roomId && membership === "join") {
        this.showMembersAccordingToMembershipWithLL();
      }
    });
    (0, _defineProperty2.default)(this, "onRoomStateMember", (ev, state, member) => {
      if (member.roomId !== this.props.roomId) {
        return;
      }

      this.updateList();
    });
    (0, _defineProperty2.default)(this, "onRoomMemberName", (ev, member) => {
      if (member.roomId !== this.props.roomId) {
        return;
      }

      this.updateList();
    });
    (0, _defineProperty2.default)(this, "onRoomStateEvent", (event, state) => {
      if (event.getRoomId() === this.props.roomId && event.getType() === "m.room.third_party_invite") {
        this.updateList();
      }

      if (this.canInvite !== this.state.canInvite) this.setState({
        canInvite: this.canInvite
      });
    });
    (0, _defineProperty2.default)(this, "updateList", (0, _lodash.throttle)(() => {
      this.updateListNow();
    }, 500, {
      leading: true,
      trailing: true
    }));
    (0, _defineProperty2.default)(this, "createOverflowTileJoined", (overflowCount, totalCount) => {
      return this.createOverflowTile(overflowCount, totalCount, this.showMoreJoinedMemberList);
    });
    (0, _defineProperty2.default)(this, "createOverflowTileInvited", (overflowCount, totalCount) => {
      return this.createOverflowTile(overflowCount, totalCount, this.showMoreInvitedMemberList);
    });
    (0, _defineProperty2.default)(this, "createOverflowTile", (overflowCount, totalCount, onClick) => {
      // For now we'll pretend this is any entity. It should probably be a separate tile.
      const text = (0, _languageHandler._t)("and %(count)s others...", {
        count: overflowCount
      });
      return /*#__PURE__*/_react.default.createElement(_EntityTile.default, {
        className: "mx_EntityTile_ellipsis",
        avatarJsx: /*#__PURE__*/_react.default.createElement(_BaseAvatar.default, {
          url: require("../../../../res/img/ellipsis.svg"),
          name: "...",
          width: 36,
          height: 36
        }),
        name: text,
        presenceState: "online",
        suppressOnHover: true,
        onClick: onClick
      });
    });
    (0, _defineProperty2.default)(this, "showMoreJoinedMemberList", () => {
      this.setState({
        truncateAtJoined: this.state.truncateAtJoined + SHOW_MORE_INCREMENT
      });
    });
    (0, _defineProperty2.default)(this, "showMoreInvitedMemberList", () => {
      this.setState({
        truncateAtInvited: this.state.truncateAtInvited + SHOW_MORE_INCREMENT
      });
    });
    (0, _defineProperty2.default)(this, "memberSort", (memberA, memberB) => {
      // order by presence, with "active now" first.
      // ...and then by power level
      // ...and then by last active
      // ...and then alphabetically.
      // We could tiebreak instead by "last recently spoken in this room" if we wanted to.
      // console.log(`Comparing userA=${this.memberString(memberA)} userB=${this.memberString(memberB)}`);
      const userA = memberA.user;
      const userB = memberB.user; // if (!userA) console.log("!! MISSING USER FOR A-SIDE: " + memberA.name + " !!");
      // if (!userB) console.log("!! MISSING USER FOR B-SIDE: " + memberB.name + " !!");

      if (!userA && !userB) return 0;
      if (userA && !userB) return -1;
      if (!userA && userB) return 1; // First by presence

      if (this.showPresence) {
        const convertPresence = p => p === 'unavailable' ? 'online' : p;

        const presenceIndex = p => {
          const order = ['active', 'online', 'offline'];
          const idx = order.indexOf(convertPresence(p));
          return idx === -1 ? order.length : idx; // unknown states at the end
        };

        const idxA = presenceIndex(userA.currentlyActive ? 'active' : userA.presence);
        const idxB = presenceIndex(userB.currentlyActive ? 'active' : userB.presence); // console.log(`userA_presenceGroup=${idxA} userB_presenceGroup=${idxB}`);

        if (idxA !== idxB) {
          // console.log("Comparing on presence group - returning");
          return idxA - idxB;
        }
      } // Second by power level


      if (memberA.powerLevel !== memberB.powerLevel) {
        // console.log("Comparing on power level - returning");
        return memberB.powerLevel - memberA.powerLevel;
      } // Third by last active


      if (this.showPresence && userA.getLastActiveTs() !== userB.getLastActiveTs()) {
        // console.log("Comparing on last active timestamp - returning");
        return userB.getLastActiveTs() - userA.getLastActiveTs();
      } // Fourth by name (alphabetical)


      return this.collator.compare(this.sortNames.get(memberA), this.sortNames.get(memberB));
    });
    (0, _defineProperty2.default)(this, "onSearchQueryChanged", searchQuery => {
      this.props.onSearchQueryChanged(searchQuery);
      this.setState({
        filteredJoinedMembers: this.filterMembers(this.state.members, 'join', searchQuery),
        filteredInvitedMembers: this.filterMembers(this.state.members, 'invite', searchQuery)
      });
    });
    (0, _defineProperty2.default)(this, "onPending3pidInviteClick", inviteEvent => {
      _dispatcher.default.dispatch({
        action: 'view_3pid_invite',
        event: inviteEvent
      });
    });
    (0, _defineProperty2.default)(this, "getChildrenJoined", (start, end) => {
      return this.makeMemberTiles(this.state.filteredJoinedMembers.slice(start, end));
    });
    (0, _defineProperty2.default)(this, "getChildCountJoined", () => this.state.filteredJoinedMembers.length);
    (0, _defineProperty2.default)(this, "getChildrenInvited", (start, end) => {
      let targets = this.state.filteredInvitedMembers;

      if (end > this.state.filteredInvitedMembers.length) {
        targets = targets.concat(this.getPending3PidInvites());
      }

      return this.makeMemberTiles(targets.slice(start, end));
    });
    (0, _defineProperty2.default)(this, "getChildCountInvited", () => {
      return this.state.filteredInvitedMembers.length + (this.getPending3PidInvites() || []).length;
    });
    (0, _defineProperty2.default)(this, "onInviteButtonClick", () => {
      if (_MatrixClientPeg.MatrixClientPeg.get().isGuest()) {
        _dispatcher.default.dispatch({
          action: 'require_registration'
        });

        return;
      } // call AddressPickerDialog


      _dispatcher.default.dispatch({
        action: 'view_invite',
        roomId: this.props.roomId
      });
    });

    const cli = _MatrixClientPeg.MatrixClientPeg.get();

    if (cli.hasLazyLoadMembersEnabled()) {
      // show an empty list
      this.state = this.getMembersState([]);
    } else {
      this.state = this.getMembersState(this.roomMembers());
    }

    cli.on("Room", this.onRoom); // invites & joining after peek

    const enablePresenceByHsUrl = _SdkConfig.default.get()["enable_presence_by_hs_url"];

    const hsUrl = _MatrixClientPeg.MatrixClientPeg.get().baseUrl;

    this.showPresence = (enablePresenceByHsUrl === null || enablePresenceByHsUrl === void 0 ? void 0 : enablePresenceByHsUrl[hsUrl]) ?? true;
  } // eslint-disable-next-line


  UNSAFE_componentWillMount() {
    const cli = _MatrixClientPeg.MatrixClientPeg.get();

    this.mounted = true;

    if (cli.hasLazyLoadMembersEnabled()) {
      this.showMembersAccordingToMembershipWithLL();
      cli.on("Room.myMembership", this.onMyMembership);
    } else {
      this.listenForMembersChanges();
    }
  }

  listenForMembersChanges() {
    const cli = _MatrixClientPeg.MatrixClientPeg.get();

    cli.on("RoomState.members", this.onRoomStateMember);
    cli.on("RoomMember.name", this.onRoomMemberName);
    cli.on("RoomState.events", this.onRoomStateEvent); // We listen for changes to the lastPresenceTs which is essentially
    // listening for all presence events (we display most of not all of
    // the information contained in presence events).

    cli.on("User.lastPresenceTs", this.onUserPresenceChange);
    cli.on("User.presence", this.onUserPresenceChange);
    cli.on("User.currentlyActive", this.onUserPresenceChange); // cli.on("Room.timeline", this.onRoomTimeline);
  }

  componentWillUnmount() {
    this.mounted = false;

    const cli = _MatrixClientPeg.MatrixClientPeg.get();

    if (cli) {
      cli.removeListener("RoomState.members", this.onRoomStateMember);
      cli.removeListener("RoomMember.name", this.onRoomMemberName);
      cli.removeListener("Room.myMembership", this.onMyMembership);
      cli.removeListener("RoomState.events", this.onRoomStateEvent);
      cli.removeListener("Room", this.onRoom);
      cli.removeListener("User.lastPresenceTs", this.onUserPresenceChange);
      cli.removeListener("User.presence", this.onUserPresenceChange);
      cli.removeListener("User.currentlyActive", this.onUserPresenceChange);
    } // cancel any pending calls to the rate_limited_funcs


    this.updateList.cancel();
  }
  /**
   * If lazy loading is enabled, either:
   * show a spinner and load the members if the user is joined,
   * or show the members available so far if the user is invited
   */


  async showMembersAccordingToMembershipWithLL() {
    const cli = _MatrixClientPeg.MatrixClientPeg.get();

    if (cli.hasLazyLoadMembersEnabled()) {
      const cli = _MatrixClientPeg.MatrixClientPeg.get();

      const room = cli.getRoom(this.props.roomId);
      const membership = room && room.getMyMembership();

      if (membership === "join") {
        this.setState({
          loading: true
        });

        try {
          await room.loadMembersIfNeeded();
        } catch (ex) {
          /* already logged in RoomView */
        }

        if (this.mounted) {
          this.setState(this.getMembersState(this.roomMembers()));
          this.listenForMembersChanges();
        }
      } else {
        // show the members we already have loaded
        this.setState(this.getMembersState(this.roomMembers()));
      }
    }
  }

  get canInvite() {
    const cli = _MatrixClientPeg.MatrixClientPeg.get();

    const room = cli.getRoom(this.props.roomId);
    return (room === null || room === void 0 ? void 0 : room.canInvite(cli.getUserId())) || (room === null || room === void 0 ? void 0 : room.isSpaceRoom()) && room.getJoinRule() === _partials.JoinRule.Public;
  }

  getMembersState(members) {
    // set the state after determining showPresence to make sure it's
    // taken into account while rendering
    return {
      loading: false,
      members: members,
      filteredJoinedMembers: this.filterMembers(members, 'join', this.props.searchQuery),
      filteredInvitedMembers: this.filterMembers(members, 'invite', this.props.searchQuery),
      canInvite: this.canInvite,
      // ideally we'd size this to the page height, but
      // in practice I find that a little constraining
      truncateAtJoined: INITIAL_LOAD_NUM_MEMBERS,
      truncateAtInvited: INITIAL_LOAD_NUM_INVITED
    };
  }

  updateListNow() {
    const members = this.roomMembers();
    this.setState({
      loading: false,
      members: members,
      filteredJoinedMembers: this.filterMembers(members, 'join', this.props.searchQuery),
      filteredInvitedMembers: this.filterMembers(members, 'invite', this.props.searchQuery)
    });
  }

  getMembersWithUser() {
    if (!this.props.roomId) return [];

    const cli = _MatrixClientPeg.MatrixClientPeg.get();

    const room = cli.getRoom(this.props.roomId);
    if (!room) return [];
    const allMembers = Object.values(room.currentState.members);
    allMembers.forEach(member => {
      // work around a race where you might have a room member object
      // before the user object exists. This may or may not cause
      // https://github.com/vector-im/vector-web/issues/186
      if (!member.user) {
        member.user = cli.getUser(member.userId);
      }

      this.sortNames.set(member, (member.name[0] === '@' ? member.name.substr(1) : member.name).replace(SORT_REGEX, "")); // XXX: this user may have no lastPresenceTs value!
      // the right solution here is to fix the race rather than leave it as 0
    });
    return allMembers;
  }

  roomMembers() {
    const allMembers = this.getMembersWithUser();
    const filteredAndSortedMembers = allMembers.filter(m => {
      return m.membership === 'join' || m.membership === 'invite';
    });

    const language = _SettingsStore.default.getValue("language");

    this.collator = new Intl.Collator(language, {
      sensitivity: 'base',
      ignorePunctuation: false
    });
    filteredAndSortedMembers.sort(this.memberSort);
    return filteredAndSortedMembers;
  }

  /**
   * SHOULD ONLY BE USED BY TESTS
   */
  memberString(member) {
    if (!member) {
      return "(null)";
    } else {
      const u = member.user;
      return "(" + member.name + ", " + member.powerLevel + ", " + (u ? u.lastActiveAgo : "<null>") + ", " + (u ? u.getLastActiveTs() : "<null>") + ", " + (u ? u.currentlyActive : "<null>") + ", " + (u ? u.presence : "<null>") + ")";
    }
  } // returns negative if a comes before b,
  // returns 0 if a and b are equivalent in ordering
  // returns positive if a comes after b.


  filterMembers(members, membership, query) {
    return members.filter(m => {
      if (query) {
        query = query.toLowerCase();
        const matchesName = m.name.toLowerCase().indexOf(query) !== -1;
        const matchesId = m.userId.toLowerCase().indexOf(query) !== -1;

        if (!matchesName && !matchesId) {
          return false;
        }
      }

      return m.membership === membership;
    });
  }

  getPending3PidInvites() {
    // include 3pid invites (m.room.third_party_invite) state events.
    // The HS may have already converted these into m.room.member invites so
    // we shouldn't add them if the 3pid invite state key (token) is in the
    // member invite (content.third_party_invite.signed.token)
    const room = _MatrixClientPeg.MatrixClientPeg.get().getRoom(this.props.roomId);

    if (room) {
      return room.currentState.getStateEvents("m.room.third_party_invite").filter(function (e) {
        if (!(0, _RoomInvite.isValid3pidInvite)(e)) return false; // discard all invites which have a m.room.member event since we've
        // already added them.

        const memberEvent = room.currentState.getInviteForThreePidToken(e.getStateKey());
        if (memberEvent) return false;
        return true;
      });
    }
  }

  makeMemberTiles(members) {
    return members.map(m => {
      if (m instanceof _roomMember.RoomMember) {
        // Is a Matrix invite
        return /*#__PURE__*/_react.default.createElement(_MemberTile.default, {
          key: m.userId,
          member: m,
          ref: m.userId,
          showPresence: this.showPresence
        });
      } else {
        // Is a 3pid invite
        return /*#__PURE__*/_react.default.createElement(_EntityTile.default, {
          key: m.getStateKey(),
          name: m.getContent().display_name,
          suppressOnHover: true,
          onClick: () => this.onPending3pidInviteClick(m)
        });
      }
    });
  }

  render() {
    if (this.state.loading) {
      return /*#__PURE__*/_react.default.createElement(_BaseCard.default, {
        className: "mx_MemberList",
        onClose: this.props.onClose,
        previousPhase: _RightPanelStorePhases.RightPanelPhases.RoomSummary
      }, /*#__PURE__*/_react.default.createElement(_Spinner.default, null));
    }

    const cli = _MatrixClientPeg.MatrixClientPeg.get();

    const room = cli.getRoom(this.props.roomId);
    let inviteButton;

    if ((room === null || room === void 0 ? void 0 : room.getMyMembership()) === 'join' && (0, _UIComponents.shouldShowComponent)(_UIFeature.UIComponent.InviteUsers)) {
      let inviteButtonText = (0, _languageHandler._t)("Invite to this room");

      const chat = _CommunityPrototypeStore.CommunityPrototypeStore.instance.getSelectedCommunityGeneralChat();

      if (chat && chat.roomId === this.props.roomId) {
        inviteButtonText = (0, _languageHandler._t)("Invite to this community");
      } else if (_SpaceStore.default.spacesEnabled && room.isSpaceRoom()) {
        inviteButtonText = (0, _languageHandler._t)("Invite to this space");
      }

      inviteButton = /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
        className: "mx_MemberList_invite",
        onClick: this.onInviteButtonClick,
        disabled: !this.state.canInvite
      }, /*#__PURE__*/_react.default.createElement("span", null, inviteButtonText));
    }

    let invitedHeader;
    let invitedSection;

    if (this.getChildCountInvited() > 0) {
      invitedHeader = /*#__PURE__*/_react.default.createElement("h2", null, (0, _languageHandler._t)("Invited"));
      invitedSection = /*#__PURE__*/_react.default.createElement(_TruncatedList.default, {
        className: "mx_MemberList_section mx_MemberList_invited",
        truncateAt: this.state.truncateAtInvited,
        createOverflowElement: this.createOverflowTileInvited,
        getChildren: this.getChildrenInvited,
        getChildCount: this.getChildCountInvited
      });
    }

    const footer = /*#__PURE__*/_react.default.createElement(_SearchBox.default, {
      className: "mx_MemberList_query mx_textinput_icon mx_textinput_search",
      placeholder: (0, _languageHandler._t)('Filter room members'),
      onSearch: this.onSearchQueryChanged,
      initialValue: this.props.searchQuery
    });

    let previousPhase = _RightPanelStorePhases.RightPanelPhases.RoomSummary; // We have no previousPhase for when viewing a MemberList from a Space

    let scopeHeader;

    if (_SpaceStore.default.spacesEnabled && room !== null && room !== void 0 && room.isSpaceRoom()) {
      previousPhase = undefined;
      scopeHeader = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_RightPanel_scopeHeader"
      }, /*#__PURE__*/_react.default.createElement(_RoomAvatar.default, {
        room: room,
        height: 32,
        width: 32
      }), /*#__PURE__*/_react.default.createElement(_RoomName.default, {
        room: room
      }));
    }

    return /*#__PURE__*/_react.default.createElement(_BaseCard.default, {
      className: "mx_MemberList",
      header: /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, scopeHeader, inviteButton),
      footer: footer,
      onClose: this.props.onClose,
      previousPhase: previousPhase
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_MemberList_wrapper"
    }, /*#__PURE__*/_react.default.createElement(_TruncatedList.default, {
      className: "mx_MemberList_section mx_MemberList_joined",
      truncateAt: this.state.truncateAtJoined,
      createOverflowElement: this.createOverflowTileJoined,
      getChildren: this.getChildrenJoined,
      getChildCount: this.getChildCountJoined
    }), invitedHeader, invitedSection));
  }

}) || _class);
exports.default = MemberList;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZpZXdzL3Jvb21zL01lbWJlckxpc3QudHN4Il0sIm5hbWVzIjpbIklOSVRJQUxfTE9BRF9OVU1fTUVNQkVSUyIsIklOSVRJQUxfTE9BRF9OVU1fSU5WSVRFRCIsIlNIT1dfTU9SRV9JTkNSRU1FTlQiLCJTT1JUX1JFR0VYIiwiTWVtYmVyTGlzdCIsIlJlYWN0IiwiQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJwcm9wcyIsIk1hcCIsImV2ZW50IiwidXNlciIsInRpbGUiLCJyZWZzIiwidXNlcklkIiwidXBkYXRlTGlzdCIsInJvb20iLCJyb29tSWQiLCJzaG93TWVtYmVyc0FjY29yZGluZ1RvTWVtYmVyc2hpcFdpdGhMTCIsIm1lbWJlcnNoaXAiLCJvbGRNZW1iZXJzaGlwIiwiZXYiLCJzdGF0ZSIsIm1lbWJlciIsImdldFJvb21JZCIsImdldFR5cGUiLCJjYW5JbnZpdGUiLCJzZXRTdGF0ZSIsInVwZGF0ZUxpc3ROb3ciLCJsZWFkaW5nIiwidHJhaWxpbmciLCJvdmVyZmxvd0NvdW50IiwidG90YWxDb3VudCIsImNyZWF0ZU92ZXJmbG93VGlsZSIsInNob3dNb3JlSm9pbmVkTWVtYmVyTGlzdCIsInNob3dNb3JlSW52aXRlZE1lbWJlckxpc3QiLCJvbkNsaWNrIiwidGV4dCIsImNvdW50IiwicmVxdWlyZSIsInRydW5jYXRlQXRKb2luZWQiLCJ0cnVuY2F0ZUF0SW52aXRlZCIsIm1lbWJlckEiLCJtZW1iZXJCIiwidXNlckEiLCJ1c2VyQiIsInNob3dQcmVzZW5jZSIsImNvbnZlcnRQcmVzZW5jZSIsInAiLCJwcmVzZW5jZUluZGV4Iiwib3JkZXIiLCJpZHgiLCJpbmRleE9mIiwibGVuZ3RoIiwiaWR4QSIsImN1cnJlbnRseUFjdGl2ZSIsInByZXNlbmNlIiwiaWR4QiIsInBvd2VyTGV2ZWwiLCJnZXRMYXN0QWN0aXZlVHMiLCJjb2xsYXRvciIsImNvbXBhcmUiLCJzb3J0TmFtZXMiLCJnZXQiLCJzZWFyY2hRdWVyeSIsIm9uU2VhcmNoUXVlcnlDaGFuZ2VkIiwiZmlsdGVyZWRKb2luZWRNZW1iZXJzIiwiZmlsdGVyTWVtYmVycyIsIm1lbWJlcnMiLCJmaWx0ZXJlZEludml0ZWRNZW1iZXJzIiwiaW52aXRlRXZlbnQiLCJkaXMiLCJkaXNwYXRjaCIsImFjdGlvbiIsInN0YXJ0IiwiZW5kIiwibWFrZU1lbWJlclRpbGVzIiwic2xpY2UiLCJ0YXJnZXRzIiwiY29uY2F0IiwiZ2V0UGVuZGluZzNQaWRJbnZpdGVzIiwiTWF0cml4Q2xpZW50UGVnIiwiaXNHdWVzdCIsImNsaSIsImhhc0xhenlMb2FkTWVtYmVyc0VuYWJsZWQiLCJnZXRNZW1iZXJzU3RhdGUiLCJyb29tTWVtYmVycyIsIm9uIiwib25Sb29tIiwiZW5hYmxlUHJlc2VuY2VCeUhzVXJsIiwiU2RrQ29uZmlnIiwiaHNVcmwiLCJiYXNlVXJsIiwiVU5TQUZFX2NvbXBvbmVudFdpbGxNb3VudCIsIm1vdW50ZWQiLCJvbk15TWVtYmVyc2hpcCIsImxpc3RlbkZvck1lbWJlcnNDaGFuZ2VzIiwib25Sb29tU3RhdGVNZW1iZXIiLCJvblJvb21NZW1iZXJOYW1lIiwib25Sb29tU3RhdGVFdmVudCIsIm9uVXNlclByZXNlbmNlQ2hhbmdlIiwiY29tcG9uZW50V2lsbFVubW91bnQiLCJyZW1vdmVMaXN0ZW5lciIsImNhbmNlbCIsImdldFJvb20iLCJnZXRNeU1lbWJlcnNoaXAiLCJsb2FkaW5nIiwibG9hZE1lbWJlcnNJZk5lZWRlZCIsImV4IiwiZ2V0VXNlcklkIiwiaXNTcGFjZVJvb20iLCJnZXRKb2luUnVsZSIsIkpvaW5SdWxlIiwiUHVibGljIiwiZ2V0TWVtYmVyc1dpdGhVc2VyIiwiYWxsTWVtYmVycyIsIk9iamVjdCIsInZhbHVlcyIsImN1cnJlbnRTdGF0ZSIsImZvckVhY2giLCJnZXRVc2VyIiwic2V0IiwibmFtZSIsInN1YnN0ciIsInJlcGxhY2UiLCJmaWx0ZXJlZEFuZFNvcnRlZE1lbWJlcnMiLCJmaWx0ZXIiLCJtIiwibGFuZ3VhZ2UiLCJTZXR0aW5nc1N0b3JlIiwiZ2V0VmFsdWUiLCJJbnRsIiwiQ29sbGF0b3IiLCJzZW5zaXRpdml0eSIsImlnbm9yZVB1bmN0dWF0aW9uIiwic29ydCIsIm1lbWJlclNvcnQiLCJtZW1iZXJTdHJpbmciLCJ1IiwibGFzdEFjdGl2ZUFnbyIsInF1ZXJ5IiwidG9Mb3dlckNhc2UiLCJtYXRjaGVzTmFtZSIsIm1hdGNoZXNJZCIsImdldFN0YXRlRXZlbnRzIiwiZSIsIm1lbWJlckV2ZW50IiwiZ2V0SW52aXRlRm9yVGhyZWVQaWRUb2tlbiIsImdldFN0YXRlS2V5IiwibWFwIiwiUm9vbU1lbWJlciIsImdldENvbnRlbnQiLCJkaXNwbGF5X25hbWUiLCJvblBlbmRpbmczcGlkSW52aXRlQ2xpY2siLCJyZW5kZXIiLCJvbkNsb3NlIiwiUmlnaHRQYW5lbFBoYXNlcyIsIlJvb21TdW1tYXJ5IiwiaW52aXRlQnV0dG9uIiwiVUlDb21wb25lbnQiLCJJbnZpdGVVc2VycyIsImludml0ZUJ1dHRvblRleHQiLCJjaGF0IiwiQ29tbXVuaXR5UHJvdG90eXBlU3RvcmUiLCJpbnN0YW5jZSIsImdldFNlbGVjdGVkQ29tbXVuaXR5R2VuZXJhbENoYXQiLCJTcGFjZVN0b3JlIiwic3BhY2VzRW5hYmxlZCIsIm9uSW52aXRlQnV0dG9uQ2xpY2siLCJpbnZpdGVkSGVhZGVyIiwiaW52aXRlZFNlY3Rpb24iLCJnZXRDaGlsZENvdW50SW52aXRlZCIsImNyZWF0ZU92ZXJmbG93VGlsZUludml0ZWQiLCJnZXRDaGlsZHJlbkludml0ZWQiLCJmb290ZXIiLCJwcmV2aW91c1BoYXNlIiwic2NvcGVIZWFkZXIiLCJ1bmRlZmluZWQiLCJjcmVhdGVPdmVyZmxvd1RpbGVKb2luZWQiLCJnZXRDaGlsZHJlbkpvaW5lZCIsImdldENoaWxkQ291bnRKb2luZWQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBbUJBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNB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QSxNQUFNLGVBQUUsNkJBQUMsY0FBRCxDQUFPLFFBQVAsUUFDRmdLLFdBREUsRUFFRmxCLFlBRkUsQ0FGTDtBQU1ILE1BQUEsTUFBTSxFQUFFZ0IsTUFOTDtBQU9ILE1BQUEsT0FBTyxFQUFFLEtBQUt0SyxLQUFMLENBQVdtSixPQVBqQjtBQVFILE1BQUEsYUFBYSxFQUFFb0I7QUFSWixvQkFVSDtBQUFLLE1BQUEsU0FBUyxFQUFDO0FBQWYsb0JBQ0ksNkJBQUMsc0JBQUQ7QUFDSSxNQUFBLFNBQVMsRUFBQyw0Q0FEZDtBQUVJLE1BQUEsVUFBVSxFQUFFLEtBQUt6SixLQUFMLENBQVdrQixnQkFGM0I7QUFHSSxNQUFBLHFCQUFxQixFQUFFLEtBQUswSSx3QkFIaEM7QUFJSSxNQUFBLFdBQVcsRUFBRSxLQUFLQyxpQkFKdEI7QUFLSSxNQUFBLGFBQWEsRUFBRSxLQUFLQztBQUx4QixNQURKLEVBT01YLGFBUE4sRUFRTUMsY0FSTixDQVZHLENBQVA7QUFxQkg7O0FBNWdCbUUsQyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG5Db3B5cmlnaHQgMjAxNSwgMjAxNiBPcGVuTWFya2V0IEx0ZFxuQ29weXJpZ2h0IDIwMTcgVmVjdG9yIENyZWF0aW9ucyBMdGRcbkNvcHlyaWdodCAyMDE3LCAyMDE4IE5ldyBWZWN0b3IgTHRkXG5Db3B5cmlnaHQgMjAyMSDFoGltb24gQnJhbmRuZXIgPHNpbW9uLmJyYS5hZ0BnbWFpbC5jb20+XG5cbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG55b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG5Zb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcblxuICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuXG5Vbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG5kaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG5XSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cblNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbmxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuKi9cblxuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IF90IH0gZnJvbSAnLi4vLi4vLi4vbGFuZ3VhZ2VIYW5kbGVyJztcbmltcG9ydCBTZGtDb25maWcgZnJvbSAnLi4vLi4vLi4vU2RrQ29uZmlnJztcbmltcG9ydCBkaXMgZnJvbSAnLi4vLi4vLi4vZGlzcGF0Y2hlci9kaXNwYXRjaGVyJztcbmltcG9ydCB7IGlzVmFsaWQzcGlkSW52aXRlIH0gZnJvbSBcIi4uLy4uLy4uL1Jvb21JbnZpdGVcIjtcbmltcG9ydCB7IE1hdHJpeENsaWVudFBlZyB9IGZyb20gXCIuLi8uLi8uLi9NYXRyaXhDbGllbnRQZWdcIjtcbmltcG9ydCB7IENvbW11bml0eVByb3RvdHlwZVN0b3JlIH0gZnJvbSBcIi4uLy4uLy4uL3N0b3Jlcy9Db21tdW5pdHlQcm90b3R5cGVTdG9yZVwiO1xuaW1wb3J0IEJhc2VDYXJkIGZyb20gXCIuLi9yaWdodF9wYW5lbC9CYXNlQ2FyZFwiO1xuaW1wb3J0IHsgUmlnaHRQYW5lbFBoYXNlcyB9IGZyb20gXCIuLi8uLi8uLi9zdG9yZXMvUmlnaHRQYW5lbFN0b3JlUGhhc2VzXCI7XG5pbXBvcnQgUm9vbUF2YXRhciBmcm9tIFwiLi4vYXZhdGFycy9Sb29tQXZhdGFyXCI7XG5pbXBvcnQgUm9vbU5hbWUgZnJvbSBcIi4uL2VsZW1lbnRzL1Jvb21OYW1lXCI7XG5pbXBvcnQgeyByZXBsYWNlYWJsZUNvbXBvbmVudCB9IGZyb20gXCIuLi8uLi8uLi91dGlscy9yZXBsYWNlYWJsZUNvbXBvbmVudFwiO1xuaW1wb3J0IFNldHRpbmdzU3RvcmUgZnJvbSBcIi4uLy4uLy4uL3NldHRpbmdzL1NldHRpbmdzU3RvcmVcIjtcbmltcG9ydCB7IE1hdHJpeEV2ZW50IH0gZnJvbSAnbWF0cml4LWpzLXNkay9zcmMvbW9kZWxzL2V2ZW50JztcbmltcG9ydCB7IFJvb20gfSBmcm9tICdtYXRyaXgtanMtc2RrL3NyYy9tb2RlbHMvcm9vbSc7XG5pbXBvcnQgeyBSb29tTWVtYmVyIH0gZnJvbSAnbWF0cml4LWpzLXNkay9zcmMvbW9kZWxzL3Jvb20tbWVtYmVyJztcbmltcG9ydCB7IFJvb21TdGF0ZSB9IGZyb20gJ21hdHJpeC1qcy1zZGsvc3JjL21vZGVscy9yb29tLXN0YXRlJztcbmltcG9ydCB7IFVzZXIgfSBmcm9tIFwibWF0cml4LWpzLXNkay9zcmMvbW9kZWxzL3VzZXJcIjtcbmltcG9ydCBUcnVuY2F0ZWRMaXN0IGZyb20gJy4uL2VsZW1lbnRzL1RydW5jYXRlZExpc3QnO1xuaW1wb3J0IFNwaW5uZXIgZnJvbSBcIi4uL2VsZW1lbnRzL1NwaW5uZXJcIjtcbmltcG9ydCBTZWFyY2hCb3ggZnJvbSBcIi4uLy4uL3N0cnVjdHVyZXMvU2VhcmNoQm94XCI7XG5pbXBvcnQgQWNjZXNzaWJsZUJ1dHRvbiBmcm9tICcuLi9lbGVtZW50cy9BY2Nlc3NpYmxlQnV0dG9uJztcbmltcG9ydCBFbnRpdHlUaWxlIGZyb20gXCIuL0VudGl0eVRpbGVcIjtcbmltcG9ydCBNZW1iZXJUaWxlIGZyb20gXCIuL01lbWJlclRpbGVcIjtcbmltcG9ydCBCYXNlQXZhdGFyIGZyb20gJy4uL2F2YXRhcnMvQmFzZUF2YXRhcic7XG5pbXBvcnQgeyB0aHJvdHRsZSB9IGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgU3BhY2VTdG9yZSBmcm9tIFwiLi4vLi4vLi4vc3RvcmVzL3NwYWNlcy9TcGFjZVN0b3JlXCI7XG5pbXBvcnQgeyBzaG91bGRTaG93Q29tcG9uZW50IH0gZnJvbSBcIi4uLy4uLy4uL2N1c3RvbWlzYXRpb25zL2hlbHBlcnMvVUlDb21wb25lbnRzXCI7XG5pbXBvcnQgeyBVSUNvbXBvbmVudCB9IGZyb20gXCIuLi8uLi8uLi9zZXR0aW5ncy9VSUZlYXR1cmVcIjtcbmltcG9ydCB7IEpvaW5SdWxlIH0gZnJvbSBcIm1hdHJpeC1qcy1zZGsvc3JjL0B0eXBlcy9wYXJ0aWFsc1wiO1xuXG5jb25zdCBJTklUSUFMX0xPQURfTlVNX01FTUJFUlMgPSAzMDtcbmNvbnN0IElOSVRJQUxfTE9BRF9OVU1fSU5WSVRFRCA9IDU7XG5jb25zdCBTSE9XX01PUkVfSU5DUkVNRU5UID0gMTAwO1xuXG4vLyBSZWdleCBhcHBsaWVkIHRvIGZpbHRlciBvdXIgcHVuY3R1YXRpb24gaW4gbWVtYmVyIG5hbWVzIGJlZm9yZSBhcHBseWluZyBzb3J0LCB0byBmdXp6eSBpdCBhIGxpdHRsZVxuLy8gbWF0Y2hlcyBhbGwgQVNDSUkgcHVuY3R1YXRpb246ICFcIiMkJSYnKCkqKywtLi86Ozw9Pj9AW1xcXV5fYHt8fX5cbmNvbnN0IFNPUlRfUkVHRVggPSAvW1xceDIxLVxceDJGXFx4M0EtXFx4NDBcXHg1Qi1cXHg2MFxceDdCLVxceDdFXSsvZztcblxuaW50ZXJmYWNlIElQcm9wcyB7XG4gICAgcm9vbUlkOiBzdHJpbmc7XG4gICAgc2VhcmNoUXVlcnk6IHN0cmluZztcbiAgICBvbkNsb3NlKCk6IHZvaWQ7XG4gICAgb25TZWFyY2hRdWVyeUNoYW5nZWQ6IChxdWVyeTogc3RyaW5nKSA9PiB2b2lkO1xufVxuXG5pbnRlcmZhY2UgSVN0YXRlIHtcbiAgICBsb2FkaW5nOiBib29sZWFuO1xuICAgIG1lbWJlcnM6IEFycmF5PFJvb21NZW1iZXI+O1xuICAgIGZpbHRlcmVkSm9pbmVkTWVtYmVyczogQXJyYXk8Um9vbU1lbWJlcj47XG4gICAgZmlsdGVyZWRJbnZpdGVkTWVtYmVyczogQXJyYXk8Um9vbU1lbWJlciB8IE1hdHJpeEV2ZW50PjtcbiAgICBjYW5JbnZpdGU6IGJvb2xlYW47XG4gICAgdHJ1bmNhdGVBdEpvaW5lZDogbnVtYmVyO1xuICAgIHRydW5jYXRlQXRJbnZpdGVkOiBudW1iZXI7XG59XG5cbkByZXBsYWNlYWJsZUNvbXBvbmVudChcInZpZXdzLnJvb21zLk1lbWJlckxpc3RcIilcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1lbWJlckxpc3QgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8SVByb3BzLCBJU3RhdGU+IHtcbiAgICBwcml2YXRlIHNob3dQcmVzZW5jZSA9IHRydWU7XG4gICAgcHJpdmF0ZSBtb3VudGVkID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBjb2xsYXRvcjogSW50bC5Db2xsYXRvcjtcbiAgICBwcml2YXRlIHNvcnROYW1lcyA9IG5ldyBNYXA8Um9vbU1lbWJlciwgc3RyaW5nPigpOyAvLyBSb29tTWVtYmVyIC0+IHNvcnROYW1lXG5cbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgICBzdXBlcihwcm9wcyk7XG5cbiAgICAgICAgY29uc3QgY2xpID0gTWF0cml4Q2xpZW50UGVnLmdldCgpO1xuICAgICAgICBpZiAoY2xpLmhhc0xhenlMb2FkTWVtYmVyc0VuYWJsZWQoKSkge1xuICAgICAgICAgICAgLy8gc2hvdyBhbiBlbXB0eSBsaXN0XG4gICAgICAgICAgICB0aGlzLnN0YXRlID0gdGhpcy5nZXRNZW1iZXJzU3RhdGUoW10pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZSA9IHRoaXMuZ2V0TWVtYmVyc1N0YXRlKHRoaXMucm9vbU1lbWJlcnMoKSk7XG4gICAgICAgIH1cblxuICAgICAgICBjbGkub24oXCJSb29tXCIsIHRoaXMub25Sb29tKTsgLy8gaW52aXRlcyAmIGpvaW5pbmcgYWZ0ZXIgcGVla1xuICAgICAgICBjb25zdCBlbmFibGVQcmVzZW5jZUJ5SHNVcmwgPSBTZGtDb25maWcuZ2V0KClbXCJlbmFibGVfcHJlc2VuY2VfYnlfaHNfdXJsXCJdO1xuICAgICAgICBjb25zdCBoc1VybCA9IE1hdHJpeENsaWVudFBlZy5nZXQoKS5iYXNlVXJsO1xuICAgICAgICB0aGlzLnNob3dQcmVzZW5jZSA9IGVuYWJsZVByZXNlbmNlQnlIc1VybD8uW2hzVXJsXSA/PyB0cnVlO1xuICAgIH1cblxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICAgIFVOU0FGRV9jb21wb25lbnRXaWxsTW91bnQoKSB7XG4gICAgICAgIGNvbnN0IGNsaSA9IE1hdHJpeENsaWVudFBlZy5nZXQoKTtcbiAgICAgICAgdGhpcy5tb3VudGVkID0gdHJ1ZTtcbiAgICAgICAgaWYgKGNsaS5oYXNMYXp5TG9hZE1lbWJlcnNFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd01lbWJlcnNBY2NvcmRpbmdUb01lbWJlcnNoaXBXaXRoTEwoKTtcbiAgICAgICAgICAgIGNsaS5vbihcIlJvb20ubXlNZW1iZXJzaGlwXCIsIHRoaXMub25NeU1lbWJlcnNoaXApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5saXN0ZW5Gb3JNZW1iZXJzQ2hhbmdlcygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBsaXN0ZW5Gb3JNZW1iZXJzQ2hhbmdlcygpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgY2xpID0gTWF0cml4Q2xpZW50UGVnLmdldCgpO1xuICAgICAgICBjbGkub24oXCJSb29tU3RhdGUubWVtYmVyc1wiLCB0aGlzLm9uUm9vbVN0YXRlTWVtYmVyKTtcbiAgICAgICAgY2xpLm9uKFwiUm9vbU1lbWJlci5uYW1lXCIsIHRoaXMub25Sb29tTWVtYmVyTmFtZSk7XG4gICAgICAgIGNsaS5vbihcIlJvb21TdGF0ZS5ldmVudHNcIiwgdGhpcy5vblJvb21TdGF0ZUV2ZW50KTtcbiAgICAgICAgLy8gV2UgbGlzdGVuIGZvciBjaGFuZ2VzIHRvIHRoZSBsYXN0UHJlc2VuY2VUcyB3aGljaCBpcyBlc3NlbnRpYWxseVxuICAgICAgICAvLyBsaXN0ZW5pbmcgZm9yIGFsbCBwcmVzZW5jZSBldmVudHMgKHdlIGRpc3BsYXkgbW9zdCBvZiBub3QgYWxsIG9mXG4gICAgICAgIC8vIHRoZSBpbmZvcm1hdGlvbiBjb250YWluZWQgaW4gcHJlc2VuY2UgZXZlbnRzKS5cbiAgICAgICAgY2xpLm9uKFwiVXNlci5sYXN0UHJlc2VuY2VUc1wiLCB0aGlzLm9uVXNlclByZXNlbmNlQ2hhbmdlKTtcbiAgICAgICAgY2xpLm9uKFwiVXNlci5wcmVzZW5jZVwiLCB0aGlzLm9uVXNlclByZXNlbmNlQ2hhbmdlKTtcbiAgICAgICAgY2xpLm9uKFwiVXNlci5jdXJyZW50bHlBY3RpdmVcIiwgdGhpcy5vblVzZXJQcmVzZW5jZUNoYW5nZSk7XG4gICAgICAgIC8vIGNsaS5vbihcIlJvb20udGltZWxpbmVcIiwgdGhpcy5vblJvb21UaW1lbGluZSk7XG4gICAgfVxuXG4gICAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgICAgIHRoaXMubW91bnRlZCA9IGZhbHNlO1xuICAgICAgICBjb25zdCBjbGkgPSBNYXRyaXhDbGllbnRQZWcuZ2V0KCk7XG4gICAgICAgIGlmIChjbGkpIHtcbiAgICAgICAgICAgIGNsaS5yZW1vdmVMaXN0ZW5lcihcIlJvb21TdGF0ZS5tZW1iZXJzXCIsIHRoaXMub25Sb29tU3RhdGVNZW1iZXIpO1xuICAgICAgICAgICAgY2xpLnJlbW92ZUxpc3RlbmVyKFwiUm9vbU1lbWJlci5uYW1lXCIsIHRoaXMub25Sb29tTWVtYmVyTmFtZSk7XG4gICAgICAgICAgICBjbGkucmVtb3ZlTGlzdGVuZXIoXCJSb29tLm15TWVtYmVyc2hpcFwiLCB0aGlzLm9uTXlNZW1iZXJzaGlwKTtcbiAgICAgICAgICAgIGNsaS5yZW1vdmVMaXN0ZW5lcihcIlJvb21TdGF0ZS5ldmVudHNcIiwgdGhpcy5vblJvb21TdGF0ZUV2ZW50KTtcbiAgICAgICAgICAgIGNsaS5yZW1vdmVMaXN0ZW5lcihcIlJvb21cIiwgdGhpcy5vblJvb20pO1xuICAgICAgICAgICAgY2xpLnJlbW92ZUxpc3RlbmVyKFwiVXNlci5sYXN0UHJlc2VuY2VUc1wiLCB0aGlzLm9uVXNlclByZXNlbmNlQ2hhbmdlKTtcbiAgICAgICAgICAgIGNsaS5yZW1vdmVMaXN0ZW5lcihcIlVzZXIucHJlc2VuY2VcIiwgdGhpcy5vblVzZXJQcmVzZW5jZUNoYW5nZSk7XG4gICAgICAgICAgICBjbGkucmVtb3ZlTGlzdGVuZXIoXCJVc2VyLmN1cnJlbnRseUFjdGl2ZVwiLCB0aGlzLm9uVXNlclByZXNlbmNlQ2hhbmdlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGNhbmNlbCBhbnkgcGVuZGluZyBjYWxscyB0byB0aGUgcmF0ZV9saW1pdGVkX2Z1bmNzXG4gICAgICAgIHRoaXMudXBkYXRlTGlzdC5jYW5jZWwoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJZiBsYXp5IGxvYWRpbmcgaXMgZW5hYmxlZCwgZWl0aGVyOlxuICAgICAqIHNob3cgYSBzcGlubmVyIGFuZCBsb2FkIHRoZSBtZW1iZXJzIGlmIHRoZSB1c2VyIGlzIGpvaW5lZCxcbiAgICAgKiBvciBzaG93IHRoZSBtZW1iZXJzIGF2YWlsYWJsZSBzbyBmYXIgaWYgdGhlIHVzZXIgaXMgaW52aXRlZFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgc2hvd01lbWJlcnNBY2NvcmRpbmdUb01lbWJlcnNoaXBXaXRoTEwoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGNsaSA9IE1hdHJpeENsaWVudFBlZy5nZXQoKTtcbiAgICAgICAgaWYgKGNsaS5oYXNMYXp5TG9hZE1lbWJlcnNFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIGNvbnN0IGNsaSA9IE1hdHJpeENsaWVudFBlZy5nZXQoKTtcbiAgICAgICAgICAgIGNvbnN0IHJvb20gPSBjbGkuZ2V0Um9vbSh0aGlzLnByb3BzLnJvb21JZCk7XG4gICAgICAgICAgICBjb25zdCBtZW1iZXJzaGlwID0gcm9vbSAmJiByb29tLmdldE15TWVtYmVyc2hpcCgpO1xuICAgICAgICAgICAgaWYgKG1lbWJlcnNoaXAgPT09IFwiam9pblwiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGxvYWRpbmc6IHRydWUgfSk7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgcm9vbS5sb2FkTWVtYmVyc0lmTmVlZGVkKCk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXgpIHsvKiBhbHJlYWR5IGxvZ2dlZCBpbiBSb29tVmlldyAqL31cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5tb3VudGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUodGhpcy5nZXRNZW1iZXJzU3RhdGUodGhpcy5yb29tTWVtYmVycygpKSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuRm9yTWVtYmVyc0NoYW5nZXMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIHNob3cgdGhlIG1lbWJlcnMgd2UgYWxyZWFkeSBoYXZlIGxvYWRlZFxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUodGhpcy5nZXRNZW1iZXJzU3RhdGUodGhpcy5yb29tTWVtYmVycygpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGdldCBjYW5JbnZpdGUoKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IGNsaSA9IE1hdHJpeENsaWVudFBlZy5nZXQoKTtcbiAgICAgICAgY29uc3Qgcm9vbSA9IGNsaS5nZXRSb29tKHRoaXMucHJvcHMucm9vbUlkKTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgcm9vbT8uY2FuSW52aXRlKGNsaS5nZXRVc2VySWQoKSkgfHxcbiAgICAgICAgICAgIChyb29tPy5pc1NwYWNlUm9vbSgpICYmIHJvb20uZ2V0Sm9pblJ1bGUoKSA9PT0gSm9pblJ1bGUuUHVibGljKVxuICAgICAgICApO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0TWVtYmVyc1N0YXRlKG1lbWJlcnM6IEFycmF5PFJvb21NZW1iZXI+KTogSVN0YXRlIHtcbiAgICAgICAgLy8gc2V0IHRoZSBzdGF0ZSBhZnRlciBkZXRlcm1pbmluZyBzaG93UHJlc2VuY2UgdG8gbWFrZSBzdXJlIGl0J3NcbiAgICAgICAgLy8gdGFrZW4gaW50byBhY2NvdW50IHdoaWxlIHJlbmRlcmluZ1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbG9hZGluZzogZmFsc2UsXG4gICAgICAgICAgICBtZW1iZXJzOiBtZW1iZXJzLFxuICAgICAgICAgICAgZmlsdGVyZWRKb2luZWRNZW1iZXJzOiB0aGlzLmZpbHRlck1lbWJlcnMobWVtYmVycywgJ2pvaW4nLCB0aGlzLnByb3BzLnNlYXJjaFF1ZXJ5KSxcbiAgICAgICAgICAgIGZpbHRlcmVkSW52aXRlZE1lbWJlcnM6IHRoaXMuZmlsdGVyTWVtYmVycyhtZW1iZXJzLCAnaW52aXRlJywgdGhpcy5wcm9wcy5zZWFyY2hRdWVyeSksXG4gICAgICAgICAgICBjYW5JbnZpdGU6IHRoaXMuY2FuSW52aXRlLFxuXG4gICAgICAgICAgICAvLyBpZGVhbGx5IHdlJ2Qgc2l6ZSB0aGlzIHRvIHRoZSBwYWdlIGhlaWdodCwgYnV0XG4gICAgICAgICAgICAvLyBpbiBwcmFjdGljZSBJIGZpbmQgdGhhdCBhIGxpdHRsZSBjb25zdHJhaW5pbmdcbiAgICAgICAgICAgIHRydW5jYXRlQXRKb2luZWQ6IElOSVRJQUxfTE9BRF9OVU1fTUVNQkVSUyxcbiAgICAgICAgICAgIHRydW5jYXRlQXRJbnZpdGVkOiBJTklUSUFMX0xPQURfTlVNX0lOVklURUQsXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvblVzZXJQcmVzZW5jZUNoYW5nZSA9IChldmVudDogTWF0cml4RXZlbnQsIHVzZXI6IFVzZXIpOiB2b2lkID0+IHtcbiAgICAgICAgLy8gQXR0YWNoIGEgU0lOR0xFIGxpc3RlbmVyIGZvciBnbG9iYWwgcHJlc2VuY2UgY2hhbmdlcyB0aGVuIGxvY2F0ZSB0aGVcbiAgICAgICAgLy8gbWVtYmVyIHRpbGUgYW5kIHJlLXJlbmRlciBpdC4gVGhpcyBpcyBtb3JlIGVmZmljaWVudCB0aGFuIGV2ZXJ5IHRpbGVcbiAgICAgICAgLy8gZXZlciBhdHRhY2hpbmcgdGhlaXIgb3duIGxpc3RlbmVyLlxuICAgICAgICBjb25zdCB0aWxlID0gdGhpcy5yZWZzW3VzZXIudXNlcklkXTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coYEdvdCBwcmVzZW5jZSB1cGRhdGUgZm9yICR7dXNlci51c2VySWR9LiBoYXNUaWxlPSR7ISF0aWxlfWApO1xuICAgICAgICBpZiAodGlsZSkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVMaXN0KCk7IC8vIHJlb3JkZXIgdGhlIG1lbWJlcnNoaXAgbGlzdFxuICAgICAgICB9XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25Sb29tID0gKHJvb206IFJvb20pOiB2b2lkID0+IHtcbiAgICAgICAgaWYgKHJvb20ucm9vbUlkICE9PSB0aGlzLnByb3BzLnJvb21JZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIFdlIGxpc3RlbiBmb3Igcm9vbSBldmVudHMgYmVjYXVzZSB3aGVuIHdlIGFjY2VwdCBhbiBpbnZpdGVcbiAgICAgICAgLy8gd2UgbmVlZCB0byB3YWl0IHRpbGwgdGhlIHJvb20gaXMgZnVsbHkgcG9wdWxhdGVkIHdpdGggc3RhdGVcbiAgICAgICAgLy8gYmVmb3JlIHJlZnJlc2hpbmcgdGhlIG1lbWJlciBsaXN0IGVsc2Ugd2UgZ2V0IGEgc3RhbGUgbGlzdC5cbiAgICAgICAgdGhpcy5zaG93TWVtYmVyc0FjY29yZGluZ1RvTWVtYmVyc2hpcFdpdGhMTCgpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uTXlNZW1iZXJzaGlwID0gKHJvb206IFJvb20sIG1lbWJlcnNoaXA6IHN0cmluZywgb2xkTWVtYmVyc2hpcDogc3RyaW5nKTogdm9pZCA9PiB7XG4gICAgICAgIGlmIChyb29tLnJvb21JZCA9PT0gdGhpcy5wcm9wcy5yb29tSWQgJiYgbWVtYmVyc2hpcCA9PT0gXCJqb2luXCIpIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd01lbWJlcnNBY2NvcmRpbmdUb01lbWJlcnNoaXBXaXRoTEwoKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwcml2YXRlIG9uUm9vbVN0YXRlTWVtYmVyID0gKGV2OiBNYXRyaXhFdmVudCwgc3RhdGU6IFJvb21TdGF0ZSwgbWVtYmVyOiBSb29tTWVtYmVyKTogdm9pZCA9PiB7XG4gICAgICAgIGlmIChtZW1iZXIucm9vbUlkICE9PSB0aGlzLnByb3BzLnJvb21JZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudXBkYXRlTGlzdCgpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uUm9vbU1lbWJlck5hbWUgPSAoZXY6IE1hdHJpeEV2ZW50LCBtZW1iZXI6IFJvb21NZW1iZXIpOiB2b2lkID0+IHtcbiAgICAgICAgaWYgKG1lbWJlci5yb29tSWQgIT09IHRoaXMucHJvcHMucm9vbUlkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cGRhdGVMaXN0KCk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25Sb29tU3RhdGVFdmVudCA9IChldmVudDogTWF0cml4RXZlbnQsIHN0YXRlOiBSb29tU3RhdGUpOiB2b2lkID0+IHtcbiAgICAgICAgaWYgKGV2ZW50LmdldFJvb21JZCgpID09PSB0aGlzLnByb3BzLnJvb21JZCAmJlxuICAgICAgICAgICAgZXZlbnQuZ2V0VHlwZSgpID09PSBcIm0ucm9vbS50aGlyZF9wYXJ0eV9pbnZpdGVcIikge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVMaXN0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5jYW5JbnZpdGUgIT09IHRoaXMuc3RhdGUuY2FuSW52aXRlKSB0aGlzLnNldFN0YXRlKHsgY2FuSW52aXRlOiB0aGlzLmNhbkludml0ZSB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSB1cGRhdGVMaXN0ID0gdGhyb3R0bGUoKCkgPT4ge1xuICAgICAgICB0aGlzLnVwZGF0ZUxpc3ROb3coKTtcbiAgICB9LCA1MDAsIHsgbGVhZGluZzogdHJ1ZSwgdHJhaWxpbmc6IHRydWUgfSk7XG5cbiAgICBwcml2YXRlIHVwZGF0ZUxpc3ROb3coKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1lbWJlcnMgPSB0aGlzLnJvb21NZW1iZXJzKCk7XG5cbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBsb2FkaW5nOiBmYWxzZSxcbiAgICAgICAgICAgIG1lbWJlcnM6IG1lbWJlcnMsXG4gICAgICAgICAgICBmaWx0ZXJlZEpvaW5lZE1lbWJlcnM6IHRoaXMuZmlsdGVyTWVtYmVycyhtZW1iZXJzLCAnam9pbicsIHRoaXMucHJvcHMuc2VhcmNoUXVlcnkpLFxuICAgICAgICAgICAgZmlsdGVyZWRJbnZpdGVkTWVtYmVyczogdGhpcy5maWx0ZXJNZW1iZXJzKG1lbWJlcnMsICdpbnZpdGUnLCB0aGlzLnByb3BzLnNlYXJjaFF1ZXJ5KSxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRNZW1iZXJzV2l0aFVzZXIoKTogQXJyYXk8Um9vbU1lbWJlcj4ge1xuICAgICAgICBpZiAoIXRoaXMucHJvcHMucm9vbUlkKSByZXR1cm4gW107XG4gICAgICAgIGNvbnN0IGNsaSA9IE1hdHJpeENsaWVudFBlZy5nZXQoKTtcbiAgICAgICAgY29uc3Qgcm9vbSA9IGNsaS5nZXRSb29tKHRoaXMucHJvcHMucm9vbUlkKTtcbiAgICAgICAgaWYgKCFyb29tKSByZXR1cm4gW107XG5cbiAgICAgICAgY29uc3QgYWxsTWVtYmVycyA9IE9iamVjdC52YWx1ZXMocm9vbS5jdXJyZW50U3RhdGUubWVtYmVycyk7XG5cbiAgICAgICAgYWxsTWVtYmVycy5mb3JFYWNoKChtZW1iZXIpID0+IHtcbiAgICAgICAgICAgIC8vIHdvcmsgYXJvdW5kIGEgcmFjZSB3aGVyZSB5b3UgbWlnaHQgaGF2ZSBhIHJvb20gbWVtYmVyIG9iamVjdFxuICAgICAgICAgICAgLy8gYmVmb3JlIHRoZSB1c2VyIG9iamVjdCBleGlzdHMuIFRoaXMgbWF5IG9yIG1heSBub3QgY2F1c2VcbiAgICAgICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS92ZWN0b3ItaW0vdmVjdG9yLXdlYi9pc3N1ZXMvMTg2XG4gICAgICAgICAgICBpZiAoIW1lbWJlci51c2VyKSB7XG4gICAgICAgICAgICAgICAgbWVtYmVyLnVzZXIgPSBjbGkuZ2V0VXNlcihtZW1iZXIudXNlcklkKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5zb3J0TmFtZXMuc2V0KFxuICAgICAgICAgICAgICAgIG1lbWJlcixcbiAgICAgICAgICAgICAgICAobWVtYmVyLm5hbWVbMF0gPT09ICdAJyA/IG1lbWJlci5uYW1lLnN1YnN0cigxKSA6IG1lbWJlci5uYW1lKS5yZXBsYWNlKFNPUlRfUkVHRVgsIFwiXCIpLFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gWFhYOiB0aGlzIHVzZXIgbWF5IGhhdmUgbm8gbGFzdFByZXNlbmNlVHMgdmFsdWUhXG4gICAgICAgICAgICAvLyB0aGUgcmlnaHQgc29sdXRpb24gaGVyZSBpcyB0byBmaXggdGhlIHJhY2UgcmF0aGVyIHRoYW4gbGVhdmUgaXQgYXMgMFxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gYWxsTWVtYmVycztcbiAgICB9XG5cbiAgICBwcml2YXRlIHJvb21NZW1iZXJzKCk6IEFycmF5PFJvb21NZW1iZXI+IHtcbiAgICAgICAgY29uc3QgYWxsTWVtYmVycyA9IHRoaXMuZ2V0TWVtYmVyc1dpdGhVc2VyKCk7XG4gICAgICAgIGNvbnN0IGZpbHRlcmVkQW5kU29ydGVkTWVtYmVycyA9IGFsbE1lbWJlcnMuZmlsdGVyKChtKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIG0ubWVtYmVyc2hpcCA9PT0gJ2pvaW4nIHx8IG0ubWVtYmVyc2hpcCA9PT0gJ2ludml0ZSdcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBsYW5ndWFnZSA9IFNldHRpbmdzU3RvcmUuZ2V0VmFsdWUoXCJsYW5ndWFnZVwiKTtcbiAgICAgICAgdGhpcy5jb2xsYXRvciA9IG5ldyBJbnRsLkNvbGxhdG9yKGxhbmd1YWdlLCB7IHNlbnNpdGl2aXR5OiAnYmFzZScsIGlnbm9yZVB1bmN0dWF0aW9uOiBmYWxzZSB9KTtcbiAgICAgICAgZmlsdGVyZWRBbmRTb3J0ZWRNZW1iZXJzLnNvcnQodGhpcy5tZW1iZXJTb3J0KTtcbiAgICAgICAgcmV0dXJuIGZpbHRlcmVkQW5kU29ydGVkTWVtYmVycztcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZU92ZXJmbG93VGlsZUpvaW5lZCA9IChvdmVyZmxvd0NvdW50OiBudW1iZXIsIHRvdGFsQ291bnQ6IG51bWJlcik6IEpTWC5FbGVtZW50ID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlT3ZlcmZsb3dUaWxlKG92ZXJmbG93Q291bnQsIHRvdGFsQ291bnQsIHRoaXMuc2hvd01vcmVKb2luZWRNZW1iZXJMaXN0KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjcmVhdGVPdmVyZmxvd1RpbGVJbnZpdGVkID0gKG92ZXJmbG93Q291bnQ6IG51bWJlciwgdG90YWxDb3VudDogbnVtYmVyKTogSlNYLkVsZW1lbnQgPT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVPdmVyZmxvd1RpbGUob3ZlcmZsb3dDb3VudCwgdG90YWxDb3VudCwgdGhpcy5zaG93TW9yZUludml0ZWRNZW1iZXJMaXN0KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjcmVhdGVPdmVyZmxvd1RpbGUgPSAob3ZlcmZsb3dDb3VudDogbnVtYmVyLCB0b3RhbENvdW50OiBudW1iZXIsIG9uQ2xpY2s6ICgpID0+IHZvaWQpOiBKU1guRWxlbWVudD0+IHtcbiAgICAgICAgLy8gRm9yIG5vdyB3ZSdsbCBwcmV0ZW5kIHRoaXMgaXMgYW55IGVudGl0eS4gSXQgc2hvdWxkIHByb2JhYmx5IGJlIGEgc2VwYXJhdGUgdGlsZS5cbiAgICAgICAgY29uc3QgdGV4dCA9IF90KFwiYW5kICUoY291bnQpcyBvdGhlcnMuLi5cIiwgeyBjb3VudDogb3ZlcmZsb3dDb3VudCB9KTtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxFbnRpdHlUaWxlXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXhfRW50aXR5VGlsZV9lbGxpcHNpc1wiXG4gICAgICAgICAgICAgICAgYXZhdGFySnN4PXtcbiAgICAgICAgICAgICAgICAgICAgPEJhc2VBdmF0YXIgdXJsPXtyZXF1aXJlKFwiLi4vLi4vLi4vLi4vcmVzL2ltZy9lbGxpcHNpcy5zdmdcIil9IG5hbWU9XCIuLi5cIiB3aWR0aD17MzZ9IGhlaWdodD17MzZ9IC8+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5hbWU9e3RleHR9XG4gICAgICAgICAgICAgICAgcHJlc2VuY2VTdGF0ZT1cIm9ubGluZVwiXG4gICAgICAgICAgICAgICAgc3VwcHJlc3NPbkhvdmVyPXt0cnVlfVxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9e29uQ2xpY2t9XG4gICAgICAgICAgICAvPlxuICAgICAgICApO1xuICAgIH07XG5cbiAgICBwcml2YXRlIHNob3dNb3JlSm9pbmVkTWVtYmVyTGlzdCA9ICgpOiB2b2lkID0+IHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICB0cnVuY2F0ZUF0Sm9pbmVkOiB0aGlzLnN0YXRlLnRydW5jYXRlQXRKb2luZWQgKyBTSE9XX01PUkVfSU5DUkVNRU5ULFxuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBzaG93TW9yZUludml0ZWRNZW1iZXJMaXN0ID0gKCk6IHZvaWQgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIHRydW5jYXRlQXRJbnZpdGVkOiB0aGlzLnN0YXRlLnRydW5jYXRlQXRJbnZpdGVkICsgU0hPV19NT1JFX0lOQ1JFTUVOVCxcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFNIT1VMRCBPTkxZIEJFIFVTRUQgQlkgVEVTVFNcbiAgICAgKi9cbiAgICBwdWJsaWMgbWVtYmVyU3RyaW5nKG1lbWJlcjogUm9vbU1lbWJlcik6IHN0cmluZyB7XG4gICAgICAgIGlmICghbWVtYmVyKSB7XG4gICAgICAgICAgICByZXR1cm4gXCIobnVsbClcIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHUgPSBtZW1iZXIudXNlcjtcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgXCIoXCIgK1xuICAgICAgICAgICAgICAgIG1lbWJlci5uYW1lICtcbiAgICAgICAgICAgICAgICBcIiwgXCIgK1xuICAgICAgICAgICAgICAgIG1lbWJlci5wb3dlckxldmVsICtcbiAgICAgICAgICAgICAgICBcIiwgXCIgK1xuICAgICAgICAgICAgICAgICh1ID8gdS5sYXN0QWN0aXZlQWdvIDogXCI8bnVsbD5cIikgK1xuICAgICAgICAgICAgICAgIFwiLCBcIiArXG4gICAgICAgICAgICAgICAgKHUgPyB1LmdldExhc3RBY3RpdmVUcygpIDogXCI8bnVsbD5cIikgK1xuICAgICAgICAgICAgICAgIFwiLCBcIiArXG4gICAgICAgICAgICAgICAgKHUgPyB1LmN1cnJlbnRseUFjdGl2ZSA6IFwiPG51bGw+XCIpICtcbiAgICAgICAgICAgICAgICBcIiwgXCIgK1xuICAgICAgICAgICAgICAgICh1ID8gdS5wcmVzZW5jZSA6IFwiPG51bGw+XCIpICtcbiAgICAgICAgICAgICAgICBcIilcIlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIHJldHVybnMgbmVnYXRpdmUgaWYgYSBjb21lcyBiZWZvcmUgYixcbiAgICAvLyByZXR1cm5zIDAgaWYgYSBhbmQgYiBhcmUgZXF1aXZhbGVudCBpbiBvcmRlcmluZ1xuICAgIC8vIHJldHVybnMgcG9zaXRpdmUgaWYgYSBjb21lcyBhZnRlciBiLlxuICAgIHByaXZhdGUgbWVtYmVyU29ydCA9IChtZW1iZXJBOiBSb29tTWVtYmVyLCBtZW1iZXJCOiBSb29tTWVtYmVyKTogbnVtYmVyID0+IHtcbiAgICAgICAgLy8gb3JkZXIgYnkgcHJlc2VuY2UsIHdpdGggXCJhY3RpdmUgbm93XCIgZmlyc3QuXG4gICAgICAgIC8vIC4uLmFuZCB0aGVuIGJ5IHBvd2VyIGxldmVsXG4gICAgICAgIC8vIC4uLmFuZCB0aGVuIGJ5IGxhc3QgYWN0aXZlXG4gICAgICAgIC8vIC4uLmFuZCB0aGVuIGFscGhhYmV0aWNhbGx5LlxuICAgICAgICAvLyBXZSBjb3VsZCB0aWVicmVhayBpbnN0ZWFkIGJ5IFwibGFzdCByZWNlbnRseSBzcG9rZW4gaW4gdGhpcyByb29tXCIgaWYgd2Ugd2FudGVkIHRvLlxuXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGBDb21wYXJpbmcgdXNlckE9JHt0aGlzLm1lbWJlclN0cmluZyhtZW1iZXJBKX0gdXNlckI9JHt0aGlzLm1lbWJlclN0cmluZyhtZW1iZXJCKX1gKTtcblxuICAgICAgICBjb25zdCB1c2VyQSA9IG1lbWJlckEudXNlcjtcbiAgICAgICAgY29uc3QgdXNlckIgPSBtZW1iZXJCLnVzZXI7XG5cbiAgICAgICAgLy8gaWYgKCF1c2VyQSkgY29uc29sZS5sb2coXCIhISBNSVNTSU5HIFVTRVIgRk9SIEEtU0lERTogXCIgKyBtZW1iZXJBLm5hbWUgKyBcIiAhIVwiKTtcbiAgICAgICAgLy8gaWYgKCF1c2VyQikgY29uc29sZS5sb2coXCIhISBNSVNTSU5HIFVTRVIgRk9SIEItU0lERTogXCIgKyBtZW1iZXJCLm5hbWUgKyBcIiAhIVwiKTtcblxuICAgICAgICBpZiAoIXVzZXJBICYmICF1c2VyQikgcmV0dXJuIDA7XG4gICAgICAgIGlmICh1c2VyQSAmJiAhdXNlckIpIHJldHVybiAtMTtcbiAgICAgICAgaWYgKCF1c2VyQSAmJiB1c2VyQikgcmV0dXJuIDE7XG5cbiAgICAgICAgLy8gRmlyc3QgYnkgcHJlc2VuY2VcbiAgICAgICAgaWYgKHRoaXMuc2hvd1ByZXNlbmNlKSB7XG4gICAgICAgICAgICBjb25zdCBjb252ZXJ0UHJlc2VuY2UgPSAocCkgPT4gcCA9PT0gJ3VuYXZhaWxhYmxlJyA/ICdvbmxpbmUnIDogcDtcbiAgICAgICAgICAgIGNvbnN0IHByZXNlbmNlSW5kZXggPSBwID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBvcmRlciA9IFsnYWN0aXZlJywgJ29ubGluZScsICdvZmZsaW5lJ107XG4gICAgICAgICAgICAgICAgY29uc3QgaWR4ID0gb3JkZXIuaW5kZXhPZihjb252ZXJ0UHJlc2VuY2UocCkpO1xuICAgICAgICAgICAgICAgIHJldHVybiBpZHggPT09IC0xID8gb3JkZXIubGVuZ3RoIDogaWR4OyAvLyB1bmtub3duIHN0YXRlcyBhdCB0aGUgZW5kXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCBpZHhBID0gcHJlc2VuY2VJbmRleCh1c2VyQS5jdXJyZW50bHlBY3RpdmUgPyAnYWN0aXZlJyA6IHVzZXJBLnByZXNlbmNlKTtcbiAgICAgICAgICAgIGNvbnN0IGlkeEIgPSBwcmVzZW5jZUluZGV4KHVzZXJCLmN1cnJlbnRseUFjdGl2ZSA/ICdhY3RpdmUnIDogdXNlckIucHJlc2VuY2UpO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYHVzZXJBX3ByZXNlbmNlR3JvdXA9JHtpZHhBfSB1c2VyQl9wcmVzZW5jZUdyb3VwPSR7aWR4Qn1gKTtcbiAgICAgICAgICAgIGlmIChpZHhBICE9PSBpZHhCKSB7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJDb21wYXJpbmcgb24gcHJlc2VuY2UgZ3JvdXAgLSByZXR1cm5pbmdcIik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlkeEEgLSBpZHhCO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2Vjb25kIGJ5IHBvd2VyIGxldmVsXG4gICAgICAgIGlmIChtZW1iZXJBLnBvd2VyTGV2ZWwgIT09IG1lbWJlckIucG93ZXJMZXZlbCkge1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJDb21wYXJpbmcgb24gcG93ZXIgbGV2ZWwgLSByZXR1cm5pbmdcIik7XG4gICAgICAgICAgICByZXR1cm4gbWVtYmVyQi5wb3dlckxldmVsIC0gbWVtYmVyQS5wb3dlckxldmVsO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVGhpcmQgYnkgbGFzdCBhY3RpdmVcbiAgICAgICAgaWYgKHRoaXMuc2hvd1ByZXNlbmNlICYmIHVzZXJBLmdldExhc3RBY3RpdmVUcygpICE9PSB1c2VyQi5nZXRMYXN0QWN0aXZlVHMoKSkge1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJDb21wYXJpbmcgb24gbGFzdCBhY3RpdmUgdGltZXN0YW1wIC0gcmV0dXJuaW5nXCIpO1xuICAgICAgICAgICAgcmV0dXJuIHVzZXJCLmdldExhc3RBY3RpdmVUcygpIC0gdXNlckEuZ2V0TGFzdEFjdGl2ZVRzKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGb3VydGggYnkgbmFtZSAoYWxwaGFiZXRpY2FsKVxuICAgICAgICByZXR1cm4gdGhpcy5jb2xsYXRvci5jb21wYXJlKHRoaXMuc29ydE5hbWVzLmdldChtZW1iZXJBKSwgdGhpcy5zb3J0TmFtZXMuZ2V0KG1lbWJlckIpKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvblNlYXJjaFF1ZXJ5Q2hhbmdlZCA9IChzZWFyY2hRdWVyeTogc3RyaW5nKTogdm9pZCA9PiB7XG4gICAgICAgIHRoaXMucHJvcHMub25TZWFyY2hRdWVyeUNoYW5nZWQoc2VhcmNoUXVlcnkpO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGZpbHRlcmVkSm9pbmVkTWVtYmVyczogdGhpcy5maWx0ZXJNZW1iZXJzKHRoaXMuc3RhdGUubWVtYmVycywgJ2pvaW4nLCBzZWFyY2hRdWVyeSksXG4gICAgICAgICAgICBmaWx0ZXJlZEludml0ZWRNZW1iZXJzOiB0aGlzLmZpbHRlck1lbWJlcnModGhpcy5zdGF0ZS5tZW1iZXJzLCAnaW52aXRlJywgc2VhcmNoUXVlcnkpLFxuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvblBlbmRpbmczcGlkSW52aXRlQ2xpY2sgPSAoaW52aXRlRXZlbnQ6IE1hdHJpeEV2ZW50KTogdm9pZCA9PiB7XG4gICAgICAgIGRpcy5kaXNwYXRjaCh7XG4gICAgICAgICAgICBhY3Rpb246ICd2aWV3XzNwaWRfaW52aXRlJyxcbiAgICAgICAgICAgIGV2ZW50OiBpbnZpdGVFdmVudCxcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgZmlsdGVyTWVtYmVycyhtZW1iZXJzOiBBcnJheTxSb29tTWVtYmVyPiwgbWVtYmVyc2hpcDogc3RyaW5nLCBxdWVyeT86IHN0cmluZyk6IEFycmF5PFJvb21NZW1iZXI+IHtcbiAgICAgICAgcmV0dXJuIG1lbWJlcnMuZmlsdGVyKChtKSA9PiB7XG4gICAgICAgICAgICBpZiAocXVlcnkpIHtcbiAgICAgICAgICAgICAgICBxdWVyeSA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbWF0Y2hlc05hbWUgPSBtLm5hbWUudG9Mb3dlckNhc2UoKS5pbmRleE9mKHF1ZXJ5KSAhPT0gLTE7XG4gICAgICAgICAgICAgICAgY29uc3QgbWF0Y2hlc0lkID0gbS51c2VySWQudG9Mb3dlckNhc2UoKS5pbmRleE9mKHF1ZXJ5KSAhPT0gLTE7XG5cbiAgICAgICAgICAgICAgICBpZiAoIW1hdGNoZXNOYW1lICYmICFtYXRjaGVzSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIG0ubWVtYmVyc2hpcCA9PT0gbWVtYmVyc2hpcDtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRQZW5kaW5nM1BpZEludml0ZXMoKTogQXJyYXk8TWF0cml4RXZlbnQ+IHtcbiAgICAgICAgLy8gaW5jbHVkZSAzcGlkIGludml0ZXMgKG0ucm9vbS50aGlyZF9wYXJ0eV9pbnZpdGUpIHN0YXRlIGV2ZW50cy5cbiAgICAgICAgLy8gVGhlIEhTIG1heSBoYXZlIGFscmVhZHkgY29udmVydGVkIHRoZXNlIGludG8gbS5yb29tLm1lbWJlciBpbnZpdGVzIHNvXG4gICAgICAgIC8vIHdlIHNob3VsZG4ndCBhZGQgdGhlbSBpZiB0aGUgM3BpZCBpbnZpdGUgc3RhdGUga2V5ICh0b2tlbikgaXMgaW4gdGhlXG4gICAgICAgIC8vIG1lbWJlciBpbnZpdGUgKGNvbnRlbnQudGhpcmRfcGFydHlfaW52aXRlLnNpZ25lZC50b2tlbilcbiAgICAgICAgY29uc3Qgcm9vbSA9IE1hdHJpeENsaWVudFBlZy5nZXQoKS5nZXRSb29tKHRoaXMucHJvcHMucm9vbUlkKTtcblxuICAgICAgICBpZiAocm9vbSkge1xuICAgICAgICAgICAgcmV0dXJuIHJvb20uY3VycmVudFN0YXRlLmdldFN0YXRlRXZlbnRzKFwibS5yb29tLnRoaXJkX3BhcnR5X2ludml0ZVwiKS5maWx0ZXIoZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgIGlmICghaXNWYWxpZDNwaWRJbnZpdGUoZSkpIHJldHVybiBmYWxzZTtcblxuICAgICAgICAgICAgICAgIC8vIGRpc2NhcmQgYWxsIGludml0ZXMgd2hpY2ggaGF2ZSBhIG0ucm9vbS5tZW1iZXIgZXZlbnQgc2luY2Ugd2UndmVcbiAgICAgICAgICAgICAgICAvLyBhbHJlYWR5IGFkZGVkIHRoZW0uXG4gICAgICAgICAgICAgICAgY29uc3QgbWVtYmVyRXZlbnQgPSByb29tLmN1cnJlbnRTdGF0ZS5nZXRJbnZpdGVGb3JUaHJlZVBpZFRva2VuKGUuZ2V0U3RhdGVLZXkoKSk7XG4gICAgICAgICAgICAgICAgaWYgKG1lbWJlckV2ZW50KSByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgbWFrZU1lbWJlclRpbGVzKG1lbWJlcnM6IEFycmF5PFJvb21NZW1iZXIgfCBNYXRyaXhFdmVudD4pIHtcbiAgICAgICAgcmV0dXJuIG1lbWJlcnMubWFwKChtKSA9PiB7XG4gICAgICAgICAgICBpZiAobSBpbnN0YW5jZW9mIFJvb21NZW1iZXIpIHtcbiAgICAgICAgICAgICAgICAvLyBJcyBhIE1hdHJpeCBpbnZpdGVcbiAgICAgICAgICAgICAgICByZXR1cm4gPE1lbWJlclRpbGUga2V5PXttLnVzZXJJZH0gbWVtYmVyPXttfSByZWY9e20udXNlcklkfSBzaG93UHJlc2VuY2U9e3RoaXMuc2hvd1ByZXNlbmNlfSAvPjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gSXMgYSAzcGlkIGludml0ZVxuICAgICAgICAgICAgICAgIHJldHVybiA8RW50aXR5VGlsZVxuICAgICAgICAgICAgICAgICAgICBrZXk9e20uZ2V0U3RhdGVLZXkoKX1cbiAgICAgICAgICAgICAgICAgICAgbmFtZT17bS5nZXRDb250ZW50KCkuZGlzcGxheV9uYW1lfVxuICAgICAgICAgICAgICAgICAgICBzdXBwcmVzc09uSG92ZXI9e3RydWV9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHRoaXMub25QZW5kaW5nM3BpZEludml0ZUNsaWNrKG0pfVxuICAgICAgICAgICAgICAgIC8+O1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldENoaWxkcmVuSm9pbmVkID0gKHN0YXJ0OiBudW1iZXIsIGVuZDogbnVtYmVyKTogQXJyYXk8SlNYLkVsZW1lbnQ+ID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMubWFrZU1lbWJlclRpbGVzKHRoaXMuc3RhdGUuZmlsdGVyZWRKb2luZWRNZW1iZXJzLnNsaWNlKHN0YXJ0LCBlbmQpKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBnZXRDaGlsZENvdW50Sm9pbmVkID0gKCk6IG51bWJlciA9PiB0aGlzLnN0YXRlLmZpbHRlcmVkSm9pbmVkTWVtYmVycy5sZW5ndGg7XG5cbiAgICBwcml2YXRlIGdldENoaWxkcmVuSW52aXRlZCA9IChzdGFydDogbnVtYmVyLCBlbmQ6IG51bWJlcik6IEFycmF5PEpTWC5FbGVtZW50PiA9PiB7XG4gICAgICAgIGxldCB0YXJnZXRzID0gdGhpcy5zdGF0ZS5maWx0ZXJlZEludml0ZWRNZW1iZXJzO1xuICAgICAgICBpZiAoZW5kID4gdGhpcy5zdGF0ZS5maWx0ZXJlZEludml0ZWRNZW1iZXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgdGFyZ2V0cyA9IHRhcmdldHMuY29uY2F0KHRoaXMuZ2V0UGVuZGluZzNQaWRJbnZpdGVzKCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMubWFrZU1lbWJlclRpbGVzKHRhcmdldHMuc2xpY2Uoc3RhcnQsIGVuZCkpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGdldENoaWxkQ291bnRJbnZpdGVkID0gKCk6IG51bWJlciA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0YXRlLmZpbHRlcmVkSW52aXRlZE1lbWJlcnMubGVuZ3RoICsgKHRoaXMuZ2V0UGVuZGluZzNQaWRJbnZpdGVzKCkgfHwgW10pLmxlbmd0aDtcbiAgICB9O1xuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5sb2FkaW5nKSB7XG4gICAgICAgICAgICByZXR1cm4gPEJhc2VDYXJkXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXhfTWVtYmVyTGlzdFwiXG4gICAgICAgICAgICAgICAgb25DbG9zZT17dGhpcy5wcm9wcy5vbkNsb3NlfVxuICAgICAgICAgICAgICAgIHByZXZpb3VzUGhhc2U9e1JpZ2h0UGFuZWxQaGFzZXMuUm9vbVN1bW1hcnl9XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPFNwaW5uZXIgLz5cbiAgICAgICAgICAgIDwvQmFzZUNhcmQ+O1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY2xpID0gTWF0cml4Q2xpZW50UGVnLmdldCgpO1xuICAgICAgICBjb25zdCByb29tID0gY2xpLmdldFJvb20odGhpcy5wcm9wcy5yb29tSWQpO1xuICAgICAgICBsZXQgaW52aXRlQnV0dG9uO1xuXG4gICAgICAgIGlmIChyb29tPy5nZXRNeU1lbWJlcnNoaXAoKSA9PT0gJ2pvaW4nICYmIHNob3VsZFNob3dDb21wb25lbnQoVUlDb21wb25lbnQuSW52aXRlVXNlcnMpKSB7XG4gICAgICAgICAgICBsZXQgaW52aXRlQnV0dG9uVGV4dCA9IF90KFwiSW52aXRlIHRvIHRoaXMgcm9vbVwiKTtcbiAgICAgICAgICAgIGNvbnN0IGNoYXQgPSBDb21tdW5pdHlQcm90b3R5cGVTdG9yZS5pbnN0YW5jZS5nZXRTZWxlY3RlZENvbW11bml0eUdlbmVyYWxDaGF0KCk7XG4gICAgICAgICAgICBpZiAoY2hhdCAmJiBjaGF0LnJvb21JZCA9PT0gdGhpcy5wcm9wcy5yb29tSWQpIHtcbiAgICAgICAgICAgICAgICBpbnZpdGVCdXR0b25UZXh0ID0gX3QoXCJJbnZpdGUgdG8gdGhpcyBjb21tdW5pdHlcIik7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKFNwYWNlU3RvcmUuc3BhY2VzRW5hYmxlZCAmJiByb29tLmlzU3BhY2VSb29tKCkpIHtcbiAgICAgICAgICAgICAgICBpbnZpdGVCdXR0b25UZXh0ID0gX3QoXCJJbnZpdGUgdG8gdGhpcyBzcGFjZVwiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaW52aXRlQnV0dG9uID0gKFxuICAgICAgICAgICAgICAgIDxBY2Nlc3NpYmxlQnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm14X01lbWJlckxpc3RfaW52aXRlXCJcbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5vbkludml0ZUJ1dHRvbkNsaWNrfVxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17IXRoaXMuc3RhdGUuY2FuSW52aXRlfVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPHNwYW4+eyBpbnZpdGVCdXR0b25UZXh0IH08L3NwYW4+XG4gICAgICAgICAgICAgICAgPC9BY2Nlc3NpYmxlQnV0dG9uPlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBpbnZpdGVkSGVhZGVyO1xuICAgICAgICBsZXQgaW52aXRlZFNlY3Rpb247XG4gICAgICAgIGlmICh0aGlzLmdldENoaWxkQ291bnRJbnZpdGVkKCkgPiAwKSB7XG4gICAgICAgICAgICBpbnZpdGVkSGVhZGVyID0gPGgyPnsgX3QoXCJJbnZpdGVkXCIpIH08L2gyPjtcbiAgICAgICAgICAgIGludml0ZWRTZWN0aW9uID0gKFxuICAgICAgICAgICAgICAgIDxUcnVuY2F0ZWRMaXN0XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm14X01lbWJlckxpc3Rfc2VjdGlvbiBteF9NZW1iZXJMaXN0X2ludml0ZWRcIlxuICAgICAgICAgICAgICAgICAgICB0cnVuY2F0ZUF0PXt0aGlzLnN0YXRlLnRydW5jYXRlQXRJbnZpdGVkfVxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVPdmVyZmxvd0VsZW1lbnQ9e3RoaXMuY3JlYXRlT3ZlcmZsb3dUaWxlSW52aXRlZH1cbiAgICAgICAgICAgICAgICAgICAgZ2V0Q2hpbGRyZW49e3RoaXMuZ2V0Q2hpbGRyZW5JbnZpdGVkfVxuICAgICAgICAgICAgICAgICAgICBnZXRDaGlsZENvdW50PXt0aGlzLmdldENoaWxkQ291bnRJbnZpdGVkfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZm9vdGVyID0gKFxuICAgICAgICAgICAgPFNlYXJjaEJveFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm14X01lbWJlckxpc3RfcXVlcnkgbXhfdGV4dGlucHV0X2ljb24gbXhfdGV4dGlucHV0X3NlYXJjaFwiXG4gICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e190KCdGaWx0ZXIgcm9vbSBtZW1iZXJzJyl9XG4gICAgICAgICAgICAgICAgb25TZWFyY2g9e3RoaXMub25TZWFyY2hRdWVyeUNoYW5nZWR9XG4gICAgICAgICAgICAgICAgaW5pdGlhbFZhbHVlPXt0aGlzLnByb3BzLnNlYXJjaFF1ZXJ5fVxuICAgICAgICAgICAgLz5cbiAgICAgICAgKTtcblxuICAgICAgICBsZXQgcHJldmlvdXNQaGFzZSA9IFJpZ2h0UGFuZWxQaGFzZXMuUm9vbVN1bW1hcnk7XG4gICAgICAgIC8vIFdlIGhhdmUgbm8gcHJldmlvdXNQaGFzZSBmb3Igd2hlbiB2aWV3aW5nIGEgTWVtYmVyTGlzdCBmcm9tIGEgU3BhY2VcbiAgICAgICAgbGV0IHNjb3BlSGVhZGVyO1xuICAgICAgICBpZiAoU3BhY2VTdG9yZS5zcGFjZXNFbmFibGVkICYmIHJvb20/LmlzU3BhY2VSb29tKCkpIHtcbiAgICAgICAgICAgIHByZXZpb3VzUGhhc2UgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICBzY29wZUhlYWRlciA9IDxkaXYgY2xhc3NOYW1lPVwibXhfUmlnaHRQYW5lbF9zY29wZUhlYWRlclwiPlxuICAgICAgICAgICAgICAgIDxSb29tQXZhdGFyIHJvb209e3Jvb219IGhlaWdodD17MzJ9IHdpZHRoPXszMn0gLz5cbiAgICAgICAgICAgICAgICA8Um9vbU5hbWUgcm9vbT17cm9vbX0gLz5cbiAgICAgICAgICAgIDwvZGl2PjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiA8QmFzZUNhcmRcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cIm14X01lbWJlckxpc3RcIlxuICAgICAgICAgICAgaGVhZGVyPXs8UmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICAgICAgICAgeyBzY29wZUhlYWRlciB9XG4gICAgICAgICAgICAgICAgeyBpbnZpdGVCdXR0b24gfVxuICAgICAgICAgICAgPC9SZWFjdC5GcmFnbWVudD59XG4gICAgICAgICAgICBmb290ZXI9e2Zvb3Rlcn1cbiAgICAgICAgICAgIG9uQ2xvc2U9e3RoaXMucHJvcHMub25DbG9zZX1cbiAgICAgICAgICAgIHByZXZpb3VzUGhhc2U9e3ByZXZpb3VzUGhhc2V9XG4gICAgICAgID5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfTWVtYmVyTGlzdF93cmFwcGVyXCI+XG4gICAgICAgICAgICAgICAgPFRydW5jYXRlZExpc3RcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXhfTWVtYmVyTGlzdF9zZWN0aW9uIG14X01lbWJlckxpc3Rfam9pbmVkXCJcbiAgICAgICAgICAgICAgICAgICAgdHJ1bmNhdGVBdD17dGhpcy5zdGF0ZS50cnVuY2F0ZUF0Sm9pbmVkfVxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVPdmVyZmxvd0VsZW1lbnQ9e3RoaXMuY3JlYXRlT3ZlcmZsb3dUaWxlSm9pbmVkfVxuICAgICAgICAgICAgICAgICAgICBnZXRDaGlsZHJlbj17dGhpcy5nZXRDaGlsZHJlbkpvaW5lZH1cbiAgICAgICAgICAgICAgICAgICAgZ2V0Q2hpbGRDb3VudD17dGhpcy5nZXRDaGlsZENvdW50Sm9pbmVkfSAvPlxuICAgICAgICAgICAgICAgIHsgaW52aXRlZEhlYWRlciB9XG4gICAgICAgICAgICAgICAgeyBpbnZpdGVkU2VjdGlvbiB9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9CYXNlQ2FyZD47XG4gICAgfVxuXG4gICAgb25JbnZpdGVCdXR0b25DbGljayA9ICgpOiB2b2lkID0+IHtcbiAgICAgICAgaWYgKE1hdHJpeENsaWVudFBlZy5nZXQoKS5pc0d1ZXN0KCkpIHtcbiAgICAgICAgICAgIGRpcy5kaXNwYXRjaCh7IGFjdGlvbjogJ3JlcXVpcmVfcmVnaXN0cmF0aW9uJyB9KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGNhbGwgQWRkcmVzc1BpY2tlckRpYWxvZ1xuICAgICAgICBkaXMuZGlzcGF0Y2goe1xuICAgICAgICAgICAgYWN0aW9uOiAndmlld19pbnZpdGUnLFxuICAgICAgICAgICAgcm9vbUlkOiB0aGlzLnByb3BzLnJvb21JZCxcbiAgICAgICAgfSk7XG4gICAgfTtcbn1cbiJdfQ==