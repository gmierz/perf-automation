"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireDefault(require("react"));

var _classnames = _interopRequireDefault(require("classnames"));

var _languageHandler = require("../../../languageHandler");

var _replaceableComponent = require("../../../utils/replaceableComponent");

var _Media = require("../../../customisations/Media");

var _BaseAvatar = _interopRequireDefault(require("../avatars/BaseAvatar"));

var _iconEmailUser = _interopRequireDefault(require("../../../../res/img/icon-email-user.svg"));

var _dec, _class, _class2, _temp;

let AddressTile = (_dec = (0, _replaceableComponent.replaceableComponent)("views.elements.AddressTile"), _dec(_class = (_temp = _class2 = class AddressTile extends _react.default.Component {
  render() {
    const address = this.props.address;
    const name = address.displayName || address.address;
    const imgUrls = [];
    const isMatrixAddress = ['mx-user-id', 'mx-room-id'].includes(address.addressType);

    if (isMatrixAddress && address.avatarMxc) {
      imgUrls.push((0, _Media.mediaFromMxc)(address.avatarMxc).getSquareThumbnailHttp(25));
    } else if (address.addressType === 'email') {
      imgUrls.push(_iconEmailUser.default);
    }

    const nameClasses = (0, _classnames.default)({
      "mx_AddressTile_name": true,
      "mx_AddressTile_justified": this.props.justified
    });
    let info;
    let error = false;

    if (isMatrixAddress && address.isKnown) {
      const idClasses = (0, _classnames.default)({
        "mx_AddressTile_id": true,
        "mx_AddressTile_justified": this.props.justified
      });
      info = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_AddressTile_mx"
      }, /*#__PURE__*/_react.default.createElement("div", {
        className: nameClasses
      }, name), this.props.showAddress ? /*#__PURE__*/_react.default.createElement("div", {
        className: idClasses
      }, address.address) : /*#__PURE__*/_react.default.createElement("div", null));
    } else if (isMatrixAddress) {
      const unknownMxClasses = (0, _classnames.default)({
        "mx_AddressTile_unknownMx": true,
        "mx_AddressTile_justified": this.props.justified
      });
      info = /*#__PURE__*/_react.default.createElement("div", {
        className: unknownMxClasses
      }, this.props.address.address);
    } else if (address.addressType === "email") {
      const emailClasses = (0, _classnames.default)({
        "mx_AddressTile_email": true,
        "mx_AddressTile_justified": this.props.justified
      });
      let nameNode = null;

      if (address.displayName) {
        nameNode = /*#__PURE__*/_react.default.createElement("div", {
          className: nameClasses
        }, address.displayName);
      }

      info = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_AddressTile_mx"
      }, /*#__PURE__*/_react.default.createElement("div", {
        className: emailClasses
      }, address.address), nameNode);
    } else {
      error = true;
      const unknownClasses = (0, _classnames.default)({
        "mx_AddressTile_unknown": true,
        "mx_AddressTile_justified": this.props.justified
      });
      info = /*#__PURE__*/_react.default.createElement("div", {
        className: unknownClasses
      }, (0, _languageHandler._t)("Unknown Address"));
    }

    const classes = (0, _classnames.default)({
      "mx_AddressTile": true,
      "mx_AddressTile_error": error
    });
    let dismiss;

    if (this.props.canDismiss) {
      dismiss = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_AddressTile_dismiss",
        onClick: this.props.onDismissed
      }, /*#__PURE__*/_react.default.createElement("img", {
        src: require("../../../../res/img/icon-address-delete.svg"),
        width: "9",
        height: "9"
      }));
    }

    return /*#__PURE__*/_react.default.createElement("div", {
      className: classes
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_AddressTile_avatar"
    }, /*#__PURE__*/_react.default.createElement(_BaseAvatar.default, {
      defaultToInitialLetter: true,
      width: 25,
      height: 25,
      name: name,
      title: name,
      urls: imgUrls
    })), info, dismiss);
  }

}, (0, _defineProperty2.default)(_class2, "defaultProps", {
  canDismiss: false,
  onDismissed: function () {},
  // NOP
  justified: false
}), _temp)) || _class);
exports.default = AddressTile;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZpZXdzL2VsZW1lbnRzL0FkZHJlc3NUaWxlLnRzeCJdLCJuYW1lcyI6WyJBZGRyZXNzVGlsZSIsIlJlYWN0IiwiQ29tcG9uZW50IiwicmVuZGVyIiwiYWRkcmVzcyIsInByb3BzIiwibmFtZSIsImRpc3BsYXlOYW1lIiwiaW1nVXJscyIsImlzTWF0cml4QWRkcmVzcyIsImluY2x1ZGVzIiwiYWRkcmVzc1R5cGUiLCJhdmF0YXJNeGMiLCJwdXNoIiwiZ2V0U3F1YXJlVGh1bWJuYWlsSHR0cCIsIkVtYWlsVXNlckljb24iLCJuYW1lQ2xhc3NlcyIsImp1c3RpZmllZCIsImluZm8iLCJlcnJvciIsImlzS25vd24iLCJpZENsYXNzZXMiLCJzaG93QWRkcmVzcyIsInVua25vd25NeENsYXNzZXMiLCJlbWFpbENsYXNzZXMiLCJuYW1lTm9kZSIsInVua25vd25DbGFzc2VzIiwiY2xhc3NlcyIsImRpc21pc3MiLCJjYW5EaXNtaXNzIiwib25EaXNtaXNzZWQiLCJyZXF1aXJlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQWlCQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFDQTs7OztJQVdxQkEsVyxXQURwQixnREFBcUIsNEJBQXJCLEMsbUNBQUQsTUFDcUJBLFdBRHJCLFNBQ3lDQyxlQUFNQyxTQUQvQyxDQUNpRTtBQU83REMsRUFBQUEsTUFBTSxHQUFHO0FBQ0wsVUFBTUMsT0FBTyxHQUFHLEtBQUtDLEtBQUwsQ0FBV0QsT0FBM0I7QUFDQSxVQUFNRSxJQUFJLEdBQUdGLE9BQU8sQ0FBQ0csV0FBUixJQUF1QkgsT0FBTyxDQUFDQSxPQUE1QztBQUVBLFVBQU1JLE9BQU8sR0FBRyxFQUFoQjtBQUNBLFVBQU1DLGVBQWUsR0FBRyxDQUFDLFlBQUQsRUFBZSxZQUFmLEVBQTZCQyxRQUE3QixDQUFzQ04sT0FBTyxDQUFDTyxXQUE5QyxDQUF4Qjs7QUFFQSxRQUFJRixlQUFlLElBQUlMLE9BQU8sQ0FB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LEdBQUcsRUFBRUMsT0FBTyxDQUFDLDZDQUFELENBQWpCO0FBQWtFLFFBQUEsS0FBSyxFQUFDLEdBQXhFO0FBQTRFLFFBQUEsTUFBTSxFQUFDO0FBQW5GLFFBREosQ0FESjtBQUtIOztBQUVELHdCQUNJO0FBQUssTUFBQSxTQUFTLEVBQUVKO0FBQWhCLG9CQUNJO0FBQUssTUFBQSxTQUFTLEVBQUM7QUFBZixvQkFDSSw2QkFBQyxtQkFBRDtBQUFZLE1BQUEsc0JBQXNCLEVBQUUsSUFBcEM7QUFBMEMsTUFBQSxLQUFLLEVBQUUsRUFBakQ7QUFBcUQsTUFBQSxNQUFNLEVBQUUsRUFBN0Q7QUFBaUUsTUFBQSxJQUFJLEVBQUVyQixJQUF2RTtBQUE2RSxNQUFBLEtBQUssRUFBRUEsSUFBcEY7QUFBMEYsTUFBQSxJQUFJLEVBQUVFO0FBQWhHLE1BREosQ0FESixFQUlNVSxJQUpOLEVBS01VLE9BTE4sQ0FESjtBQVNIOztBQXhHNEQsQyx5REFDdEI7QUFDbkNDLEVBQUFBLFVBQVUsRUFBRSxLQUR1QjtBQUVuQ0MsRUFBQUEsV0FBVyxFQUFFLFlBQVcsQ0FBRSxDQUZTO0FBRVA7QUFDNUJiLEVBQUFBLFNBQVMsRUFBRTtBQUh3QixDIiwic291cmNlc0NvbnRlbnQiOlsiLypcbkNvcHlyaWdodCAyMDE1LCAyMDE2IE9wZW5NYXJrZXQgTHRkXG5Db3B5cmlnaHQgMjAxNyBOZXcgVmVjdG9yIEx0ZFxuXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xueW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG5cbiAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcblxuVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG5TZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG5saW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiovXG5cbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgY2xhc3NOYW1lcyBmcm9tICdjbGFzc25hbWVzJztcbmltcG9ydCB7IF90IH0gZnJvbSAnLi4vLi4vLi4vbGFuZ3VhZ2VIYW5kbGVyJztcbmltcG9ydCB7IHJlcGxhY2VhYmxlQ29tcG9uZW50IH0gZnJvbSBcIi4uLy4uLy4uL3V0aWxzL3JlcGxhY2VhYmxlQ29tcG9uZW50XCI7XG5pbXBvcnQgeyBtZWRpYUZyb21NeGMgfSBmcm9tIFwiLi4vLi4vLi4vY3VzdG9taXNhdGlvbnMvTWVkaWFcIjtcbmltcG9ydCB7IElVc2VyQWRkcmVzcyB9IGZyb20gJy4uLy4uLy4uL1VzZXJBZGRyZXNzJztcbmltcG9ydCBCYXNlQXZhdGFyIGZyb20gJy4uL2F2YXRhcnMvQmFzZUF2YXRhcic7XG5pbXBvcnQgRW1haWxVc2VySWNvbiBmcm9tIFwiLi4vLi4vLi4vLi4vcmVzL2ltZy9pY29uLWVtYWlsLXVzZXIuc3ZnXCI7XG5cbmludGVyZmFjZSBJUHJvcHMge1xuICAgIGFkZHJlc3M6IElVc2VyQWRkcmVzcztcbiAgICBjYW5EaXNtaXNzPzogYm9vbGVhbjtcbiAgICBvbkRpc21pc3NlZD86ICgpID0+IHZvaWQ7XG4gICAganVzdGlmaWVkPzogYm9vbGVhbjtcbiAgICBzaG93QWRkcmVzcz86IGJvb2xlYW47XG59XG5cbkByZXBsYWNlYWJsZUNvbXBvbmVudChcInZpZXdzLmVsZW1lbnRzLkFkZHJlc3NUaWxlXCIpXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBZGRyZXNzVGlsZSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxJUHJvcHM+IHtcbiAgICBzdGF0aWMgZGVmYXVsdFByb3BzOiBQYXJ0aWFsPElQcm9wcz4gPSB7XG4gICAgICAgIGNhbkRpc21pc3M6IGZhbHNlLFxuICAgICAgICBvbkRpc21pc3NlZDogZnVuY3Rpb24oKSB7fSwgLy8gTk9QXG4gICAgICAgIGp1c3RpZmllZDogZmFsc2UsXG4gICAgfTtcblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgYWRkcmVzcyA9IHRoaXMucHJvcHMuYWRkcmVzcztcbiAgICAgICAgY29uc3QgbmFtZSA9IGFkZHJlc3MuZGlzcGxheU5hbWUgfHwgYWRkcmVzcy5hZGRyZXNzO1xuXG4gICAgICAgIGNvbnN0IGltZ1VybHMgPSBbXTtcbiAgICAgICAgY29uc3QgaXNNYXRyaXhBZGRyZXNzID0gWydteC11c2VyLWlkJywgJ214LXJvb20taWQnXS5pbmNsdWRlcyhhZGRyZXNzLmFkZHJlc3NUeXBlKTtcblxuICAgICAgICBpZiAoaXNNYXRyaXhBZGRyZXNzICYmIGFkZHJlc3MuYXZhdGFyTXhjKSB7XG4gICAgICAgICAgICBpbWdVcmxzLnB1c2gobWVkaWFGcm9tTXhjKGFkZHJlc3MuYXZhdGFyTXhjKS5nZXRTcXVhcmVUaHVtYm5haWxIdHRwKDI1KSk7XG4gICAgICAgIH0gZWxzZSBpZiAoYWRkcmVzcy5hZGRyZXNzVHlwZSA9PT0gJ2VtYWlsJykge1xuICAgICAgICAgICAgaW1nVXJscy5wdXNoKEVtYWlsVXNlckljb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbmFtZUNsYXNzZXMgPSBjbGFzc05hbWVzKHtcbiAgICAgICAgICAgIFwibXhfQWRkcmVzc1RpbGVfbmFtZVwiOiB0cnVlLFxuICAgICAgICAgICAgXCJteF9BZGRyZXNzVGlsZV9qdXN0aWZpZWRcIjogdGhpcy5wcm9wcy5qdXN0aWZpZWQsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGxldCBpbmZvO1xuICAgICAgICBsZXQgZXJyb3IgPSBmYWxzZTtcbiAgICAgICAgaWYgKGlzTWF0cml4QWRkcmVzcyAmJiBhZGRyZXNzLmlzS25vd24pIHtcbiAgICAgICAgICAgIGNvbnN0IGlkQ2xhc3NlcyA9IGNsYXNzTmFtZXMoe1xuICAgICAgICAgICAgICAgIFwibXhfQWRkcmVzc1RpbGVfaWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcIm14X0FkZHJlc3NUaWxlX2p1c3RpZmllZFwiOiB0aGlzLnByb3BzLmp1c3RpZmllZCxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpbmZvID0gKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfQWRkcmVzc1RpbGVfbXhcIj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e25hbWVDbGFzc2VzfT57IG5hbWUgfTwvZGl2PlxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLnNob3dBZGRyZXNzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyA8ZGl2IGNsYXNzTmFtZT17aWRDbGFzc2VzfT57IGFkZHJlc3MuYWRkcmVzcyB9PC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiA8ZGl2IC8+XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNNYXRyaXhBZGRyZXNzKSB7XG4gICAgICAgICAgICBjb25zdCB1bmtub3duTXhDbGFzc2VzID0gY2xhc3NOYW1lcyh7XG4gICAgICAgICAgICAgICAgXCJteF9BZGRyZXNzVGlsZV91bmtub3duTXhcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcIm14X0FkZHJlc3NUaWxlX2p1c3RpZmllZFwiOiB0aGlzLnByb3BzLmp1c3RpZmllZCxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpbmZvID0gKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXt1bmtub3duTXhDbGFzc2VzfT57IHRoaXMucHJvcHMuYWRkcmVzcy5hZGRyZXNzIH08L2Rpdj5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSBpZiAoYWRkcmVzcy5hZGRyZXNzVHlwZSA9PT0gXCJlbWFpbFwiKSB7XG4gICAgICAgICAgICBjb25zdCBlbWFpbENsYXNzZXMgPSBjbGFzc05hbWVzKHtcbiAgICAgICAgICAgICAgICBcIm14X0FkZHJlc3NUaWxlX2VtYWlsXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgXCJteF9BZGRyZXNzVGlsZV9qdXN0aWZpZWRcIjogdGhpcy5wcm9wcy5qdXN0aWZpZWQsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgbGV0IG5hbWVOb2RlID0gbnVsbDtcbiAgICAgICAgICAgIGlmIChhZGRyZXNzLmRpc3BsYXlOYW1lKSB7XG4gICAgICAgICAgICAgICAgbmFtZU5vZGUgPSA8ZGl2IGNsYXNzTmFtZT17bmFtZUNsYXNzZXN9PnsgYWRkcmVzcy5kaXNwbGF5TmFtZSB9PC9kaXY+O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpbmZvID0gKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfQWRkcmVzc1RpbGVfbXhcIj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2VtYWlsQ2xhc3Nlc30+eyBhZGRyZXNzLmFkZHJlc3MgfTwvZGl2PlxuICAgICAgICAgICAgICAgICAgICB7IG5hbWVOb2RlIH1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlcnJvciA9IHRydWU7XG4gICAgICAgICAgICBjb25zdCB1bmtub3duQ2xhc3NlcyA9IGNsYXNzTmFtZXMoe1xuICAgICAgICAgICAgICAgIFwibXhfQWRkcmVzc1RpbGVfdW5rbm93blwiOiB0cnVlLFxuICAgICAgICAgICAgICAgIFwibXhfQWRkcmVzc1RpbGVfanVzdGlmaWVkXCI6IHRoaXMucHJvcHMuanVzdGlmaWVkLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGluZm8gPSAoXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e3Vua25vd25DbGFzc2VzfT57IF90KFwiVW5rbm93biBBZGRyZXNzXCIpIH08L2Rpdj5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjbGFzc2VzID0gY2xhc3NOYW1lcyh7XG4gICAgICAgICAgICBcIm14X0FkZHJlc3NUaWxlXCI6IHRydWUsXG4gICAgICAgICAgICBcIm14X0FkZHJlc3NUaWxlX2Vycm9yXCI6IGVycm9yLFxuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgZGlzbWlzcztcbiAgICAgICAgaWYgKHRoaXMucHJvcHMuY2FuRGlzbWlzcykge1xuICAgICAgICAgICAgZGlzbWlzcyA9IChcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X0FkZHJlc3NUaWxlX2Rpc21pc3NcIiBvbkNsaWNrPXt0aGlzLnByb3BzLm9uRGlzbWlzc2VkfT5cbiAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9e3JlcXVpcmUoXCIuLi8uLi8uLi8uLi9yZXMvaW1nL2ljb24tYWRkcmVzcy1kZWxldGUuc3ZnXCIpfSB3aWR0aD1cIjlcIiBoZWlnaHQ9XCI5XCIgLz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2NsYXNzZXN9PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfQWRkcmVzc1RpbGVfYXZhdGFyXCI+XG4gICAgICAgICAgICAgICAgICAgIDxCYXNlQXZhdGFyIGRlZmF1bHRUb0luaXRpYWxMZXR0ZXI9e3RydWV9IHdpZHRoPXsyNX0gaGVpZ2h0PXsyNX0gbmFtZT17bmFtZX0gdGl0bGU9e25hbWV9IHVybHM9e2ltZ1VybHN9IC8+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgeyBpbmZvIH1cbiAgICAgICAgICAgICAgICB7IGRpc21pc3MgfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICk7XG4gICAgfVxufVxuIl19