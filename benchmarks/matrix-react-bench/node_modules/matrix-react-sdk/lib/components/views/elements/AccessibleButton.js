"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = AccessibleButton;

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _react = _interopRequireDefault(require("react"));

var _Keyboard = require("../../../Keyboard");

var _classnames = _interopRequireDefault(require("classnames"));

const _excluded = ["element", "onClick", "children", "kind", "disabled", "inputRef", "className", "onKeyDown", "onKeyUp"];

/**
 * AccessibleButton is a generic wrapper for any element that should be treated
 * as a button.  Identifies the element as a button, setting proper tab
 * indexing and keyboard activation behavior.
 *
 * @param {Object} props  react element properties
 * @returns {Object} rendered react
 */
function AccessibleButton(_ref) {
  let {
    element,
    onClick,
    children,
    kind,
    disabled,
    inputRef,
    className,
    onKeyDown,
    onKeyUp
  } = _ref,
      restProps = (0, _objectWithoutProperties2.default)(_ref, _excluded);
  const newProps = restProps;

  if (disabled) {
    newProps["aria-disabled"] = true;
  } else {
    newProps.onClick = onClick; // We need to consume enter onKeyDown and space onKeyUp
    // otherwise we are risking also activating other keyboard focusable elements
    // that might receive focus as a result of the AccessibleButtonClick action
    // It's because we are using html buttons at a few places e.g. inside dialogs
    // And divs which we report as role button to assistive technologies.
    // Browsers handle space and enter keypresses differently and we are only adjusting to the
    // inconsistencies here

    newProps.onKeyDown = e => {
      if (e.key === _Keyboard.Key.ENTER) {
        e.stopPropagation();
        e.preventDefault();
        return onClick(e);
      }

      if (e.key === _Keyboard.Key.SPACE) {
        e.stopPropagation();
        e.preventDefault();
      } else {
        onKeyDown === null || onKeyDown === void 0 ? void 0 : onKeyDown(e);
      }
    };

    newProps.onKeyUp = e => {
      if (e.key === _Keyboard.Key.SPACE) {
        e.stopPropagation();
        e.preventDefault();
        return onClick(e);
      }

      if (e.key === _Keyboard.Key.ENTER) {
        e.stopPropagation();
        e.preventDefault();
      } else {
        onKeyUp === null || onKeyUp === void 0 ? void 0 : onKeyUp(e);
      }
    };
  } // Pass through the ref - used for keyboard shortcut access to some buttons


  newProps.ref = inputRef;
  newProps.className = (0, _classnames.default)("mx_AccessibleButton", className, {
    "mx_AccessibleButton_hasKind": kind,
    [`mx_AccessibleButton_kind_${kind}`]: kind,
    "mx_AccessibleButton_disabled": disabled
  }); // React.createElement expects InputHTMLAttributes

  return /*#__PURE__*/_react.default.createElement(element, newProps, children);
}

AccessibleButton.defaultProps = {
  element: 'div',
  role: 'button',
  tabIndex: 0
};
AccessibleButton.displayName = "AccessibleButton";
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZpZXdzL2VsZW1lbnRzL0FjY2Vzc2libGVCdXR0b24udHN4Il0sIm5hbWVzIjpbIkFjY2Vzc2libGVCdXR0b24iLCJlbGVtZW50Iiwib25DbGljayIsImNoaWxkcmVuIiwia2luZCIsImRpc2FibGVkIiwiaW5wdXRSZWYiLCJjbGFzc05hbWUiLCJvbktleURvd24iLCJvbktleVVwIiwicmVzdFByb3BzIiwibmV3UHJvcHMiLCJlIiwia2V5IiwiS2V5IiwiRU5URVIiLCJzdG9wUHJvcGFnYXRpb24iLCJwcmV2ZW50RGVmYXVsdCIsIlNQQUNFIiwicmVmIiwiUmVhY3QiLCJjcmVhdGVFbGVtZW50IiwiZGVmYXVsdFByb3BzIiwicm9sZSIsInRhYkluZGV4IiwiZGlzcGxheU5hbWUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBZ0JBOztBQUVBOztBQUNBOzs7O0FBNkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDZSxTQUFTQSxnQkFBVCxPQVdKO0FBQUEsTUFYOEI7QUFDckNDLElBQUFBLE9BRHFDO0FBRXJDQyxJQUFBQSxPQUZxQztBQUdyQ0MsSUFBQUEsUUFIcUM7QUFJckNDLElBQUFBLElBSnFDO0FBS3JDQyxJQUFBQSxRQUxxQztBQU1yQ0MsSUFBQUEsUUFOcUM7QUFPckNDLElBQUFBLFNBUHFDO0FBUXJDQyxJQUFBQSxTQVJxQztBQVNyQ0MsSUFBQUE7QUFUcUMsR0FXOUI7QUFBQSxNQURKQyxTQUNJO0FBQ1AsUUFBTUMsUUFBZ0MsR0FBR0QsU0FBekM7O0FBQ0EsTUFBSUwsUUFBSixFQUFjO0FBQ1ZNLElBQUFBLFFBQVEsQ0FBQyxlQUFELENBQVIsR0FBNEIsSUFBNUI7QUFDSCxHQUZELE1BRU87QUFDSEEsSUFBQUEsUUFBUSxDQUFDVCxPQUFULEdBQW1CQSxPQUFuQixDQURHLENBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0FTLElBQUFBLFFBQVEsQ0FBQ0gsU0FBVCxHQUFzQkksQ0FBRCxJQUFPO0FBQ3hCLFVBQUlBLENBQUMsQ0FBQ0MsR0FBRixLQUFVQyxjQUFJQyxLQUFsQixFQUF5QjtBQUNyQkgsUUFBQUEsQ0FBQyxDQUFDSSxlQUFGO0FBQ0FKLFFBQUFBLENBQUMsQ0FBQ0ssY0FBRjtBQUNBLGVBQU9mLE9BQU8sQ0FBQ1UsQ0FBRCxDQUFkO0FBQ0g7O0FBQ0QsVUFBSUEsQ0FBQyxDQUFDQyxHQUFGLEtBQVVDLGNBQUlJLEtBQWxCLEVBQXlCO0FBQ3JCTixRQUFBQSxDQUFDLENBQUNJLGVBQUY7QUFDQUosUUFBQUEsQ0FBQyxDQUFDSyxjQUFGO0FBQ0gsT0FIRCxNQUdPO0FBQ0hULFFBQUFBLFNBQVMsU0FBVCxJQUFBQSxTQUFTLFdBQVQsWUFBQUEsU0FBUyxDQUFHSSxDQUFILENBQVQ7QUFDSDtBQUNKLEtBWkQ7O0FBYUFELElBQUFBLFFBQVEsQ0FBQ0YsT0FBVCxHQUFvQkcsQ0FBRCxJQUFPO0FBQ3RCLFVBQUlBLENBQUMsQ0FBQ0MsR0FBRixLQUFVQyxjQUFJSSxLQUFsQixFQUF5QjtBQUNyQk4sUUFBQUEsQ0FBQyxDQUFDSSxlQUFGO0FBQ0FKLFFBQUFBLENBQUMsQ0FBQ0ssY0FBRjtBQUNBLGVBQU9mLE9BQU8sQ0FBQ1UsQ0FBRCxDQUFkO0FBQ0g7O0FBQ0QsVUFBSUEsQ0FBQyxDQUFDQyxHQUFGLEtBQVVDLGNBQUlDLEtBQWxCLEVBQXlCO0FBQ3JCSCxRQUFBQSxDQUFDLENBQUNJLGVBQUY7QUFDQUosUUFBQUEsQ0FBQyxDQUFDSyxjQUFGO0FBQ0gsT0FIRCxNQUdPO0FBQ0hSLFFBQUFBLE9BQU8sU0FBUCxJQUFBQSxPQUFPLFdBQVAsWUFBQUEsT0FBTyxDQUFHRyxDQUFILENBQVA7QUFDSDtBQUNKLEtBWkQ7QUFhSCxHQXZDTSxDQXlDUDs7O0FBQ0FELEVBQUFBLFFBQVEsQ0FBQ1EsR0FBVCxHQUFlYixRQUFmO0FBRUFLLEVBQUFBLFFBQVEsQ0FBQ0osU0FBVCxHQUFxQix5QkFDakIscUJBRGlCLEVBRWpCQSxTQUZpQixFQUdqQjtBQUNJLG1DQUErQkgsSUFEbkM7QUFFSSxLQUFFLDRCQUEyQkEsSUFBSyxFQUFsQyxHQUFzQ0EsSUFGMUM7QUFHSSxvQ0FBZ0NDO0FBSHBDLEdBSGlCLENBQXJCLENBNUNPLENBc0RQOztBQUNBLHNCQUFPZSxlQUFNQyxhQUFOLENBQW9CcEIsT0FBcEIsRUFBNkJVLFFBQTdCLEVBQXVDUixRQUF2QyxDQUFQO0FBQ0g7O0FBRURILGdCQUFnQixDQUFDc0IsWUFBakIsR0FBZ0M7QUFDNUJyQixFQUFBQSxPQUFPLEVBQUUsS0FEbUI7QUFFNUJzQixFQUFBQSxJQUFJLEVBQUUsUUFGc0I7QUFHNUJDLEVBQUFBLFFBQVEsRUFBRTtBQUhrQixDQUFoQztBQU1BeEIsZ0JBQWdCLENBQUN5QixXQUFqQixHQUErQixrQkFBL0IiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuIENvcHlyaWdodCAyMDE2IEphbmkgTXVzdG9uZW5cblxuIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuXG4gaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cbiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgUmVhY3QsIHsgUmVhY3RIVE1MIH0gZnJvbSAncmVhY3QnO1xuXG5pbXBvcnQgeyBLZXkgfSBmcm9tICcuLi8uLi8uLi9LZXlib2FyZCc7XG5pbXBvcnQgY2xhc3NuYW1lcyBmcm9tICdjbGFzc25hbWVzJztcblxuZXhwb3J0IHR5cGUgQnV0dG9uRXZlbnQgPSBSZWFjdC5Nb3VzZUV2ZW50PEVsZW1lbnQ+IHwgUmVhY3QuS2V5Ym9hcmRFdmVudDxFbGVtZW50PiB8IFJlYWN0LkZvcm1FdmVudDxFbGVtZW50PjtcblxuLyoqXG4gKiBjaGlsZHJlbjogUmVhY3QncyBtYWdpYyBwcm9wLiBSZXByZXNlbnRzIGFsbCBjaGlsZHJlbiBnaXZlbiB0byB0aGUgZWxlbWVudC5cbiAqIGVsZW1lbnQ6ICAob3B0aW9uYWwpIFRoZSBiYXNlIGVsZW1lbnQgdHlwZS4gXCJkaXZcIiBieSBkZWZhdWx0LlxuICogb25DbGljazogIChyZXF1aXJlZCkgRXZlbnQgaGFuZGxlciBmb3IgYnV0dG9uIGFjdGl2YXRpb24uIFNob3VsZCBiZVxuICogICAgICAgICAgIGltcGxlbWVudGVkIGV4YWN0bHkgbGlrZSBhIG5vcm1hbCBvbkNsaWNrIGhhbmRsZXIuXG4gKi9cbmludGVyZmFjZSBJUHJvcHMgZXh0ZW5kcyBSZWFjdC5JbnB1dEhUTUxBdHRyaWJ1dGVzPEVsZW1lbnQ+IHtcbiAgICBpbnB1dFJlZj86IFJlYWN0LlJlZjxFbGVtZW50PjtcbiAgICBlbGVtZW50Pzoga2V5b2YgUmVhY3RIVE1MO1xuICAgIC8vIFRoZSBraW5kIG9mIGJ1dHRvbiwgc2ltaWxhciB0byBob3cgQm9vdHN0cmFwIHdvcmtzLlxuICAgIC8vIFNlZSBhdmFpbGFibGUgY2xhc3NlcyBmb3IgQWNjZXNzaWJsZUJ1dHRvbiBmb3Igb3B0aW9ucy5cbiAgICBraW5kPzogc3RyaW5nO1xuICAgIC8vIFRoZSBBUklBIHJvbGVcbiAgICByb2xlPzogc3RyaW5nO1xuICAgIC8vIFRoZSB0YWJJbmRleFxuICAgIHRhYkluZGV4PzogbnVtYmVyO1xuICAgIGRpc2FibGVkPzogYm9vbGVhbjtcbiAgICBjbGFzc05hbWU/OiBzdHJpbmc7XG4gICAgb25DbGljayhlPzogQnV0dG9uRXZlbnQpOiB2b2lkIHwgUHJvbWlzZTx2b2lkPjtcbn1cblxuaW50ZXJmYWNlIElBY2Nlc3NpYmxlQnV0dG9uUHJvcHMgZXh0ZW5kcyBSZWFjdC5JbnB1dEhUTUxBdHRyaWJ1dGVzPEVsZW1lbnQ+IHtcbiAgICByZWY/OiBSZWFjdC5SZWY8RWxlbWVudD47XG59XG5cbi8qKlxuICogQWNjZXNzaWJsZUJ1dHRvbiBpcyBhIGdlbmVyaWMgd3JhcHBlciBmb3IgYW55IGVsZW1lbnQgdGhhdCBzaG91bGQgYmUgdHJlYXRlZFxuICogYXMgYSBidXR0b24uICBJZGVudGlmaWVzIHRoZSBlbGVtZW50IGFzIGEgYnV0dG9uLCBzZXR0aW5nIHByb3BlciB0YWJcbiAqIGluZGV4aW5nIGFuZCBrZXlib2FyZCBhY3RpdmF0aW9uIGJlaGF2aW9yLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBwcm9wcyAgcmVhY3QgZWxlbWVudCBwcm9wZXJ0aWVzXG4gKiBAcmV0dXJucyB7T2JqZWN0fSByZW5kZXJlZCByZWFjdFxuICovXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBBY2Nlc3NpYmxlQnV0dG9uKHtcbiAgICBlbGVtZW50LFxuICAgIG9uQ2xpY2ssXG4gICAgY2hpbGRyZW4sXG4gICAga2luZCxcbiAgICBkaXNhYmxlZCxcbiAgICBpbnB1dFJlZixcbiAgICBjbGFzc05hbWUsXG4gICAgb25LZXlEb3duLFxuICAgIG9uS2V5VXAsXG4gICAgLi4ucmVzdFByb3BzXG59OiBJUHJvcHMpIHtcbiAgICBjb25zdCBuZXdQcm9wczogSUFjY2Vzc2libGVCdXR0b25Qcm9wcyA9IHJlc3RQcm9wcztcbiAgICBpZiAoZGlzYWJsZWQpIHtcbiAgICAgICAgbmV3UHJvcHNbXCJhcmlhLWRpc2FibGVkXCJdID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBuZXdQcm9wcy5vbkNsaWNrID0gb25DbGljaztcbiAgICAgICAgLy8gV2UgbmVlZCB0byBjb25zdW1lIGVudGVyIG9uS2V5RG93biBhbmQgc3BhY2Ugb25LZXlVcFxuICAgICAgICAvLyBvdGhlcndpc2Ugd2UgYXJlIHJpc2tpbmcgYWxzbyBhY3RpdmF0aW5nIG90aGVyIGtleWJvYXJkIGZvY3VzYWJsZSBlbGVtZW50c1xuICAgICAgICAvLyB0aGF0IG1pZ2h0IHJlY2VpdmUgZm9jdXMgYXMgYSByZXN1bHQgb2YgdGhlIEFjY2Vzc2libGVCdXR0b25DbGljayBhY3Rpb25cbiAgICAgICAgLy8gSXQncyBiZWNhdXNlIHdlIGFyZSB1c2luZyBodG1sIGJ1dHRvbnMgYXQgYSBmZXcgcGxhY2VzIGUuZy4gaW5zaWRlIGRpYWxvZ3NcbiAgICAgICAgLy8gQW5kIGRpdnMgd2hpY2ggd2UgcmVwb3J0IGFzIHJvbGUgYnV0dG9uIHRvIGFzc2lzdGl2ZSB0ZWNobm9sb2dpZXMuXG4gICAgICAgIC8vIEJyb3dzZXJzIGhhbmRsZSBzcGFjZSBhbmQgZW50ZXIga2V5cHJlc3NlcyBkaWZmZXJlbnRseSBhbmQgd2UgYXJlIG9ubHkgYWRqdXN0aW5nIHRvIHRoZVxuICAgICAgICAvLyBpbmNvbnNpc3RlbmNpZXMgaGVyZVxuICAgICAgICBuZXdQcm9wcy5vbktleURvd24gPSAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKGUua2V5ID09PSBLZXkuRU5URVIpIHtcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gb25DbGljayhlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlLmtleSA9PT0gS2V5LlNQQUNFKSB7XG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG9uS2V5RG93bj8uKGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBuZXdQcm9wcy5vbktleVVwID0gKGUpID0+IHtcbiAgICAgICAgICAgIGlmIChlLmtleSA9PT0gS2V5LlNQQUNFKSB7XG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9uQ2xpY2soZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZS5rZXkgPT09IEtleS5FTlRFUikge1xuICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBvbktleVVwPy4oZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gUGFzcyB0aHJvdWdoIHRoZSByZWYgLSB1c2VkIGZvciBrZXlib2FyZCBzaG9ydGN1dCBhY2Nlc3MgdG8gc29tZSBidXR0b25zXG4gICAgbmV3UHJvcHMucmVmID0gaW5wdXRSZWY7XG5cbiAgICBuZXdQcm9wcy5jbGFzc05hbWUgPSBjbGFzc25hbWVzKFxuICAgICAgICBcIm14X0FjY2Vzc2libGVCdXR0b25cIixcbiAgICAgICAgY2xhc3NOYW1lLFxuICAgICAgICB7XG4gICAgICAgICAgICBcIm14X0FjY2Vzc2libGVCdXR0b25faGFzS2luZFwiOiBraW5kLFxuICAgICAgICAgICAgW2BteF9BY2Nlc3NpYmxlQnV0dG9uX2tpbmRfJHtraW5kfWBdOiBraW5kLFxuICAgICAgICAgICAgXCJteF9BY2Nlc3NpYmxlQnV0dG9uX2Rpc2FibGVkXCI6IGRpc2FibGVkLFxuICAgICAgICB9LFxuICAgICk7XG5cbiAgICAvLyBSZWFjdC5jcmVhdGVFbGVtZW50IGV4cGVjdHMgSW5wdXRIVE1MQXR0cmlidXRlc1xuICAgIHJldHVybiBSZWFjdC5jcmVhdGVFbGVtZW50KGVsZW1lbnQsIG5ld1Byb3BzLCBjaGlsZHJlbik7XG59XG5cbkFjY2Vzc2libGVCdXR0b24uZGVmYXVsdFByb3BzID0ge1xuICAgIGVsZW1lbnQ6ICdkaXYnIGFzIGtleW9mIFJlYWN0SFRNTCxcbiAgICByb2xlOiAnYnV0dG9uJyxcbiAgICB0YWJJbmRleDogMCxcbn07XG5cbkFjY2Vzc2libGVCdXR0b24uZGlzcGxheU5hbWUgPSBcIkFjY2Vzc2libGVCdXR0b25cIjtcbiJdfQ==