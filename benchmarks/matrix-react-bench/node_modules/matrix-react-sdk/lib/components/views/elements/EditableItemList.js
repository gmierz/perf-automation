"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.EditableItem = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireDefault(require("react"));

var _languageHandler = require("../../../languageHandler");

var _Field = _interopRequireDefault(require("./Field"));

var _AccessibleButton = _interopRequireDefault(require("./AccessibleButton"));

var _replaceableComponent = require("../../../utils/replaceableComponent");

var _dec, _class;

class EditableItem extends _react.default.Component {
  constructor(...args) {
    super(...args);
    (0, _defineProperty2.default)(this, "state", {
      verifyRemove: false
    });
    (0, _defineProperty2.default)(this, "onRemove", e => {
      e.stopPropagation();
      e.preventDefault();
      this.setState({
        verifyRemove: true
      });
    });
    (0, _defineProperty2.default)(this, "onDontRemove", e => {
      e.stopPropagation();
      e.preventDefault();
      this.setState({
        verifyRemove: false
      });
    });
    (0, _defineProperty2.default)(this, "onActuallyRemove", e => {
      e.stopPropagation();
      e.preventDefault();
      if (this.props.onRemove) this.props.onRemove(this.props.index);
      this.setState({
        verifyRemove: false
      });
    });
  }

  render() {
    if (this.state.verifyRemove) {
      return /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_EditableItem"
      }, /*#__PURE__*/_react.default.createElement("span", {
        className: "mx_EditableItem_promptText"
      }, (0, _languageHandler._t)("Are you sure?")), /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
        onClick: this.onActuallyRemove,
        kind: "primary_sm",
        className: "mx_EditableItem_confirmBtn"
      }, (0, _languageHandler._t)("Yes")), /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
        onClick: this.onDontRemove,
        kind: "danger_sm",
        className: "mx_EditableItem_confirmBtn"
      }, (0, _languageHandler._t)("No")));
    }

    return /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_EditableItem"
    }, /*#__PURE__*/_react.default.createElement("div", {
      onClick: this.onRemove,
      className: "mx_EditableItem_delete",
      title: (0, _languageHandler._t)("Remove"),
      role: "button"
    }), /*#__PURE__*/_react.default.createElement("span", {
      className: "mx_EditableItem_item"
    }, this.props.value));
  }

}

exports.EditableItem = EditableItem;
let EditableItemList = (_dec = (0, _replaceableComponent.replaceableComponent)("views.elements.EditableItemList"), _dec(_class = class EditableItemList extends _react.default.PureComponent {
  constructor(...args) {
    super(...args);
    (0, _defineProperty2.default)(this, "onItemAdded", e => {
      e.stopPropagation();
      e.preventDefault();
      if (this.props.onItemAdded) this.props.onItemAdded(this.props.newItem);
    });
    (0, _defineProperty2.default)(this, "onItemRemoved", index => {
      if (this.props.onItemRemoved) this.props.onItemRemoved(index);
    });
    (0, _defineProperty2.default)(this, "onNewItemChanged", e => {
      if (this.props.onNewItemChanged) this.props.onNewItemChanged(e.target.value);
    });
  }

  renderNewItemField() {
    return /*#__PURE__*/_react.default.createElement("form", {
      onSubmit: this.onItemAdded,
      autoComplete: "off",
      noValidate: true,
      className: "mx_EditableItemList_newItem"
    }, /*#__PURE__*/_react.default.createElement(_Field.default, {
      label: this.props.placeholder,
      type: "text",
      autoComplete: "off",
      value: this.props.newItem || "",
      onChange: this.onNewItemChanged,
      list: this.props.suggestionsListId
    }), /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
      onClick: this.onItemAdded,
      kind: "primary",
      type: "submit",
      disabled: !this.props.newItem
    }, (0, _languageHandler._t)("Add")));
  }

  render() {
    const editableItems = this.props.items.map((item, index) => {
      if (!this.props.canRemove) {
        return /*#__PURE__*/_react.default.createElement("li", {
          key: item
        }, item);
      }

      return /*#__PURE__*/_react.default.createElement(EditableItem, {
        key: item,
        index: index,
        value: item,
        onRemove: this.onItemRemoved
      });
    });
    const editableItemsSection = this.props.canRemove ? editableItems : /*#__PURE__*/_react.default.createElement("ul", null, editableItems);
    const label = this.props.items.length > 0 ? this.props.itemsLabel : this.props.noItemsLabel;
    return /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_EditableItemList"
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_EditableItemList_label"
    }, label), editableItemsSection, this.props.canEdit ? this.renderNewItemField() : /*#__PURE__*/_react.default.createElement("div", null));
  }

}) || _class);
exports.default = EditableItemList;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZpZXdzL2VsZW1lbnRzL0VkaXRhYmxlSXRlbUxpc3QudHN4Il0sIm5hbWVzIjpbIkVkaXRhYmxlSXRlbSIsIlJlYWN0IiwiQ29tcG9uZW50IiwidmVyaWZ5UmVtb3ZlIiwiZSIsInN0b3BQcm9wYWdhdGlvbiIsInByZXZlbnREZWZhdWx0Iiwic2V0U3RhdGUiLCJwcm9wcyIsIm9uUmVtb3ZlIiwiaW5kZXgiLCJyZW5kZXIiLCJzdGF0ZSIsIm9uQWN0dWFsbHlSZW1vdmUiLCJvbkRvbnRSZW1vdmUiLCJ2YWx1ZSIsIkVkaXRhYmxlSXRlbUxpc3QiLCJQdXJlQ29tcG9uZW50Iiwib25JdGVtQWRkZWQiLCJuZXdJdGVtIiwib25JdGVtUmVtb3ZlZCIsIm9uTmV3SXRlbUNoYW5nZWQiLCJ0YXJnZXQiLCJyZW5kZXJOZXdJdGVtRmllbGQiLCJwbGFjZWhvbGRlciIsInN1Z2dlc3Rpb25zTGlzdElkIiwiZWRpdGFibGVJdGVtcyIsIml0ZW1zIiwibWFwIiwiaXRlbSIsImNhblJlbW92ZSIsImVkaXRhYmxlSXRlbXNTZWN0aW9uIiwibGFiZWwiLCJsZW5ndGgiLCJpdGVtc0xhYmVsIiwibm9JdGVtc0xhYmVsIiwiY2FuRWRpdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFnQkE7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7QUFZTyxNQUFNQSxZQUFOLFNBQTJCQyxlQUFNQyxTQUFqQyxDQUFtRTtBQUFBO0FBQUE7QUFBQSxpREFDdkQ7QUFDWEMsTUFBQUEsWUFBWSxFQUFFO0FBREgsS0FEdUQ7QUFBQSxvREFLbERDLENBQUQsSUFBTztBQUN0QkEsTUFBQUEsQ0FBQyxDQUFDQyxlQUFGO0FBQ0FELE1BQUFBLENBQUMsQ0FBQ0UsY0FBRjtBQUVBLFdBQUtDLFFBQUwsQ0FBYztBQUFFSixRQUFBQSxZQUFZLEVBQUU7QUFBaEIsT0FBZDtBQUNILEtBVnFFO0FBQUEsd0RBWTlDQyxDQUFELElBQU87QUFDMUJBLE1B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QUFzRCxLQUFLMUIsS0FBTCxDQUFXMkIsWUFBL0U7QUFFQSx3QkFDSTtBQUFLLE1BQUEsU0FBUyxFQUFDO0FBQWYsb0JBQ0k7QUFBSyxNQUFBLFNBQVMsRUFBQztBQUFmLE9BQ01ILEtBRE4sQ0FESixFQUlNRCxvQkFKTixFQUtNLEtBQUt2QixLQUFMLENBQVc0QixPQUFYLEdBQXFCLEtBQUtiLGtCQUFMLEVBQXJCLGdCQUFpRCx5Q0FMdkQsQ0FESjtBQVNIOztBQXRFaUYsQyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG5Db3B5cmlnaHQgMjAxNy0yMDIxIFRoZSBNYXRyaXgub3JnIEZvdW5kYXRpb24gQy5JLkMuXG5cbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG55b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG5Zb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcblxuICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuXG5Vbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG5kaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG5XSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cblNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbmxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuKi9cblxuaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuXG5pbXBvcnQgeyBfdCB9IGZyb20gJy4uLy4uLy4uL2xhbmd1YWdlSGFuZGxlcic7XG5pbXBvcnQgRmllbGQgZnJvbSBcIi4vRmllbGRcIjtcbmltcG9ydCBBY2Nlc3NpYmxlQnV0dG9uIGZyb20gXCIuL0FjY2Vzc2libGVCdXR0b25cIjtcbmltcG9ydCB7IHJlcGxhY2VhYmxlQ29tcG9uZW50IH0gZnJvbSBcIi4uLy4uLy4uL3V0aWxzL3JlcGxhY2VhYmxlQ29tcG9uZW50XCI7XG5cbmludGVyZmFjZSBJSXRlbVByb3BzIHtcbiAgICBpbmRleD86IG51bWJlcjtcbiAgICB2YWx1ZT86IHN0cmluZztcbiAgICBvblJlbW92ZT8oaW5kZXg6IG51bWJlcik6IHZvaWQ7XG59XG5cbmludGVyZmFjZSBJSXRlbVN0YXRlIHtcbiAgICB2ZXJpZnlSZW1vdmU6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjbGFzcyBFZGl0YWJsZUl0ZW0gZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8SUl0ZW1Qcm9wcywgSUl0ZW1TdGF0ZT4ge1xuICAgIHB1YmxpYyBzdGF0ZSA9IHtcbiAgICAgICAgdmVyaWZ5UmVtb3ZlOiBmYWxzZSxcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvblJlbW92ZSA9IChlKSA9PiB7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICB0aGlzLnNldFN0YXRlKHsgdmVyaWZ5UmVtb3ZlOiB0cnVlIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uRG9udFJlbW92ZSA9IChlKSA9PiB7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICB0aGlzLnNldFN0YXRlKHsgdmVyaWZ5UmVtb3ZlOiBmYWxzZSB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkFjdHVhbGx5UmVtb3ZlID0gKGUpID0+IHtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIGlmICh0aGlzLnByb3BzLm9uUmVtb3ZlKSB0aGlzLnByb3BzLm9uUmVtb3ZlKHRoaXMucHJvcHMuaW5kZXgpO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgdmVyaWZ5UmVtb3ZlOiBmYWxzZSB9KTtcbiAgICB9O1xuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS52ZXJpZnlSZW1vdmUpIHtcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJteF9FZGl0YWJsZUl0ZW1cIj5cbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwibXhfRWRpdGFibGVJdGVtX3Byb21wdFRleHRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHsgX3QoXCJBcmUgeW91IHN1cmU/XCIpIH1cbiAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICA8QWNjZXNzaWJsZUJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5vbkFjdHVhbGx5UmVtb3ZlfVxuICAgICAgICAgICAgICAgICAgICAgICAga2luZD1cInByaW1hcnlfc21cIlxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXhfRWRpdGFibGVJdGVtX2NvbmZpcm1CdG5cIlxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICB7IF90KFwiWWVzXCIpIH1cbiAgICAgICAgICAgICAgICAgICAgPC9BY2Nlc3NpYmxlQnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICA8QWNjZXNzaWJsZUJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5vbkRvbnRSZW1vdmV9XG4gICAgICAgICAgICAgICAgICAgICAgICBraW5kPVwiZGFuZ2VyX3NtXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm14X0VkaXRhYmxlSXRlbV9jb25maXJtQnRuXCJcbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgeyBfdChcIk5vXCIpIH1cbiAgICAgICAgICAgICAgICAgICAgPC9BY2Nlc3NpYmxlQnV0dG9uPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X0VkaXRhYmxlSXRlbVwiPlxuICAgICAgICAgICAgICAgIDxkaXYgb25DbGljaz17dGhpcy5vblJlbW92ZX0gY2xhc3NOYW1lPVwibXhfRWRpdGFibGVJdGVtX2RlbGV0ZVwiIHRpdGxlPXtfdChcIlJlbW92ZVwiKX0gcm9sZT1cImJ1dHRvblwiIC8+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwibXhfRWRpdGFibGVJdGVtX2l0ZW1cIj57IHRoaXMucHJvcHMudmFsdWUgfTwvc3Bhbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApO1xuICAgIH1cbn1cblxuaW50ZXJmYWNlIElQcm9wcyB7XG4gICAgaWQ6IHN0cmluZztcbiAgICBpdGVtczogc3RyaW5nW107XG4gICAgaXRlbXNMYWJlbD86IHN0cmluZztcbiAgICBub0l0ZW1zTGFiZWw/OiBzdHJpbmc7XG4gICAgcGxhY2Vob2xkZXI/OiBzdHJpbmc7XG4gICAgbmV3SXRlbT86IHN0cmluZztcbiAgICBjYW5FZGl0PzogYm9vbGVhbjtcbiAgICBjYW5SZW1vdmU/OiBib29sZWFuO1xuICAgIHN1Z2dlc3Rpb25zTGlzdElkPzogc3RyaW5nO1xuICAgIG9uSXRlbUFkZGVkPyhpdGVtOiBzdHJpbmcpOiB2b2lkO1xuICAgIG9uSXRlbVJlbW92ZWQ/KGluZGV4OiBudW1iZXIpOiB2b2lkO1xuICAgIG9uTmV3SXRlbUNoYW5nZWQ/KGl0ZW06IHN0cmluZyk6IHZvaWQ7XG59XG5cbkByZXBsYWNlYWJsZUNvbXBvbmVudChcInZpZXdzLmVsZW1lbnRzLkVkaXRhYmxlSXRlbUxpc3RcIilcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEVkaXRhYmxlSXRlbUxpc3Q8UCA9IHt9PiBleHRlbmRzIFJlYWN0LlB1cmVDb21wb25lbnQ8SVByb3BzICYgUD4ge1xuICAgIHByb3RlY3RlZCBvbkl0ZW1BZGRlZCA9IChlKSA9PiB7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICBpZiAodGhpcy5wcm9wcy5vbkl0ZW1BZGRlZCkgdGhpcy5wcm9wcy5vbkl0ZW1BZGRlZCh0aGlzLnByb3BzLm5ld0l0ZW0pO1xuICAgIH07XG5cbiAgICBwcm90ZWN0ZWQgb25JdGVtUmVtb3ZlZCA9IChpbmRleCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5wcm9wcy5vbkl0ZW1SZW1vdmVkKSB0aGlzLnByb3BzLm9uSXRlbVJlbW92ZWQoaW5kZXgpO1xuICAgIH07XG5cbiAgICBwcm90ZWN0ZWQgb25OZXdJdGVtQ2hhbmdlZCA9IChlKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLnByb3BzLm9uTmV3SXRlbUNoYW5nZWQpIHRoaXMucHJvcHMub25OZXdJdGVtQ2hhbmdlZChlLnRhcmdldC52YWx1ZSk7XG4gICAgfTtcblxuICAgIHByb3RlY3RlZCByZW5kZXJOZXdJdGVtRmllbGQoKSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8Zm9ybVxuICAgICAgICAgICAgICAgIG9uU3VibWl0PXt0aGlzLm9uSXRlbUFkZGVkfVxuICAgICAgICAgICAgICAgIGF1dG9Db21wbGV0ZT1cIm9mZlwiXG4gICAgICAgICAgICAgICAgbm9WYWxpZGF0ZT17dHJ1ZX1cbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJteF9FZGl0YWJsZUl0ZW1MaXN0X25ld0l0ZW1cIlxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgICAgICBsYWJlbD17dGhpcy5wcm9wcy5wbGFjZWhvbGRlcn1cbiAgICAgICAgICAgICAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICAgICAgICAgICAgICBhdXRvQ29tcGxldGU9XCJvZmZcIlxuICAgICAgICAgICAgICAgICAgICB2YWx1ZT17dGhpcy5wcm9wcy5uZXdJdGVtIHx8IFwiXCJ9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uTmV3SXRlbUNoYW5nZWR9XG4gICAgICAgICAgICAgICAgICAgIGxpc3Q9e3RoaXMucHJvcHMuc3VnZ2VzdGlvbnNMaXN0SWR9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8QWNjZXNzaWJsZUJ1dHRvblxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uSXRlbUFkZGVkfVxuICAgICAgICAgICAgICAgICAgICBraW5kPVwicHJpbWFyeVwiXG4gICAgICAgICAgICAgICAgICAgIHR5cGU9XCJzdWJtaXRcIlxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17IXRoaXMucHJvcHMubmV3SXRlbX1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIHsgX3QoXCJBZGRcIikgfVxuICAgICAgICAgICAgICAgIDwvQWNjZXNzaWJsZUJ1dHRvbj5cbiAgICAgICAgICAgIDwvZm9ybT5cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IGVkaXRhYmxlSXRlbXMgPSB0aGlzLnByb3BzLml0ZW1zLm1hcCgoaXRlbSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGlmICghdGhpcy5wcm9wcy5jYW5SZW1vdmUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gPGxpIGtleT17aXRlbX0+eyBpdGVtIH08L2xpPjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIDxFZGl0YWJsZUl0ZW1cbiAgICAgICAgICAgICAgICBrZXk9e2l0ZW19XG4gICAgICAgICAgICAgICAgaW5kZXg9e2luZGV4fVxuICAgICAgICAgICAgICAgIHZhbHVlPXtpdGVtfVxuICAgICAgICAgICAgICAgIG9uUmVtb3ZlPXt0aGlzLm9uSXRlbVJlbW92ZWR9XG4gICAgICAgICAgICAvPjtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgZWRpdGFibGVJdGVtc1NlY3Rpb24gPSB0aGlzLnByb3BzLmNhblJlbW92ZSA/IGVkaXRhYmxlSXRlbXMgOiA8dWw+eyBlZGl0YWJsZUl0ZW1zIH08L3VsPjtcbiAgICAgICAgY29uc3QgbGFiZWwgPSB0aGlzLnByb3BzLml0ZW1zLmxlbmd0aCA+IDAgPyB0aGlzLnByb3BzLml0ZW1zTGFiZWwgOiB0aGlzLnByb3BzLm5vSXRlbXNMYWJlbDtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJteF9FZGl0YWJsZUl0ZW1MaXN0XCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJteF9FZGl0YWJsZUl0ZW1MaXN0X2xhYmVsXCI+XG4gICAgICAgICAgICAgICAgICAgIHsgbGFiZWwgfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIHsgZWRpdGFibGVJdGVtc1NlY3Rpb24gfVxuICAgICAgICAgICAgICAgIHsgdGhpcy5wcm9wcy5jYW5FZGl0ID8gdGhpcy5yZW5kZXJOZXdJdGVtRmllbGQoKSA6IDxkaXYgLz4gfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICk7XG4gICAgfVxufVxuIl19