"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _replaceableComponent = require("../../../utils/replaceableComponent");

var _dec, _class;

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

let Slider = (_dec = (0, _replaceableComponent.replaceableComponent)("views.elements.Slider"), _dec(_class = class Slider extends React.Component {
  // offset is a terrible inverse approximation.
  // if the values represents some function f(x) = y where x is the
  // index of the array and y = values[x] then offset(f, y) = x
  // s.t f(x) = y.
  // it assumes a monotonic function and interpolates linearly between
  // y values.
  // Offset is used for finding the location of a value on a
  // non linear slider.
  offset(values, value) {
    // the index of the first number greater than value.
    const closest = values.reduce((prev, curr) => {
      return value > curr ? prev + 1 : prev;
    }, 0); // Off the left

    if (closest === 0) {
      return 0;
    } // Off the right


    if (closest === values.length) {
      return 100;
    } // Now


    const closestLessValue = values[closest - 1];
    const closestGreaterValue = values[closest];
    const intervalWidth = 1 / (values.length - 1);
    const linearInterpolation = (value - closestLessValue) / (closestGreaterValue - closestLessValue);
    return 100 * (closest - 1 + linearInterpolation) * intervalWidth;
  }

  render() {
    const dots = this.props.values.map(v => /*#__PURE__*/React.createElement(Dot, {
      active: v <= this.props.value,
      label: this.props.displayFunc(v),
      onClick: this.props.disabled ? () => {} : () => this.props.onSelectionChange(v),
      key: v,
      disabled: this.props.disabled
    }));
    let selection = null;

    if (!this.props.disabled) {
      const offset = this.offset(this.props.values, this.props.value);
      selection = /*#__PURE__*/React.createElement("div", {
        className: "mx_Slider_selection"
      }, /*#__PURE__*/React.createElement("div", {
        className: "mx_Slider_selectionDot",
        style: {
          left: "calc(-1.195em + " + offset + "%)"
        }
      }, /*#__PURE__*/React.createElement("div", {
        className: "mx_Slider_selectionText"
      }, this.props.value)), /*#__PURE__*/React.createElement("hr", {
        style: {
          width: offset + "%"
        }
      }));
    }

    return /*#__PURE__*/React.createElement("div", {
      className: "mx_Slider"
    }, /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("div", {
      className: "mx_Slider_bar"
    }, /*#__PURE__*/React.createElement("hr", {
      onClick: this.props.disabled ? () => {} : this.onClick.bind(this)
    }), selection), /*#__PURE__*/React.createElement("div", {
      className: "mx_Slider_dotContainer"
    }, dots)));
  }

  onClick(event) {
    const width = event.target.clientWidth; // nativeEvent is safe to use because https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/offsetX
    // is supported by all modern browsers

    const relativeClick = event.nativeEvent.offsetX / width;
    const nearestValue = this.props.values[Math.round(relativeClick * (this.props.values.length - 1))];
    this.props.onSelectionChange(nearestValue);
  }

}) || _class);
exports.default = Slider;

class Dot extends React.PureComponent {
  render() {
    let className = "mx_Slider_dot";

    if (!this.props.disabled && this.props.active) {
      className += " mx_Slider_dotActive";
    }

    return /*#__PURE__*/React.createElement("span", {
      onClick: this.props.onClick,
      className: "mx_Slider_dotValue"
    }, /*#__PURE__*/React.createElement("div", {
      className: className
    }), /*#__PURE__*/React.createElement("div", {
      className: "mx_Slider_labelContainer"
    }, /*#__PURE__*/React.createElement("div", {
      className: "mx_Slider_label"
    }, this.props.label)));
  }

}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZpZXdzL2VsZW1lbnRzL1NsaWRlci50c3giXSwibmFtZXMiOlsiU2xpZGVyIiwiUmVhY3QiLCJDb21wb25lbnQiLCJvZmZzZXQiLCJ2YWx1ZXMiLCJ2YWx1ZSIsImNsb3Nlc3QiLCJyZWR1Y2UiLCJwcmV2IiwiY3VyciIsImxlbmd0aCIsImNsb3Nlc3RMZXNzVmFsdWUiLCJjbG9zZXN0R3JlYXRlclZhbHVlIiwiaW50ZXJ2YWxXaWR0aCIsImxpbmVhckludGVycG9sYXRpb24iLCJyZW5kZXIiLCJkb3RzIiwicHJvcHMiLCJtYXAiLCJ2IiwiZGlzcGxheUZ1bmMiLCJkaXNhYmxlZCIsIm9uU2VsZWN0aW9uQ2hhbmdlIiwic2VsZWN0aW9uIiwibGVmdCIsIndpZHRoIiwib25DbGljayIsImJpbmQiLCJldmVudCIsInRhcmdldCIsImNsaWVudFdpZHRoIiwicmVsYXRpdmVDbGljayIsIm5hdGl2ZUV2ZW50Iiwib2Zmc2V0WCIsIm5lYXJlc3RWYWx1ZSIsIk1hdGgiLCJyb3VuZCIsIkRvdCIsIlB1cmVDb21wb25lbnQiLCJjbGFzc05hbWUiLCJhY3RpdmUiLCJsYWJlbCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQWdCQTs7QUFDQTs7Ozs7Ozs7SUFxQnFCQSxNLFdBRHBCLGdEQUFxQix1QkFBckIsQyxnQkFBRCxNQUNxQkEsTUFEckIsU0FDb0NDLEtBQUssQ0FBQ0MsU0FEMUMsQ0FDNEQ7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRQyxFQUFBQSxNQUFNLENBQUNDLE1BQUQsRUFBbUJDLEtBQW5CLEVBQTBDO0FBQ3BEO0FBQ0EsVUFBTUMsT0FBTyxHQUFHRixNQUFNLENBQUNHLE1BQVAsQ0FBYyxDQUFDQyxJQUFELEVBQU9DLElBQVAsS0FBZ0I7QUFDMUMsYUFBUUosS0FBSyxHQUFHSSxJQUFSLEdBQWVELElBQUksR0FBRyxDQUF0QixHQUEwQkEsSUFBbEM7QUFDSCxLQUZlLEVB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Q0FBa0JDLE9BQWxCLEdBQTRCUixLQUFuRDtBQUNBLFVBQU1TLFlBQVksR0FBRyxLQUFLakIsS0FBTCxDQUFXYixNQUFYLENBQWtCK0IsSUFBSSxDQUFDQyxLQUFMLENBQVdMLGFBQWEsSUFBSSxLQUFLZCxLQUFMLENBQVdiLE1BQVgsQ0FBa0JNLE1BQWxCLEdBQTJCLENBQS9CLENBQXhCLENBQWxCLENBQXJCO0FBQ0EsU0FBS08sS0FBTCxDQUFXSyxpQkFBWCxDQUE2QlksWUFBN0I7QUFDSDs7QUE3RXVELEM7OztBQThGNUQsTUFBTUcsR0FBTixTQUFrQnBDLEtBQUssQ0FBQ3FDLGFBQXhCLENBQWlEO0FBQzdDdkIsRUFBQUEsTUFBTSxHQUFvQjtBQUN0QixRQUFJd0IsU0FBUyxHQUFHLGVBQWhCOztBQUNBLFFBQUksQ0FBQyxLQUFLdEIsS0FBTCxDQUFXSSxRQUFaLElBQXdCLEtBQUtKLEtBQUwsQ0FBV3VCLE1BQXZDLEVBQStDO0FBQzNDRCxNQUFBQSxTQUFTLElBQUksc0JBQWI7QUFDSDs7QUFFRCx3QkFBTztBQUFNLE1BQUEsT0FBTyxFQUFFLEtBQUt0QixLQUFMLENBQVdTLE9BQTFCO0FBQW1DLE1BQUEsU0FBUyxFQUFDO0FBQTdDLG9CQUNIO0FBQUssTUFBQSxTQUFTLEVBQUVhO0FBQWhCLE1BREcsZUFFSDtBQUFLLE1BQUEsU0FBUyxFQUFDO0FBQWYsb0JBQ0k7QUFBSyxNQUFBLFNBQVMsRUFBQztBQUFmLE9BQ00sS0FBS3RCLEtBQUwsQ0FBV3dCLEtBRGpCLENBREosQ0FGRyxDQUFQO0FBUUg7O0FBZjRDIiwic291cmNlc0NvbnRlbnQiOlsiLypcbkNvcHlyaWdodCAyMDIwIFRoZSBNYXRyaXgub3JnIEZvdW5kYXRpb24gQy5JLkMuXG5cbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG55b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG5Zb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcblxuICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuXG5Vbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG5kaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG5XSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cblNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbmxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuKi9cblxuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgcmVwbGFjZWFibGVDb21wb25lbnQgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvcmVwbGFjZWFibGVDb21wb25lbnRcIjtcblxuaW50ZXJmYWNlIElQcm9wcyB7XG4gICAgLy8gQSBjYWxsYmFjayBmb3IgdGhlIHNlbGVjdGVkIHZhbHVlXG4gICAgb25TZWxlY3Rpb25DaGFuZ2U6ICh2YWx1ZTogbnVtYmVyKSA9PiB2b2lkO1xuXG4gICAgLy8gVGhlIGN1cnJlbnQgdmFsdWUgb2YgdGhlIHNsaWRlclxuICAgIHZhbHVlOiBudW1iZXI7XG5cbiAgICAvLyBUaGUgcmFuZ2UgYW5kIHZhbHVlcyBvZiB0aGUgc2xpZGVyXG4gICAgLy8gQ3VycmVudGx5IG9ubHkgc3VwcG9ydHMgYW4gYXNjZW5kaW5nLCBjb25zdGFudCBpbnRlcnZhbCByYW5nZVxuICAgIHZhbHVlczogbnVtYmVyW107XG5cbiAgICAvLyBBIGZ1bmN0aW9uIGZvciBmb3JtYXR0aW5nIHRoZSB0aGUgdmFsdWVzXG4gICAgZGlzcGxheUZ1bmM6ICh2YWx1ZTogbnVtYmVyKSA9PiBzdHJpbmc7XG5cbiAgICAvLyBXaGV0aGVyIHRoZSBzbGlkZXIgaXMgZGlzYWJsZWRcbiAgICBkaXNhYmxlZDogYm9vbGVhbjtcbn1cblxuQHJlcGxhY2VhYmxlQ29tcG9uZW50KFwidmlld3MuZWxlbWVudHMuU2xpZGVyXCIpXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTbGlkZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8SVByb3BzPiB7XG4gICAgLy8gb2Zmc2V0IGlzIGEgdGVycmlibGUgaW52ZXJzZSBhcHByb3hpbWF0aW9uLlxuICAgIC8vIGlmIHRoZSB2YWx1ZXMgcmVwcmVzZW50cyBzb21lIGZ1bmN0aW9uIGYoeCkgPSB5IHdoZXJlIHggaXMgdGhlXG4gICAgLy8gaW5kZXggb2YgdGhlIGFycmF5IGFuZCB5ID0gdmFsdWVzW3hdIHRoZW4gb2Zmc2V0KGYsIHkpID0geFxuICAgIC8vIHMudCBmKHgpID0geS5cbiAgICAvLyBpdCBhc3N1bWVzIGEgbW9ub3RvbmljIGZ1bmN0aW9uIGFuZCBpbnRlcnBvbGF0ZXMgbGluZWFybHkgYmV0d2VlblxuICAgIC8vIHkgdmFsdWVzLlxuICAgIC8vIE9mZnNldCBpcyB1c2VkIGZvciBmaW5kaW5nIHRoZSBsb2NhdGlvbiBvZiBhIHZhbHVlIG9uIGFcbiAgICAvLyBub24gbGluZWFyIHNsaWRlci5cbiAgICBwcml2YXRlIG9mZnNldCh2YWx1ZXM6IG51bWJlcltdLCB2YWx1ZTogbnVtYmVyKTogbnVtYmVyIHtcbiAgICAgICAgLy8gdGhlIGluZGV4IG9mIHRoZSBmaXJzdCBudW1iZXIgZ3JlYXRlciB0aGFuIHZhbHVlLlxuICAgICAgICBjb25zdCBjbG9zZXN0ID0gdmFsdWVzLnJlZHVjZSgocHJldiwgY3VycikgPT4ge1xuICAgICAgICAgICAgcmV0dXJuICh2YWx1ZSA+IGN1cnIgPyBwcmV2ICsgMSA6IHByZXYpO1xuICAgICAgICB9LCAwKTtcblxuICAgICAgICAvLyBPZmYgdGhlIGxlZnRcbiAgICAgICAgaWYgKGNsb3Nlc3QgPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gT2ZmIHRoZSByaWdodFxuICAgICAgICBpZiAoY2xvc2VzdCA9PT0gdmFsdWVzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIDEwMDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE5vd1xuICAgICAgICBjb25zdCBjbG9zZXN0TGVzc1ZhbHVlID0gdmFsdWVzW2Nsb3Nlc3QgLSAxXTtcbiAgICAgICAgY29uc3QgY2xvc2VzdEdyZWF0ZXJWYWx1ZSA9IHZhbHVlc1tjbG9zZXN0XTtcblxuICAgICAgICBjb25zdCBpbnRlcnZhbFdpZHRoID0gMSAvICh2YWx1ZXMubGVuZ3RoIC0gMSk7XG5cbiAgICAgICAgY29uc3QgbGluZWFySW50ZXJwb2xhdGlvbiA9ICh2YWx1ZSAtIGNsb3Nlc3RMZXNzVmFsdWUpIC8gKGNsb3Nlc3RHcmVhdGVyVmFsdWUgLSBjbG9zZXN0TGVzc1ZhbHVlKTtcblxuICAgICAgICByZXR1cm4gMTAwICogKGNsb3Nlc3QgLSAxICsgbGluZWFySW50ZXJwb2xhdGlvbikgKiBpbnRlcnZhbFdpZHRoO1xuICAgIH1cblxuICAgIHJlbmRlcigpOiBSZWFjdC5SZWFjdE5vZGUge1xuICAgICAgICBjb25zdCBkb3RzID0gdGhpcy5wcm9wcy52YWx1ZXMubWFwKHYgPT4gPERvdFxuICAgICAgICAgICAgYWN0aXZlPXt2IDw9IHRoaXMucHJvcHMudmFsdWV9XG4gICAgICAgICAgICBsYWJlbD17dGhpcy5wcm9wcy5kaXNwbGF5RnVuYyh2KX1cbiAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMucHJvcHMuZGlzYWJsZWQgPyAoKSA9PiB7fSA6ICgpID0+IHRoaXMucHJvcHMub25TZWxlY3Rpb25DaGFuZ2Uodil9XG4gICAgICAgICAgICBrZXk9e3Z9XG4gICAgICAgICAgICBkaXNhYmxlZD17dGhpcy5wcm9wcy5kaXNhYmxlZH1cbiAgICAgICAgLz4pO1xuXG4gICAgICAgIGxldCBzZWxlY3Rpb24gPSBudWxsO1xuXG4gICAgICAgIGlmICghdGhpcy5wcm9wcy5kaXNhYmxlZCkge1xuICAgICAgICAgICAgY29uc3Qgb2Zmc2V0ID0gdGhpcy5vZmZzZXQodGhpcy5wcm9wcy52YWx1ZXMsIHRoaXMucHJvcHMudmFsdWUpO1xuICAgICAgICAgICAgc2VsZWN0aW9uID0gPGRpdiBjbGFzc05hbWU9XCJteF9TbGlkZXJfc2VsZWN0aW9uXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJteF9TbGlkZXJfc2VsZWN0aW9uRG90XCIgc3R5bGU9e3sgbGVmdDogXCJjYWxjKC0xLjE5NWVtICsgXCIgKyBvZmZzZXQgKyBcIiUpXCIgfX0+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfU2xpZGVyX3NlbGVjdGlvblRleHRcIj57IHRoaXMucHJvcHMudmFsdWUgfTwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxociBzdHlsZT17eyB3aWR0aDogb2Zmc2V0ICsgXCIlXCIgfX0gLz5cbiAgICAgICAgICAgIDwvZGl2PjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cIm14X1NsaWRlclwiPlxuICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X1NsaWRlcl9iYXJcIj5cbiAgICAgICAgICAgICAgICAgICAgPGhyIG9uQ2xpY2s9e3RoaXMucHJvcHMuZGlzYWJsZWQgPyAoKSA9PiB7fSA6IHRoaXMub25DbGljay5iaW5kKHRoaXMpfSAvPlxuICAgICAgICAgICAgICAgICAgICB7IHNlbGVjdGlvbiB9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJteF9TbGlkZXJfZG90Q29udGFpbmVyXCI+XG4gICAgICAgICAgICAgICAgICAgIHsgZG90cyB9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+O1xuICAgIH1cblxuICAgIG9uQ2xpY2soZXZlbnQ6IFJlYWN0Lk1vdXNlRXZlbnQpIHtcbiAgICAgICAgY29uc3Qgd2lkdGggPSAoZXZlbnQudGFyZ2V0IGFzIEhUTUxFbGVtZW50KS5jbGllbnRXaWR0aDtcbiAgICAgICAgLy8gbmF0aXZlRXZlbnQgaXMgc2FmZSB0byB1c2UgYmVjYXVzZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvTW91c2VFdmVudC9vZmZzZXRYXG4gICAgICAgIC8vIGlzIHN1cHBvcnRlZCBieSBhbGwgbW9kZXJuIGJyb3dzZXJzXG4gICAgICAgIGNvbnN0IHJlbGF0aXZlQ2xpY2sgPSAoZXZlbnQubmF0aXZlRXZlbnQub2Zmc2V0WCAvIHdpZHRoKTtcbiAgICAgICAgY29uc3QgbmVhcmVzdFZhbHVlID0gdGhpcy5wcm9wcy52YWx1ZXNbTWF0aC5yb3VuZChyZWxhdGl2ZUNsaWNrICogKHRoaXMucHJvcHMudmFsdWVzLmxlbmd0aCAtIDEpKV07XG4gICAgICAgIHRoaXMucHJvcHMub25TZWxlY3Rpb25DaGFuZ2UobmVhcmVzdFZhbHVlKTtcbiAgICB9XG59XG5cbmludGVyZmFjZSBJRG90UHJvcHMge1xuICAgIC8vIENhbGxiYWNrIGZvciBiZWhhdmlvciBvbmNsaWNrXG4gICAgb25DbGljazogKCkgPT4gdm9pZDtcblxuICAgIC8vIFdoZXRoZXIgdGhlIGRvdCBzaG91bGQgYXBwZWFyIGFjdGl2ZVxuICAgIGFjdGl2ZTogYm9vbGVhbjtcblxuICAgIC8vIFRoZSBsYWJlbCBvbiB0aGUgZG90XG4gICAgbGFiZWw6IHN0cmluZztcblxuICAgIC8vIFdoZXRoZXIgdGhlIHNsaWRlciBpcyBkaXNhYmxlZFxuICAgIGRpc2FibGVkOiBib29sZWFuO1xufVxuXG5jbGFzcyBEb3QgZXh0ZW5kcyBSZWFjdC5QdXJlQ29tcG9uZW50PElEb3RQcm9wcz4ge1xuICAgIHJlbmRlcigpOiBSZWFjdC5SZWFjdE5vZGUge1xuICAgICAgICBsZXQgY2xhc3NOYW1lID0gXCJteF9TbGlkZXJfZG90XCI7XG4gICAgICAgIGlmICghdGhpcy5wcm9wcy5kaXNhYmxlZCAmJiB0aGlzLnByb3BzLmFjdGl2ZSkge1xuICAgICAgICAgICAgY2xhc3NOYW1lICs9IFwiIG14X1NsaWRlcl9kb3RBY3RpdmVcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiA8c3BhbiBvbkNsaWNrPXt0aGlzLnByb3BzLm9uQ2xpY2t9IGNsYXNzTmFtZT1cIm14X1NsaWRlcl9kb3RWYWx1ZVwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2NsYXNzTmFtZX0gLz5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfU2xpZGVyX2xhYmVsQ29udGFpbmVyXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJteF9TbGlkZXJfbGFiZWxcIj5cbiAgICAgICAgICAgICAgICAgICAgeyB0aGlzLnByb3BzLmxhYmVsIH1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L3NwYW4+O1xuICAgIH1cbn1cbiJdfQ==