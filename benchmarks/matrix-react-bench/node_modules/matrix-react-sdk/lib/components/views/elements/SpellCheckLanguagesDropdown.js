"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _react = _interopRequireDefault(require("react"));

var _Dropdown = _interopRequireDefault(require("../../views/elements/Dropdown"));

var _PlatformPeg = _interopRequireDefault(require("../../../PlatformPeg"));

var _SettingsStore = _interopRequireDefault(require("../../../settings/SettingsStore"));

var _languageHandler = require("../../../languageHandler");

var _replaceableComponent = require("../../../utils/replaceableComponent");

var _Spinner = _interopRequireDefault(require("./Spinner"));

var _dec, _class;

function languageMatchesSearchQuery(query, language) {
  if (language.label.toUpperCase().includes(query.toUpperCase())) return true;
  if (language.value.toUpperCase() === query.toUpperCase()) return true;
  return false;
}

let SpellCheckLanguagesDropdown = (_dec = (0, _replaceableComponent.replaceableComponent)("views.elements.SpellCheckLanguagesDropdown"), _dec(_class = class SpellCheckLanguagesDropdown extends _react.default.Component {
  constructor(props) {
    super(props);
    this.onSearchChange = this.onSearchChange.bind(this);
    this.state = {
      searchQuery: '',
      languages: null
    };
  }

  componentDidMount() {
    const plaf = _PlatformPeg.default.get();

    if (plaf) {
      plaf.getAvailableSpellCheckLanguages().then(languages => {
        languages.sort(function (a, b) {
          if (a < b) return -1;
          if (a > b) return 1;
          return 0;
        });
        const langs = [];
        languages.forEach(language => {
          langs.push({
            label: language,
            value: language
          });
        });
        this.setState({
          languages: langs
        });
      }).catch(e => {
        this.setState({
          languages: ['en']
        });
      });
    }
  }

  onSearchChange(searchQuery) {
    this.setState({
      searchQuery
    });
  }

  render() {
    if (this.state.languages === null) {
      return /*#__PURE__*/_react.default.createElement(_Spinner.default, null);
    }

    let displayedLanguages;

    if (this.state.searchQuery) {
      displayedLanguages = this.state.languages.filter(lang => {
        return languageMatchesSearchQuery(this.state.searchQuery, lang);
      });
    } else {
      displayedLanguages = this.state.languages;
    }

    const options = displayedLanguages.map(language => {
      return /*#__PURE__*/_react.default.createElement("div", {
        key: language.value
      }, language.label);
    }); // default value here too, otherwise we need to handle null / undefined;
    // values between mounting and the initial value propgating

    let language = _SettingsStore.default.getValue("language", null,
    /*excludeDefault:*/
    true);

    let value = null;

    if (language) {
      value = this.props.value || language;
    } else {
      language = navigator.language || navigator.userLanguage;
      value = this.props.value || language;
    }

    return /*#__PURE__*/_react.default.createElement(_Dropdown.default, {
      id: "mx_LanguageDropdown",
      className: this.props.className,
      onOptionChange: this.props.onOptionChange,
      onSearchChange: this.onSearchChange,
      searchEnabled: true,
      value: value,
      label: (0, _languageHandler._t)("Language Dropdown")
    }, options);
  }

}) || _class);
exports.default = SpellCheckLanguagesDropdown;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZpZXdzL2VsZW1lbnRzL1NwZWxsQ2hlY2tMYW5ndWFnZXNEcm9wZG93bi50c3giXSwibmFtZXMiOlsibGFuZ3VhZ2VNYXRjaGVzU2VhcmNoUXVlcnkiLCJxdWVyeSIsImxhbmd1YWdlIiwibGFiZWwiLCJ0b1VwcGVyQ2FzZSIsImluY2x1ZGVzIiwidmFsdWUiLCJTcGVsbENoZWNrTGFuZ3VhZ2VzRHJvcGRvd24iLCJSZWFjdCIsIkNvbXBvbmVudCIsImNvbnN0cnVjdG9yIiwicHJvcHMiLCJvblNlYXJjaENoYW5nZSIsImJpbmQiLCJzdGF0ZSIsInNlYXJjaFF1ZXJ5IiwibGFuZ3VhZ2VzIiwiY29tcG9uZW50RGlkTW91bnQiLCJwbGFmIiwiUGxhdGZvcm1QZWciLCJnZXQiLCJnZXRBdmFpbGFibGVTcGVsbENoZWNrTGFuZ3VhZ2VzIiwidGhlbiIsInNvcnQiLCJhIiwiYiIsImxhbmdzIiwiZm9yRWFjaCIsInB1c2giLCJzZXRTdGF0ZSIsImNhdGNoIiwiZSIsInJlbmRlciIsImRpc3BsYXllZExhbmd1YWdlcyIsImZpbHRlciIsImxhbmciLCJvcHRpb25zIiwibWFwIiwiU2V0dGluZ3NTdG9yZSIsImdldFZhbHVlIiwibmF2aWdhdG9yIiwidXNlckxhbmd1YWdlIiwiY2xhc3NOYW1lIiwib25PcHRpb25DaGFuZ2UiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQWdCQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7OztBQUVBLFNBQVNBLDBCQUFULENBQW9DQyxLQUFwQyxFQUEyQ0MsUUFBM0MsRUFBcUQ7QUFDakQsTUFBSUEsUUFBUSxDQUFDQyxLQUFULENBQWVDLFdBQWYsR0FBNkJDLFFBQTdCLENBQXNDSixLQUFLLENBQUNHLFdBQU4sRUFBdEMsQ0FBSixFQUFnRSxPQUFPLElBQVA7QUFDaEUsTUFBSUYsUUFBUSxDQUFDSSxLQUFULENBQWVGLFdBQWYsT0FBaUNILEtBQUssQ0FBQ0cs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QUEsS0FBSyxHQUFHLEtBQUtLLEtBQUwsQ0FBV0wsS0FBWCxJQUFvQkosUUFBNUI7QUFDSCxLQUZELE1BRU87QUFDSEEsTUFBQUEsUUFBUSxHQUFHc0MsU0FBUyxDQUFDdEMsUUFBVixJQUFzQnNDLFNBQVMsQ0FBQ0MsWUFBM0M7QUFDQW5DLE1BQUFBLEtBQUssR0FBRyxLQUFLSyxLQUFMLENBQVdMLEtBQVgsSUFBb0JKLFFBQTVCO0FBQ0g7O0FBRUQsd0JBQU8sNkJBQUMsaUJBQUQ7QUFDSCxNQUFBLEVBQUUsRUFBQyxxQkFEQTtBQUVILE1BQUEsU0FBUyxFQUFFLEtBQUtTLEtBQUwsQ0FBVytCLFNBRm5CO0FBR0gsTUFBQSxjQUFjLEVBQUUsS0FBSy9CLEtBQUwsQ0FBV2dDLGNBSHhCO0FBSUgsTUFBQSxjQUFjLEVBQUUsS0FBSy9CLGNBSmxCO0FBS0gsTUFBQSxhQUFhLEVBQUUsSUFMWjtBQU1ILE1BQUEsS0FBSyxFQUFFTixLQU5KO0FBT0gsTUFBQSxLQUFLLEVBQUUseUJBQUcsbUJBQUg7QUFQSixPQVFEOEIsT0FSQyxDQUFQO0FBVUg7O0FBL0V1RyxDIiwic291cmNlc0NvbnRlbnQiOlsiLypcbkNvcHlyaWdodCAyMDIxIMWgaW1vbiBCcmFuZG5lciA8c2ltb24uYnJhLmFnQGdtYWlsLmNvbT5cblxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbnlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbllvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuXG4gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cblVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbmRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxubGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4qL1xuXG5pbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuXG5pbXBvcnQgRHJvcGRvd24gZnJvbSBcIi4uLy4uL3ZpZXdzL2VsZW1lbnRzL0Ryb3Bkb3duXCI7XG5pbXBvcnQgUGxhdGZvcm1QZWcgZnJvbSBcIi4uLy4uLy4uL1BsYXRmb3JtUGVnXCI7XG5pbXBvcnQgU2V0dGluZ3NTdG9yZSBmcm9tIFwiLi4vLi4vLi4vc2V0dGluZ3MvU2V0dGluZ3NTdG9yZVwiO1xuaW1wb3J0IHsgX3QgfSBmcm9tIFwiLi4vLi4vLi4vbGFuZ3VhZ2VIYW5kbGVyXCI7XG5pbXBvcnQgeyByZXBsYWNlYWJsZUNvbXBvbmVudCB9IGZyb20gXCIuLi8uLi8uLi91dGlscy9yZXBsYWNlYWJsZUNvbXBvbmVudFwiO1xuaW1wb3J0IFNwaW5uZXIgZnJvbSBcIi4vU3Bpbm5lclwiO1xuXG5mdW5jdGlvbiBsYW5ndWFnZU1hdGNoZXNTZWFyY2hRdWVyeShxdWVyeSwgbGFuZ3VhZ2UpIHtcbiAgICBpZiAobGFuZ3VhZ2UubGFiZWwudG9VcHBlckNhc2UoKS5pbmNsdWRlcyhxdWVyeS50b1VwcGVyQ2FzZSgpKSkgcmV0dXJuIHRydWU7XG4gICAgaWYgKGxhbmd1YWdlLnZhbHVlLnRvVXBwZXJDYXNlKCkgPT09IHF1ZXJ5LnRvVXBwZXJDYXNlKCkpIHJldHVybiB0cnVlO1xuICAgIHJldHVybiBmYWxzZTtcbn1cblxuaW50ZXJmYWNlIFNwZWxsQ2hlY2tMYW5ndWFnZXNEcm9wZG93bklQcm9wcyB7XG4gICAgY2xhc3NOYW1lOiBzdHJpbmc7XG4gICAgdmFsdWU6IHN0cmluZztcbiAgICBvbk9wdGlvbkNoYW5nZShsYW5ndWFnZTogc3RyaW5nKTtcbn1cblxuaW50ZXJmYWNlIFNwZWxsQ2hlY2tMYW5ndWFnZXNEcm9wZG93bklTdGF0ZSB7XG4gICAgc2VhcmNoUXVlcnk6IHN0cmluZztcbiAgICBsYW5ndWFnZXM6IGFueTtcbn1cblxuQHJlcGxhY2VhYmxlQ29tcG9uZW50KFwidmlld3MuZWxlbWVudHMuU3BlbGxDaGVja0xhbmd1YWdlc0Ryb3Bkb3duXCIpXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTcGVsbENoZWNrTGFuZ3VhZ2VzRHJvcGRvd24gZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8U3BlbGxDaGVja0xhbmd1YWdlc0Ryb3Bkb3duSVByb3BzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNwZWxsQ2hlY2tMYW5ndWFnZXNEcm9wZG93bklTdGF0ZT4ge1xuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcbiAgICAgICAgdGhpcy5vblNlYXJjaENoYW5nZSA9IHRoaXMub25TZWFyY2hDaGFuZ2UuYmluZCh0aGlzKTtcblxuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgc2VhcmNoUXVlcnk6ICcnLFxuICAgICAgICAgICAgbGFuZ3VhZ2VzOiBudWxsLFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgICBjb25zdCBwbGFmID0gUGxhdGZvcm1QZWcuZ2V0KCk7XG4gICAgICAgIGlmIChwbGFmKSB7XG4gICAgICAgICAgICBwbGFmLmdldEF2YWlsYWJsZVNwZWxsQ2hlY2tMYW5ndWFnZXMoKS50aGVuKChsYW5ndWFnZXMpID0+IHtcbiAgICAgICAgICAgICAgICBsYW5ndWFnZXMuc29ydChmdW5jdGlvbihhLCBiKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhIDwgYikgcmV0dXJuIC0xO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYSA+IGIpIHJldHVybiAxO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjb25zdCBsYW5ncyA9IFtdO1xuICAgICAgICAgICAgICAgIGxhbmd1YWdlcy5mb3JFYWNoKChsYW5ndWFnZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBsYW5ncy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBsYW5ndWFnZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBsYW5ndWFnZSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGxhbmd1YWdlczogbGFuZ3MgfSk7XG4gICAgICAgICAgICB9KS5jYXRjaCgoZSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBsYW5ndWFnZXM6IFsnZW4nXSB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvblNlYXJjaENoYW5nZShzZWFyY2hRdWVyeTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBzZWFyY2hRdWVyeSB9KTtcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmxhbmd1YWdlcyA9PT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIDxTcGlubmVyIC8+O1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGRpc3BsYXllZExhbmd1YWdlcztcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuc2VhcmNoUXVlcnkpIHtcbiAgICAgICAgICAgIGRpc3BsYXllZExhbmd1YWdlcyA9IHRoaXMuc3RhdGUubGFuZ3VhZ2VzLmZpbHRlcigobGFuZykgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBsYW5ndWFnZU1hdGNoZXNTZWFyY2hRdWVyeSh0aGlzLnN0YXRlLnNlYXJjaFF1ZXJ5LCBsYW5nKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGlzcGxheWVkTGFuZ3VhZ2VzID0gdGhpcy5zdGF0ZS5sYW5ndWFnZXM7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBvcHRpb25zID0gZGlzcGxheWVkTGFuZ3VhZ2VzLm1hcCgobGFuZ3VhZ2UpID0+IHtcbiAgICAgICAgICAgIHJldHVybiA8ZGl2IGtleT17bGFuZ3VhZ2UudmFsdWV9PlxuICAgICAgICAgICAgICAgIHsgbGFuZ3VhZ2UubGFiZWwgfVxuICAgICAgICAgICAgPC9kaXY+O1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBkZWZhdWx0IHZhbHVlIGhlcmUgdG9vLCBvdGhlcndpc2Ugd2UgbmVlZCB0byBoYW5kbGUgbnVsbCAvIHVuZGVmaW5lZDtcbiAgICAgICAgLy8gdmFsdWVzIGJldHdlZW4gbW91bnRpbmcgYW5kIHRoZSBpbml0aWFsIHZhbHVlIHByb3BnYXRpbmdcbiAgICAgICAgbGV0IGxhbmd1YWdlID0gU2V0dGluZ3NTdG9yZS5nZXRWYWx1ZShcImxhbmd1YWdlXCIsIG51bGwsIC8qZXhjbHVkZURlZmF1bHQ6Ki90cnVlKTtcbiAgICAgICAgbGV0IHZhbHVlID0gbnVsbDtcbiAgICAgICAgaWYgKGxhbmd1YWdlKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IHRoaXMucHJvcHMudmFsdWUgfHwgbGFuZ3VhZ2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsYW5ndWFnZSA9IG5hdmlnYXRvci5sYW5ndWFnZSB8fCBuYXZpZ2F0b3IudXNlckxhbmd1YWdlO1xuICAgICAgICAgICAgdmFsdWUgPSB0aGlzLnByb3BzLnZhbHVlIHx8IGxhbmd1YWdlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIDxEcm9wZG93blxuICAgICAgICAgICAgaWQ9XCJteF9MYW5ndWFnZURyb3Bkb3duXCJcbiAgICAgICAgICAgIGNsYXNzTmFtZT17dGhpcy5wcm9wcy5jbGFzc05hbWV9XG4gICAgICAgICAgICBvbk9wdGlvbkNoYW5nZT17dGhpcy5wcm9wcy5vbk9wdGlvbkNoYW5nZX1cbiAgICAgICAgICAgIG9uU2VhcmNoQ2hhbmdlPXt0aGlzLm9uU2VhcmNoQ2hhbmdlfVxuICAgICAgICAgICAgc2VhcmNoRW5hYmxlZD17dHJ1ZX1cbiAgICAgICAgICAgIHZhbHVlPXt2YWx1ZX1cbiAgICAgICAgICAgIGxhYmVsPXtfdChcIkxhbmd1YWdlIERyb3Bkb3duXCIpfT5cbiAgICAgICAgICAgIHsgb3B0aW9ucyB9XG4gICAgICAgIDwvRHJvcGRvd24+O1xuICAgIH1cbn1cbiJdfQ==