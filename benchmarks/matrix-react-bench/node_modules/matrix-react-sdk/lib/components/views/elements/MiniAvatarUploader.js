"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.AVATAR_SIZE = void 0;

var _react = _interopRequireWildcard(require("react"));

var _event = require("matrix-js-sdk/src/@types/event");

var _classnames = _interopRequireDefault(require("classnames"));

var _AccessibleButton = _interopRequireDefault(require("./AccessibleButton"));

var _Spinner = _interopRequireDefault(require("./Spinner"));

var _MatrixClientContext = _interopRequireDefault(require("../../../contexts/MatrixClientContext"));

var _useTimeout = require("../../../hooks/useTimeout");

var _Analytics = _interopRequireDefault(require("../../../Analytics"));

var _CountlyAnalytics = _interopRequireDefault(require("../../../CountlyAnalytics"));

var _RoomContext = _interopRequireDefault(require("../../../contexts/RoomContext"));

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

/*
Copyright 2020 The Matrix.org Foundation C.I.C.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
const AVATAR_SIZE = 52;
exports.AVATAR_SIZE = AVATAR_SIZE;

const MiniAvatarUploader = ({
  hasAvatar,
  hasAvatarLabel,
  noAvatarLabel,
  setAvatarUrl,
  children
}) => {
  const cli = (0, _react.useContext)(_MatrixClientContext.default);
  const [busy, setBusy] = (0, _react.useState)(false);
  const [hover, setHover] = (0, _react.useState)(false);
  const [show, setShow] = (0, _react.useState)(false);
  (0, _useTimeout.useTimeout)(() => {
    setShow(true);
  }, 3000); // show after 3 seconds

  (0, _useTimeout.useTimeout)(() => {
    setShow(false);
  }, 13000); // hide after being shown for 10 seconds

  const uploadRef = (0, _react.useRef)();
  const label = hasAvatar || busy ? hasAvatarLabel : noAvatarLabel;
  const {
    room
  } = (0, _react.useContext)(_RoomContext.default);
  const canSetAvatar = room === null || room === void 0 ? void 0 : room.currentState.maySendStateEvent(_event.EventType.RoomAvatar, cli.getUserId());
  if (!canSetAvatar) return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, children);
  const visible = !!label && (hover || show);
  return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement("input", {
    type: "file",
    ref: uploadRef,
    className: "mx_MiniAvatarUploader_input",
    onChange: async ev => {
      var _ev$target$files;

      if (!((_ev$target$files = ev.target.files) !== null && _ev$target$files !== void 0 && _ev$target$files.length)) return;
      setBusy(true);

      _Analytics.default.trackEvent("mini_avatar", "upload");

      _CountlyAnalytics.default.instance.track("mini_avatar_upload");

      const file = ev.target.files[0];
      const uri = await cli.uploadContent(file);
      await setAvatarUrl(uri);
      setBusy(false);
    },
    accept: "image/*"
  }), /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
    className: (0, _classnames.default)("mx_MiniAvatarUploader", {
      mx_MiniAvatarUploader_busy: busy,
      mx_MiniAvatarUploader_hasAvatar: hasAvatar
    }),
    disabled: busy,
    onClick: () => {
      uploadRef.current.click();
    },
    onMouseOver: () => setHover(true),
    onMouseLeave: () => setHover(false)
  }, children, /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_MiniAvatarUploader_indicator"
  }, busy ? /*#__PURE__*/_react.default.createElement(_Spinner.default, {
    w: 20,
    h: 20
  }) : /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_MiniAvatarUploader_cameraIcon"
  })), /*#__PURE__*/_react.default.createElement("div", {
    className: (0, _classnames.default)("mx_Tooltip", {
      "mx_Tooltip_visible": visible,
      "mx_Tooltip_invisible": !visible
    })
  }, /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_Tooltip_chevron"
  }), label)));
};

var _default = MiniAvatarUploader;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZpZXdzL2VsZW1lbnRzL01pbmlBdmF0YXJVcGxvYWRlci50c3giXSwibmFtZXMiOlsiQVZBVEFSX1NJWkUiLCJNaW5pQXZhdGFyVXBsb2FkZXIiLCJoYXNBdmF0YXIiLCJoYXNBdmF0YXJMYWJlbCIsIm5vQXZhdGFyTGFiZWwiLCJzZXRBdmF0YXJVcmwiLCJjaGlsZHJlbiIsImNsaSIsIk1hdHJpeENsaWVudENvbnRleHQiLCJidXN5Iiwic2V0QnVzeSIsImhvdmVyIiwic2V0SG92ZXIiLCJzaG93Iiwic2V0U2hvdyIsInVwbG9hZFJlZiIsImxhYmVsIiwicm9vbSIsIlJvb21Db250ZXh0IiwiY2FuU2V0QXZhdGFyIiwiY3VycmVudFN0YXRlIiwibWF5U2VuZFN0YXRlRXZlbnQiLCJFdmVudFR5cGUiLCJSb29tQXZhdGFyIiwiZ2V0VXNlcklkIiwidmlzaWJsZSIsImV2IiwidGFyZ2V0IiwiZmlsZXMiLCJsZW5ndGgiLCJBbmFseXRpY3MiLCJ0cmFja0V2ZW50IiwiQ291bnRseUFuYWx5dGljcyIsImluc3RhbmNlIiwidHJhY2siLCJmaWxlIiwidXJpIiwidXBsb2FkQ29udGVudCIsIm14X01pbmlBdmF0YXJVcGxvYWRlcl9idXN5IiwibXhfTWluaUF2YXRhclVwbG9hZGVyX2hhc0F2YXRhciIsImN1cnJlbnQiLCJjbGljayJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBZ0JBOztBQUNBOztBQUNBOztBQUVBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7Ozs7QUExQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBY08sTUFBTUEsV0FBVyxHQUFHLEVBQXBCOzs7QUFTUCxNQUFNQyxrQkFBb0MsR0FBRyxDQUFDO0FBQUVDLEVBQUFBLFNBQUY7QUFBYUMsRUFBQUEsY0FBYjtBQUE2QkMsRUFBQUEsYUFB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QWYsS0FDTUcsSUFBSSxnQkFDRiw2QkFBQyxnQkFBRDtBQUFTLElBQUEsQ0FBQyxFQUFFLEVBQVo7QUFBZ0IsSUFBQSxDQUFDLEVBQUU7QUFBbkIsSUFERSxnQkFFRjtBQUFLLElBQUEsU0FBUyxFQUFDO0FBQWYsSUFIUixDQWRKLGVBb0JJO0FBQUssSUFBQSxTQUFTLEVBQUUseUJBQVcsWUFBWCxFQUF5QjtBQUNyQyw0QkFBc0JnQixPQURlO0FBRXJDLDhCQUF3QixDQUFDQTtBQUZZLEtBQXpCO0FBQWhCLGtCQUlJO0FBQUssSUFBQSxTQUFTLEVBQUM7QUFBZixJQUpKLEVBS01ULEtBTE4sQ0FwQkosQ0FsQkcsQ0FBUDtBQStDSCxDQXJFRDs7ZUF1RWVmLGtCIiwic291cmNlc0NvbnRlbnQiOlsiLypcbkNvcHlyaWdodCAyMDIwIFRoZSBNYXRyaXgub3JnIEZvdW5kYXRpb24gQy5JLkMuXG5cbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG55b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG5Zb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcblxuICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuXG5Vbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG5kaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG5XSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cblNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbmxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuKi9cblxuaW1wb3J0IFJlYWN0LCB7IHVzZUNvbnRleHQsIHVzZVJlZiwgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBFdmVudFR5cGUgfSBmcm9tICdtYXRyaXgtanMtc2RrL3NyYy9AdHlwZXMvZXZlbnQnO1xuaW1wb3J0IGNsYXNzTmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XG5cbmltcG9ydCBBY2Nlc3NpYmxlQnV0dG9uIGZyb20gXCIuL0FjY2Vzc2libGVCdXR0b25cIjtcbmltcG9ydCBTcGlubmVyIGZyb20gXCIuL1NwaW5uZXJcIjtcbmltcG9ydCBNYXRyaXhDbGllbnRDb250ZXh0IGZyb20gXCIuLi8uLi8uLi9jb250ZXh0cy9NYXRyaXhDbGllbnRDb250ZXh0XCI7XG5pbXBvcnQgeyB1c2VUaW1lb3V0IH0gZnJvbSBcIi4uLy4uLy4uL2hvb2tzL3VzZVRpbWVvdXRcIjtcbmltcG9ydCBBbmFseXRpY3MgZnJvbSBcIi4uLy4uLy4uL0FuYWx5dGljc1wiO1xuaW1wb3J0IENvdW50bHlBbmFseXRpY3MgZnJvbSAnLi4vLi4vLi4vQ291bnRseUFuYWx5dGljcyc7XG5pbXBvcnQgUm9vbUNvbnRleHQgZnJvbSBcIi4uLy4uLy4uL2NvbnRleHRzL1Jvb21Db250ZXh0XCI7XG5cbmV4cG9ydCBjb25zdCBBVkFUQVJfU0laRSA9IDUyO1xuXG5pbnRlcmZhY2UgSVByb3BzIHtcbiAgICBoYXNBdmF0YXI6IGJvb2xlYW47XG4gICAgbm9BdmF0YXJMYWJlbD86IHN0cmluZztcbiAgICBoYXNBdmF0YXJMYWJlbD86IHN0cmluZztcbiAgICBzZXRBdmF0YXJVcmwodXJsOiBzdHJpbmcpOiBQcm9taXNlPHVua25vd24+O1xufVxuXG5jb25zdCBNaW5pQXZhdGFyVXBsb2FkZXI6IFJlYWN0LkZDPElQcm9wcz4gPSAoeyBoYXNBdmF0YXIsIGhhc0F2YXRhckxhYmVsLCBub0F2YXRhckxhYmVsLCBzZXRBdmF0YXJVcmwsIGNoaWxkcmVuIH0pID0+IHtcbiAgICBjb25zdCBjbGkgPSB1c2VDb250ZXh0KE1hdHJpeENsaWVudENvbnRleHQpO1xuICAgIGNvbnN0IFtidXN5LCBzZXRCdXN5XSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgICBjb25zdCBbaG92ZXIsIHNldEhvdmVyXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgICBjb25zdCBbc2hvdywgc2V0U2hvd10gPSB1c2VTdGF0ZShmYWxzZSk7XG5cbiAgICB1c2VUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgc2V0U2hvdyh0cnVlKTtcbiAgICB9LCAzMDAwKTsgLy8gc2hvdyBhZnRlciAzIHNlY29uZHNcbiAgICB1c2VUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgc2V0U2hvdyhmYWxzZSk7XG4gICAgfSwgMTMwMDApOyAvLyBoaWRlIGFmdGVyIGJlaW5nIHNob3duIGZvciAxMCBzZWNvbmRzXG5cbiAgICBjb25zdCB1cGxvYWRSZWYgPSB1c2VSZWY8SFRNTElucHV0RWxlbWVudD4oKTtcblxuICAgIGNvbnN0IGxhYmVsID0gKGhhc0F2YXRhciB8fCBidXN5KSA/IGhhc0F2YXRhckxhYmVsIDogbm9BdmF0YXJMYWJlbDtcblxuICAgIGNvbnN0IHsgcm9vbSB9ID0gdXNlQ29udGV4dChSb29tQ29udGV4dCk7XG4gICAgY29uc3QgY2FuU2V0QXZhdGFyID0gcm9vbT8uY3VycmVudFN0YXRlLm1heVNlbmRTdGF0ZUV2ZW50KEV2ZW50VHlwZS5Sb29tQXZhdGFyLCBjbGkuZ2V0VXNlcklkKCkpO1xuICAgIGlmICghY2FuU2V0QXZhdGFyKSByZXR1cm4gPFJlYWN0LkZyYWdtZW50PnsgY2hpbGRyZW4gfTwvUmVhY3QuRnJhZ21lbnQ+O1xuXG4gICAgY29uc3QgdmlzaWJsZSA9ICEhbGFiZWwgJiYgKGhvdmVyIHx8IHNob3cpO1xuICAgIHJldHVybiA8UmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgdHlwZT1cImZpbGVcIlxuICAgICAgICAgICAgcmVmPXt1cGxvYWRSZWZ9XG4gICAgICAgICAgICBjbGFzc05hbWU9XCJteF9NaW5pQXZhdGFyVXBsb2FkZXJfaW5wdXRcIlxuICAgICAgICAgICAgb25DaGFuZ2U9e2FzeW5jIChldikgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghZXYudGFyZ2V0LmZpbGVzPy5sZW5ndGgpIHJldHVybjtcbiAgICAgICAgICAgICAgICBzZXRCdXN5KHRydWUpO1xuICAgICAgICAgICAgICAgIEFuYWx5dGljcy50cmFja0V2ZW50KFwibWluaV9hdmF0YXJcIiwgXCJ1cGxvYWRcIik7XG4gICAgICAgICAgICAgICAgQ291bnRseUFuYWx5dGljcy5pbnN0YW5jZS50cmFjayhcIm1pbmlfYXZhdGFyX3VwbG9hZFwiKTtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gZXYudGFyZ2V0LmZpbGVzWzBdO1xuICAgICAgICAgICAgICAgIGNvbnN0IHVyaSA9IGF3YWl0IGNsaS51cGxvYWRDb250ZW50KGZpbGUpO1xuICAgICAgICAgICAgICAgIGF3YWl0IHNldEF2YXRhclVybCh1cmkpO1xuICAgICAgICAgICAgICAgIHNldEJ1c3koZmFsc2UpO1xuICAgICAgICAgICAgfX1cbiAgICAgICAgICAgIGFjY2VwdD1cImltYWdlLypcIlxuICAgICAgICAvPlxuXG4gICAgICAgIDxBY2Nlc3NpYmxlQnV0dG9uXG4gICAgICAgICAgICBjbGFzc05hbWU9e2NsYXNzTmFtZXMoXCJteF9NaW5pQXZhdGFyVXBsb2FkZXJcIiwge1xuICAgICAgICAgICAgICAgIG14X01pbmlBdmF0YXJVcGxvYWRlcl9idXN5OiBidXN5LFxuICAgICAgICAgICAgICAgIG14X01pbmlBdmF0YXJVcGxvYWRlcl9oYXNBdmF0YXI6IGhhc0F2YXRhcixcbiAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgZGlzYWJsZWQ9e2J1c3l9XG4gICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB7XG4gICAgICAgICAgICAgICAgdXBsb2FkUmVmLmN1cnJlbnQuY2xpY2soKTtcbiAgICAgICAgICAgIH19XG4gICAgICAgICAgICBvbk1vdXNlT3Zlcj17KCkgPT4gc2V0SG92ZXIodHJ1ZSl9XG4gICAgICAgICAgICBvbk1vdXNlTGVhdmU9eygpID0+IHNldEhvdmVyKGZhbHNlKX1cbiAgICAgICAgPlxuICAgICAgICAgICAgeyBjaGlsZHJlbiB9XG5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfTWluaUF2YXRhclVwbG9hZGVyX2luZGljYXRvclwiPlxuICAgICAgICAgICAgICAgIHsgYnVzeSA/XG4gICAgICAgICAgICAgICAgICAgIDxTcGlubmVyIHc9ezIwfSBoPXsyMH0gLz4gOlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X01pbmlBdmF0YXJVcGxvYWRlcl9jYW1lcmFJY29uXCIgLz4gfVxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtjbGFzc05hbWVzKFwibXhfVG9vbHRpcFwiLCB7XG4gICAgICAgICAgICAgICAgXCJteF9Ub29sdGlwX3Zpc2libGVcIjogdmlzaWJsZSxcbiAgICAgICAgICAgICAgICBcIm14X1Rvb2x0aXBfaW52aXNpYmxlXCI6ICF2aXNpYmxlLFxuICAgICAgICAgICAgfSl9PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfVG9vbHRpcF9jaGV2cm9uXCIgLz5cbiAgICAgICAgICAgICAgICB7IGxhYmVsIH1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L0FjY2Vzc2libGVCdXR0b24+XG4gICAgPC9SZWFjdC5GcmFnbWVudD47XG59O1xuXG5leHBvcnQgZGVmYXVsdCBNaW5pQXZhdGFyVXBsb2FkZXI7XG4iXX0=