"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireDefault(require("react"));

var _SettingsStore = _interopRequireDefault(require("../../../settings/SettingsStore"));

var _languageHandler = require("../../../languageHandler");

var _ToggleSwitch = _interopRequireDefault(require("./ToggleSwitch"));

var _StyledCheckbox = _interopRequireDefault(require("./StyledCheckbox"));

var _replaceableComponent = require("../../../utils/replaceableComponent");

var _dec, _class;

let SettingsFlag = (_dec = (0, _replaceableComponent.replaceableComponent)("views.elements.SettingsFlag"), _dec(_class = class SettingsFlag extends _react.default.Component {
  constructor(props) {
    super(props);
    (0, _defineProperty2.default)(this, "onChange", async checked => {
      await this.save(checked);
      this.setState({
        value: checked
      });
      if (this.props.onChange) this.props.onChange(checked);
    });
    (0, _defineProperty2.default)(this, "checkBoxOnChange", e => {
      this.onChange(e.target.checked);
    });
    (0, _defineProperty2.default)(this, "save", async val => {
      await _SettingsStore.default.setValue(this.props.name, this.props.roomId, this.props.level, val !== undefined ? val : this.state.value);
    });
    this.state = {
      value: _SettingsStore.default.getValueAt(this.props.level, this.props.name, this.props.roomId, this.props.isExplicit)
    };
  }

  render() {
    const canChange = _SettingsStore.default.canSetValue(this.props.name, this.props.roomId, this.props.level);

    const label = this.props.label ? (0, _languageHandler._t)(this.props.label) : _SettingsStore.default.getDisplayName(this.props.name, this.props.level);

    const description = _SettingsStore.default.getDescription(this.props.name);

    if (this.props.useCheckbox) {
      return /*#__PURE__*/_react.default.createElement(_StyledCheckbox.default, {
        checked: this.state.value,
        onChange: this.checkBoxOnChange,
        disabled: this.props.disabled || !canChange
      }, label);
    } else {
      return /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_SettingsFlag"
      }, /*#__PURE__*/_react.default.createElement("span", {
        className: "mx_SettingsFlag_label"
      }, label), /*#__PURE__*/_react.default.createElement(_ToggleSwitch.default, {
        checked: this.state.value,
        onChange: this.onChange,
        disabled: this.props.disabled || !canChange,
        "aria-label": label
      }), description && /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_SettingsFlag_microcopy"
      }, description));
    }
  }

}) || _class);
exports.default = SettingsFlag;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZpZXdzL2VsZW1lbnRzL1NldHRpbmdzRmxhZy50c3giXSwibmFtZXMiOlsiU2V0dGluZ3NGbGFnIiwiUmVhY3QiLCJDb21wb25lbnQiLCJjb25zdHJ1Y3RvciIsInByb3BzIiwiY2hlY2tlZCIsInNhdmUiLCJzZXRTdGF0ZSIsInZhbHVlIiwib25DaGFuZ2UiLCJlIiwidGFyZ2V0IiwidmFsIiwiU2V0dGluZ3NTdG9yZSIsInNldFZhbHVlIiwibmFtZSIsInJvb21JZCIsImxldmVsIiwidW5kZWZpbmVkIiwic3RhdGUiLCJnZXRWYWx1ZUF0IiwiaXNFeHBsaWNpdCIsInJlbmRlciIsImNhbkNoYW5nZSIsImNhblNldFZhbHVlIiwibGFiZWwiLCJnZXREaXNwbGF5TmFtZSIsImRlc2NyaXB0aW9uIiwiZ2V0RGVzY3JpcHRpb24iLCJ1c2VDaGVja2JveCIsImNoZWNrQm94T25DaGFuZ2UiLCJkaXNhYmxlZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFpQkE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7Ozs7SUFvQnFCQSxZLFdBRHBCLGdEQUFxQiw2QkFBckIsQyxnQkFBRCxNQUNxQkEsWUFEckIsU0FDMENDLGVBQU1DLFNBRGhELENBQzBFO0FBQ3RFQyxFQUFBQSxXQUFXLENBQUNDLEtBQUQsRUFBZ0I7QUFDdkIsVUFBTUEsS0FBTjtBQUR1QixvREFhUixNQUFPQyxPQUFQLElBQTRCO0FBQzNDLFlBQU0sS0FBS0MsSUFBTCxDQUFVRCxPQUFWLENBQU47QUFDQSxXQUFLRSxRQUFMLENBQWM7QUFBRUMsUUFBQUEsS0FBSyxFQUFFSDtBQUFULE9BQWQ7QUFDQSxVQUFJLEtBQUtELEtBQUwsQ0FBV0ssUUFBZixFQUF5QixLQUFLTCxLQUFMLENBQVdLLFFBQVgsQ0FBb0JKLE9BQXBCO0FBQzVCLEtBakIwQjtBQUFBLDREQW1CQ0ssQ0FBRCxJQUE0QztBQUNuRSxXQUFLRCxRQUFMLENBQWNDLENBQUMsQ0FBQ0MsTUFBRixDQUFTTixPQUF2QjtBQUNILEtBckIwQjtBQUFBLGdEQXVCWixNQUFPTyxHQUFQLElBQXlCO0FBQ3BDLFlBQU1DLHVCQUFjQyxRQUFkLENBQ0YsS0FBS1YsS0FBTCxDQUFXVyxJQURULEVBRUYsS0FBS1gsS0FBTCxDQUFXWSxNQUZULEVBR0YsS0FBS1osS0FBTCxDQUFXYSxLQUhULEVBSUZMLEdBQUcsS0FBS00sU0FBUixHQUFvQk4sR0FBcEIsR0FBMEIsS0FBS08sS0FBTCxDQUFXWCxLQUpuQyxDQUFOO0FBTUgsS0E5QjBCO0FBR3ZCLFNBQUtXLEtBQUwsR0FBYTtBQUNUWCxNQUFBQSxLQUFLLEVBQUVLLHVCQUFjTyxVQUFkLENBQ0gsS0FBS2hCLEtBQUwsQ0FBV2EsS0FEUixFQUVILEtBQUtiLEtBQUwsQ0FBV1csSUFGUixFQUdILEtBQUtYLEtBQUwsQ0FBV1ksTUFIUixFQUlILEtBQUtaLEtBQUwsQ0FBV2lCLFVBSlI7QUFERSxLQUFiO0FBUUg7O0FBcUJNQyxFQUFBQSxNQUFNLEdBQUc7QUFDWixVQUFNQyxTQUFTLEdBQUdWLHVCQUFjVyxXQUFkLENBQTBCLEtBQUtwQixLQUFMLENBQVdXLElBQXJDLEVBQTJDLEtBQUtYLEtBQUwsQ0FBV1ksTUFBdEQsRUFBOEQsS0FBS1osS0FBTCxDQUFXYSxLQUF6RSxDQUFsQjs7QUFFQSxVQUFNUSxLQUFLLEdBQUcsS0FBS3JCLEtBQUwsQ0FBV3FCLEtBQVgsR0FDUix5QkFBRyxLQUFLckIsS0FBTCxDQUFXcUIsS0FBZCxDQURRLEdBRVJaLHVCQUFjYSxjQUFkLENBQTZCLEtBQUt0QixLQUFMLENBQVdXLElBQXhDLEVBQThDLEtBQUtYLEtBQUwsQ0FBV2EsS0FBekQsQ0FGTjs7QUFHQSxVQUFNVSxXQUFXLEdBQUdkLHVCQUFjZSxjQUFkLENBQTZCLEtBQUt4QixLQUFMLENBQVdXLElBQXhDLENBQXBCOztBQUVBLFFBQUksS0FBS1gsS0FBTCxDQUFXeUIsV0FBZixFQUE0QjtBQUN4QiwwQkFBTyw2QkFBQyx1QkFBRDtBQUNILFFBQUEsT0FBTyxFQUFFLEtBQUtWLEtBQUwsQ0FBV1gsS0FEakI7QUFFSCxRQUFBLFFBQVEsRUFBRSxLQUFLc0IsZ0JBRlo7QUFHSCxRQUFBLFFBQVEsRUFBRSxLQUFLMUIsS0FBTCxDQUFXMkIsUUFBWCxJQUF1QixDQUFDUjtBQUgvQixTQUtERSxLQUxDLENBQVA7QUFPSCxLQVJELE1BUU87QUFDSCwwQkFDSTtBQUFLLFFBQUEsU0FBUyxFQUFDO0FBQWYsc0JBQ0k7QUFBTSxRQUFBLFNBQVMsRUFBQztBQUFoQixTQUEwQ0EsS0FBMUMsQ0FESixlQUVJLDZCQUFDLHFCQUFEO0FBQ0ksUUFBQSxPQUFPLEVBQUUsS0FBS04sS0FBTCxDQUFXWCxLQUR4QjtBQUVJLFFBQUEsUUFBUSxFQUFFLEtBQUtDLFFBRm5CO0FBR0ksUUFBQSxRQUFRLEVBQUUsS0FBS0wsS0FBTCxDQUFXMkIsUUFBWCxJQUF1QixDQUFDUixTQUh0QztBQUlJLHNCQUFZRTtBQUpoQixRQUZKLEVBUU1FLFdBQVcsaUJBQUk7QUFBSyxRQUFBLFNBQVMsRUFBQztBQUFmLFNBQ1hBLFdBRFcsQ0FSckIsQ0FESjtBQWNIO0FBQ0o7O0FBakVxRSxDIiwic291cmNlc0NvbnRlbnQiOlsiLypcbkNvcHlyaWdodCAyMDE3IFRyYXZpcyBSYWxzdG9uXG5Db3B5cmlnaHQgMjAxOSBUaGUgTWF0cml4Lm9yZyBGb3VuZGF0aW9uIEMuSS5DLlxuXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xueW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG5cbiAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcblxuVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG5TZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG5saW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiovXG5cbmltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCBTZXR0aW5nc1N0b3JlIGZyb20gXCIuLi8uLi8uLi9zZXR0aW5ncy9TZXR0aW5nc1N0b3JlXCI7XG5pbXBvcnQgeyBfdCB9IGZyb20gJy4uLy4uLy4uL2xhbmd1YWdlSGFuZGxlcic7XG5pbXBvcnQgVG9nZ2xlU3dpdGNoIGZyb20gXCIuL1RvZ2dsZVN3aXRjaFwiO1xuaW1wb3J0IFN0eWxlZENoZWNrYm94IGZyb20gXCIuL1N0eWxlZENoZWNrYm94XCI7XG5pbXBvcnQgeyBTZXR0aW5nTGV2ZWwgfSBmcm9tIFwiLi4vLi4vLi4vc2V0dGluZ3MvU2V0dGluZ0xldmVsXCI7XG5pbXBvcnQgeyByZXBsYWNlYWJsZUNvbXBvbmVudCB9IGZyb20gXCIuLi8uLi8uLi91dGlscy9yZXBsYWNlYWJsZUNvbXBvbmVudFwiO1xuXG5pbnRlcmZhY2UgSVByb3BzIHtcbiAgICAvLyBUaGUgc2V0dGluZyBtdXN0IGJlIGEgYm9vbGVhblxuICAgIG5hbWU6IHN0cmluZztcbiAgICBsZXZlbDogU2V0dGluZ0xldmVsO1xuICAgIHJvb21JZD86IHN0cmluZzsgLy8gZm9yIHBlci1yb29tIHNldHRpbmdzXG4gICAgbGFiZWw/OiBzdHJpbmc7IC8vIHVudHJhbnNsYXRlZFxuICAgIGlzRXhwbGljaXQ/OiBib29sZWFuO1xuICAgIC8vIFhYWDogb25jZSBkZXNpZ24gcmVwbGFjZXMgYWxsIHRvZ2dsZXMgbWFrZSB0aGlzIHRoZSBkZWZhdWx0XG4gICAgdXNlQ2hlY2tib3g/OiBib29sZWFuO1xuICAgIGRpc2FibGVkPzogYm9vbGVhbjtcbiAgICBvbkNoYW5nZT8oY2hlY2tlZDogYm9vbGVhbik6IHZvaWQ7XG59XG5cbmludGVyZmFjZSBJU3RhdGUge1xuICAgIHZhbHVlOiBib29sZWFuO1xufVxuXG5AcmVwbGFjZWFibGVDb21wb25lbnQoXCJ2aWV3cy5lbGVtZW50cy5TZXR0aW5nc0ZsYWdcIilcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNldHRpbmdzRmxhZyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxJUHJvcHMsIElTdGF0ZT4ge1xuICAgIGNvbnN0cnVjdG9yKHByb3BzOiBJUHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICB2YWx1ZTogU2V0dGluZ3NTdG9yZS5nZXRWYWx1ZUF0KFxuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMubGV2ZWwsXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5uYW1lLFxuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMucm9vbUlkLFxuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuaXNFeHBsaWNpdCxcbiAgICAgICAgICAgICksXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvbkNoYW5nZSA9IGFzeW5jIChjaGVja2VkOiBib29sZWFuKSA9PiB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZShjaGVja2VkKTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHZhbHVlOiBjaGVja2VkIH0pO1xuICAgICAgICBpZiAodGhpcy5wcm9wcy5vbkNoYW5nZSkgdGhpcy5wcm9wcy5vbkNoYW5nZShjaGVja2VkKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjaGVja0JveE9uQ2hhbmdlID0gKGU6IFJlYWN0LkNoYW5nZUV2ZW50PEhUTUxJbnB1dEVsZW1lbnQ+KSA9PiB7XG4gICAgICAgIHRoaXMub25DaGFuZ2UoZS50YXJnZXQuY2hlY2tlZCk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgc2F2ZSA9IGFzeW5jICh2YWw/OiBib29sZWFuKSA9PiB7XG4gICAgICAgIGF3YWl0IFNldHRpbmdzU3RvcmUuc2V0VmFsdWUoXG4gICAgICAgICAgICB0aGlzLnByb3BzLm5hbWUsXG4gICAgICAgICAgICB0aGlzLnByb3BzLnJvb21JZCxcbiAgICAgICAgICAgIHRoaXMucHJvcHMubGV2ZWwsXG4gICAgICAgICAgICB2YWwgIT09IHVuZGVmaW5lZCA/IHZhbCA6IHRoaXMuc3RhdGUudmFsdWUsXG4gICAgICAgICk7XG4gICAgfTtcblxuICAgIHB1YmxpYyByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IGNhbkNoYW5nZSA9IFNldHRpbmdzU3RvcmUuY2FuU2V0VmFsdWUodGhpcy5wcm9wcy5uYW1lLCB0aGlzLnByb3BzLnJvb21JZCwgdGhpcy5wcm9wcy5sZXZlbCk7XG5cbiAgICAgICAgY29uc3QgbGFiZWwgPSB0aGlzLnByb3BzLmxhYmVsXG4gICAgICAgICAgICA/IF90KHRoaXMucHJvcHMubGFiZWwpXG4gICAgICAgICAgICA6IFNldHRpbmdzU3RvcmUuZ2V0RGlzcGxheU5hbWUodGhpcy5wcm9wcy5uYW1lLCB0aGlzLnByb3BzLmxldmVsKTtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSBTZXR0aW5nc1N0b3JlLmdldERlc2NyaXB0aW9uKHRoaXMucHJvcHMubmFtZSk7XG5cbiAgICAgICAgaWYgKHRoaXMucHJvcHMudXNlQ2hlY2tib3gpIHtcbiAgICAgICAgICAgIHJldHVybiA8U3R5bGVkQ2hlY2tib3hcbiAgICAgICAgICAgICAgICBjaGVja2VkPXt0aGlzLnN0YXRlLnZhbHVlfVxuICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLmNoZWNrQm94T25DaGFuZ2V9XG4gICAgICAgICAgICAgICAgZGlzYWJsZWQ9e3RoaXMucHJvcHMuZGlzYWJsZWQgfHwgIWNhbkNoYW5nZX1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7IGxhYmVsIH1cbiAgICAgICAgICAgIDwvU3R5bGVkQ2hlY2tib3g+O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X1NldHRpbmdzRmxhZ1wiPlxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJteF9TZXR0aW5nc0ZsYWdfbGFiZWxcIj57IGxhYmVsIH08L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgIDxUb2dnbGVTd2l0Y2hcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e3RoaXMuc3RhdGUudmFsdWV9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkNoYW5nZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXt0aGlzLnByb3BzLmRpc2FibGVkIHx8ICFjYW5DaGFuZ2V9XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmlhLWxhYmVsPXtsYWJlbH1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgeyBkZXNjcmlwdGlvbiAmJiA8ZGl2IGNsYXNzTmFtZT1cIm14X1NldHRpbmdzRmxhZ19taWNyb2NvcHlcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHsgZGVzY3JpcHRpb24gfVxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj4gfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiJdfQ==