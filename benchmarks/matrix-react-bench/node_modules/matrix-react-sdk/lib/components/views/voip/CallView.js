"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireWildcard(require("react"));

var _dispatcher = _interopRequireDefault(require("../../../dispatcher/dispatcher"));

var _CallHandler = _interopRequireDefault(require("../../../CallHandler"));

var _MatrixClientPeg = require("../../../MatrixClientPeg");

var _languageHandler = require("../../../languageHandler");

var _VideoFeed = _interopRequireDefault(require("./VideoFeed"));

var _RoomAvatar = _interopRequireDefault(require("../avatars/RoomAvatar"));

var _call = require("matrix-js-sdk/src/webrtc/call");

var _classnames = _interopRequireDefault(require("classnames"));

var _AccessibleButton = _interopRequireDefault(require("../elements/AccessibleButton"));

var _Keyboard = require("../../../Keyboard");

var _Avatar = require("../../../Avatar");

var _replaceableComponent = require("../../../utils/replaceableComponent");

var _DesktopCapturerSourcePicker = _interopRequireDefault(require("../elements/DesktopCapturerSourcePicker"));

var _Modal = _interopRequireDefault(require("../../../Modal"));

var _callEventTypes = require("matrix-js-sdk/src/webrtc/callEventTypes");

var _CallViewSidebar = _interopRequireDefault(require("./CallViewSidebar"));

var _CallViewHeader = _interopRequireDefault(require("./CallView/CallViewHeader"));

var _CallViewButtons = _interopRequireDefault(require("./CallView/CallViewButtons"));

var _dec, _class;

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function getFullScreenElement() {
  return document.fullscreenElement || // moz omitted because firefox supports this unprefixed now (webkit here for safari)
  document.webkitFullscreenElement || document.msFullscreenElement;
}

function requestFullscreen(element) {
  const method = element.requestFullscreen || // moz omitted since firefox supports unprefixed now
  element.webkitRequestFullScreen || element.msRequestFullscreen;
  if (method) method.call(element);
}

function exitFullscreen() {
  const exitMethod = document.exitFullscreen || document.webkitExitFullscreen || document.msExitFullscreen;
  if (exitMethod) exitMethod.call(document);
}

let CallView = (_dec = (0, _replaceableComponent.replaceableComponent)("views.voip.CallView"), _dec(_class = class CallView extends _react.default.Component {
  constructor(props) {
    super(props);
    (0, _defineProperty2.default)(this, "dispatcherRef", void 0);
    (0, _defineProperty2.default)(this, "contentRef", /*#__PURE__*/(0, _react.createRef)());
    (0, _defineProperty2.default)(this, "buttonsRef", /*#__PURE__*/(0, _react.createRef)());
    (0, _defineProperty2.default)(this, "onAction", payload => {
      switch (payload.action) {
        case 'video_fullscreen':
          {
            if (!this.contentRef.current) {
              return;
            }

            if (payload.fullscreen) {
              requestFullscreen(this.contentRef.current);
            } else if (getFullScreenElement()) {
              exitFullscreen();
            }

            break;
          }
      }
    });
    (0, _defineProperty2.default)(this, "onCallState", state => {
      this.setState({
        callState: state
      });
    });
    (0, _defineProperty2.default)(this, "onFeedsChanged", newFeeds => {
      const {
        primary,
        secondary
      } = CallView.getOrderedFeeds(newFeeds);
      this.setState({
        primaryFeed: primary,
        secondaryFeeds: secondary,
        micMuted: this.props.call.isMicrophoneMuted(),
        vidMuted: this.props.call.isLocalVideoMuted()
      });
    });
    (0, _defineProperty2.default)(this, "onCallLocalHoldUnhold", () => {
      this.setState({
        isLocalOnHold: this.props.call.isLocalOnHold()
      });
    });
    (0, _defineProperty2.default)(this, "onCallRemoteHoldUnhold", () => {
      this.setState({
        isRemoteOnHold: this.props.call.isRemoteOnHold(),
        // update both here because isLocalOnHold changes when we hold the call too
        isLocalOnHold: this.props.call.isLocalOnHold()
      });
    });
    (0, _defineProperty2.default)(this, "onMouseMove", () => {
      var _this$buttonsRef$curr;

      (_this$buttonsRef$curr = this.buttonsRef.current) === null || _this$buttonsRef$curr === void 0 ? void 0 : _this$buttonsRef$curr.showControls();
    });
    (0, _defineProperty2.default)(this, "onMicMuteClick", async () => {
      const newVal = !this.state.micMuted;
      this.setState({
        micMuted: await this.props.call.setMicrophoneMuted(newVal)
      });
    });
    (0, _defineProperty2.default)(this, "onVidMuteClick", async () => {
      const newVal = !this.state.vidMuted;
      this.setState({
        vidMuted: await this.props.call.setLocalVideoMuted(newVal)
      });
    });
    (0, _defineProperty2.default)(this, "onScreenshareClick", async () => {
      let isScreensharing;

      if (this.state.screensharing) {
        isScreensharing = await this.props.call.setScreensharingEnabled(false);
      } else {
        var _window$electron;

        if ((_window$electron = window.electron) !== null && _window$electron !== void 0 && _window$electron.getDesktopCapturerSources) {
          const {
            finished
          } = _Modal.default.createDialog(_DesktopCapturerSourcePicker.default);

          const [source] = await finished;
          if (!source) return;
          isScreensharing = await this.props.call.setScreensharingEnabled(true, source);
        } else {
          isScreensharing = await this.props.call.setScreensharingEnabled(true);
        }
      }

      this.setState({
        sidebarShown: true,
        screensharing: isScreensharing
      });
    });
    (0, _defineProperty2.default)(this, "onNativeKeyDown", ev => {
      let handled = false;
      const ctrlCmdOnly = (0, _Keyboard.isOnlyCtrlOrCmdKeyEvent)(ev);

      switch (ev.key) {
        case _Keyboard.Key.D:
          if (ctrlCmdOnly) {
            var _this$buttonsRef$curr2;

            this.onMicMuteClick(); // show the controls to give feedback

            (_this$buttonsRef$curr2 = this.buttonsRef.current) === null || _this$buttonsRef$curr2 === void 0 ? void 0 : _this$buttonsRef$curr2.showControls();
            handled = true;
          }

          break;

        case _Keyboard.Key.E:
          if (ctrlCmdOnly) {
            var _this$buttonsRef$curr3;

            this.onVidMuteClick(); // show the controls to give feedback

            (_this$buttonsRef$curr3 = this.buttonsRef.current) === null || _this$buttonsRef$curr3 === void 0 ? void 0 : _this$buttonsRef$curr3.showControls();
            handled = true;
          }

          break;
      }

      if (handled) {
        ev.stopPropagation();
        ev.preventDefault();
      }
    });
    (0, _defineProperty2.default)(this, "onCallResumeClick", () => {
      const userFacingRoomId = _CallHandler.default.sharedInstance().roomIdForCall(this.props.call);

      _CallHandler.default.sharedInstance().setActiveCallRoomId(userFacingRoomId);
    });
    (0, _defineProperty2.default)(this, "onTransferClick", () => {
      const transfereeCall = _CallHandler.default.sharedInstance().getTransfereeForCallId(this.props.call.callId);

      this.props.call.transferToCall(transfereeCall);
    });
    (0, _defineProperty2.default)(this, "onHangupClick", () => {
      _dispatcher.default.dispatch({
        action: 'hangup',
        room_id: _CallHandler.default.sharedInstance().roomIdForCall(this.props.call)
      });
    });
    (0, _defineProperty2.default)(this, "onToggleSidebar", () => {
      this.setState({
        sidebarShown: !this.state.sidebarShown
      });
    });
    const {
      primary: _primary,
      secondary: _secondary
    } = CallView.getOrderedFeeds(this.props.call.getFeeds());
    this.state = {
      isLocalOnHold: this.props.call.isLocalOnHold(),
      isRemoteOnHold: this.props.call.isRemoteOnHold(),
      micMuted: this.props.call.isMicrophoneMuted(),
      vidMuted: this.props.call.isLocalVideoMuted(),
      screensharing: this.props.call.isScreensharing(),
      callState: this.props.call.state,
      controlsVisible: true,
      hoveringControls: false,
      showMoreMenu: false,
      showDialpad: false,
      primaryFeed: _primary,
      secondaryFeeds: _secondary,
      sidebarShown: true
    };
    this.updateCallListeners(null, this.props.call);
  }

  componentDidMount() {
    this.dispatcherRef = _dispatcher.default.register(this.onAction);
    document.addEventListener('keydown', this.onNativeKeyDown);
  }

  componentWillUnmount() {
    if (getFullScreenElement()) {
      exitFullscreen();
    }

    document.removeEventListener("keydown", this.onNativeKeyDown);
    this.updateCallListeners(this.props.call, null);

    _dispatcher.default.unregister(this.dispatcherRef);
  }

  static getDerivedStateFromProps(props) {
    const {
      primary,
      secondary
    } = CallView.getOrderedFeeds(props.call.getFeeds());
    return {
      primaryFeed: primary,
      secondaryFeeds: secondary
    };
  }

  componentDidUpdate(prevProps) {
    if (this.props.call === prevProps.call) return;
    this.setState({
      isLocalOnHold: this.props.call.isLocalOnHold(),
      isRemoteOnHold: this.props.call.isRemoteOnHold(),
      micMuted: this.props.call.isMicrophoneMuted(),
      vidMuted: this.props.call.isLocalVideoMuted(),
      callState: this.props.call.state
    });
    this.updateCallListeners(null, this.props.call);
  }

  updateCallListeners(oldCall, newCall) {
    if (oldCall === newCall) return;

    if (oldCall) {
      oldCall.removeListener(_call.CallEvent.State, this.onCallState);
      oldCall.removeListener(_call.CallEvent.LocalHoldUnhold, this.onCallLocalHoldUnhold);
      oldCall.removeListener(_call.CallEvent.RemoteHoldUnhold, this.onCallRemoteHoldUnhold);
      oldCall.removeListener(_call.CallEvent.FeedsChanged, this.onFeedsChanged);
    }

    if (newCall) {
      newCall.on(_call.CallEvent.State, this.onCallState);
      newCall.on(_call.CallEvent.LocalHoldUnhold, this.onCallLocalHoldUnhold);
      newCall.on(_call.CallEvent.RemoteHoldUnhold, this.onCallRemoteHoldUnhold);
      newCall.on(_call.CallEvent.FeedsChanged, this.onFeedsChanged);
    }
  }

  static getOrderedFeeds(feeds) {
    let primary; // Try to use a screensharing as primary, a remote one if possible

    const screensharingFeeds = feeds.filter(feed => feed.purpose === _callEventTypes.SDPStreamMetadataPurpose.Screenshare);
    primary = screensharingFeeds.find(feed => !feed.isLocal()) || screensharingFeeds[0]; // If we didn't find remote screen-sharing stream, try to find any remote stream

    if (!primary) {
      primary = feeds.find(feed => !feed.isLocal());
    }

    const secondary = [...feeds]; // Remove the primary feed from the array

    if (primary) secondary.splice(secondary.indexOf(primary), 1);
    secondary.sort((a, b) => {
      if (a.isLocal() && !b.isLocal()) return -1;
      if (!a.isLocal() && b.isLocal()) return 1;
      return 0;
    });
    return {
      primary,
      secondary
    };
  }

  renderCallControls() {
    var _this$state$primaryFe;

    // We don't support call upgrades (yet) so hide the video mute button in voice calls
    const vidMuteButtonShown = this.props.call.type === _call.CallType.Video; // Screensharing is possible, if we can send a second stream and
    // identify it using SDPStreamMetadata or if we can replace the already
    // existing usermedia track by a screensharing track. We also need to be
    // connected to know the state of the other side

    const screensharingButtonShown = (this.props.call.opponentSupportsSDPStreamMetadata() || this.props.call.type === _call.CallType.Video) && this.props.call.state === _call.CallState.Connected; // To show the sidebar we need secondary feeds, if we don't have them,
    // we can hide this button. If we are in PiP, sidebar is also hidden, so
    // we can hide the button too


    const sidebarButtonShown = ((_this$state$primaryFe = this.state.primaryFeed) === null || _this$state$primaryFe === void 0 ? void 0 : _this$state$primaryFe.purpose) === _callEventTypes.SDPStreamMetadataPurpose.Screenshare || this.props.call.isScreensharing(); // The dial pad & 'more' button actions are only relevant in a connected call

    const contextMenuButtonShown = this.state.callState === _call.CallState.Connected;
    const dialpadButtonShown = this.state.callState === _call.CallState.Connected && this.props.call.opponentSupportsDTMF();
    return /*#__PURE__*/_react.default.createElement(_CallViewButtons.default, {
      ref: this.buttonsRef,
      call: this.props.call,
      pipMode: this.props.pipMode,
      handlers: {
        onToggleSidebarClick: this.onToggleSidebar,
        onScreenshareClick: this.onScreenshareClick,
        onHangupClick: this.onHangupClick,
        onMicMuteClick: this.onMicMuteClick,
        onVidMuteClick: this.onVidMuteClick
      },
      buttonsState: {
        micMuted: this.state.micMuted,
        vidMuted: this.state.vidMuted,
        sidebarShown: this.state.sidebarShown,
        screensharing: this.state.screensharing
      },
      buttonsVisibility: {
        vidMute: vidMuteButtonShown,
        screensharing: screensharingButtonShown,
        sidebar: sidebarButtonShown,
        contextMenu: contextMenuButtonShown,
        dialpad: dialpadButtonShown
      }
    });
  }

  render() {
    const client = _MatrixClientPeg.MatrixClientPeg.get();

    const callRoomId = _CallHandler.default.sharedInstance().roomIdForCall(this.props.call);

    const secondaryCallRoomId = _CallHandler.default.sharedInstance().roomIdForCall(this.props.secondaryCall);

    const callRoom = client.getRoom(callRoomId);
    const secCallRoom = this.props.secondaryCall ? client.getRoom(secondaryCallRoomId) : null;
    const avatarSize = this.props.pipMode ? 76 : 160;

    const transfereeCall = _CallHandler.default.sharedInstance().getTransfereeForCallId(this.props.call.callId);

    const isOnHold = this.state.isLocalOnHold || this.state.isRemoteOnHold;
    const isScreensharing = this.props.call.isScreensharing();
    const sidebarShown = this.state.sidebarShown;
    const someoneIsScreensharing = this.props.call.getFeeds().some(feed => {
      return feed.purpose === _callEventTypes.SDPStreamMetadataPurpose.Screenshare;
    });
    const isVideoCall = this.props.call.type === _call.CallType.Video;
    let contentView;
    let holdTransferContent;

    if (transfereeCall) {
      const transferTargetRoom = _MatrixClientPeg.MatrixClientPeg.get().getRoom(_CallHandler.default.sharedInstance().roomIdForCall(this.props.call));

      const transferTargetName = transferTargetRoom ? transferTargetRoom.name : (0, _languageHandler._t)("unknown person");

      const transfereeRoom = _MatrixClientPeg.MatrixClientPeg.get().getRoom(_CallHandler.default.sharedInstance().roomIdForCall(transfereeCall));

      const transfereeName = transfereeRoom ? transfereeRoom.name : (0, _languageHandler._t)("unknown person");
      holdTransferContent = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_CallView_holdTransferContent"
      }, (0, _languageHandler._t)("Consulting with %(transferTarget)s. <a>Transfer to %(transferee)s</a>", {
        transferTarget: transferTargetName,
        transferee: transfereeName
      }, {
        a: sub => /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
          kind: "link",
          onClick: this.onTransferClick
        }, sub)
      }));
    } else if (isOnHold) {
      let onHoldText = null;

      if (this.state.isRemoteOnHold) {
        const holdString = _CallHandler.default.sharedInstance().hasAnyUnheldCall() ? (0, _languageHandler._td)("You held the call <a>Switch</a>") : (0, _languageHandler._td)("You held the call <a>Resume</a>");
        onHoldText = (0, _languageHandler._t)(holdString, {}, {
          a: sub => /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
            kind: "link",
            onClick: this.onCallResumeClick
          }, sub)
        });
      } else if (this.state.isLocalOnHold) {
        onHoldText = (0, _languageHandler._t)("%(peerName)s held the call", {
          peerName: this.props.call.getOpponentMember().name
        });
      }

      holdTransferContent = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_CallView_holdTransferContent"
      }, onHoldText);
    }

    let sidebar;

    if (!isOnHold && !transfereeCall && sidebarShown && (isVideoCall || someoneIsScreensharing)) {
      sidebar = /*#__PURE__*/_react.default.createElement(_CallViewSidebar.default, {
        feeds: this.state.secondaryFeeds,
        call: this.props.call,
        pipMode: this.props.pipMode
      });
    } // This is a bit messy. I can't see a reason to have two onHold/transfer screens


    if (isOnHold || transfereeCall) {
      if (isVideoCall) {
        const containerClasses = (0, _classnames.default)({
          mx_CallView_content: true,
          mx_CallView_video: true,
          mx_CallView_video_hold: isOnHold
        });
        let onHoldBackground = null;
        const backgroundStyle = {};
        const backgroundAvatarUrl = (0, _Avatar.avatarUrlForMember)( // is it worth getting the size of the div to pass here?
        this.props.call.getOpponentMember(), 1024, 1024, 'crop');
        backgroundStyle.backgroundImage = 'url(' + backgroundAvatarUrl + ')';
        onHoldBackground = /*#__PURE__*/_react.default.createElement("div", {
          className: "mx_CallView_video_holdBackground",
          style: backgroundStyle
        });
        contentView = /*#__PURE__*/_react.default.createElement("div", {
          className: containerClasses,
          ref: this.contentRef,
          onMouseMove: this.onMouseMove
        }, onHoldBackground, holdTransferContent, this.renderCallControls());
      } else {
        const classes = (0, _classnames.default)({
          mx_CallView_content: true,
          mx_CallView_voice: true,
          mx_CallView_voice_hold: isOnHold
        });
        contentView = /*#__PURE__*/_react.default.createElement("div", {
          className: classes,
          onMouseMove: this.onMouseMove
        }, /*#__PURE__*/_react.default.createElement("div", {
          className: "mx_CallView_voice_avatarsContainer"
        }, /*#__PURE__*/_react.default.createElement("div", {
          className: "mx_CallView_voice_avatarContainer",
          style: {
            width: avatarSize,
            height: avatarSize
          }
        }, /*#__PURE__*/_react.default.createElement(_RoomAvatar.default, {
          room: callRoom,
          height: avatarSize,
          width: avatarSize
        }))), holdTransferContent, this.renderCallControls());
      }
    } else if (this.props.call.noIncomingFeeds()) {
      // Here we're reusing the css classes from voice on hold, because
      // I am lazy. If this gets merged, the CallView might be subject
      // to change anyway - I might take an axe to this file in order to
      // try to get other things working
      const classes = (0, _classnames.default)({
        mx_CallView_content: true,
        mx_CallView_voice: true
      }); // Saying "Connecting" here isn't really true, but the best thing
      // I can come up with, but this might be subject to change as well

      contentView = /*#__PURE__*/_react.default.createElement("div", {
        className: classes,
        onMouseMove: this.onMouseMove,
        ref: this.contentRef
      }, sidebar, /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_CallView_voice_avatarsContainer"
      }, /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_CallView_voice_avatarContainer",
        style: {
          width: avatarSize,
          height: avatarSize
        }
      }, /*#__PURE__*/_react.default.createElement(_RoomAvatar.default, {
        room: callRoom,
        height: avatarSize,
        width: avatarSize
      }))), /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_CallView_holdTransferContent"
      }, (0, _languageHandler._t)("Connecting")), this.renderCallControls());
    } else {
      const containerClasses = (0, _classnames.default)({
        mx_CallView_content: true,
        mx_CallView_video: true
      });
      let toast;

      if (someoneIsScreensharing) {
        const presentingClasses = (0, _classnames.default)({
          mx_CallView_presenting: true,
          mx_CallView_presenting_hidden: !this.state.controlsVisible
        });
        const sharerName = this.state.primaryFeed.getMember().name;
        let text = isScreensharing ? (0, _languageHandler._t)("You are presenting") : (0, _languageHandler._t)('%(sharerName)s is presenting', {
          sharerName
        });

        if (!this.state.sidebarShown && isVideoCall) {
          text += " • " + (this.props.call.isLocalVideoMuted() ? (0, _languageHandler._t)("Your camera is turned off") : (0, _languageHandler._t)("Your camera is still enabled"));
        }

        toast = /*#__PURE__*/_react.default.createElement("div", {
          className: presentingClasses
        }, text);
      }

      contentView = /*#__PURE__*/_react.default.createElement("div", {
        className: containerClasses,
        ref: this.contentRef,
        onMouseMove: this.onMouseMove
      }, toast, sidebar, /*#__PURE__*/_react.default.createElement(_VideoFeed.default, {
        feed: this.state.primaryFeed,
        call: this.props.call,
        pipMode: this.props.pipMode,
        onResize: this.props.onResize,
        primary: true
      }), this.renderCallControls());
    }

    const callViewClasses = (0, _classnames.default)({
      mx_CallView: true,
      mx_CallView_pip: this.props.pipMode,
      mx_CallView_large: !this.props.pipMode,
      mx_CallView_belowWidget: this.props.showApps // css to correct the margins if the call is below the AppsDrawer.

    });
    return /*#__PURE__*/_react.default.createElement("div", {
      className: callViewClasses
    }, /*#__PURE__*/_react.default.createElement(_CallViewHeader.default, {
      onPipMouseDown: this.props.onMouseDownOnHeader,
      pipMode: this.props.pipMode,
      type: this.props.call.type,
      callRooms: [callRoom, secCallRoom]
    }), contentView);
  }

}) || _class);
exports.default = CallView;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZpZXdzL3ZvaXAvQ2FsbFZpZXcudHN4Il0sIm5hbWVzIjpbImdldEZ1bGxTY3JlZW5FbGVtZW50IiwiZG9jdW1lbnQiLCJmdWxsc2NyZWVuRWxlbWVudCIsIndlYmtpdEZ1bGxzY3JlZW5FbGVtZW50IiwibXNGdWxsc2NyZWVuRWxlbWVudCIsInJlcXVlc3RGdWxsc2NyZWVuIiwiZWxlbWVudCIsIm1ldGhvZCIsIndlYmtpdFJlcXVlc3RGdWxsU2NyZWVuIiwibXNSZXF1ZXN0RnVsbHNjcmVlbiIsImNhbGwiLCJleGl0RnVsbHNjcmVlbiIsImV4aXRNZXRob2QiLCJ3ZWJraXRFeGl0RnVsbHNjcmVlbiIsIm1zRXhpdEZ1bGxzY3JlZW4iLCJDYWxsVmlldyIsIlJlYWN0IiwiQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJwcm9wcyIsInBheWxvYWQiLCJhY3Rpb24iLCJjb250ZW50UmVmIiwiY3VycmVudCIsImZ1bGxzY3JlZW4iLCJzdGF0ZSIsInNldFN0YXRlIiwiY2FsbFN0YXRlIiwibmV3RmVlZHMiLCJwcmltYXJ5Iiwic2Vjb25kYXJ5IiwiZ2V0T3JkZXJlZEZlZWRzIiwicHJpbWFyeUZlZWQiLCJzZWNvbmRhcnlGZWVkcyIsIm1pY011dGVkIiwiaXNNaWNyb3Bob25lTXV0ZWQiLCJ2aWRNdXRlZCIsImlzTG9jYWxWaWRlb011dGVkIiwiaXNMb2NhbE9uSG9sZCIsImlzUmVtb3RlT25Ib2xkIiwiYnV0dG9uc1JlZiIsInNob3dDb250cm9scyIsIm5ld1ZhbCIsInNldE1pY3JvcGhvbmVNdXRlZCIsInNldExvY2FsVmlkZW9NdXRlZCIsImlzU2NyZWVuc2hhcmluZyIsInNjcmVlbnNoYXJpbmciLCJzZXRTY3JlZW5zaGFyaW5nRW5hYmxlZCIsIndpbmRvdyIsImVsZWN0cm9uIiwiZ2V0RGVza3RvcENhcHR1cmVyU291cmNlcyIsImZpbmlzaGVkIiwiTW9kYWwiLCJjcmVhdGVEaWFsb2ciLCJEZXNrdG9wQ2FwdHVyZXJTb3VyY2VQaWNrZXIiLCJzb3VyY2UiLCJzaWRlYmFyU2hvd24iLCJldiIsImhhbmRsZWQiLCJjdHJsQ21kT25seSIsImtleSIsIktleSIsIkQiLCJvbk1pY011dGVDbGljayIsIkUiLCJvblZpZE11dGVDbGljayIsInN0b3BQcm9wYWdhdGlvbiIsInByZXZlbnREZWZhdWx0IiwidXNlckZhY2luZ1Jvb21JZCIsIkNhbGxIYW5kbGVyIiwic2hhcmVkSW5zdGFuY2UiLCJyb29tSWRGb3JDYWxsIiwic2V0QWN0aXZlQ2FsbFJvb21JZCIsInRyYW5zZmVyZWVDYWxsIiwiZ2V0VHJhbnNmZXJlZUZvckNhbGxJZCIsImNhbGxJZCIsInRyYW5zZmVyVG9DYWxsIiwiZGlzIiwiZGlzcGF0Y2giLCJyb29tX2lkIiwiZ2V0RmVlZHMiLCJjb250cm9sc1Zpc2libGUiLCJob3ZlcmluZ0NvbnRyb2xzIiwic2hvd01vcmVNZW51Iiwic2hvd0RpYWxwYWQiLCJ1cGRhdGVDYWxsTGlzdGVuZXJzIiwiY29tcG9uZW50RGlkTW91bnQiLCJkaXNwYXRjaGVyUmVmIiwicmVnaXN0ZXIiLCJvbkFjdGlvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJvbk5hdGl2ZUtleURvd24iLCJjb21wb25lbnRXaWxsVW5tb3VudCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJ1bnJlZ2lzdGVyIiwiZ2V0RGVyaXZlZFN0YXRlRnJvbVByb3BzIiwiY29tcG9uZW50RGlkVXBkYXRlIiwicHJldlByb3BzIiwib2xkQ2FsbCIsIm5ld0NhbGwiLCJyZW1vdmVMaXN0ZW5lciIsIkNhbGxFdmVudCIsIlN0YXRlIiwib25DYWxsU3RhdGUiLCJMb2NhbEhvbGRVbmhvbGQiLCJvbkNhbGxMb2NhbEhvbGRVbmhvbGQiLCJSZW1vdGVIb2xkVW5ob2xkIiwib25DYWxsUmVtb3RlSG9sZFVuaG9sZCIsIkZlZWRzQ2hhbmdlZCIsIm9uRmVlZHNDaGFuZ2VkIiwib24iLCJmZWVkcyIsInNjcmVlbnNoYXJpbmdGZWVkcyIsImZpbHRlciIsImZlZWQiLCJwdXJwb3NlIiwiU0RQU3RyZWFtTWV0YWRhdGFQdXJwb3NlIiwiU2NyZWVuc2hhcmUiLCJmaW5kIiwiaXNMb2NhbCIsInNwbGljZSIsImluZGV4T2YiLCJzb3J0IiwiYSIsImIiLCJyZW5kZXJDYWxsQ29udHJvbHMiLCJ2aWRNdXRlQnV0dG9uU2hvd24iLCJ0eXBlIiwiQ2FsbFR5cGUiLCJWaWRlbyIsInNjcmVlbnNoYXJpbmdCdXR0b25TaG93biIsIm9wcG9uZW50U3VwcG9ydHNTRFBTdHJlYW1NZXRhZGF0YSIsIkNhbGxTdGF0ZSIsIkNvbm5lY3RlZCIsInNpZGViYXJCdXR0b25TaG93biIsImNvbnRleHRNZW51QnV0dG9uU2hvd24iLCJkaWFscGFkQnV0dG9uU2hvd24iLCJvcHBvbmVudFN1cHBvcnRzRFRNRiIsInBpcE1vZGUiLCJvblRvZ2dsZVNpZGViYXJDbGljayIsIm9uVG9nZ2xlU2lkZWJhciIsIm9uU2NyZWVuc2hhcmVDbGljayIsIm9uSGFuZ3VwQ2xpY2siLCJ2aWRNdXRlIiwic2lkZWJhciIsImNvbnRleHRNZW51IiwiZGlhbHBhZCIsInJlbmRlciIsImNsaWVudCIsIk1hdHJpeENsaWVudFBlZyIsImdldCIsImNhbGxSb29tSWQiLCJzZWNvbmRhcnlDYWxsUm9vbUlkIiwic2Vjb25kYXJ5Q2FsbCIsImNhbGxSb29tIiwiZ2V0Um9vbSIsInNlY0NhbGxSb29tIiwiYXZhdGFyU2l6ZSIsImlzT25Ib2xkIiwic29tZW9uZUlzU2NyZWVuc2hhcmluZyIsInNvbWUiLCJpc1ZpZGVvQ2FsbCIsImNvbnRlbnRWaWV3IiwiaG9sZFRyYW5zZmVyQ29udGVudCIsInRyYW5zZmVyVGFyZ2V0Um9vbSIsInRyYW5zZmVyVGFyZ2V0TmFtZSIsIm5hbWUiLCJ0cmFuc2ZlcmVlUm9vbSIsInRyYW5zZmVyZWVOYW1lIiwidHJhbnNmZXJUYXJnZXQiLCJ0cmFuc2ZlcmVlIiwic3ViIiwib25UcmFuc2ZlckNsaWNrIiwib25Ib2xkVGV4dCIsImhvbGRTdHJpbmciLCJoYXNBbnlVbmhlbGRDYWxsIiwib25DYWxsUmVzdW1lQ2xpY2siLCJwZWVyTmFtZSIsImdldE9wcG9uZW50TWVtYmVyIiwiY29udGFpbmVyQ2xhc3NlcyIsIm14X0NhbGxWaWV3X2NvbnRlbnQiLCJteF9DYWxsVmlld192aWRlbyIsIm14X0NhbGxWaWV3X3ZpZGVvX2hvbGQiLCJvbkhvbGRCYWNrZ3JvdW5kIiwiYmFja2dyb3VuZFN0eWxlIiwiYmFja2dyb3VuZEF2YXRhclVybCIsImJhY2tncm91bmRJbWFnZSIsIm9uTW91c2VNb3ZlIiwiY2xhc3NlcyIsIm14X0NhbGxWaWV3X3ZvaWNlIiwibXhfQ2FsbFZpZXdfdm9pY2VfaG9sZCIsIndpZHRoIiwiaGVpZ2h0Iiwibm9JbmNvbWluZ0ZlZWRzIiwidG9hc3QiLCJwcmVzZW50aW5nQ2xhc3NlcyIsIm14X0NhbGxWaWV3X3ByZXNlbnRpbmciLCJteF9DYWxsVmlld19wcmVzZW50aW5nX2hpZGRlbiIsInNoYXJlck5hbWUiLCJnZXRNZW1iZXIiLCJ0ZXh0Iiwib25SZXNpemUiLCJjYWxsVmlld0NsYXNzZXMiLCJteF9DYWxsVmlldyIsIm14X0NhbGxWaWV3X3BpcCIsIm14X0NhbGxWaWV3X2xhcmdlIiwibXhfQ2FsbFZpZXdfYmVsb3dXaWRnZXQiLCJzaG93QXBwcyIsIm9uTW91c2VEb3duT25IZWFkZXIiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBa0JBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7Ozs7OztBQXlDQSxTQUFTQSxvQkFBVCxHQUFnQztBQUM1QixTQUNJQyxRQUFRLENBQUNDLGlCQUFULElBQ0E7QUFDQUQsRUFBQUEsUUFBUSxDQUFDRSx1QkFGVCxJQUdBRixRQUFRLENBQUNHLG1CQUpiO0FBTUg7O0FBRUQsU0FBU0MsaUJBQVQsQ0FBMkJDLE9BQTNCLEVBQTZDO0FBQ3pDLFFBQU1DLE1BQU0sR0FDUkQsT0FBTyxDQUFDRCxp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QWNNLEtBQUs1RSxrQkFBTCxFQWROLENBREo7QUFrQkg7O0FBRUQsVUFBTTZFLGVBQWUsR0FBRyx5QkFBVztBQUMvQkMsTUFBQUEsV0FBVyxFQUFFLElBRGtCO0FBRS9CQyxNQUFBQSxlQUFlLEVBQUUsS0FBS3pMLEtBQUwsQ0FBV3VILE9BRkc7QUFHL0JtRSxNQUFBQSxpQkFBaUIsRUFBRSxDQUFDLEtBQUsxTCxLQUFMLENBQVd1SCxPQUhBO0FBSS9Cb0UsTUFBQUEsdUJBQXVCLEVBQUUsS0FBSzNMLEtBQUwsQ0FBVzRMLFFBSkwsQ0FJZTs7QUFKZixLQUFYLENBQXhCO0FBT0Esd0JBQU87QUFBSyxNQUFBLFNBQVMsRUFBRUw7QUFBaEIsb0JBQ0gsNkJBQUMsdUJBQUQ7QUFDSSxNQUFBLGNBQWMsRUFBRSxLQUFLdkwsS0FBTCxDQUFXNkwsbUJBRC9CO0FBRUksTUFBQSxPQUFPLEVBQUUsS0FBSzdMLEtBQUwsQ0FBV3VILE9BRnhCO0FBR0ksTUFBQSxJQUFJLEVBQUUsS0FBS3ZILEtBQUwsQ0FBV1QsSUFBWCxDQUFnQnFILElBSDFCO0FBSUksTUFBQSxTQUFTLEVBQUUsQ0FBQzJCLFFBQUQsRUFBV0UsV0FBWDtBQUpmLE1BREcsRUFPRE0sV0FQQyxDQUFQO0FBU0g7O0FBL2dCaUUsQyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG5Db3B5cmlnaHQgMjAxNSwgMjAxNiBPcGVuTWFya2V0IEx0ZFxuQ29weXJpZ2h0IDIwMTkgLSAyMDIxIFRoZSBNYXRyaXgub3JnIEZvdW5kYXRpb24gQy5JLkMuXG5Db3B5cmlnaHQgMjAyMSDFoGltb24gQnJhbmRuZXIgPHNpbW9uLmJyYS5hZ0BnbWFpbC5jb20+XG5cbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG55b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG5Zb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcblxuICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuXG5Vbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG5kaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG5XSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cblNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbmxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuKi9cblxuaW1wb3J0IFJlYWN0LCB7IGNyZWF0ZVJlZiwgQ1NTUHJvcGVydGllcyB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBkaXMgZnJvbSAnLi4vLi4vLi4vZGlzcGF0Y2hlci9kaXNwYXRjaGVyJztcbmltcG9ydCBDYWxsSGFuZGxlciBmcm9tICcuLi8uLi8uLi9DYWxsSGFuZGxlcic7XG5pbXBvcnQgeyBNYXRyaXhDbGllbnRQZWcgfSBmcm9tICcuLi8uLi8uLi9NYXRyaXhDbGllbnRQZWcnO1xuaW1wb3J0IHsgX3QsIF90ZCB9IGZyb20gJy4uLy4uLy4uL2xhbmd1YWdlSGFuZGxlcic7XG5pbXBvcnQgVmlkZW9GZWVkIGZyb20gJy4vVmlkZW9GZWVkJztcbmltcG9ydCBSb29tQXZhdGFyIGZyb20gXCIuLi9hdmF0YXJzL1Jvb21BdmF0YXJcIjtcbmltcG9ydCB7IENhbGxFdmVudCwgQ2FsbFN0YXRlLCBDYWxsVHlwZSwgTWF0cml4Q2FsbCB9IGZyb20gJ21hdHJpeC1qcy1zZGsvc3JjL3dlYnJ0Yy9jYWxsJztcbmltcG9ydCBjbGFzc05hbWVzIGZyb20gJ2NsYXNzbmFtZXMnO1xuaW1wb3J0IEFjY2Vzc2libGVCdXR0b24gZnJvbSAnLi4vZWxlbWVudHMvQWNjZXNzaWJsZUJ1dHRvbic7XG5pbXBvcnQgeyBpc09ubHlDdHJsT3JDbWRLZXlFdmVudCwgS2V5IH0gZnJvbSAnLi4vLi4vLi4vS2V5Ym9hcmQnO1xuaW1wb3J0IHsgYXZhdGFyVXJsRm9yTWVtYmVyIH0gZnJvbSAnLi4vLi4vLi4vQXZhdGFyJztcbmltcG9ydCB7IENhbGxGZWVkIH0gZnJvbSAnbWF0cml4LWpzLXNkay9zcmMvd2VicnRjL2NhbGxGZWVkJztcbmltcG9ydCB7IHJlcGxhY2VhYmxlQ29tcG9uZW50IH0gZnJvbSBcIi4uLy4uLy4uL3V0aWxzL3JlcGxhY2VhYmxlQ29tcG9uZW50XCI7XG5pbXBvcnQgRGVza3RvcENhcHR1cmVyU291cmNlUGlja2VyIGZyb20gXCIuLi9lbGVtZW50cy9EZXNrdG9wQ2FwdHVyZXJTb3VyY2VQaWNrZXJcIjtcbmltcG9ydCBNb2RhbCBmcm9tICcuLi8uLi8uLi9Nb2RhbCc7XG5pbXBvcnQgeyBTRFBTdHJlYW1NZXRhZGF0YVB1cnBvc2UgfSBmcm9tICdtYXRyaXgtanMtc2RrL3NyYy93ZWJydGMvY2FsbEV2ZW50VHlwZXMnO1xuaW1wb3J0IENhbGxWaWV3U2lkZWJhciBmcm9tICcuL0NhbGxWaWV3U2lkZWJhcic7XG5pbXBvcnQgQ2FsbFZpZXdIZWFkZXIgZnJvbSAnLi9DYWxsVmlldy9DYWxsVmlld0hlYWRlcic7XG5pbXBvcnQgQ2FsbFZpZXdCdXR0b25zIGZyb20gXCIuL0NhbGxWaWV3L0NhbGxWaWV3QnV0dG9uc1wiO1xuXG5pbnRlcmZhY2UgSVByb3BzIHtcbiAgICAvLyBUaGUgY2FsbCBmb3IgdXMgdG8gZGlzcGxheVxuICAgIGNhbGw6IE1hdHJpeENhbGw7XG5cbiAgICAvLyBBbm90aGVyIG9uZ29pbmcgY2FsbCB0byBkaXNwbGF5IGluZm9ybWF0aW9uIGFib3V0XG4gICAgc2Vjb25kYXJ5Q2FsbD86IE1hdHJpeENhbGw7XG5cbiAgICAvLyBhIGNhbGxiYWNrIHdoaWNoIGlzIGNhbGxlZCB3aGVuIHRoZSBjb250ZW50IGluIHRoZSBDYWxsVmlldyBjaGFuZ2VzXG4gICAgLy8gaW4gYSB3YXkgdGhhdCBpcyBsaWtlbHkgdG8gY2F1c2UgYSByZXNpemUuXG4gICAgb25SZXNpemU/OiAoZXZlbnQ6IEV2ZW50KSA9PiB2b2lkO1xuXG4gICAgLy8gV2hldGhlciB0aGlzIGNhbGwgdmlldyBpcyBmb3IgcGljdHVyZS1pbi1waWN0dXJlIG1vZGVcbiAgICAvLyBvdGhlcndpc2UsIGl0J3MgdGhlIGxhcmdlciBjYWxsIHZpZXcgd2hlbiB2aWV3aW5nIHRoZSByb29tIHRoZSBjYWxsIGlzIGluLlxuICAgIC8vIFRoaXMgaXMgc29ydCBvZiBhIHByb3h5IGZvciBhIG51bWJlciBvZiB0aGluZ3MgYnV0IHdlIGN1cnJlbnRseSBoYXZlIG5vXG4gICAgLy8gbmVlZCB0byBjb250cm9sIHRob3NlIHRoaW5ncyBzZXBhcmF0ZWx5LCBzbyB0aGlzIGlzIHNpbXBsZXIuXG4gICAgcGlwTW9kZT86IGJvb2xlYW47XG5cbiAgICAvLyBVc2VkIGZvciBkcmFnZ2luZyB0aGUgUGlQIENhbGxWaWV3XG4gICAgb25Nb3VzZURvd25PbkhlYWRlcj86IChldmVudDogUmVhY3QuTW91c2VFdmVudDxFbGVtZW50LCBNb3VzZUV2ZW50PikgPT4gdm9pZDtcblxuICAgIHNob3dBcHBzPzogYm9vbGVhbjtcbn1cblxuaW50ZXJmYWNlIElTdGF0ZSB7XG4gICAgaXNMb2NhbE9uSG9sZDogYm9vbGVhbjtcbiAgICBpc1JlbW90ZU9uSG9sZDogYm9vbGVhbjtcbiAgICBtaWNNdXRlZDogYm9vbGVhbjtcbiAgICB2aWRNdXRlZDogYm9vbGVhbjtcbiAgICBzY3JlZW5zaGFyaW5nOiBib29sZWFuO1xuICAgIGNhbGxTdGF0ZTogQ2FsbFN0YXRlO1xuICAgIGNvbnRyb2xzVmlzaWJsZTogYm9vbGVhbjtcbiAgICBob3ZlcmluZ0NvbnRyb2xzOiBib29sZWFuO1xuICAgIHNob3dNb3JlTWVudTogYm9vbGVhbjtcbiAgICBzaG93RGlhbHBhZDogYm9vbGVhbjtcbiAgICBwcmltYXJ5RmVlZDogQ2FsbEZlZWQ7XG4gICAgc2Vjb25kYXJ5RmVlZHM6IEFycmF5PENhbGxGZWVkPjtcbiAgICBzaWRlYmFyU2hvd246IGJvb2xlYW47XG59XG5cbmZ1bmN0aW9uIGdldEZ1bGxTY3JlZW5FbGVtZW50KCkge1xuICAgIHJldHVybiAoXG4gICAgICAgIGRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50IHx8XG4gICAgICAgIC8vIG1veiBvbWl0dGVkIGJlY2F1c2UgZmlyZWZveCBzdXBwb3J0cyB0aGlzIHVucHJlZml4ZWQgbm93ICh3ZWJraXQgaGVyZSBmb3Igc2FmYXJpKVxuICAgICAgICBkb2N1bWVudC53ZWJraXRGdWxsc2NyZWVuRWxlbWVudCB8fFxuICAgICAgICBkb2N1bWVudC5tc0Z1bGxzY3JlZW5FbGVtZW50XG4gICAgKTtcbn1cblxuZnVuY3Rpb24gcmVxdWVzdEZ1bGxzY3JlZW4oZWxlbWVudDogRWxlbWVudCkge1xuICAgIGNvbnN0IG1ldGhvZCA9IChcbiAgICAgICAgZWxlbWVudC5yZXF1ZXN0RnVsbHNjcmVlbiB8fFxuICAgICAgICAvLyBtb3ogb21pdHRlZCBzaW5jZSBmaXJlZm94IHN1cHBvcnRzIHVucHJlZml4ZWQgbm93XG4gICAgICAgIGVsZW1lbnQud2Via2l0UmVxdWVzdEZ1bGxTY3JlZW4gfHxcbiAgICAgICAgZWxlbWVudC5tc1JlcXVlc3RGdWxsc2NyZWVuXG4gICAgKTtcbiAgICBpZiAobWV0aG9kKSBtZXRob2QuY2FsbChlbGVtZW50KTtcbn1cblxuZnVuY3Rpb24gZXhpdEZ1bGxzY3JlZW4oKSB7XG4gICAgY29uc3QgZXhpdE1ldGhvZCA9IChcbiAgICAgICAgZG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW4gfHxcbiAgICAgICAgZG9jdW1lbnQud2Via2l0RXhpdEZ1bGxzY3JlZW4gfHxcbiAgICAgICAgZG9jdW1lbnQubXNFeGl0RnVsbHNjcmVlblxuICAgICk7XG4gICAgaWYgKGV4aXRNZXRob2QpIGV4aXRNZXRob2QuY2FsbChkb2N1bWVudCk7XG59XG5cbkByZXBsYWNlYWJsZUNvbXBvbmVudChcInZpZXdzLnZvaXAuQ2FsbFZpZXdcIilcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhbGxWaWV3IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PElQcm9wcywgSVN0YXRlPiB7XG4gICAgcHJpdmF0ZSBkaXNwYXRjaGVyUmVmOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBjb250ZW50UmVmID0gY3JlYXRlUmVmPEhUTUxEaXZFbGVtZW50PigpO1xuICAgIHByaXZhdGUgYnV0dG9uc1JlZiA9IGNyZWF0ZVJlZjxDYWxsVmlld0J1dHRvbnM+KCk7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcm9wczogSVByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcblxuICAgICAgICBjb25zdCB7IHByaW1hcnksIHNlY29uZGFyeSB9ID0gQ2FsbFZpZXcuZ2V0T3JkZXJlZEZlZWRzKHRoaXMucHJvcHMuY2FsbC5nZXRGZWVkcygpKTtcblxuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgaXNMb2NhbE9uSG9sZDogdGhpcy5wcm9wcy5jYWxsLmlzTG9jYWxPbkhvbGQoKSxcbiAgICAgICAgICAgIGlzUmVtb3RlT25Ib2xkOiB0aGlzLnByb3BzLmNhbGwuaXNSZW1vdGVPbkhvbGQoKSxcbiAgICAgICAgICAgIG1pY011dGVkOiB0aGlzLnByb3BzLmNhbGwuaXNNaWNyb3Bob25lTXV0ZWQoKSxcbiAgICAgICAgICAgIHZpZE11dGVkOiB0aGlzLnByb3BzLmNhbGwuaXNMb2NhbFZpZGVvTXV0ZWQoKSxcbiAgICAgICAgICAgIHNjcmVlbnNoYXJpbmc6IHRoaXMucHJvcHMuY2FsbC5pc1NjcmVlbnNoYXJpbmcoKSxcbiAgICAgICAgICAgIGNhbGxTdGF0ZTogdGhpcy5wcm9wcy5jYWxsLnN0YXRlLFxuICAgICAgICAgICAgY29udHJvbHNWaXNpYmxlOiB0cnVlLFxuICAgICAgICAgICAgaG92ZXJpbmdDb250cm9sczogZmFsc2UsXG4gICAgICAgICAgICBzaG93TW9yZU1lbnU6IGZhbHNlLFxuICAgICAgICAgICAgc2hvd0RpYWxwYWQ6IGZhbHNlLFxuICAgICAgICAgICAgcHJpbWFyeUZlZWQ6IHByaW1hcnksXG4gICAgICAgICAgICBzZWNvbmRhcnlGZWVkczogc2Vjb25kYXJ5LFxuICAgICAgICAgICAgc2lkZWJhclNob3duOiB0cnVlLFxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMudXBkYXRlQ2FsbExpc3RlbmVycyhudWxsLCB0aGlzLnByb3BzLmNhbGwpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgICAgdGhpcy5kaXNwYXRjaGVyUmVmID0gZGlzLnJlZ2lzdGVyKHRoaXMub25BY3Rpb24pO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5vbk5hdGl2ZUtleURvd24pO1xuICAgIH1cblxuICAgIHB1YmxpYyBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICAgICAgaWYgKGdldEZ1bGxTY3JlZW5FbGVtZW50KCkpIHtcbiAgICAgICAgICAgIGV4aXRGdWxsc2NyZWVuKCk7XG4gICAgICAgIH1cblxuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLm9uTmF0aXZlS2V5RG93bik7XG4gICAgICAgIHRoaXMudXBkYXRlQ2FsbExpc3RlbmVycyh0aGlzLnByb3BzLmNhbGwsIG51bGwpO1xuICAgICAgICBkaXMudW5yZWdpc3Rlcih0aGlzLmRpc3BhdGNoZXJSZWYpO1xuICAgIH1cblxuICAgIHN0YXRpYyBnZXREZXJpdmVkU3RhdGVGcm9tUHJvcHMocHJvcHM6IElQcm9wcyk6IFBhcnRpYWw8SVN0YXRlPiB7XG4gICAgICAgIGNvbnN0IHsgcHJpbWFyeSwgc2Vjb25kYXJ5IH0gPSBDYWxsVmlldy5nZXRPcmRlcmVkRmVlZHMocHJvcHMuY2FsbC5nZXRGZWVkcygpKTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcHJpbWFyeUZlZWQ6IHByaW1hcnksXG4gICAgICAgICAgICBzZWNvbmRhcnlGZWVkczogc2Vjb25kYXJ5LFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHB1YmxpYyBjb21wb25lbnREaWRVcGRhdGUocHJldlByb3BzOiBJUHJvcHMpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMucHJvcHMuY2FsbCA9PT0gcHJldlByb3BzLmNhbGwpIHJldHVybjtcblxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGlzTG9jYWxPbkhvbGQ6IHRoaXMucHJvcHMuY2FsbC5pc0xvY2FsT25Ib2xkKCksXG4gICAgICAgICAgICBpc1JlbW90ZU9uSG9sZDogdGhpcy5wcm9wcy5jYWxsLmlzUmVtb3RlT25Ib2xkKCksXG4gICAgICAgICAgICBtaWNNdXRlZDogdGhpcy5wcm9wcy5jYWxsLmlzTWljcm9waG9uZU11dGVkKCksXG4gICAgICAgICAgICB2aWRNdXRlZDogdGhpcy5wcm9wcy5jYWxsLmlzTG9jYWxWaWRlb011dGVkKCksXG4gICAgICAgICAgICBjYWxsU3RhdGU6IHRoaXMucHJvcHMuY2FsbC5zdGF0ZSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy51cGRhdGVDYWxsTGlzdGVuZXJzKG51bGwsIHRoaXMucHJvcHMuY2FsbCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvbkFjdGlvbiA9IChwYXlsb2FkKSA9PiB7XG4gICAgICAgIHN3aXRjaCAocGF5bG9hZC5hY3Rpb24pIHtcbiAgICAgICAgICAgIGNhc2UgJ3ZpZGVvX2Z1bGxzY3JlZW4nOiB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNvbnRlbnRSZWYuY3VycmVudCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChwYXlsb2FkLmZ1bGxzY3JlZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdEZ1bGxzY3JlZW4odGhpcy5jb250ZW50UmVmLmN1cnJlbnQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZ2V0RnVsbFNjcmVlbkVsZW1lbnQoKSkge1xuICAgICAgICAgICAgICAgICAgICBleGl0RnVsbHNjcmVlbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwcml2YXRlIHVwZGF0ZUNhbGxMaXN0ZW5lcnMob2xkQ2FsbDogTWF0cml4Q2FsbCwgbmV3Q2FsbDogTWF0cml4Q2FsbCkge1xuICAgICAgICBpZiAob2xkQ2FsbCA9PT0gbmV3Q2FsbCkgcmV0dXJuO1xuXG4gICAgICAgIGlmIChvbGRDYWxsKSB7XG4gICAgICAgICAgICBvbGRDYWxsLnJlbW92ZUxpc3RlbmVyKENhbGxFdmVudC5TdGF0ZSwgdGhpcy5vbkNhbGxTdGF0ZSk7XG4gICAgICAgICAgICBvbGRDYWxsLnJlbW92ZUxpc3RlbmVyKENhbGxFdmVudC5Mb2NhbEhvbGRVbmhvbGQsIHRoaXMub25DYWxsTG9jYWxIb2xkVW5ob2xkKTtcbiAgICAgICAgICAgIG9sZENhbGwucmVtb3ZlTGlzdGVuZXIoQ2FsbEV2ZW50LlJlbW90ZUhvbGRVbmhvbGQsIHRoaXMub25DYWxsUmVtb3RlSG9sZFVuaG9sZCk7XG4gICAgICAgICAgICBvbGRDYWxsLnJlbW92ZUxpc3RlbmVyKENhbGxFdmVudC5GZWVkc0NoYW5nZWQsIHRoaXMub25GZWVkc0NoYW5nZWQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChuZXdDYWxsKSB7XG4gICAgICAgICAgICBuZXdDYWxsLm9uKENhbGxFdmVudC5TdGF0ZSwgdGhpcy5vbkNhbGxTdGF0ZSk7XG4gICAgICAgICAgICBuZXdDYWxsLm9uKENhbGxFdmVudC5Mb2NhbEhvbGRVbmhvbGQsIHRoaXMub25DYWxsTG9jYWxIb2xkVW5ob2xkKTtcbiAgICAgICAgICAgIG5ld0NhbGwub24oQ2FsbEV2ZW50LlJlbW90ZUhvbGRVbmhvbGQsIHRoaXMub25DYWxsUmVtb3RlSG9sZFVuaG9sZCk7XG4gICAgICAgICAgICBuZXdDYWxsLm9uKENhbGxFdmVudC5GZWVkc0NoYW5nZWQsIHRoaXMub25GZWVkc0NoYW5nZWQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvbkNhbGxTdGF0ZSA9IChzdGF0ZSkgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGNhbGxTdGF0ZTogc3RhdGUsXG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uRmVlZHNDaGFuZ2VkID0gKG5ld0ZlZWRzOiBBcnJheTxDYWxsRmVlZD4pID0+IHtcbiAgICAgICAgY29uc3QgeyBwcmltYXJ5LCBzZWNvbmRhcnkgfSA9IENhbGxWaWV3LmdldE9yZGVyZWRGZWVkcyhuZXdGZWVkcyk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgcHJpbWFyeUZlZWQ6IHByaW1hcnksXG4gICAgICAgICAgICBzZWNvbmRhcnlGZWVkczogc2Vjb25kYXJ5LFxuICAgICAgICAgICAgbWljTXV0ZWQ6IHRoaXMucHJvcHMuY2FsbC5pc01pY3JvcGhvbmVNdXRlZCgpLFxuICAgICAgICAgICAgdmlkTXV0ZWQ6IHRoaXMucHJvcHMuY2FsbC5pc0xvY2FsVmlkZW9NdXRlZCgpLFxuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkNhbGxMb2NhbEhvbGRVbmhvbGQgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgaXNMb2NhbE9uSG9sZDogdGhpcy5wcm9wcy5jYWxsLmlzTG9jYWxPbkhvbGQoKSxcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25DYWxsUmVtb3RlSG9sZFVuaG9sZCA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBpc1JlbW90ZU9uSG9sZDogdGhpcy5wcm9wcy5jYWxsLmlzUmVtb3RlT25Ib2xkKCksXG4gICAgICAgICAgICAvLyB1cGRhdGUgYm90aCBoZXJlIGJlY2F1c2UgaXNMb2NhbE9uSG9sZCBjaGFuZ2VzIHdoZW4gd2UgaG9sZCB0aGUgY2FsbCB0b29cbiAgICAgICAgICAgIGlzTG9jYWxPbkhvbGQ6IHRoaXMucHJvcHMuY2FsbC5pc0xvY2FsT25Ib2xkKCksXG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uTW91c2VNb3ZlID0gKCkgPT4ge1xuICAgICAgICB0aGlzLmJ1dHRvbnNSZWYuY3VycmVudD8uc2hvd0NvbnRyb2xzKCk7XG4gICAgfTtcblxuICAgIHN0YXRpYyBnZXRPcmRlcmVkRmVlZHMoZmVlZHM6IEFycmF5PENhbGxGZWVkPik6IHsgcHJpbWFyeTogQ2FsbEZlZWQsIHNlY29uZGFyeTogQXJyYXk8Q2FsbEZlZWQ+IH0ge1xuICAgICAgICBsZXQgcHJpbWFyeTtcblxuICAgICAgICAvLyBUcnkgdG8gdXNlIGEgc2NyZWVuc2hhcmluZyBhcyBwcmltYXJ5LCBhIHJlbW90ZSBvbmUgaWYgcG9zc2libGVcbiAgICAgICAgY29uc3Qgc2NyZWVuc2hhcmluZ0ZlZWRzID0gZmVlZHMuZmlsdGVyKChmZWVkKSA9PiBmZWVkLnB1cnBvc2UgPT09IFNEUFN0cmVhbU1ldGFkYXRhUHVycG9zZS5TY3JlZW5zaGFyZSk7XG4gICAgICAgIHByaW1hcnkgPSBzY3JlZW5zaGFyaW5nRmVlZHMuZmluZCgoZmVlZCkgPT4gIWZlZWQuaXNMb2NhbCgpKSB8fCBzY3JlZW5zaGFyaW5nRmVlZHNbMF07XG4gICAgICAgIC8vIElmIHdlIGRpZG4ndCBmaW5kIHJlbW90ZSBzY3JlZW4tc2hhcmluZyBzdHJlYW0sIHRyeSB0byBmaW5kIGFueSByZW1vdGUgc3RyZWFtXG4gICAgICAgIGlmICghcHJpbWFyeSkge1xuICAgICAgICAgICAgcHJpbWFyeSA9IGZlZWRzLmZpbmQoKGZlZWQpID0+ICFmZWVkLmlzTG9jYWwoKSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzZWNvbmRhcnkgPSBbLi4uZmVlZHNdO1xuICAgICAgICAvLyBSZW1vdmUgdGhlIHByaW1hcnkgZmVlZCBmcm9tIHRoZSBhcnJheVxuICAgICAgICBpZiAocHJpbWFyeSkgc2Vjb25kYXJ5LnNwbGljZShzZWNvbmRhcnkuaW5kZXhPZihwcmltYXJ5KSwgMSk7XG4gICAgICAgIHNlY29uZGFyeS5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgICAgICBpZiAoYS5pc0xvY2FsKCkgJiYgIWIuaXNMb2NhbCgpKSByZXR1cm4gLTE7XG4gICAgICAgICAgICBpZiAoIWEuaXNMb2NhbCgpICYmIGIuaXNMb2NhbCgpKSByZXR1cm4gMTtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4geyBwcmltYXJ5LCBzZWNvbmRhcnkgfTtcbiAgICB9XG5cbiAgICBwcml2YXRlIG9uTWljTXV0ZUNsaWNrID0gYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgICAgICBjb25zdCBuZXdWYWwgPSAhdGhpcy5zdGF0ZS5taWNNdXRlZDtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IG1pY011dGVkOiBhd2FpdCB0aGlzLnByb3BzLmNhbGwuc2V0TWljcm9waG9uZU11dGVkKG5ld1ZhbCkgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25WaWRNdXRlQ2xpY2sgPSBhc3luYyAoKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgICAgIGNvbnN0IG5ld1ZhbCA9ICF0aGlzLnN0YXRlLnZpZE11dGVkO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgdmlkTXV0ZWQ6IGF3YWl0IHRoaXMucHJvcHMuY2FsbC5zZXRMb2NhbFZpZGVvTXV0ZWQobmV3VmFsKSB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvblNjcmVlbnNoYXJlQ2xpY2sgPSBhc3luYyAoKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgICAgIGxldCBpc1NjcmVlbnNoYXJpbmc7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLnNjcmVlbnNoYXJpbmcpIHtcbiAgICAgICAgICAgIGlzU2NyZWVuc2hhcmluZyA9IGF3YWl0IHRoaXMucHJvcHMuY2FsbC5zZXRTY3JlZW5zaGFyaW5nRW5hYmxlZChmYWxzZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAod2luZG93LmVsZWN0cm9uPy5nZXREZXNrdG9wQ2FwdHVyZXJTb3VyY2VzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBmaW5pc2hlZCB9ID0gTW9kYWwuY3JlYXRlRGlhbG9nKERlc2t0b3BDYXB0dXJlclNvdXJjZVBpY2tlcik7XG4gICAgICAgICAgICAgICAgY29uc3QgW3NvdXJjZV0gPSBhd2FpdCBmaW5pc2hlZDtcbiAgICAgICAgICAgICAgICBpZiAoIXNvdXJjZSkgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgaXNTY3JlZW5zaGFyaW5nID0gYXdhaXQgdGhpcy5wcm9wcy5jYWxsLnNldFNjcmVlbnNoYXJpbmdFbmFibGVkKHRydWUsIHNvdXJjZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlzU2NyZWVuc2hhcmluZyA9IGF3YWl0IHRoaXMucHJvcHMuY2FsbC5zZXRTY3JlZW5zaGFyaW5nRW5hYmxlZCh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgc2lkZWJhclNob3duOiB0cnVlLFxuICAgICAgICAgICAgc2NyZWVuc2hhcmluZzogaXNTY3JlZW5zaGFyaW5nLFxuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgLy8gd2UgcmVnaXN0ZXIgZ2xvYmFsIHNob3J0Y3V0cyBoZXJlLCB0aGV5ICptdXN0IG5vdCBjb25mbGljdCogd2l0aCBsb2NhbCBzaG9ydGN1dHMgZWxzZXdoZXJlIG9yIGJvdGggd2lsbCBmaXJlXG4gICAgLy8gTm90ZSB0aGF0IHRoaXMgYXNzdW1lcyB3ZSBhbHdheXMgaGF2ZSBhIENhbGxWaWV3IG9uIHNjcmVlbiBhdCBhbnkgZ2l2ZW4gdGltZVxuICAgIC8vIENhbGxIYW5kbGVyIHdvdWxkIHByb2JhYmx5IGJlIGEgYmV0dGVyIHBsYWNlIGZvciB0aGlzXG4gICAgcHJpdmF0ZSBvbk5hdGl2ZUtleURvd24gPSAoZXYpOiB2b2lkID0+IHtcbiAgICAgICAgbGV0IGhhbmRsZWQgPSBmYWxzZTtcbiAgICAgICAgY29uc3QgY3RybENtZE9ubHkgPSBpc09ubHlDdHJsT3JDbWRLZXlFdmVudChldik7XG5cbiAgICAgICAgc3dpdGNoIChldi5rZXkpIHtcbiAgICAgICAgICAgIGNhc2UgS2V5LkQ6XG4gICAgICAgICAgICAgICAgaWYgKGN0cmxDbWRPbmx5KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25NaWNNdXRlQ2xpY2soKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gc2hvdyB0aGUgY29udHJvbHMgdG8gZ2l2ZSBmZWVkYmFja1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmJ1dHRvbnNSZWYuY3VycmVudD8uc2hvd0NvbnRyb2xzKCk7XG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSBLZXkuRTpcbiAgICAgICAgICAgICAgICBpZiAoY3RybENtZE9ubHkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vblZpZE11dGVDbGljaygpO1xuICAgICAgICAgICAgICAgICAgICAvLyBzaG93IHRoZSBjb250cm9scyB0byBnaXZlIGZlZWRiYWNrXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnV0dG9uc1JlZi5jdXJyZW50Py5zaG93Q29udHJvbHMoKTtcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGhhbmRsZWQpIHtcbiAgICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwcml2YXRlIG9uQ2FsbFJlc3VtZUNsaWNrID0gKCk6IHZvaWQgPT4ge1xuICAgICAgICBjb25zdCB1c2VyRmFjaW5nUm9vbUlkID0gQ2FsbEhhbmRsZXIuc2hhcmVkSW5zdGFuY2UoKS5yb29tSWRGb3JDYWxsKHRoaXMucHJvcHMuY2FsbCk7XG4gICAgICAgIENhbGxIYW5kbGVyLnNoYXJlZEluc3RhbmNlKCkuc2V0QWN0aXZlQ2FsbFJvb21JZCh1c2VyRmFjaW5nUm9vbUlkKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvblRyYW5zZmVyQ2xpY2sgPSAoKTogdm9pZCA9PiB7XG4gICAgICAgIGNvbnN0IHRyYW5zZmVyZWVDYWxsID0gQ2FsbEhhbmRsZXIuc2hhcmVkSW5zdGFuY2UoKS5nZXRUcmFuc2ZlcmVlRm9yQ2FsbElkKHRoaXMucHJvcHMuY2FsbC5jYWxsSWQpO1xuICAgICAgICB0aGlzLnByb3BzLmNhbGwudHJhbnNmZXJUb0NhbGwodHJhbnNmZXJlZUNhbGwpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uSGFuZ3VwQ2xpY2sgPSAoKTogdm9pZCA9PiB7XG4gICAgICAgIGRpcy5kaXNwYXRjaCh7XG4gICAgICAgICAgICBhY3Rpb246ICdoYW5ndXAnLFxuICAgICAgICAgICAgcm9vbV9pZDogQ2FsbEhhbmRsZXIuc2hhcmVkSW5zdGFuY2UoKS5yb29tSWRGb3JDYWxsKHRoaXMucHJvcHMuY2FsbCksXG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uVG9nZ2xlU2lkZWJhciA9ICgpOiB2b2lkID0+IHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHNpZGViYXJTaG93bjogIXRoaXMuc3RhdGUuc2lkZWJhclNob3duIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIHJlbmRlckNhbGxDb250cm9scygpOiBKU1guRWxlbWVudCB7XG4gICAgICAgIC8vIFdlIGRvbid0IHN1cHBvcnQgY2FsbCB1cGdyYWRlcyAoeWV0KSBzbyBoaWRlIHRoZSB2aWRlbyBtdXRlIGJ1dHRvbiBpbiB2b2ljZSBjYWxsc1xuICAgICAgICBjb25zdCB2aWRNdXRlQnV0dG9uU2hvd24gPSB0aGlzLnByb3BzLmNhbGwudHlwZSA9PT0gQ2FsbFR5cGUuVmlkZW87XG4gICAgICAgIC8vIFNjcmVlbnNoYXJpbmcgaXMgcG9zc2libGUsIGlmIHdlIGNhbiBzZW5kIGEgc2Vjb25kIHN0cmVhbSBhbmRcbiAgICAgICAgLy8gaWRlbnRpZnkgaXQgdXNpbmcgU0RQU3RyZWFtTWV0YWRhdGEgb3IgaWYgd2UgY2FuIHJlcGxhY2UgdGhlIGFscmVhZHlcbiAgICAgICAgLy8gZXhpc3RpbmcgdXNlcm1lZGlhIHRyYWNrIGJ5IGEgc2NyZWVuc2hhcmluZyB0cmFjay4gV2UgYWxzbyBuZWVkIHRvIGJlXG4gICAgICAgIC8vIGNvbm5lY3RlZCB0byBrbm93IHRoZSBzdGF0ZSBvZiB0aGUgb3RoZXIgc2lkZVxuICAgICAgICBjb25zdCBzY3JlZW5zaGFyaW5nQnV0dG9uU2hvd24gPSAoXG4gICAgICAgICAgICAodGhpcy5wcm9wcy5jYWxsLm9wcG9uZW50U3VwcG9ydHNTRFBTdHJlYW1NZXRhZGF0YSgpIHx8IHRoaXMucHJvcHMuY2FsbC50eXBlID09PSBDYWxsVHlwZS5WaWRlbykgJiZcbiAgICAgICAgICAgIHRoaXMucHJvcHMuY2FsbC5zdGF0ZSA9PT0gQ2FsbFN0YXRlLkNvbm5lY3RlZFxuICAgICAgICApO1xuICAgICAgICAvLyBUbyBzaG93IHRoZSBzaWRlYmFyIHdlIG5lZWQgc2Vjb25kYXJ5IGZlZWRzLCBpZiB3ZSBkb24ndCBoYXZlIHRoZW0sXG4gICAgICAgIC8vIHdlIGNhbiBoaWRlIHRoaXMgYnV0dG9uLiBJZiB3ZSBhcmUgaW4gUGlQLCBzaWRlYmFyIGlzIGFsc28gaGlkZGVuLCBzb1xuICAgICAgICAvLyB3ZSBjYW4gaGlkZSB0aGUgYnV0dG9uIHRvb1xuICAgICAgICBjb25zdCBzaWRlYmFyQnV0dG9uU2hvd24gPSAoXG4gICAgICAgICAgICB0aGlzLnN0YXRlLnByaW1hcnlGZWVkPy5wdXJwb3NlID09PSBTRFBTdHJlYW1NZXRhZGF0YVB1cnBvc2UuU2NyZWVuc2hhcmUgfHxcbiAgICAgICAgICAgIHRoaXMucHJvcHMuY2FsbC5pc1NjcmVlbnNoYXJpbmcoKVxuICAgICAgICApO1xuICAgICAgICAvLyBUaGUgZGlhbCBwYWQgJiAnbW9yZScgYnV0dG9uIGFjdGlvbnMgYXJlIG9ubHkgcmVsZXZhbnQgaW4gYSBjb25uZWN0ZWQgY2FsbFxuICAgICAgICBjb25zdCBjb250ZXh0TWVudUJ1dHRvblNob3duID0gdGhpcy5zdGF0ZS5jYWxsU3RhdGUgPT09IENhbGxTdGF0ZS5Db25uZWN0ZWQ7XG4gICAgICAgIGNvbnN0IGRpYWxwYWRCdXR0b25TaG93biA9IChcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuY2FsbFN0YXRlID09PSBDYWxsU3RhdGUuQ29ubmVjdGVkICYmXG4gICAgICAgICAgICB0aGlzLnByb3BzLmNhbGwub3Bwb25lbnRTdXBwb3J0c0RUTUYoKVxuICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8Q2FsbFZpZXdCdXR0b25zXG4gICAgICAgICAgICAgICAgcmVmPXt0aGlzLmJ1dHRvbnNSZWZ9XG4gICAgICAgICAgICAgICAgY2FsbD17dGhpcy5wcm9wcy5jYWxsfVxuICAgICAgICAgICAgICAgIHBpcE1vZGU9e3RoaXMucHJvcHMucGlwTW9kZX1cbiAgICAgICAgICAgICAgICBoYW5kbGVycz17e1xuICAgICAgICAgICAgICAgICAgICBvblRvZ2dsZVNpZGViYXJDbGljazogdGhpcy5vblRvZ2dsZVNpZGViYXIsXG4gICAgICAgICAgICAgICAgICAgIG9uU2NyZWVuc2hhcmVDbGljazogdGhpcy5vblNjcmVlbnNoYXJlQ2xpY2ssXG4gICAgICAgICAgICAgICAgICAgIG9uSGFuZ3VwQ2xpY2s6IHRoaXMub25IYW5ndXBDbGljayxcbiAgICAgICAgICAgICAgICAgICAgb25NaWNNdXRlQ2xpY2s6IHRoaXMub25NaWNNdXRlQ2xpY2ssXG4gICAgICAgICAgICAgICAgICAgIG9uVmlkTXV0ZUNsaWNrOiB0aGlzLm9uVmlkTXV0ZUNsaWNrLFxuICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgYnV0dG9uc1N0YXRlPXt7XG4gICAgICAgICAgICAgICAgICAgIG1pY011dGVkOiB0aGlzLnN0YXRlLm1pY011dGVkLFxuICAgICAgICAgICAgICAgICAgICB2aWRNdXRlZDogdGhpcy5zdGF0ZS52aWRNdXRlZCxcbiAgICAgICAgICAgICAgICAgICAgc2lkZWJhclNob3duOiB0aGlzLnN0YXRlLnNpZGViYXJTaG93bixcbiAgICAgICAgICAgICAgICAgICAgc2NyZWVuc2hhcmluZzogdGhpcy5zdGF0ZS5zY3JlZW5zaGFyaW5nLFxuICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgYnV0dG9uc1Zpc2liaWxpdHk9e3tcbiAgICAgICAgICAgICAgICAgICAgdmlkTXV0ZTogdmlkTXV0ZUJ1dHRvblNob3duLFxuICAgICAgICAgICAgICAgICAgICBzY3JlZW5zaGFyaW5nOiBzY3JlZW5zaGFyaW5nQnV0dG9uU2hvd24sXG4gICAgICAgICAgICAgICAgICAgIHNpZGViYXI6IHNpZGViYXJCdXR0b25TaG93bixcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dE1lbnU6IGNvbnRleHRNZW51QnV0dG9uU2hvd24sXG4gICAgICAgICAgICAgICAgICAgIGRpYWxwYWQ6IGRpYWxwYWRCdXR0b25TaG93bixcbiAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgLz5cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgcmVuZGVyKCkge1xuICAgICAgICBjb25zdCBjbGllbnQgPSBNYXRyaXhDbGllbnRQZWcuZ2V0KCk7XG4gICAgICAgIGNvbnN0IGNhbGxSb29tSWQgPSBDYWxsSGFuZGxlci5zaGFyZWRJbnN0YW5jZSgpLnJvb21JZEZvckNhbGwodGhpcy5wcm9wcy5jYWxsKTtcbiAgICAgICAgY29uc3Qgc2Vjb25kYXJ5Q2FsbFJvb21JZCA9IENhbGxIYW5kbGVyLnNoYXJlZEluc3RhbmNlKCkucm9vbUlkRm9yQ2FsbCh0aGlzLnByb3BzLnNlY29uZGFyeUNhbGwpO1xuICAgICAgICBjb25zdCBjYWxsUm9vbSA9IGNsaWVudC5nZXRSb29tKGNhbGxSb29tSWQpO1xuICAgICAgICBjb25zdCBzZWNDYWxsUm9vbSA9IHRoaXMucHJvcHMuc2Vjb25kYXJ5Q2FsbCA/IGNsaWVudC5nZXRSb29tKHNlY29uZGFyeUNhbGxSb29tSWQpIDogbnVsbDtcbiAgICAgICAgY29uc3QgYXZhdGFyU2l6ZSA9IHRoaXMucHJvcHMucGlwTW9kZSA/IDc2IDogMTYwO1xuICAgICAgICBjb25zdCB0cmFuc2ZlcmVlQ2FsbCA9IENhbGxIYW5kbGVyLnNoYXJlZEluc3RhbmNlKCkuZ2V0VHJhbnNmZXJlZUZvckNhbGxJZCh0aGlzLnByb3BzLmNhbGwuY2FsbElkKTtcbiAgICAgICAgY29uc3QgaXNPbkhvbGQgPSB0aGlzLnN0YXRlLmlzTG9jYWxPbkhvbGQgfHwgdGhpcy5zdGF0ZS5pc1JlbW90ZU9uSG9sZDtcbiAgICAgICAgY29uc3QgaXNTY3JlZW5zaGFyaW5nID0gdGhpcy5wcm9wcy5jYWxsLmlzU2NyZWVuc2hhcmluZygpO1xuICAgICAgICBjb25zdCBzaWRlYmFyU2hvd24gPSB0aGlzLnN0YXRlLnNpZGViYXJTaG93bjtcbiAgICAgICAgY29uc3Qgc29tZW9uZUlzU2NyZWVuc2hhcmluZyA9IHRoaXMucHJvcHMuY2FsbC5nZXRGZWVkcygpLnNvbWUoKGZlZWQpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBmZWVkLnB1cnBvc2UgPT09IFNEUFN0cmVhbU1ldGFkYXRhUHVycG9zZS5TY3JlZW5zaGFyZTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGlzVmlkZW9DYWxsID0gdGhpcy5wcm9wcy5jYWxsLnR5cGUgPT09IENhbGxUeXBlLlZpZGVvO1xuXG4gICAgICAgIGxldCBjb250ZW50VmlldzogUmVhY3QuUmVhY3ROb2RlO1xuICAgICAgICBsZXQgaG9sZFRyYW5zZmVyQ29udGVudDtcblxuICAgICAgICBpZiAodHJhbnNmZXJlZUNhbGwpIHtcbiAgICAgICAgICAgIGNvbnN0IHRyYW5zZmVyVGFyZ2V0Um9vbSA9IE1hdHJpeENsaWVudFBlZy5nZXQoKS5nZXRSb29tKFxuICAgICAgICAgICAgICAgIENhbGxIYW5kbGVyLnNoYXJlZEluc3RhbmNlKCkucm9vbUlkRm9yQ2FsbCh0aGlzLnByb3BzLmNhbGwpLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGNvbnN0IHRyYW5zZmVyVGFyZ2V0TmFtZSA9IHRyYW5zZmVyVGFyZ2V0Um9vbSA/IHRyYW5zZmVyVGFyZ2V0Um9vbS5uYW1lIDogX3QoXCJ1bmtub3duIHBlcnNvblwiKTtcblxuICAgICAgICAgICAgY29uc3QgdHJhbnNmZXJlZVJvb20gPSBNYXRyaXhDbGllbnRQZWcuZ2V0KCkuZ2V0Um9vbShcbiAgICAgICAgICAgICAgICBDYWxsSGFuZGxlci5zaGFyZWRJbnN0YW5jZSgpLnJvb21JZEZvckNhbGwodHJhbnNmZXJlZUNhbGwpLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGNvbnN0IHRyYW5zZmVyZWVOYW1lID0gdHJhbnNmZXJlZVJvb20gPyB0cmFuc2ZlcmVlUm9vbS5uYW1lIDogX3QoXCJ1bmtub3duIHBlcnNvblwiKTtcblxuICAgICAgICAgICAgaG9sZFRyYW5zZmVyQ29udGVudCA9IDxkaXYgY2xhc3NOYW1lPVwibXhfQ2FsbFZpZXdfaG9sZFRyYW5zZmVyQ29udGVudFwiPlxuICAgICAgICAgICAgICAgIHsgX3QoXG4gICAgICAgICAgICAgICAgICAgIFwiQ29uc3VsdGluZyB3aXRoICUodHJhbnNmZXJUYXJnZXQpcy4gPGE+VHJhbnNmZXIgdG8gJSh0cmFuc2ZlcmVlKXM8L2E+XCIsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zZmVyVGFyZ2V0OiB0cmFuc2ZlclRhcmdldE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2ZlcmVlOiB0cmFuc2ZlcmVlTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgYTogc3ViID0+IDxBY2Nlc3NpYmxlQnV0dG9uIGtpbmQ9XCJsaW5rXCIgb25DbGljaz17dGhpcy5vblRyYW5zZmVyQ2xpY2t9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgc3ViIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvQWNjZXNzaWJsZUJ1dHRvbj4sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgKSB9XG4gICAgICAgICAgICA8L2Rpdj47XG4gICAgICAgIH0gZWxzZSBpZiAoaXNPbkhvbGQpIHtcbiAgICAgICAgICAgIGxldCBvbkhvbGRUZXh0ID0gbnVsbDtcbiAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlLmlzUmVtb3RlT25Ib2xkKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaG9sZFN0cmluZyA9IENhbGxIYW5kbGVyLnNoYXJlZEluc3RhbmNlKCkuaGFzQW55VW5oZWxkQ2FsbCgpID9cbiAgICAgICAgICAgICAgICAgICAgX3RkKFwiWW91IGhlbGQgdGhlIGNhbGwgPGE+U3dpdGNoPC9hPlwiKSA6IF90ZChcIllvdSBoZWxkIHRoZSBjYWxsIDxhPlJlc3VtZTwvYT5cIik7XG4gICAgICAgICAgICAgICAgb25Ib2xkVGV4dCA9IF90KGhvbGRTdHJpbmcsIHt9LCB7XG4gICAgICAgICAgICAgICAgICAgIGE6IHN1YiA9PiA8QWNjZXNzaWJsZUJ1dHRvbiBraW5kPVwibGlua1wiIG9uQ2xpY2s9e3RoaXMub25DYWxsUmVzdW1lQ2xpY2t9PlxuICAgICAgICAgICAgICAgICAgICAgICAgeyBzdWIgfVxuICAgICAgICAgICAgICAgICAgICA8L0FjY2Vzc2libGVCdXR0b24+LFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnN0YXRlLmlzTG9jYWxPbkhvbGQpIHtcbiAgICAgICAgICAgICAgICBvbkhvbGRUZXh0ID0gX3QoXCIlKHBlZXJOYW1lKXMgaGVsZCB0aGUgY2FsbFwiLCB7XG4gICAgICAgICAgICAgICAgICAgIHBlZXJOYW1lOiB0aGlzLnByb3BzLmNhbGwuZ2V0T3Bwb25lbnRNZW1iZXIoKS5uYW1lLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaG9sZFRyYW5zZmVyQ29udGVudCA9IDxkaXYgY2xhc3NOYW1lPVwibXhfQ2FsbFZpZXdfaG9sZFRyYW5zZmVyQ29udGVudFwiPlxuICAgICAgICAgICAgICAgIHsgb25Ib2xkVGV4dCB9XG4gICAgICAgICAgICA8L2Rpdj47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgc2lkZWJhcjtcbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgIWlzT25Ib2xkICYmXG4gICAgICAgICAgICAhdHJhbnNmZXJlZUNhbGwgJiZcbiAgICAgICAgICAgIHNpZGViYXJTaG93biAmJlxuICAgICAgICAgICAgKGlzVmlkZW9DYWxsIHx8IHNvbWVvbmVJc1NjcmVlbnNoYXJpbmcpXG4gICAgICAgICkge1xuICAgICAgICAgICAgc2lkZWJhciA9IChcbiAgICAgICAgICAgICAgICA8Q2FsbFZpZXdTaWRlYmFyXG4gICAgICAgICAgICAgICAgICAgIGZlZWRzPXt0aGlzLnN0YXRlLnNlY29uZGFyeUZlZWRzfVxuICAgICAgICAgICAgICAgICAgICBjYWxsPXt0aGlzLnByb3BzLmNhbGx9XG4gICAgICAgICAgICAgICAgICAgIHBpcE1vZGU9e3RoaXMucHJvcHMucGlwTW9kZX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRoaXMgaXMgYSBiaXQgbWVzc3kuIEkgY2FuJ3Qgc2VlIGEgcmVhc29uIHRvIGhhdmUgdHdvIG9uSG9sZC90cmFuc2ZlciBzY3JlZW5zXG4gICAgICAgIGlmIChpc09uSG9sZCB8fCB0cmFuc2ZlcmVlQ2FsbCkge1xuICAgICAgICAgICAgaWYgKGlzVmlkZW9DYWxsKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29udGFpbmVyQ2xhc3NlcyA9IGNsYXNzTmFtZXMoe1xuICAgICAgICAgICAgICAgICAgICBteF9DYWxsVmlld19jb250ZW50OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBteF9DYWxsVmlld192aWRlbzogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgbXhfQ2FsbFZpZXdfdmlkZW9faG9sZDogaXNPbkhvbGQsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgbGV0IG9uSG9sZEJhY2tncm91bmQgPSBudWxsO1xuICAgICAgICAgICAgICAgIGNvbnN0IGJhY2tncm91bmRTdHlsZTogQ1NTUHJvcGVydGllcyA9IHt9O1xuICAgICAgICAgICAgICAgIGNvbnN0IGJhY2tncm91bmRBdmF0YXJVcmwgPSBhdmF0YXJVcmxGb3JNZW1iZXIoXG4gICAgICAgICAgICAgICAgICAgIC8vIGlzIGl0IHdvcnRoIGdldHRpbmcgdGhlIHNpemUgb2YgdGhlIGRpdiB0byBwYXNzIGhlcmU/XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuY2FsbC5nZXRPcHBvbmVudE1lbWJlcigpLCAxMDI0LCAxMDI0LCAnY3JvcCcsXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kU3R5bGUuYmFja2dyb3VuZEltYWdlID0gJ3VybCgnICsgYmFja2dyb3VuZEF2YXRhclVybCArICcpJztcbiAgICAgICAgICAgICAgICBvbkhvbGRCYWNrZ3JvdW5kID0gPGRpdiBjbGFzc05hbWU9XCJteF9DYWxsVmlld192aWRlb19ob2xkQmFja2dyb3VuZFwiIHN0eWxlPXtiYWNrZ3JvdW5kU3R5bGV9IC8+O1xuXG4gICAgICAgICAgICAgICAgY29udGVudFZpZXcgPSAoXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtjb250YWluZXJDbGFzc2VzfSByZWY9e3RoaXMuY29udGVudFJlZn0gb25Nb3VzZU1vdmU9e3RoaXMub25Nb3VzZU1vdmV9PlxuICAgICAgICAgICAgICAgICAgICAgICAgeyBvbkhvbGRCYWNrZ3JvdW5kIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHsgaG9sZFRyYW5zZmVyQ29udGVudCB9XG4gICAgICAgICAgICAgICAgICAgICAgICB7IHRoaXMucmVuZGVyQ2FsbENvbnRyb2xzKCkgfVxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjbGFzc2VzID0gY2xhc3NOYW1lcyh7XG4gICAgICAgICAgICAgICAgICAgIG14X0NhbGxWaWV3X2NvbnRlbnQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIG14X0NhbGxWaWV3X3ZvaWNlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBteF9DYWxsVmlld192b2ljZV9ob2xkOiBpc09uSG9sZCxcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGNvbnRlbnRWaWV3ID0gKFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17Y2xhc3Nlc30gb25Nb3VzZU1vdmU9e3RoaXMub25Nb3VzZU1vdmV9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJteF9DYWxsVmlld192b2ljZV9hdmF0YXJzQ29udGFpbmVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJteF9DYWxsVmlld192b2ljZV9hdmF0YXJDb250YWluZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17eyB3aWR0aDogYXZhdGFyU2l6ZSwgaGVpZ2h0OiBhdmF0YXJTaXplIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Um9vbUF2YXRhclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm9vbT17Y2FsbFJvb219XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ9e2F2YXRhclNpemV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD17YXZhdGFyU2l6ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgeyBob2xkVHJhbnNmZXJDb250ZW50IH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHsgdGhpcy5yZW5kZXJDYWxsQ29udHJvbHMoKSB9XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy5jYWxsLm5vSW5jb21pbmdGZWVkcygpKSB7XG4gICAgICAgICAgICAvLyBIZXJlIHdlJ3JlIHJldXNpbmcgdGhlIGNzcyBjbGFzc2VzIGZyb20gdm9pY2Ugb24gaG9sZCwgYmVjYXVzZVxuICAgICAgICAgICAgLy8gSSBhbSBsYXp5LiBJZiB0aGlzIGdldHMgbWVyZ2VkLCB0aGUgQ2FsbFZpZXcgbWlnaHQgYmUgc3ViamVjdFxuICAgICAgICAgICAgLy8gdG8gY2hhbmdlIGFueXdheSAtIEkgbWlnaHQgdGFrZSBhbiBheGUgdG8gdGhpcyBmaWxlIGluIG9yZGVyIHRvXG4gICAgICAgICAgICAvLyB0cnkgdG8gZ2V0IG90aGVyIHRoaW5ncyB3b3JraW5nXG4gICAgICAgICAgICBjb25zdCBjbGFzc2VzID0gY2xhc3NOYW1lcyh7XG4gICAgICAgICAgICAgICAgbXhfQ2FsbFZpZXdfY29udGVudDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBteF9DYWxsVmlld192b2ljZTogdHJ1ZSxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBTYXlpbmcgXCJDb25uZWN0aW5nXCIgaGVyZSBpc24ndCByZWFsbHkgdHJ1ZSwgYnV0IHRoZSBiZXN0IHRoaW5nXG4gICAgICAgICAgICAvLyBJIGNhbiBjb21lIHVwIHdpdGgsIGJ1dCB0aGlzIG1pZ2h0IGJlIHN1YmplY3QgdG8gY2hhbmdlIGFzIHdlbGxcbiAgICAgICAgICAgIGNvbnRlbnRWaWV3ID0gKFxuICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbGFzc2VzfVxuICAgICAgICAgICAgICAgICAgICBvbk1vdXNlTW92ZT17dGhpcy5vbk1vdXNlTW92ZX1cbiAgICAgICAgICAgICAgICAgICAgcmVmPXt0aGlzLmNvbnRlbnRSZWZ9XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICB7IHNpZGViYXIgfVxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X0NhbGxWaWV3X3ZvaWNlX2F2YXRhcnNDb250YWluZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJteF9DYWxsVmlld192b2ljZV9hdmF0YXJDb250YWluZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7IHdpZHRoOiBhdmF0YXJTaXplLCBoZWlnaHQ6IGF2YXRhclNpemUgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Um9vbUF2YXRhclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb29tPXtjYWxsUm9vbX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0PXthdmF0YXJTaXplfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD17YXZhdGFyU2l6ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X0NhbGxWaWV3X2hvbGRUcmFuc2ZlckNvbnRlbnRcIj57IF90KFwiQ29ubmVjdGluZ1wiKSB9PC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIHsgdGhpcy5yZW5kZXJDYWxsQ29udHJvbHMoKSB9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyQ2xhc3NlcyA9IGNsYXNzTmFtZXMoe1xuICAgICAgICAgICAgICAgIG14X0NhbGxWaWV3X2NvbnRlbnQ6IHRydWUsXG4gICAgICAgICAgICAgICAgbXhfQ2FsbFZpZXdfdmlkZW86IHRydWUsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgbGV0IHRvYXN0O1xuICAgICAgICAgICAgaWYgKHNvbWVvbmVJc1NjcmVlbnNoYXJpbmcpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwcmVzZW50aW5nQ2xhc3NlcyA9IGNsYXNzTmFtZXMoe1xuICAgICAgICAgICAgICAgICAgICBteF9DYWxsVmlld19wcmVzZW50aW5nOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBteF9DYWxsVmlld19wcmVzZW50aW5nX2hpZGRlbjogIXRoaXMuc3RhdGUuY29udHJvbHNWaXNpYmxlLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHNoYXJlck5hbWUgPSB0aGlzLnN0YXRlLnByaW1hcnlGZWVkLmdldE1lbWJlcigpLm5hbWU7XG4gICAgICAgICAgICAgICAgbGV0IHRleHQgPSBpc1NjcmVlbnNoYXJpbmdcbiAgICAgICAgICAgICAgICAgICAgPyBfdChcIllvdSBhcmUgcHJlc2VudGluZ1wiKVxuICAgICAgICAgICAgICAgICAgICA6IF90KCclKHNoYXJlck5hbWUpcyBpcyBwcmVzZW50aW5nJywgeyBzaGFyZXJOYW1lIH0pO1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5zdGF0ZS5zaWRlYmFyU2hvd24gJiYgaXNWaWRlb0NhbGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dCArPSBcIiDigKIgXCIgKyAodGhpcy5wcm9wcy5jYWxsLmlzTG9jYWxWaWRlb011dGVkKClcbiAgICAgICAgICAgICAgICAgICAgICAgID8gX3QoXCJZb3VyIGNhbWVyYSBpcyB0dXJuZWQgb2ZmXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICA6IF90KFwiWW91ciBjYW1lcmEgaXMgc3RpbGwgZW5hYmxlZFwiKSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdG9hc3QgPSAoXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtwcmVzZW50aW5nQ2xhc3Nlc30+XG4gICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQgfVxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb250ZW50VmlldyA9IChcbiAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y29udGFpbmVyQ2xhc3Nlc31cbiAgICAgICAgICAgICAgICAgICAgcmVmPXt0aGlzLmNvbnRlbnRSZWZ9XG4gICAgICAgICAgICAgICAgICAgIG9uTW91c2VNb3ZlPXt0aGlzLm9uTW91c2VNb3ZlfVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgeyB0b2FzdCB9XG4gICAgICAgICAgICAgICAgICAgIHsgc2lkZWJhciB9XG4gICAgICAgICAgICAgICAgICAgIDxWaWRlb0ZlZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIGZlZWQ9e3RoaXMuc3RhdGUucHJpbWFyeUZlZWR9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsPXt0aGlzLnByb3BzLmNhbGx9XG4gICAgICAgICAgICAgICAgICAgICAgICBwaXBNb2RlPXt0aGlzLnByb3BzLnBpcE1vZGV9XG4gICAgICAgICAgICAgICAgICAgICAgICBvblJlc2l6ZT17dGhpcy5wcm9wcy5vblJlc2l6ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHByaW1hcnk9e3RydWV9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIHsgdGhpcy5yZW5kZXJDYWxsQ29udHJvbHMoKSB9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY2FsbFZpZXdDbGFzc2VzID0gY2xhc3NOYW1lcyh7XG4gICAgICAgICAgICBteF9DYWxsVmlldzogdHJ1ZSxcbiAgICAgICAgICAgIG14X0NhbGxWaWV3X3BpcDogdGhpcy5wcm9wcy5waXBNb2RlLFxuICAgICAgICAgICAgbXhfQ2FsbFZpZXdfbGFyZ2U6ICF0aGlzLnByb3BzLnBpcE1vZGUsXG4gICAgICAgICAgICBteF9DYWxsVmlld19iZWxvd1dpZGdldDogdGhpcy5wcm9wcy5zaG93QXBwcywgLy8gY3NzIHRvIGNvcnJlY3QgdGhlIG1hcmdpbnMgaWYgdGhlIGNhbGwgaXMgYmVsb3cgdGhlIEFwcHNEcmF3ZXIuXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT17Y2FsbFZpZXdDbGFzc2VzfT5cbiAgICAgICAgICAgIDxDYWxsVmlld0hlYWRlclxuICAgICAgICAgICAgICAgIG9uUGlwTW91c2VEb3duPXt0aGlzLnByb3BzLm9uTW91c2VEb3duT25IZWFkZXJ9XG4gICAgICAgICAgICAgICAgcGlwTW9kZT17dGhpcy5wcm9wcy5waXBNb2RlfVxuICAgICAgICAgICAgICAgIHR5cGU9e3RoaXMucHJvcHMuY2FsbC50eXBlfVxuICAgICAgICAgICAgICAgIGNhbGxSb29tcz17W2NhbGxSb29tLCBzZWNDYWxsUm9vbV19XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgeyBjb250ZW50VmlldyB9XG4gICAgICAgIDwvZGl2PjtcbiAgICB9XG59XG4iXX0=