"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var React = _interopRequireWildcard(require("react"));

var _AccessibleButton = _interopRequireDefault(require("../elements/AccessibleButton"));

var _Field = _interopRequireDefault(require("../elements/Field"));

var _DialPad = _interopRequireDefault(require("./DialPad"));

var _dispatcher = _interopRequireDefault(require("../../../dispatcher/dispatcher"));

var _replaceableComponent = require("../../../utils/replaceableComponent");

var _actions = require("../../../dispatcher/actions");

var _DialPadBackspaceButton = _interopRequireDefault(require("../elements/DialPadBackspaceButton"));

var _dec, _class;

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

let DialpadModal = (_dec = (0, _replaceableComponent.replaceableComponent)("views.voip.DialPadModal"), _dec(_class = class DialpadModal extends React.PureComponent {
  constructor(props) {
    super(props);
    (0, _defineProperty2.default)(this, "numberEntryFieldRef", /*#__PURE__*/(0, React.createRef)());
    (0, _defineProperty2.default)(this, "onCancelClick", () => {
      this.props.onFinished(false);
    });
    (0, _defineProperty2.default)(this, "onChange", ev => {
      this.setState({
        value: ev.target.value
      });
    });
    (0, _defineProperty2.default)(this, "onFormSubmit", ev => {
      ev.preventDefault();
      this.onDialPress();
    });
    (0, _defineProperty2.default)(this, "onDigitPress", (digit, ev) => {
      this.setState({
        value: this.state.value + digit
      }); // Keep the number field focused so that keyboard entry is still available.
      // However, don't focus if this wasn't the result of directly clicking on the button,
      // i.e someone using keyboard navigation.

      if (ev.type === "click") {
        var _this$numberEntryFiel;

        (_this$numberEntryFiel = this.numberEntryFieldRef.current) === null || _this$numberEntryFiel === void 0 ? void 0 : _this$numberEntryFiel.focus();
      }
    });
    (0, _defineProperty2.default)(this, "onDeletePress", ev => {
      if (this.state.value.length === 0) return;
      this.setState({
        value: this.state.value.slice(0, -1)
      }); // Keep the number field focused so that keyboard entry is still available
      // However, don't focus if this wasn't the result of directly clicking on the button,
      // i.e someone using keyboard navigation.

      if (ev.type === "click") {
        var _this$numberEntryFiel2;

        (_this$numberEntryFiel2 = this.numberEntryFieldRef.current) === null || _this$numberEntryFiel2 === void 0 ? void 0 : _this$numberEntryFiel2.focus();
      }
    });
    (0, _defineProperty2.default)(this, "onDialPress", async () => {
      const payload = {
        action: _actions.Action.DialNumber,
        number: this.state.value
      };

      _dispatcher.default.dispatch(payload);

      this.props.onFinished(true);
    });
    this.state = {
      value: ''
    };
  }

  render() {
    const backspaceButton = /*#__PURE__*/React.createElement(_DialPadBackspaceButton.default, {
      onBackspacePress: this.onDeletePress
    }); // Only show the backspace button if the field has content

    let dialPadField;

    if (this.state.value.length !== 0) {
      dialPadField = /*#__PURE__*/React.createElement(_Field.default, {
        ref: this.numberEntryFieldRef,
        className: "mx_DialPadModal_field",
        id: "dialpad_number",
        value: this.state.value,
        autoFocus: true,
        onChange: this.onChange,
        postfixComponent: backspaceButton
      });
    } else {
      dialPadField = /*#__PURE__*/React.createElement(_Field.default, {
        ref: this.numberEntryFieldRef,
        className: "mx_DialPadModal_field",
        id: "dialpad_number",
        value: this.state.value,
        autoFocus: true,
        onChange: this.onChange
      });
    }

    return /*#__PURE__*/React.createElement("div", {
      className: "mx_DialPadModal"
    }, /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement(_AccessibleButton.default, {
      className: "mx_DialPadModal_cancel",
      onClick: this.onCancelClick
    })), /*#__PURE__*/React.createElement("div", {
      className: "mx_DialPadModal_header"
    }, /*#__PURE__*/React.createElement("form", {
      onSubmit: this.onFormSubmit
    }, dialPadField)), /*#__PURE__*/React.createElement("div", {
      className: "mx_DialPadModal_dialPad"
    }, /*#__PURE__*/React.createElement(_DialPad.default, {
      hasDial: true,
      onDigitPress: this.onDigitPress,
      onDeletePress: this.onDeletePress,
      onDialPress: this.onDialPress
    })));
  }

}) || _class);
exports.default = DialpadModal;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZpZXdzL3ZvaXAvRGlhbFBhZE1vZGFsLnRzeCJdLCJuYW1lcyI6WyJEaWFscGFkTW9kYWwiLCJSZWFjdCIsIlB1cmVDb21wb25lbnQiLCJjb25zdHJ1Y3RvciIsInByb3BzIiwib25GaW5pc2hlZCIsImV2Iiwic2V0U3RhdGUiLCJ2YWx1ZSIsInRhcmdldCIsInByZXZlbnREZWZhdWx0Iiwib25EaWFsUHJlc3MiLCJkaWdpdCIsInN0YXRlIiwidHlwZSIsIm51bWJlckVudHJ5RmllbGRSZWYiLCJjdXJyZW50IiwiZm9jdXMiLCJsZW5ndGgiLCJzbGljZSIsInBheWxvYWQiLCJhY3Rpb24iLCJBY3Rpb24iLCJEaWFsTnVtYmVyIiwibnVtYmVyIiwiZGlzIiwiZGlzcGF0Y2giLCJyZW5kZXIiLCJiYWNrc3BhY2VCdXR0b24iLCJvbkRlbGV0ZVByZXNzIiwiZGlhbFBhZEZpZWxkIiwib25DaGFuZ2UiLCJvbkNhbmNlbENsaWNrIiwib25Gb3JtU3VibWl0Iiwib25EaWdpdFByZXNzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQWdCQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFDQTs7Ozs7Ozs7SUFXcUJBLFksV0FEcEIsZ0RBQXFCLHlCQUFyQixDLGdCQUFELE1BQ3FCQSxZQURyQixTQUMwQ0MsS0FBSyxDQUFDQyxhQURoRCxDQUM4RTtBQUcxRUMsRUFBQUEsV0FBVyxDQUFDQyxLQUFELEVBQVE7QUFDZixVQUFNQSxLQUFOO0FBRGUsNEVBRm1DLHNCQUVuQztBQUFBLHlEQU9ILE1BQU07QUFDbEIsV0FBS0EsS0FBTCxDQUFXQyxVQUFYLENBQXNCLEtBQXRCO0FBQ0gsS0FUa0I7QUFBQSxvREFXUEMsRUFBRCxJQUFRO0FBQ2YsV0FBS0MsUUFBTCxDQUFjO0FBQUVDLFFBQUFBLEtBQUssRUFBRUYsRUFBRSxDQUFDRyxNQUFILENBQVVEO0FBQW5CLE9BQWQ7QUFDSCxLQWJrQjtBQUFB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STtBQUFNLE1BQUEsUUFBUSxFQUFFLEtBQUtDO0FBQXJCLE9BQ01ILFlBRE4sQ0FESixDQUpHLGVBU0g7QUFBSyxNQUFBLFNBQVMsRUFBQztBQUFmLG9CQUNJLG9CQUFDLGdCQUFEO0FBQVMsTUFBQSxPQUFPLEVBQUUsSUFBbEI7QUFDSSxNQUFBLFlBQVksRUFBRSxLQUFLSSxZQUR2QjtBQUVJLE1BQUEsYUFBYSxFQUFFLEtBQUtMLGFBRnhCO0FBR0ksTUFBQSxXQUFXLEVBQUUsS0FBS2xCO0FBSHRCLE1BREosQ0FURyxDQUFQO0FBaUJIOztBQXJHeUUsQyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG5Db3B5cmlnaHQgMjAyMCBUaGUgTWF0cml4Lm9yZyBGb3VuZGF0aW9uIEMuSS5DLlxuXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xueW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG5cbiAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcblxuVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG5TZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG5saW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiovXG5cbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgY3JlYXRlUmVmIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgQWNjZXNzaWJsZUJ1dHRvbiwgeyBCdXR0b25FdmVudCB9IGZyb20gXCIuLi9lbGVtZW50cy9BY2Nlc3NpYmxlQnV0dG9uXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcIi4uL2VsZW1lbnRzL0ZpZWxkXCI7XG5pbXBvcnQgRGlhbFBhZCBmcm9tICcuL0RpYWxQYWQnO1xuaW1wb3J0IGRpcyBmcm9tICcuLi8uLi8uLi9kaXNwYXRjaGVyL2Rpc3BhdGNoZXInO1xuaW1wb3J0IHsgcmVwbGFjZWFibGVDb21wb25lbnQgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvcmVwbGFjZWFibGVDb21wb25lbnRcIjtcbmltcG9ydCB7IERpYWxOdW1iZXJQYXlsb2FkIH0gZnJvbSBcIi4uLy4uLy4uL2Rpc3BhdGNoZXIvcGF5bG9hZHMvRGlhbE51bWJlclBheWxvYWRcIjtcbmltcG9ydCB7IEFjdGlvbiB9IGZyb20gXCIuLi8uLi8uLi9kaXNwYXRjaGVyL2FjdGlvbnNcIjtcbmltcG9ydCBEaWFsUGFkQmFja3NwYWNlQnV0dG9uIGZyb20gXCIuLi9lbGVtZW50cy9EaWFsUGFkQmFja3NwYWNlQnV0dG9uXCI7XG5cbmludGVyZmFjZSBJUHJvcHMge1xuICAgIG9uRmluaXNoZWQ6IChib29sZWFuKSA9PiB2b2lkO1xufVxuXG5pbnRlcmZhY2UgSVN0YXRlIHtcbiAgICB2YWx1ZTogc3RyaW5nO1xufVxuXG5AcmVwbGFjZWFibGVDb21wb25lbnQoXCJ2aWV3cy52b2lwLkRpYWxQYWRNb2RhbFwiKVxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRGlhbHBhZE1vZGFsIGV4dGVuZHMgUmVhY3QuUHVyZUNvbXBvbmVudDxJUHJvcHMsIElTdGF0ZT4ge1xuICAgIHByaXZhdGUgbnVtYmVyRW50cnlGaWVsZFJlZjogUmVhY3QuUmVmT2JqZWN0PEZpZWxkPiA9IGNyZWF0ZVJlZigpO1xuXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgdmFsdWU6ICcnLFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIG9uQ2FuY2VsQ2xpY2sgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMucHJvcHMub25GaW5pc2hlZChmYWxzZSk7XG4gICAgfTtcblxuICAgIG9uQ2hhbmdlID0gKGV2KSA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyB2YWx1ZTogZXYudGFyZ2V0LnZhbHVlIH0pO1xuICAgIH07XG5cbiAgICBvbkZvcm1TdWJtaXQgPSAoZXYpID0+IHtcbiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5vbkRpYWxQcmVzcygpO1xuICAgIH07XG5cbiAgICBvbkRpZ2l0UHJlc3MgPSAoZGlnaXQ6IHN0cmluZywgZXY6IEJ1dHRvbkV2ZW50KSA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyB2YWx1ZTogdGhpcy5zdGF0ZS52YWx1ZSArIGRpZ2l0IH0pO1xuXG4gICAgICAgIC8vIEtlZXAgdGhlIG51bWJlciBmaWVsZCBmb2N1c2VkIHNvIHRoYXQga2V5Ym9hcmQgZW50cnkgaXMgc3RpbGwgYXZhaWxhYmxlLlxuICAgICAgICAvLyBIb3dldmVyLCBkb24ndCBmb2N1cyBpZiB0aGlzIHdhc24ndCB0aGUgcmVzdWx0IG9mIGRpcmVjdGx5IGNsaWNraW5nIG9uIHRoZSBidXR0b24sXG4gICAgICAgIC8vIGkuZSBzb21lb25lIHVzaW5nIGtleWJvYXJkIG5hdmlnYXRpb24uXG4gICAgICAgIGlmIChldi50eXBlID09PSBcImNsaWNrXCIpIHtcbiAgICAgICAgICAgIHRoaXMubnVtYmVyRW50cnlGaWVsZFJlZi5jdXJyZW50Py5mb2N1cygpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIG9uRGVsZXRlUHJlc3MgPSAoZXY6IEJ1dHRvbkV2ZW50KSA9PiB7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLnZhbHVlLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgdmFsdWU6IHRoaXMuc3RhdGUudmFsdWUuc2xpY2UoMCwgLTEpIH0pO1xuXG4gICAgICAgIC8vIEtlZXAgdGhlIG51bWJlciBmaWVsZCBmb2N1c2VkIHNvIHRoYXQga2V5Ym9hcmQgZW50cnkgaXMgc3RpbGwgYXZhaWxhYmxlXG4gICAgICAgIC8vIEhvd2V2ZXIsIGRvbid0IGZvY3VzIGlmIHRoaXMgd2Fzbid0IHRoZSByZXN1bHQgb2YgZGlyZWN0bHkgY2xpY2tpbmcgb24gdGhlIGJ1dHRvbixcbiAgICAgICAgLy8gaS5lIHNvbWVvbmUgdXNpbmcga2V5Ym9hcmQgbmF2aWdhdGlvbi5cbiAgICAgICAgaWYgKGV2LnR5cGUgPT09IFwiY2xpY2tcIikge1xuICAgICAgICAgICAgdGhpcy5udW1iZXJFbnRyeUZpZWxkUmVmLmN1cnJlbnQ/LmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgb25EaWFsUHJlc3MgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHBheWxvYWQ6IERpYWxOdW1iZXJQYXlsb2FkID0ge1xuICAgICAgICAgICAgYWN0aW9uOiBBY3Rpb24uRGlhbE51bWJlcixcbiAgICAgICAgICAgIG51bWJlcjogdGhpcy5zdGF0ZS52YWx1ZSxcbiAgICAgICAgfTtcbiAgICAgICAgZGlzLmRpc3BhdGNoKHBheWxvYWQpO1xuXG4gICAgICAgIHRoaXMucHJvcHMub25GaW5pc2hlZCh0cnVlKTtcbiAgICB9O1xuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBjb25zdCBiYWNrc3BhY2VCdXR0b24gPSAoXG4gICAgICAgICAgICA8RGlhbFBhZEJhY2tzcGFjZUJ1dHRvbiBvbkJhY2tzcGFjZVByZXNzPXt0aGlzLm9uRGVsZXRlUHJlc3N9IC8+XG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gT25seSBzaG93IHRoZSBiYWNrc3BhY2UgYnV0dG9uIGlmIHRoZSBmaWVsZCBoYXMgY29udGVudFxuICAgICAgICBsZXQgZGlhbFBhZEZpZWxkO1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS52YWx1ZS5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgIGRpYWxQYWRGaWVsZCA9IDxGaWVsZFxuICAgICAgICAgICAgICAgIHJlZj17dGhpcy5udW1iZXJFbnRyeUZpZWxkUmVmfVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm14X0RpYWxQYWRNb2RhbF9maWVsZFwiXG4gICAgICAgICAgICAgICAgaWQ9XCJkaWFscGFkX251bWJlclwiXG4gICAgICAgICAgICAgICAgdmFsdWU9e3RoaXMuc3RhdGUudmFsdWV9XG4gICAgICAgICAgICAgICAgYXV0b0ZvY3VzPXt0cnVlfVxuICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uQ2hhbmdlfVxuICAgICAgICAgICAgICAgIHBvc3RmaXhDb21wb25lbnQ9e2JhY2tzcGFjZUJ1dHRvbn1cbiAgICAgICAgICAgIC8+O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGlhbFBhZEZpZWxkID0gPEZpZWxkXG4gICAgICAgICAgICAgICAgcmVmPXt0aGlzLm51bWJlckVudHJ5RmllbGRSZWZ9XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXhfRGlhbFBhZE1vZGFsX2ZpZWxkXCJcbiAgICAgICAgICAgICAgICBpZD1cImRpYWxwYWRfbnVtYmVyXCJcbiAgICAgICAgICAgICAgICB2YWx1ZT17dGhpcy5zdGF0ZS52YWx1ZX1cbiAgICAgICAgICAgICAgICBhdXRvRm9jdXM9e3RydWV9XG4gICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25DaGFuZ2V9XG4gICAgICAgICAgICAvPjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cIm14X0RpYWxQYWRNb2RhbFwiPlxuICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICA8QWNjZXNzaWJsZUJ1dHRvbiBjbGFzc05hbWU9XCJteF9EaWFsUGFkTW9kYWxfY2FuY2VsXCIgb25DbGljaz17dGhpcy5vbkNhbmNlbENsaWNrfSAvPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X0RpYWxQYWRNb2RhbF9oZWFkZXJcIj5cbiAgICAgICAgICAgICAgICA8Zm9ybSBvblN1Ym1pdD17dGhpcy5vbkZvcm1TdWJtaXR9PlxuICAgICAgICAgICAgICAgICAgICB7IGRpYWxQYWRGaWVsZCB9XG4gICAgICAgICAgICAgICAgPC9mb3JtPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X0RpYWxQYWRNb2RhbF9kaWFsUGFkXCI+XG4gICAgICAgICAgICAgICAgPERpYWxQYWQgaGFzRGlhbD17dHJ1ZX1cbiAgICAgICAgICAgICAgICAgICAgb25EaWdpdFByZXNzPXt0aGlzLm9uRGlnaXRQcmVzc31cbiAgICAgICAgICAgICAgICAgICAgb25EZWxldGVQcmVzcz17dGhpcy5vbkRlbGV0ZVByZXNzfVxuICAgICAgICAgICAgICAgICAgICBvbkRpYWxQcmVzcz17dGhpcy5vbkRpYWxQcmVzc31cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PjtcbiAgICB9XG59XG4iXX0=