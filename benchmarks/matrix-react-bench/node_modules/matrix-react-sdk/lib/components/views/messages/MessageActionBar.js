"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _react = _interopRequireWildcard(require("react"));

var _event = require("matrix-js-sdk/src/models/event");

var _languageHandler = require("../../../languageHandler");

var _dispatcher = _interopRequireDefault(require("../../../dispatcher/dispatcher"));

var _actions = require("../../../dispatcher/actions");

var _ContextMenu = _interopRequireWildcard(require("../../structures/ContextMenu"));

var _EventUtils = require("../../../utils/EventUtils");

var _RoomContext = _interopRequireWildcard(require("../../../contexts/RoomContext"));

var _Toolbar = _interopRequireDefault(require("../../../accessibility/Toolbar"));

var _RovingTabIndex = require("../../../accessibility/RovingTabIndex");

var _replaceableComponent = require("../../../utils/replaceableComponent");

var _MessageContextMenu = _interopRequireWildcard(require("../context_menus/MessageContextMenu"));

var _Resend = _interopRequireDefault(require("../../../Resend"));

var _MatrixClientPeg = require("../../../MatrixClientPeg");

var _MediaEventHelper = require("../../../utils/MediaEventHelper");

var _DownloadActionButton = _interopRequireDefault(require("./DownloadActionButton"));

var _classnames = _interopRequireDefault(require("classnames"));

var _SettingsStore = _interopRequireDefault(require("../../../settings/SettingsStore"));

var _ReplyChain = _interopRequireDefault(require("../elements/ReplyChain"));

var _threads = require("../../../dispatcher/dispatch-actions/threads");

var _ReactionPicker = _interopRequireDefault(require("../emojipicker/ReactionPicker"));

var _event2 = require("matrix-js-sdk/src/@types/event");

var _dec, _class, _class2, _temp;

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

const OptionsButton = ({
  mxEvent,
  getTile,
  getReplyChain,
  permalinkCreator,
  onFocusChange
}) => {
  const [menuDisplayed, button, openMenu, closeMenu] = (0, _ContextMenu.useContextMenu)();
  const [onFocus, isActive, ref] = (0, _RovingTabIndex.useRovingTabIndex)(button);
  (0, _react.useEffect)(() => {
    onFocusChange(menuDisplayed);
  }, [onFocusChange, menuDisplayed]);
  let contextMenu;

  if (menuDisplayed) {
    const tile = getTile && getTile();
    const replyChain = getReplyChain && getReplyChain();
    const buttonRect = button.current.getBoundingClientRect();
    contextMenu = /*#__PURE__*/_react.default.createElement(_MessageContextMenu.default, (0, _extends2.default)({}, (0, _ContextMenu.aboveLeftOf)(buttonRect), {
      mxEvent: mxEvent,
      permalinkCreator: permalinkCreator,
      eventTileOps: tile && tile.getEventTileOps ? tile.getEventTileOps() : undefined,
      collapseReplyChain: replyChain && replyChain.canCollapse() ? replyChain.collapse : undefined,
      onFinished: closeMenu
    }));
  }

  return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement(_ContextMenu.ContextMenuTooltipButton, {
    className: "mx_MessageActionBar_maskButton mx_MessageActionBar_optionsButton",
    title: (0, _languageHandler._t)("Options"),
    onClick: openMenu,
    isExpanded: menuDisplayed,
    inputRef: ref,
    onFocus: onFocus,
    tabIndex: isActive ? 0 : -1
  }), contextMenu);
};

const ReactButton = ({
  mxEvent,
  reactions,
  onFocusChange
}) => {
  const [menuDisplayed, button, openMenu, closeMenu] = (0, _ContextMenu.useContextMenu)();
  const [onFocus, isActive, ref] = (0, _RovingTabIndex.useRovingTabIndex)(button);
  (0, _react.useEffect)(() => {
    onFocusChange(menuDisplayed);
  }, [onFocusChange, menuDisplayed]);
  let contextMenu;

  if (menuDisplayed) {
    const buttonRect = button.current.getBoundingClientRect();
    contextMenu = /*#__PURE__*/_react.default.createElement(_ContextMenu.default, (0, _extends2.default)({}, (0, _ContextMenu.aboveLeftOf)(buttonRect), {
      onFinished: closeMenu,
      managed: false
    }), /*#__PURE__*/_react.default.createElement(_ReactionPicker.default, {
      mxEvent: mxEvent,
      reactions: reactions,
      onFinished: closeMenu
    }));
  }

  return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement(_ContextMenu.ContextMenuTooltipButton, {
    className: "mx_MessageActionBar_maskButton mx_MessageActionBar_reactButton",
    title: (0, _languageHandler._t)("React"),
    onClick: openMenu,
    isExpanded: menuDisplayed,
    inputRef: ref,
    onFocus: onFocus,
    tabIndex: isActive ? 0 : -1
  }), contextMenu);
};

let MessageActionBar = (_dec = (0, _replaceableComponent.replaceableComponent)("views.messages.MessageActionBar"), _dec(_class = (_temp = _class2 = class MessageActionBar extends _react.default.PureComponent {
  constructor(...args) {
    super(...args);
    (0, _defineProperty2.default)(this, "onDecrypted", () => {
      // When an event decrypts, it is likely to change the set of available
      // actions, so we force an update to check again.
      this.forceUpdate();
    });
    (0, _defineProperty2.default)(this, "onBeforeRedaction", () => {
      // When an event is redacted, we can't edit it so update the available actions.
      this.forceUpdate();
    });
    (0, _defineProperty2.default)(this, "onSent", () => {
      // When an event is sent and echoed the possible actions change.
      this.forceUpdate();
    });
    (0, _defineProperty2.default)(this, "onFocusChange", focused => {
      if (!this.props.onFocusChange) {
        return;
      }

      this.props.onFocusChange(focused);
    });
    (0, _defineProperty2.default)(this, "onReplyClick", ev => {
      _dispatcher.default.dispatch({
        action: 'reply_to_event',
        event: this.props.mxEvent,
        context: this.context.timelineRenderingType
      });
    });
    (0, _defineProperty2.default)(this, "onThreadClick", () => {
      (0, _threads.dispatchShowThreadEvent)(this.props.mxEvent);

      _dispatcher.default.dispatch({
        action: _actions.Action.FocusSendMessageComposer,
        context: _RoomContext.TimelineRenderingType.Thread
      });
    });
    (0, _defineProperty2.default)(this, "onEditClick", ev => {
      _dispatcher.default.dispatch({
        action: _actions.Action.EditEvent,
        event: this.props.mxEvent,
        timelineRenderingType: this.context.timelineRenderingType
      });
    });
    (0, _defineProperty2.default)(this, "forbiddenThreadHeadMsgType", [_event2.MsgType.KeyVerificationRequest]);
    (0, _defineProperty2.default)(this, "onResendClick", ev => {
      this.runActionOnFailedEv(tarEv => _Resend.default.resend(tarEv));
    });
    (0, _defineProperty2.default)(this, "onCancelClick", ev => {
      this.runActionOnFailedEv(tarEv => _Resend.default.removeFromQueue(tarEv), testEv => (0, _MessageContextMenu.canCancel)(testEv.status));
    });
  }

  componentDidMount() {
    if (this.props.mxEvent.status && this.props.mxEvent.status !== _event.EventStatus.SENT) {
      this.props.mxEvent.on("Event.status", this.onSent);
    }

    const client = _MatrixClientPeg.MatrixClientPeg.get();

    client.decryptEventIfNeeded(this.props.mxEvent);

    if (this.props.mxEvent.isBeingDecrypted()) {
      this.props.mxEvent.once("Event.decrypted", this.onDecrypted);
    }

    this.props.mxEvent.on("Event.beforeRedaction", this.onBeforeRedaction);
  }

  componentWillUnmount() {
    this.props.mxEvent.off("Event.status", this.onSent);
    this.props.mxEvent.off("Event.decrypted", this.onDecrypted);
    this.props.mxEvent.off("Event.beforeRedaction", this.onBeforeRedaction);
  }

  get showReplyInThreadAction() {
    const isThreadEnabled = _SettingsStore.default.getValue("feature_thread");

    const inNotThreadTimeline = this.context.timelineRenderingType !== _RoomContext.TimelineRenderingType.Thread;
    const isAllowedMessageType = !this.forbiddenThreadHeadMsgType.includes(this.props.mxEvent.getContent().msgtype);
    return isThreadEnabled && inNotThreadTimeline && isAllowedMessageType;
  }
  /**
   * Runs a given fn on the set of possible events to test. The first event
   * that passes the checkFn will have fn executed on it. Both functions take
   * a MatrixEvent object. If no particular conditions are needed, checkFn can
   * be null/undefined. If no functions pass the checkFn, no action will be
   * taken.
   * @param {Function} fn The execution function.
   * @param {Function} checkFn The test function.
   */


  runActionOnFailedEv(fn, checkFn) {
    if (!checkFn) checkFn = () => true;
    const mxEvent = this.props.mxEvent;
    const editEvent = mxEvent.replacingEvent();
    const redactEvent = mxEvent.localRedactionEvent();
    const tryOrder = [redactEvent, editEvent, mxEvent];

    for (const ev of tryOrder) {
      if (ev && checkFn(ev)) {
        fn(ev);
        break;
      }
    }
  }

  render() {
    const toolbarOpts = [];

    if ((0, _EventUtils.canEditContent)(this.props.mxEvent)) {
      toolbarOpts.push( /*#__PURE__*/_react.default.createElement(_RovingTabIndex.RovingAccessibleTooltipButton, {
        className: "mx_MessageActionBar_maskButton mx_MessageActionBar_editButton",
        title: (0, _languageHandler._t)("Edit"),
        onClick: this.onEditClick,
        key: "edit"
      }));
    }

    const cancelSendingButton = /*#__PURE__*/_react.default.createElement(_RovingTabIndex.RovingAccessibleTooltipButton, {
      className: "mx_MessageActionBar_maskButton mx_MessageActionBar_cancelButton",
      title: (0, _languageHandler._t)("Delete"),
      onClick: this.onCancelClick,
      key: "cancel"
    }); // We show a different toolbar for failed events, so detect that first.


    const mxEvent = this.props.mxEvent;
    const editStatus = mxEvent.replacingEvent() && mxEvent.replacingEvent().status;
    const redactStatus = mxEvent.localRedactionEvent() && mxEvent.localRedactionEvent().status;
    const allowCancel = (0, _MessageContextMenu.canCancel)(mxEvent.status) || (0, _MessageContextMenu.canCancel)(editStatus) || (0, _MessageContextMenu.canCancel)(redactStatus);
    const isFailed = [mxEvent.status, editStatus, redactStatus].includes(_event.EventStatus.NOT_SENT);

    if (allowCancel && isFailed) {
      // The resend button needs to appear ahead of the edit button, so insert to the
      // start of the opts
      toolbarOpts.splice(0, 0, /*#__PURE__*/_react.default.createElement(_RovingTabIndex.RovingAccessibleTooltipButton, {
        className: "mx_MessageActionBar_maskButton mx_MessageActionBar_resendButton",
        title: (0, _languageHandler._t)("Retry"),
        onClick: this.onResendClick,
        key: "resend"
      })); // The delete button should appear last, so we can just drop it at the end

      toolbarOpts.push(cancelSendingButton);
    } else {
      if ((0, _EventUtils.isContentActionable)(this.props.mxEvent)) {
        // Like the resend button, the react and reply buttons need to appear before the edit.
        // The only catch is we do the reply button first so that we can make sure the react
        // button is the very first button without having to do length checks for `splice()`.
        if (this.context.canReply) {
          toolbarOpts.splice(0, 0, /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement(_RovingTabIndex.RovingAccessibleTooltipButton, {
            className: "mx_MessageActionBar_maskButton mx_MessageActionBar_replyButton",
            title: (0, _languageHandler._t)("Reply"),
            onClick: this.onReplyClick,
            key: "reply"
          }), this.showReplyInThreadAction && /*#__PURE__*/_react.default.createElement(_RovingTabIndex.RovingAccessibleTooltipButton, {
            className: "mx_MessageActionBar_maskButton mx_MessageActionBar_threadButton",
            title: (0, _languageHandler._t)("Reply in thread"),
            onClick: this.onThreadClick,
            key: "thread"
          })));
        }

        if (this.context.canReact) {
          toolbarOpts.splice(0, 0, /*#__PURE__*/_react.default.createElement(ReactButton, {
            mxEvent: this.props.mxEvent,
            reactions: this.props.reactions,
            onFocusChange: this.onFocusChange,
            key: "react"
          }));
        } // XXX: Assuming that the underlying tile will be a media event if it is eligible media.


        if (_MediaEventHelper.MediaEventHelper.isEligible(this.props.mxEvent)) {
          toolbarOpts.splice(0, 0, /*#__PURE__*/_react.default.createElement(_DownloadActionButton.default, {
            mxEvent: this.props.mxEvent,
            mediaEventHelperGet: () => {
              var _this$props$getTile, _this$props, _this$props$getTile$c, _this$props$getTile$c2;

              return (_this$props$getTile = (_this$props = this.props).getTile) === null || _this$props$getTile === void 0 ? void 0 : (_this$props$getTile$c = (_this$props$getTile$c2 = _this$props$getTile.call(_this$props)).getMediaHelper) === null || _this$props$getTile$c === void 0 ? void 0 : _this$props$getTile$c.call(_this$props$getTile$c2);
            },
            key: "download"
          }));
        }
      } // Show thread icon even for deleted messages, but only within main timeline


      if (this.context.timelineRenderingType === _RoomContext.TimelineRenderingType.Room && _SettingsStore.default.getValue("feature_thread") && this.props.mxEvent.getThread() && !(0, _EventUtils.isContentActionable)(this.props.mxEvent)) {
        toolbarOpts.unshift( /*#__PURE__*/_react.default.createElement(_RovingTabIndex.RovingAccessibleTooltipButton, {
          className: "mx_MessageActionBar_maskButton mx_MessageActionBar_threadButton",
          title: (0, _languageHandler._t)("Reply in thread"),
          onClick: this.onThreadClick,
          key: "thread"
        }));
      }

      if (allowCancel) {
        toolbarOpts.push(cancelSendingButton);
      }

      if (this.props.isQuoteExpanded !== undefined && _ReplyChain.default.hasReply(this.props.mxEvent)) {
        const expandClassName = (0, _classnames.default)({
          'mx_MessageActionBar_maskButton': true,
          'mx_MessageActionBar_expandMessageButton': !this.props.isQuoteExpanded,
          'mx_MessageActionBar_collapseMessageButton': this.props.isQuoteExpanded
        });
        toolbarOpts.push( /*#__PURE__*/_react.default.createElement(_RovingTabIndex.RovingAccessibleTooltipButton, {
          className: expandClassName,
          title: this.props.isQuoteExpanded ? (0, _languageHandler._t)("Collapse quotes │ ⇧+click") : (0, _languageHandler._t)("Expand quotes │ ⇧+click"),
          onClick: this.props.toggleThreadExpanded,
          key: "expand"
        }));
      } // The menu button should be last, so dump it there.


      toolbarOpts.push( /*#__PURE__*/_react.default.createElement(OptionsButton, {
        mxEvent: this.props.mxEvent,
        getReplyChain: this.props.getReplyChain,
        getTile: this.props.getTile,
        permalinkCreator: this.props.permalinkCreator,
        onFocusChange: this.onFocusChange,
        key: "menu"
      }));
    } // aria-live=off to not have this read out automatically as navigating around timeline, gets repetitive.


    return /*#__PURE__*/_react.default.createElement(_Toolbar.default, {
      className: "mx_MessageActionBar",
      "aria-label": (0, _languageHandler._t)("Message Actions"),
      "aria-live": "off"
    }, toolbarOpts);
  }

}, (0, _defineProperty2.default)(_class2, "contextType", _RoomContext.default), _temp)) || _class);
exports.default = MessageActionBar;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZpZXdzL21lc3NhZ2VzL01lc3NhZ2VBY3Rpb25CYXIudHN4Il0sIm5hbWVzIjpbIk9wdGlvbnNCdXR0b24iLCJteEV2ZW50IiwiZ2V0VGlsZSIsImdldFJlcGx5Q2hhaW4iLCJwZXJtYWxpbmtDcmVhdG9yIiwib25Gb2N1c0NoYW5nZSIsIm1lbnVEaXNwbGF5ZWQiLCJidXR0b24iLCJvcGVuTWVudSIsImNsb3NlTWVudSIsIm9uRm9jdXMiLCJpc0FjdGl2ZSIsInJlZiIsImNvbnRleHRNZW51IiwidGlsZSIsInJlcGx5Q2hhaW4iLCJidXR0b25SZWN0IiwiY3VycmVudCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImdldEV2ZW50VGlsZU9wcyIsInVuZGVmaW5lZCIsImNhbkNvbGxhcHNlIiwiY29sbGFwc2UiLCJSZWFjdEJ1dHRvbiIsInJlYWN0aW9ucyIsIk1lc3NhZ2VBY3Rpb25CYXIiLCJSZWFjdCIsIlB1cmVDb21wb25lbnQiLCJmb3JjZVVwZGF0ZSIsImZvY3VzZWQiLCJwcm9wcyIsImV2IiwiZGlzIiwiZGlzcGF0Y2giLCJhY3Rpb24iLCJldmVudCIsImNvbnRleHQiLCJ0aW1lbGluZVJlbmRlcmluZ1R5cGUiLCJBY3Rpb24iLCJGb2N1c1NlbmRNZXNzYWdlQ29tcG9zZXIiLCJUaW1lbGluZVJlbmRlcmluZ1R5cGUiLCJUaHJlYWQiLCJFZGl0RXZlbnQiLCJNc2dUeXBlIiwiS2V5VmVyaWZpY2F0aW9uUmVxdWVzdCIsInJ1bkFjdGlvbk9uRmFpbGVkRXYiLCJ0YXJFdiIsIlJlc2VuZCIsInJlc2VuZCIsInJlbW92ZUZyb21RdWV1ZSIsInRlc3RFdiIsInN0YXR1cyIsImNvbXBvbmVudERpZE1vdW50IiwiRXZlbnRTdGF0dXMiLCJTRU5UIiwib24iLCJvblNlbnQiLCJjbGllbnQiLCJNYXRyaXhDbGllbnRQZWciLCJnZXQiLCJkZWNyeXB0RXZlbnRJZk5lZWRlZCIsImlzQmVpbmdEZWNyeXB0ZWQiLCJvbmNlIiwib25EZWNyeXB0ZWQiLCJvbkJlZm9yZVJlZGFjdGlvbiIsImNvbXBvbmVudFdpbGxVbm1vdW50Iiwib2ZmIiwic2hvd1JlcGx5SW5UaHJlYWRBY3Rpb24iLCJpc1RocmVhZEVuYWJsZWQiLCJTZXR0aW5nc1N0b3JlIiwiZ2V0VmFsdWUiLCJpbk5vdFRocmVhZFRpbWVsaW5lIiwiaXNBbGxvd2VkTWVzc2FnZVR5cGUiLCJmb3JiaWRkZW5UaHJlYWRIZWFkTXNnVHlwZSIsImluY2x1ZGVzIiwiZ2V0Q29udGVudCIsIm1zZ3R5cGUiLCJmbiIsImNoZWNrRm4iLCJlZGl0RXZlbnQiLCJyZXBsYWNpbmdFdmVudCIsInJlZGFjdEV2ZW50IiwibG9jYWxSZWRhY3Rpb25FdmVudCIsInRyeU9yZGVyIiwicmVuZGVyIiwidG9vbGJhck9wdHMiLCJwdXNoIiwib25FZGl0Q2xpY2siLCJjYW5jZWxTZW5kaW5nQnV0dG9uIiwib25DYW5jZWxDbGljayIsImVkaXRTdGF0dXMiLCJyZWRhY3RTdGF0dXMiLCJhbGxvd0NhbmNlbCIsImlzRmFpbGVkIiwiTk9UX1NFTlQiLCJzcGxpY2UiLCJvblJlc2VuZENsaWNrIiwiY2FuUmVwbHkiLCJvblJlcGx5Q2xpY2siLCJvblRocmVhZENsaWNrIiwiY2FuUmVhY3QiLCJNZWRpYUV2ZW50SGVscGVyIiwiaXNFbGlnaWJsZSIsImdldE1lZGlhSGVscGVyIiwiUm9vbSIsImdldFRocmVhZCIsInVuc2hpZnQiLCJpc1F1b3RlRXhwYW5kZWQiLCJSZXBseUNoYWluIiwiaGFzUmVwbHkiLCJleHBhbmRDbGFzc05hbWUiLCJ0b2dnbGVUaHJlYWRFeHBhbmRlZCIsIlJvb21Db250ZXh0Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBa0JBOztBQUNBOztBQUdBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUNBOztBQUNBOztBQUNBOzs7Ozs7OztBQVdBLE1BQU1BLGFBQTRDLEdBQzlDLENBQUM7QUFBRUMsRUFBQUEsT0FBRjtBQUFXQyxFQUFBQSxPQUFYO0FBQW9CQyxFQUFBQSxhQUFwQjtBQUFtQ0MsRUFBQUEsZ0JBQW5DO0FBQXFEQyxFQUFBQTtBQUFyRCxDQUFELEtBQTBFO0FBQ3RFLFFBQU0sQ0FBQ0MsYUFBRCxFQUFnQkMsTUFBaEIsRUFBd0JDLFFBQXhCLEVBQWtDQyxTQUFsQyxJQUErQyxrQ0FBckQ7QUFDQSxRQUFNLENBQUNDLE9BQUQsRUFBVUMsUUFBVixFQUFvQkMsR0FBcEIsSUFBMkIsdUNBQWtCTCxNQUFsQixDQUFqQztBQUNBLHdCQUFVLE1BQU07QUFDWkYsSUFBQUEsYUFBYSxDQUFDQyxhQUFELENBQWI7QUFDSCxHQUZELEVBRUcsQ0FBQ0QsYUFBRCxFQUFnQkMsYUFBaEIsQ0FGSDtBQUlBLE1BQUlPLFdBQUo7O0FBQ0EsTUFBSVAsYUFBSixFQUFtQjtBQUNmLFVBQU1RLElBQUksR0FBR1osT0FBTyxJQUFJQSxPQUFPLEVBQS9CO0FBQ0EsVUFBTWEsVUFBVSxHQUFHWixhQUFhLElBQUlBLGFBQWEsRUFBakQ7QUFFQSxVQUFNYSxVQUFVLEdBQUdULE1BQU0sQ0FBQ1UsT0FBUCxDQUFlQyxxQkFBZixFQUFuQjtBQUNBTCxJQUFBQSxXQUFXLGdCQUFHLDZCQUFDLDJCQUFELDZCQUNOLDhCQUFZRyxVQUFaLENBRE07QUFFVixNQUFBLE9BQU8sRUFBRWYsT0FGQztBQUdWLE1BQUEsZ0JBQWdCLEVBQUVHLGdCQUhSO0FBSVYsTUFBQSxZQUFZLEVBQUVVLElBQUksSUFBSUEsSUFBSSxDQUFDSyxlQUFiLEdBQStCTCxJQUFJLENBQUNLLGVBQUwsRUFBL0IsR0FBd0RDLFNBSjVEO0FBS1YsTUFBQSxrQkFBa0IsRUFBRUwsVUFBVSxJQUFJQSxVQUFVLENBQUNNLFdBQVgsRUFBZCxHQUF5Q04sVUFBVSxDQUFDTyxRQUFwRCxHQUErREYsU0FMekU7QUFNVixNQUFBLFVBQVUsRUFBRVg7QUFORixPQUFkO0FBUUg7O0FBRUQsc0JBQU8sNkJBQUMsY0FBRCxDQUFPLFFBQVAscUJBQ0gsNkJBQUMscUNBQUQ7QUFDSSxJQUFBLFNBQVMsRUFBQyxrRUFEZDtBQUVJLElBQUEsS0FBSyxFQUFFLHlCQUFHLFNBQUgsQ0FGWDtBQUdJLElBQUEsT0FBTyxFQUFFRCxRQUhiO0FBSUksSUFBQSxVQUFVLEVBQUVGLGFBSmhCO0FBS0ksSUFBQSxRQUFRLEVBQUVNLEdBTGQ7QUFNSSxJQUFBLE9BQU8sRUFBRUYsT0FOYjtBQU9JLElBQUEsUUFBUSxFQUFFQyxRQUFRLEdBQUcsQ0FBSCxHQUFPLENBQUM7QUFQOUIsSUFERyxFQVdERSxXQVhDLENBQVA7QUFhSCxDQXJDTDs7QUE2Q0EsTUFBTVUsV0FBd0MsR0FBRyxDQUFDO0FBQUV0QixFQUFBQSxPQUFGO0FBQVd1QixFQUFBQSxTQUFYO0FBQXNCbkIsRUFBQUE7QUFBdEIsQ0FBRCxLQUEyQztBQUN4RixRQUFNLENBQUNDLGFBQUQsRUFBZ0JDLE1BQWhCLEVBQXdCQyxRQUF4QixFQUFrQ0MsU0FBbEMsSUFBK0Msa0NBQXJEO0FBQ0EsUUFBTSxDQUFDQyxPQUFELEVBQVVDLFFBQVYsRUFBb0JDLEdBQXBCLElBQTJCLHVDQUFrQkwsTUFBbEIsQ0FBakM7QUFDQSx3QkFBVSxNQUFNO0FBQ1pGLElBQUFBLGFBQWEsQ0FBQ0MsYUFBRCxDQUFiO0FBQ0gsR0FGRCxFQUVHLENBQUNELGFBQUQsRUFBZ0JDLGFBQWhCLENBRkg7QUFJQSxNQUFJTyxXQUFKOztBQUNBLE1BQUlQLGFBQUosRUFBbUI7QUFDZixVQUFNVSxVQUFVLEdBQUdULE1BQU0sQ0FBQ1UsT0FBUCxDQUFlQyxxQkFBZixFQUFuQjtBQUNBTCxJQUFBQSxXQUFXLGdCQUFHLDZCQUFDLG9CQUFELDZCQUFpQiw4QkFBWUcsVUFBWixDQUFqQjtBQUEwQyxNQUFBLFVBQVUsRUFBRVAsU0FBdEQ7QUFBaUUsTUFBQSxPQUFPLEVBQUU7QUFBMUUscUJBQ1YsNkJBQUMsdUJBQUQ7QUFBZ0IsTUFBQSxPQUFPLEVBQUVSLE9BQXpCO0FBQWtDLE1BQUEsU0FBUyxFQUFFdUIsU0FBN0M7QUFBd0QsTUFBQSxVQUFVLEVBQUVmO0FBQXBFLE1BRFUsQ0FBZDtBQUdIOztBQUVELHNCQUFPLDZCQUFDLGNBQUQsQ0FBTyxRQUFQLHFCQUNILDZCQUFDLHFDQUFEO0FBQ0ksSUFBQSxTQUFTLEVBQUMsZ0VBRGQ7QUFFSSxJQUFBLEtBQUssRUFBRSx5QkFBRyxPQUFILENBRlg7QUFHSSxJQUFBLE9BQU8sRUFBRUQsUUFIYjtBQUlJLElBQUEsVUFBVSxFQUFFRixhQUpoQjtBQUtJLElBQUEsUUFBUSxFQUFFTSxHQUxkO0FBTUksSUFBQSxPQUFPLEVBQUVGLE9BTmI7QUFPSSxJQUFBLFFBQVEsRUFBRUMsUUFBUSxHQUFHLENBQUgsR0FBTyxDQUFDO0FBUDlCLElBREcsRUFXREUsV0FYQyxDQUFQO0FBYUgsQ0E1QkQ7O0lBMkNxQlksZ0IsV0FEcEIsZ0RBQXFCLGlDQUFyQixDLG1DQUFELE1BQ3FCQSxnQkFEckIsU0FDOENDLGVBQU1DLGFBRHBELENBQzBGO0FBQUE7QUFBQTtBQUFBLHVEQXVCaEUsTUFBWTtBQUM5QjtBQUNBO0FBQ0EsV0FBS0MsV0FBTDtBQUNILEtBM0JxRjtBQUFBLDZEQTZCMUQsTUFBWTtBQUNwQztBQUNBLFdBQUtBLFdBQUw7QUFDSCxLQWhDcUY7QUFBQSxrREFrQ3JFLE1BQVk7QUFDekI7QUFDQSxXQUFLQSxXQUFMO0FBQ0gsS0FyQ3FGO0FBQUEseURBdUM3REMsT0FBRCxJQUE0QjtBQUNoRCxVQUFJLENBQUMsS0FBS0MsS0FBTCxDQUFXekIsYUFBaEIsRUFBK0I7QUFDM0I7QUFDSDs7QUFDRCxXQUFLeUIsS0FBTCxDQUFXekIsYUFBWCxDQUF5QndCLE9BQXpCO0FBQ0gsS0E1Q3FGO0FBQUEsd0RBOEM5REUsRUFBRCxJQUFnQztBQUNuREMsMEJBQUlDLFFBQUosQ0FBYTtBQUNUQyxRQUFBQSxNQUFNLEVBQUUsZ0JBREM7QUFFVEMsUUFBQUEsS0FBSyxFQUFFLEtBQUtMLEtBQUwsQ0FBVzdCLE9BRlQ7QUFHVG1DLFFBQUFBLE9BQU8sRUFBRSxLQUFLQSxPQUFMLENBQWFDO0FBSGIsT0FBYjtBQUtILEtBcERxRjtBQUFBLHlEQXNEOUQsTUFBWTtBQUNoQyw0Q0FBd0IsS0FBS1AsS0FBTCxDQUFXN0IsT0FBbkM7O0FBQ0ErQiwwQkFBSUMsUUFBSixDQUFhO0FBQ1RDLFFBQUFBLE1BQU0sRUFBRUksZ0JBQU9DLHdCQUROO0FBRVRILFFBQUFBLE9BQU8sRUFBRUksbUNBQXNCQztBQUZ0QixPQUFiO0FBSUgsS0E1RHFGO0FBQUEsdURBOEQvRFYsRUFBRCxJQUFnQztBQUNsREMsMEJBQUlDLFFBQUosQ0FBYTtBQUNUQyxRQUFBQSxNQUFNLEVBQUVJLGdCQUFPSSxTQUROO0FBRVRQLFFBQUFBLEtBQUssRUFBRSxLQUFLTCxLQUFMLENBQVc3QixPQUZUO0FBR1RvQyxRQUFBQSxxQkFBcUIsRUFBRSxLQUFLRCxPQUFMLENBQWFDO0FBSDNCLE9BQWI7QUFLSCxLQXBFcUY7QUFBQSxzRUFzRXhDLENBQzFDTSxnQkFBUUMsc0JBRGtDLENBdEV3QztBQUFBLHlEQTZHN0RiLEVBQUQsSUFBZ0M7QUFDcEQsV0FBS2MsbUJBQUwsQ0FBMEJDLEtBQUQsSUFBV0MsZ0JBQU9DLE1BQVAsQ0FBY0YsS0FBZCxDQUFwQztBQUNILEtBL0dxRjtBQUFBLHlEQWlIN0RmLEVBQUQsSUFBZ0M7QUFDcEQsV0FBS2MsbUJBQUwsQ0FDS0MsS0FBRCxJQUFXQyxnQkFBT0UsZUFBUCxDQUF1QkgsS0FBdkIsQ0FEZixFQUVLSSxNQUFELElBQVksbUNBQVVBLE1BQU0sQ0FBQ0MsTUFBakIsQ0FGaEI7QUFJSCxLQXRIcUY7QUFBQTs7QUFHL0VDLEVBQUFBLGlCQUFpQixHQUFTO0FBQzdCLFFBQUksS0FBS3RCLEtBQUwsQ0FBVzdCLE9BQVgsQ0FBbUJrRCxNQUFuQixJQUE2QixLQUFLckIsS0FBTCxDQUFXN0IsT0FBWCxDQUFtQmtELE1BQW5CLEtBQThCRSxtQkFBWUMsSUFBM0UsRUFBaUY7QUFDN0UsV0FBS3hCLEtBQUwsQ0FBVzdCLE9BQVgsQ0FBbUJzRCxFQUFuQixDQUFzQixjQUF0QixFQUFzQyxLQUFLQyxNQUEzQztBQUNIOztBQUVELFVBQU1DLE1BQU0sR0FBR0MsaUNBQWdCQyxHQUFoQixFQUFmOztBQUNBRixJQUFBQSxNQUFNLENBQUNHLG9CQUFQLENBQTRCLEtBQUs5QixLQUFMLENBQVc3QixPQUF2Qzs7QUFFQSxRQUFJLEtBQUs2QixLQUFMLENBQVc3QixPQUFYLENBQW1CNEQsZ0JBQW5CLEVBQUosRUFBMkM7QUFDdkMsV0FBSy9CLEtBQUwsQ0FBVzdCLE9BQVgsQ0FBbUI2RCxJQUFuQixDQUF3QixpQkFBeEIsRUFBMkMsS0FBS0MsV0FBaEQ7QUFDSDs7QUFDRCxTQUFLakMsS0FBTCxDQUFXN0IsT0FBWCxDQUFtQnNELEVBQW5CLENBQXNCLHVCQUF0QixFQUErQyxLQUFLUyxpQkFBcEQ7QUFDSDs7QUFFTUMsRUFBQUEsb0JBQW9CLEdBQVM7QUFDaEMsU0FBS25DLEtBQUwsQ0FBVzdCLE9BQVgsQ0FBbUJpRSxHQUFuQixDQUF1QixjQUF2QixFQUF1QyxLQUFLVixNQUE1QztBQUNBLFNBQUsxQixLQUFMLENBQVc3QixPQUFYLENBQW1CaUUsR0FBbkIsQ0FBdUIsaUJBQXZCLEVBQTBDLEtBQUtILFdBQS9DO0FBQ0EsU0FBS2pDLEtBQUwsQ0FBVzdCLE9BQVgsQ0FBbUJpRSxHQUFuQixDQUF1Qix1QkFBdkIsRUFBZ0QsS0FBS0YsaUJBQXJEO0FBQ0g7O0FBcURrQyxNQUF2QkcsdUJBQXVCLEdBQVk7QUFDM0MsVUFBTUMsZUFBZSxHQUFHQyx1QkFBY0MsUUFBZCxDQUF1QixnQkFBdkIsQ0FBeEI7O0FBQ0EsVUFBTUMsbUJBQW1CLEdBQUcsS0FBS25DLE9BQUwsQ0FBYUMscUJBQWIsS0FBdUNHLG1DQUFzQkMsTUFBekY7QUFFQSxVQUFNK0Isb0JBQW9CLEdBQUcsQ0FBQyxLQUFLQywwQkFBTCxDQUFnQ0MsUUFBaEMsQ0FDMUIsS0FBSzVDLEtBQUwsQ0FBVzdCLE9BQVgsQ0FBbUIwRSxVQUFuQixHQUFnQ0MsT0FETixDQUE5QjtBQUlBLFdBQU9SLGVBQWUsSUFBSUcsbUJBQW5CLElBQTBDQyxvQkFBakQ7QUFDSDtBQUVEO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ1kzQixFQUFBQSxtQkFBbUIsQ0FBQ2dDLEVBQUQsRUFBZ0NDLE9BQWhDLEVBQThFO0FBQ3JHLFFBQUksQ0FBQ0EsT0FBTCxFQUFjQSxPQUFPLEdBQUcsTUFBTSxJQUFoQjtBQUVkLFVBQU03RSxPQUFPLEdBQUcsS0FBSzZCLEtBQUwsQ0FBVzdCLE9BQTNCO0FBQ0EsVUFBTThFLFNBQVMsR0FBRzlFLE9BQU8sQ0FBQytFLGNBQVIsRUFBbEI7QUFDQSxVQUFNQyxXQUFXLEdBQUdoRixPQUFPLENBQUNpRixtQkFBUixFQUFwQjtBQUNBLFVBQU1DLFFBQVEsR0FBRyxDQUFDRixXQUFELEVBQWNGLFNBQWQsRUFBeUI5RSxPQUF6QixDQUFqQjs7QUFDQSxTQUFLLE1BQU04QixFQUFYLElBQWlCb0QsUUFBakIsRUFBMkI7QUFDdkIsVUFBSXBELEVBQUUsSUFBSStDLE9BQU8sQ0FBQy9DLEVBQUQsQ0FBakIsRUFBdUI7QUFDbkI4QyxRQUFBQSxFQUFFLENBQUM5QyxFQUFELENBQUY7QUFDQTtBQUNIO0FBQ0o7QUFDSjs7QUFhTXFELEVBQUFBLE1BQU0sR0FBZ0I7QUFDekIsVUFBTUMsV0FBVyxHQUFHLEVBQXBCOztBQUNBLFFBQUksZ0NBQWUsS0FBS3ZELEtBQUwsQ0FBVzdCLE9BQTFCLENBQUosRUFBd0M7QUFDcENvRixNQUFBQSxXQUFXLENBQUNDLElBQVosZUFBaUIsNkJBQUMsNkNBQUQ7QUFDYixRQUFBLFNBQVMsRUFBQywrREFERztBQUViLFFBQUEsS0FBSyxFQUFFLHlCQUFHLE1BQUgsQ0FGTTtBQUdiLFFBQUEsT0FBTyxFQUFFLEtBQUtDLFdBSEQ7QUFJYixRQUFBLEdBQUcsRUFBQztBQUpTLFFBQWpCO0FBTUg7O0FBRUQsVUFBTUMsbUJBQW1CLGdCQUFHLDZCQUFDLDZDQUFEO0FBQ3hCLE1BQUEsU0FBUyxFQUFDLGlFQURjO0FBRXhCLE1BQUEsS0FBSyxFQUFFLHlCQUFHLFFBQUgsQ0FGaUI7QUFHeEIsTUFBQSxPQUFPLEVBQUUsS0FBS0MsYUFIVTtBQUl4QixNQUFBLEdBQUcsRUFBQztBQUpvQixNQUE1QixDQVh5QixDQWtCekI7OztBQUNBLFVBQU14RixPQUFPLEdBQUcsS0FBSzZCLEtBQUwsQ0FBVzdCLE9BQTNCO0FBQ0EsVUFBTXlGLFVBQVUsR0FBR3pGLE9BQU8sQ0FBQytFLGNBQVIsTUFBNEIvRSxPQUFPLENBQUMrRSxjQUFSLEdBQXlCN0IsTUFBeEU7QUFDQSxVQUFNd0MsWUFBWSxHQUFHMUYsT0FBTyxDQUFDaUYsbUJBQVIsTUFBaUNqRixPQUFPLENBQUNpRixtQkFBUixHQUE4Qi9CLE1BQXBGO0FBQ0EsVUFBTXlDLFdBQVcsR0FBRyxtQ0FBVTNGLE9BQU8sQ0FBQ2tELE1BQWxCLEtBQTZCLG1DQUFVdUMsVUFBVixDQUE3QixJQUFzRCxtQ0FBVUMsWUFBVixDQUExRTtBQUNBLFVBQU1FLFFBQVEsR0FBRyxDQUFDNUYsT0FBTyxDQUFDa0QsTUFBVCxFQUFpQnVDLFVBQWpCLEVBQTZCQyxZQUE3QixFQUEyQ2pCLFFBQTNDLENBQW9EckIsbUJBQVl5QyxRQUFoRSxDQUFqQjs7QUFDQSxRQUFJRixXQUFXLElBQUlDLFFBQW5CLEVBQTZCO0FBQ3pCO0FBQ0E7QUFDQVIsTUFBQUEsV0FBVyxDQUFDVSxNQUFaLENBQW1CLENBQW5CLEVBQXNCLENBQXRCLGVBQXlCLDZCQUFDLDZDQUFEO0FBQ3JCLFFBQUEsU0FBUyxFQUFDLGlFQURXO0FBRXJCLFFBQUEsS0FBSyxFQUFFLHlCQUFHLE9BQUgsQ0FGYztBQUdyQixRQUFBLE9BQU8sRUFBRSxLQUFLQyxhQUhPO0FBSXJCLFFBQUEsR0FBRyxFQUFDO0FBSmlCLFFBQXpCLEVBSHlCLENBVXpCOztBQUNBWCxNQUFBQSxXQUFXLENBQUNDLElBQVosQ0FBaUJFLG1CQUFqQjtBQUNILEtBWkQsTUFZTztBQUNILFVBQUkscUNBQW9CLEtBQUsxRCxLQUFMLENBQVc3QixPQUEvQixDQUFKLEVBQTZDO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBLFlBQUksS0FBS21DLE9BQUwsQ0FBYTZELFFBQWpCLEVBQTJCO0FBQ3ZCWixVQUFBQSxXQUFXLENBQUNVLE1BQVosQ0FBbUIsQ0FBbkIsRUFBc0IsQ0FBdEIsZUFBeUIseUVBQ3JCLDZCQUFDLDZDQUFEO0FBQ0ksWUFBQSxTQUFTLEVBQUMsZ0VBRGQ7QUFFSSxZQUFBLEtBQUssRUFBRSx5QkFBRyxPQUFILENBRlg7QUFHSSxZQUFBLE9BQU8sRUFBRSxLQUFLRyxZQUhsQjtBQUlJLFlBQUEsR0FBRyxFQUFDO0FBSlIsWUFEcUIsRUFPbEIsS0FBSy9CLHVCQUFOLGlCQUNFLDZCQUFDLDZDQUFEO0FBQ0ksWUFBQSxTQUFTLEVBQUMsaUVBRGQ7QUFFSSxZQUFBLEtBQUssRUFBRSx5QkFBRyxpQkFBSCxDQUZYO0FBR0ksWUFBQSxPQUFPLEVBQUUsS0FBS2dDLGFBSGxCO0FBSUksWUFBQSxHQUFHLEVBQUM7QUFKUixZQVJpQixDQUF6QjtBQWdCSDs7QUFDRCxZQUFJLEtBQUsvRCxPQUFMLENBQWFnRSxRQUFqQixFQUEyQjtBQUN2QmYsVUFBQUEsV0FBVyxDQUFDVSxNQUFaLENBQW1CLENBQW5CLEVBQXNCLENBQXRCLGVBQXlCLDZCQUFDLFdBQUQ7QUFDckIsWUFBQSxPQUFPLEVBQUUsS0FBS2pFLEtBQUwsQ0FBVzdCLE9BREM7QUFFckIsWUFBQSxTQUFTLEVBQUUsS0FBSzZCLEtBQUwsQ0FBV04sU0FGRDtBQUdyQixZQUFBLGFBQWEsRUFBRSxLQUFLbkIsYUFIQztBQUlyQixZQUFBLEdBQUcsRUFBQztBQUppQixZQUF6QjtBQU1ILFNBN0J3QyxDQStCekM7OztBQUNBLFlBQUlnRyxtQ0FBaUJDLFVBQWpCLENBQTRCLEtBQUt4RSxLQUFMLENBQVc3QixPQUF2QyxDQUFKLEVBQXFEO0FBQ2pEb0YsVUFBQUEsV0FBVyxDQUFDVSxNQUFaLENBQW1CLENBQW5CLEVBQXNCLENBQXRCLGVBQXlCLDZCQUFDLDZCQUFEO0FBQ3JCLFlBQUEsT0FBTyxFQUFFLEtBQUtqRSxLQUFMLENBQVc3QixPQURDO0FBRXJCLFlBQUEsbUJBQW1CLEVBQUU7QUFBQTs7QUFBQSw0Q0FBTSxvQkFBSzZCLEtBQUwsRUFBVzVCLE9BQWpCLGlGQUFNLGlFQUF1QnFHLGNBQTdCLDBEQUFNLGtEQUFOO0FBQUEsYUFGQTtBQUdyQixZQUFBLEdBQUcsRUFBQztBQUhpQixZQUF6QjtBQUtIO0FBQ0osT0F4Q0UsQ0F5Q0g7OztBQUNBLFVBQUksS0FBS25FLE9BQUwsQ0FBYUMscUJBQWIsS0FBdUNHLG1DQUFzQmdFLElBQTdELElBQ0FuQyx1QkFBY0MsUUFBZCxDQUF1QixnQkFBdkIsQ0FEQSxJQUVBLEtBQUt4QyxLQUFMLENBQVc3QixPQUFYLENBQW1Cd0csU0FBbkIsRUFGQSxJQUdBLENBQUMscUNBQW9CLEtBQUszRSxLQUFMLENBQVc3QixPQUEvQixDQUhMLEVBSUU7QUFDRW9GLFFBQUFBLFdBQVcsQ0FBQ3FCLE9BQVosZUFBb0IsNkJBQUMsNkNBQUQ7QUFDaEIsVUFBQSxTQUFTLEVBQUMsaUVBRE07QUFFaEIsVUFBQSxLQUFLLEVBQUUseUJBQUcsaUJBQUgsQ0FGUztBQUdoQixVQUFBLE9BQU8sRUFBRSxLQUFLUCxhQUhFO0FBSWhCLFVBQUEsR0FBRyxFQUFDO0FBSlksVUFBcEI7QUFNSDs7QUFFRCxVQUFJUCxXQUFKLEVBQWlCO0FBQ2JQLFFBQUFBLFdBQVcsQ0FBQ0MsSUFBWixDQUFpQkUsbUJBQWpCO0FBQ0g7O0FBRUQsVUFBSSxLQUFLMUQsS0FBTCxDQUFXNkUsZUFBWCxLQUErQnZGLFNBQS9CLElBQTRDd0Ysb0JBQVdDLFFBQVgsQ0FBb0IsS0FBSy9FLEtBQUwsQ0FBVzdCLE9BQS9CLENBQWhELEVBQXlGO0FBQ3JGLGNBQU02RyxlQUFlLEdBQUcseUJBQVc7QUFDL0IsNENBQWtDLElBREg7QUFFL0IscURBQTJDLENBQUMsS0FBS2hGLEtBQUwsQ0FBVzZFLGVBRnhCO0FBRy9CLHVEQUE2QyxLQUFLN0UsS0FBTCxDQUFXNkU7QUFIekIsU0FBWCxDQUF4QjtBQUtBdEIsUUFBQUEsV0FBVyxDQUFDQyxJQUFaLGVBQWlCLDZCQUFDLDZDQUFEO0FBQ2IsVUFBQSxTQUFTLEVBQUV3QixlQURFO0FBRWIsVUFBQSxLQUFLLEVBQUUsS0FBS2hGLEtBQUwsQ0FBVzZFLGVBQVgsR0FBNkIseUJBQUcsMkJBQUgsQ0FBN0IsR0FBK0QseUJBQUcseUJBQUgsQ0FGekQ7QUFHYixVQUFBLE9BQU8sRUFBRSxLQUFLN0UsS0FBTCxDQUFXaUYsb0JBSFA7QUFJYixVQUFBLEdBQUcsRUFBQztBQUpTLFVBQWpCO0FBTUgsT0F2RUUsQ0F5RUg7OztBQUNBMUIsTUFBQUEsV0FBVyxDQUFDQyxJQUFaLGVBQWlCLDZCQUFDLGFBQUQ7QUFDYixRQUFBLE9BQU8sRUFBRSxLQUFLeEQsS0FBTCxDQUFXN0IsT0FEUDtBQUViLFFBQUEsYUFBYSxFQUFFLEtBQUs2QixLQUFMLENBQVczQixhQUZiO0FBR2IsUUFBQSxPQUFPLEVBQUUsS0FBSzJCLEtBQUwsQ0FBVzVCLE9BSFA7QUFJYixRQUFBLGdCQUFnQixFQUFFLEtBQUs0QixLQUFMLENBQVcxQixnQkFKaEI7QUFLYixRQUFBLGFBQWEsRUFBRSxLQUFLQyxhQUxQO0FBTWIsUUFBQSxHQUFHLEVBQUM7QUFOUyxRQUFqQjtBQVFILEtBdEh3QixDQXdIekI7OztBQUNBLHdCQUFPLDZCQUFDLGdCQUFEO0FBQVMsTUFBQSxTQUFTLEVBQUMscUJBQW5CO0FBQXlDLG9CQUFZLHlCQUFHLGlCQUFILENBQXJEO0FBQTRFLG1CQUFVO0FBQXRGLE9BQ0RnRixXQURDLENBQVA7QUFHSDs7QUFwUHFGLEMsd0RBQzFEMkIsb0IiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuQ29weXJpZ2h0IDIwMTkgTmV3IFZlY3RvciBMdGRcbkNvcHlyaWdodCAyMDE5IE1pY2hhZWwgVGVsYXR5bnNraSA8N3QzY2hndXlAZ21haWwuY29tPlxuQ29weXJpZ2h0IDIwMTksIDIwMjAgVGhlIE1hdHJpeC5vcmcgRm91bmRhdGlvbiBDLkkuQy5cblxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbnlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbllvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuXG4gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cblVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbmRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxubGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4qL1xuXG5pbXBvcnQgUmVhY3QsIHsgdXNlRWZmZWN0IH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgRXZlbnRTdGF0dXMsIE1hdHJpeEV2ZW50IH0gZnJvbSAnbWF0cml4LWpzLXNkay9zcmMvbW9kZWxzL2V2ZW50JztcbmltcG9ydCB0eXBlIHsgUmVsYXRpb25zIH0gZnJvbSAnbWF0cml4LWpzLXNkay9zcmMvbW9kZWxzL3JlbGF0aW9ucyc7XG5cbmltcG9ydCB7IF90IH0gZnJvbSAnLi4vLi4vLi4vbGFuZ3VhZ2VIYW5kbGVyJztcbmltcG9ydCBkaXMgZnJvbSAnLi4vLi4vLi4vZGlzcGF0Y2hlci9kaXNwYXRjaGVyJztcbmltcG9ydCB7IEFjdGlvbiB9IGZyb20gJy4uLy4uLy4uL2Rpc3BhdGNoZXIvYWN0aW9ucyc7XG5pbXBvcnQgQ29udGV4dE1lbnUsIHsgYWJvdmVMZWZ0T2YsIENvbnRleHRNZW51VG9vbHRpcEJ1dHRvbiwgdXNlQ29udGV4dE1lbnUgfSBmcm9tICcuLi8uLi9zdHJ1Y3R1cmVzL0NvbnRleHRNZW51JztcbmltcG9ydCB7IGlzQ29udGVudEFjdGlvbmFibGUsIGNhbkVkaXRDb250ZW50IH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvRXZlbnRVdGlscyc7XG5pbXBvcnQgUm9vbUNvbnRleHQsIHsgVGltZWxpbmVSZW5kZXJpbmdUeXBlIH0gZnJvbSBcIi4uLy4uLy4uL2NvbnRleHRzL1Jvb21Db250ZXh0XCI7XG5pbXBvcnQgVG9vbGJhciBmcm9tIFwiLi4vLi4vLi4vYWNjZXNzaWJpbGl0eS9Ub29sYmFyXCI7XG5pbXBvcnQgeyBSb3ZpbmdBY2Nlc3NpYmxlVG9vbHRpcEJ1dHRvbiwgdXNlUm92aW5nVGFiSW5kZXggfSBmcm9tIFwiLi4vLi4vLi4vYWNjZXNzaWJpbGl0eS9Sb3ZpbmdUYWJJbmRleFwiO1xuaW1wb3J0IHsgcmVwbGFjZWFibGVDb21wb25lbnQgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvcmVwbGFjZWFibGVDb21wb25lbnRcIjtcbmltcG9ydCB7IGNhbkNhbmNlbCB9IGZyb20gXCIuLi9jb250ZXh0X21lbnVzL01lc3NhZ2VDb250ZXh0TWVudVwiO1xuaW1wb3J0IFJlc2VuZCBmcm9tIFwiLi4vLi4vLi4vUmVzZW5kXCI7XG5pbXBvcnQgeyBNYXRyaXhDbGllbnRQZWcgfSBmcm9tIFwiLi4vLi4vLi4vTWF0cml4Q2xpZW50UGVnXCI7XG5pbXBvcnQgeyBNZWRpYUV2ZW50SGVscGVyIH0gZnJvbSBcIi4uLy4uLy4uL3V0aWxzL01lZGlhRXZlbnRIZWxwZXJcIjtcbmltcG9ydCBEb3dubG9hZEFjdGlvbkJ1dHRvbiBmcm9tIFwiLi9Eb3dubG9hZEFjdGlvbkJ1dHRvblwiO1xuaW1wb3J0IE1lc3NhZ2VDb250ZXh0TWVudSBmcm9tIFwiLi4vY29udGV4dF9tZW51cy9NZXNzYWdlQ29udGV4dE1lbnVcIjtcbmltcG9ydCBjbGFzc05hbWVzIGZyb20gJ2NsYXNzbmFtZXMnO1xuXG5pbXBvcnQgU2V0dGluZ3NTdG9yZSBmcm9tICcuLi8uLi8uLi9zZXR0aW5ncy9TZXR0aW5nc1N0b3JlJztcbmltcG9ydCB7IFJvb21QZXJtYWxpbmtDcmVhdG9yIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvcGVybWFsaW5rcy9QZXJtYWxpbmtzJztcbmltcG9ydCBSZXBseUNoYWluIGZyb20gJy4uL2VsZW1lbnRzL1JlcGx5Q2hhaW4nO1xuaW1wb3J0IHsgZGlzcGF0Y2hTaG93VGhyZWFkRXZlbnQgfSBmcm9tICcuLi8uLi8uLi9kaXNwYXRjaGVyL2Rpc3BhdGNoLWFjdGlvbnMvdGhyZWFkcyc7XG5pbXBvcnQgUmVhY3Rpb25QaWNrZXIgZnJvbSBcIi4uL2Vtb2ppcGlja2VyL1JlYWN0aW9uUGlja2VyXCI7XG5pbXBvcnQgeyBNc2dUeXBlIH0gZnJvbSAnbWF0cml4LWpzLXNkay9zcmMvQHR5cGVzL2V2ZW50JztcblxuaW50ZXJmYWNlIElPcHRpb25zQnV0dG9uUHJvcHMge1xuICAgIG14RXZlbnQ6IE1hdHJpeEV2ZW50O1xuICAgIC8vIFRPRE86IFR5cGVzXG4gICAgZ2V0VGlsZTogKCkgPT4gYW55IHwgbnVsbDtcbiAgICBnZXRSZXBseUNoYWluOiAoKSA9PiBSZXBseUNoYWluO1xuICAgIHBlcm1hbGlua0NyZWF0b3I6IFJvb21QZXJtYWxpbmtDcmVhdG9yO1xuICAgIG9uRm9jdXNDaGFuZ2U6IChtZW51RGlzcGxheWVkOiBib29sZWFuKSA9PiB2b2lkO1xufVxuXG5jb25zdCBPcHRpb25zQnV0dG9uOiBSZWFjdC5GQzxJT3B0aW9uc0J1dHRvblByb3BzPiA9XG4gICAgKHsgbXhFdmVudCwgZ2V0VGlsZSwgZ2V0UmVwbHlDaGFpbiwgcGVybWFsaW5rQ3JlYXRvciwgb25Gb2N1c0NoYW5nZSB9KSA9PiB7XG4gICAgICAgIGNvbnN0IFttZW51RGlzcGxheWVkLCBidXR0b24sIG9wZW5NZW51LCBjbG9zZU1lbnVdID0gdXNlQ29udGV4dE1lbnUoKTtcbiAgICAgICAgY29uc3QgW29uRm9jdXMsIGlzQWN0aXZlLCByZWZdID0gdXNlUm92aW5nVGFiSW5kZXgoYnV0dG9uKTtcbiAgICAgICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgICAgIG9uRm9jdXNDaGFuZ2UobWVudURpc3BsYXllZCk7XG4gICAgICAgIH0sIFtvbkZvY3VzQ2hhbmdlLCBtZW51RGlzcGxheWVkXSk7XG5cbiAgICAgICAgbGV0IGNvbnRleHRNZW51O1xuICAgICAgICBpZiAobWVudURpc3BsYXllZCkge1xuICAgICAgICAgICAgY29uc3QgdGlsZSA9IGdldFRpbGUgJiYgZ2V0VGlsZSgpO1xuICAgICAgICAgICAgY29uc3QgcmVwbHlDaGFpbiA9IGdldFJlcGx5Q2hhaW4gJiYgZ2V0UmVwbHlDaGFpbigpO1xuXG4gICAgICAgICAgICBjb25zdCBidXR0b25SZWN0ID0gYnV0dG9uLmN1cnJlbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgICAgICBjb250ZXh0TWVudSA9IDxNZXNzYWdlQ29udGV4dE1lbnVcbiAgICAgICAgICAgICAgICB7Li4uYWJvdmVMZWZ0T2YoYnV0dG9uUmVjdCl9XG4gICAgICAgICAgICAgICAgbXhFdmVudD17bXhFdmVudH1cbiAgICAgICAgICAgICAgICBwZXJtYWxpbmtDcmVhdG9yPXtwZXJtYWxpbmtDcmVhdG9yfVxuICAgICAgICAgICAgICAgIGV2ZW50VGlsZU9wcz17dGlsZSAmJiB0aWxlLmdldEV2ZW50VGlsZU9wcyA/IHRpbGUuZ2V0RXZlbnRUaWxlT3BzKCkgOiB1bmRlZmluZWR9XG4gICAgICAgICAgICAgICAgY29sbGFwc2VSZXBseUNoYWluPXtyZXBseUNoYWluICYmIHJlcGx5Q2hhaW4uY2FuQ29sbGFwc2UoKSA/IHJlcGx5Q2hhaW4uY29sbGFwc2UgOiB1bmRlZmluZWR9XG4gICAgICAgICAgICAgICAgb25GaW5pc2hlZD17Y2xvc2VNZW51fVxuICAgICAgICAgICAgLz47XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gPFJlYWN0LkZyYWdtZW50PlxuICAgICAgICAgICAgPENvbnRleHRNZW51VG9vbHRpcEJ1dHRvblxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm14X01lc3NhZ2VBY3Rpb25CYXJfbWFza0J1dHRvbiBteF9NZXNzYWdlQWN0aW9uQmFyX29wdGlvbnNCdXR0b25cIlxuICAgICAgICAgICAgICAgIHRpdGxlPXtfdChcIk9wdGlvbnNcIil9XG4gICAgICAgICAgICAgICAgb25DbGljaz17b3Blbk1lbnV9XG4gICAgICAgICAgICAgICAgaXNFeHBhbmRlZD17bWVudURpc3BsYXllZH1cbiAgICAgICAgICAgICAgICBpbnB1dFJlZj17cmVmfVxuICAgICAgICAgICAgICAgIG9uRm9jdXM9e29uRm9jdXN9XG4gICAgICAgICAgICAgICAgdGFiSW5kZXg9e2lzQWN0aXZlID8gMCA6IC0xfVxuICAgICAgICAgICAgLz5cblxuICAgICAgICAgICAgeyBjb250ZXh0TWVudSB9XG4gICAgICAgIDwvUmVhY3QuRnJhZ21lbnQ+O1xuICAgIH07XG5cbmludGVyZmFjZSBJUmVhY3RCdXR0b25Qcm9wcyB7XG4gICAgbXhFdmVudDogTWF0cml4RXZlbnQ7XG4gICAgcmVhY3Rpb25zOiBSZWxhdGlvbnM7XG4gICAgb25Gb2N1c0NoYW5nZTogKG1lbnVEaXNwbGF5ZWQ6IGJvb2xlYW4pID0+IHZvaWQ7XG59XG5cbmNvbnN0IFJlYWN0QnV0dG9uOiBSZWFjdC5GQzxJUmVhY3RCdXR0b25Qcm9wcz4gPSAoeyBteEV2ZW50LCByZWFjdGlvbnMsIG9uRm9jdXNDaGFuZ2UgfSkgPT4ge1xuICAgIGNvbnN0IFttZW51RGlzcGxheWVkLCBidXR0b24sIG9wZW5NZW51LCBjbG9zZU1lbnVdID0gdXNlQ29udGV4dE1lbnUoKTtcbiAgICBjb25zdCBbb25Gb2N1cywgaXNBY3RpdmUsIHJlZl0gPSB1c2VSb3ZpbmdUYWJJbmRleChidXR0b24pO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIG9uRm9jdXNDaGFuZ2UobWVudURpc3BsYXllZCk7XG4gICAgfSwgW29uRm9jdXNDaGFuZ2UsIG1lbnVEaXNwbGF5ZWRdKTtcblxuICAgIGxldCBjb250ZXh0TWVudTtcbiAgICBpZiAobWVudURpc3BsYXllZCkge1xuICAgICAgICBjb25zdCBidXR0b25SZWN0ID0gYnV0dG9uLmN1cnJlbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIGNvbnRleHRNZW51ID0gPENvbnRleHRNZW51IHsuLi5hYm92ZUxlZnRPZihidXR0b25SZWN0KX0gb25GaW5pc2hlZD17Y2xvc2VNZW51fSBtYW5hZ2VkPXtmYWxzZX0+XG4gICAgICAgICAgICA8UmVhY3Rpb25QaWNrZXIgbXhFdmVudD17bXhFdmVudH0gcmVhY3Rpb25zPXtyZWFjdGlvbnN9IG9uRmluaXNoZWQ9e2Nsb3NlTWVudX0gLz5cbiAgICAgICAgPC9Db250ZXh0TWVudT47XG4gICAgfVxuXG4gICAgcmV0dXJuIDxSZWFjdC5GcmFnbWVudD5cbiAgICAgICAgPENvbnRleHRNZW51VG9vbHRpcEJ1dHRvblxuICAgICAgICAgICAgY2xhc3NOYW1lPVwibXhfTWVzc2FnZUFjdGlvbkJhcl9tYXNrQnV0dG9uIG14X01lc3NhZ2VBY3Rpb25CYXJfcmVhY3RCdXR0b25cIlxuICAgICAgICAgICAgdGl0bGU9e190KFwiUmVhY3RcIil9XG4gICAgICAgICAgICBvbkNsaWNrPXtvcGVuTWVudX1cbiAgICAgICAgICAgIGlzRXhwYW5kZWQ9e21lbnVEaXNwbGF5ZWR9XG4gICAgICAgICAgICBpbnB1dFJlZj17cmVmfVxuICAgICAgICAgICAgb25Gb2N1cz17b25Gb2N1c31cbiAgICAgICAgICAgIHRhYkluZGV4PXtpc0FjdGl2ZSA/IDAgOiAtMX1cbiAgICAgICAgLz5cblxuICAgICAgICB7IGNvbnRleHRNZW51IH1cbiAgICA8L1JlYWN0LkZyYWdtZW50Pjtcbn07XG5cbmludGVyZmFjZSBJTWVzc2FnZUFjdGlvbkJhclByb3BzIHtcbiAgICBteEV2ZW50OiBNYXRyaXhFdmVudDtcbiAgICByZWFjdGlvbnM/OiBSZWxhdGlvbnM7XG4gICAgLy8gVE9ETzogVHlwZXNcbiAgICBnZXRUaWxlOiAoKSA9PiBhbnkgfCBudWxsO1xuICAgIGdldFJlcGx5Q2hhaW46ICgpID0+IFJlcGx5Q2hhaW4gfCB1bmRlZmluZWQ7XG4gICAgcGVybWFsaW5rQ3JlYXRvcj86IFJvb21QZXJtYWxpbmtDcmVhdG9yO1xuICAgIG9uRm9jdXNDaGFuZ2U/OiAobWVudURpc3BsYXllZDogYm9vbGVhbikgPT4gdm9pZDtcbiAgICB0b2dnbGVUaHJlYWRFeHBhbmRlZDogKCkgPT4gdm9pZDtcbiAgICBpc1F1b3RlRXhwYW5kZWQ/OiBib29sZWFuO1xufVxuXG5AcmVwbGFjZWFibGVDb21wb25lbnQoXCJ2aWV3cy5tZXNzYWdlcy5NZXNzYWdlQWN0aW9uQmFyXCIpXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNZXNzYWdlQWN0aW9uQmFyIGV4dGVuZHMgUmVhY3QuUHVyZUNvbXBvbmVudDxJTWVzc2FnZUFjdGlvbkJhclByb3BzPiB7XG4gICAgcHVibGljIHN0YXRpYyBjb250ZXh0VHlwZSA9IFJvb21Db250ZXh0O1xuXG4gICAgcHVibGljIGNvbXBvbmVudERpZE1vdW50KCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5wcm9wcy5teEV2ZW50LnN0YXR1cyAmJiB0aGlzLnByb3BzLm14RXZlbnQuc3RhdHVzICE9PSBFdmVudFN0YXR1cy5TRU5UKSB7XG4gICAgICAgICAgICB0aGlzLnByb3BzLm14RXZlbnQub24oXCJFdmVudC5zdGF0dXNcIiwgdGhpcy5vblNlbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY2xpZW50ID0gTWF0cml4Q2xpZW50UGVnLmdldCgpO1xuICAgICAgICBjbGllbnQuZGVjcnlwdEV2ZW50SWZOZWVkZWQodGhpcy5wcm9wcy5teEV2ZW50KTtcblxuICAgICAgICBpZiAodGhpcy5wcm9wcy5teEV2ZW50LmlzQmVpbmdEZWNyeXB0ZWQoKSkge1xuICAgICAgICAgICAgdGhpcy5wcm9wcy5teEV2ZW50Lm9uY2UoXCJFdmVudC5kZWNyeXB0ZWRcIiwgdGhpcy5vbkRlY3J5cHRlZCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcm9wcy5teEV2ZW50Lm9uKFwiRXZlbnQuYmVmb3JlUmVkYWN0aW9uXCIsIHRoaXMub25CZWZvcmVSZWRhY3Rpb24pO1xuICAgIH1cblxuICAgIHB1YmxpYyBjb21wb25lbnRXaWxsVW5tb3VudCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5wcm9wcy5teEV2ZW50Lm9mZihcIkV2ZW50LnN0YXR1c1wiLCB0aGlzLm9uU2VudCk7XG4gICAgICAgIHRoaXMucHJvcHMubXhFdmVudC5vZmYoXCJFdmVudC5kZWNyeXB0ZWRcIiwgdGhpcy5vbkRlY3J5cHRlZCk7XG4gICAgICAgIHRoaXMucHJvcHMubXhFdmVudC5vZmYoXCJFdmVudC5iZWZvcmVSZWRhY3Rpb25cIiwgdGhpcy5vbkJlZm9yZVJlZGFjdGlvbik7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvbkRlY3J5cHRlZCA9ICgpOiB2b2lkID0+IHtcbiAgICAgICAgLy8gV2hlbiBhbiBldmVudCBkZWNyeXB0cywgaXQgaXMgbGlrZWx5IHRvIGNoYW5nZSB0aGUgc2V0IG9mIGF2YWlsYWJsZVxuICAgICAgICAvLyBhY3Rpb25zLCBzbyB3ZSBmb3JjZSBhbiB1cGRhdGUgdG8gY2hlY2sgYWdhaW4uXG4gICAgICAgIHRoaXMuZm9yY2VVcGRhdGUoKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkJlZm9yZVJlZGFjdGlvbiA9ICgpOiB2b2lkID0+IHtcbiAgICAgICAgLy8gV2hlbiBhbiBldmVudCBpcyByZWRhY3RlZCwgd2UgY2FuJ3QgZWRpdCBpdCBzbyB1cGRhdGUgdGhlIGF2YWlsYWJsZSBhY3Rpb25zLlxuICAgICAgICB0aGlzLmZvcmNlVXBkYXRlKCk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25TZW50ID0gKCk6IHZvaWQgPT4ge1xuICAgICAgICAvLyBXaGVuIGFuIGV2ZW50IGlzIHNlbnQgYW5kIGVjaG9lZCB0aGUgcG9zc2libGUgYWN0aW9ucyBjaGFuZ2UuXG4gICAgICAgIHRoaXMuZm9yY2VVcGRhdGUoKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkZvY3VzQ2hhbmdlID0gKGZvY3VzZWQ6IGJvb2xlYW4pOiB2b2lkID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLnByb3BzLm9uRm9jdXNDaGFuZ2UpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByb3BzLm9uRm9jdXNDaGFuZ2UoZm9jdXNlZCk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25SZXBseUNsaWNrID0gKGV2OiBSZWFjdC5Nb3VzZUV2ZW50KTogdm9pZCA9PiB7XG4gICAgICAgIGRpcy5kaXNwYXRjaCh7XG4gICAgICAgICAgICBhY3Rpb246ICdyZXBseV90b19ldmVudCcsXG4gICAgICAgICAgICBldmVudDogdGhpcy5wcm9wcy5teEV2ZW50LFxuICAgICAgICAgICAgY29udGV4dDogdGhpcy5jb250ZXh0LnRpbWVsaW5lUmVuZGVyaW5nVHlwZSxcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25UaHJlYWRDbGljayA9ICgpOiB2b2lkID0+IHtcbiAgICAgICAgZGlzcGF0Y2hTaG93VGhyZWFkRXZlbnQodGhpcy5wcm9wcy5teEV2ZW50KTtcbiAgICAgICAgZGlzLmRpc3BhdGNoKHtcbiAgICAgICAgICAgIGFjdGlvbjogQWN0aW9uLkZvY3VzU2VuZE1lc3NhZ2VDb21wb3NlcixcbiAgICAgICAgICAgIGNvbnRleHQ6IFRpbWVsaW5lUmVuZGVyaW5nVHlwZS5UaHJlYWQsXG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uRWRpdENsaWNrID0gKGV2OiBSZWFjdC5Nb3VzZUV2ZW50KTogdm9pZCA9PiB7XG4gICAgICAgIGRpcy5kaXNwYXRjaCh7XG4gICAgICAgICAgICBhY3Rpb246IEFjdGlvbi5FZGl0RXZlbnQsXG4gICAgICAgICAgICBldmVudDogdGhpcy5wcm9wcy5teEV2ZW50LFxuICAgICAgICAgICAgdGltZWxpbmVSZW5kZXJpbmdUeXBlOiB0aGlzLmNvbnRleHQudGltZWxpbmVSZW5kZXJpbmdUeXBlLFxuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSByZWFkb25seSBmb3JiaWRkZW5UaHJlYWRIZWFkTXNnVHlwZSA9IFtcbiAgICAgICAgTXNnVHlwZS5LZXlWZXJpZmljYXRpb25SZXF1ZXN0LFxuICAgIF07XG5cbiAgICBwcml2YXRlIGdldCBzaG93UmVwbHlJblRocmVhZEFjdGlvbigpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgaXNUaHJlYWRFbmFibGVkID0gU2V0dGluZ3NTdG9yZS5nZXRWYWx1ZShcImZlYXR1cmVfdGhyZWFkXCIpO1xuICAgICAgICBjb25zdCBpbk5vdFRocmVhZFRpbWVsaW5lID0gdGhpcy5jb250ZXh0LnRpbWVsaW5lUmVuZGVyaW5nVHlwZSAhPT0gVGltZWxpbmVSZW5kZXJpbmdUeXBlLlRocmVhZDtcblxuICAgICAgICBjb25zdCBpc0FsbG93ZWRNZXNzYWdlVHlwZSA9ICF0aGlzLmZvcmJpZGRlblRocmVhZEhlYWRNc2dUeXBlLmluY2x1ZGVzKFxuICAgICAgICAgICAgdGhpcy5wcm9wcy5teEV2ZW50LmdldENvbnRlbnQoKS5tc2d0eXBlIGFzIE1zZ1R5cGUsXG4gICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIGlzVGhyZWFkRW5hYmxlZCAmJiBpbk5vdFRocmVhZFRpbWVsaW5lICYmIGlzQWxsb3dlZE1lc3NhZ2VUeXBlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJ1bnMgYSBnaXZlbiBmbiBvbiB0aGUgc2V0IG9mIHBvc3NpYmxlIGV2ZW50cyB0byB0ZXN0LiBUaGUgZmlyc3QgZXZlbnRcbiAgICAgKiB0aGF0IHBhc3NlcyB0aGUgY2hlY2tGbiB3aWxsIGhhdmUgZm4gZXhlY3V0ZWQgb24gaXQuIEJvdGggZnVuY3Rpb25zIHRha2VcbiAgICAgKiBhIE1hdHJpeEV2ZW50IG9iamVjdC4gSWYgbm8gcGFydGljdWxhciBjb25kaXRpb25zIGFyZSBuZWVkZWQsIGNoZWNrRm4gY2FuXG4gICAgICogYmUgbnVsbC91bmRlZmluZWQuIElmIG5vIGZ1bmN0aW9ucyBwYXNzIHRoZSBjaGVja0ZuLCBubyBhY3Rpb24gd2lsbCBiZVxuICAgICAqIHRha2VuLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBleGVjdXRpb24gZnVuY3Rpb24uXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2hlY2tGbiBUaGUgdGVzdCBmdW5jdGlvbi5cbiAgICAgKi9cbiAgICBwcml2YXRlIHJ1bkFjdGlvbk9uRmFpbGVkRXYoZm46IChldjogTWF0cml4RXZlbnQpID0+IHZvaWQsIGNoZWNrRm4/OiAoZXY6IE1hdHJpeEV2ZW50KSA9PiBib29sZWFuKTogdm9pZCB7XG4gICAgICAgIGlmICghY2hlY2tGbikgY2hlY2tGbiA9ICgpID0+IHRydWU7XG5cbiAgICAgICAgY29uc3QgbXhFdmVudCA9IHRoaXMucHJvcHMubXhFdmVudDtcbiAgICAgICAgY29uc3QgZWRpdEV2ZW50ID0gbXhFdmVudC5yZXBsYWNpbmdFdmVudCgpO1xuICAgICAgICBjb25zdCByZWRhY3RFdmVudCA9IG14RXZlbnQubG9jYWxSZWRhY3Rpb25FdmVudCgpO1xuICAgICAgICBjb25zdCB0cnlPcmRlciA9IFtyZWRhY3RFdmVudCwgZWRpdEV2ZW50LCBteEV2ZW50XTtcbiAgICAgICAgZm9yIChjb25zdCBldiBvZiB0cnlPcmRlcikge1xuICAgICAgICAgICAgaWYgKGV2ICYmIGNoZWNrRm4oZXYpKSB7XG4gICAgICAgICAgICAgICAgZm4oZXYpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvblJlc2VuZENsaWNrID0gKGV2OiBSZWFjdC5Nb3VzZUV2ZW50KTogdm9pZCA9PiB7XG4gICAgICAgIHRoaXMucnVuQWN0aW9uT25GYWlsZWRFdigodGFyRXYpID0+IFJlc2VuZC5yZXNlbmQodGFyRXYpKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkNhbmNlbENsaWNrID0gKGV2OiBSZWFjdC5Nb3VzZUV2ZW50KTogdm9pZCA9PiB7XG4gICAgICAgIHRoaXMucnVuQWN0aW9uT25GYWlsZWRFdihcbiAgICAgICAgICAgICh0YXJFdikgPT4gUmVzZW5kLnJlbW92ZUZyb21RdWV1ZSh0YXJFdiksXG4gICAgICAgICAgICAodGVzdEV2KSA9PiBjYW5DYW5jZWwodGVzdEV2LnN0YXR1cyksXG4gICAgICAgICk7XG4gICAgfTtcblxuICAgIHB1YmxpYyByZW5kZXIoKTogSlNYLkVsZW1lbnQge1xuICAgICAgICBjb25zdCB0b29sYmFyT3B0cyA9IFtdO1xuICAgICAgICBpZiAoY2FuRWRpdENvbnRlbnQodGhpcy5wcm9wcy5teEV2ZW50KSkge1xuICAgICAgICAgICAgdG9vbGJhck9wdHMucHVzaCg8Um92aW5nQWNjZXNzaWJsZVRvb2x0aXBCdXR0b25cbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJteF9NZXNzYWdlQWN0aW9uQmFyX21hc2tCdXR0b24gbXhfTWVzc2FnZUFjdGlvbkJhcl9lZGl0QnV0dG9uXCJcbiAgICAgICAgICAgICAgICB0aXRsZT17X3QoXCJFZGl0XCIpfVxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMub25FZGl0Q2xpY2t9XG4gICAgICAgICAgICAgICAga2V5PVwiZWRpdFwiXG4gICAgICAgICAgICAvPik7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjYW5jZWxTZW5kaW5nQnV0dG9uID0gPFJvdmluZ0FjY2Vzc2libGVUb29sdGlwQnV0dG9uXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJteF9NZXNzYWdlQWN0aW9uQmFyX21hc2tCdXR0b24gbXhfTWVzc2FnZUFjdGlvbkJhcl9jYW5jZWxCdXR0b25cIlxuICAgICAgICAgICAgdGl0bGU9e190KFwiRGVsZXRlXCIpfVxuICAgICAgICAgICAgb25DbGljaz17dGhpcy5vbkNhbmNlbENsaWNrfVxuICAgICAgICAgICAga2V5PVwiY2FuY2VsXCJcbiAgICAgICAgLz47XG5cbiAgICAgICAgLy8gV2Ugc2hvdyBhIGRpZmZlcmVudCB0b29sYmFyIGZvciBmYWlsZWQgZXZlbnRzLCBzbyBkZXRlY3QgdGhhdCBmaXJzdC5cbiAgICAgICAgY29uc3QgbXhFdmVudCA9IHRoaXMucHJvcHMubXhFdmVudDtcbiAgICAgICAgY29uc3QgZWRpdFN0YXR1cyA9IG14RXZlbnQucmVwbGFjaW5nRXZlbnQoKSAmJiBteEV2ZW50LnJlcGxhY2luZ0V2ZW50KCkuc3RhdHVzO1xuICAgICAgICBjb25zdCByZWRhY3RTdGF0dXMgPSBteEV2ZW50LmxvY2FsUmVkYWN0aW9uRXZlbnQoKSAmJiBteEV2ZW50LmxvY2FsUmVkYWN0aW9uRXZlbnQoKS5zdGF0dXM7XG4gICAgICAgIGNvbnN0IGFsbG93Q2FuY2VsID0gY2FuQ2FuY2VsKG14RXZlbnQuc3RhdHVzKSB8fCBjYW5DYW5jZWwoZWRpdFN0YXR1cykgfHwgY2FuQ2FuY2VsKHJlZGFjdFN0YXR1cyk7XG4gICAgICAgIGNvbnN0IGlzRmFpbGVkID0gW214RXZlbnQuc3RhdHVzLCBlZGl0U3RhdHVzLCByZWRhY3RTdGF0dXNdLmluY2x1ZGVzKEV2ZW50U3RhdHVzLk5PVF9TRU5UKTtcbiAgICAgICAgaWYgKGFsbG93Q2FuY2VsICYmIGlzRmFpbGVkKSB7XG4gICAgICAgICAgICAvLyBUaGUgcmVzZW5kIGJ1dHRvbiBuZWVkcyB0byBhcHBlYXIgYWhlYWQgb2YgdGhlIGVkaXQgYnV0dG9uLCBzbyBpbnNlcnQgdG8gdGhlXG4gICAgICAgICAgICAvLyBzdGFydCBvZiB0aGUgb3B0c1xuICAgICAgICAgICAgdG9vbGJhck9wdHMuc3BsaWNlKDAsIDAsIDxSb3ZpbmdBY2Nlc3NpYmxlVG9vbHRpcEJ1dHRvblxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm14X01lc3NhZ2VBY3Rpb25CYXJfbWFza0J1dHRvbiBteF9NZXNzYWdlQWN0aW9uQmFyX3Jlc2VuZEJ1dHRvblwiXG4gICAgICAgICAgICAgICAgdGl0bGU9e190KFwiUmV0cnlcIil9XG4gICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5vblJlc2VuZENsaWNrfVxuICAgICAgICAgICAgICAgIGtleT1cInJlc2VuZFwiXG4gICAgICAgICAgICAvPik7XG5cbiAgICAgICAgICAgIC8vIFRoZSBkZWxldGUgYnV0dG9uIHNob3VsZCBhcHBlYXIgbGFzdCwgc28gd2UgY2FuIGp1c3QgZHJvcCBpdCBhdCB0aGUgZW5kXG4gICAgICAgICAgICB0b29sYmFyT3B0cy5wdXNoKGNhbmNlbFNlbmRpbmdCdXR0b24pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKGlzQ29udGVudEFjdGlvbmFibGUodGhpcy5wcm9wcy5teEV2ZW50KSkge1xuICAgICAgICAgICAgICAgIC8vIExpa2UgdGhlIHJlc2VuZCBidXR0b24sIHRoZSByZWFjdCBhbmQgcmVwbHkgYnV0dG9ucyBuZWVkIHRvIGFwcGVhciBiZWZvcmUgdGhlIGVkaXQuXG4gICAgICAgICAgICAgICAgLy8gVGhlIG9ubHkgY2F0Y2ggaXMgd2UgZG8gdGhlIHJlcGx5IGJ1dHRvbiBmaXJzdCBzbyB0aGF0IHdlIGNhbiBtYWtlIHN1cmUgdGhlIHJlYWN0XG4gICAgICAgICAgICAgICAgLy8gYnV0dG9uIGlzIHRoZSB2ZXJ5IGZpcnN0IGJ1dHRvbiB3aXRob3V0IGhhdmluZyB0byBkbyBsZW5ndGggY2hlY2tzIGZvciBgc3BsaWNlKClgLlxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbnRleHQuY2FuUmVwbHkpIHtcbiAgICAgICAgICAgICAgICAgICAgdG9vbGJhck9wdHMuc3BsaWNlKDAsIDAsIDw+XG4gICAgICAgICAgICAgICAgICAgICAgICA8Um92aW5nQWNjZXNzaWJsZVRvb2x0aXBCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJteF9NZXNzYWdlQWN0aW9uQmFyX21hc2tCdXR0b24gbXhfTWVzc2FnZUFjdGlvbkJhcl9yZXBseUJ1dHRvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e190KFwiUmVwbHlcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5vblJlcGx5Q2xpY2t9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5PVwicmVwbHlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIHsgKHRoaXMuc2hvd1JlcGx5SW5UaHJlYWRBY3Rpb24pICYmIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Um92aW5nQWNjZXNzaWJsZVRvb2x0aXBCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXhfTWVzc2FnZUFjdGlvbkJhcl9tYXNrQnV0dG9uIG14X01lc3NhZ2VBY3Rpb25CYXJfdGhyZWFkQnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e190KFwiUmVwbHkgaW4gdGhyZWFkXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uVGhyZWFkQ2xpY2t9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT1cInRocmVhZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICkgfVxuICAgICAgICAgICAgICAgICAgICA8Lz4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jb250ZXh0LmNhblJlYWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRvb2xiYXJPcHRzLnNwbGljZSgwLCAwLCA8UmVhY3RCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgIG14RXZlbnQ9e3RoaXMucHJvcHMubXhFdmVudH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlYWN0aW9ucz17dGhpcy5wcm9wcy5yZWFjdGlvbnN9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkZvY3VzQ2hhbmdlPXt0aGlzLm9uRm9jdXNDaGFuZ2V9XG4gICAgICAgICAgICAgICAgICAgICAgICBrZXk9XCJyZWFjdFwiXG4gICAgICAgICAgICAgICAgICAgIC8+KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBYWFg6IEFzc3VtaW5nIHRoYXQgdGhlIHVuZGVybHlpbmcgdGlsZSB3aWxsIGJlIGEgbWVkaWEgZXZlbnQgaWYgaXQgaXMgZWxpZ2libGUgbWVkaWEuXG4gICAgICAgICAgICAgICAgaWYgKE1lZGlhRXZlbnRIZWxwZXIuaXNFbGlnaWJsZSh0aGlzLnByb3BzLm14RXZlbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvb2xiYXJPcHRzLnNwbGljZSgwLCAwLCA8RG93bmxvYWRBY3Rpb25CdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgIG14RXZlbnQ9e3RoaXMucHJvcHMubXhFdmVudH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG1lZGlhRXZlbnRIZWxwZXJHZXQ9eygpID0+IHRoaXMucHJvcHMuZ2V0VGlsZT8uKCkuZ2V0TWVkaWFIZWxwZXI/LigpfVxuICAgICAgICAgICAgICAgICAgICAgICAga2V5PVwiZG93bmxvYWRcIlxuICAgICAgICAgICAgICAgICAgICAvPik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gU2hvdyB0aHJlYWQgaWNvbiBldmVuIGZvciBkZWxldGVkIG1lc3NhZ2VzLCBidXQgb25seSB3aXRoaW4gbWFpbiB0aW1lbGluZVxuICAgICAgICAgICAgaWYgKHRoaXMuY29udGV4dC50aW1lbGluZVJlbmRlcmluZ1R5cGUgPT09IFRpbWVsaW5lUmVuZGVyaW5nVHlwZS5Sb29tICYmXG4gICAgICAgICAgICAgICAgU2V0dGluZ3NTdG9yZS5nZXRWYWx1ZShcImZlYXR1cmVfdGhyZWFkXCIpICYmXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5teEV2ZW50LmdldFRocmVhZCgpICYmXG4gICAgICAgICAgICAgICAgIWlzQ29udGVudEFjdGlvbmFibGUodGhpcy5wcm9wcy5teEV2ZW50KVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgdG9vbGJhck9wdHMudW5zaGlmdCg8Um92aW5nQWNjZXNzaWJsZVRvb2x0aXBCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXhfTWVzc2FnZUFjdGlvbkJhcl9tYXNrQnV0dG9uIG14X01lc3NhZ2VBY3Rpb25CYXJfdGhyZWFkQnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU9e190KFwiUmVwbHkgaW4gdGhyZWFkXCIpfVxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uVGhyZWFkQ2xpY2t9XG4gICAgICAgICAgICAgICAgICAgIGtleT1cInRocmVhZFwiXG4gICAgICAgICAgICAgICAgLz4pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoYWxsb3dDYW5jZWwpIHtcbiAgICAgICAgICAgICAgICB0b29sYmFyT3B0cy5wdXNoKGNhbmNlbFNlbmRpbmdCdXR0b24pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5wcm9wcy5pc1F1b3RlRXhwYW5kZWQgIT09IHVuZGVmaW5lZCAmJiBSZXBseUNoYWluLmhhc1JlcGx5KHRoaXMucHJvcHMubXhFdmVudCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBleHBhbmRDbGFzc05hbWUgPSBjbGFzc05hbWVzKHtcbiAgICAgICAgICAgICAgICAgICAgJ214X01lc3NhZ2VBY3Rpb25CYXJfbWFza0J1dHRvbic6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICdteF9NZXNzYWdlQWN0aW9uQmFyX2V4cGFuZE1lc3NhZ2VCdXR0b24nOiAhdGhpcy5wcm9wcy5pc1F1b3RlRXhwYW5kZWQsXG4gICAgICAgICAgICAgICAgICAgICdteF9NZXNzYWdlQWN0aW9uQmFyX2NvbGxhcHNlTWVzc2FnZUJ1dHRvbic6IHRoaXMucHJvcHMuaXNRdW90ZUV4cGFuZGVkLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRvb2xiYXJPcHRzLnB1c2goPFJvdmluZ0FjY2Vzc2libGVUb29sdGlwQnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17ZXhwYW5kQ2xhc3NOYW1lfVxuICAgICAgICAgICAgICAgICAgICB0aXRsZT17dGhpcy5wcm9wcy5pc1F1b3RlRXhwYW5kZWQgPyBfdChcIkNvbGxhcHNlIHF1b3RlcyDilIIg4oenK2NsaWNrXCIpIDogX3QoXCJFeHBhbmQgcXVvdGVzIOKUgiDih6crY2xpY2tcIil9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMucHJvcHMudG9nZ2xlVGhyZWFkRXhwYW5kZWR9XG4gICAgICAgICAgICAgICAgICAgIGtleT1cImV4cGFuZFwiXG4gICAgICAgICAgICAgICAgLz4pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBUaGUgbWVudSBidXR0b24gc2hvdWxkIGJlIGxhc3QsIHNvIGR1bXAgaXQgdGhlcmUuXG4gICAgICAgICAgICB0b29sYmFyT3B0cy5wdXNoKDxPcHRpb25zQnV0dG9uXG4gICAgICAgICAgICAgICAgbXhFdmVudD17dGhpcy5wcm9wcy5teEV2ZW50fVxuICAgICAgICAgICAgICAgIGdldFJlcGx5Q2hhaW49e3RoaXMucHJvcHMuZ2V0UmVwbHlDaGFpbn1cbiAgICAgICAgICAgICAgICBnZXRUaWxlPXt0aGlzLnByb3BzLmdldFRpbGV9XG4gICAgICAgICAgICAgICAgcGVybWFsaW5rQ3JlYXRvcj17dGhpcy5wcm9wcy5wZXJtYWxpbmtDcmVhdG9yfVxuICAgICAgICAgICAgICAgIG9uRm9jdXNDaGFuZ2U9e3RoaXMub25Gb2N1c0NoYW5nZX1cbiAgICAgICAgICAgICAgICBrZXk9XCJtZW51XCJcbiAgICAgICAgICAgIC8+KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGFyaWEtbGl2ZT1vZmYgdG8gbm90IGhhdmUgdGhpcyByZWFkIG91dCBhdXRvbWF0aWNhbGx5IGFzIG5hdmlnYXRpbmcgYXJvdW5kIHRpbWVsaW5lLCBnZXRzIHJlcGV0aXRpdmUuXG4gICAgICAgIHJldHVybiA8VG9vbGJhciBjbGFzc05hbWU9XCJteF9NZXNzYWdlQWN0aW9uQmFyXCIgYXJpYS1sYWJlbD17X3QoXCJNZXNzYWdlIEFjdGlvbnNcIil9IGFyaWEtbGl2ZT1cIm9mZlwiPlxuICAgICAgICAgICAgeyB0b29sYmFyT3B0cyB9XG4gICAgICAgIDwvVG9vbGJhcj47XG4gICAgfVxufVxuIl19