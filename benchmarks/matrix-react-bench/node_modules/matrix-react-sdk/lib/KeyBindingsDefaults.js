"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.defaultBindingsProvider = void 0;

var _KeyBindingsManager = require("./KeyBindingsManager");

var _Keyboard = require("./Keyboard");

var _SettingsStore = _interopRequireDefault(require("./settings/SettingsStore"));

/*
Copyright 2021 Clemens Zeidler

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
const messageComposerBindings = () => {
  const bindings = [{
    action: _KeyBindingsManager.MessageComposerAction.SelectPrevSendHistory,
    keyCombo: {
      key: _Keyboard.Key.ARROW_UP,
      altKey: true,
      ctrlKey: true
    }
  }, {
    action: _KeyBindingsManager.MessageComposerAction.SelectNextSendHistory,
    keyCombo: {
      key: _Keyboard.Key.ARROW_DOWN,
      altKey: true,
      ctrlKey: true
    }
  }, {
    action: _KeyBindingsManager.MessageComposerAction.EditPrevMessage,
    keyCombo: {
      key: _Keyboard.Key.ARROW_UP
    }
  }, {
    action: _KeyBindingsManager.MessageComposerAction.EditNextMessage,
    keyCombo: {
      key: _Keyboard.Key.ARROW_DOWN
    }
  }, {
    action: _KeyBindingsManager.MessageComposerAction.CancelEditing,
    keyCombo: {
      key: _Keyboard.Key.ESCAPE
    }
  }, {
    action: _KeyBindingsManager.MessageComposerAction.FormatBold,
    keyCombo: {
      key: _Keyboard.Key.B,
      ctrlOrCmd: true
    }
  }, {
    action: _KeyBindingsManager.MessageComposerAction.FormatItalics,
    keyCombo: {
      key: _Keyboard.Key.I,
      ctrlOrCmd: true
    }
  }, {
    action: _KeyBindingsManager.MessageComposerAction.FormatQuote,
    keyCombo: {
      key: _Keyboard.Key.GREATER_THAN,
      ctrlOrCmd: true,
      shiftKey: true
    }
  }, {
    action: _KeyBindingsManager.MessageComposerAction.EditUndo,
    keyCombo: {
      key: _Keyboard.Key.Z,
      ctrlOrCmd: true
    }
  }, {
    action: _KeyBindingsManager.MessageComposerAction.MoveCursorToStart,
    keyCombo: {
      key: _Keyboard.Key.HOME,
      ctrlOrCmd: true
    }
  }, {
    action: _KeyBindingsManager.MessageComposerAction.MoveCursorToEnd,
    keyCombo: {
      key: _Keyboard.Key.END,
      ctrlOrCmd: true
    }
  }];

  if (_Keyboard.isMac) {
    bindings.push({
      action: _KeyBindingsManager.MessageComposerAction.EditRedo,
      keyCombo: {
        key: _Keyboard.Key.Z,
        ctrlOrCmd: true,
        shiftKey: true
      }
    });
  } else {
    bindings.push({
      action: _KeyBindingsManager.MessageComposerAction.EditRedo,
      keyCombo: {
        key: _Keyboard.Key.Y,
        ctrlOrCmd: true
      }
    });
  }

  if (_SettingsStore.default.getValue('MessageComposerInput.ctrlEnterToSend')) {
    bindings.push({
      action: _KeyBindingsManager.MessageComposerAction.Send,
      keyCombo: {
        key: _Keyboard.Key.ENTER,
        ctrlOrCmd: true
      }
    });
    bindings.push({
      action: _KeyBindingsManager.MessageComposerAction.NewLine,
      keyCombo: {
        key: _Keyboard.Key.ENTER
      }
    });
  } else {
    bindings.push({
      action: _KeyBindingsManager.MessageComposerAction.Send,
      keyCombo: {
        key: _Keyboard.Key.ENTER
      }
    });
    bindings.push({
      action: _KeyBindingsManager.MessageComposerAction.NewLine,
      keyCombo: {
        key: _Keyboard.Key.ENTER,
        shiftKey: true
      }
    });

    if (_Keyboard.isMac) {
      bindings.push({
        action: _KeyBindingsManager.MessageComposerAction.NewLine,
        keyCombo: {
          key: _Keyboard.Key.ENTER,
          altKey: true
        }
      });
    }
  }

  return bindings;
};

const autocompleteBindings = () => {
  return [{
    action: _KeyBindingsManager.AutocompleteAction.ForceComplete,
    keyCombo: {
      key: _Keyboard.Key.TAB
    }
  }, {
    action: _KeyBindingsManager.AutocompleteAction.ForceComplete,
    keyCombo: {
      key: _Keyboard.Key.TAB,
      ctrlKey: true
    }
  }, {
    action: _KeyBindingsManager.AutocompleteAction.Complete,
    keyCombo: {
      key: _Keyboard.Key.ENTER
    }
  }, {
    action: _KeyBindingsManager.AutocompleteAction.Complete,
    keyCombo: {
      key: _Keyboard.Key.ENTER,
      ctrlKey: true
    }
  }, {
    action: _KeyBindingsManager.AutocompleteAction.Cancel,
    keyCombo: {
      key: _Keyboard.Key.ESCAPE
    }
  }, {
    action: _KeyBindingsManager.AutocompleteAction.PrevSelection,
    keyCombo: {
      key: _Keyboard.Key.ARROW_UP
    }
  }, {
    action: _KeyBindingsManager.AutocompleteAction.NextSelection,
    keyCombo: {
      key: _Keyboard.Key.ARROW_DOWN
    }
  }];
};

const roomListBindings = () => {
  return [{
    action: _KeyBindingsManager.RoomListAction.ClearSearch,
    keyCombo: {
      key: _Keyboard.Key.ESCAPE
    }
  }, {
    action: _KeyBindingsManager.RoomListAction.PrevRoom,
    keyCombo: {
      key: _Keyboard.Key.ARROW_UP
    }
  }, {
    action: _KeyBindingsManager.RoomListAction.NextRoom,
    keyCombo: {
      key: _Keyboard.Key.ARROW_DOWN
    }
  }, {
    action: _KeyBindingsManager.RoomListAction.SelectRoom,
    keyCombo: {
      key: _Keyboard.Key.ENTER
    }
  }, {
    action: _KeyBindingsManager.RoomListAction.CollapseSection,
    keyCombo: {
      key: _Keyboard.Key.ARROW_LEFT
    }
  }, {
    action: _KeyBindingsManager.RoomListAction.ExpandSection,
    keyCombo: {
      key: _Keyboard.Key.ARROW_RIGHT
    }
  }];
};

const roomBindings = () => {
  const bindings = [{
    action: _KeyBindingsManager.RoomAction.ScrollUp,
    keyCombo: {
      key: _Keyboard.Key.PAGE_UP
    }
  }, {
    action: _KeyBindingsManager.RoomAction.RoomScrollDown,
    keyCombo: {
      key: _Keyboard.Key.PAGE_DOWN
    }
  }, {
    action: _KeyBindingsManager.RoomAction.DismissReadMarker,
    keyCombo: {
      key: _Keyboard.Key.ESCAPE
    }
  }, {
    action: _KeyBindingsManager.RoomAction.JumpToOldestUnread,
    keyCombo: {
      key: _Keyboard.Key.PAGE_UP,
      shiftKey: true
    }
  }, {
    action: _KeyBindingsManager.RoomAction.UploadFile,
    keyCombo: {
      key: _Keyboard.Key.U,
      ctrlOrCmd: true,
      shiftKey: true
    }
  }, {
    action: _KeyBindingsManager.RoomAction.JumpToFirstMessage,
    keyCombo: {
      key: _Keyboard.Key.HOME,
      ctrlKey: true
    }
  }, {
    action: _KeyBindingsManager.RoomAction.JumpToLatestMessage,
    keyCombo: {
      key: _Keyboard.Key.END,
      ctrlKey: true
    }
  }];

  if (_SettingsStore.default.getValue('ctrlFForSearch')) {
    bindings.push({
      action: _KeyBindingsManager.RoomAction.FocusSearch,
      keyCombo: {
        key: _Keyboard.Key.F,
        ctrlOrCmd: true
      }
    });
  }

  return bindings;
};

const navigationBindings = () => {
  return [{
    action: _KeyBindingsManager.NavigationAction.FocusRoomSearch,
    keyCombo: {
      key: _Keyboard.Key.K,
      ctrlOrCmd: true
    }
  }, {
    action: _KeyBindingsManager.NavigationAction.ToggleRoomSidePanel,
    keyCombo: {
      key: _Keyboard.Key.PERIOD,
      ctrlOrCmd: true
    }
  }, {
    action: _KeyBindingsManager.NavigationAction.ToggleUserMenu,
    // Ideally this would be CTRL+P for "Profile", but that's
    // taken by the print dialog. CTRL+I for "Information"
    // was previously chosen but conflicted with italics in
    // composer, so CTRL+` it is
    keyCombo: {
      key: _Keyboard.Key.BACKTICK,
      ctrlOrCmd: true
    }
  }, {
    action: _KeyBindingsManager.NavigationAction.ToggleShortCutDialog,
    keyCombo: {
      key: _Keyboard.Key.SLASH,
      ctrlOrCmd: true
    }
  }, {
    action: _KeyBindingsManager.NavigationAction.ToggleShortCutDialog,
    keyCombo: {
      key: _Keyboard.Key.SLASH,
      ctrlOrCmd: true,
      shiftKey: true
    }
  }, {
    action: _KeyBindingsManager.NavigationAction.GoToHome,
    keyCombo: {
      key: _Keyboard.Key.H,
      ctrlKey: true,
      altKey: !_Keyboard.isMac,
      shiftKey: _Keyboard.isMac
    }
  }, {
    action: _KeyBindingsManager.NavigationAction.SelectPrevRoom,
    keyCombo: {
      key: _Keyboard.Key.ARROW_UP,
      altKey: true
    }
  }, {
    action: _KeyBindingsManager.NavigationAction.SelectNextRoom,
    keyCombo: {
      key: _Keyboard.Key.ARROW_DOWN,
      altKey: true
    }
  }, {
    action: _KeyBindingsManager.NavigationAction.SelectPrevUnreadRoom,
    keyCombo: {
      key: _Keyboard.Key.ARROW_UP,
      altKey: true,
      shiftKey: true
    }
  }, {
    action: _KeyBindingsManager.NavigationAction.SelectNextUnreadRoom,
    keyCombo: {
      key: _Keyboard.Key.ARROW_DOWN,
      altKey: true,
      shiftKey: true
    }
  }];
};

const defaultBindingsProvider = {
  getMessageComposerBindings: messageComposerBindings,
  getAutocompleteBindings: autocompleteBindings,
  getRoomListBindings: roomListBindings,
  getRoomBindings: roomBindings,
  getNavigationBindings: navigationBindings
};
exports.defaultBindingsProvider = defaultBindingsProvider;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9LZXlCaW5kaW5nc0RlZmF1bHRzLnRzIl0sIm5hbWVzIjpbIm1lc3NhZ2VDb21wb3NlckJpbmRpbmdzIiwiYmluZGluZ3MiLCJhY3Rpb24iLCJNZXNzYWdlQ29tcG9zZXJBY3Rpb24iLCJTZWxlY3RQcmV2U2VuZEhpc3RvcnkiLCJrZXlDb21ibyIsImtleSIsIktleSIsIkFSUk9XX1VQIiwiYWx0S2V5IiwiY3RybEtleSIsIlNlbGVjdE5leHRTZW5kSGlzdG9yeSIsIkFSUk9XX0RPV04iLCJFZGl0UHJldk1lc3NhZ2UiLCJFZGl0TmV4dE1lc3NhZ2UiLCJDYW5jZWxFZGl0aW5nIiwiRVNDQVBFIiwiRm9ybWF0Qm9sZCIsIkIiLCJjdHJsT3JDbWQiLCJGb3JtYXRJdGFsaWNzIiwiSSIsIkZvcm1hdFF1b3RlIiwiR1JFQVRFUl9USEFOIiwic2hpZnRLZXkiLCJFZGl0VW5kbyIsIloiLCJNb3ZlQ3Vyc29yVG9TdGFydCIsIkhPTUUiLCJNb3ZlQ3Vyc29yVG9FbmQiLCJFTkQiLCJpc01hYyIsInB1c2giLCJFZGl0UmVkbyIsIlkiLCJTZXR0aW5nc1N0b3JlIiwiZ2V0VmFsdWUiLCJTZW5kIiwiRU5URVIiLCJOZXdMaW5lIiwiYXV0b2NvbXBsZXRlQmluZGluZ3MiLCJBdXRvY29tcGxldGVBY3Rpb24iLCJGb3JjZUNvbXBsZXRlIiwiVEFCIiwiQ29tcGxldGUiLCJDYW5jZWwiLCJQcmV2U2VsZWN0aW9uIiwiTmV4dFNlbGVjdGlvbiIsInJvb21MaXN0QmluZGluZ3MiLCJSb29tTGlzdEFjdGlvbiIsIkNsZWFyU2VhcmNoIiwiUHJldlJvb20iLCJOZXh0Um9vbSIsIlNlbGVjdFJvb20iLCJDb2xsYXBzZVNlY3Rpb24iLCJBUlJPV19MRUZUIiwiRXhwYW5kU2VjdGlvbiIsIkFSUk9XX1JJR0hUIiwicm9vbUJpbmRpbmdzIiwiUm9vbUFjdGlvbiIsIlNjcm9sbFVwIiwiUEFHRV9VUCIsIlJvb21TY3JvbGxEb3duIiwiUEFHRV9ET1dOIiwiRGlzbWlzc1JlYWRNYXJrZXIiLCJKdW1wVG9PbGRlc3RVbnJlYWQiLCJVcGxvYWRGaWxlIiwiVSIsIkp1bXBUb0ZpcnN0TWVzc2FnZSIsIkp1bXBUb0xhdGVzdE1lc3NhZ2UiLCJGb2N1c1NlYXJjaCIsIkYiLCJuYXZpZ2F0aW9uQmluZGluZ3MiLCJOYXZpZ2F0aW9uQWN0aW9uIiwiRm9jdXNSb29tU2VhcmNoIiwiSyIsIlRvZ2dsZVJvb21TaWRlUGFuZWwiLCJQRVJJT0QiLCJUb2dnbGVVc2VyTWVudSIsIkJBQ0tUSUNLIiwiVG9nZ2xlU2hvcnRDdXREaWFsb2ciLCJTTEFTSCIsIkdvVG9Ib21lIiwiSCIsIlNlbGVjdFByZXZSb29tIiwiU2VsZWN0TmV4dFJvb20iLCJTZWxlY3RQcmV2VW5yZWFkUm9vbSIsIlNlbGVjdE5leHRVbnJlYWRSb29tIiwiZGVmYXVsdEJpbmRpbmdzUHJvdmlkZXIiLCJnZXRNZXNzYWdlQ29tcG9zZXJCaW5kaW5ncyIsImdldEF1dG9jb21wbGV0ZUJpbmRpbmdzIiwiZ2V0Um9vbUxpc3RCaW5kaW5ncyIsImdldFJvb21CaW5kaW5ncyIsImdldE5hdmlnYXRpb25CaW5kaW5ncyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBZ0JBOztBQUVBOztBQUNBOztBQW5CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPQSxNQUFNQSx1QkFBdUIsR0FBRyxNQUEyQztBQUN2RSxRQUFNQyxRQUE2QyxHQUFHLENBQ2xEO0FBQ0lDLElBQUFBLE1BQU0sRUFBRUMsMENBQXNCQyxxQkFEbEM7QUFFSUMsSUFBQUEsUUFBUSxFQUFFO0FBQ05DLE1BQUFBLEdBQUcsRUFBRUMsY0FBSUMsUUFESDtBQUVOQyxNQUFBQSxNQUFNLEVBQUUsSUFGRjtBQUdOQyxNQUFBQSxPQUFPLEVBQUU7QUFISDtBQUZkLEdBRGtELEVBU2xEO0FBQ0lSLElBQUFBLE1BQU0sRUFBRUMsMENBQXNCUSxxQkFEbEM7QUFFSU4sSUFBQUEsUUFBUSxFQUFFO0FBQ05DLE1BQUFBLEdBQUcsRUFBRUMsY0FBSUssVUFESDtBQUVOSCxNQUFBQSxNQUFNLEVBQUUsSUFGRjtBQUdOQyxNQUFBQSxPQUFPLEVBQUU7QUFISDtBQUZkLEdBVGtELEVBaUJsRDtBQUNJUixJQUFBQSxNQUFNLEVBQUVDLDBDQUFzQlUsZUFEbEM7QUFFSVIsSUFBQUEsUUFBUSxFQUFFO0FBQ05DLE1BQUFBLEdBQUcsRUFBRUMsY0FBSUM7QUFESDtBQUZkLEdBakJrRCxFQXVCbEQ7QUFDSU4sSUFBQUEsTUFBTSxFQUFFQywwQ0FBc0JXLGVBRGxDO0FBRUlULElBQUFBLFFBQVEsRUFBRTtBQUNOQyxNQUFBQSxHQUFHLEVBQUVDLGNBQUlLO0FBREg7QUFGZCxHQXZCa0QsRUE2QmxEO0FBQ0lWLElBQUFBLE1BQU0sRUFBRUMsMENBQXNCWSxhQURsQztBQUVJVixJQUFBQSxRQUFRLEVBQUU7QUFDTkMsTUFBQUEsR0FBRyxFQUFFQyxjQUFJUztBQURIO0FBRmQsR0E3QmtELEVBbUNsRDtBQUNJZCxJQUFBQSxNQUFNLEVBQUVDLDBDQUFzQmMsVUFEbEM7QUFFSVosSUFBQUEsUUFBUSxFQUFFO0FBQ05DLE1BQUFBLEdBQUcsRUFBRUMsY0FBSVcsQ0FESDtBQUVOQyxNQUFBQSxTQUFTLEVBQUU7QUFGTDtBQUZkLEdBbkNrRCxFQTBDbEQ7QUFDSWpCLElBQUFBLE1BQU0sRUFBRUMsMENBQXNCaUIsYUFEbEM7QUFFSWYsSUFBQUEsUUFBUSxFQUFFO0FBQ05DLE1BQUFBLEdBQUcsRUFBRUMsY0FBSWMsQ0FESDtBQUVORixNQUFBQSxTQUFTLEVBQUU7QUFGTDtBQUZkLEdBMUNrRCxFQWlEbEQ7QUFDSWpCLElBQUFBLE1BQU0sRUFBRUMsMENBQXNCbUIsV0FEbEM7QUFFSWpCLElBQUFBLFFBQVEsRUFBRTtBQUNOQyxNQUFBQSxHQUFHLEVBQUVDLGNBQUlnQixZQURIO0FBRU5KLE1BQUFBLFNBQVMsRUFBRSxJQUZMO0FBR05LLE1BQUFBLFFBQVEsRUFBRTtBQUhKO0FBRmQsR0FqRGtELEVBeURsRDtBQUNJdEIsSUFBQUEsTUFBTSxFQUFFQywwQ0FBc0JzQixRQURsQztBQUVJcEIsSUFBQUEsUUFBUSxFQUFFO0FBQ05DLE1BQUFBLEdBQUcsRUFBRUMsY0FBSW1CLENBREg7QUFFTlAsTUFBQUEsU0FBUyxFQUFFO0FBRkw7QUFGZCxHQXpEa0QsRUFnRWxEO0FBQ0lqQixJQUFBQSxNQUFNLEVBQUVDLDBDQUFzQndCLGlCQURsQztBQUVJdEIsSUFBQUEsUUFBUSxFQUFFO0FBQ05DLE1BQUFBLEdBQUcsRUFBRUMsY0FBSXFCLElBREg7QUFFTlQsTUFBQUEsU0FBUyxFQUFFO0FBRkw7QUFGZCxHQWhFa0QsRUF1RWxEO0FBQ0lqQixJQUFBQSxNQUFNLEVBQUVDLDBDQUFzQjBCLGVBRGxDO0FBRUl4QixJQUFBQSxRQUFRLEVBQUU7QUFDTkMsTUFBQUEsR0FBRyxFQUFFQyxjQUFJdUIsR0FESDtBQUVOWCxNQUFBQSxTQUFTLEVBQUU7QUFGTDtBQUZkLEdBdkVrRCxDQUF0RDs7QUErRUEsTUFBSVksZUFBSixFQUFXO0FBQ1A5QixJQUFBQSxRQUFRLENBQUMrQixJQUFULENBQWM7QUFDVjlCLE1BQUFBLE1BQU0sRUFBRUMsMENBQXNCOEIsUUFEcEI7QUFFVjVCLE1BQUFBLFFBQVEsRUFBRTtBQUNOQyxRQUFBQSxHQUFHLEVBQUVDLGNBQUltQixDQURIO0FBRU5QLFFBQUFBLFNBQVMsRUFBRSxJQUZMO0FBR05LLFFBQUFBLFFBQVEsRUFBRTtBQUhKO0FBRkEsS0FBZDtBQVFILEdBVEQsTUFTTztBQUNIdkIsSUFBQUEsUUFBUSxDQUFDK0IsSUFBVCxDQUFjO0FBQ1Y5QixNQUFBQSxNQUFNLEVBQUVDLDBDQUFzQjhCLFFBRHBCO0FBRVY1QixNQUFBQSxRQUFRLEVBQUU7QUFDTkMsUUFBQUEsR0FBRyxFQUFFQyxjQUFJMkIsQ0FESDtBQUVOZixRQUFBQSxTQUFTLEVBQUU7QUFGTDtBQUZBLEtBQWQ7QUFPSDs7QUFDRCxNQUFJZ0IsdUJBQWNDLFFBQWQsQ0FBdUIsc0NBQXZCLENBQUosRUFBb0U7QUFDaEVuQyxJQUFBQSxRQUFRLENBQUMrQixJQUFULENBQWM7QUFDVjlCLE1BQUFBLE1BQU0sRUFBRUMsMENBQXNCa0MsSUFEcEI7QUFFVmhDLE1BQUFBLFFBQVEsRUFBRTtBQUNOQyxRQUFBQSxHQUFHLEVBQUVDLGNBQUkrQixLQURIO0FBRU5uQixRQUFBQSxTQUFTLEVBQUU7QUFGTDtBQUZBLEtBQWQ7QUFPQWxCLElBQUFBLFFBQVEsQ0FBQytCLElBQVQsQ0FBYztBQUNWOUIsTUFBQUEsTUFBTSxFQUFFQywwQ0FBc0JvQyxPQURwQjtBQUVWbEMsTUFBQUEsUUFBUSxFQUFFO0FBQ05DLFFBQUFBLEdBQUcsRUFBRUMsY0FBSStCO0FBREg7QUFGQSxLQUFkO0FBTUgsR0FkRCxNQWNPO0FBQ0hyQyxJQUFBQSxRQUFRLENBQUMrQixJQUFULENBQWM7QUFDVjlCLE1BQUFBLE1BQU0sRUFBRUMsMENBQXNCa0MsSUFEcEI7QUFFVmhDLE1BQUFBLFFBQVEsRUFBRTtBQUNOQyxRQUFBQSxHQUFHLEVBQUVDLGNBQUkrQjtBQURIO0FBRkEsS0FBZDtBQU1BckMsSUFBQUEsUUFBUSxDQUFDK0IsSUFBVCxDQUFjO0FBQ1Y5QixNQUFBQSxNQUFNLEVBQUVDLDBDQUFzQm9DLE9BRHBCO0FBRVZsQyxNQUFBQSxRQUFRLEVBQUU7QUFDTkMsUUFBQUEsR0FBRyxFQUFFQyxjQUFJK0IsS0FESDtBQUVOZCxRQUFBQSxRQUFRLEVBQUU7QUFGSjtBQUZBLEtBQWQ7O0FBT0EsUUFBSU8sZUFBSixFQUFXO0FBQ1A5QixNQUFBQSxRQUFRLENBQUMrQixJQUFULENBQWM7QUFDVjlCLFFBQUFBLE1BQU0sRUFBRUMsMENBQXNCb0MsT0FEcEI7QUFFVmxDLFFBQUFBLFFBQVEsRUFBRTtBQUNOQyxVQUFBQSxHQUFHLEVBQUVDLGNBQUkrQixLQURIO0FBRU43QixVQUFBQSxNQUFNLEVBQUU7QUFGRjtBQUZBLE9BQWQ7QUFPSDtBQUNKOztBQUNELFNBQU9SLFFBQVA7QUFDSCxDQXpJRDs7QUEySUEsTUFBTXVDLG9CQUFvQixHQUFHLE1BQXdDO0FBQ2pFLFNBQU8sQ0FDSDtBQUNJdEMsSUFBQUEsTUFBTSxFQUFFdUMsdUNBQW1CQyxhQUQvQjtBQUVJckMsSUFBQUEsUUFBUSxFQUFFO0FBQ05DLE1BQUFBLEdBQUcsRUFBRUMsY0FBSW9DO0FBREg7QUFGZCxHQURHLEVBT0g7QUFDSXpDLElBQUFBLE1BQU0sRUFBRXVDLHVDQUFtQkMsYUFEL0I7QUFFSXJDLElBQUFBLFFBQVEsRUFBRTtBQUNOQyxNQUFBQSxHQUFHLEVBQUVDLGNBQUlvQyxHQURIO0FBRU5qQyxNQUFBQSxPQUFPLEVBQUU7QUFGSDtBQUZkLEdBUEcsRUFjSDtBQUNJUixJQUFBQSxNQUFNLEVBQUV1Qyx1Q0FBbUJHLFFBRC9CO0FBRUl2QyxJQUFBQSxRQUFRLEVBQUU7QUFDTkMsTUFBQUEsR0FBRyxFQUFFQyxjQUFJK0I7QUFESDtBQUZkLEdBZEcsRUFvQkg7QUFDSXBDLElBQUFBLE1BQU0sRUFBRXVDLHVDQUFtQkcsUUFEL0I7QUFFSXZDLElBQUFBLFFBQVEsRUFBRTtBQUNOQyxNQUFBQSxHQUFHLEVBQUVDLGNBQUkrQixLQURIO0FBRU41QixNQUFBQSxPQUFPLEVBQUU7QUFGSDtBQUZkLEdBcEJHLEVBMkJIO0FBQ0lSLElBQUFBLE1BQU0sRUFBRXVDLHVDQUFtQkksTUFEL0I7QUFFSXhDLElBQUFBLFFBQVEsRUFBRTtBQUNOQyxNQUFBQSxHQUFHLEVBQUVDLGNBQUlTO0FBREg7QUFGZCxHQTNCRyxFQWlDSDtBQUNJZCxJQUFBQSxNQUFNLEVBQUV1Qyx1Q0FBbUJLLGFBRC9CO0FBRUl6QyxJQUFBQSxRQUFRLEVBQUU7QUFDTkMsTUFBQUEsR0FBRyxFQUFFQyxjQUFJQztBQURIO0FBRmQsR0FqQ0csRUF1Q0g7QUFDSU4sSUFBQUEsTUFBTSxFQUFFdUMsdUNBQW1CTSxhQUQvQjtBQUVJMUMsSUFBQUEsUUFBUSxFQUFFO0FBQ05DLE1BQUFBLEdBQUcsRUFBRUMsY0FBSUs7QUFESDtBQUZkLEdBdkNHLENBQVA7QUE4Q0gsQ0EvQ0Q7O0FBaURBLE1BQU1vQyxnQkFBZ0IsR0FBRyxNQUFvQztBQUN6RCxTQUFPLENBQ0g7QUFDSTlDLElBQUFBLE1BQU0sRUFBRStDLG1DQUFlQyxXQUQzQjtBQUVJN0MsSUFBQUEsUUFBUSxFQUFFO0FBQ05DLE1BQUFBLEdBQUcsRUFBRUMsY0FBSVM7QUFESDtBQUZkLEdBREcsRUFPSDtBQUNJZCxJQUFBQSxNQUFNLEVBQUUrQyxtQ0FBZUUsUUFEM0I7QUFFSTlDLElBQUFBLFFBQVEsRUFBRTtBQUNOQyxNQUFBQSxHQUFHLEVBQUVDLGNBQUlDO0FBREg7QUFGZCxHQVBHLEVBYUg7QUFDSU4sSUFBQUEsTUFBTSxFQUFFK0MsbUNBQWVHLFFBRDNCO0FBRUkvQyxJQUFBQSxRQUFRLEVBQUU7QUFDTkMsTUFBQUEsR0FBRyxFQUFFQyxjQUFJSztBQURIO0FBRmQsR0FiRyxFQW1CSDtBQUNJVixJQUFBQSxNQUFNLEVBQUUrQyxtQ0FBZUksVUFEM0I7QUFFSWhELElBQUFBLFFBQVEsRUFBRTtBQUNOQyxNQUFBQSxHQUFHLEVBQUVDLGNBQUkrQjtBQURIO0FBRmQsR0FuQkcsRUF5Qkg7QUFDSXBDLElBQUFBLE1BQU0sRUFBRStDLG1DQUFlSyxlQUQzQjtBQUVJakQsSUFBQUEsUUFBUSxFQUFFO0FBQ05DLE1BQUFBLEdBQUcsRUFBRUMsY0FBSWdEO0FBREg7QUFGZCxHQXpCRyxFQStCSDtBQUNJckQsSUFBQUEsTUFBTSxFQUFFK0MsbUNBQWVPLGFBRDNCO0FBRUluRCxJQUFBQSxRQUFRLEVBQUU7QUFDTkMsTUFBQUEsR0FBRyxFQUFFQyxjQUFJa0Q7QUFESDtBQUZkLEdBL0JHLENBQVA7QUFzQ0gsQ0F2Q0Q7O0FBeUNBLE1BQU1DLFlBQVksR0FBRyxNQUFnQztBQUNqRCxRQUFNekQsUUFBa0MsR0FBRyxDQUN2QztBQUNJQyxJQUFBQSxNQUFNLEVBQUV5RCwrQkFBV0MsUUFEdkI7QUFFSXZELElBQUFBLFFBQVEsRUFBRTtBQUNOQyxNQUFBQSxHQUFHLEVBQUVDLGNBQUlzRDtBQURIO0FBRmQsR0FEdUMsRUFPdkM7QUFDSTNELElBQUFBLE1BQU0sRUFBRXlELCtCQUFXRyxjQUR2QjtBQUVJekQsSUFBQUEsUUFBUSxFQUFFO0FBQ05DLE1BQUFBLEdBQUcsRUFBRUMsY0FBSXdEO0FBREg7QUFGZCxHQVB1QyxFQWF2QztBQUNJN0QsSUFBQUEsTUFBTSxFQUFFeUQsK0JBQVdLLGlCQUR2QjtBQUVJM0QsSUFBQUEsUUFBUSxFQUFFO0FBQ05DLE1BQUFBLEdBQUcsRUFBRUMsY0FBSVM7QUFESDtBQUZkLEdBYnVDLEVBbUJ2QztBQUNJZCxJQUFBQSxNQUFNLEVBQUV5RCwrQkFBV00sa0JBRHZCO0FBRUk1RCxJQUFBQSxRQUFRLEVBQUU7QUFDTkMsTUFBQUEsR0FBRyxFQUFFQyxjQUFJc0QsT0FESDtBQUVOckMsTUFBQUEsUUFBUSxFQUFFO0FBRko7QUFGZCxHQW5CdUMsRUEwQnZDO0FBQ0l0QixJQUFBQSxNQUFNLEVBQUV5RCwrQkFBV08sVUFEdkI7QUFFSTdELElBQUFBLFFBQVEsRUFBRTtBQUNOQyxNQUFBQSxHQUFHLEVBQUVDLGNBQUk0RCxDQURIO0FBRU5oRCxNQUFBQSxTQUFTLEVBQUUsSUFGTDtBQUdOSyxNQUFBQSxRQUFRLEVBQUU7QUFISjtBQUZkLEdBMUJ1QyxFQWtDdkM7QUFDSXRCLElBQUFBLE1BQU0sRUFBRXlELCtCQUFXUyxrQkFEdkI7QUFFSS9ELElBQUFBLFFBQVEsRUFBRTtBQUNOQyxNQUFBQSxHQUFHLEVBQUVDLGNBQUlxQixJQURIO0FBRU5sQixNQUFBQSxPQUFPLEVBQUU7QUFGSDtBQUZkLEdBbEN1QyxFQXlDdkM7QUFDSVIsSUFBQUEsTUFBTSxFQUFFeUQsK0JBQVdVLG1CQUR2QjtBQUVJaEUsSUFBQUEsUUFBUSxFQUFFO0FBQ05DLE1BQUFBLEdBQUcsRUFBRUMsY0FBSXVCLEdBREg7QUFFTnBCLE1BQUFBLE9BQU8sRUFBRTtBQUZIO0FBRmQsR0F6Q3VDLENBQTNDOztBQWtEQSxNQUFJeUIsdUJBQWNDLFFBQWQsQ0FBdUIsZ0JBQXZCLENBQUosRUFBOEM7QUFDMUNuQyxJQUFBQSxRQUFRLENBQUMrQixJQUFULENBQWM7QUFDVjlCLE1BQUFBLE1BQU0sRUFBRXlELCtCQUFXVyxXQURUO0FBRVZqRSxNQUFBQSxRQUFRLEVBQUU7QUFDTkMsUUFBQUEsR0FBRyxFQUFFQyxjQUFJZ0UsQ0FESDtBQUVOcEQsUUFBQUEsU0FBUyxFQUFFO0FBRkw7QUFGQSxLQUFkO0FBT0g7O0FBRUQsU0FBT2xCLFFBQVA7QUFDSCxDQTlERDs7QUFnRUEsTUFBTXVFLGtCQUFrQixHQUFHLE1BQXNDO0FBQzdELFNBQU8sQ0FDSDtBQUNJdEUsSUFBQUEsTUFBTSxFQUFFdUUscUNBQWlCQyxlQUQ3QjtBQUVJckUsSUFBQUEsUUFBUSxFQUFFO0FBQ05DLE1BQUFBLEdBQUcsRUFBRUMsY0FBSW9FLENBREg7QUFFTnhELE1BQUFBLFNBQVMsRUFBRTtBQUZMO0FBRmQsR0FERyxFQVFIO0FBQ0lqQixJQUFBQSxNQUFNLEVBQUV1RSxxQ0FBaUJHLG1CQUQ3QjtBQUVJdkUsSUFBQUEsUUFBUSxFQUFFO0FBQ05DLE1BQUFBLEdBQUcsRUFBRUMsY0FBSXNFLE1BREg7QUFFTjFELE1BQUFBLFNBQVMsRUFBRTtBQUZMO0FBRmQsR0FSRyxFQWVIO0FBQ0lqQixJQUFBQSxNQUFNLEVBQUV1RSxxQ0FBaUJLLGNBRDdCO0FBRUk7QUFDQTtBQUNBO0FBQ0E7QUFDQXpFLElBQUFBLFFBQVEsRUFBRTtBQUNOQyxNQUFBQSxHQUFHLEVBQUVDLGNBQUl3RSxRQURIO0FBRU41RCxNQUFBQSxTQUFTLEVBQUU7QUFGTDtBQU5kLEdBZkcsRUEwQkg7QUFDSWpCLElBQUFBLE1BQU0sRUFBRXVFLHFDQUFpQk8sb0JBRDdCO0FBRUkzRSxJQUFBQSxRQUFRLEVBQUU7QUFDTkMsTUFBQUEsR0FBRyxFQUFFQyxjQUFJMEUsS0FESDtBQUVOOUQsTUFBQUEsU0FBUyxFQUFFO0FBRkw7QUFGZCxHQTFCRyxFQWlDSDtBQUNJakIsSUFBQUEsTUFBTSxFQUFFdUUscUNBQWlCTyxvQkFEN0I7QUFFSTNFLElBQUFBLFFBQVEsRUFBRTtBQUNOQyxNQUFBQSxHQUFHLEVBQUVDLGNBQUkwRSxLQURIO0FBRU45RCxNQUFBQSxTQUFTLEVBQUUsSUFGTDtBQUdOSyxNQUFBQSxRQUFRLEVBQUU7QUFISjtBQUZkLEdBakNHLEVBeUNIO0FBQ0l0QixJQUFBQSxNQUFNLEVBQUV1RSxxQ0FBaUJTLFFBRDdCO0FBRUk3RSxJQUFBQSxRQUFRLEVBQUU7QUFDTkMsTUFBQUEsR0FBRyxFQUFFQyxjQUFJNEUsQ0FESDtBQUVOekUsTUFBQUEsT0FBTyxFQUFFLElBRkg7QUFHTkQsTUFBQUEsTUFBTSxFQUFFLENBQUNzQixlQUhIO0FBSU5QLE1BQUFBLFFBQVEsRUFBRU87QUFKSjtBQUZkLEdBekNHLEVBa0RIO0FBQ0k3QixJQUFBQSxNQUFNLEVBQUV1RSxxQ0FBaUJXLGNBRDdCO0FBRUkvRSxJQUFBQSxRQUFRLEVBQUU7QUFDTkMsTUFBQUEsR0FBRyxFQUFFQyxjQUFJQyxRQURIO0FBRU5DLE1BQUFBLE1BQU0sRUFBRTtBQUZGO0FBRmQsR0FsREcsRUF5REg7QUFDSVAsSUFBQUEsTUFBTSxFQUFFdUUscUNBQWlCWSxjQUQ3QjtBQUVJaEYsSUFBQUEsUUFBUSxFQUFFO0FBQ05DLE1BQUFBLEdBQUcsRUFBRUMsY0FBSUssVUFESDtBQUVOSCxNQUFBQSxNQUFNLEVBQUU7QUFGRjtBQUZkLEdBekRHLEVBZ0VIO0FBQ0lQLElBQUFBLE1BQU0sRUFBRXVFLHFDQUFpQmEsb0JBRDdCO0FBRUlqRixJQUFBQSxRQUFRLEVBQUU7QUFDTkMsTUFBQUEsR0FBRyxFQUFFQyxjQUFJQyxRQURIO0FBRU5DLE1BQUFBLE1BQU0sRUFBRSxJQUZGO0FBR05lLE1BQUFBLFFBQVEsRUFBRTtBQUhKO0FBRmQsR0FoRUcsRUF3RUg7QUFDSXRCLElBQUFBLE1BQU0sRUFBRXVFLHFDQUFpQmMsb0JBRDdCO0FBRUlsRixJQUFBQSxRQUFRLEVBQUU7QUFDTkMsTUFBQUEsR0FBRyxFQUFFQyxjQUFJSyxVQURIO0FBRU5ILE1BQUFBLE1BQU0sRUFBRSxJQUZGO0FBR05lLE1BQUFBLFFBQVEsRUFBRTtBQUhKO0FBRmQsR0F4RUcsQ0FBUDtBQWlGSCxDQWxGRDs7QUFvRk8sTUFBTWdFLHVCQUE2QyxHQUFHO0FBQ3pEQyxFQUFBQSwwQkFBMEIsRUFBRXpGLHVCQUQ2QjtBQUV6RDBGLEVBQUFBLHVCQUF1QixFQUFFbEQsb0JBRmdDO0FBR3pEbUQsRUFBQUEsbUJBQW1CLEVBQUUzQyxnQkFIb0M7QUFJekQ0QyxFQUFBQSxlQUFlLEVBQUVsQyxZQUp3QztBQUt6RG1DLEVBQUFBLHFCQUFxQixFQUFFckI7QUFMa0MsQ0FBdEQiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuQ29weXJpZ2h0IDIwMjEgQ2xlbWVucyBaZWlkbGVyXG5cbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG55b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG5Zb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcblxuICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuXG5Vbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG5kaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG5XSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cblNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbmxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuKi9cblxuaW1wb3J0IHsgQXV0b2NvbXBsZXRlQWN0aW9uLCBJS2V5QmluZGluZ3NQcm92aWRlciwgS2V5QmluZGluZywgTWVzc2FnZUNvbXBvc2VyQWN0aW9uLCBOYXZpZ2F0aW9uQWN0aW9uLCBSb29tQWN0aW9uLFxuICAgIFJvb21MaXN0QWN0aW9uIH0gZnJvbSBcIi4vS2V5QmluZGluZ3NNYW5hZ2VyXCI7XG5pbXBvcnQgeyBpc01hYywgS2V5IH0gZnJvbSBcIi4vS2V5Ym9hcmRcIjtcbmltcG9ydCBTZXR0aW5nc1N0b3JlIGZyb20gXCIuL3NldHRpbmdzL1NldHRpbmdzU3RvcmVcIjtcblxuY29uc3QgbWVzc2FnZUNvbXBvc2VyQmluZGluZ3MgPSAoKTogS2V5QmluZGluZzxNZXNzYWdlQ29tcG9zZXJBY3Rpb24+W10gPT4ge1xuICAgIGNvbnN0IGJpbmRpbmdzOiBLZXlCaW5kaW5nPE1lc3NhZ2VDb21wb3NlckFjdGlvbj5bXSA9IFtcbiAgICAgICAge1xuICAgICAgICAgICAgYWN0aW9uOiBNZXNzYWdlQ29tcG9zZXJBY3Rpb24uU2VsZWN0UHJldlNlbmRIaXN0b3J5LFxuICAgICAgICAgICAga2V5Q29tYm86IHtcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5BUlJPV19VUCxcbiAgICAgICAgICAgICAgICBhbHRLZXk6IHRydWUsXG4gICAgICAgICAgICAgICAgY3RybEtleTogdHJ1ZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGFjdGlvbjogTWVzc2FnZUNvbXBvc2VyQWN0aW9uLlNlbGVjdE5leHRTZW5kSGlzdG9yeSxcbiAgICAgICAgICAgIGtleUNvbWJvOiB7XG4gICAgICAgICAgICAgICAga2V5OiBLZXkuQVJST1dfRE9XTixcbiAgICAgICAgICAgICAgICBhbHRLZXk6IHRydWUsXG4gICAgICAgICAgICAgICAgY3RybEtleTogdHJ1ZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGFjdGlvbjogTWVzc2FnZUNvbXBvc2VyQWN0aW9uLkVkaXRQcmV2TWVzc2FnZSxcbiAgICAgICAgICAgIGtleUNvbWJvOiB7XG4gICAgICAgICAgICAgICAga2V5OiBLZXkuQVJST1dfVVAsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhY3Rpb246IE1lc3NhZ2VDb21wb3NlckFjdGlvbi5FZGl0TmV4dE1lc3NhZ2UsXG4gICAgICAgICAgICBrZXlDb21ibzoge1xuICAgICAgICAgICAgICAgIGtleTogS2V5LkFSUk9XX0RPV04sXG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhY3Rpb246IE1lc3NhZ2VDb21wb3NlckFjdGlvbi5DYW5jZWxFZGl0aW5nLFxuICAgICAgICAgICAga2V5Q29tYm86IHtcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5FU0NBUEUsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhY3Rpb246IE1lc3NhZ2VDb21wb3NlckFjdGlvbi5Gb3JtYXRCb2xkLFxuICAgICAgICAgICAga2V5Q29tYm86IHtcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5CLFxuICAgICAgICAgICAgICAgIGN0cmxPckNtZDogdHJ1ZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGFjdGlvbjogTWVzc2FnZUNvbXBvc2VyQWN0aW9uLkZvcm1hdEl0YWxpY3MsXG4gICAgICAgICAgICBrZXlDb21ibzoge1xuICAgICAgICAgICAgICAgIGtleTogS2V5LkksXG4gICAgICAgICAgICAgICAgY3RybE9yQ21kOiB0cnVlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYWN0aW9uOiBNZXNzYWdlQ29tcG9zZXJBY3Rpb24uRm9ybWF0UXVvdGUsXG4gICAgICAgICAgICBrZXlDb21ibzoge1xuICAgICAgICAgICAgICAgIGtleTogS2V5LkdSRUFURVJfVEhBTixcbiAgICAgICAgICAgICAgICBjdHJsT3JDbWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgc2hpZnRLZXk6IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhY3Rpb246IE1lc3NhZ2VDb21wb3NlckFjdGlvbi5FZGl0VW5kbyxcbiAgICAgICAgICAgIGtleUNvbWJvOiB7XG4gICAgICAgICAgICAgICAga2V5OiBLZXkuWixcbiAgICAgICAgICAgICAgICBjdHJsT3JDbWQ6IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhY3Rpb246IE1lc3NhZ2VDb21wb3NlckFjdGlvbi5Nb3ZlQ3Vyc29yVG9TdGFydCxcbiAgICAgICAgICAgIGtleUNvbWJvOiB7XG4gICAgICAgICAgICAgICAga2V5OiBLZXkuSE9NRSxcbiAgICAgICAgICAgICAgICBjdHJsT3JDbWQ6IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhY3Rpb246IE1lc3NhZ2VDb21wb3NlckFjdGlvbi5Nb3ZlQ3Vyc29yVG9FbmQsXG4gICAgICAgICAgICBrZXlDb21ibzoge1xuICAgICAgICAgICAgICAgIGtleTogS2V5LkVORCxcbiAgICAgICAgICAgICAgICBjdHJsT3JDbWQ6IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgIF07XG4gICAgaWYgKGlzTWFjKSB7XG4gICAgICAgIGJpbmRpbmdzLnB1c2goe1xuICAgICAgICAgICAgYWN0aW9uOiBNZXNzYWdlQ29tcG9zZXJBY3Rpb24uRWRpdFJlZG8sXG4gICAgICAgICAgICBrZXlDb21ibzoge1xuICAgICAgICAgICAgICAgIGtleTogS2V5LlosXG4gICAgICAgICAgICAgICAgY3RybE9yQ21kOiB0cnVlLFxuICAgICAgICAgICAgICAgIHNoaWZ0S2V5OiB0cnVlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgYmluZGluZ3MucHVzaCh7XG4gICAgICAgICAgICBhY3Rpb246IE1lc3NhZ2VDb21wb3NlckFjdGlvbi5FZGl0UmVkbyxcbiAgICAgICAgICAgIGtleUNvbWJvOiB7XG4gICAgICAgICAgICAgICAga2V5OiBLZXkuWSxcbiAgICAgICAgICAgICAgICBjdHJsT3JDbWQ6IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgaWYgKFNldHRpbmdzU3RvcmUuZ2V0VmFsdWUoJ01lc3NhZ2VDb21wb3NlcklucHV0LmN0cmxFbnRlclRvU2VuZCcpKSB7XG4gICAgICAgIGJpbmRpbmdzLnB1c2goe1xuICAgICAgICAgICAgYWN0aW9uOiBNZXNzYWdlQ29tcG9zZXJBY3Rpb24uU2VuZCxcbiAgICAgICAgICAgIGtleUNvbWJvOiB7XG4gICAgICAgICAgICAgICAga2V5OiBLZXkuRU5URVIsXG4gICAgICAgICAgICAgICAgY3RybE9yQ21kOiB0cnVlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIGJpbmRpbmdzLnB1c2goe1xuICAgICAgICAgICAgYWN0aW9uOiBNZXNzYWdlQ29tcG9zZXJBY3Rpb24uTmV3TGluZSxcbiAgICAgICAgICAgIGtleUNvbWJvOiB7XG4gICAgICAgICAgICAgICAga2V5OiBLZXkuRU5URVIsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBiaW5kaW5ncy5wdXNoKHtcbiAgICAgICAgICAgIGFjdGlvbjogTWVzc2FnZUNvbXBvc2VyQWN0aW9uLlNlbmQsXG4gICAgICAgICAgICBrZXlDb21ibzoge1xuICAgICAgICAgICAgICAgIGtleTogS2V5LkVOVEVSLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIGJpbmRpbmdzLnB1c2goe1xuICAgICAgICAgICAgYWN0aW9uOiBNZXNzYWdlQ29tcG9zZXJBY3Rpb24uTmV3TGluZSxcbiAgICAgICAgICAgIGtleUNvbWJvOiB7XG4gICAgICAgICAgICAgICAga2V5OiBLZXkuRU5URVIsXG4gICAgICAgICAgICAgICAgc2hpZnRLZXk6IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGlzTWFjKSB7XG4gICAgICAgICAgICBiaW5kaW5ncy5wdXNoKHtcbiAgICAgICAgICAgICAgICBhY3Rpb246IE1lc3NhZ2VDb21wb3NlckFjdGlvbi5OZXdMaW5lLFxuICAgICAgICAgICAgICAgIGtleUNvbWJvOiB7XG4gICAgICAgICAgICAgICAgICAgIGtleTogS2V5LkVOVEVSLFxuICAgICAgICAgICAgICAgICAgICBhbHRLZXk6IHRydWUsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBiaW5kaW5ncztcbn07XG5cbmNvbnN0IGF1dG9jb21wbGV0ZUJpbmRpbmdzID0gKCk6IEtleUJpbmRpbmc8QXV0b2NvbXBsZXRlQWN0aW9uPltdID0+IHtcbiAgICByZXR1cm4gW1xuICAgICAgICB7XG4gICAgICAgICAgICBhY3Rpb246IEF1dG9jb21wbGV0ZUFjdGlvbi5Gb3JjZUNvbXBsZXRlLFxuICAgICAgICAgICAga2V5Q29tYm86IHtcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5UQUIsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhY3Rpb246IEF1dG9jb21wbGV0ZUFjdGlvbi5Gb3JjZUNvbXBsZXRlLFxuICAgICAgICAgICAga2V5Q29tYm86IHtcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5UQUIsXG4gICAgICAgICAgICAgICAgY3RybEtleTogdHJ1ZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGFjdGlvbjogQXV0b2NvbXBsZXRlQWN0aW9uLkNvbXBsZXRlLFxuICAgICAgICAgICAga2V5Q29tYm86IHtcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5FTlRFUixcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGFjdGlvbjogQXV0b2NvbXBsZXRlQWN0aW9uLkNvbXBsZXRlLFxuICAgICAgICAgICAga2V5Q29tYm86IHtcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5FTlRFUixcbiAgICAgICAgICAgICAgICBjdHJsS2V5OiB0cnVlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYWN0aW9uOiBBdXRvY29tcGxldGVBY3Rpb24uQ2FuY2VsLFxuICAgICAgICAgICAga2V5Q29tYm86IHtcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5FU0NBUEUsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhY3Rpb246IEF1dG9jb21wbGV0ZUFjdGlvbi5QcmV2U2VsZWN0aW9uLFxuICAgICAgICAgICAga2V5Q29tYm86IHtcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5BUlJPV19VUCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGFjdGlvbjogQXV0b2NvbXBsZXRlQWN0aW9uLk5leHRTZWxlY3Rpb24sXG4gICAgICAgICAgICBrZXlDb21ibzoge1xuICAgICAgICAgICAgICAgIGtleTogS2V5LkFSUk9XX0RPV04sXG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgIF07XG59O1xuXG5jb25zdCByb29tTGlzdEJpbmRpbmdzID0gKCk6IEtleUJpbmRpbmc8Um9vbUxpc3RBY3Rpb24+W10gPT4ge1xuICAgIHJldHVybiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGFjdGlvbjogUm9vbUxpc3RBY3Rpb24uQ2xlYXJTZWFyY2gsXG4gICAgICAgICAgICBrZXlDb21ibzoge1xuICAgICAgICAgICAgICAgIGtleTogS2V5LkVTQ0FQRSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGFjdGlvbjogUm9vbUxpc3RBY3Rpb24uUHJldlJvb20sXG4gICAgICAgICAgICBrZXlDb21ibzoge1xuICAgICAgICAgICAgICAgIGtleTogS2V5LkFSUk9XX1VQLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYWN0aW9uOiBSb29tTGlzdEFjdGlvbi5OZXh0Um9vbSxcbiAgICAgICAgICAgIGtleUNvbWJvOiB7XG4gICAgICAgICAgICAgICAga2V5OiBLZXkuQVJST1dfRE9XTixcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGFjdGlvbjogUm9vbUxpc3RBY3Rpb24uU2VsZWN0Um9vbSxcbiAgICAgICAgICAgIGtleUNvbWJvOiB7XG4gICAgICAgICAgICAgICAga2V5OiBLZXkuRU5URVIsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhY3Rpb246IFJvb21MaXN0QWN0aW9uLkNvbGxhcHNlU2VjdGlvbixcbiAgICAgICAgICAgIGtleUNvbWJvOiB7XG4gICAgICAgICAgICAgICAga2V5OiBLZXkuQVJST1dfTEVGVCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGFjdGlvbjogUm9vbUxpc3RBY3Rpb24uRXhwYW5kU2VjdGlvbixcbiAgICAgICAgICAgIGtleUNvbWJvOiB7XG4gICAgICAgICAgICAgICAga2V5OiBLZXkuQVJST1dfUklHSFQsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgIF07XG59O1xuXG5jb25zdCByb29tQmluZGluZ3MgPSAoKTogS2V5QmluZGluZzxSb29tQWN0aW9uPltdID0+IHtcbiAgICBjb25zdCBiaW5kaW5nczogS2V5QmluZGluZzxSb29tQWN0aW9uPltdID0gW1xuICAgICAgICB7XG4gICAgICAgICAgICBhY3Rpb246IFJvb21BY3Rpb24uU2Nyb2xsVXAsXG4gICAgICAgICAgICBrZXlDb21ibzoge1xuICAgICAgICAgICAgICAgIGtleTogS2V5LlBBR0VfVVAsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhY3Rpb246IFJvb21BY3Rpb24uUm9vbVNjcm9sbERvd24sXG4gICAgICAgICAgICBrZXlDb21ibzoge1xuICAgICAgICAgICAgICAgIGtleTogS2V5LlBBR0VfRE9XTixcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGFjdGlvbjogUm9vbUFjdGlvbi5EaXNtaXNzUmVhZE1hcmtlcixcbiAgICAgICAgICAgIGtleUNvbWJvOiB7XG4gICAgICAgICAgICAgICAga2V5OiBLZXkuRVNDQVBFLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYWN0aW9uOiBSb29tQWN0aW9uLkp1bXBUb09sZGVzdFVucmVhZCxcbiAgICAgICAgICAgIGtleUNvbWJvOiB7XG4gICAgICAgICAgICAgICAga2V5OiBLZXkuUEFHRV9VUCxcbiAgICAgICAgICAgICAgICBzaGlmdEtleTogdHJ1ZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGFjdGlvbjogUm9vbUFjdGlvbi5VcGxvYWRGaWxlLFxuICAgICAgICAgICAga2V5Q29tYm86IHtcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5VLFxuICAgICAgICAgICAgICAgIGN0cmxPckNtZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBzaGlmdEtleTogdHJ1ZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGFjdGlvbjogUm9vbUFjdGlvbi5KdW1wVG9GaXJzdE1lc3NhZ2UsXG4gICAgICAgICAgICBrZXlDb21ibzoge1xuICAgICAgICAgICAgICAgIGtleTogS2V5LkhPTUUsXG4gICAgICAgICAgICAgICAgY3RybEtleTogdHJ1ZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGFjdGlvbjogUm9vbUFjdGlvbi5KdW1wVG9MYXRlc3RNZXNzYWdlLFxuICAgICAgICAgICAga2V5Q29tYm86IHtcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5FTkQsXG4gICAgICAgICAgICAgICAgY3RybEtleTogdHJ1ZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgXTtcblxuICAgIGlmIChTZXR0aW5nc1N0b3JlLmdldFZhbHVlKCdjdHJsRkZvclNlYXJjaCcpKSB7XG4gICAgICAgIGJpbmRpbmdzLnB1c2goe1xuICAgICAgICAgICAgYWN0aW9uOiBSb29tQWN0aW9uLkZvY3VzU2VhcmNoLFxuICAgICAgICAgICAga2V5Q29tYm86IHtcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5GLFxuICAgICAgICAgICAgICAgIGN0cmxPckNtZDogdHJ1ZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBiaW5kaW5ncztcbn07XG5cbmNvbnN0IG5hdmlnYXRpb25CaW5kaW5ncyA9ICgpOiBLZXlCaW5kaW5nPE5hdmlnYXRpb25BY3Rpb24+W10gPT4ge1xuICAgIHJldHVybiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGFjdGlvbjogTmF2aWdhdGlvbkFjdGlvbi5Gb2N1c1Jvb21TZWFyY2gsXG4gICAgICAgICAgICBrZXlDb21ibzoge1xuICAgICAgICAgICAgICAgIGtleTogS2V5LkssXG4gICAgICAgICAgICAgICAgY3RybE9yQ21kOiB0cnVlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYWN0aW9uOiBOYXZpZ2F0aW9uQWN0aW9uLlRvZ2dsZVJvb21TaWRlUGFuZWwsXG4gICAgICAgICAgICBrZXlDb21ibzoge1xuICAgICAgICAgICAgICAgIGtleTogS2V5LlBFUklPRCxcbiAgICAgICAgICAgICAgICBjdHJsT3JDbWQ6IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhY3Rpb246IE5hdmlnYXRpb25BY3Rpb24uVG9nZ2xlVXNlck1lbnUsXG4gICAgICAgICAgICAvLyBJZGVhbGx5IHRoaXMgd291bGQgYmUgQ1RSTCtQIGZvciBcIlByb2ZpbGVcIiwgYnV0IHRoYXQnc1xuICAgICAgICAgICAgLy8gdGFrZW4gYnkgdGhlIHByaW50IGRpYWxvZy4gQ1RSTCtJIGZvciBcIkluZm9ybWF0aW9uXCJcbiAgICAgICAgICAgIC8vIHdhcyBwcmV2aW91c2x5IGNob3NlbiBidXQgY29uZmxpY3RlZCB3aXRoIGl0YWxpY3MgaW5cbiAgICAgICAgICAgIC8vIGNvbXBvc2VyLCBzbyBDVFJMK2AgaXQgaXNcbiAgICAgICAgICAgIGtleUNvbWJvOiB7XG4gICAgICAgICAgICAgICAga2V5OiBLZXkuQkFDS1RJQ0ssXG4gICAgICAgICAgICAgICAgY3RybE9yQ21kOiB0cnVlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYWN0aW9uOiBOYXZpZ2F0aW9uQWN0aW9uLlRvZ2dsZVNob3J0Q3V0RGlhbG9nLFxuICAgICAgICAgICAga2V5Q29tYm86IHtcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5TTEFTSCxcbiAgICAgICAgICAgICAgICBjdHJsT3JDbWQ6IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhY3Rpb246IE5hdmlnYXRpb25BY3Rpb24uVG9nZ2xlU2hvcnRDdXREaWFsb2csXG4gICAgICAgICAgICBrZXlDb21ibzoge1xuICAgICAgICAgICAgICAgIGtleTogS2V5LlNMQVNILFxuICAgICAgICAgICAgICAgIGN0cmxPckNtZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBzaGlmdEtleTogdHJ1ZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGFjdGlvbjogTmF2aWdhdGlvbkFjdGlvbi5Hb1RvSG9tZSxcbiAgICAgICAgICAgIGtleUNvbWJvOiB7XG4gICAgICAgICAgICAgICAga2V5OiBLZXkuSCxcbiAgICAgICAgICAgICAgICBjdHJsS2V5OiB0cnVlLFxuICAgICAgICAgICAgICAgIGFsdEtleTogIWlzTWFjLFxuICAgICAgICAgICAgICAgIHNoaWZ0S2V5OiBpc01hYyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGFjdGlvbjogTmF2aWdhdGlvbkFjdGlvbi5TZWxlY3RQcmV2Um9vbSxcbiAgICAgICAgICAgIGtleUNvbWJvOiB7XG4gICAgICAgICAgICAgICAga2V5OiBLZXkuQVJST1dfVVAsXG4gICAgICAgICAgICAgICAgYWx0S2V5OiB0cnVlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYWN0aW9uOiBOYXZpZ2F0aW9uQWN0aW9uLlNlbGVjdE5leHRSb29tLFxuICAgICAgICAgICAga2V5Q29tYm86IHtcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5BUlJPV19ET1dOLFxuICAgICAgICAgICAgICAgIGFsdEtleTogdHJ1ZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGFjdGlvbjogTmF2aWdhdGlvbkFjdGlvbi5TZWxlY3RQcmV2VW5yZWFkUm9vbSxcbiAgICAgICAgICAgIGtleUNvbWJvOiB7XG4gICAgICAgICAgICAgICAga2V5OiBLZXkuQVJST1dfVVAsXG4gICAgICAgICAgICAgICAgYWx0S2V5OiB0cnVlLFxuICAgICAgICAgICAgICAgIHNoaWZ0S2V5OiB0cnVlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYWN0aW9uOiBOYXZpZ2F0aW9uQWN0aW9uLlNlbGVjdE5leHRVbnJlYWRSb29tLFxuICAgICAgICAgICAga2V5Q29tYm86IHtcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5BUlJPV19ET1dOLFxuICAgICAgICAgICAgICAgIGFsdEtleTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBzaGlmdEtleTogdHJ1ZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgXTtcbn07XG5cbmV4cG9ydCBjb25zdCBkZWZhdWx0QmluZGluZ3NQcm92aWRlcjogSUtleUJpbmRpbmdzUHJvdmlkZXIgPSB7XG4gICAgZ2V0TWVzc2FnZUNvbXBvc2VyQmluZGluZ3M6IG1lc3NhZ2VDb21wb3NlckJpbmRpbmdzLFxuICAgIGdldEF1dG9jb21wbGV0ZUJpbmRpbmdzOiBhdXRvY29tcGxldGVCaW5kaW5ncyxcbiAgICBnZXRSb29tTGlzdEJpbmRpbmdzOiByb29tTGlzdEJpbmRpbmdzLFxuICAgIGdldFJvb21CaW5kaW5nczogcm9vbUJpbmRpbmdzLFxuICAgIGdldE5hdmlnYXRpb25CaW5kaW5nczogbmF2aWdhdGlvbkJpbmRpbmdzLFxufTtcbiJdfQ==