"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.hasText = hasText;
exports.textForEvent = textForEvent;

var _react = _interopRequireDefault(require("react"));

var _languageHandler = require("./languageHandler");

var Roles = _interopRequireWildcard(require("./Roles"));

var _RoomInvite = require("./RoomInvite");

var _SettingsStore = _interopRequireDefault(require("./settings/SettingsStore"));

var _BanList = require("./mjolnir/BanList");

var _WidgetLayoutStore = require("./stores/widgets/WidgetLayoutStore");

var _RightPanelStorePhases = require("./stores/RightPanelStorePhases");

var _actions = require("./dispatcher/actions");

var _dispatcher = _interopRequireDefault(require("./dispatcher/dispatcher"));

var _partials = require("matrix-js-sdk/src/@types/partials");

var _event = require("matrix-js-sdk/src/@types/event");

var _MatrixClientPeg = require("./MatrixClientPeg");

var _RoomSettingsDialog = require("./components/views/dialogs/RoomSettingsDialog");

var _logger = require("matrix-js-sdk/src/logger");

var _utils = require("matrix-js-sdk/src/utils");

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

/*
Copyright 2015, 2016 OpenMarket Ltd

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
// These functions are frequently used just to check whether an event has
// any text to display at all. For this reason they return deferred values
// to avoid the expense of looking up translations when they're not needed.
function textForCallInviteEvent(event) {
  const getSenderName = () => event.sender ? event.sender.name : (0, _languageHandler._t)('Someone'); // FIXME: Find a better way to determine this from the event?


  let isVoice = true;

  if (event.getContent().offer && event.getContent().offer.sdp && event.getContent().offer.sdp.indexOf('m=video') !== -1) {
    isVoice = false;
  }

  const isSupported = _MatrixClientPeg.MatrixClientPeg.get().supportsVoip(); // This ladder could be reduced down to a couple string variables, however other languages
  // can have a hard time translating those strings. In an effort to make translations easier
  // and more accurate, we break out the string-based variables to a couple booleans.


  if (isVoice && isSupported) {
    return () => (0, _languageHandler._t)("%(senderName)s placed a voice call.", {
      senderName: getSenderName()
    });
  } else if (isVoice && !isSupported) {
    return () => (0, _languageHandler._t)("%(senderName)s placed a voice call. (not supported by this browser)", {
      senderName: getSenderName()
    });
  } else if (!isVoice && isSupported) {
    return () => (0, _languageHandler._t)("%(senderName)s placed a video call.", {
      senderName: getSenderName()
    });
  } else if (!isVoice && !isSupported) {
    return () => (0, _languageHandler._t)("%(senderName)s placed a video call. (not supported by this browser)", {
      senderName: getSenderName()
    });
  }
}

function textForMemberEvent(ev, allowJSX, showHiddenEvents) {
  // XXX: SYJS-16 "sender is sometimes null for join messages"
  const senderName = ev.sender ? ev.sender.name : ev.getSender();
  const targetName = ev.target ? ev.target.name : ev.getStateKey();
  const prevContent = ev.getPrevContent();
  const content = ev.getContent();
  const reason = content.reason;

  switch (content.membership) {
    case 'invite':
      {
        const threePidContent = content.third_party_invite;

        if (threePidContent) {
          if (threePidContent.display_name) {
            return () => (0, _languageHandler._t)('%(targetName)s accepted the invitation for %(displayName)s', {
              targetName,
              displayName: threePidContent.display_name
            });
          } else {
            return () => (0, _languageHandler._t)('%(targetName)s accepted an invitation', {
              targetName
            });
          }
        } else {
          return () => (0, _languageHandler._t)('%(senderName)s invited %(targetName)s', {
            senderName,
            targetName
          });
        }
      }

    case 'ban':
      return () => reason ? (0, _languageHandler._t)('%(senderName)s banned %(targetName)s: %(reason)s', {
        senderName,
        targetName,
        reason
      }) : (0, _languageHandler._t)('%(senderName)s banned %(targetName)s', {
        senderName,
        targetName
      });

    case 'join':
      if (prevContent && prevContent.membership === 'join') {
        if (prevContent.displayname && content.displayname && prevContent.displayname !== content.displayname) {
          return () => (0, _languageHandler._t)('%(oldDisplayName)s changed their display name to %(displayName)s', {
            // We're taking the display namke directly from the event content here so we need
            // to strip direction override chars which the js-sdk would normally do when
            // calculating the display name
            oldDisplayName: (0, _utils.removeDirectionOverrideChars)(prevContent.displayname),
            displayName: (0, _utils.removeDirectionOverrideChars)(content.displayname)
          });
        } else if (!prevContent.displayname && content.displayname) {
          return () => (0, _languageHandler._t)('%(senderName)s set their display name to %(displayName)s', {
            senderName: ev.getSender(),
            displayName: (0, _utils.removeDirectionOverrideChars)(content.displayname)
          });
        } else if (prevContent.displayname && !content.displayname) {
          return () => (0, _languageHandler._t)('%(senderName)s removed their display name (%(oldDisplayName)s)', {
            senderName,
            oldDisplayName: (0, _utils.removeDirectionOverrideChars)(prevContent.displayname)
          });
        } else if (prevContent.avatar_url && !content.avatar_url) {
          return () => (0, _languageHandler._t)('%(senderName)s removed their profile picture', {
            senderName
          });
        } else if (prevContent.avatar_url && content.avatar_url && prevContent.avatar_url !== content.avatar_url) {
          return () => (0, _languageHandler._t)('%(senderName)s changed their profile picture', {
            senderName
          });
        } else if (!prevContent.avatar_url && content.avatar_url) {
          return () => (0, _languageHandler._t)('%(senderName)s set a profile picture', {
            senderName
          });
        } else if (showHiddenEvents ?? _SettingsStore.default.getValue("showHiddenEventsInTimeline")) {
          // This is a null rejoin, it will only be visible if using 'show hidden events' (labs)
          return () => (0, _languageHandler._t)("%(senderName)s made no change", {
            senderName
          });
        } else {
          return null;
        }
      } else {
        if (!ev.target) _logger.logger.warn("Join message has no target! -- " + ev.getContent().state_key);
        return () => (0, _languageHandler._t)('%(targetName)s joined the room', {
          targetName
        });
      }

    case 'leave':
      if (ev.getSender() === ev.getStateKey()) {
        if (prevContent.membership === "invite") {
          return () => (0, _languageHandler._t)('%(targetName)s rejected the invitation', {
            targetName
          });
        } else {
          return () => reason ? (0, _languageHandler._t)('%(targetName)s left the room: %(reason)s', {
            targetName,
            reason
          }) : (0, _languageHandler._t)('%(targetName)s left the room', {
            targetName
          });
        }
      } else if (prevContent.membership === "ban") {
        return () => (0, _languageHandler._t)('%(senderName)s unbanned %(targetName)s', {
          senderName,
          targetName
        });
      } else if (prevContent.membership === "invite") {
        return () => reason ? (0, _languageHandler._t)('%(senderName)s withdrew %(targetName)s\'s invitation: %(reason)s', {
          senderName,
          targetName,
          reason
        }) : (0, _languageHandler._t)('%(senderName)s withdrew %(targetName)s\'s invitation', {
          senderName,
          targetName
        });
      } else if (prevContent.membership === "join") {
        return () => reason ? (0, _languageHandler._t)('%(senderName)s kicked %(targetName)s: %(reason)s', {
          senderName,
          targetName,
          reason
        }) : (0, _languageHandler._t)('%(senderName)s kicked %(targetName)s', {
          senderName,
          targetName
        });
      } else {
        return null;
      }

  }
}

function textForTopicEvent(ev) {
  const senderDisplayName = ev.sender && ev.sender.name ? ev.sender.name : ev.getSender();
  return () => (0, _languageHandler._t)('%(senderDisplayName)s changed the topic to "%(topic)s".', {
    senderDisplayName,
    topic: ev.getContent().topic
  });
}

function textForRoomAvatarEvent(ev) {
  var _ev$sender;

  const senderDisplayName = (ev === null || ev === void 0 ? void 0 : (_ev$sender = ev.sender) === null || _ev$sender === void 0 ? void 0 : _ev$sender.name) || ev.getSender();
  return () => (0, _languageHandler._t)('%(senderDisplayName)s changed the room avatar.', {
    senderDisplayName
  });
}

function textForRoomNameEvent(ev) {
  const senderDisplayName = ev.sender && ev.sender.name ? ev.sender.name : ev.getSender();

  if (!ev.getContent().name || ev.getContent().name.trim().length === 0) {
    return () => (0, _languageHandler._t)('%(senderDisplayName)s removed the room name.', {
      senderDisplayName
    });
  }

  if (ev.getPrevContent().name) {
    return () => (0, _languageHandler._t)('%(senderDisplayName)s changed the room name from %(oldRoomName)s to %(newRoomName)s.', {
      senderDisplayName,
      oldRoomName: ev.getPrevContent().name,
      newRoomName: ev.getContent().name
    });
  }

  return () => (0, _languageHandler._t)('%(senderDisplayName)s changed the room name to %(roomName)s.', {
    senderDisplayName,
    roomName: ev.getContent().name
  });
}

function textForTombstoneEvent(ev) {
  const senderDisplayName = ev.sender && ev.sender.name ? ev.sender.name : ev.getSender();
  return () => (0, _languageHandler._t)('%(senderDisplayName)s upgraded this room.', {
    senderDisplayName
  });
}

const onViewJoinRuleSettingsClick = () => {
  _dispatcher.default.dispatch({
    action: "open_room_settings",
    initial_tab_id: _RoomSettingsDialog.ROOM_SECURITY_TAB
  });
};

function textForJoinRulesEvent(ev, allowJSX) {
  const senderDisplayName = ev.sender && ev.sender.name ? ev.sender.name : ev.getSender();

  switch (ev.getContent().join_rule) {
    case _partials.JoinRule.Public:
      return () => (0, _languageHandler._t)('%(senderDisplayName)s made the room public to whoever knows the link.', {
        senderDisplayName
      });

    case _partials.JoinRule.Invite:
      return () => (0, _languageHandler._t)('%(senderDisplayName)s made the room invite only.', {
        senderDisplayName
      });

    case _partials.JoinRule.Restricted:
      if (allowJSX) {
        return () => /*#__PURE__*/_react.default.createElement("span", null, (0, _languageHandler._t)('%(senderDisplayName)s changed who can join this room. <a>View settings</a>.', {
          senderDisplayName
        }, {
          "a": sub => /*#__PURE__*/_react.default.createElement("a", {
            onClick: onViewJoinRuleSettingsClick
          }, sub)
        }));
      }

      return () => (0, _languageHandler._t)('%(senderDisplayName)s changed who can join this room.', {
        senderDisplayName
      });

    default:
      // The spec supports "knock" and "private", however nothing implements these.
      return () => (0, _languageHandler._t)('%(senderDisplayName)s changed the join rule to %(rule)s', {
        senderDisplayName,
        rule: ev.getContent().join_rule
      });
  }
}

function textForGuestAccessEvent(ev) {
  const senderDisplayName = ev.sender && ev.sender.name ? ev.sender.name : ev.getSender();

  switch (ev.getContent().guest_access) {
    case _partials.GuestAccess.CanJoin:
      return () => (0, _languageHandler._t)('%(senderDisplayName)s has allowed guests to join the room.', {
        senderDisplayName
      });

    case _partials.GuestAccess.Forbidden:
      return () => (0, _languageHandler._t)('%(senderDisplayName)s has prevented guests from joining the room.', {
        senderDisplayName
      });

    default:
      // There's no other options we can expect, however just for safety's sake we'll do this.
      return () => (0, _languageHandler._t)('%(senderDisplayName)s changed guest access to %(rule)s', {
        senderDisplayName,
        rule: ev.getContent().guest_access
      });
  }
}

function textForRelatedGroupsEvent(ev) {
  const senderDisplayName = ev.sender && ev.sender.name ? ev.sender.name : ev.getSender();
  const groups = ev.getContent().groups || [];
  const prevGroups = ev.getPrevContent().groups || [];
  const added = groups.filter(g => !prevGroups.includes(g));
  const removed = prevGroups.filter(g => !groups.includes(g));

  if (added.length && !removed.length) {
    return () => (0, _languageHandler._t)('%(senderDisplayName)s enabled flair for %(groups)s in this room.', {
      senderDisplayName,
      groups: added.join(', ')
    });
  } else if (!added.length && removed.length) {
    return () => (0, _languageHandler._t)('%(senderDisplayName)s disabled flair for %(groups)s in this room.', {
      senderDisplayName,
      groups: removed.join(', ')
    });
  } else if (added.length && removed.length) {
    return () => (0, _languageHandler._t)('%(senderDisplayName)s enabled flair for %(newGroups)s and disabled flair for ' + '%(oldGroups)s in this room.', {
      senderDisplayName,
      newGroups: added.join(', '),
      oldGroups: removed.join(', ')
    });
  } else {
    // Don't bother rendering this change (because there were no changes)
    return null;
  }
}

function textForServerACLEvent(ev) {
  const senderDisplayName = ev.sender && ev.sender.name ? ev.sender.name : ev.getSender();
  const prevContent = ev.getPrevContent();
  const current = ev.getContent();
  const prev = {
    deny: Array.isArray(prevContent.deny) ? prevContent.deny : [],
    allow: Array.isArray(prevContent.allow) ? prevContent.allow : [],
    allow_ip_literals: !(prevContent.allow_ip_literals === false)
  };
  let getText = null;

  if (prev.deny.length === 0 && prev.allow.length === 0) {
    getText = () => (0, _languageHandler._t)("%(senderDisplayName)s set the server ACLs for this room.", {
      senderDisplayName
    });
  } else {
    getText = () => (0, _languageHandler._t)("%(senderDisplayName)s changed the server ACLs for this room.", {
      senderDisplayName
    });
  }

  if (!Array.isArray(current.allow)) {
    current.allow = [];
  } // If we know for sure everyone is banned, mark the room as obliterated


  if (current.allow.length === 0) {
    return () => getText() + " " + (0, _languageHandler._t)("🎉 All servers are banned from participating! This room can no longer be used.");
  }

  return getText;
}

function textForMessageEvent(ev) {
  return () => {
    const senderDisplayName = ev.sender && ev.sender.name ? ev.sender.name : ev.getSender();
    let message = ev.getContent().body;

    if (ev.isRedacted()) {
      var _unsigned$redacted_be;

      message = (0, _languageHandler._t)("Message deleted");
      const unsigned = ev.getUnsigned();
      const redactedBecauseUserId = unsigned === null || unsigned === void 0 ? void 0 : (_unsigned$redacted_be = unsigned.redacted_because) === null || _unsigned$redacted_be === void 0 ? void 0 : _unsigned$redacted_be.sender;

      if (redactedBecauseUserId && redactedBecauseUserId !== ev.getSender()) {
        const room = _MatrixClientPeg.MatrixClientPeg.get().getRoom(ev.getRoomId());

        const sender = room === null || room === void 0 ? void 0 : room.getMember(redactedBecauseUserId);
        message = (0, _languageHandler._t)("Message deleted by %(name)s", {
          name: (sender === null || sender === void 0 ? void 0 : sender.name) || redactedBecauseUserId
        });
      }
    }

    if (ev.getContent().msgtype === _event.MsgType.Emote) {
      message = "* " + senderDisplayName + " " + message;
    } else if (ev.getContent().msgtype === _event.MsgType.Image) {
      message = (0, _languageHandler._t)('%(senderDisplayName)s sent an image.', {
        senderDisplayName
      });
    } else if (ev.getType() == _event.EventType.Sticker) {
      message = (0, _languageHandler._t)('%(senderDisplayName)s sent a sticker.', {
        senderDisplayName
      });
    } else {
      // in this case, parse it as a plain text message
      message = senderDisplayName + ': ' + message;
    }

    return message;
  };
}

function textForCanonicalAliasEvent(ev) {
  const senderName = ev.sender && ev.sender.name ? ev.sender.name : ev.getSender();
  const oldAlias = ev.getPrevContent().alias;
  const oldAltAliases = ev.getPrevContent().alt_aliases || [];
  const newAlias = ev.getContent().alias;
  const newAltAliases = ev.getContent().alt_aliases || [];
  const removedAltAliases = oldAltAliases.filter(alias => !newAltAliases.includes(alias));
  const addedAltAliases = newAltAliases.filter(alias => !oldAltAliases.includes(alias));

  if (!removedAltAliases.length && !addedAltAliases.length) {
    if (newAlias) {
      return () => (0, _languageHandler._t)('%(senderName)s set the main address for this room to %(address)s.', {
        senderName: senderName,
        address: ev.getContent().alias
      });
    } else if (oldAlias) {
      return () => (0, _languageHandler._t)('%(senderName)s removed the main address for this room.', {
        senderName: senderName
      });
    }
  } else if (newAlias === oldAlias) {
    if (addedAltAliases.length && !removedAltAliases.length) {
      return () => (0, _languageHandler._t)('%(senderName)s added the alternative addresses %(addresses)s for this room.', {
        senderName: senderName,
        addresses: addedAltAliases.join(", "),
        count: addedAltAliases.length
      });
    }

    if (removedAltAliases.length && !addedAltAliases.length) {
      return () => (0, _languageHandler._t)('%(senderName)s removed the alternative addresses %(addresses)s for this room.', {
        senderName: senderName,
        addresses: removedAltAliases.join(", "),
        count: removedAltAliases.length
      });
    }

    if (removedAltAliases.length && addedAltAliases.length) {
      return () => (0, _languageHandler._t)('%(senderName)s changed the alternative addresses for this room.', {
        senderName: senderName
      });
    }
  } else {
    // both alias and alt_aliases where modified
    return () => (0, _languageHandler._t)('%(senderName)s changed the main and alternative addresses for this room.', {
      senderName: senderName
    });
  } // in case there is no difference between the two events,
  // say something as we can't simply hide the tile from here


  return () => (0, _languageHandler._t)('%(senderName)s changed the addresses for this room.', {
    senderName: senderName
  });
}

function textForThreePidInviteEvent(event) {
  const senderName = event.sender ? event.sender.name : event.getSender();

  if (!(0, _RoomInvite.isValid3pidInvite)(event)) {
    return () => (0, _languageHandler._t)('%(senderName)s revoked the invitation for %(targetDisplayName)s to join the room.', {
      senderName,
      targetDisplayName: event.getPrevContent().display_name || (0, _languageHandler._t)("Someone")
    });
  }

  return () => (0, _languageHandler._t)('%(senderName)s sent an invitation to %(targetDisplayName)s to join the room.', {
    senderName,
    targetDisplayName: event.getContent().display_name
  });
}

function textForHistoryVisibilityEvent(event) {
  const senderName = event.sender ? event.sender.name : event.getSender();

  switch (event.getContent().history_visibility) {
    case _partials.HistoryVisibility.Invited:
      return () => (0, _languageHandler._t)('%(senderName)s made future room history visible to all room members, ' + 'from the point they are invited.', {
        senderName
      });

    case _partials.HistoryVisibility.Joined:
      return () => (0, _languageHandler._t)('%(senderName)s made future room history visible to all room members, ' + 'from the point they joined.', {
        senderName
      });

    case _partials.HistoryVisibility.Shared:
      return () => (0, _languageHandler._t)('%(senderName)s made future room history visible to all room members.', {
        senderName
      });

    case _partials.HistoryVisibility.WorldReadable:
      return () => (0, _languageHandler._t)('%(senderName)s made future room history visible to anyone.', {
        senderName
      });

    default:
      return () => (0, _languageHandler._t)('%(senderName)s made future room history visible to unknown (%(visibility)s).', {
        senderName,
        visibility: event.getContent().history_visibility
      });
  }
} // Currently will only display a change if a user's power level is changed


function textForPowerEvent(event) {
  const senderName = event.sender ? event.sender.name : event.getSender();

  if (!event.getPrevContent() || !event.getPrevContent().users || !event.getContent() || !event.getContent().users) {
    return null;
  }

  const previousUserDefault = event.getPrevContent().users_default || 0;
  const currentUserDefault = event.getContent().users_default || 0; // Construct set of userIds

  const users = [];
  Object.keys(event.getContent().users).forEach(userId => {
    if (users.indexOf(userId) === -1) users.push(userId);
  });
  Object.keys(event.getPrevContent().users).forEach(userId => {
    if (users.indexOf(userId) === -1) users.push(userId);
  });
  const diffs = [];
  users.forEach(userId => {
    // Previous power level
    let from = event.getPrevContent().users[userId];

    if (!Number.isInteger(from)) {
      from = previousUserDefault;
    } // Current power level


    let to = event.getContent().users[userId];

    if (!Number.isInteger(to)) {
      to = currentUserDefault;
    }

    if (from === previousUserDefault && to === currentUserDefault) {
      return;
    }

    if (to !== from) {
      diffs.push({
        userId,
        from,
        to
      });
    }
  });

  if (!diffs.length) {
    return null;
  } // XXX: This is also surely broken for i18n


  return () => (0, _languageHandler._t)('%(senderName)s changed the power level of %(powerLevelDiffText)s.', {
    senderName,
    powerLevelDiffText: diffs.map(diff => (0, _languageHandler._t)('%(userId)s from %(fromPowerLevel)s to %(toPowerLevel)s', {
      userId: diff.userId,
      fromPowerLevel: Roles.textualPowerLevel(diff.from, previousUserDefault),
      toPowerLevel: Roles.textualPowerLevel(diff.to, currentUserDefault)
    })).join(", ")
  });
}

const onPinnedOrUnpinnedMessageClick = (messageId, roomId) => {
  _dispatcher.default.dispatch({
    action: _actions.Action.ViewRoom,
    event_id: messageId,
    highlighted: true,
    room_id: roomId
  });
};

const onPinnedMessagesClick = () => {
  _dispatcher.default.dispatch({
    action: _actions.Action.SetRightPanelPhase,
    phase: _RightPanelStorePhases.RightPanelPhases.PinnedMessages,
    allowClose: false
  });
};

function textForPinnedEvent(event, allowJSX) {
  if (!_SettingsStore.default.getValue("feature_pinning")) return null;
  const senderName = event.sender ? event.sender.name : event.getSender();
  const roomId = event.getRoomId();
  const pinned = event.getContent().pinned ?? [];
  const previouslyPinned = event.getPrevContent().pinned ?? [];
  const newlyPinned = pinned.filter(item => previouslyPinned.indexOf(item) < 0);
  const newlyUnpinned = previouslyPinned.filter(item => pinned.indexOf(item) < 0);

  if (newlyPinned.length === 1 && newlyUnpinned.length === 0) {
    // A single message was pinned, include a link to that message.
    if (allowJSX) {
      const messageId = newlyPinned.pop();
      return () => /*#__PURE__*/_react.default.createElement("span", null, (0, _languageHandler._t)("%(senderName)s pinned <a>a message</a> to this room. See all <b>pinned messages</b>.", {
        senderName
      }, {
        "a": sub => /*#__PURE__*/_react.default.createElement("a", {
          onClick: e => onPinnedOrUnpinnedMessageClick(messageId, roomId)
        }, sub),
        "b": sub => /*#__PURE__*/_react.default.createElement("a", {
          onClick: onPinnedMessagesClick
        }, sub)
      }));
    }

    return () => (0, _languageHandler._t)("%(senderName)s pinned a message to this room. See all pinned messages.", {
      senderName
    });
  }

  if (newlyUnpinned.length === 1 && newlyPinned.length === 0) {
    // A single message was unpinned, include a link to that message.
    if (allowJSX) {
      const messageId = newlyUnpinned.pop();
      return () => /*#__PURE__*/_react.default.createElement("span", null, (0, _languageHandler._t)("%(senderName)s unpinned <a>a message</a> from this room. See all <b>pinned messages</b>.", {
        senderName
      }, {
        "a": sub => /*#__PURE__*/_react.default.createElement("a", {
          onClick: e => onPinnedOrUnpinnedMessageClick(messageId, roomId)
        }, sub),
        "b": sub => /*#__PURE__*/_react.default.createElement("a", {
          onClick: onPinnedMessagesClick
        }, sub)
      }));
    }

    return () => (0, _languageHandler._t)("%(senderName)s unpinned a message from this room. See all pinned messages.", {
      senderName
    });
  }

  if (allowJSX) {
    return () => /*#__PURE__*/_react.default.createElement("span", null, (0, _languageHandler._t)("%(senderName)s changed the <a>pinned messages</a> for the room.", {
      senderName
    }, {
      "a": sub => /*#__PURE__*/_react.default.createElement("a", {
        onClick: onPinnedMessagesClick
      }, " ", sub, " ")
    }));
  }

  return () => (0, _languageHandler._t)("%(senderName)s changed the pinned messages for the room.", {
    senderName
  });
}

function textForWidgetEvent(event) {
  const senderName = event.getSender();
  const {
    name: prevName,
    type: prevType,
    url: prevUrl
  } = event.getPrevContent();
  const {
    name,
    type,
    url
  } = event.getContent() || {};
  let widgetName = name || prevName || type || prevType || ''; // Apply sentence case to widget name

  if (widgetName && widgetName.length > 0) {
    widgetName = widgetName[0].toUpperCase() + widgetName.slice(1);
  } // If the widget was removed, its content should be {}, but this is sufficiently
  // equivalent to that condition.


  if (url) {
    if (prevUrl) {
      return () => (0, _languageHandler._t)('%(widgetName)s widget modified by %(senderName)s', {
        widgetName,
        senderName
      });
    } else {
      return () => (0, _languageHandler._t)('%(widgetName)s widget added by %(senderName)s', {
        widgetName,
        senderName
      });
    }
  } else {
    return () => (0, _languageHandler._t)('%(widgetName)s widget removed by %(senderName)s', {
      widgetName,
      senderName
    });
  }
}

function textForWidgetLayoutEvent(event) {
  var _event$sender;

  const senderName = ((_event$sender = event.sender) === null || _event$sender === void 0 ? void 0 : _event$sender.name) || event.getSender();
  return () => (0, _languageHandler._t)("%(senderName)s has updated the room layout", {
    senderName
  });
}

function textForMjolnirEvent(event) {
  const senderName = event.getSender();
  const {
    entity: prevEntity
  } = event.getPrevContent();
  const {
    entity,
    recommendation,
    reason
  } = event.getContent(); // Rule removed

  if (!entity) {
    if (_BanList.USER_RULE_TYPES.includes(event.getType())) {
      return () => (0, _languageHandler._t)("%(senderName)s removed the rule banning users matching %(glob)s", {
        senderName,
        glob: prevEntity
      });
    } else if (_BanList.ROOM_RULE_TYPES.includes(event.getType())) {
      return () => (0, _languageHandler._t)("%(senderName)s removed the rule banning rooms matching %(glob)s", {
        senderName,
        glob: prevEntity
      });
    } else if (_BanList.SERVER_RULE_TYPES.includes(event.getType())) {
      return () => (0, _languageHandler._t)("%(senderName)s removed the rule banning servers matching %(glob)s", {
        senderName,
        glob: prevEntity
      });
    } // Unknown type. We'll say something, but we shouldn't end up here.


    return () => (0, _languageHandler._t)("%(senderName)s removed a ban rule matching %(glob)s", {
      senderName,
      glob: prevEntity
    });
  } // Invalid rule


  if (!recommendation || !reason) return () => (0, _languageHandler._t)(`%(senderName)s updated an invalid ban rule`, {
    senderName
  }); // Rule updated

  if (entity === prevEntity) {
    if (_BanList.USER_RULE_TYPES.includes(event.getType())) {
      return () => (0, _languageHandler._t)("%(senderName)s updated the rule banning users matching %(glob)s for %(reason)s", {
        senderName,
        glob: entity,
        reason
      });
    } else if (_BanList.ROOM_RULE_TYPES.includes(event.getType())) {
      return () => (0, _languageHandler._t)("%(senderName)s updated the rule banning rooms matching %(glob)s for %(reason)s", {
        senderName,
        glob: entity,
        reason
      });
    } else if (_BanList.SERVER_RULE_TYPES.includes(event.getType())) {
      return () => (0, _languageHandler._t)("%(senderName)s updated the rule banning servers matching %(glob)s for %(reason)s", {
        senderName,
        glob: entity,
        reason
      });
    } // Unknown type. We'll say something but we shouldn't end up here.


    return () => (0, _languageHandler._t)("%(senderName)s updated a ban rule matching %(glob)s for %(reason)s", {
      senderName,
      glob: entity,
      reason
    });
  } // New rule


  if (!prevEntity) {
    if (_BanList.USER_RULE_TYPES.includes(event.getType())) {
      return () => (0, _languageHandler._t)("%(senderName)s created a rule banning users matching %(glob)s for %(reason)s", {
        senderName,
        glob: entity,
        reason
      });
    } else if (_BanList.ROOM_RULE_TYPES.includes(event.getType())) {
      return () => (0, _languageHandler._t)("%(senderName)s created a rule banning rooms matching %(glob)s for %(reason)s", {
        senderName,
        glob: entity,
        reason
      });
    } else if (_BanList.SERVER_RULE_TYPES.includes(event.getType())) {
      return () => (0, _languageHandler._t)("%(senderName)s created a rule banning servers matching %(glob)s for %(reason)s", {
        senderName,
        glob: entity,
        reason
      });
    } // Unknown type. We'll say something but we shouldn't end up here.


    return () => (0, _languageHandler._t)("%(senderName)s created a ban rule matching %(glob)s for %(reason)s", {
      senderName,
      glob: entity,
      reason
    });
  } // else the entity !== prevEntity - count as a removal & add


  if (_BanList.USER_RULE_TYPES.includes(event.getType())) {
    return () => (0, _languageHandler._t)("%(senderName)s changed a rule that was banning users matching %(oldGlob)s to matching " + "%(newGlob)s for %(reason)s", {
      senderName,
      oldGlob: prevEntity,
      newGlob: entity,
      reason
    });
  } else if (_BanList.ROOM_RULE_TYPES.includes(event.getType())) {
    return () => (0, _languageHandler._t)("%(senderName)s changed a rule that was banning rooms matching %(oldGlob)s to matching " + "%(newGlob)s for %(reason)s", {
      senderName,
      oldGlob: prevEntity,
      newGlob: entity,
      reason
    });
  } else if (_BanList.SERVER_RULE_TYPES.includes(event.getType())) {
    return () => (0, _languageHandler._t)("%(senderName)s changed a rule that was banning servers matching %(oldGlob)s to matching " + "%(newGlob)s for %(reason)s", {
      senderName,
      oldGlob: prevEntity,
      newGlob: entity,
      reason
    });
  } // Unknown type. We'll say something but we shouldn't end up here.


  return () => (0, _languageHandler._t)("%(senderName)s updated a ban rule that was matching %(oldGlob)s to matching %(newGlob)s " + "for %(reason)s", {
    senderName,
    oldGlob: prevEntity,
    newGlob: entity,
    reason
  });
}

const handlers = {
  [_event.EventType.RoomMessage]: textForMessageEvent,
  [_event.EventType.Sticker]: textForMessageEvent,
  [_event.EventType.CallInvite]: textForCallInviteEvent
};
const stateHandlers = {
  [_event.EventType.RoomCanonicalAlias]: textForCanonicalAliasEvent,
  [_event.EventType.RoomName]: textForRoomNameEvent,
  [_event.EventType.RoomTopic]: textForTopicEvent,
  [_event.EventType.RoomMember]: textForMemberEvent,
  [_event.EventType.RoomAvatar]: textForRoomAvatarEvent,
  [_event.EventType.RoomThirdPartyInvite]: textForThreePidInviteEvent,
  [_event.EventType.RoomHistoryVisibility]: textForHistoryVisibilityEvent,
  [_event.EventType.RoomPowerLevels]: textForPowerEvent,
  [_event.EventType.RoomPinnedEvents]: textForPinnedEvent,
  [_event.EventType.RoomServerAcl]: textForServerACLEvent,
  [_event.EventType.RoomTombstone]: textForTombstoneEvent,
  [_event.EventType.RoomJoinRules]: textForJoinRulesEvent,
  [_event.EventType.RoomGuestAccess]: textForGuestAccessEvent,
  'm.room.related_groups': textForRelatedGroupsEvent,
  // TODO: Enable support for m.widget event type (https://github.com/vector-im/element-web/issues/13111)
  'im.vector.modular.widgets': textForWidgetEvent,
  [_WidgetLayoutStore.WIDGET_LAYOUT_EVENT_TYPE]: textForWidgetLayoutEvent
}; // Add all the Mjolnir stuff to the renderer

for (const evType of _BanList.ALL_RULE_TYPES) {
  stateHandlers[evType] = textForMjolnirEvent;
}
/**
 * Determines whether the given event has text to display.
 * @param ev The event
 * @param showHiddenEvents An optional cached setting value for showHiddenEventsInTimeline
 *     to avoid hitting the settings store
 */


function hasText(ev, showHiddenEvents) {
  const handler = (ev.isState() ? stateHandlers : handlers)[ev.getType()];
  return Boolean(handler === null || handler === void 0 ? void 0 : handler(ev, false, showHiddenEvents));
}
/**
 * Gets the textual content of the given event.
 * @param ev The event
 * @param allowJSX Whether to output rich JSX content
 * @param showHiddenEvents An optional cached setting value for showHiddenEventsInTimeline
 *     to avoid hitting the settings store
 */


function textForEvent(ev, allowJSX = false, showHiddenEvents) {
  var _handler;

  const handler = (ev.isState() ? stateHandlers : handlers)[ev.getType()];
  return (handler === null || handler === void 0 ? void 0 : (_handler = handler(ev, allowJSX, showHiddenEvents)) === null || _handler === void 0 ? void 0 : _handler()) || '';
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9UZXh0Rm9yRXZlbnQudHN4Il0sIm5hbWVzIjpbInRleHRGb3JDYWxsSW52aXRlRXZlbnQiLCJldmVudCIsImdldFNlbmRlck5hbWUiLCJzZW5kZXIiLCJuYW1lIiwiaXNWb2ljZSIsImdldENvbnRlbnQiLCJvZmZlciIsInNkcCIsImluZGV4T2YiLCJpc1N1cHBvcnRlZCIsIk1hdHJpeENsaWVudFBlZyIsImdldCIsInN1cHBvcnRzVm9pcCIsInNlbmRlck5hbWUiLCJ0ZXh0Rm9yTWVtYmVyRXZlbnQiLCJldiIsImFsbG93SlNYIiwic2hvd0hpZGRlbkV2ZW50cyIsImdldFNlbmRlciIsInRhcmdldE5hbWUiLCJ0YXJnZXQiLCJnZXRTdGF0ZUtleSIsInByZXZDb250ZW50IiwiZ2V0UHJldkNvbnRlbnQiLCJjb250ZW50IiwicmVhc29uIiwibWVtYmVyc2hpcCIsInRocmVlUGlkQ29udGVudCIsInRoaXJkX3BhcnR5X2ludml0ZSIsImRpc3BsYXlfbmFtZSIsImRpc3BsYXlOYW1lIiwiZGlzcGxheW5hbWUiLCJvbGREaXNwbGF5TmFtZSIsImF2YXRhcl91cmwiLCJTZXR0aW5nc1N0b3JlIiwiZ2V0VmFsdWUiLCJsb2dnZXIiLCJ3YXJuIiwic3RhdGVfa2V5IiwidGV4dEZvclRvcGljRXZlbnQiLCJzZW5kZXJEaXNwbGF5TmFtZSIsInRvcGljIiwidGV4dEZvclJvb21BdmF0YXJFdmVudCIsInRleHRGb3JSb29tTmFtZUV2ZW50IiwidHJpbSIsImxlbmd0aCIsIm9sZFJvb21OYW1lIiwibmV3Um9vbU5hbWUiLCJyb29tTmFtZSIsInRleHRGb3JUb21ic3RvbmVFdmVudCIsIm9uVmlld0pvaW5SdWxlU2V0dGluZ3NDbGljayIsImRlZmF1bHREaXNwYXRjaGVyIiwiZGlzcGF0Y2giLCJhY3Rpb24iLCJpbml0aWFsX3RhYl9pZCIsIlJPT01fU0VDVVJJVFlfVEFCIiwidGV4dEZvckpvaW5SdWxlc0V2ZW50Iiwiam9pbl9ydWxlIiwiSm9pblJ1bGUiLCJQdWJsaWMiLCJJbnZpdGUiLCJSZXN0cmljdGVkIiwic3ViIiwicnVsZSIsInRleHRGb3JHdWVzdEFjY2Vzc0V2ZW50IiwiZ3Vlc3RfYWNjZXNzIiwiR3Vlc3RBY2Nlc3MiLCJDYW5Kb2luIiwiRm9yYmlkZGVuIiwidGV4dEZvclJlbGF0ZWRHcm91cHNFdmVudCIsImdyb3VwcyIsInByZXZHcm91cHMiLCJhZGRlZCIsImZpbHRlciIsImciLCJpbmNsdWRlcyIsInJlbW92ZWQiLCJqb2luIiwibmV3R3JvdXBzIiwib2xkR3JvdXBzIiwidGV4dEZvclNlcnZlckFDTEV2ZW50IiwiY3VycmVudCIsInByZXYiLCJkZW55IiwiQXJyYXkiLCJpc0FycmF5IiwiYWxsb3ciLCJhbGxvd19pcF9saXRlcmFscyIsImdldFRleHQiLCJ0ZXh0Rm9yTWVzc2FnZUV2ZW50IiwibWVzc2FnZSIsImJvZHkiLCJpc1JlZGFjdGVkIiwidW5zaWduZWQiLCJnZXRVbnNpZ25lZCIsInJlZGFjdGVkQmVjYXVzZVVzZXJJZCIsInJlZGFjdGVkX2JlY2F1c2UiLCJyb29tIiwiZ2V0Um9vbSIsImdldFJvb21JZCIsImdldE1lbWJlciIsIm1zZ3R5cGUiLCJNc2dUeXBlIiwiRW1vdGUiLCJJbWFnZSIsImdldFR5cGUiLCJFdmVudFR5cGUiLCJTdGlja2VyIiwidGV4dEZvckNhbm9uaWNhbEFsaWFzRXZlbnQiLCJvbGRBbGlhcyIsImFsaWFzIiwib2xkQWx0QWxpYXNlcyIsImFsdF9hbGlhc2VzIiwibmV3QWxpYXMiLCJuZXdBbHRBbGlhc2VzIiwicmVtb3ZlZEFsdEFsaWFzZXMiLCJhZGRlZEFsdEFsaWFzZXMiLCJhZGRyZXNzIiwiYWRkcmVzc2VzIiwiY291bnQiLCJ0ZXh0Rm9yVGhyZWVQaWRJbnZpdGVFdmVudCIsInRhcmdldERpc3BsYXlOYW1lIiwidGV4dEZvckhpc3RvcnlWaXNpYmlsaXR5RXZlbnQiLCJoaXN0b3J5X3Zpc2liaWxpdHkiLCJIaXN0b3J5VmlzaWJpbGl0eSIsIkludml0ZWQiLCJKb2luZWQiLCJTaGFyZWQiLCJXb3JsZFJlYWRhYmxlIiwidmlzaWJpbGl0eSIsInRleHRGb3JQb3dlckV2ZW50IiwidXNlcnMiLCJwcmV2aW91c1VzZXJEZWZhdWx0IiwidXNlcnNfZGVmYXVsdCIsImN1cnJlbnRVc2VyRGVmYXVsdCIsIk9iamVjdCIsImtleXMiLCJmb3JFYWNoIiwidXNlcklkIiwicHVzaCIsImRpZmZzIiwiZnJvbSIsIk51bWJlciIsImlzSW50ZWdlciIsInRvIiwicG93ZXJMZXZlbERpZmZUZXh0IiwibWFwIiwiZGlmZiIsImZyb21Qb3dlckxldmVsIiwiUm9sZXMiLCJ0ZXh0dWFsUG93ZXJMZXZlbCIsInRvUG93ZXJMZXZlbCIsIm9uUGlubmVkT3JVbnBpbm5lZE1lc3NhZ2VDbGljayIsIm1lc3NhZ2VJZCIsInJvb21JZCIsIkFjdGlvbiIsIlZpZXdSb29tIiwiZXZlbnRfaWQiLCJoaWdobGlnaHRlZCIsInJvb21faWQiLCJvblBpbm5lZE1lc3NhZ2VzQ2xpY2siLCJTZXRSaWdodFBhbmVsUGhhc2UiLCJwaGFzZSIsIlJpZ2h0UGFuZWxQaGFzZXMiLCJQaW5uZWRNZXNzYWdlcyIsImFsbG93Q2xvc2UiLCJ0ZXh0Rm9yUGlubmVkRXZlbnQiLCJwaW5uZWQiLCJwcmV2aW91c2x5UGlubmVkIiwibmV3bHlQaW5uZWQiLCJpdGVtIiwibmV3bHlVbnBpbm5lZCIsInBvcCIsImUiLCJ0ZXh0Rm9yV2lkZ2V0RXZlbnQiLCJwcmV2TmFtZSIsInR5cGUiLCJwcmV2VHlwZSIsInVybCIsInByZXZVcmwiLCJ3aWRnZXROYW1lIiwidG9VcHBlckNhc2UiLCJzbGljZSIsInRleHRGb3JXaWRnZXRMYXlvdXRFdmVudCIsInRleHRGb3JNam9sbmlyRXZlbnQiLCJlbnRpdHkiLCJwcmV2RW50aXR5IiwicmVjb21tZW5kYXRpb24iLCJVU0VSX1JVTEVfVFlQRVMiLCJnbG9iIiwiUk9PTV9SVUxFX1RZUEVTIiwiU0VSVkVSX1JVTEVfVFlQRVMiLCJvbGRHbG9iIiwibmV3R2xvYiIsImhhbmRsZXJzIiwiUm9vbU1lc3NhZ2UiLCJDYWxsSW52aXRlIiwic3RhdGVIYW5kbGVycyIsIlJvb21DYW5vbmljYWxBbGlhcyIsIlJvb21OYW1lIiwiUm9vbVRvcGljIiwiUm9vbU1lbWJlciIsIlJvb21BdmF0YXIiLCJSb29tVGhpcmRQYXJ0eUludml0ZSIsIlJvb21IaXN0b3J5VmlzaWJpbGl0eSIsIlJvb21Qb3dlckxldmVscyIsIlJvb21QaW5uZWRFdmVudHMiLCJSb29tU2VydmVyQWNsIiwiUm9vbVRvbWJzdG9uZSIsIlJvb21Kb2luUnVsZXMiLCJSb29tR3Vlc3RBY2Nlc3MiLCJXSURHRVRfTEFZT1VUX0VWRU5UX1RZUEUiLCJldlR5cGUiLCJBTExfUlVMRV9UWVBFUyIsImhhc1RleHQiLCJoYW5kbGVyIiwiaXNTdGF0ZSIsIkJvb2xlYW4iLCJ0ZXh0Rm9yRXZlbnQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFnQkE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBR0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7O0FBQ0E7Ozs7OztBQWxDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFzQkE7QUFDQTtBQUNBO0FBRUEsU0FBU0Esc0JBQVQsQ0FBZ0NDLEtBQWhDLEVBQXlFO0FBQ3JFLFFBQU1DLGFBQWEsR0FBRyxNQUFNRCxLQUFLLENBQUNFLE1BQU4sR0FBZUYsS0FBSyxDQUFDRSxNQUFOLENBQWFDLElBQTVCLEdBQW1DLHlCQUFHLFNBQUgsQ0FBL0QsQ0FEcUUsQ0FFckU7OztBQUNBLE1BQUlDLE9BQU8sR0FBRyxJQUFkOztBQUNBLE1BQUlKLEtBQUssQ0FBQ0ssVUFBTixHQUFtQkMsS0FBbkIsSUFBNEJOLEtBQUssQ0FBQ0ssVUFBTixHQUFtQkMsS0FBbkIsQ0FBeUJDLEdBQXJELElBQ0FQLEtBQUssQ0FBQ0ssVUFBTixHQUFtQkMsS0FBbkIsQ0FBeUJDLEdBQXpCLENBQTZCQyxPQUE3QixD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IEx0ZFxuXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xueW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG5cbiAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcblxuVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG5TZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG5saW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiovXG5cbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBfdCB9IGZyb20gJy4vbGFuZ3VhZ2VIYW5kbGVyJztcbmltcG9ydCAqIGFzIFJvbGVzIGZyb20gJy4vUm9sZXMnO1xuaW1wb3J0IHsgaXNWYWxpZDNwaWRJbnZpdGUgfSBmcm9tIFwiLi9Sb29tSW52aXRlXCI7XG5pbXBvcnQgU2V0dGluZ3NTdG9yZSBmcm9tIFwiLi9zZXR0aW5ncy9TZXR0aW5nc1N0b3JlXCI7XG5pbXBvcnQgeyBBTExfUlVMRV9UWVBFUywgUk9PTV9SVUxFX1RZUEVTLCBTRVJWRVJfUlVMRV9UWVBFUywgVVNFUl9SVUxFX1RZUEVTIH0gZnJvbSBcIi4vbWpvbG5pci9CYW5MaXN0XCI7XG5pbXBvcnQgeyBXSURHRVRfTEFZT1VUX0VWRU5UX1RZUEUgfSBmcm9tIFwiLi9zdG9yZXMvd2lkZ2V0cy9XaWRnZXRMYXlvdXRTdG9yZVwiO1xuaW1wb3J0IHsgUmlnaHRQYW5lbFBoYXNlcyB9IGZyb20gJy4vc3RvcmVzL1JpZ2h0UGFuZWxTdG9yZVBoYXNlcyc7XG5pbXBvcnQgeyBBY3Rpb24gfSBmcm9tICcuL2Rpc3BhdGNoZXIvYWN0aW9ucyc7XG5pbXBvcnQgZGVmYXVsdERpc3BhdGNoZXIgZnJvbSAnLi9kaXNwYXRjaGVyL2Rpc3BhdGNoZXInO1xuaW1wb3J0IHsgU2V0UmlnaHRQYW5lbFBoYXNlUGF5bG9hZCB9IGZyb20gJy4vZGlzcGF0Y2hlci9wYXlsb2Fkcy9TZXRSaWdodFBhbmVsUGhhc2VQYXlsb2FkJztcbmltcG9ydCB7IE1hdHJpeEV2ZW50IH0gZnJvbSBcIm1hdHJpeC1qcy1zZGsvc3JjL21vZGVscy9ldmVudFwiO1xuaW1wb3J0IHsgR3Vlc3RBY2Nlc3MsIEhpc3RvcnlWaXNpYmlsaXR5LCBKb2luUnVsZSB9IGZyb20gXCJtYXRyaXgtanMtc2RrL3NyYy9AdHlwZXMvcGFydGlhbHNcIjtcbmltcG9ydCB7IEV2ZW50VHlwZSwgTXNnVHlwZSB9IGZyb20gXCJtYXRyaXgtanMtc2RrL3NyYy9AdHlwZXMvZXZlbnRcIjtcbmltcG9ydCB7IE1hdHJpeENsaWVudFBlZyB9IGZyb20gXCIuL01hdHJpeENsaWVudFBlZ1wiO1xuaW1wb3J0IHsgUk9PTV9TRUNVUklUWV9UQUIgfSBmcm9tIFwiLi9jb21wb25lbnRzL3ZpZXdzL2RpYWxvZ3MvUm9vbVNldHRpbmdzRGlhbG9nXCI7XG5cbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gXCJtYXRyaXgtanMtc2RrL3NyYy9sb2dnZXJcIjtcbmltcG9ydCB7IHJlbW92ZURpcmVjdGlvbk92ZXJyaWRlQ2hhcnMgfSBmcm9tICdtYXRyaXgtanMtc2RrL3NyYy91dGlscyc7XG5cbi8vIFRoZXNlIGZ1bmN0aW9ucyBhcmUgZnJlcXVlbnRseSB1c2VkIGp1c3QgdG8gY2hlY2sgd2hldGhlciBhbiBldmVudCBoYXNcbi8vIGFueSB0ZXh0IHRvIGRpc3BsYXkgYXQgYWxsLiBGb3IgdGhpcyByZWFzb24gdGhleSByZXR1cm4gZGVmZXJyZWQgdmFsdWVzXG4vLyB0byBhdm9pZCB0aGUgZXhwZW5zZSBvZiBsb29raW5nIHVwIHRyYW5zbGF0aW9ucyB3aGVuIHRoZXkncmUgbm90IG5lZWRlZC5cblxuZnVuY3Rpb24gdGV4dEZvckNhbGxJbnZpdGVFdmVudChldmVudDogTWF0cml4RXZlbnQpOiAoKSA9PiBzdHJpbmcgfCBudWxsIHtcbiAgICBjb25zdCBnZXRTZW5kZXJOYW1lID0gKCkgPT4gZXZlbnQuc2VuZGVyID8gZXZlbnQuc2VuZGVyLm5hbWUgOiBfdCgnU29tZW9uZScpO1xuICAgIC8vIEZJWE1FOiBGaW5kIGEgYmV0dGVyIHdheSB0byBkZXRlcm1pbmUgdGhpcyBmcm9tIHRoZSBldmVudD9cbiAgICBsZXQgaXNWb2ljZSA9IHRydWU7XG4gICAgaWYgKGV2ZW50LmdldENvbnRlbnQoKS5vZmZlciAmJiBldmVudC5nZXRDb250ZW50KCkub2ZmZXIuc2RwICYmXG4gICAgICAgIGV2ZW50LmdldENvbnRlbnQoKS5vZmZlci5zZHAuaW5kZXhPZignbT12aWRlbycpICE9PSAtMSkge1xuICAgICAgICBpc1ZvaWNlID0gZmFsc2U7XG4gICAgfVxuICAgIGNvbnN0IGlzU3VwcG9ydGVkID0gTWF0cml4Q2xpZW50UGVnLmdldCgpLnN1cHBvcnRzVm9pcCgpO1xuXG4gICAgLy8gVGhpcyBsYWRkZXIgY291bGQgYmUgcmVkdWNlZCBkb3duIHRvIGEgY291cGxlIHN0cmluZyB2YXJpYWJsZXMsIGhvd2V2ZXIgb3RoZXIgbGFuZ3VhZ2VzXG4gICAgLy8gY2FuIGhhdmUgYSBoYXJkIHRpbWUgdHJhbnNsYXRpbmcgdGhvc2Ugc3RyaW5ncy4gSW4gYW4gZWZmb3J0IHRvIG1ha2UgdHJhbnNsYXRpb25zIGVhc2llclxuICAgIC8vIGFuZCBtb3JlIGFjY3VyYXRlLCB3ZSBicmVhayBvdXQgdGhlIHN0cmluZy1iYXNlZCB2YXJpYWJsZXMgdG8gYSBjb3VwbGUgYm9vbGVhbnMuXG4gICAgaWYgKGlzVm9pY2UgJiYgaXNTdXBwb3J0ZWQpIHtcbiAgICAgICAgcmV0dXJuICgpID0+IF90KFwiJShzZW5kZXJOYW1lKXMgcGxhY2VkIGEgdm9pY2UgY2FsbC5cIiwge1xuICAgICAgICAgICAgc2VuZGVyTmFtZTogZ2V0U2VuZGVyTmFtZSgpLFxuICAgICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKGlzVm9pY2UgJiYgIWlzU3VwcG9ydGVkKSB7XG4gICAgICAgIHJldHVybiAoKSA9PiBfdChcIiUoc2VuZGVyTmFtZSlzIHBsYWNlZCBhIHZvaWNlIGNhbGwuIChub3Qgc3VwcG9ydGVkIGJ5IHRoaXMgYnJvd3NlcilcIiwge1xuICAgICAgICAgICAgc2VuZGVyTmFtZTogZ2V0U2VuZGVyTmFtZSgpLFxuICAgICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKCFpc1ZvaWNlICYmIGlzU3VwcG9ydGVkKSB7XG4gICAgICAgIHJldHVybiAoKSA9PiBfdChcIiUoc2VuZGVyTmFtZSlzIHBsYWNlZCBhIHZpZGVvIGNhbGwuXCIsIHtcbiAgICAgICAgICAgIHNlbmRlck5hbWU6IGdldFNlbmRlck5hbWUoKSxcbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIGlmICghaXNWb2ljZSAmJiAhaXNTdXBwb3J0ZWQpIHtcbiAgICAgICAgcmV0dXJuICgpID0+IF90KFwiJShzZW5kZXJOYW1lKXMgcGxhY2VkIGEgdmlkZW8gY2FsbC4gKG5vdCBzdXBwb3J0ZWQgYnkgdGhpcyBicm93c2VyKVwiLCB7XG4gICAgICAgICAgICBzZW5kZXJOYW1lOiBnZXRTZW5kZXJOYW1lKCksXG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gdGV4dEZvck1lbWJlckV2ZW50KGV2OiBNYXRyaXhFdmVudCwgYWxsb3dKU1g6IGJvb2xlYW4sIHNob3dIaWRkZW5FdmVudHM/OiBib29sZWFuKTogKCkgPT4gc3RyaW5nIHwgbnVsbCB7XG4gICAgLy8gWFhYOiBTWUpTLTE2IFwic2VuZGVyIGlzIHNvbWV0aW1lcyBudWxsIGZvciBqb2luIG1lc3NhZ2VzXCJcbiAgICBjb25zdCBzZW5kZXJOYW1lID0gZXYuc2VuZGVyID8gZXYuc2VuZGVyLm5hbWUgOiBldi5nZXRTZW5kZXIoKTtcbiAgICBjb25zdCB0YXJnZXROYW1lID0gZXYudGFyZ2V0ID8gZXYudGFyZ2V0Lm5hbWUgOiBldi5nZXRTdGF0ZUtleSgpO1xuICAgIGNvbnN0IHByZXZDb250ZW50ID0gZXYuZ2V0UHJldkNvbnRlbnQoKTtcbiAgICBjb25zdCBjb250ZW50ID0gZXYuZ2V0Q29udGVudCgpO1xuICAgIGNvbnN0IHJlYXNvbiA9IGNvbnRlbnQucmVhc29uO1xuXG4gICAgc3dpdGNoIChjb250ZW50Lm1lbWJlcnNoaXApIHtcbiAgICAgICAgY2FzZSAnaW52aXRlJzoge1xuICAgICAgICAgICAgY29uc3QgdGhyZWVQaWRDb250ZW50ID0gY29udGVudC50aGlyZF9wYXJ0eV9pbnZpdGU7XG4gICAgICAgICAgICBpZiAodGhyZWVQaWRDb250ZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKHRocmVlUGlkQ29udGVudC5kaXNwbGF5X25hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgpID0+IF90KCclKHRhcmdldE5hbWUpcyBhY2NlcHRlZCB0aGUgaW52aXRhdGlvbiBmb3IgJShkaXNwbGF5TmFtZSlzJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiB0aHJlZVBpZENvbnRlbnQuZGlzcGxheV9uYW1lLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKCkgPT4gX3QoJyUodGFyZ2V0TmFtZSlzIGFjY2VwdGVkIGFuIGludml0YXRpb24nLCB7IHRhcmdldE5hbWUgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKCkgPT4gX3QoJyUoc2VuZGVyTmFtZSlzIGludml0ZWQgJSh0YXJnZXROYW1lKXMnLCB7IHNlbmRlck5hbWUsIHRhcmdldE5hbWUgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAnYmFuJzpcbiAgICAgICAgICAgIHJldHVybiAoKSA9PiByZWFzb25cbiAgICAgICAgICAgICAgICA/IF90KCclKHNlbmRlck5hbWUpcyBiYW5uZWQgJSh0YXJnZXROYW1lKXM6ICUocmVhc29uKXMnLCB7IHNlbmRlck5hbWUsIHRhcmdldE5hbWUsIHJlYXNvbiB9KVxuICAgICAgICAgICAgICAgIDogX3QoJyUoc2VuZGVyTmFtZSlzIGJhbm5lZCAlKHRhcmdldE5hbWUpcycsIHsgc2VuZGVyTmFtZSwgdGFyZ2V0TmFtZSB9KTtcbiAgICAgICAgY2FzZSAnam9pbic6XG4gICAgICAgICAgICBpZiAocHJldkNvbnRlbnQgJiYgcHJldkNvbnRlbnQubWVtYmVyc2hpcCA9PT0gJ2pvaW4nKSB7XG4gICAgICAgICAgICAgICAgaWYgKHByZXZDb250ZW50LmRpc3BsYXluYW1lICYmIGNvbnRlbnQuZGlzcGxheW5hbWUgJiYgcHJldkNvbnRlbnQuZGlzcGxheW5hbWUgIT09IGNvbnRlbnQuZGlzcGxheW5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgpID0+IF90KCclKG9sZERpc3BsYXlOYW1lKXMgY2hhbmdlZCB0aGVpciBkaXNwbGF5IG5hbWUgdG8gJShkaXNwbGF5TmFtZSlzJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gV2UncmUgdGFraW5nIHRoZSBkaXNwbGF5IG5hbWtlIGRpcmVjdGx5IGZyb20gdGhlIGV2ZW50IGNvbnRlbnQgaGVyZSBzbyB3ZSBuZWVkXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0byBzdHJpcCBkaXJlY3Rpb24gb3ZlcnJpZGUgY2hhcnMgd2hpY2ggdGhlIGpzLXNkayB3b3VsZCBub3JtYWxseSBkbyB3aGVuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjYWxjdWxhdGluZyB0aGUgZGlzcGxheSBuYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICBvbGREaXNwbGF5TmFtZTogcmVtb3ZlRGlyZWN0aW9uT3ZlcnJpZGVDaGFycyhwcmV2Q29udGVudC5kaXNwbGF5bmFtZSksXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogcmVtb3ZlRGlyZWN0aW9uT3ZlcnJpZGVDaGFycyhjb250ZW50LmRpc3BsYXluYW1lKSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICghcHJldkNvbnRlbnQuZGlzcGxheW5hbWUgJiYgY29udGVudC5kaXNwbGF5bmFtZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKCkgPT4gX3QoJyUoc2VuZGVyTmFtZSlzIHNldCB0aGVpciBkaXNwbGF5IG5hbWUgdG8gJShkaXNwbGF5TmFtZSlzJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VuZGVyTmFtZTogZXYuZ2V0U2VuZGVyKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogcmVtb3ZlRGlyZWN0aW9uT3ZlcnJpZGVDaGFycyhjb250ZW50LmRpc3BsYXluYW1lKSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwcmV2Q29udGVudC5kaXNwbGF5bmFtZSAmJiAhY29udGVudC5kaXNwbGF5bmFtZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKCkgPT4gX3QoJyUoc2VuZGVyTmFtZSlzIHJlbW92ZWQgdGhlaXIgZGlzcGxheSBuYW1lICglKG9sZERpc3BsYXlOYW1lKXMpJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VuZGVyTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9sZERpc3BsYXlOYW1lOiByZW1vdmVEaXJlY3Rpb25PdmVycmlkZUNoYXJzKHByZXZDb250ZW50LmRpc3BsYXluYW1lKSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwcmV2Q29udGVudC5hdmF0YXJfdXJsICYmICFjb250ZW50LmF2YXRhcl91cmwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgpID0+IF90KCclKHNlbmRlck5hbWUpcyByZW1vdmVkIHRoZWlyIHByb2ZpbGUgcGljdHVyZScsIHsgc2VuZGVyTmFtZSB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHByZXZDb250ZW50LmF2YXRhcl91cmwgJiYgY29udGVudC5hdmF0YXJfdXJsICYmXG4gICAgICAgICAgICAgICAgICAgIHByZXZDb250ZW50LmF2YXRhcl91cmwgIT09IGNvbnRlbnQuYXZhdGFyX3VybCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKCkgPT4gX3QoJyUoc2VuZGVyTmFtZSlzIGNoYW5nZWQgdGhlaXIgcHJvZmlsZSBwaWN0dXJlJywgeyBzZW5kZXJOYW1lIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIXByZXZDb250ZW50LmF2YXRhcl91cmwgJiYgY29udGVudC5hdmF0YXJfdXJsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoKSA9PiBfdCgnJShzZW5kZXJOYW1lKXMgc2V0IGEgcHJvZmlsZSBwaWN0dXJlJywgeyBzZW5kZXJOYW1lIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hvd0hpZGRlbkV2ZW50cyA/PyBTZXR0aW5nc1N0b3JlLmdldFZhbHVlKFwic2hvd0hpZGRlbkV2ZW50c0luVGltZWxpbmVcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBpcyBhIG51bGwgcmVqb2luLCBpdCB3aWxsIG9ubHkgYmUgdmlzaWJsZSBpZiB1c2luZyAnc2hvdyBoaWRkZW4gZXZlbnRzJyAobGFicylcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgpID0+IF90KFwiJShzZW5kZXJOYW1lKXMgbWFkZSBubyBjaGFuZ2VcIiwgeyBzZW5kZXJOYW1lIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKCFldi50YXJnZXQpIGxvZ2dlci53YXJuKFwiSm9pbiBtZXNzYWdlIGhhcyBubyB0YXJnZXQhIC0tIFwiICsgZXYuZ2V0Q29udGVudCgpLnN0YXRlX2tleSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuICgpID0+IF90KCclKHRhcmdldE5hbWUpcyBqb2luZWQgdGhlIHJvb20nLCB7IHRhcmdldE5hbWUgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIGNhc2UgJ2xlYXZlJzpcbiAgICAgICAgICAgIGlmIChldi5nZXRTZW5kZXIoKSA9PT0gZXYuZ2V0U3RhdGVLZXkoKSkge1xuICAgICAgICAgICAgICAgIGlmIChwcmV2Q29udGVudC5tZW1iZXJzaGlwID09PSBcImludml0ZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoKSA9PiBfdCgnJSh0YXJnZXROYW1lKXMgcmVqZWN0ZWQgdGhlIGludml0YXRpb24nLCB7IHRhcmdldE5hbWUgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgpID0+IHJlYXNvblxuICAgICAgICAgICAgICAgICAgICAgICAgPyBfdCgnJSh0YXJnZXROYW1lKXMgbGVmdCB0aGUgcm9vbTogJShyZWFzb24pcycsIHsgdGFyZ2V0TmFtZSwgcmVhc29uIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICA6IF90KCclKHRhcmdldE5hbWUpcyBsZWZ0IHRoZSByb29tJywgeyB0YXJnZXROYW1lIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAocHJldkNvbnRlbnQubWVtYmVyc2hpcCA9PT0gXCJiYW5cIikge1xuICAgICAgICAgICAgICAgIHJldHVybiAoKSA9PiBfdCgnJShzZW5kZXJOYW1lKXMgdW5iYW5uZWQgJSh0YXJnZXROYW1lKXMnLCB7IHNlbmRlck5hbWUsIHRhcmdldE5hbWUgfSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHByZXZDb250ZW50Lm1lbWJlcnNoaXAgPT09IFwiaW52aXRlXCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKCkgPT4gcmVhc29uXG4gICAgICAgICAgICAgICAgICAgID8gX3QoJyUoc2VuZGVyTmFtZSlzIHdpdGhkcmV3ICUodGFyZ2V0TmFtZSlzXFwncyBpbnZpdGF0aW9uOiAlKHJlYXNvbilzJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VuZGVyTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICByZWFzb24sXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIDogX3QoJyUoc2VuZGVyTmFtZSlzIHdpdGhkcmV3ICUodGFyZ2V0TmFtZSlzXFwncyBpbnZpdGF0aW9uJywgeyBzZW5kZXJOYW1lLCB0YXJnZXROYW1lIH0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChwcmV2Q29udGVudC5tZW1iZXJzaGlwID09PSBcImpvaW5cIikge1xuICAgICAgICAgICAgICAgIHJldHVybiAoKSA9PiByZWFzb25cbiAgICAgICAgICAgICAgICAgICAgPyBfdCgnJShzZW5kZXJOYW1lKXMga2lja2VkICUodGFyZ2V0TmFtZSlzOiAlKHJlYXNvbilzJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VuZGVyTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICByZWFzb24sXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIDogX3QoJyUoc2VuZGVyTmFtZSlzIGtpY2tlZCAlKHRhcmdldE5hbWUpcycsIHsgc2VuZGVyTmFtZSwgdGFyZ2V0TmFtZSB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiB0ZXh0Rm9yVG9waWNFdmVudChldjogTWF0cml4RXZlbnQpOiAoKSA9PiBzdHJpbmcgfCBudWxsIHtcbiAgICBjb25zdCBzZW5kZXJEaXNwbGF5TmFtZSA9IGV2LnNlbmRlciAmJiBldi5zZW5kZXIubmFtZSA/IGV2LnNlbmRlci5uYW1lIDogZXYuZ2V0U2VuZGVyKCk7XG4gICAgcmV0dXJuICgpID0+IF90KCclKHNlbmRlckRpc3BsYXlOYW1lKXMgY2hhbmdlZCB0aGUgdG9waWMgdG8gXCIlKHRvcGljKXNcIi4nLCB7XG4gICAgICAgIHNlbmRlckRpc3BsYXlOYW1lLFxuICAgICAgICB0b3BpYzogZXYuZ2V0Q29udGVudCgpLnRvcGljLFxuICAgIH0pO1xufVxuXG5mdW5jdGlvbiB0ZXh0Rm9yUm9vbUF2YXRhckV2ZW50KGV2OiBNYXRyaXhFdmVudCk6ICgpID0+IHN0cmluZyB8IG51bGwge1xuICAgIGNvbnN0IHNlbmRlckRpc3BsYXlOYW1lID0gZXY/LnNlbmRlcj8ubmFtZSB8fCBldi5nZXRTZW5kZXIoKTtcbiAgICByZXR1cm4gKCkgPT4gX3QoJyUoc2VuZGVyRGlzcGxheU5hbWUpcyBjaGFuZ2VkIHRoZSByb29tIGF2YXRhci4nLCB7IHNlbmRlckRpc3BsYXlOYW1lIH0pO1xufVxuXG5mdW5jdGlvbiB0ZXh0Rm9yUm9vbU5hbWVFdmVudChldjogTWF0cml4RXZlbnQpOiAoKSA9PiBzdHJpbmcgfCBudWxsIHtcbiAgICBjb25zdCBzZW5kZXJEaXNwbGF5TmFtZSA9IGV2LnNlbmRlciAmJiBldi5zZW5kZXIubmFtZSA/IGV2LnNlbmRlci5uYW1lIDogZXYuZ2V0U2VuZGVyKCk7XG5cbiAgICBpZiAoIWV2LmdldENvbnRlbnQoKS5uYW1lIHx8IGV2LmdldENvbnRlbnQoKS5uYW1lLnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuICgpID0+IF90KCclKHNlbmRlckRpc3BsYXlOYW1lKXMgcmVtb3ZlZCB0aGUgcm9vbSBuYW1lLicsIHsgc2VuZGVyRGlzcGxheU5hbWUgfSk7XG4gICAgfVxuICAgIGlmIChldi5nZXRQcmV2Q29udGVudCgpLm5hbWUpIHtcbiAgICAgICAgcmV0dXJuICgpID0+IF90KCclKHNlbmRlckRpc3BsYXlOYW1lKXMgY2hhbmdlZCB0aGUgcm9vbSBuYW1lIGZyb20gJShvbGRSb29tTmFtZSlzIHRvICUobmV3Um9vbU5hbWUpcy4nLCB7XG4gICAgICAgICAgICBzZW5kZXJEaXNwbGF5TmFtZSxcbiAgICAgICAgICAgIG9sZFJvb21OYW1lOiBldi5nZXRQcmV2Q29udGVudCgpLm5hbWUsXG4gICAgICAgICAgICBuZXdSb29tTmFtZTogZXYuZ2V0Q29udGVudCgpLm5hbWUsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gKCkgPT4gX3QoJyUoc2VuZGVyRGlzcGxheU5hbWUpcyBjaGFuZ2VkIHRoZSByb29tIG5hbWUgdG8gJShyb29tTmFtZSlzLicsIHtcbiAgICAgICAgc2VuZGVyRGlzcGxheU5hbWUsXG4gICAgICAgIHJvb21OYW1lOiBldi5nZXRDb250ZW50KCkubmFtZSxcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gdGV4dEZvclRvbWJzdG9uZUV2ZW50KGV2OiBNYXRyaXhFdmVudCk6ICgpID0+IHN0cmluZyB8IG51bGwge1xuICAgIGNvbnN0IHNlbmRlckRpc3BsYXlOYW1lID0gZXYuc2VuZGVyICYmIGV2LnNlbmRlci5uYW1lID8gZXYuc2VuZGVyLm5hbWUgOiBldi5nZXRTZW5kZXIoKTtcbiAgICByZXR1cm4gKCkgPT4gX3QoJyUoc2VuZGVyRGlzcGxheU5hbWUpcyB1cGdyYWRlZCB0aGlzIHJvb20uJywgeyBzZW5kZXJEaXNwbGF5TmFtZSB9KTtcbn1cblxuY29uc3Qgb25WaWV3Sm9pblJ1bGVTZXR0aW5nc0NsaWNrID0gKCkgPT4ge1xuICAgIGRlZmF1bHREaXNwYXRjaGVyLmRpc3BhdGNoKHtcbiAgICAgICAgYWN0aW9uOiBcIm9wZW5fcm9vbV9zZXR0aW5nc1wiLFxuICAgICAgICBpbml0aWFsX3RhYl9pZDogUk9PTV9TRUNVUklUWV9UQUIsXG4gICAgfSk7XG59O1xuXG5mdW5jdGlvbiB0ZXh0Rm9ySm9pblJ1bGVzRXZlbnQoZXY6IE1hdHJpeEV2ZW50LCBhbGxvd0pTWDogYm9vbGVhbik6ICgpID0+IHN0cmluZyB8IEpTWC5FbGVtZW50IHwgbnVsbCB7XG4gICAgY29uc3Qgc2VuZGVyRGlzcGxheU5hbWUgPSBldi5zZW5kZXIgJiYgZXYuc2VuZGVyLm5hbWUgPyBldi5zZW5kZXIubmFtZSA6IGV2LmdldFNlbmRlcigpO1xuICAgIHN3aXRjaCAoZXYuZ2V0Q29udGVudCgpLmpvaW5fcnVsZSkge1xuICAgICAgICBjYXNlIEpvaW5SdWxlLlB1YmxpYzpcbiAgICAgICAgICAgIHJldHVybiAoKSA9PiBfdCgnJShzZW5kZXJEaXNwbGF5TmFtZSlzIG1hZGUgdGhlIHJvb20gcHVibGljIHRvIHdob2V2ZXIga25vd3MgdGhlIGxpbmsuJywge1xuICAgICAgICAgICAgICAgIHNlbmRlckRpc3BsYXlOYW1lLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIGNhc2UgSm9pblJ1bGUuSW52aXRlOlxuICAgICAgICAgICAgcmV0dXJuICgpID0+IF90KCclKHNlbmRlckRpc3BsYXlOYW1lKXMgbWFkZSB0aGUgcm9vbSBpbnZpdGUgb25seS4nLCB7XG4gICAgICAgICAgICAgICAgc2VuZGVyRGlzcGxheU5hbWUsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgY2FzZSBKb2luUnVsZS5SZXN0cmljdGVkOlxuICAgICAgICAgICAgaWYgKGFsbG93SlNYKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICgpID0+IDxzcGFuPlxuICAgICAgICAgICAgICAgICAgICB7IF90KCclKHNlbmRlckRpc3BsYXlOYW1lKXMgY2hhbmdlZCB3aG8gY2FuIGpvaW4gdGhpcyByb29tLiA8YT5WaWV3IHNldHRpbmdzPC9hPi4nLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZW5kZXJEaXNwbGF5TmFtZSxcbiAgICAgICAgICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJhXCI6IChzdWIpID0+IDxhIG9uQ2xpY2s9e29uVmlld0pvaW5SdWxlU2V0dGluZ3NDbGlja30+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBzdWIgfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9hPixcbiAgICAgICAgICAgICAgICAgICAgfSkgfVxuICAgICAgICAgICAgICAgIDwvc3Bhbj47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiAoKSA9PiBfdCgnJShzZW5kZXJEaXNwbGF5TmFtZSlzIGNoYW5nZWQgd2hvIGNhbiBqb2luIHRoaXMgcm9vbS4nLCB7IHNlbmRlckRpc3BsYXlOYW1lIH0pO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgLy8gVGhlIHNwZWMgc3VwcG9ydHMgXCJrbm9ja1wiIGFuZCBcInByaXZhdGVcIiwgaG93ZXZlciBub3RoaW5nIGltcGxlbWVudHMgdGhlc2UuXG4gICAgICAgICAgICByZXR1cm4gKCkgPT4gX3QoJyUoc2VuZGVyRGlzcGxheU5hbWUpcyBjaGFuZ2VkIHRoZSBqb2luIHJ1bGUgdG8gJShydWxlKXMnLCB7XG4gICAgICAgICAgICAgICAgc2VuZGVyRGlzcGxheU5hbWUsXG4gICAgICAgICAgICAgICAgcnVsZTogZXYuZ2V0Q29udGVudCgpLmpvaW5fcnVsZSxcbiAgICAgICAgICAgIH0pO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gdGV4dEZvckd1ZXN0QWNjZXNzRXZlbnQoZXY6IE1hdHJpeEV2ZW50KTogKCkgPT4gc3RyaW5nIHwgbnVsbCB7XG4gICAgY29uc3Qgc2VuZGVyRGlzcGxheU5hbWUgPSBldi5zZW5kZXIgJiYgZXYuc2VuZGVyLm5hbWUgPyBldi5zZW5kZXIubmFtZSA6IGV2LmdldFNlbmRlcigpO1xuICAgIHN3aXRjaCAoZXYuZ2V0Q29udGVudCgpLmd1ZXN0X2FjY2Vzcykge1xuICAgICAgICBjYXNlIEd1ZXN0QWNjZXNzLkNhbkpvaW46XG4gICAgICAgICAgICByZXR1cm4gKCkgPT4gX3QoJyUoc2VuZGVyRGlzcGxheU5hbWUpcyBoYXMgYWxsb3dlZCBndWVzdHMgdG8gam9pbiB0aGUgcm9vbS4nLCB7IHNlbmRlckRpc3BsYXlOYW1lIH0pO1xuICAgICAgICBjYXNlIEd1ZXN0QWNjZXNzLkZvcmJpZGRlbjpcbiAgICAgICAgICAgIHJldHVybiAoKSA9PiBfdCgnJShzZW5kZXJEaXNwbGF5TmFtZSlzIGhhcyBwcmV2ZW50ZWQgZ3Vlc3RzIGZyb20gam9pbmluZyB0aGUgcm9vbS4nLCB7IHNlbmRlckRpc3BsYXlOYW1lIH0pO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgLy8gVGhlcmUncyBubyBvdGhlciBvcHRpb25zIHdlIGNhbiBleHBlY3QsIGhvd2V2ZXIganVzdCBmb3Igc2FmZXR5J3Mgc2FrZSB3ZSdsbCBkbyB0aGlzLlxuICAgICAgICAgICAgcmV0dXJuICgpID0+IF90KCclKHNlbmRlckRpc3BsYXlOYW1lKXMgY2hhbmdlZCBndWVzdCBhY2Nlc3MgdG8gJShydWxlKXMnLCB7XG4gICAgICAgICAgICAgICAgc2VuZGVyRGlzcGxheU5hbWUsXG4gICAgICAgICAgICAgICAgcnVsZTogZXYuZ2V0Q29udGVudCgpLmd1ZXN0X2FjY2VzcyxcbiAgICAgICAgICAgIH0pO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gdGV4dEZvclJlbGF0ZWRHcm91cHNFdmVudChldjogTWF0cml4RXZlbnQpOiAoKSA9PiBzdHJpbmcgfCBudWxsIHtcbiAgICBjb25zdCBzZW5kZXJEaXNwbGF5TmFtZSA9IGV2LnNlbmRlciAmJiBldi5zZW5kZXIubmFtZSA/IGV2LnNlbmRlci5uYW1lIDogZXYuZ2V0U2VuZGVyKCk7XG4gICAgY29uc3QgZ3JvdXBzID0gZXYuZ2V0Q29udGVudCgpLmdyb3VwcyB8fCBbXTtcbiAgICBjb25zdCBwcmV2R3JvdXBzID0gZXYuZ2V0UHJldkNvbnRlbnQoKS5ncm91cHMgfHwgW107XG4gICAgY29uc3QgYWRkZWQgPSBncm91cHMuZmlsdGVyKChnKSA9PiAhcHJldkdyb3Vwcy5pbmNsdWRlcyhnKSk7XG4gICAgY29uc3QgcmVtb3ZlZCA9IHByZXZHcm91cHMuZmlsdGVyKChnKSA9PiAhZ3JvdXBzLmluY2x1ZGVzKGcpKTtcblxuICAgIGlmIChhZGRlZC5sZW5ndGggJiYgIXJlbW92ZWQubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiAoKSA9PiBfdCgnJShzZW5kZXJEaXNwbGF5TmFtZSlzIGVuYWJsZWQgZmxhaXIgZm9yICUoZ3JvdXBzKXMgaW4gdGhpcyByb29tLicsIHtcbiAgICAgICAgICAgIHNlbmRlckRpc3BsYXlOYW1lLFxuICAgICAgICAgICAgZ3JvdXBzOiBhZGRlZC5qb2luKCcsICcpLFxuICAgICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKCFhZGRlZC5sZW5ndGggJiYgcmVtb3ZlZC5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuICgpID0+IF90KCclKHNlbmRlckRpc3BsYXlOYW1lKXMgZGlzYWJsZWQgZmxhaXIgZm9yICUoZ3JvdXBzKXMgaW4gdGhpcyByb29tLicsIHtcbiAgICAgICAgICAgIHNlbmRlckRpc3BsYXlOYW1lLFxuICAgICAgICAgICAgZ3JvdXBzOiByZW1vdmVkLmpvaW4oJywgJyksXG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSBpZiAoYWRkZWQubGVuZ3RoICYmIHJlbW92ZWQubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiAoKSA9PiBfdCgnJShzZW5kZXJEaXNwbGF5TmFtZSlzIGVuYWJsZWQgZmxhaXIgZm9yICUobmV3R3JvdXBzKXMgYW5kIGRpc2FibGVkIGZsYWlyIGZvciAnICtcbiAgICAgICAgICAgICclKG9sZEdyb3VwcylzIGluIHRoaXMgcm9vbS4nLCB7XG4gICAgICAgICAgICBzZW5kZXJEaXNwbGF5TmFtZSxcbiAgICAgICAgICAgIG5ld0dyb3VwczogYWRkZWQuam9pbignLCAnKSxcbiAgICAgICAgICAgIG9sZEdyb3VwczogcmVtb3ZlZC5qb2luKCcsICcpLFxuICAgICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBEb24ndCBib3RoZXIgcmVuZGVyaW5nIHRoaXMgY2hhbmdlIChiZWNhdXNlIHRoZXJlIHdlcmUgbm8gY2hhbmdlcylcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB0ZXh0Rm9yU2VydmVyQUNMRXZlbnQoZXY6IE1hdHJpeEV2ZW50KTogKCkgPT4gc3RyaW5nIHwgbnVsbCB7XG4gICAgY29uc3Qgc2VuZGVyRGlzcGxheU5hbWUgPSBldi5zZW5kZXIgJiYgZXYuc2VuZGVyLm5hbWUgPyBldi5zZW5kZXIubmFtZSA6IGV2LmdldFNlbmRlcigpO1xuICAgIGNvbnN0IHByZXZDb250ZW50ID0gZXYuZ2V0UHJldkNvbnRlbnQoKTtcbiAgICBjb25zdCBjdXJyZW50ID0gZXYuZ2V0Q29udGVudCgpO1xuICAgIGNvbnN0IHByZXYgPSB7XG4gICAgICAgIGRlbnk6IEFycmF5LmlzQXJyYXkocHJldkNvbnRlbnQuZGVueSkgPyBwcmV2Q29udGVudC5kZW55IDogW10sXG4gICAgICAgIGFsbG93OiBBcnJheS5pc0FycmF5KHByZXZDb250ZW50LmFsbG93KSA/IHByZXZDb250ZW50LmFsbG93IDogW10sXG4gICAgICAgIGFsbG93X2lwX2xpdGVyYWxzOiAhKHByZXZDb250ZW50LmFsbG93X2lwX2xpdGVyYWxzID09PSBmYWxzZSksXG4gICAgfTtcblxuICAgIGxldCBnZXRUZXh0ID0gbnVsbDtcbiAgICBpZiAocHJldi5kZW55Lmxlbmd0aCA9PT0gMCAmJiBwcmV2LmFsbG93Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBnZXRUZXh0ID0gKCkgPT4gX3QoXCIlKHNlbmRlckRpc3BsYXlOYW1lKXMgc2V0IHRoZSBzZXJ2ZXIgQUNMcyBmb3IgdGhpcyByb29tLlwiLCB7IHNlbmRlckRpc3BsYXlOYW1lIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGdldFRleHQgPSAoKSA9PiBfdChcIiUoc2VuZGVyRGlzcGxheU5hbWUpcyBjaGFuZ2VkIHRoZSBzZXJ2ZXIgQUNMcyBmb3IgdGhpcyByb29tLlwiLCB7IHNlbmRlckRpc3BsYXlOYW1lIH0pO1xuICAgIH1cblxuICAgIGlmICghQXJyYXkuaXNBcnJheShjdXJyZW50LmFsbG93KSkge1xuICAgICAgICBjdXJyZW50LmFsbG93ID0gW107XG4gICAgfVxuXG4gICAgLy8gSWYgd2Uga25vdyBmb3Igc3VyZSBldmVyeW9uZSBpcyBiYW5uZWQsIG1hcmsgdGhlIHJvb20gYXMgb2JsaXRlcmF0ZWRcbiAgICBpZiAoY3VycmVudC5hbGxvdy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuICgpID0+IGdldFRleHQoKSArIFwiIFwiICtcbiAgICAgICAgICAgIF90KFwi8J+OiSBBbGwgc2VydmVycyBhcmUgYmFubmVkIGZyb20gcGFydGljaXBhdGluZyEgVGhpcyByb29tIGNhbiBubyBsb25nZXIgYmUgdXNlZC5cIik7XG4gICAgfVxuXG4gICAgcmV0dXJuIGdldFRleHQ7XG59XG5cbmZ1bmN0aW9uIHRleHRGb3JNZXNzYWdlRXZlbnQoZXY6IE1hdHJpeEV2ZW50KTogKCkgPT4gc3RyaW5nIHwgbnVsbCB7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgY29uc3Qgc2VuZGVyRGlzcGxheU5hbWUgPSBldi5zZW5kZXIgJiYgZXYuc2VuZGVyLm5hbWUgPyBldi5zZW5kZXIubmFtZSA6IGV2LmdldFNlbmRlcigpO1xuICAgICAgICBsZXQgbWVzc2FnZSA9IGV2LmdldENvbnRlbnQoKS5ib2R5O1xuICAgICAgICBpZiAoZXYuaXNSZWRhY3RlZCgpKSB7XG4gICAgICAgICAgICBtZXNzYWdlID0gX3QoXCJNZXNzYWdlIGRlbGV0ZWRcIik7XG4gICAgICAgICAgICBjb25zdCB1bnNpZ25lZCA9IGV2LmdldFVuc2lnbmVkKCk7XG4gICAgICAgICAgICBjb25zdCByZWRhY3RlZEJlY2F1c2VVc2VySWQgPSB1bnNpZ25lZD8ucmVkYWN0ZWRfYmVjYXVzZT8uc2VuZGVyO1xuICAgICAgICAgICAgaWYgKHJlZGFjdGVkQmVjYXVzZVVzZXJJZCAmJiByZWRhY3RlZEJlY2F1c2VVc2VySWQgIT09IGV2LmdldFNlbmRlcigpKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgcm9vbSA9IE1hdHJpeENsaWVudFBlZy5nZXQoKS5nZXRSb29tKGV2LmdldFJvb21JZCgpKTtcbiAgICAgICAgICAgICAgICBjb25zdCBzZW5kZXIgPSByb29tPy5nZXRNZW1iZXIocmVkYWN0ZWRCZWNhdXNlVXNlcklkKTtcbiAgICAgICAgICAgICAgICBtZXNzYWdlID0gX3QoXCJNZXNzYWdlIGRlbGV0ZWQgYnkgJShuYW1lKXNcIiwgeyBuYW1lOiBzZW5kZXI/Lm5hbWVcbiB8fCByZWRhY3RlZEJlY2F1c2VVc2VySWQgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV2LmdldENvbnRlbnQoKS5tc2d0eXBlID09PSBNc2dUeXBlLkVtb3RlKSB7XG4gICAgICAgICAgICBtZXNzYWdlID0gXCIqIFwiICsgc2VuZGVyRGlzcGxheU5hbWUgKyBcIiBcIiArIG1lc3NhZ2U7XG4gICAgICAgIH0gZWxzZSBpZiAoZXYuZ2V0Q29udGVudCgpLm1zZ3R5cGUgPT09IE1zZ1R5cGUuSW1hZ2UpIHtcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBfdCgnJShzZW5kZXJEaXNwbGF5TmFtZSlzIHNlbnQgYW4gaW1hZ2UuJywgeyBzZW5kZXJEaXNwbGF5TmFtZSB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChldi5nZXRUeXBlKCkgPT0gRXZlbnRUeXBlLlN0aWNrZXIpIHtcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBfdCgnJShzZW5kZXJEaXNwbGF5TmFtZSlzIHNlbnQgYSBzdGlja2VyLicsIHsgc2VuZGVyRGlzcGxheU5hbWUgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBpbiB0aGlzIGNhc2UsIHBhcnNlIGl0IGFzIGEgcGxhaW4gdGV4dCBtZXNzYWdlXG4gICAgICAgICAgICBtZXNzYWdlID0gc2VuZGVyRGlzcGxheU5hbWUgKyAnOiAnICsgbWVzc2FnZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICB9O1xufVxuXG5mdW5jdGlvbiB0ZXh0Rm9yQ2Fub25pY2FsQWxpYXNFdmVudChldjogTWF0cml4RXZlbnQpOiAoKSA9PiBzdHJpbmcgfCBudWxsIHtcbiAgICBjb25zdCBzZW5kZXJOYW1lID0gZXYuc2VuZGVyICYmIGV2LnNlbmRlci5uYW1lID8gZXYuc2VuZGVyLm5hbWUgOiBldi5nZXRTZW5kZXIoKTtcbiAgICBjb25zdCBvbGRBbGlhcyA9IGV2LmdldFByZXZDb250ZW50KCkuYWxpYXM7XG4gICAgY29uc3Qgb2xkQWx0QWxpYXNlcyA9IGV2LmdldFByZXZDb250ZW50KCkuYWx0X2FsaWFzZXMgfHwgW107XG4gICAgY29uc3QgbmV3QWxpYXMgPSBldi5nZXRDb250ZW50KCkuYWxpYXM7XG4gICAgY29uc3QgbmV3QWx0QWxpYXNlcyA9IGV2LmdldENvbnRlbnQoKS5hbHRfYWxpYXNlcyB8fCBbXTtcbiAgICBjb25zdCByZW1vdmVkQWx0QWxpYXNlcyA9IG9sZEFsdEFsaWFzZXMuZmlsdGVyKGFsaWFzID0+ICFuZXdBbHRBbGlhc2VzLmluY2x1ZGVzKGFsaWFzKSk7XG4gICAgY29uc3QgYWRkZWRBbHRBbGlhc2VzID0gbmV3QWx0QWxpYXNlcy5maWx0ZXIoYWxpYXMgPT4gIW9sZEFsdEFsaWFzZXMuaW5jbHVkZXMoYWxpYXMpKTtcblxuICAgIGlmICghcmVtb3ZlZEFsdEFsaWFzZXMubGVuZ3RoICYmICFhZGRlZEFsdEFsaWFzZXMubGVuZ3RoKSB7XG4gICAgICAgIGlmIChuZXdBbGlhcykge1xuICAgICAgICAgICAgcmV0dXJuICgpID0+IF90KCclKHNlbmRlck5hbWUpcyBzZXQgdGhlIG1haW4gYWRkcmVzcyBmb3IgdGhpcyByb29tIHRvICUoYWRkcmVzcylzLicsIHtcbiAgICAgICAgICAgICAgICBzZW5kZXJOYW1lOiBzZW5kZXJOYW1lLFxuICAgICAgICAgICAgICAgIGFkZHJlc3M6IGV2LmdldENvbnRlbnQoKS5hbGlhcyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKG9sZEFsaWFzKSB7XG4gICAgICAgICAgICByZXR1cm4gKCkgPT4gX3QoJyUoc2VuZGVyTmFtZSlzIHJlbW92ZWQgdGhlIG1haW4gYWRkcmVzcyBmb3IgdGhpcyByb29tLicsIHtcbiAgICAgICAgICAgICAgICBzZW5kZXJOYW1lOiBzZW5kZXJOYW1lLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKG5ld0FsaWFzID09PSBvbGRBbGlhcykge1xuICAgICAgICBpZiAoYWRkZWRBbHRBbGlhc2VzLmxlbmd0aCAmJiAhcmVtb3ZlZEFsdEFsaWFzZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gKCkgPT4gX3QoJyUoc2VuZGVyTmFtZSlzIGFkZGVkIHRoZSBhbHRlcm5hdGl2ZSBhZGRyZXNzZXMgJShhZGRyZXNzZXMpcyBmb3IgdGhpcyByb29tLicsIHtcbiAgICAgICAgICAgICAgICBzZW5kZXJOYW1lOiBzZW5kZXJOYW1lLFxuICAgICAgICAgICAgICAgIGFkZHJlc3NlczogYWRkZWRBbHRBbGlhc2VzLmpvaW4oXCIsIFwiKSxcbiAgICAgICAgICAgICAgICBjb3VudDogYWRkZWRBbHRBbGlhc2VzLmxlbmd0aCxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGlmIChyZW1vdmVkQWx0QWxpYXNlcy5sZW5ndGggJiYgIWFkZGVkQWx0QWxpYXNlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiAoKSA9PiBfdCgnJShzZW5kZXJOYW1lKXMgcmVtb3ZlZCB0aGUgYWx0ZXJuYXRpdmUgYWRkcmVzc2VzICUoYWRkcmVzc2VzKXMgZm9yIHRoaXMgcm9vbS4nLCB7XG4gICAgICAgICAgICAgICAgc2VuZGVyTmFtZTogc2VuZGVyTmFtZSxcbiAgICAgICAgICAgICAgICBhZGRyZXNzZXM6IHJlbW92ZWRBbHRBbGlhc2VzLmpvaW4oXCIsIFwiKSxcbiAgICAgICAgICAgICAgICBjb3VudDogcmVtb3ZlZEFsdEFsaWFzZXMubGVuZ3RoLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gaWYgKHJlbW92ZWRBbHRBbGlhc2VzLmxlbmd0aCAmJiBhZGRlZEFsdEFsaWFzZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gKCkgPT4gX3QoJyUoc2VuZGVyTmFtZSlzIGNoYW5nZWQgdGhlIGFsdGVybmF0aXZlIGFkZHJlc3NlcyBmb3IgdGhpcyByb29tLicsIHtcbiAgICAgICAgICAgICAgICBzZW5kZXJOYW1lOiBzZW5kZXJOYW1lLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBib3RoIGFsaWFzIGFuZCBhbHRfYWxpYXNlcyB3aGVyZSBtb2RpZmllZFxuICAgICAgICByZXR1cm4gKCkgPT4gX3QoJyUoc2VuZGVyTmFtZSlzIGNoYW5nZWQgdGhlIG1haW4gYW5kIGFsdGVybmF0aXZlIGFkZHJlc3NlcyBmb3IgdGhpcyByb29tLicsIHtcbiAgICAgICAgICAgIHNlbmRlck5hbWU6IHNlbmRlck5hbWUsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvLyBpbiBjYXNlIHRoZXJlIGlzIG5vIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUgdHdvIGV2ZW50cyxcbiAgICAvLyBzYXkgc29tZXRoaW5nIGFzIHdlIGNhbid0IHNpbXBseSBoaWRlIHRoZSB0aWxlIGZyb20gaGVyZVxuICAgIHJldHVybiAoKSA9PiBfdCgnJShzZW5kZXJOYW1lKXMgY2hhbmdlZCB0aGUgYWRkcmVzc2VzIGZvciB0aGlzIHJvb20uJywge1xuICAgICAgICBzZW5kZXJOYW1lOiBzZW5kZXJOYW1lLFxuICAgIH0pO1xufVxuXG5mdW5jdGlvbiB0ZXh0Rm9yVGhyZWVQaWRJbnZpdGVFdmVudChldmVudDogTWF0cml4RXZlbnQpOiAoKSA9PiBzdHJpbmcgfCBudWxsIHtcbiAgICBjb25zdCBzZW5kZXJOYW1lID0gZXZlbnQuc2VuZGVyID8gZXZlbnQuc2VuZGVyLm5hbWUgOiBldmVudC5nZXRTZW5kZXIoKTtcblxuICAgIGlmICghaXNWYWxpZDNwaWRJbnZpdGUoZXZlbnQpKSB7XG4gICAgICAgIHJldHVybiAoKSA9PiBfdCgnJShzZW5kZXJOYW1lKXMgcmV2b2tlZCB0aGUgaW52aXRhdGlvbiBmb3IgJSh0YXJnZXREaXNwbGF5TmFtZSlzIHRvIGpvaW4gdGhlIHJvb20uJywge1xuICAgICAgICAgICAgc2VuZGVyTmFtZSxcbiAgICAgICAgICAgIHRhcmdldERpc3BsYXlOYW1lOiBldmVudC5nZXRQcmV2Q29udGVudCgpLmRpc3BsYXlfbmFtZSB8fCBfdChcIlNvbWVvbmVcIiksXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiAoKSA9PiBfdCgnJShzZW5kZXJOYW1lKXMgc2VudCBhbiBpbnZpdGF0aW9uIHRvICUodGFyZ2V0RGlzcGxheU5hbWUpcyB0byBqb2luIHRoZSByb29tLicsIHtcbiAgICAgICAgc2VuZGVyTmFtZSxcbiAgICAgICAgdGFyZ2V0RGlzcGxheU5hbWU6IGV2ZW50LmdldENvbnRlbnQoKS5kaXNwbGF5X25hbWUsXG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIHRleHRGb3JIaXN0b3J5VmlzaWJpbGl0eUV2ZW50KGV2ZW50OiBNYXRyaXhFdmVudCk6ICgpID0+IHN0cmluZyB8IG51bGwge1xuICAgIGNvbnN0IHNlbmRlck5hbWUgPSBldmVudC5zZW5kZXIgPyBldmVudC5zZW5kZXIubmFtZSA6IGV2ZW50LmdldFNlbmRlcigpO1xuICAgIHN3aXRjaCAoZXZlbnQuZ2V0Q29udGVudCgpLmhpc3RvcnlfdmlzaWJpbGl0eSkge1xuICAgICAgICBjYXNlIEhpc3RvcnlWaXNpYmlsaXR5Lkludml0ZWQ6XG4gICAgICAgICAgICByZXR1cm4gKCkgPT4gX3QoJyUoc2VuZGVyTmFtZSlzIG1hZGUgZnV0dXJlIHJvb20gaGlzdG9yeSB2aXNpYmxlIHRvIGFsbCByb29tIG1lbWJlcnMsICdcbiAgICAgICAgICAgICAgICArICdmcm9tIHRoZSBwb2ludCB0aGV5IGFyZSBpbnZpdGVkLicsIHsgc2VuZGVyTmFtZSB9KTtcbiAgICAgICAgY2FzZSBIaXN0b3J5VmlzaWJpbGl0eS5Kb2luZWQ6XG4gICAgICAgICAgICByZXR1cm4gKCkgPT4gX3QoJyUoc2VuZGVyTmFtZSlzIG1hZGUgZnV0dXJlIHJvb20gaGlzdG9yeSB2aXNpYmxlIHRvIGFsbCByb29tIG1lbWJlcnMsICdcbiAgICAgICAgICAgICAgICArICdmcm9tIHRoZSBwb2ludCB0aGV5IGpvaW5lZC4nLCB7IHNlbmRlck5hbWUgfSk7XG4gICAgICAgIGNhc2UgSGlzdG9yeVZpc2liaWxpdHkuU2hhcmVkOlxuICAgICAgICAgICAgcmV0dXJuICgpID0+IF90KCclKHNlbmRlck5hbWUpcyBtYWRlIGZ1dHVyZSByb29tIGhpc3RvcnkgdmlzaWJsZSB0byBhbGwgcm9vbSBtZW1iZXJzLicsIHsgc2VuZGVyTmFtZSB9KTtcbiAgICAgICAgY2FzZSBIaXN0b3J5VmlzaWJpbGl0eS5Xb3JsZFJlYWRhYmxlOlxuICAgICAgICAgICAgcmV0dXJuICgpID0+IF90KCclKHNlbmRlck5hbWUpcyBtYWRlIGZ1dHVyZSByb29tIGhpc3RvcnkgdmlzaWJsZSB0byBhbnlvbmUuJywgeyBzZW5kZXJOYW1lIH0pO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuICgpID0+IF90KCclKHNlbmRlck5hbWUpcyBtYWRlIGZ1dHVyZSByb29tIGhpc3RvcnkgdmlzaWJsZSB0byB1bmtub3duICglKHZpc2liaWxpdHkpcykuJywge1xuICAgICAgICAgICAgICAgIHNlbmRlck5hbWUsXG4gICAgICAgICAgICAgICAgdmlzaWJpbGl0eTogZXZlbnQuZ2V0Q29udGVudCgpLmhpc3RvcnlfdmlzaWJpbGl0eSxcbiAgICAgICAgICAgIH0pO1xuICAgIH1cbn1cblxuLy8gQ3VycmVudGx5IHdpbGwgb25seSBkaXNwbGF5IGEgY2hhbmdlIGlmIGEgdXNlcidzIHBvd2VyIGxldmVsIGlzIGNoYW5nZWRcbmZ1bmN0aW9uIHRleHRGb3JQb3dlckV2ZW50KGV2ZW50OiBNYXRyaXhFdmVudCk6ICgpID0+IHN0cmluZyB8IG51bGwge1xuICAgIGNvbnN0IHNlbmRlck5hbWUgPSBldmVudC5zZW5kZXIgPyBldmVudC5zZW5kZXIubmFtZSA6IGV2ZW50LmdldFNlbmRlcigpO1xuICAgIGlmICghZXZlbnQuZ2V0UHJldkNvbnRlbnQoKSB8fCAhZXZlbnQuZ2V0UHJldkNvbnRlbnQoKS51c2VycyB8fFxuICAgICAgICAhZXZlbnQuZ2V0Q29udGVudCgpIHx8ICFldmVudC5nZXRDb250ZW50KCkudXNlcnMpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IHByZXZpb3VzVXNlckRlZmF1bHQgPSBldmVudC5nZXRQcmV2Q29udGVudCgpLnVzZXJzX2RlZmF1bHQgfHwgMDtcbiAgICBjb25zdCBjdXJyZW50VXNlckRlZmF1bHQgPSBldmVudC5nZXRDb250ZW50KCkudXNlcnNfZGVmYXVsdCB8fCAwO1xuICAgIC8vIENvbnN0cnVjdCBzZXQgb2YgdXNlcklkc1xuICAgIGNvbnN0IHVzZXJzID0gW107XG4gICAgT2JqZWN0LmtleXMoZXZlbnQuZ2V0Q29udGVudCgpLnVzZXJzKS5mb3JFYWNoKFxuICAgICAgICAodXNlcklkKSA9PiB7XG4gICAgICAgICAgICBpZiAodXNlcnMuaW5kZXhPZih1c2VySWQpID09PSAtMSkgdXNlcnMucHVzaCh1c2VySWQpO1xuICAgICAgICB9LFxuICAgICk7XG4gICAgT2JqZWN0LmtleXMoZXZlbnQuZ2V0UHJldkNvbnRlbnQoKS51c2VycykuZm9yRWFjaChcbiAgICAgICAgKHVzZXJJZCkgPT4ge1xuICAgICAgICAgICAgaWYgKHVzZXJzLmluZGV4T2YodXNlcklkKSA9PT0gLTEpIHVzZXJzLnB1c2godXNlcklkKTtcbiAgICAgICAgfSxcbiAgICApO1xuICAgIGNvbnN0IGRpZmZzID0gW107XG4gICAgdXNlcnMuZm9yRWFjaCgodXNlcklkKSA9PiB7XG4gICAgICAgIC8vIFByZXZpb3VzIHBvd2VyIGxldmVsXG4gICAgICAgIGxldCBmcm9tID0gZXZlbnQuZ2V0UHJldkNvbnRlbnQoKS51c2Vyc1t1c2VySWRdO1xuICAgICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIoZnJvbSkpIHtcbiAgICAgICAgICAgIGZyb20gPSBwcmV2aW91c1VzZXJEZWZhdWx0O1xuICAgICAgICB9XG4gICAgICAgIC8vIEN1cnJlbnQgcG93ZXIgbGV2ZWxcbiAgICAgICAgbGV0IHRvID0gZXZlbnQuZ2V0Q29udGVudCgpLnVzZXJzW3VzZXJJZF07XG4gICAgICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcih0bykpIHtcbiAgICAgICAgICAgIHRvID0gY3VycmVudFVzZXJEZWZhdWx0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChmcm9tID09PSBwcmV2aW91c1VzZXJEZWZhdWx0ICYmIHRvID09PSBjdXJyZW50VXNlckRlZmF1bHQpIHsgcmV0dXJuOyB9XG4gICAgICAgIGlmICh0byAhPT0gZnJvbSkge1xuICAgICAgICAgICAgZGlmZnMucHVzaCh7IHVzZXJJZCwgZnJvbSwgdG8gfSk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoIWRpZmZzLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgLy8gWFhYOiBUaGlzIGlzIGFsc28gc3VyZWx5IGJyb2tlbiBmb3IgaTE4blxuICAgIHJldHVybiAoKSA9PiBfdCgnJShzZW5kZXJOYW1lKXMgY2hhbmdlZCB0aGUgcG93ZXIgbGV2ZWwgb2YgJShwb3dlckxldmVsRGlmZlRleHQpcy4nLCB7XG4gICAgICAgIHNlbmRlck5hbWUsXG4gICAgICAgIHBvd2VyTGV2ZWxEaWZmVGV4dDogZGlmZnMubWFwKGRpZmYgPT5cbiAgICAgICAgICAgIF90KCclKHVzZXJJZClzIGZyb20gJShmcm9tUG93ZXJMZXZlbClzIHRvICUodG9Qb3dlckxldmVsKXMnLCB7XG4gICAgICAgICAgICAgICAgdXNlcklkOiBkaWZmLnVzZXJJZCxcbiAgICAgICAgICAgICAgICBmcm9tUG93ZXJMZXZlbDogUm9sZXMudGV4dHVhbFBvd2VyTGV2ZWwoZGlmZi5mcm9tLCBwcmV2aW91c1VzZXJEZWZhdWx0KSxcbiAgICAgICAgICAgICAgICB0b1Bvd2VyTGV2ZWw6IFJvbGVzLnRleHR1YWxQb3dlckxldmVsKGRpZmYudG8sIGN1cnJlbnRVc2VyRGVmYXVsdCksXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgKS5qb2luKFwiLCBcIiksXG4gICAgfSk7XG59XG5cbmNvbnN0IG9uUGlubmVkT3JVbnBpbm5lZE1lc3NhZ2VDbGljayA9IChtZXNzYWdlSWQ6IHN0cmluZywgcm9vbUlkOiBzdHJpbmcpOiB2b2lkID0+IHtcbiAgICBkZWZhdWx0RGlzcGF0Y2hlci5kaXNwYXRjaCh7XG4gICAgICAgIGFjdGlvbjogQWN0aW9uLlZpZXdSb29tLFxuICAgICAgICBldmVudF9pZDogbWVzc2FnZUlkLFxuICAgICAgICBoaWdobGlnaHRlZDogdHJ1ZSxcbiAgICAgICAgcm9vbV9pZDogcm9vbUlkLFxuICAgIH0pO1xufTtcblxuY29uc3Qgb25QaW5uZWRNZXNzYWdlc0NsaWNrID0gKCk6IHZvaWQgPT4ge1xuICAgIGRlZmF1bHREaXNwYXRjaGVyLmRpc3BhdGNoPFNldFJpZ2h0UGFuZWxQaGFzZVBheWxvYWQ+KHtcbiAgICAgICAgYWN0aW9uOiBBY3Rpb24uU2V0UmlnaHRQYW5lbFBoYXNlLFxuICAgICAgICBwaGFzZTogUmlnaHRQYW5lbFBoYXNlcy5QaW5uZWRNZXNzYWdlcyxcbiAgICAgICAgYWxsb3dDbG9zZTogZmFsc2UsXG4gICAgfSk7XG59O1xuXG5mdW5jdGlvbiB0ZXh0Rm9yUGlubmVkRXZlbnQoZXZlbnQ6IE1hdHJpeEV2ZW50LCBhbGxvd0pTWDogYm9vbGVhbik6ICgpID0+IHN0cmluZyB8IEpTWC5FbGVtZW50IHwgbnVsbCB7XG4gICAgaWYgKCFTZXR0aW5nc1N0b3JlLmdldFZhbHVlKFwiZmVhdHVyZV9waW5uaW5nXCIpKSByZXR1cm4gbnVsbDtcbiAgICBjb25zdCBzZW5kZXJOYW1lID0gZXZlbnQuc2VuZGVyID8gZXZlbnQuc2VuZGVyLm5hbWUgOiBldmVudC5nZXRTZW5kZXIoKTtcbiAgICBjb25zdCByb29tSWQgPSBldmVudC5nZXRSb29tSWQoKTtcblxuICAgIGNvbnN0IHBpbm5lZCA9IGV2ZW50LmdldENvbnRlbnQoKS5waW5uZWQgPz8gW107XG4gICAgY29uc3QgcHJldmlvdXNseVBpbm5lZCA9IGV2ZW50LmdldFByZXZDb250ZW50KCkucGlubmVkID8/IFtdO1xuICAgIGNvbnN0IG5ld2x5UGlubmVkID0gcGlubmVkLmZpbHRlcihpdGVtID0+IHByZXZpb3VzbHlQaW5uZWQuaW5kZXhPZihpdGVtKSA8IDApO1xuICAgIGNvbnN0IG5ld2x5VW5waW5uZWQgPSBwcmV2aW91c2x5UGlubmVkLmZpbHRlcihpdGVtID0+IHBpbm5lZC5pbmRleE9mKGl0ZW0pIDwgMCk7XG5cbiAgICBpZiAobmV3bHlQaW5uZWQubGVuZ3RoID09PSAxICYmIG5ld2x5VW5waW5uZWQubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIC8vIEEgc2luZ2xlIG1lc3NhZ2Ugd2FzIHBpbm5lZCwgaW5jbHVkZSBhIGxpbmsgdG8gdGhhdCBtZXNzYWdlLlxuICAgICAgICBpZiAoYWxsb3dKU1gpIHtcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VJZCA9IG5ld2x5UGlubmVkLnBvcCgpO1xuXG4gICAgICAgICAgICByZXR1cm4gKCkgPT4gKFxuICAgICAgICAgICAgICAgIDxzcGFuPlxuICAgICAgICAgICAgICAgICAgICB7IF90KFxuICAgICAgICAgICAgICAgICAgICAgICAgXCIlKHNlbmRlck5hbWUpcyBwaW5uZWQgPGE+YSBtZXNzYWdlPC9hPiB0byB0aGlzIHJvb20uIFNlZSBhbGwgPGI+cGlubmVkIG1lc3NhZ2VzPC9iPi5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgc2VuZGVyTmFtZSB9LFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYVwiOiAoc3ViKSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBvbkNsaWNrPXsoZSkgPT4gb25QaW5uZWRPclVucGlubmVkTWVzc2FnZUNsaWNrKG1lc3NhZ2VJZCwgcm9vbUlkKX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHN1YiB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYT4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJiXCI6IChzdWIpID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIG9uQ2xpY2s9e29uUGlubmVkTWVzc2FnZXNDbGlja30+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHN1YiB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYT4sXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICApIH1cbiAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuICgpID0+IF90KFwiJShzZW5kZXJOYW1lKXMgcGlubmVkIGEgbWVzc2FnZSB0byB0aGlzIHJvb20uIFNlZSBhbGwgcGlubmVkIG1lc3NhZ2VzLlwiLCB7IHNlbmRlck5hbWUgfSk7XG4gICAgfVxuXG4gICAgaWYgKG5ld2x5VW5waW5uZWQubGVuZ3RoID09PSAxICYmIG5ld2x5UGlubmVkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAvLyBBIHNpbmdsZSBtZXNzYWdlIHdhcyB1bnBpbm5lZCwgaW5jbHVkZSBhIGxpbmsgdG8gdGhhdCBtZXNzYWdlLlxuICAgICAgICBpZiAoYWxsb3dKU1gpIHtcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VJZCA9IG5ld2x5VW5waW5uZWQucG9wKCk7XG5cbiAgICAgICAgICAgIHJldHVybiAoKSA9PiAoXG4gICAgICAgICAgICAgICAgPHNwYW4+XG4gICAgICAgICAgICAgICAgICAgIHsgX3QoXG4gICAgICAgICAgICAgICAgICAgICAgICBcIiUoc2VuZGVyTmFtZSlzIHVucGlubmVkIDxhPmEgbWVzc2FnZTwvYT4gZnJvbSB0aGlzIHJvb20uIFNlZSBhbGwgPGI+cGlubmVkIG1lc3NhZ2VzPC9iPi5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgc2VuZGVyTmFtZSB9LFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYVwiOiAoc3ViKSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBvbkNsaWNrPXsoZSkgPT4gb25QaW5uZWRPclVucGlubmVkTWVzc2FnZUNsaWNrKG1lc3NhZ2VJZCwgcm9vbUlkKX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHN1YiB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYT4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJiXCI6IChzdWIpID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIG9uQ2xpY2s9e29uUGlubmVkTWVzc2FnZXNDbGlja30+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHN1YiB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYT4sXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICApIH1cbiAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuICgpID0+IF90KFwiJShzZW5kZXJOYW1lKXMgdW5waW5uZWQgYSBtZXNzYWdlIGZyb20gdGhpcyByb29tLiBTZWUgYWxsIHBpbm5lZCBtZXNzYWdlcy5cIiwgeyBzZW5kZXJOYW1lIH0pO1xuICAgIH1cblxuICAgIGlmIChhbGxvd0pTWCkge1xuICAgICAgICByZXR1cm4gKCkgPT4gKFxuICAgICAgICAgICAgPHNwYW4+XG4gICAgICAgICAgICAgICAgeyBfdChcbiAgICAgICAgICAgICAgICAgICAgXCIlKHNlbmRlck5hbWUpcyBjaGFuZ2VkIHRoZSA8YT5waW5uZWQgbWVzc2FnZXM8L2E+IGZvciB0aGUgcm9vbS5cIixcbiAgICAgICAgICAgICAgICAgICAgeyBzZW5kZXJOYW1lIH0sXG4gICAgICAgICAgICAgICAgICAgIHsgXCJhXCI6IChzdWIpID0+IDxhIG9uQ2xpY2s9e29uUGlubmVkTWVzc2FnZXNDbGlja30+IHsgc3ViIH0gPC9hPiB9LFxuICAgICAgICAgICAgICAgICkgfVxuICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICApO1xuICAgIH1cblxuICAgIHJldHVybiAoKSA9PiBfdChcIiUoc2VuZGVyTmFtZSlzIGNoYW5nZWQgdGhlIHBpbm5lZCBtZXNzYWdlcyBmb3IgdGhlIHJvb20uXCIsIHsgc2VuZGVyTmFtZSB9KTtcbn1cblxuZnVuY3Rpb24gdGV4dEZvcldpZGdldEV2ZW50KGV2ZW50OiBNYXRyaXhFdmVudCk6ICgpID0+IHN0cmluZyB8IG51bGwge1xuICAgIGNvbnN0IHNlbmRlck5hbWUgPSBldmVudC5nZXRTZW5kZXIoKTtcbiAgICBjb25zdCB7IG5hbWU6IHByZXZOYW1lLCB0eXBlOiBwcmV2VHlwZSwgdXJsOiBwcmV2VXJsIH0gPSBldmVudC5nZXRQcmV2Q29udGVudCgpO1xuICAgIGNvbnN0IHsgbmFtZSwgdHlwZSwgdXJsIH0gPSBldmVudC5nZXRDb250ZW50KCkgfHwge307XG5cbiAgICBsZXQgd2lkZ2V0TmFtZSA9IG5hbWUgfHwgcHJldk5hbWUgfHwgdHlwZSB8fCBwcmV2VHlwZSB8fCAnJztcbiAgICAvLyBBcHBseSBzZW50ZW5jZSBjYXNlIHRvIHdpZGdldCBuYW1lXG4gICAgaWYgKHdpZGdldE5hbWUgJiYgd2lkZ2V0TmFtZS5sZW5ndGggPiAwKSB7XG4gICAgICAgIHdpZGdldE5hbWUgPSB3aWRnZXROYW1lWzBdLnRvVXBwZXJDYXNlKCkgKyB3aWRnZXROYW1lLnNsaWNlKDEpO1xuICAgIH1cblxuICAgIC8vIElmIHRoZSB3aWRnZXQgd2FzIHJlbW92ZWQsIGl0cyBjb250ZW50IHNob3VsZCBiZSB7fSwgYnV0IHRoaXMgaXMgc3VmZmljaWVudGx5XG4gICAgLy8gZXF1aXZhbGVudCB0byB0aGF0IGNvbmRpdGlvbi5cbiAgICBpZiAodXJsKSB7XG4gICAgICAgIGlmIChwcmV2VXJsKSB7XG4gICAgICAgICAgICByZXR1cm4gKCkgPT4gX3QoJyUod2lkZ2V0TmFtZSlzIHdpZGdldCBtb2RpZmllZCBieSAlKHNlbmRlck5hbWUpcycsIHtcbiAgICAgICAgICAgICAgICB3aWRnZXROYW1lLCBzZW5kZXJOYW1lLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gKCkgPT4gX3QoJyUod2lkZ2V0TmFtZSlzIHdpZGdldCBhZGRlZCBieSAlKHNlbmRlck5hbWUpcycsIHtcbiAgICAgICAgICAgICAgICB3aWRnZXROYW1lLCBzZW5kZXJOYW1lLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gKCkgPT4gX3QoJyUod2lkZ2V0TmFtZSlzIHdpZGdldCByZW1vdmVkIGJ5ICUoc2VuZGVyTmFtZSlzJywge1xuICAgICAgICAgICAgd2lkZ2V0TmFtZSwgc2VuZGVyTmFtZSxcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB0ZXh0Rm9yV2lkZ2V0TGF5b3V0RXZlbnQoZXZlbnQ6IE1hdHJpeEV2ZW50KTogKCkgPT4gc3RyaW5nIHwgbnVsbCB7XG4gICAgY29uc3Qgc2VuZGVyTmFtZSA9IGV2ZW50LnNlbmRlcj8ubmFtZSB8fCBldmVudC5nZXRTZW5kZXIoKTtcbiAgICByZXR1cm4gKCkgPT4gX3QoXCIlKHNlbmRlck5hbWUpcyBoYXMgdXBkYXRlZCB0aGUgcm9vbSBsYXlvdXRcIiwgeyBzZW5kZXJOYW1lIH0pO1xufVxuXG5mdW5jdGlvbiB0ZXh0Rm9yTWpvbG5pckV2ZW50KGV2ZW50OiBNYXRyaXhFdmVudCk6ICgpID0+IHN0cmluZyB8IG51bGwge1xuICAgIGNvbnN0IHNlbmRlck5hbWUgPSBldmVudC5nZXRTZW5kZXIoKTtcbiAgICBjb25zdCB7IGVudGl0eTogcHJldkVudGl0eSB9ID0gZXZlbnQuZ2V0UHJldkNvbnRlbnQoKTtcbiAgICBjb25zdCB7IGVudGl0eSwgcmVjb21tZW5kYXRpb24sIHJlYXNvbiB9ID0gZXZlbnQuZ2V0Q29udGVudCgpO1xuXG4gICAgLy8gUnVsZSByZW1vdmVkXG4gICAgaWYgKCFlbnRpdHkpIHtcbiAgICAgICAgaWYgKFVTRVJfUlVMRV9UWVBFUy5pbmNsdWRlcyhldmVudC5nZXRUeXBlKCkpKSB7XG4gICAgICAgICAgICByZXR1cm4gKCkgPT4gX3QoXCIlKHNlbmRlck5hbWUpcyByZW1vdmVkIHRoZSBydWxlIGJhbm5pbmcgdXNlcnMgbWF0Y2hpbmcgJShnbG9iKXNcIixcbiAgICAgICAgICAgICAgICB7IHNlbmRlck5hbWUsIGdsb2I6IHByZXZFbnRpdHkgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoUk9PTV9SVUxFX1RZUEVTLmluY2x1ZGVzKGV2ZW50LmdldFR5cGUoKSkpIHtcbiAgICAgICAgICAgIHJldHVybiAoKSA9PiBfdChcIiUoc2VuZGVyTmFtZSlzIHJlbW92ZWQgdGhlIHJ1bGUgYmFubmluZyByb29tcyBtYXRjaGluZyAlKGdsb2Ipc1wiLFxuICAgICAgICAgICAgICAgIHsgc2VuZGVyTmFtZSwgZ2xvYjogcHJldkVudGl0eSB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChTRVJWRVJfUlVMRV9UWVBFUy5pbmNsdWRlcyhldmVudC5nZXRUeXBlKCkpKSB7XG4gICAgICAgICAgICByZXR1cm4gKCkgPT4gX3QoXCIlKHNlbmRlck5hbWUpcyByZW1vdmVkIHRoZSBydWxlIGJhbm5pbmcgc2VydmVycyBtYXRjaGluZyAlKGdsb2Ipc1wiLFxuICAgICAgICAgICAgICAgIHsgc2VuZGVyTmFtZSwgZ2xvYjogcHJldkVudGl0eSB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFVua25vd24gdHlwZS4gV2UnbGwgc2F5IHNvbWV0aGluZywgYnV0IHdlIHNob3VsZG4ndCBlbmQgdXAgaGVyZS5cbiAgICAgICAgcmV0dXJuICgpID0+IF90KFwiJShzZW5kZXJOYW1lKXMgcmVtb3ZlZCBhIGJhbiBydWxlIG1hdGNoaW5nICUoZ2xvYilzXCIsIHsgc2VuZGVyTmFtZSwgZ2xvYjogcHJldkVudGl0eSB9KTtcbiAgICB9XG5cbiAgICAvLyBJbnZhbGlkIHJ1bGVcbiAgICBpZiAoIXJlY29tbWVuZGF0aW9uIHx8ICFyZWFzb24pIHJldHVybiAoKSA9PiBfdChgJShzZW5kZXJOYW1lKXMgdXBkYXRlZCBhbiBpbnZhbGlkIGJhbiBydWxlYCwgeyBzZW5kZXJOYW1lIH0pO1xuXG4gICAgLy8gUnVsZSB1cGRhdGVkXG4gICAgaWYgKGVudGl0eSA9PT0gcHJldkVudGl0eSkge1xuICAgICAgICBpZiAoVVNFUl9SVUxFX1RZUEVTLmluY2x1ZGVzKGV2ZW50LmdldFR5cGUoKSkpIHtcbiAgICAgICAgICAgIHJldHVybiAoKSA9PiBfdChcIiUoc2VuZGVyTmFtZSlzIHVwZGF0ZWQgdGhlIHJ1bGUgYmFubmluZyB1c2VycyBtYXRjaGluZyAlKGdsb2IpcyBmb3IgJShyZWFzb24pc1wiLFxuICAgICAgICAgICAgICAgIHsgc2VuZGVyTmFtZSwgZ2xvYjogZW50aXR5LCByZWFzb24gfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoUk9PTV9SVUxFX1RZUEVTLmluY2x1ZGVzKGV2ZW50LmdldFR5cGUoKSkpIHtcbiAgICAgICAgICAgIHJldHVybiAoKSA9PiBfdChcIiUoc2VuZGVyTmFtZSlzIHVwZGF0ZWQgdGhlIHJ1bGUgYmFubmluZyByb29tcyBtYXRjaGluZyAlKGdsb2IpcyBmb3IgJShyZWFzb24pc1wiLFxuICAgICAgICAgICAgICAgIHsgc2VuZGVyTmFtZSwgZ2xvYjogZW50aXR5LCByZWFzb24gfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoU0VSVkVSX1JVTEVfVFlQRVMuaW5jbHVkZXMoZXZlbnQuZ2V0VHlwZSgpKSkge1xuICAgICAgICAgICAgcmV0dXJuICgpID0+IF90KFwiJShzZW5kZXJOYW1lKXMgdXBkYXRlZCB0aGUgcnVsZSBiYW5uaW5nIHNlcnZlcnMgbWF0Y2hpbmcgJShnbG9iKXMgZm9yICUocmVhc29uKXNcIixcbiAgICAgICAgICAgICAgICB7IHNlbmRlck5hbWUsIGdsb2I6IGVudGl0eSwgcmVhc29uIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVW5rbm93biB0eXBlLiBXZSdsbCBzYXkgc29tZXRoaW5nIGJ1dCB3ZSBzaG91bGRuJ3QgZW5kIHVwIGhlcmUuXG4gICAgICAgIHJldHVybiAoKSA9PiBfdChcIiUoc2VuZGVyTmFtZSlzIHVwZGF0ZWQgYSBiYW4gcnVsZSBtYXRjaGluZyAlKGdsb2IpcyBmb3IgJShyZWFzb24pc1wiLFxuICAgICAgICAgICAgeyBzZW5kZXJOYW1lLCBnbG9iOiBlbnRpdHksIHJlYXNvbiB9KTtcbiAgICB9XG5cbiAgICAvLyBOZXcgcnVsZVxuICAgIGlmICghcHJldkVudGl0eSkge1xuICAgICAgICBpZiAoVVNFUl9SVUxFX1RZUEVTLmluY2x1ZGVzKGV2ZW50LmdldFR5cGUoKSkpIHtcbiAgICAgICAgICAgIHJldHVybiAoKSA9PiBfdChcIiUoc2VuZGVyTmFtZSlzIGNyZWF0ZWQgYSBydWxlIGJhbm5pbmcgdXNlcnMgbWF0Y2hpbmcgJShnbG9iKXMgZm9yICUocmVhc29uKXNcIixcbiAgICAgICAgICAgICAgICB7IHNlbmRlck5hbWUsIGdsb2I6IGVudGl0eSwgcmVhc29uIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKFJPT01fUlVMRV9UWVBFUy5pbmNsdWRlcyhldmVudC5nZXRUeXBlKCkpKSB7XG4gICAgICAgICAgICByZXR1cm4gKCkgPT4gX3QoXCIlKHNlbmRlck5hbWUpcyBjcmVhdGVkIGEgcnVsZSBiYW5uaW5nIHJvb21zIG1hdGNoaW5nICUoZ2xvYilzIGZvciAlKHJlYXNvbilzXCIsXG4gICAgICAgICAgICAgICAgeyBzZW5kZXJOYW1lLCBnbG9iOiBlbnRpdHksIHJlYXNvbiB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChTRVJWRVJfUlVMRV9UWVBFUy5pbmNsdWRlcyhldmVudC5nZXRUeXBlKCkpKSB7XG4gICAgICAgICAgICByZXR1cm4gKCkgPT4gX3QoXCIlKHNlbmRlck5hbWUpcyBjcmVhdGVkIGEgcnVsZSBiYW5uaW5nIHNlcnZlcnMgbWF0Y2hpbmcgJShnbG9iKXMgZm9yICUocmVhc29uKXNcIixcbiAgICAgICAgICAgICAgICB7IHNlbmRlck5hbWUsIGdsb2I6IGVudGl0eSwgcmVhc29uIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVW5rbm93biB0eXBlLiBXZSdsbCBzYXkgc29tZXRoaW5nIGJ1dCB3ZSBzaG91bGRuJ3QgZW5kIHVwIGhlcmUuXG4gICAgICAgIHJldHVybiAoKSA9PiBfdChcIiUoc2VuZGVyTmFtZSlzIGNyZWF0ZWQgYSBiYW4gcnVsZSBtYXRjaGluZyAlKGdsb2IpcyBmb3IgJShyZWFzb24pc1wiLFxuICAgICAgICAgICAgeyBzZW5kZXJOYW1lLCBnbG9iOiBlbnRpdHksIHJlYXNvbiB9KTtcbiAgICB9XG5cbiAgICAvLyBlbHNlIHRoZSBlbnRpdHkgIT09IHByZXZFbnRpdHkgLSBjb3VudCBhcyBhIHJlbW92YWwgJiBhZGRcbiAgICBpZiAoVVNFUl9SVUxFX1RZUEVTLmluY2x1ZGVzKGV2ZW50LmdldFR5cGUoKSkpIHtcbiAgICAgICAgcmV0dXJuICgpID0+IF90KFxuICAgICAgICAgICAgXCIlKHNlbmRlck5hbWUpcyBjaGFuZ2VkIGEgcnVsZSB0aGF0IHdhcyBiYW5uaW5nIHVzZXJzIG1hdGNoaW5nICUob2xkR2xvYilzIHRvIG1hdGNoaW5nIFwiICtcbiAgICAgICAgICAgIFwiJShuZXdHbG9iKXMgZm9yICUocmVhc29uKXNcIixcbiAgICAgICAgICAgIHsgc2VuZGVyTmFtZSwgb2xkR2xvYjogcHJldkVudGl0eSwgbmV3R2xvYjogZW50aXR5LCByZWFzb24gfSxcbiAgICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKFJPT01fUlVMRV9UWVBFUy5pbmNsdWRlcyhldmVudC5nZXRUeXBlKCkpKSB7XG4gICAgICAgIHJldHVybiAoKSA9PiBfdChcbiAgICAgICAgICAgIFwiJShzZW5kZXJOYW1lKXMgY2hhbmdlZCBhIHJ1bGUgdGhhdCB3YXMgYmFubmluZyByb29tcyBtYXRjaGluZyAlKG9sZEdsb2IpcyB0byBtYXRjaGluZyBcIiArXG4gICAgICAgICAgICBcIiUobmV3R2xvYilzIGZvciAlKHJlYXNvbilzXCIsXG4gICAgICAgICAgICB7IHNlbmRlck5hbWUsIG9sZEdsb2I6IHByZXZFbnRpdHksIG5ld0dsb2I6IGVudGl0eSwgcmVhc29uIH0sXG4gICAgICAgICk7XG4gICAgfSBlbHNlIGlmIChTRVJWRVJfUlVMRV9UWVBFUy5pbmNsdWRlcyhldmVudC5nZXRUeXBlKCkpKSB7XG4gICAgICAgIHJldHVybiAoKSA9PiBfdChcbiAgICAgICAgICAgIFwiJShzZW5kZXJOYW1lKXMgY2hhbmdlZCBhIHJ1bGUgdGhhdCB3YXMgYmFubmluZyBzZXJ2ZXJzIG1hdGNoaW5nICUob2xkR2xvYilzIHRvIG1hdGNoaW5nIFwiICtcbiAgICAgICAgICAgIFwiJShuZXdHbG9iKXMgZm9yICUocmVhc29uKXNcIixcbiAgICAgICAgICAgIHsgc2VuZGVyTmFtZSwgb2xkR2xvYjogcHJldkVudGl0eSwgbmV3R2xvYjogZW50aXR5LCByZWFzb24gfSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBVbmtub3duIHR5cGUuIFdlJ2xsIHNheSBzb21ldGhpbmcgYnV0IHdlIHNob3VsZG4ndCBlbmQgdXAgaGVyZS5cbiAgICByZXR1cm4gKCkgPT4gX3QoXCIlKHNlbmRlck5hbWUpcyB1cGRhdGVkIGEgYmFuIHJ1bGUgdGhhdCB3YXMgbWF0Y2hpbmcgJShvbGRHbG9iKXMgdG8gbWF0Y2hpbmcgJShuZXdHbG9iKXMgXCIgK1xuICAgICAgICBcImZvciAlKHJlYXNvbilzXCIsIHsgc2VuZGVyTmFtZSwgb2xkR2xvYjogcHJldkVudGl0eSwgbmV3R2xvYjogZW50aXR5LCByZWFzb24gfSk7XG59XG5cbmludGVyZmFjZSBJSGFuZGxlcnMge1xuICAgIFt0eXBlOiBzdHJpbmddOlxuICAgICAgICAoZXY6IE1hdHJpeEV2ZW50LCBhbGxvd0pTWDogYm9vbGVhbiwgc2hvd0hpZGRlbkV2ZW50cz86IGJvb2xlYW4pID0+XG4gICAgICAgICAgICAoKCkgPT4gc3RyaW5nIHwgSlNYLkVsZW1lbnQgfCBudWxsKTtcbn1cblxuY29uc3QgaGFuZGxlcnM6IElIYW5kbGVycyA9IHtcbiAgICBbRXZlbnRUeXBlLlJvb21NZXNzYWdlXTogdGV4dEZvck1lc3NhZ2VFdmVudCxcbiAgICBbRXZlbnRUeXBlLlN0aWNrZXJdOiB0ZXh0Rm9yTWVzc2FnZUV2ZW50LFxuICAgIFtFdmVudFR5cGUuQ2FsbEludml0ZV06IHRleHRGb3JDYWxsSW52aXRlRXZlbnQsXG59O1xuXG5jb25zdCBzdGF0ZUhhbmRsZXJzOiBJSGFuZGxlcnMgPSB7XG4gICAgW0V2ZW50VHlwZS5Sb29tQ2Fub25pY2FsQWxpYXNdOiB0ZXh0Rm9yQ2Fub25pY2FsQWxpYXNFdmVudCxcbiAgICBbRXZlbnRUeXBlLlJvb21OYW1lXTogdGV4dEZvclJvb21OYW1lRXZlbnQsXG4gICAgW0V2ZW50VHlwZS5Sb29tVG9waWNdOiB0ZXh0Rm9yVG9waWNFdmVudCxcbiAgICBbRXZlbnRUeXBlLlJvb21NZW1iZXJdOiB0ZXh0Rm9yTWVtYmVyRXZlbnQsXG4gICAgW0V2ZW50VHlwZS5Sb29tQXZhdGFyXTogdGV4dEZvclJvb21BdmF0YXJFdmVudCxcbiAgICBbRXZlbnRUeXBlLlJvb21UaGlyZFBhcnR5SW52aXRlXTogdGV4dEZvclRocmVlUGlkSW52aXRlRXZlbnQsXG4gICAgW0V2ZW50VHlwZS5Sb29tSGlzdG9yeVZpc2liaWxpdHldOiB0ZXh0Rm9ySGlzdG9yeVZpc2liaWxpdHlFdmVudCxcbiAgICBbRXZlbnRUeXBlLlJvb21Qb3dlckxldmVsc106IHRleHRGb3JQb3dlckV2ZW50LFxuICAgIFtFdmVudFR5cGUuUm9vbVBpbm5lZEV2ZW50c106IHRleHRGb3JQaW5uZWRFdmVudCxcbiAgICBbRXZlbnRUeXBlLlJvb21TZXJ2ZXJBY2xdOiB0ZXh0Rm9yU2VydmVyQUNMRXZlbnQsXG4gICAgW0V2ZW50VHlwZS5Sb29tVG9tYnN0b25lXTogdGV4dEZvclRvbWJzdG9uZUV2ZW50LFxuICAgIFtFdmVudFR5cGUuUm9vbUpvaW5SdWxlc106IHRleHRGb3JKb2luUnVsZXNFdmVudCxcbiAgICBbRXZlbnRUeXBlLlJvb21HdWVzdEFjY2Vzc106IHRleHRGb3JHdWVzdEFjY2Vzc0V2ZW50LFxuICAgICdtLnJvb20ucmVsYXRlZF9ncm91cHMnOiB0ZXh0Rm9yUmVsYXRlZEdyb3Vwc0V2ZW50LFxuXG4gICAgLy8gVE9ETzogRW5hYmxlIHN1cHBvcnQgZm9yIG0ud2lkZ2V0IGV2ZW50IHR5cGUgKGh0dHBzOi8vZ2l0aHViLmNvbS92ZWN0b3ItaW0vZWxlbWVudC13ZWIvaXNzdWVzLzEzMTExKVxuICAgICdpbS52ZWN0b3IubW9kdWxhci53aWRnZXRzJzogdGV4dEZvcldpZGdldEV2ZW50LFxuICAgIFtXSURHRVRfTEFZT1VUX0VWRU5UX1RZUEVdOiB0ZXh0Rm9yV2lkZ2V0TGF5b3V0RXZlbnQsXG59O1xuXG4vLyBBZGQgYWxsIHRoZSBNam9sbmlyIHN0dWZmIHRvIHRoZSByZW5kZXJlclxuZm9yIChjb25zdCBldlR5cGUgb2YgQUxMX1JVTEVfVFlQRVMpIHtcbiAgICBzdGF0ZUhhbmRsZXJzW2V2VHlwZV0gPSB0ZXh0Rm9yTWpvbG5pckV2ZW50O1xufVxuXG4vKipcbiAqIERldGVybWluZXMgd2hldGhlciB0aGUgZ2l2ZW4gZXZlbnQgaGFzIHRleHQgdG8gZGlzcGxheS5cbiAqIEBwYXJhbSBldiBUaGUgZXZlbnRcbiAqIEBwYXJhbSBzaG93SGlkZGVuRXZlbnRzIEFuIG9wdGlvbmFsIGNhY2hlZCBzZXR0aW5nIHZhbHVlIGZvciBzaG93SGlkZGVuRXZlbnRzSW5UaW1lbGluZVxuICogICAgIHRvIGF2b2lkIGhpdHRpbmcgdGhlIHNldHRpbmdzIHN0b3JlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBoYXNUZXh0KGV2OiBNYXRyaXhFdmVudCwgc2hvd0hpZGRlbkV2ZW50cz86IGJvb2xlYW4pOiBib29sZWFuIHtcbiAgICBjb25zdCBoYW5kbGVyID0gKGV2LmlzU3RhdGUoKSA/IHN0YXRlSGFuZGxlcnMgOiBoYW5kbGVycylbZXYuZ2V0VHlwZSgpXTtcbiAgICByZXR1cm4gQm9vbGVhbihoYW5kbGVyPy4oZXYsIGZhbHNlLCBzaG93SGlkZGVuRXZlbnRzKSk7XG59XG5cbi8qKlxuICogR2V0cyB0aGUgdGV4dHVhbCBjb250ZW50IG9mIHRoZSBnaXZlbiBldmVudC5cbiAqIEBwYXJhbSBldiBUaGUgZXZlbnRcbiAqIEBwYXJhbSBhbGxvd0pTWCBXaGV0aGVyIHRvIG91dHB1dCByaWNoIEpTWCBjb250ZW50XG4gKiBAcGFyYW0gc2hvd0hpZGRlbkV2ZW50cyBBbiBvcHRpb25hbCBjYWNoZWQgc2V0dGluZyB2YWx1ZSBmb3Igc2hvd0hpZGRlbkV2ZW50c0luVGltZWxpbmVcbiAqICAgICB0byBhdm9pZCBoaXR0aW5nIHRoZSBzZXR0aW5ncyBzdG9yZVxuICovXG5leHBvcnQgZnVuY3Rpb24gdGV4dEZvckV2ZW50KGV2OiBNYXRyaXhFdmVudCk6IHN0cmluZztcbmV4cG9ydCBmdW5jdGlvbiB0ZXh0Rm9yRXZlbnQoZXY6IE1hdHJpeEV2ZW50LCBhbGxvd0pTWDogdHJ1ZSwgc2hvd0hpZGRlbkV2ZW50cz86IGJvb2xlYW4pOiBzdHJpbmcgfCBKU1guRWxlbWVudDtcbmV4cG9ydCBmdW5jdGlvbiB0ZXh0Rm9yRXZlbnQoZXY6IE1hdHJpeEV2ZW50LCBhbGxvd0pTWCA9IGZhbHNlLCBzaG93SGlkZGVuRXZlbnRzPzogYm9vbGVhbik6IHN0cmluZyB8IEpTWC5FbGVtZW50IHtcbiAgICBjb25zdCBoYW5kbGVyID0gKGV2LmlzU3RhdGUoKSA/IHN0YXRlSGFuZGxlcnMgOiBoYW5kbGVycylbZXYuZ2V0VHlwZSgpXTtcbiAgICByZXR1cm4gaGFuZGxlcj8uKGV2LCBhbGxvd0pTWCwgc2hvd0hpZGRlbkV2ZW50cyk/LigpIHx8ICcnO1xufVxuIl19