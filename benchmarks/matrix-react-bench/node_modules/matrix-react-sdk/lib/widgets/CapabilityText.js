"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.CapabilityText = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _matrixWidgetApi = require("matrix-widget-api");

var _languageHandler = require("../languageHandler");

var _event = require("matrix-js-sdk/src/@types/event");

var _ElementWidgetCapabilities = require("../stores/widgets/ElementWidgetCapabilities");

var _react = _interopRequireDefault(require("react"));

var _MatrixClientPeg = require("../MatrixClientPeg");

var _TextWithTooltip = _interopRequireDefault(require("../components/views/elements/TextWithTooltip"));

/*
Copyright 2020 - 2021 The Matrix.org Foundation C.I.C.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
// eslint-disable-line @typescript-eslint/naming-convention
const GENERIC_WIDGET_KIND = "generic";

class CapabilityText {
  static bylineFor(eventCap) {
    if (eventCap.isState) {
      return !eventCap.keyStr ? (0, _languageHandler._t)("with an empty state key") : (0, _languageHandler._t)("with state key %(stateKey)s", {
        stateKey: eventCap.keyStr
      });
    }

    return null; // room messages are handled specially
  }

  static for(capability, kind) {
    // First see if we have a super simple line of text to provide back
    if (CapabilityText.simpleCaps[capability]) {
      const textForKind = CapabilityText.simpleCaps[capability];
      if (textForKind[kind]) return {
        primary: (0, _languageHandler._t)(textForKind[kind])
      };
      if (textForKind[GENERIC_WIDGET_KIND]) return {
        primary: (0, _languageHandler._t)(textForKind[GENERIC_WIDGET_KIND])
      }; // ... we'll fall through to the generic capability processing at the end of this
      // function if we fail to generate a string for the capability.
    } // Try to handle timeline capabilities. The text here implies that the caller has sorted
    // the timeline caps to the end for UI purposes.


    if ((0, _matrixWidgetApi.isTimelineCapability)(capability)) {
      if ((0, _matrixWidgetApi.isTimelineCapabilityFor)(capability, _matrixWidgetApi.Symbols.AnyRoom)) {
        return {
          primary: (0, _languageHandler._t)("The above, but in any room you are joined or invited to as well")
        };
      } else {
        const roomId = (0, _matrixWidgetApi.getTimelineRoomIDFromCapability)(capability);

        const room = _MatrixClientPeg.MatrixClientPeg.get().getRoom(roomId);

        return {
          primary: (0, _languageHandler._t)("The above, but in <Room /> as well", {}, {
            Room: () => {
              if (room) {
                return /*#__PURE__*/_react.default.createElement(_TextWithTooltip.default, {
                  tooltip: room.getCanonicalAlias() ?? roomId
                }, /*#__PURE__*/_react.default.createElement("b", null, room.name));
              } else {
                return /*#__PURE__*/_react.default.createElement("b", null, /*#__PURE__*/_react.default.createElement("code", null, roomId));
              }
            }
          })
        };
      }
    } // We didn't have a super simple line of text, so try processing the capability as the
    // more complex event send/receive permission type.


    const [eventCap] = _matrixWidgetApi.WidgetEventCapability.findEventCapabilities([capability]);

    if (eventCap) {
      // Special case room messages so they show up a bit cleaner to the user. Result is
      // effectively "Send images" instead of "Send messages... of type images" if we were
      // to handle the msgtype nuances in this function.
      if (!eventCap.isState && eventCap.eventType === _event.EventType.RoomMessage) {
        return CapabilityText.forRoomMessageCap(eventCap, kind);
      } // See if we have a static line of text to provide for the given event type and
      // direction. The hope is that we do for common event types for friendlier copy.


      const evSendRecv = eventCap.isState ? CapabilityText.stateSendRecvCaps : CapabilityText.nonStateSendRecvCaps;

      if (evSendRecv[eventCap.eventType]) {
        const textForKind = evSendRecv[eventCap.eventType];
        const textForDirection = textForKind[kind] || textForKind[GENERIC_WIDGET_KIND];

        if (textForDirection && textForDirection[eventCap.direction]) {
          return {
            primary: (0, _languageHandler._t)(textForDirection[eventCap.direction]) // no byline because we would have already represented the event properly

          };
        }
      } // We don't have anything simple, so just return a generic string for the event cap


      if (kind === _matrixWidgetApi.WidgetKind.Room) {
        if (eventCap.direction === _matrixWidgetApi.EventDirection.Send) {
          return {
            primary: (0, _languageHandler._t)("Send <b>%(eventType)s</b> events as you in this room", {
              eventType: eventCap.eventType
            }, {
              b: sub => /*#__PURE__*/_react.default.createElement("b", null, sub)
            }),
            byline: CapabilityText.bylineFor(eventCap)
          };
        } else {
          return {
            primary: (0, _languageHandler._t)("See <b>%(eventType)s</b> events posted to this room", {
              eventType: eventCap.eventType
            }, {
              b: sub => /*#__PURE__*/_react.default.createElement("b", null, sub)
            }),
            byline: CapabilityText.bylineFor(eventCap)
          };
        }
      } else {
        // assume generic
        if (eventCap.direction === _matrixWidgetApi.EventDirection.Send) {
          return {
            primary: (0, _languageHandler._t)("Send <b>%(eventType)s</b> events as you in your active room", {
              eventType: eventCap.eventType
            }, {
              b: sub => /*#__PURE__*/_react.default.createElement("b", null, sub)
            }),
            byline: CapabilityText.bylineFor(eventCap)
          };
        } else {
          return {
            primary: (0, _languageHandler._t)("See <b>%(eventType)s</b> events posted to your active room", {
              eventType: eventCap.eventType
            }, {
              b: sub => /*#__PURE__*/_react.default.createElement("b", null, sub)
            }),
            byline: CapabilityText.bylineFor(eventCap)
          };
        }
      }
    } // We don't have enough context to render this capability specially, so we'll present it as-is


    return {
      primary: (0, _languageHandler._t)("The <b>%(capability)s</b> capability", {
        capability
      }, {
        b: sub => /*#__PURE__*/_react.default.createElement("b", null, sub)
      })
    };
  }

  static forRoomMessageCap(eventCap, kind) {
    // First handle the case of "all messages" to make the switch later on a bit clearer
    if (!eventCap.keyStr) {
      if (eventCap.direction === _matrixWidgetApi.EventDirection.Send) {
        return {
          primary: kind === _matrixWidgetApi.WidgetKind.Room ? (0, _languageHandler._t)("Send messages as you in this room") : (0, _languageHandler._t)("Send messages as you in your active room")
        };
      } else {
        return {
          primary: kind === _matrixWidgetApi.WidgetKind.Room ? (0, _languageHandler._t)("See messages posted to this room") : (0, _languageHandler._t)("See messages posted to your active room")
        };
      }
    } // Now handle all the message types we care about. There are more message types available, however
    // they are not as common so we don't bother rendering them. They'll fall into the generic case.


    switch (eventCap.keyStr) {
      case _event.MsgType.Text:
        {
          if (eventCap.direction === _matrixWidgetApi.EventDirection.Send) {
            return {
              primary: kind === _matrixWidgetApi.WidgetKind.Room ? (0, _languageHandler._t)("Send text messages as you in this room") : (0, _languageHandler._t)("Send text messages as you in your active room")
            };
          } else {
            return {
              primary: kind === _matrixWidgetApi.WidgetKind.Room ? (0, _languageHandler._t)("See text messages posted to this room") : (0, _languageHandler._t)("See text messages posted to your active room")
            };
          }
        }

      case _event.MsgType.Emote:
        {
          if (eventCap.direction === _matrixWidgetApi.EventDirection.Send) {
            return {
              primary: kind === _matrixWidgetApi.WidgetKind.Room ? (0, _languageHandler._t)("Send emotes as you in this room") : (0, _languageHandler._t)("Send emotes as you in your active room")
            };
          } else {
            return {
              primary: kind === _matrixWidgetApi.WidgetKind.Room ? (0, _languageHandler._t)("See emotes posted to this room") : (0, _languageHandler._t)("See emotes posted to your active room")
            };
          }
        }

      case _event.MsgType.Image:
        {
          if (eventCap.direction === _matrixWidgetApi.EventDirection.Send) {
            return {
              primary: kind === _matrixWidgetApi.WidgetKind.Room ? (0, _languageHandler._t)("Send images as you in this room") : (0, _languageHandler._t)("Send images as you in your active room")
            };
          } else {
            return {
              primary: kind === _matrixWidgetApi.WidgetKind.Room ? (0, _languageHandler._t)("See images posted to this room") : (0, _languageHandler._t)("See images posted to your active room")
            };
          }
        }

      case _event.MsgType.Video:
        {
          if (eventCap.direction === _matrixWidgetApi.EventDirection.Send) {
            return {
              primary: kind === _matrixWidgetApi.WidgetKind.Room ? (0, _languageHandler._t)("Send videos as you in this room") : (0, _languageHandler._t)("Send videos as you in your active room")
            };
          } else {
            return {
              primary: kind === _matrixWidgetApi.WidgetKind.Room ? (0, _languageHandler._t)("See videos posted to this room") : (0, _languageHandler._t)("See videos posted to your active room")
            };
          }
        }

      case _event.MsgType.File:
        {
          if (eventCap.direction === _matrixWidgetApi.EventDirection.Send) {
            return {
              primary: kind === _matrixWidgetApi.WidgetKind.Room ? (0, _languageHandler._t)("Send general files as you in this room") : (0, _languageHandler._t)("Send general files as you in your active room")
            };
          } else {
            return {
              primary: kind === _matrixWidgetApi.WidgetKind.Room ? (0, _languageHandler._t)("See general files posted to this room") : (0, _languageHandler._t)("See general files posted to your active room")
            };
          }
        }

      default:
        {
          let primary;

          if (eventCap.direction === _matrixWidgetApi.EventDirection.Send) {
            if (kind === _matrixWidgetApi.WidgetKind.Room) {
              primary = (0, _languageHandler._t)("Send <b>%(msgtype)s</b> messages as you in this room", {
                msgtype: eventCap.keyStr
              }, {
                b: sub => /*#__PURE__*/_react.default.createElement("b", null, sub)
              });
            } else {
              primary = (0, _languageHandler._t)("Send <b>%(msgtype)s</b> messages as you in your active room", {
                msgtype: eventCap.keyStr
              }, {
                b: sub => /*#__PURE__*/_react.default.createElement("b", null, sub)
              });
            }
          } else {
            if (kind === _matrixWidgetApi.WidgetKind.Room) {
              primary = (0, _languageHandler._t)("See <b>%(msgtype)s</b> messages posted to this room", {
                msgtype: eventCap.keyStr
              }, {
                b: sub => /*#__PURE__*/_react.default.createElement("b", null, sub)
              });
            } else {
              primary = (0, _languageHandler._t)("See <b>%(msgtype)s</b> messages posted to your active room", {
                msgtype: eventCap.keyStr
              }, {
                b: sub => /*#__PURE__*/_react.default.createElement("b", null, sub)
              });
            }
          }

          return {
            primary
          };
        }
    }
  }

}

exports.CapabilityText = CapabilityText;
(0, _defineProperty2.default)(CapabilityText, "simpleCaps", {
  [_matrixWidgetApi.MatrixCapabilities.AlwaysOnScreen]: {
    [_matrixWidgetApi.WidgetKind.Room]: (0, _languageHandler._td)("Remain on your screen when viewing another room, when running"),
    [GENERIC_WIDGET_KIND]: (0, _languageHandler._td)("Remain on your screen while running")
  },
  [_matrixWidgetApi.MatrixCapabilities.StickerSending]: {
    [_matrixWidgetApi.WidgetKind.Room]: (0, _languageHandler._td)("Send stickers into this room"),
    [GENERIC_WIDGET_KIND]: (0, _languageHandler._td)("Send stickers into your active room")
  },
  [_ElementWidgetCapabilities.ElementWidgetCapabilities.CanChangeViewedRoom]: {
    [GENERIC_WIDGET_KIND]: (0, _languageHandler._td)("Change which room you're viewing")
  },
  [_matrixWidgetApi.MatrixCapabilities.MSC2931Navigate]: {
    [GENERIC_WIDGET_KIND]: (0, _languageHandler._td)("Change which room, message, or user you're viewing")
  }
});
(0, _defineProperty2.default)(CapabilityText, "stateSendRecvCaps", {
  [_event.EventType.RoomTopic]: {
    [_matrixWidgetApi.WidgetKind.Room]: {
      [_matrixWidgetApi.EventDirection.Send]: (0, _languageHandler._td)("Change the topic of this room"),
      [_matrixWidgetApi.EventDirection.Receive]: (0, _languageHandler._td)("See when the topic changes in this room")
    },
    [GENERIC_WIDGET_KIND]: {
      [_matrixWidgetApi.EventDirection.Send]: (0, _languageHandler._td)("Change the topic of your active room"),
      [_matrixWidgetApi.EventDirection.Receive]: (0, _languageHandler._td)("See when the topic changes in your active room")
    }
  },
  [_event.EventType.RoomName]: {
    [_matrixWidgetApi.WidgetKind.Room]: {
      [_matrixWidgetApi.EventDirection.Send]: (0, _languageHandler._td)("Change the name of this room"),
      [_matrixWidgetApi.EventDirection.Receive]: (0, _languageHandler._td)("See when the name changes in this room")
    },
    [GENERIC_WIDGET_KIND]: {
      [_matrixWidgetApi.EventDirection.Send]: (0, _languageHandler._td)("Change the name of your active room"),
      [_matrixWidgetApi.EventDirection.Receive]: (0, _languageHandler._td)("See when the name changes in your active room")
    }
  },
  [_event.EventType.RoomAvatar]: {
    [_matrixWidgetApi.WidgetKind.Room]: {
      [_matrixWidgetApi.EventDirection.Send]: (0, _languageHandler._td)("Change the avatar of this room"),
      [_matrixWidgetApi.EventDirection.Receive]: (0, _languageHandler._td)("See when the avatar changes in this room")
    },
    [GENERIC_WIDGET_KIND]: {
      [_matrixWidgetApi.EventDirection.Send]: (0, _languageHandler._td)("Change the avatar of your active room"),
      [_matrixWidgetApi.EventDirection.Receive]: (0, _languageHandler._td)("See when the avatar changes in your active room")
    }
  },
  [_event.EventType.RoomMember]: {
    [_matrixWidgetApi.WidgetKind.Room]: {
      [_matrixWidgetApi.EventDirection.Send]: (0, _languageHandler._td)("Kick, ban, or invite people to this room, and make you leave"),
      [_matrixWidgetApi.EventDirection.Receive]: (0, _languageHandler._td)("See when people join, leave, or are invited to this room")
    },
    [GENERIC_WIDGET_KIND]: {
      [_matrixWidgetApi.EventDirection.Send]: (0, _languageHandler._td)("Kick, ban, or invite people to your active room, and make you leave"),
      [_matrixWidgetApi.EventDirection.Receive]: (0, _languageHandler._td)("See when people join, leave, or are invited to your active room")
    }
  }
});
(0, _defineProperty2.default)(CapabilityText, "nonStateSendRecvCaps", {
  [_event.EventType.Sticker]: {
    [_matrixWidgetApi.WidgetKind.Room]: {
      [_matrixWidgetApi.EventDirection.Send]: (0, _languageHandler._td)("Send stickers to this room as you"),
      [_matrixWidgetApi.EventDirection.Receive]: (0, _languageHandler._td)("See when a sticker is posted in this room")
    },
    [GENERIC_WIDGET_KIND]: {
      [_matrixWidgetApi.EventDirection.Send]: (0, _languageHandler._td)("Send stickers to your active room as you"),
      [_matrixWidgetApi.EventDirection.Receive]: (0, _languageHandler._td)("See when anyone posts a sticker to your active room")
    }
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy93aWRnZXRzL0NhcGFiaWxpdHlUZXh0LnRzeCJdLCJuYW1lcyI6WyJHRU5FUklDX1dJREdFVF9LSU5EIiwiQ2FwYWJpbGl0eVRleHQiLCJieWxpbmVGb3IiLCJldmVudENhcCIsImlzU3RhdGUiLCJrZXlTdHIiLCJzdGF0ZUtleSIsImZvciIsImNhcGFiaWxpdHkiLCJraW5kIiwic2ltcGxlQ2FwcyIsInRleHRGb3JLaW5kIiwicHJpbWFyeSIsIlN5bWJvbHMiLCJBbnlSb29tIiwicm9vbUlkIiwicm9vbSIsIk1hdHJpeENsaWVudFBlZyIsImdldCIsImdldFJvb20iLCJSb29tIiwiZ2V0Q2Fub25pY2FsQWxpYXMiLCJuYW1lIiwiV2lkZ2V0RXZlbnRDYXBhYmlsaXR5IiwiZmluZEV2ZW50Q2FwYWJpbGl0aWVzIiwiZXZlbnRUeXBlIiwiRXZlbnRUeXBlIiwiUm9vbU1lc3NhZ2UiLCJmb3JSb29tTWVzc2FnZUNhcCIsImV2U2VuZFJlY3YiLCJzdGF0ZVNlbmRSZWN2Q2FwcyIsIm5vblN0YXRlU2VuZFJlY3ZDYXBzIiwidGV4dEZvckRpcmVjdGlvbiIsImRpcmVjdGlvbiIsIldpZGdldEtpbmQiLCJFdmVudERpcmVjdGlvbiIsIlNlbmQiLCJiIiwic3ViIiwiYnlsaW5lIiwiTXNnVHlwZSIsIlRleHQiLCJFbW90ZSIsIkltYWdlIiwiVmlkZW8iLCJGaWxlIiwibXNndHlwZSIsIk1hdHJpeENhcGFiaWxpdGllcyIsIkFsd2F5c09uU2NyZWVuIiwiU3RpY2tlclNlbmRpbmciLCJFbGVtZW50V2lkZ2V0Q2FwYWJpbGl0aWVzIiwiQ2FuQ2hhbmdlVmlld2VkUm9vbSIsIk1TQzI5MzFOYXZpZ2F0ZSIsIlJvb21Ub3BpYyIsIlJlY2VpdmUiLCJSb29tTmFtZSIsIlJvb21BdmF0YXIiLCJSb29tTWVtYmVyIiwiU3RpY2tlciJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFnQkE7O0FBVUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FB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QUFGUDtBQUxIO0FBL0IrQixDOzhCQWxCbERyRCxjLDBCQTZEcUQ7QUFDMUQsR0FBQ3lCLGlCQUFVZ0MsT0FBWCxHQUFxQjtBQUNqQixLQUFDeEIsNEJBQVdkLElBQVosR0FBbUI7QUFDZixPQUFDZSxnQ0FBZUMsSUFBaEIsR0FBdUIsMEJBQUksbUNBQUosQ0FEUjtBQUVmLE9BQUNELGdDQUFlbUIsT0FBaEIsR0FBMEIsMEJBQUksMkNBQUo7QUFGWCxLQURGO0FBS2pCLEtBQUN0RCxtQkFBRCxHQUF1QjtBQUNuQixPQUFDbUMsZ0NBQWVDLElBQWhCLEdBQXVCLDBCQUFJLDBDQUFKLENBREo7QUFFbkIsT0FBQ0QsZ0NBQWVtQixPQUFoQixHQUEwQiwwQkFBSSxxREFBSjtBQUZQO0FBTE47QUFEcUMsQyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG5Db3B5cmlnaHQgMjAyMCAtIDIwMjEgVGhlIE1hdHJpeC5vcmcgRm91bmRhdGlvbiBDLkkuQy5cblxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbnlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbllvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuXG4gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cblVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbmRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxubGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4qL1xuXG5pbXBvcnQge1xuICAgIENhcGFiaWxpdHksXG4gICAgRXZlbnREaXJlY3Rpb24sXG4gICAgZ2V0VGltZWxpbmVSb29tSURGcm9tQ2FwYWJpbGl0eSxcbiAgICBpc1RpbWVsaW5lQ2FwYWJpbGl0eSxcbiAgICBpc1RpbWVsaW5lQ2FwYWJpbGl0eUZvcixcbiAgICBNYXRyaXhDYXBhYmlsaXRpZXMsIFN5bWJvbHMsXG4gICAgV2lkZ2V0RXZlbnRDYXBhYmlsaXR5LFxuICAgIFdpZGdldEtpbmQsXG59IGZyb20gXCJtYXRyaXgtd2lkZ2V0LWFwaVwiO1xuaW1wb3J0IHsgX3QsIF90ZCwgVHJhbnNsYXRlZFN0cmluZyB9IGZyb20gXCIuLi9sYW5ndWFnZUhhbmRsZXJcIjtcbmltcG9ydCB7IEV2ZW50VHlwZSwgTXNnVHlwZSB9IGZyb20gXCJtYXRyaXgtanMtc2RrL3NyYy9AdHlwZXMvZXZlbnRcIjtcbmltcG9ydCB7IEVsZW1lbnRXaWRnZXRDYXBhYmlsaXRpZXMgfSBmcm9tIFwiLi4vc3RvcmVzL3dpZGdldHMvRWxlbWVudFdpZGdldENhcGFiaWxpdGllc1wiO1xuaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgTWF0cml4Q2xpZW50UGVnIH0gZnJvbSBcIi4uL01hdHJpeENsaWVudFBlZ1wiO1xuaW1wb3J0IFRleHRXaXRoVG9vbHRpcCBmcm9tIFwiLi4vY29tcG9uZW50cy92aWV3cy9lbGVtZW50cy9UZXh0V2l0aFRvb2x0aXBcIjtcblxudHlwZSBHRU5FUklDX1dJREdFVF9LSU5EID0gXCJnZW5lcmljXCI7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25hbWluZy1jb252ZW50aW9uXG5jb25zdCBHRU5FUklDX1dJREdFVF9LSU5EOiBHRU5FUklDX1dJREdFVF9LSU5EID0gXCJnZW5lcmljXCI7XG5cbmludGVyZmFjZSBJU2VuZFJlY3ZTdGF0aWNDYXBUZXh0IHtcbiAgICAvLyBAdHMtaWdub3JlIC0gVFMgd2FudHMgdGhlIGtleSB0byBiZSBhIHN0cmluZywgYnV0IHdlIGtub3cgYmV0dGVyXG4gICAgW2V2ZW50VHlwZTogRXZlbnRUeXBlXToge1xuICAgICAgICAvLyBAdHMtaWdub3JlIC0gVFMgd2FudHMgdGhlIGtleSB0byBiZSBhIHN0cmluZywgYnV0IHdlIGtub3cgYmV0dGVyXG4gICAgICAgIFt3aWRnZXRLaW5kOiBXaWRnZXRLaW5kIHwgR0VORVJJQ19XSURHRVRfS0lORF06IHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgLSBUUyB3YW50cyB0aGUga2V5IHRvIGJlIGEgc3RyaW5nLCBidXQgd2Uga25vdyBiZXR0ZXJcbiAgICAgICAgICAgIFtkaXJlY3Rpb246IEV2ZW50RGlyZWN0aW9uXTogc3RyaW5nO1xuICAgICAgICB9O1xuICAgIH07XG59XG5cbmludGVyZmFjZSBJU3RhdGljQ2FwVGV4dCB7XG4gICAgLy8gQHRzLWlnbm9yZSAtIFRTIHdhbnRzIHRoZSBrZXkgdG8gYmUgYSBzdHJpbmcsIGJ1dCB3ZSBrbm93IGJldHRlclxuICAgIFtjYXBhYmlsaXR5OiBDYXBhYmlsaXR5XToge1xuICAgICAgICAvLyBAdHMtaWdub3JlIC0gVFMgd2FudHMgdGhlIGtleSB0byBiZSBhIHN0cmluZywgYnV0IHdlIGtub3cgYmV0dGVyXG4gICAgICAgIFt3aWRnZXRLaW5kOiBXaWRnZXRLaW5kIHwgR0VORVJJQ19XSURHRVRfS0lORF06IHN0cmluZztcbiAgICB9O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRyYW5zbGF0ZWRDYXBhYmlsaXR5VGV4dCB7XG4gICAgcHJpbWFyeTogVHJhbnNsYXRlZFN0cmluZztcbiAgICBieWxpbmU/OiBUcmFuc2xhdGVkU3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgQ2FwYWJpbGl0eVRleHQge1xuICAgIHByaXZhdGUgc3RhdGljIHNpbXBsZUNhcHM6IElTdGF0aWNDYXBUZXh0ID0ge1xuICAgICAgICBbTWF0cml4Q2FwYWJpbGl0aWVzLkFsd2F5c09uU2NyZWVuXToge1xuICAgICAgICAgICAgW1dpZGdldEtpbmQuUm9vbV06IF90ZChcIlJlbWFpbiBvbiB5b3VyIHNjcmVlbiB3aGVuIHZpZXdpbmcgYW5vdGhlciByb29tLCB3aGVuIHJ1bm5pbmdcIiksXG4gICAgICAgICAgICBbR0VORVJJQ19XSURHRVRfS0lORF06IF90ZChcIlJlbWFpbiBvbiB5b3VyIHNjcmVlbiB3aGlsZSBydW5uaW5nXCIpLFxuICAgICAgICB9LFxuICAgICAgICBbTWF0cml4Q2FwYWJpbGl0aWVzLlN0aWNrZXJTZW5kaW5nXToge1xuICAgICAgICAgICAgW1dpZGdldEtpbmQuUm9vbV06IF90ZChcIlNlbmQgc3RpY2tlcnMgaW50byB0aGlzIHJvb21cIiksXG4gICAgICAgICAgICBbR0VORVJJQ19XSURHRVRfS0lORF06IF90ZChcIlNlbmQgc3RpY2tlcnMgaW50byB5b3VyIGFjdGl2ZSByb29tXCIpLFxuICAgICAgICB9LFxuICAgICAgICBbRWxlbWVudFdpZGdldENhcGFiaWxpdGllcy5DYW5DaGFuZ2VWaWV3ZWRSb29tXToge1xuICAgICAgICAgICAgW0dFTkVSSUNfV0lER0VUX0tJTkRdOiBfdGQoXCJDaGFuZ2Ugd2hpY2ggcm9vbSB5b3UncmUgdmlld2luZ1wiKSxcbiAgICAgICAgfSxcbiAgICAgICAgW01hdHJpeENhcGFiaWxpdGllcy5NU0MyOTMxTmF2aWdhdGVdOiB7XG4gICAgICAgICAgICBbR0VORVJJQ19XSURHRVRfS0lORF06IF90ZChcIkNoYW5nZSB3aGljaCByb29tLCBtZXNzYWdlLCBvciB1c2VyIHlvdSdyZSB2aWV3aW5nXCIpLFxuICAgICAgICB9LFxuICAgIH07XG5cbiAgICBwcml2YXRlIHN0YXRpYyBzdGF0ZVNlbmRSZWN2Q2FwczogSVNlbmRSZWN2U3RhdGljQ2FwVGV4dCA9IHtcbiAgICAgICAgW0V2ZW50VHlwZS5Sb29tVG9waWNdOiB7XG4gICAgICAgICAgICBbV2lkZ2V0S2luZC5Sb29tXToge1xuICAgICAgICAgICAgICAgIFtFdmVudERpcmVjdGlvbi5TZW5kXTogX3RkKFwiQ2hhbmdlIHRoZSB0b3BpYyBvZiB0aGlzIHJvb21cIiksXG4gICAgICAgICAgICAgICAgW0V2ZW50RGlyZWN0aW9uLlJlY2VpdmVdOiBfdGQoXCJTZWUgd2hlbiB0aGUgdG9waWMgY2hhbmdlcyBpbiB0aGlzIHJvb21cIiksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgW0dFTkVSSUNfV0lER0VUX0tJTkRdOiB7XG4gICAgICAgICAgICAgICAgW0V2ZW50RGlyZWN0aW9uLlNlbmRdOiBfdGQoXCJDaGFuZ2UgdGhlIHRvcGljIG9mIHlvdXIgYWN0aXZlIHJvb21cIiksXG4gICAgICAgICAgICAgICAgW0V2ZW50RGlyZWN0aW9uLlJlY2VpdmVdOiBfdGQoXCJTZWUgd2hlbiB0aGUgdG9waWMgY2hhbmdlcyBpbiB5b3VyIGFjdGl2ZSByb29tXCIpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgW0V2ZW50VHlwZS5Sb29tTmFtZV06IHtcbiAgICAgICAgICAgIFtXaWRnZXRLaW5kLlJvb21dOiB7XG4gICAgICAgICAgICAgICAgW0V2ZW50RGlyZWN0aW9uLlNlbmRdOiBfdGQoXCJDaGFuZ2UgdGhlIG5hbWUgb2YgdGhpcyByb29tXCIpLFxuICAgICAgICAgICAgICAgIFtFdmVudERpcmVjdGlvbi5SZWNlaXZlXTogX3RkKFwiU2VlIHdoZW4gdGhlIG5hbWUgY2hhbmdlcyBpbiB0aGlzIHJvb21cIiksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgW0dFTkVSSUNfV0lER0VUX0tJTkRdOiB7XG4gICAgICAgICAgICAgICAgW0V2ZW50RGlyZWN0aW9uLlNlbmRdOiBfdGQoXCJDaGFuZ2UgdGhlIG5hbWUgb2YgeW91ciBhY3RpdmUgcm9vbVwiKSxcbiAgICAgICAgICAgICAgICBbRXZlbnREaXJlY3Rpb24uUmVjZWl2ZV06IF90ZChcIlNlZSB3aGVuIHRoZSBuYW1lIGNoYW5nZXMgaW4geW91ciBhY3RpdmUgcm9vbVwiKSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIFtFdmVudFR5cGUuUm9vbUF2YXRhcl06IHtcbiAgICAgICAgICAgIFtXaWRnZXRLaW5kLlJvb21dOiB7XG4gICAgICAgICAgICAgICAgW0V2ZW50RGlyZWN0aW9uLlNlbmRdOiBfdGQoXCJDaGFuZ2UgdGhlIGF2YXRhciBvZiB0aGlzIHJvb21cIiksXG4gICAgICAgICAgICAgICAgW0V2ZW50RGlyZWN0aW9uLlJlY2VpdmVdOiBfdGQoXCJTZWUgd2hlbiB0aGUgYXZhdGFyIGNoYW5nZXMgaW4gdGhpcyByb29tXCIpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFtHRU5FUklDX1dJREdFVF9LSU5EXToge1xuICAgICAgICAgICAgICAgIFtFdmVudERpcmVjdGlvbi5TZW5kXTogX3RkKFwiQ2hhbmdlIHRoZSBhdmF0YXIgb2YgeW91ciBhY3RpdmUgcm9vbVwiKSxcbiAgICAgICAgICAgICAgICBbRXZlbnREaXJlY3Rpb24uUmVjZWl2ZV06IF90ZChcIlNlZSB3aGVuIHRoZSBhdmF0YXIgY2hhbmdlcyBpbiB5b3VyIGFjdGl2ZSByb29tXCIpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgW0V2ZW50VHlwZS5Sb29tTWVtYmVyXToge1xuICAgICAgICAgICAgW1dpZGdldEtpbmQuUm9vbV06IHtcbiAgICAgICAgICAgICAgICBbRXZlbnREaXJlY3Rpb24uU2VuZF06IF90ZChcIktpY2ssIGJhbiwgb3IgaW52aXRlIHBlb3BsZSB0byB0aGlzIHJvb20sIGFuZCBtYWtlIHlvdSBsZWF2ZVwiKSxcbiAgICAgICAgICAgICAgICBbRXZlbnREaXJlY3Rpb24uUmVjZWl2ZV06IF90ZChcIlNlZSB3aGVuIHBlb3BsZSBqb2luLCBsZWF2ZSwgb3IgYXJlIGludml0ZWQgdG8gdGhpcyByb29tXCIpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFtHRU5FUklDX1dJREdFVF9LSU5EXToge1xuICAgICAgICAgICAgICAgIFtFdmVudERpcmVjdGlvbi5TZW5kXTogX3RkKFwiS2ljaywgYmFuLCBvciBpbnZpdGUgcGVvcGxlIHRvIHlvdXIgYWN0aXZlIHJvb20sIGFuZCBtYWtlIHlvdSBsZWF2ZVwiKSxcbiAgICAgICAgICAgICAgICBbRXZlbnREaXJlY3Rpb24uUmVjZWl2ZV06IF90ZChcIlNlZSB3aGVuIHBlb3BsZSBqb2luLCBsZWF2ZSwgb3IgYXJlIGludml0ZWQgdG8geW91ciBhY3RpdmUgcm9vbVwiKSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgfTtcblxuICAgIHByaXZhdGUgc3RhdGljIG5vblN0YXRlU2VuZFJlY3ZDYXBzOiBJU2VuZFJlY3ZTdGF0aWNDYXBUZXh0ID0ge1xuICAgICAgICBbRXZlbnRUeXBlLlN0aWNrZXJdOiB7XG4gICAgICAgICAgICBbV2lkZ2V0S2luZC5Sb29tXToge1xuICAgICAgICAgICAgICAgIFtFdmVudERpcmVjdGlvbi5TZW5kXTogX3RkKFwiU2VuZCBzdGlja2VycyB0byB0aGlzIHJvb20gYXMgeW91XCIpLFxuICAgICAgICAgICAgICAgIFtFdmVudERpcmVjdGlvbi5SZWNlaXZlXTogX3RkKFwiU2VlIHdoZW4gYSBzdGlja2VyIGlzIHBvc3RlZCBpbiB0aGlzIHJvb21cIiksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgW0dFTkVSSUNfV0lER0VUX0tJTkRdOiB7XG4gICAgICAgICAgICAgICAgW0V2ZW50RGlyZWN0aW9uLlNlbmRdOiBfdGQoXCJTZW5kIHN0aWNrZXJzIHRvIHlvdXIgYWN0aXZlIHJvb20gYXMgeW91XCIpLFxuICAgICAgICAgICAgICAgIFtFdmVudERpcmVjdGlvbi5SZWNlaXZlXTogX3RkKFwiU2VlIHdoZW4gYW55b25lIHBvc3RzIGEgc3RpY2tlciB0byB5b3VyIGFjdGl2ZSByb29tXCIpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBzdGF0aWMgYnlsaW5lRm9yKGV2ZW50Q2FwOiBXaWRnZXRFdmVudENhcGFiaWxpdHkpOiBUcmFuc2xhdGVkU3RyaW5nIHtcbiAgICAgICAgaWYgKGV2ZW50Q2FwLmlzU3RhdGUpIHtcbiAgICAgICAgICAgIHJldHVybiAhZXZlbnRDYXAua2V5U3RyXG4gICAgICAgICAgICAgICAgPyBfdChcIndpdGggYW4gZW1wdHkgc3RhdGUga2V5XCIpXG4gICAgICAgICAgICAgICAgOiBfdChcIndpdGggc3RhdGUga2V5ICUoc3RhdGVLZXkpc1wiLCB7IHN0YXRlS2V5OiBldmVudENhcC5rZXlTdHIgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7IC8vIHJvb20gbWVzc2FnZXMgYXJlIGhhbmRsZWQgc3BlY2lhbGx5XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBmb3IoY2FwYWJpbGl0eTogQ2FwYWJpbGl0eSwga2luZDogV2lkZ2V0S2luZCk6IFRyYW5zbGF0ZWRDYXBhYmlsaXR5VGV4dCB7XG4gICAgICAgIC8vIEZpcnN0IHNlZSBpZiB3ZSBoYXZlIGEgc3VwZXIgc2ltcGxlIGxpbmUgb2YgdGV4dCB0byBwcm92aWRlIGJhY2tcbiAgICAgICAgaWYgKENhcGFiaWxpdHlUZXh0LnNpbXBsZUNhcHNbY2FwYWJpbGl0eV0pIHtcbiAgICAgICAgICAgIGNvbnN0IHRleHRGb3JLaW5kID0gQ2FwYWJpbGl0eVRleHQuc2ltcGxlQ2Fwc1tjYXBhYmlsaXR5XTtcbiAgICAgICAgICAgIGlmICh0ZXh0Rm9yS2luZFtraW5kXSkgcmV0dXJuIHsgcHJpbWFyeTogX3QodGV4dEZvcktpbmRba2luZF0pIH07XG4gICAgICAgICAgICBpZiAodGV4dEZvcktpbmRbR0VORVJJQ19XSURHRVRfS0lORF0pIHJldHVybiB7IHByaW1hcnk6IF90KHRleHRGb3JLaW5kW0dFTkVSSUNfV0lER0VUX0tJTkRdKSB9O1xuXG4gICAgICAgICAgICAvLyAuLi4gd2UnbGwgZmFsbCB0aHJvdWdoIHRvIHRoZSBnZW5lcmljIGNhcGFiaWxpdHkgcHJvY2Vzc2luZyBhdCB0aGUgZW5kIG9mIHRoaXNcbiAgICAgICAgICAgIC8vIGZ1bmN0aW9uIGlmIHdlIGZhaWwgdG8gZ2VuZXJhdGUgYSBzdHJpbmcgZm9yIHRoZSBjYXBhYmlsaXR5LlxuICAgICAgICB9XG5cbiAgICAgICAgLy8gVHJ5IHRvIGhhbmRsZSB0aW1lbGluZSBjYXBhYmlsaXRpZXMuIFRoZSB0ZXh0IGhlcmUgaW1wbGllcyB0aGF0IHRoZSBjYWxsZXIgaGFzIHNvcnRlZFxuICAgICAgICAvLyB0aGUgdGltZWxpbmUgY2FwcyB0byB0aGUgZW5kIGZvciBVSSBwdXJwb3Nlcy5cbiAgICAgICAgaWYgKGlzVGltZWxpbmVDYXBhYmlsaXR5KGNhcGFiaWxpdHkpKSB7XG4gICAgICAgICAgICBpZiAoaXNUaW1lbGluZUNhcGFiaWxpdHlGb3IoY2FwYWJpbGl0eSwgU3ltYm9scy5BbnlSb29tKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHByaW1hcnk6IF90KFwiVGhlIGFib3ZlLCBidXQgaW4gYW55IHJvb20geW91IGFyZSBqb2luZWQgb3IgaW52aXRlZCB0byBhcyB3ZWxsXCIpIH07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJvb21JZCA9IGdldFRpbWVsaW5lUm9vbUlERnJvbUNhcGFiaWxpdHkoY2FwYWJpbGl0eSk7XG4gICAgICAgICAgICAgICAgY29uc3Qgcm9vbSA9IE1hdHJpeENsaWVudFBlZy5nZXQoKS5nZXRSb29tKHJvb21JZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgcHJpbWFyeTogX3QoXCJUaGUgYWJvdmUsIGJ1dCBpbiA8Um9vbSAvPiBhcyB3ZWxsXCIsIHt9LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBSb29tOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJvb20pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDxUZXh0V2l0aFRvb2x0aXAgdG9vbHRpcD17cm9vbS5nZXRDYW5vbmljYWxBbGlhcygpID8/IHJvb21JZH0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Yj57IHJvb20ubmFtZSB9PC9iPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1RleHRXaXRoVG9vbHRpcD47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDxiPjxjb2RlPnsgcm9vbUlkIH08L2NvZGU+PC9iPjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gV2UgZGlkbid0IGhhdmUgYSBzdXBlciBzaW1wbGUgbGluZSBvZiB0ZXh0LCBzbyB0cnkgcHJvY2Vzc2luZyB0aGUgY2FwYWJpbGl0eSBhcyB0aGVcbiAgICAgICAgLy8gbW9yZSBjb21wbGV4IGV2ZW50IHNlbmQvcmVjZWl2ZSBwZXJtaXNzaW9uIHR5cGUuXG4gICAgICAgIGNvbnN0IFtldmVudENhcF0gPSBXaWRnZXRFdmVudENhcGFiaWxpdHkuZmluZEV2ZW50Q2FwYWJpbGl0aWVzKFtjYXBhYmlsaXR5XSk7XG4gICAgICAgIGlmIChldmVudENhcCkge1xuICAgICAgICAgICAgLy8gU3BlY2lhbCBjYXNlIHJvb20gbWVzc2FnZXMgc28gdGhleSBzaG93IHVwIGEgYml0IGNsZWFuZXIgdG8gdGhlIHVzZXIuIFJlc3VsdCBpc1xuICAgICAgICAgICAgLy8gZWZmZWN0aXZlbHkgXCJTZW5kIGltYWdlc1wiIGluc3RlYWQgb2YgXCJTZW5kIG1lc3NhZ2VzLi4uIG9mIHR5cGUgaW1hZ2VzXCIgaWYgd2Ugd2VyZVxuICAgICAgICAgICAgLy8gdG8gaGFuZGxlIHRoZSBtc2d0eXBlIG51YW5jZXMgaW4gdGhpcyBmdW5jdGlvbi5cbiAgICAgICAgICAgIGlmICghZXZlbnRDYXAuaXNTdGF0ZSAmJiBldmVudENhcC5ldmVudFR5cGUgPT09IEV2ZW50VHlwZS5Sb29tTWVzc2FnZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBDYXBhYmlsaXR5VGV4dC5mb3JSb29tTWVzc2FnZUNhcChldmVudENhcCwga2luZCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFNlZSBpZiB3ZSBoYXZlIGEgc3RhdGljIGxpbmUgb2YgdGV4dCB0byBwcm92aWRlIGZvciB0aGUgZ2l2ZW4gZXZlbnQgdHlwZSBhbmRcbiAgICAgICAgICAgIC8vIGRpcmVjdGlvbi4gVGhlIGhvcGUgaXMgdGhhdCB3ZSBkbyBmb3IgY29tbW9uIGV2ZW50IHR5cGVzIGZvciBmcmllbmRsaWVyIGNvcHkuXG4gICAgICAgICAgICBjb25zdCBldlNlbmRSZWN2ID0gZXZlbnRDYXAuaXNTdGF0ZVxuICAgICAgICAgICAgICAgID8gQ2FwYWJpbGl0eVRleHQuc3RhdGVTZW5kUmVjdkNhcHNcbiAgICAgICAgICAgICAgICA6IENhcGFiaWxpdHlUZXh0Lm5vblN0YXRlU2VuZFJlY3ZDYXBzO1xuICAgICAgICAgICAgaWYgKGV2U2VuZFJlY3ZbZXZlbnRDYXAuZXZlbnRUeXBlXSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRleHRGb3JLaW5kID0gZXZTZW5kUmVjdltldmVudENhcC5ldmVudFR5cGVdO1xuICAgICAgICAgICAgICAgIGNvbnN0IHRleHRGb3JEaXJlY3Rpb24gPSB0ZXh0Rm9yS2luZFtraW5kXSB8fCB0ZXh0Rm9yS2luZFtHRU5FUklDX1dJREdFVF9LSU5EXTtcbiAgICAgICAgICAgICAgICBpZiAodGV4dEZvckRpcmVjdGlvbiAmJiB0ZXh0Rm9yRGlyZWN0aW9uW2V2ZW50Q2FwLmRpcmVjdGlvbl0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaW1hcnk6IF90KHRleHRGb3JEaXJlY3Rpb25bZXZlbnRDYXAuZGlyZWN0aW9uXSksXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBubyBieWxpbmUgYmVjYXVzZSB3ZSB3b3VsZCBoYXZlIGFscmVhZHkgcmVwcmVzZW50ZWQgdGhlIGV2ZW50IHByb3Blcmx5XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBXZSBkb24ndCBoYXZlIGFueXRoaW5nIHNpbXBsZSwgc28ganVzdCByZXR1cm4gYSBnZW5lcmljIHN0cmluZyBmb3IgdGhlIGV2ZW50IGNhcFxuICAgICAgICAgICAgaWYgKGtpbmQgPT09IFdpZGdldEtpbmQuUm9vbSkge1xuICAgICAgICAgICAgICAgIGlmIChldmVudENhcC5kaXJlY3Rpb24gPT09IEV2ZW50RGlyZWN0aW9uLlNlbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaW1hcnk6IF90KFwiU2VuZCA8Yj4lKGV2ZW50VHlwZSlzPC9iPiBldmVudHMgYXMgeW91IGluIHRoaXMgcm9vbVwiLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRUeXBlOiBldmVudENhcC5ldmVudFR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYjogc3ViID0+IDxiPnsgc3ViIH08L2I+LFxuICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICBieWxpbmU6IENhcGFiaWxpdHlUZXh0LmJ5bGluZUZvcihldmVudENhcCksXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaW1hcnk6IF90KFwiU2VlIDxiPiUoZXZlbnRUeXBlKXM8L2I+IGV2ZW50cyBwb3N0ZWQgdG8gdGhpcyByb29tXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudFR5cGU6IGV2ZW50Q2FwLmV2ZW50VHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOiBzdWIgPT4gPGI+eyBzdWIgfTwvYj4sXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ5bGluZTogQ2FwYWJpbGl0eVRleHQuYnlsaW5lRm9yKGV2ZW50Q2FwKSxcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgeyAvLyBhc3N1bWUgZ2VuZXJpY1xuICAgICAgICAgICAgICAgIGlmIChldmVudENhcC5kaXJlY3Rpb24gPT09IEV2ZW50RGlyZWN0aW9uLlNlbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaW1hcnk6IF90KFwiU2VuZCA8Yj4lKGV2ZW50VHlwZSlzPC9iPiBldmVudHMgYXMgeW91IGluIHlvdXIgYWN0aXZlIHJvb21cIiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50VHlwZTogZXZlbnRDYXAuZXZlbnRUeXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI6IHN1YiA9PiA8Yj57IHN1YiB9PC9iPixcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgYnlsaW5lOiBDYXBhYmlsaXR5VGV4dC5ieWxpbmVGb3IoZXZlbnRDYXApLFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmltYXJ5OiBfdChcIlNlZSA8Yj4lKGV2ZW50VHlwZSlzPC9iPiBldmVudHMgcG9zdGVkIHRvIHlvdXIgYWN0aXZlIHJvb21cIiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50VHlwZTogZXZlbnRDYXAuZXZlbnRUeXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI6IHN1YiA9PiA8Yj57IHN1YiB9PC9iPixcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgYnlsaW5lOiBDYXBhYmlsaXR5VGV4dC5ieWxpbmVGb3IoZXZlbnRDYXApLFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFdlIGRvbid0IGhhdmUgZW5vdWdoIGNvbnRleHQgdG8gcmVuZGVyIHRoaXMgY2FwYWJpbGl0eSBzcGVjaWFsbHksIHNvIHdlJ2xsIHByZXNlbnQgaXQgYXMtaXNcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHByaW1hcnk6IF90KFwiVGhlIDxiPiUoY2FwYWJpbGl0eSlzPC9iPiBjYXBhYmlsaXR5XCIsIHsgY2FwYWJpbGl0eSB9LCB7XG4gICAgICAgICAgICAgICAgYjogc3ViID0+IDxiPnsgc3ViIH08L2I+LFxuICAgICAgICAgICAgfSksXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGF0aWMgZm9yUm9vbU1lc3NhZ2VDYXAoZXZlbnRDYXA6IFdpZGdldEV2ZW50Q2FwYWJpbGl0eSwga2luZDogV2lkZ2V0S2luZCk6IFRyYW5zbGF0ZWRDYXBhYmlsaXR5VGV4dCB7XG4gICAgICAgIC8vIEZpcnN0IGhhbmRsZSB0aGUgY2FzZSBvZiBcImFsbCBtZXNzYWdlc1wiIHRvIG1ha2UgdGhlIHN3aXRjaCBsYXRlciBvbiBhIGJpdCBjbGVhcmVyXG4gICAgICAgIGlmICghZXZlbnRDYXAua2V5U3RyKSB7XG4gICAgICAgICAgICBpZiAoZXZlbnRDYXAuZGlyZWN0aW9uID09PSBFdmVudERpcmVjdGlvbi5TZW5kKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgcHJpbWFyeToga2luZCA9PT0gV2lkZ2V0S2luZC5Sb29tXG4gICAgICAgICAgICAgICAgICAgICAgICA/IF90KFwiU2VuZCBtZXNzYWdlcyBhcyB5b3UgaW4gdGhpcyByb29tXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICA6IF90KFwiU2VuZCBtZXNzYWdlcyBhcyB5b3UgaW4geW91ciBhY3RpdmUgcm9vbVwiKSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBwcmltYXJ5OiBraW5kID09PSBXaWRnZXRLaW5kLlJvb21cbiAgICAgICAgICAgICAgICAgICAgICAgID8gX3QoXCJTZWUgbWVzc2FnZXMgcG9zdGVkIHRvIHRoaXMgcm9vbVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgOiBfdChcIlNlZSBtZXNzYWdlcyBwb3N0ZWQgdG8geW91ciBhY3RpdmUgcm9vbVwiKSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gTm93IGhhbmRsZSBhbGwgdGhlIG1lc3NhZ2UgdHlwZXMgd2UgY2FyZSBhYm91dC4gVGhlcmUgYXJlIG1vcmUgbWVzc2FnZSB0eXBlcyBhdmFpbGFibGUsIGhvd2V2ZXJcbiAgICAgICAgLy8gdGhleSBhcmUgbm90IGFzIGNvbW1vbiBzbyB3ZSBkb24ndCBib3RoZXIgcmVuZGVyaW5nIHRoZW0uIFRoZXknbGwgZmFsbCBpbnRvIHRoZSBnZW5lcmljIGNhc2UuXG4gICAgICAgIHN3aXRjaCAoZXZlbnRDYXAua2V5U3RyKSB7XG4gICAgICAgICAgICBjYXNlIE1zZ1R5cGUuVGV4dDoge1xuICAgICAgICAgICAgICAgIGlmIChldmVudENhcC5kaXJlY3Rpb24gPT09IEV2ZW50RGlyZWN0aW9uLlNlbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaW1hcnk6IGtpbmQgPT09IFdpZGdldEtpbmQuUm9vbVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gX3QoXCJTZW5kIHRleHQgbWVzc2FnZXMgYXMgeW91IGluIHRoaXMgcm9vbVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogX3QoXCJTZW5kIHRleHQgbWVzc2FnZXMgYXMgeW91IGluIHlvdXIgYWN0aXZlIHJvb21cIiksXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaW1hcnk6IGtpbmQgPT09IFdpZGdldEtpbmQuUm9vbVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gX3QoXCJTZWUgdGV4dCBtZXNzYWdlcyBwb3N0ZWQgdG8gdGhpcyByb29tXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBfdChcIlNlZSB0ZXh0IG1lc3NhZ2VzIHBvc3RlZCB0byB5b3VyIGFjdGl2ZSByb29tXCIpLFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgTXNnVHlwZS5FbW90ZToge1xuICAgICAgICAgICAgICAgIGlmIChldmVudENhcC5kaXJlY3Rpb24gPT09IEV2ZW50RGlyZWN0aW9uLlNlbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaW1hcnk6IGtpbmQgPT09IFdpZGdldEtpbmQuUm9vbVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gX3QoXCJTZW5kIGVtb3RlcyBhcyB5b3UgaW4gdGhpcyByb29tXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBfdChcIlNlbmQgZW1vdGVzIGFzIHlvdSBpbiB5b3VyIGFjdGl2ZSByb29tXCIpLFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmltYXJ5OiBraW5kID09PSBXaWRnZXRLaW5kLlJvb21cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IF90KFwiU2VlIGVtb3RlcyBwb3N0ZWQgdG8gdGhpcyByb29tXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBfdChcIlNlZSBlbW90ZXMgcG9zdGVkIHRvIHlvdXIgYWN0aXZlIHJvb21cIiksXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBNc2dUeXBlLkltYWdlOiB7XG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50Q2FwLmRpcmVjdGlvbiA9PT0gRXZlbnREaXJlY3Rpb24uU2VuZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJpbWFyeToga2luZCA9PT0gV2lkZ2V0S2luZC5Sb29tXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBfdChcIlNlbmQgaW1hZ2VzIGFzIHlvdSBpbiB0aGlzIHJvb21cIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IF90KFwiU2VuZCBpbWFnZXMgYXMgeW91IGluIHlvdXIgYWN0aXZlIHJvb21cIiksXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaW1hcnk6IGtpbmQgPT09IFdpZGdldEtpbmQuUm9vbVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gX3QoXCJTZWUgaW1hZ2VzIHBvc3RlZCB0byB0aGlzIHJvb21cIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IF90KFwiU2VlIGltYWdlcyBwb3N0ZWQgdG8geW91ciBhY3RpdmUgcm9vbVwiKSxcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIE1zZ1R5cGUuVmlkZW86IHtcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnRDYXAuZGlyZWN0aW9uID09PSBFdmVudERpcmVjdGlvbi5TZW5kKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmltYXJ5OiBraW5kID09PSBXaWRnZXRLaW5kLlJvb21cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IF90KFwiU2VuZCB2aWRlb3MgYXMgeW91IGluIHRoaXMgcm9vbVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogX3QoXCJTZW5kIHZpZGVvcyBhcyB5b3UgaW4geW91ciBhY3RpdmUgcm9vbVwiKSxcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJpbWFyeToga2luZCA9PT0gV2lkZ2V0S2luZC5Sb29tXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBfdChcIlNlZSB2aWRlb3MgcG9zdGVkIHRvIHRoaXMgcm9vbVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogX3QoXCJTZWUgdmlkZW9zIHBvc3RlZCB0byB5b3VyIGFjdGl2ZSByb29tXCIpLFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgTXNnVHlwZS5GaWxlOiB7XG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50Q2FwLmRpcmVjdGlvbiA9PT0gRXZlbnREaXJlY3Rpb24uU2VuZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJpbWFyeToga2luZCA9PT0gV2lkZ2V0S2luZC5Sb29tXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBfdChcIlNlbmQgZ2VuZXJhbCBmaWxlcyBhcyB5b3UgaW4gdGhpcyByb29tXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBfdChcIlNlbmQgZ2VuZXJhbCBmaWxlcyBhcyB5b3UgaW4geW91ciBhY3RpdmUgcm9vbVwiKSxcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJpbWFyeToga2luZCA9PT0gV2lkZ2V0S2luZC5Sb29tXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBfdChcIlNlZSBnZW5lcmFsIGZpbGVzIHBvc3RlZCB0byB0aGlzIHJvb21cIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IF90KFwiU2VlIGdlbmVyYWwgZmlsZXMgcG9zdGVkIHRvIHlvdXIgYWN0aXZlIHJvb21cIiksXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVmYXVsdDoge1xuICAgICAgICAgICAgICAgIGxldCBwcmltYXJ5OiBUcmFuc2xhdGVkU3RyaW5nO1xuICAgICAgICAgICAgICAgIGlmIChldmVudENhcC5kaXJlY3Rpb24gPT09IEV2ZW50RGlyZWN0aW9uLlNlbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtpbmQgPT09IFdpZGdldEtpbmQuUm9vbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJpbWFyeSA9IF90KFwiU2VuZCA8Yj4lKG1zZ3R5cGUpczwvYj4gbWVzc2FnZXMgYXMgeW91IGluIHRoaXMgcm9vbVwiLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNndHlwZTogZXZlbnRDYXAua2V5U3RyLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI6IHN1YiA9PiA8Yj57IHN1YiB9PC9iPixcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJpbWFyeSA9IF90KFwiU2VuZCA8Yj4lKG1zZ3R5cGUpczwvYj4gbWVzc2FnZXMgYXMgeW91IGluIHlvdXIgYWN0aXZlIHJvb21cIiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1zZ3R5cGU6IGV2ZW50Q2FwLmtleVN0cixcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOiBzdWIgPT4gPGI+eyBzdWIgfTwvYj4sXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChraW5kID09PSBXaWRnZXRLaW5kLlJvb20pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaW1hcnkgPSBfdChcIlNlZSA8Yj4lKG1zZ3R5cGUpczwvYj4gbWVzc2FnZXMgcG9zdGVkIHRvIHRoaXMgcm9vbVwiLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNndHlwZTogZXZlbnRDYXAua2V5U3RyLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI6IHN1YiA9PiA8Yj57IHN1YiB9PC9iPixcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJpbWFyeSA9IF90KFwiU2VlIDxiPiUobXNndHlwZSlzPC9iPiBtZXNzYWdlcyBwb3N0ZWQgdG8geW91ciBhY3RpdmUgcm9vbVwiLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNndHlwZTogZXZlbnRDYXAua2V5U3RyLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI6IHN1YiA9PiA8Yj57IHN1YiB9PC9iPixcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB7IHByaW1hcnkgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbiJdfQ==