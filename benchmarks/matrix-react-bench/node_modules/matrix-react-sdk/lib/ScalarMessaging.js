"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.setOpenManagerUrl = setOpenManagerUrl;
exports.startListening = startListening;
exports.stopListening = stopListening;

var _MatrixClientPeg = require("./MatrixClientPeg");

var _event = require("matrix-js-sdk/src/models/event");

var _dispatcher = _interopRequireDefault(require("./dispatcher/dispatcher"));

var _WidgetUtils = _interopRequireDefault(require("./utils/WidgetUtils"));

var _RoomViewStore = _interopRequireDefault(require("./stores/RoomViewStore"));

var _languageHandler = require("./languageHandler");

var _IntegrationManagers = require("./integrations/IntegrationManagers");

var _WidgetType = require("./widgets/WidgetType");

var _objects = require("./utils/objects");

var _logger = require("matrix-js-sdk/src/logger");

/*
Copyright 2016 OpenMarket Ltd
Copyright 2017 Vector Creations Ltd
Copyright 2018 New Vector Ltd

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
// TODO: Generify the name of this and all components within - it's not just for scalar.

/*
Listens for incoming postMessage requests from the integrations UI URL. The following API is exposed:
{
    action: "invite" | "membership_state" | "bot_options" | "set_bot_options" | etc... ,
    room_id: $ROOM_ID,
    user_id: $USER_ID
    // additional request fields
}

The complete request object is returned to the caller with an additional "response" key like so:
{
    action: "invite" | "membership_state" | "bot_options" | "set_bot_options",
    room_id: $ROOM_ID,
    user_id: $USER_ID,
    // additional request fields
    response: { ... }
}

The "action" determines the format of the request and response. All actions can return an error response.
An error response is a "response" object which consists of a sole "error" key to indicate an error.
They look like:
{
    error: {
        message: "Unable to invite user into room.",
        _error: <Original Error Object>
    }
}
The "message" key should be a human-friendly string.

ACTIONS
=======
All actions can return an error response instead of the response outlined below.

invite
------
Invites a user into a room.

Request:
 - room_id is the room to invite the user into.
 - user_id is the user ID to invite.
 - No additional fields.
Response:
{
    success: true
}
Example:
{
    action: "invite",
    room_id: "!foo:bar",
    user_id: "@invitee:bar",
    response: {
        success: true
    }
}

set_bot_options
---------------
Set the m.room.bot.options state event for a bot user.

Request:
 - room_id is the room to send the state event into.
 - user_id is the user ID of the bot who you're setting options for.
 - "content" is an object consisting of the content you wish to set.
Response:
{
    success: true
}
Example:
{
    action: "set_bot_options",
    room_id: "!foo:bar",
    user_id: "@bot:bar",
    content: {
        default_option: "alpha"
    },
    response: {
        success: true
    }
}

get_membership_count
--------------------
Get the number of joined users in the room.

Request:
 - room_id is the room to get the count in.
Response:
78
Example:
{
    action: "get_membership_count",
    room_id: "!foo:bar",
    response: 78
}

can_send_event
--------------
Check if the client can send the given event into the given room. If the client
is unable to do this, an error response is returned instead of 'response: false'.

Request:
 - room_id is the room to do the check in.
 - event_type is the event type which will be sent.
 - is_state is true if the event to be sent is a state event.
Response:
true
Example:
{
    action: "can_send_event",
    is_state: false,
    event_type: "m.room.message",
    room_id: "!foo:bar",
    response: true
}

set_widget
----------
Set a new widget in the room. Clobbers based on the ID.

Request:
 - `room_id` (String) is the room to set the widget in.
 - `widget_id` (String) is the ID of the widget to add (or replace if it already exists).
   It can be an arbitrary UTF8 string and is purely for distinguishing between widgets.
 - `url` (String) is the URL that clients should load in an iframe to run the widget.
   All widgets must have a valid URL. If the URL is `null` (not `undefined`), the
   widget will be removed from the room.
 - `type` (String) is the type of widget, which is provided as a hint for matrix clients so they
   can configure/lay out the widget in different ways. All widgets must have a type.
 - `name` (String) is an optional human-readable string about the widget.
 - `data` (Object) is some optional data about the widget, and can contain arbitrary key/value pairs.
Response:
{
    success: true
}
Example:
{
    action: "set_widget",
    room_id: "!foo:bar",
    widget_id: "abc123",
    url: "http://widget.url",
    type: "example",
    response: {
        success: true
    }
}

get_widgets
-----------
Get a list of all widgets in the room. The response is an array
of state events.

Request:
 - `room_id` (String) is the room to get the widgets in.
Response:
[
    {
        // TODO: Enable support for m.widget event type (https://github.com/vector-im/element-web/issues/13111)
        type: "im.vector.modular.widgets",
        state_key: "wid1",
        content: {
            type: "grafana",
            url: "https://grafanaurl",
            name: "dashboard",
            data: {key: "val"}
        }
        room_id: "!foo:bar",
        sender: "@alice:localhost"
    }
]
Example:
{
    action: "get_widgets",
    room_id: "!foo:bar",
    response: [
        {
            // TODO: Enable support for m.widget event type (https://github.com/vector-im/element-web/issues/13111)
            type: "im.vector.modular.widgets",
            state_key: "wid1",
            content: {
                type: "grafana",
                url: "https://grafanaurl",
                name: "dashboard",
                data: {key: "val"}
            }
            room_id: "!foo:bar",
            sender: "@alice:localhost"
        }
    ]
}

membership_state AND bot_options
--------------------------------
Get the content of the "m.room.member" or "m.room.bot.options" state event respectively.

NB: Whilst this API is basically equivalent to getStateEvent, we specifically do not
    want external entities to be able to query any state event for any room, hence the
    restrictive API outlined here.

Request:
 - room_id is the room which has the state event.
 - user_id is the state_key parameter which in both cases is a user ID (the member or the bot).
 - No additional fields.
Response:
 - The event content. If there is no state event, the "response" key should be null.
Example:
{
    action: "membership_state",
    room_id: "!foo:bar",
    user_id: "@somemember:bar",
    response: {
        membership: "join",
        displayname: "Bob",
        avatar_url: null
    }
}
*/
var Action;

(function (Action) {
  Action["CloseScalar"] = "close_scalar";
  Action["GetWidgets"] = "get_widgets";
  Action["SetWidgets"] = "set_widgets";
  Action["SetWidget"] = "set_widget";
  Action["JoinRulesState"] = "join_rules_state";
  Action["SetPlumbingState"] = "set_plumbing_state";
  Action["GetMembershipCount"] = "get_membership_count";
  Action["GetRoomEncryptionState"] = "get_room_enc_state";
  Action["CanSendEvent"] = "can_send_event";
  Action["MembershipState"] = "membership_state";
  Action["invite"] = "invite";
  Action["BotOptions"] = "bot_options";
  Action["SetBotOptions"] = "set_bot_options";
  Action["SetBotPower"] = "set_bot_power";
})(Action || (Action = {}));

function sendResponse(event, res) {
  const data = (0, _objects.objectClone)(event.data);
  data.response = res; // @ts-ignore

  event.source.postMessage(data, event.origin);
}

function sendError(event, msg, nestedError) {
  _logger.logger.error("Action:" + event.data.action + " failed with message: " + msg);

  const data = (0, _objects.objectClone)(event.data);
  data.response = {
    error: {
      message: msg
    }
  };

  if (nestedError) {
    data.response.error._error = nestedError;
  } // @ts-ignore


  event.source.postMessage(data, event.origin);
}

function inviteUser(event, roomId, userId) {
  _logger.logger.log(`Received request to invite ${userId} into room ${roomId}`);

  const client = _MatrixClientPeg.MatrixClientPeg.get();

  if (!client) {
    sendError(event, (0, _languageHandler._t)('You need to be logged in.'));
    return;
  }

  const room = client.getRoom(roomId);

  if (room) {
    // if they are already invited we can resolve immediately.
    const member = room.getMember(userId);

    if (member && member.membership === "invite") {
      sendResponse(event, {
        success: true
      });
      return;
    }
  }

  client.invite(roomId, userId).then(function () {
    sendResponse(event, {
      success: true
    });
  }, function (err) {
    sendError(event, (0, _languageHandler._t)('You need to be able to invite users to do that.'), err);
  });
}

function setWidget(event, roomId) {
  const widgetId = event.data.widget_id;
  let widgetType = event.data.type;
  const widgetUrl = event.data.url;
  const widgetName = event.data.name; // optional

  const widgetData = event.data.data; // optional

  const userWidget = event.data.userWidget; // both adding/removing widgets need these checks

  if (!widgetId || widgetUrl === undefined) {
    sendError(event, (0, _languageHandler._t)("Unable to create widget."), new Error("Missing required widget fields."));
    return;
  }

  if (widgetUrl !== null) {
    // if url is null it is being deleted, don't need to check name/type/etc
    // check types of fields
    if (widgetName !== undefined && typeof widgetName !== 'string') {
      sendError(event, (0, _languageHandler._t)("Unable to create widget."), new Error("Optional field 'name' must be a string."));
      return;
    }

    if (widgetData !== undefined && !(widgetData instanceof Object)) {
      sendError(event, (0, _languageHandler._t)("Unable to create widget."), new Error("Optional field 'data' must be an Object."));
      return;
    }

    if (typeof widgetType !== 'string') {
      sendError(event, (0, _languageHandler._t)("Unable to create widget."), new Error("Field 'type' must be a string."));
      return;
    }

    if (typeof widgetUrl !== 'string') {
      sendError(event, (0, _languageHandler._t)("Unable to create widget."), new Error("Field 'url' must be a string or null."));
      return;
    }
  } // convert the widget type to a known widget type


  widgetType = _WidgetType.WidgetType.fromString(widgetType);

  if (userWidget) {
    _WidgetUtils.default.setUserWidget(widgetId, widgetType, widgetUrl, widgetName, widgetData).then(() => {
      sendResponse(event, {
        success: true
      });

      _dispatcher.default.dispatch({
        action: "user_widget_updated"
      });
    }).catch(e => {
      sendError(event, (0, _languageHandler._t)('Unable to create widget.'), e);
    });
  } else {
    // Room widget
    if (!roomId) {
      sendError(event, (0, _languageHandler._t)('Missing roomId.'), null);
    }

    _WidgetUtils.default.setRoomWidget(roomId, widgetId, widgetType, widgetUrl, widgetName, widgetData).then(() => {
      sendResponse(event, {
        success: true
      });
    }, err => {
      sendError(event, (0, _languageHandler._t)('Failed to send request.'), err);
    });
  }
}

function getWidgets(event, roomId) {
  const client = _MatrixClientPeg.MatrixClientPeg.get();

  if (!client) {
    sendError(event, (0, _languageHandler._t)('You need to be logged in.'));
    return;
  }

  let widgetStateEvents = [];

  if (roomId) {
    const room = client.getRoom(roomId);

    if (!room) {
      sendError(event, (0, _languageHandler._t)('This room is not recognised.'));
      return;
    } // XXX: This gets the raw event object (I think because we can't
    // send the MatrixEvent over postMessage?)


    widgetStateEvents = _WidgetUtils.default.getRoomWidgets(room).map(ev => ev.event);
  } // Add user widgets (not linked to a specific room)


  const userWidgets = _WidgetUtils.default.getUserWidgetsArray();

  widgetStateEvents = widgetStateEvents.concat(userWidgets);
  sendResponse(event, widgetStateEvents);
}

function getRoomEncState(event, roomId) {
  const client = _MatrixClientPeg.MatrixClientPeg.get();

  if (!client) {
    sendError(event, (0, _languageHandler._t)('You need to be logged in.'));
    return;
  }

  const room = client.getRoom(roomId);

  if (!room) {
    sendError(event, (0, _languageHandler._t)('This room is not recognised.'));
    return;
  }

  const roomIsEncrypted = _MatrixClientPeg.MatrixClientPeg.get().isRoomEncrypted(roomId);

  sendResponse(event, roomIsEncrypted);
}

function setPlumbingState(event, roomId, status) {
  if (typeof status !== 'string') {
    throw new Error('Plumbing state status should be a string');
  }

  _logger.logger.log(`Received request to set plumbing state to status "${status}" in room ${roomId}`);

  const client = _MatrixClientPeg.MatrixClientPeg.get();

  if (!client) {
    sendError(event, (0, _languageHandler._t)('You need to be logged in.'));
    return;
  }

  client.sendStateEvent(roomId, "m.room.plumbing", {
    status: status
  }).then(() => {
    sendResponse(event, {
      success: true
    });
  }, err => {
    sendError(event, err.message ? err.message : (0, _languageHandler._t)('Failed to send request.'), err);
  });
}

function setBotOptions(event, roomId, userId) {
  _logger.logger.log(`Received request to set options for bot ${userId} in room ${roomId}`);

  const client = _MatrixClientPeg.MatrixClientPeg.get();

  if (!client) {
    sendError(event, (0, _languageHandler._t)('You need to be logged in.'));
    return;
  }

  client.sendStateEvent(roomId, "m.room.bot.options", event.data.content, "_" + userId).then(() => {
    sendResponse(event, {
      success: true
    });
  }, err => {
    sendError(event, err.message ? err.message : (0, _languageHandler._t)('Failed to send request.'), err);
  });
}

async function setBotPower(event, roomId, userId, level, ignoreIfGreater) {
  if (!(Number.isInteger(level) && level >= 0)) {
    sendError(event, (0, _languageHandler._t)('Power level must be positive integer.'));
    return;
  }

  _logger.logger.log(`Received request to set power level to ${level} for bot ${userId} in room ${roomId}.`);

  const client = _MatrixClientPeg.MatrixClientPeg.get();

  if (!client) {
    sendError(event, (0, _languageHandler._t)('You need to be logged in.'));
    return;
  }

  try {
    const powerLevels = await client.getStateEvent(roomId, "m.room.power_levels", ""); // If the PL is equal to or greater than the requested PL, ignore.

    if (ignoreIfGreater === true) {
      // As per https://matrix.org/docs/spec/client_server/r0.6.0#m-room-power-levels
      const currentPl = powerLevels.content.users && powerLevels.content.users[userId] || powerLevels.content.users_default || 0;

      if (currentPl >= level) {
        return sendResponse(event, {
          success: true
        });
      }
    }

    await client.setPowerLevel(roomId, userId, level, new _event.MatrixEvent({
      type: "m.room.power_levels",
      content: powerLevels
    }));
    return sendResponse(event, {
      success: true
    });
  } catch (err) {
    sendError(event, err.message ? err.message : (0, _languageHandler._t)('Failed to send request.'), err);
  }
}

function getMembershipState(event, roomId, userId) {
  _logger.logger.log(`membership_state of ${userId} in room ${roomId} requested.`);

  returnStateEvent(event, roomId, "m.room.member", userId);
}

function getJoinRules(event, roomId) {
  _logger.logger.log(`join_rules of ${roomId} requested.`);

  returnStateEvent(event, roomId, "m.room.join_rules", "");
}

function botOptions(event, roomId, userId) {
  _logger.logger.log(`bot_options of ${userId} in room ${roomId} requested.`);

  returnStateEvent(event, roomId, "m.room.bot.options", "_" + userId);
}

function getMembershipCount(event, roomId) {
  const client = _MatrixClientPeg.MatrixClientPeg.get();

  if (!client) {
    sendError(event, (0, _languageHandler._t)('You need to be logged in.'));
    return;
  }

  const room = client.getRoom(roomId);

  if (!room) {
    sendError(event, (0, _languageHandler._t)('This room is not recognised.'));
    return;
  }

  const count = room.getJoinedMemberCount();
  sendResponse(event, count);
}

function canSendEvent(event, roomId) {
  const evType = "" + event.data.event_type; // force stringify

  const isState = Boolean(event.data.is_state);

  const client = _MatrixClientPeg.MatrixClientPeg.get();

  if (!client) {
    sendError(event, (0, _languageHandler._t)('You need to be logged in.'));
    return;
  }

  const room = client.getRoom(roomId);

  if (!room) {
    sendError(event, (0, _languageHandler._t)('This room is not recognised.'));
    return;
  }

  if (room.getMyMembership() !== "join") {
    sendError(event, (0, _languageHandler._t)('You are not in this room.'));
    return;
  }

  const me = client.credentials.userId;
  let canSend = false;

  if (isState) {
    canSend = room.currentState.maySendStateEvent(evType, me);
  } else {
    canSend = room.currentState.maySendEvent(evType, me);
  }

  if (!canSend) {
    sendError(event, (0, _languageHandler._t)('You do not have permission to do that in this room.'));
    return;
  }

  sendResponse(event, true);
}

function returnStateEvent(event, roomId, eventType, stateKey) {
  const client = _MatrixClientPeg.MatrixClientPeg.get();

  if (!client) {
    sendError(event, (0, _languageHandler._t)('You need to be logged in.'));
    return;
  }

  const room = client.getRoom(roomId);

  if (!room) {
    sendError(event, (0, _languageHandler._t)('This room is not recognised.'));
    return;
  }

  const stateEvent = room.currentState.getStateEvents(eventType, stateKey);

  if (!stateEvent) {
    sendResponse(event, null);
    return;
  }

  sendResponse(event, stateEvent.getContent());
}

const onMessage = function (event) {
  if (!event.origin) {
    // stupid chrome
    // @ts-ignore
    event.origin = event.originalEvent.origin;
  } // Check that the integrations UI URL starts with the origin of the event
  // This means the URL could contain a path (like /develop) and still be used
  // to validate event origins, which do not specify paths.
  // (See https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage)


  let configUrl;

  try {
    if (!openManagerUrl) openManagerUrl = _IntegrationManagers.IntegrationManagers.sharedInstance().getPrimaryManager().uiUrl;
    configUrl = new URL(openManagerUrl);
  } catch (e) {
    // No integrations UI URL, ignore silently.
    return;
  }

  let eventOriginUrl;

  try {
    eventOriginUrl = new URL(event.origin);
  } catch (e) {
    return;
  } // TODO -- Scalar postMessage API should be namespaced with event.data.api field
  // Fix following "if" statement to respond only to specific API messages.


  if (configUrl.origin !== eventOriginUrl.origin || !event.data.action || event.data.api // Ignore messages with specific API set
  ) {
    // don't log this - debugging APIs and browser add-ons like to spam
    // postMessage which floods the log otherwise
    return;
  }

  if (event.data.action === Action.CloseScalar) {
    _dispatcher.default.dispatch({
      action: Action.CloseScalar
    });

    sendResponse(event, null);
    return;
  }

  const roomId = event.data.room_id;
  const userId = event.data.user_id;

  if (!roomId) {
    // These APIs don't require roomId
    // Get and set user widgets (not associated with a specific room)
    // If roomId is specified, it must be validated, so room-based widgets agreed
    // handled further down.
    if (event.data.action === Action.GetWidgets) {
      getWidgets(event, null);
      return;
    } else if (event.data.action === Action.SetWidgets) {
      setWidget(event, null);
      return;
    } else {
      sendError(event, (0, _languageHandler._t)('Missing room_id in request'));
      return;
    }
  }

  if (roomId !== _RoomViewStore.default.getRoomId()) {
    sendError(event, (0, _languageHandler._t)('Room %(roomId)s not visible', {
      roomId: roomId
    }));
    return;
  } // Get and set room-based widgets


  if (event.data.action === Action.GetWidgets) {
    getWidgets(event, roomId);
    return;
  } else if (event.data.action === Action.SetWidget) {
    setWidget(event, roomId);
    return;
  } // These APIs don't require userId


  if (event.data.action === Action.JoinRulesState) {
    getJoinRules(event, roomId);
    return;
  } else if (event.data.action === Action.SetPlumbingState) {
    setPlumbingState(event, roomId, event.data.status);
    return;
  } else if (event.data.action === Action.GetMembershipCount) {
    getMembershipCount(event, roomId);
    return;
  } else if (event.data.action === Action.GetRoomEncryptionState) {
    getRoomEncState(event, roomId);
    return;
  } else if (event.data.action === Action.CanSendEvent) {
    canSendEvent(event, roomId);
    return;
  }

  if (!userId) {
    sendError(event, (0, _languageHandler._t)('Missing user_id in request'));
    return;
  }

  switch (event.data.action) {
    case Action.MembershipState:
      getMembershipState(event, roomId, userId);
      break;

    case Action.invite:
      inviteUser(event, roomId, userId);
      break;

    case Action.BotOptions:
      botOptions(event, roomId, userId);
      break;

    case Action.SetBotOptions:
      setBotOptions(event, roomId, userId);
      break;

    case Action.SetBotPower:
      setBotPower(event, roomId, userId, event.data.level, event.data.ignoreIfGreater);
      break;

    default:
      _logger.logger.warn("Unhandled postMessage event with action '" + event.data.action + "'");

      break;
  }
};

let listenerCount = 0;
let openManagerUrl = null;

function startListening() {
  if (listenerCount === 0) {
    window.addEventListener("message", onMessage, false);
  }

  listenerCount += 1;
}

function stopListening() {
  listenerCount -= 1;

  if (listenerCount === 0) {
    window.removeEventListener("message", onMessage);
  }

  if (listenerCount < 0) {
    // Make an error so we get a stack trace
    const e = new Error("ScalarMessaging: mismatched startListening / stopListening detected." + " Negative count");

    _logger.logger.error(e);
  }
}

function setOpenManagerUrl(url) {
  openManagerUrl = url;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9TY2FsYXJNZXNzYWdpbmcudHMiXSwibmFtZXMiOlsiQWN0aW9uIiwic2VuZFJlc3BvbnNlIiwiZXZlbnQiLCJyZXMiLCJkYXRhIiwicmVzcG9uc2UiLCJzb3VyY2UiLCJwb3N0TWVzc2FnZSIsIm9yaWdpbiIsInNlbmRFcnJvciIsIm1zZyIsIm5lc3RlZEVycm9yIiwibG9nZ2VyIiwiZXJyb3IiLCJhY3Rpb24iLCJtZXNzYWdlIiwiX2Vycm9yIiwiaW52aXRlVXNlciIsInJvb21JZCIsInVzZXJJZCIsImxvZyIsImNsaWVudCIsIk1hdHJpeENsaWVudFBlZyIsImdldCIsInJvb20iLCJnZXRSb29tIiwibWVtYmVyIiwiZ2V0TWVtYmVyIiwibWVtYmVyc2hpcCIsInN1Y2Nlc3MiLCJpbnZpdGUiLCJ0aGVuIiwiZXJyIiwic2V0V2lkZ2V0Iiwid2lkZ2V0SWQiLCJ3aWRnZXRfaWQiLCJ3aWRnZXRUeXBlIiwidHlwZSIsIndpZGdldFVybCIsInVybCIsIndpZGdldE5hbWUiLCJuYW1lIiwid2lkZ2V0RGF0YSIsInVzZXJXaWRnZXQiLCJ1bmRlZmluZWQiLCJFcnJvciIsIk9iamVjdCIsIldpZGdldFR5cGUiLCJmcm9tU3RyaW5nIiwiV2lkZ2V0VXRpbHMiLCJzZXRVc2VyV2lkZ2V0IiwiZGlzIiwiZGlzcGF0Y2giLCJjYXRjaCIsImUiLCJzZXRSb29tV2lkZ2V0IiwiZ2V0V2lkZ2V0cyIsIndpZGdldFN0YXRlRXZlbnRzIiwiZ2V0Um9vbVdpZGdldHMiLCJtYXAiLCJldiIsInVzZXJXaWRnZXRzIiwiZ2V0VXNlcldpZGdldHNBcnJheSIsImNvbmNhdCIsImdldFJvb21FbmNTdGF0ZSIsInJvb21Jc0VuY3J5cHRlZCIsImlzUm9vbUVuY3J5cHRlZCIsInNldFBsdW1iaW5nU3RhdGUiLCJzdGF0dXMiLCJzZW5kU3RhdGVFdmVudCIsInNldEJvdE9wdGlvbnMiLCJjb250ZW50Iiwic2V0Qm90UG93ZXIiLCJsZXZlbCIsImlnbm9yZUlmR3JlYXRlciIsIk51bWJlciIsImlzSW50ZWdlciIsInBvd2VyTGV2ZWxzIiwiZ2V0U3RhdGVFdmVudCIsImN1cnJlbnRQbCIsInVzZXJzIiwidXNlcnNfZGVmYXVsdCIsInNldFBvd2VyTGV2ZWwiLCJNYXRyaXhFdmVudCIsImdldE1lbWJlcnNoaXBTdGF0ZSIsInJldHVyblN0YXRlRXZlbnQiLCJnZXRKb2luUnVsZXMiLCJib3RPcHRpb25zIiwiZ2V0TWVtYmVyc2hpcENvdW50IiwiY291bnQiLCJnZXRKb2luZWRNZW1iZXJDb3VudCIsImNhblNlbmRFdmVudCIsImV2VHlwZSIsImV2ZW50X3R5cGUiLCJpc1N0YXRlIiwiQm9vbGVhbiIsImlzX3N0YXRlIiwiZ2V0TXlNZW1iZXJzaGlwIiwibWUiLCJjcmVkZW50aWFscyIsImNhblNlbmQiLCJjdXJyZW50U3RhdGUiLCJtYXlTZW5kU3RhdGVFdmVudCIsIm1heVNlbmRFdmVudCIsImV2ZW50VHlwZSIsInN0YXRlS2V5Iiwic3RhdGVFdmVudCIsImdldFN0YXRlRXZlbnRzIiwiZ2V0Q29udGVudCIsIm9uTWVzc2FnZSIsIm9yaWdpbmFsRXZlbnQiLCJjb25maWdVcmwiLCJvcGVuTWFuYWdlclVybCIsIkludGVncmF0aW9uTWFuYWdlcnMiLCJzaGFyZWRJbnN0YW5jZSIsImdldFByaW1hcnlNYW5hZ2VyIiwidWlVcmwiLCJVUkwiLCJldmVudE9yaWdpblVybCIsImFwaSIsIkNsb3NlU2NhbGFyIiwicm9vbV9pZCIsInVzZXJfaWQiLCJHZXRXaWRnZXRzIiwiU2V0V2lkZ2V0cyIsIlJvb21WaWV3U3RvcmUiLCJnZXRSb29tSWQiLCJTZXRXaWRnZXQiLCJKb2luUnVsZXNTdGF0ZSIsIlNldFBsdW1iaW5nU3RhdGUiLCJHZXRNZW1iZXJzaGlwQ291bnQiLCJHZXRSb29tRW5jcnlwdGlvblN0YXRlIiwiQ2FuU2VuZEV2ZW50IiwiTWVtYmVyc2hpcFN0YXRlIiwiQm90T3B0aW9ucyIsIlNldEJvdE9wdGlvbnMiLCJTZXRCb3RQb3dlciIsIndhcm4iLCJsaXN0ZW5lckNvdW50Iiwic3RhcnRMaXN0ZW5pbmciLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwic3RvcExpc3RlbmluZyIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRPcGVuTWFuYWdlclVybCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUE2T0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7O0FBdlBBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QUFzQ2xDLFNBQXRDO0FBQ0g7O0FBQ0QsTUFBSTZCLGFBQWEsR0FBRyxDQUFwQixFQUF1QjtBQUNuQjtBQUNBLFVBQU1wRixDQUFDLEdBQUcsSUFBSVQsS0FBSixDQUNOLHlFQUNBLGlCQUZNLENBQVY7O0FBSUFqQyxtQkFBT0MsS0FBUCxDQUFheUMsQ0FBYjtBQUNIO0FBQ0o7O0FBRU0sU0FBUzBGLGlCQUFULENBQTJCekcsR0FBM0IsRUFBOEM7QUFDakR5RSxFQUFBQSxjQUFjLEdBQUd6RSxHQUFqQjtBQUNIIiwic291cmNlc0NvbnRlbnQiOlsiLypcbkNvcHlyaWdodCAyMDE2IE9wZW5NYXJrZXQgTHRkXG5Db3B5cmlnaHQgMjAxNyBWZWN0b3IgQ3JlYXRpb25zIEx0ZFxuQ29weXJpZ2h0IDIwMTggTmV3IFZlY3RvciBMdGRcblxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbnlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbllvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuXG4gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cblVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbmRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxubGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4qL1xuXG4vLyBUT0RPOiBHZW5lcmlmeSB0aGUgbmFtZSBvZiB0aGlzIGFuZCBhbGwgY29tcG9uZW50cyB3aXRoaW4gLSBpdCdzIG5vdCBqdXN0IGZvciBzY2FsYXIuXG5cbi8qXG5MaXN0ZW5zIGZvciBpbmNvbWluZyBwb3N0TWVzc2FnZSByZXF1ZXN0cyBmcm9tIHRoZSBpbnRlZ3JhdGlvbnMgVUkgVVJMLiBUaGUgZm9sbG93aW5nIEFQSSBpcyBleHBvc2VkOlxue1xuICAgIGFjdGlvbjogXCJpbnZpdGVcIiB8IFwibWVtYmVyc2hpcF9zdGF0ZVwiIHwgXCJib3Rfb3B0aW9uc1wiIHwgXCJzZXRfYm90X29wdGlvbnNcIiB8IGV0Yy4uLiAsXG4gICAgcm9vbV9pZDogJFJPT01fSUQsXG4gICAgdXNlcl9pZDogJFVTRVJfSURcbiAgICAvLyBhZGRpdGlvbmFsIHJlcXVlc3QgZmllbGRzXG59XG5cblRoZSBjb21wbGV0ZSByZXF1ZXN0IG9iamVjdCBpcyByZXR1cm5lZCB0byB0aGUgY2FsbGVyIHdpdGggYW4gYWRkaXRpb25hbCBcInJlc3BvbnNlXCIga2V5IGxpa2Ugc286XG57XG4gICAgYWN0aW9uOiBcImludml0ZVwiIHwgXCJtZW1iZXJzaGlwX3N0YXRlXCIgfCBcImJvdF9vcHRpb25zXCIgfCBcInNldF9ib3Rfb3B0aW9uc1wiLFxuICAgIHJvb21faWQ6ICRST09NX0lELFxuICAgIHVzZXJfaWQ6ICRVU0VSX0lELFxuICAgIC8vIGFkZGl0aW9uYWwgcmVxdWVzdCBmaWVsZHNcbiAgICByZXNwb25zZTogeyAuLi4gfVxufVxuXG5UaGUgXCJhY3Rpb25cIiBkZXRlcm1pbmVzIHRoZSBmb3JtYXQgb2YgdGhlIHJlcXVlc3QgYW5kIHJlc3BvbnNlLiBBbGwgYWN0aW9ucyBjYW4gcmV0dXJuIGFuIGVycm9yIHJlc3BvbnNlLlxuQW4gZXJyb3IgcmVzcG9uc2UgaXMgYSBcInJlc3BvbnNlXCIgb2JqZWN0IHdoaWNoIGNvbnNpc3RzIG9mIGEgc29sZSBcImVycm9yXCIga2V5IHRvIGluZGljYXRlIGFuIGVycm9yLlxuVGhleSBsb29rIGxpa2U6XG57XG4gICAgZXJyb3I6IHtcbiAgICAgICAgbWVzc2FnZTogXCJVbmFibGUgdG8gaW52aXRlIHVzZXIgaW50byByb29tLlwiLFxuICAgICAgICBfZXJyb3I6IDxPcmlnaW5hbCBFcnJvciBPYmplY3Q+XG4gICAgfVxufVxuVGhlIFwibWVzc2FnZVwiIGtleSBzaG91bGQgYmUgYSBodW1hbi1mcmllbmRseSBzdHJpbmcuXG5cbkFDVElPTlNcbj09PT09PT1cbkFsbCBhY3Rpb25zIGNhbiByZXR1cm4gYW4gZXJyb3IgcmVzcG9uc2UgaW5zdGVhZCBvZiB0aGUgcmVzcG9uc2Ugb3V0bGluZWQgYmVsb3cuXG5cbmludml0ZVxuLS0tLS0tXG5JbnZpdGVzIGEgdXNlciBpbnRvIGEgcm9vbS5cblxuUmVxdWVzdDpcbiAtIHJvb21faWQgaXMgdGhlIHJvb20gdG8gaW52aXRlIHRoZSB1c2VyIGludG8uXG4gLSB1c2VyX2lkIGlzIHRoZSB1c2VyIElEIHRvIGludml0ZS5cbiAtIE5vIGFkZGl0aW9uYWwgZmllbGRzLlxuUmVzcG9uc2U6XG57XG4gICAgc3VjY2VzczogdHJ1ZVxufVxuRXhhbXBsZTpcbntcbiAgICBhY3Rpb246IFwiaW52aXRlXCIsXG4gICAgcm9vbV9pZDogXCIhZm9vOmJhclwiLFxuICAgIHVzZXJfaWQ6IFwiQGludml0ZWU6YmFyXCIsXG4gICAgcmVzcG9uc2U6IHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZVxuICAgIH1cbn1cblxuc2V0X2JvdF9vcHRpb25zXG4tLS0tLS0tLS0tLS0tLS1cblNldCB0aGUgbS5yb29tLmJvdC5vcHRpb25zIHN0YXRlIGV2ZW50IGZvciBhIGJvdCB1c2VyLlxuXG5SZXF1ZXN0OlxuIC0gcm9vbV9pZCBpcyB0aGUgcm9vbSB0byBzZW5kIHRoZSBzdGF0ZSBldmVudCBpbnRvLlxuIC0gdXNlcl9pZCBpcyB0aGUgdXNlciBJRCBvZiB0aGUgYm90IHdobyB5b3UncmUgc2V0dGluZyBvcHRpb25zIGZvci5cbiAtIFwiY29udGVudFwiIGlzIGFuIG9iamVjdCBjb25zaXN0aW5nIG9mIHRoZSBjb250ZW50IHlvdSB3aXNoIHRvIHNldC5cblJlc3BvbnNlOlxue1xuICAgIHN1Y2Nlc3M6IHRydWVcbn1cbkV4YW1wbGU6XG57XG4gICAgYWN0aW9uOiBcInNldF9ib3Rfb3B0aW9uc1wiLFxuICAgIHJvb21faWQ6IFwiIWZvbzpiYXJcIixcbiAgICB1c2VyX2lkOiBcIkBib3Q6YmFyXCIsXG4gICAgY29udGVudDoge1xuICAgICAgICBkZWZhdWx0X29wdGlvbjogXCJhbHBoYVwiXG4gICAgfSxcbiAgICByZXNwb25zZToge1xuICAgICAgICBzdWNjZXNzOiB0cnVlXG4gICAgfVxufVxuXG5nZXRfbWVtYmVyc2hpcF9jb3VudFxuLS0tLS0tLS0tLS0tLS0tLS0tLS1cbkdldCB0aGUgbnVtYmVyIG9mIGpvaW5lZCB1c2VycyBpbiB0aGUgcm9vbS5cblxuUmVxdWVzdDpcbiAtIHJvb21faWQgaXMgdGhlIHJvb20gdG8gZ2V0IHRoZSBjb3VudCBpbi5cblJlc3BvbnNlOlxuNzhcbkV4YW1wbGU6XG57XG4gICAgYWN0aW9uOiBcImdldF9tZW1iZXJzaGlwX2NvdW50XCIsXG4gICAgcm9vbV9pZDogXCIhZm9vOmJhclwiLFxuICAgIHJlc3BvbnNlOiA3OFxufVxuXG5jYW5fc2VuZF9ldmVudFxuLS0tLS0tLS0tLS0tLS1cbkNoZWNrIGlmIHRoZSBjbGllbnQgY2FuIHNlbmQgdGhlIGdpdmVuIGV2ZW50IGludG8gdGhlIGdpdmVuIHJvb20uIElmIHRoZSBjbGllbnRcbmlzIHVuYWJsZSB0byBkbyB0aGlzLCBhbiBlcnJvciByZXNwb25zZSBpcyByZXR1cm5lZCBpbnN0ZWFkIG9mICdyZXNwb25zZTogZmFsc2UnLlxuXG5SZXF1ZXN0OlxuIC0gcm9vbV9pZCBpcyB0aGUgcm9vbSB0byBkbyB0aGUgY2hlY2sgaW4uXG4gLSBldmVudF90eXBlIGlzIHRoZSBldmVudCB0eXBlIHdoaWNoIHdpbGwgYmUgc2VudC5cbiAtIGlzX3N0YXRlIGlzIHRydWUgaWYgdGhlIGV2ZW50IHRvIGJlIHNlbnQgaXMgYSBzdGF0ZSBldmVudC5cblJlc3BvbnNlOlxudHJ1ZVxuRXhhbXBsZTpcbntcbiAgICBhY3Rpb246IFwiY2FuX3NlbmRfZXZlbnRcIixcbiAgICBpc19zdGF0ZTogZmFsc2UsXG4gICAgZXZlbnRfdHlwZTogXCJtLnJvb20ubWVzc2FnZVwiLFxuICAgIHJvb21faWQ6IFwiIWZvbzpiYXJcIixcbiAgICByZXNwb25zZTogdHJ1ZVxufVxuXG5zZXRfd2lkZ2V0XG4tLS0tLS0tLS0tXG5TZXQgYSBuZXcgd2lkZ2V0IGluIHRoZSByb29tLiBDbG9iYmVycyBiYXNlZCBvbiB0aGUgSUQuXG5cblJlcXVlc3Q6XG4gLSBgcm9vbV9pZGAgKFN0cmluZykgaXMgdGhlIHJvb20gdG8gc2V0IHRoZSB3aWRnZXQgaW4uXG4gLSBgd2lkZ2V0X2lkYCAoU3RyaW5nKSBpcyB0aGUgSUQgb2YgdGhlIHdpZGdldCB0byBhZGQgKG9yIHJlcGxhY2UgaWYgaXQgYWxyZWFkeSBleGlzdHMpLlxuICAgSXQgY2FuIGJlIGFuIGFyYml0cmFyeSBVVEY4IHN0cmluZyBhbmQgaXMgcHVyZWx5IGZvciBkaXN0aW5ndWlzaGluZyBiZXR3ZWVuIHdpZGdldHMuXG4gLSBgdXJsYCAoU3RyaW5nKSBpcyB0aGUgVVJMIHRoYXQgY2xpZW50cyBzaG91bGQgbG9hZCBpbiBhbiBpZnJhbWUgdG8gcnVuIHRoZSB3aWRnZXQuXG4gICBBbGwgd2lkZ2V0cyBtdXN0IGhhdmUgYSB2YWxpZCBVUkwuIElmIHRoZSBVUkwgaXMgYG51bGxgIChub3QgYHVuZGVmaW5lZGApLCB0aGVcbiAgIHdpZGdldCB3aWxsIGJlIHJlbW92ZWQgZnJvbSB0aGUgcm9vbS5cbiAtIGB0eXBlYCAoU3RyaW5nKSBpcyB0aGUgdHlwZSBvZiB3aWRnZXQsIHdoaWNoIGlzIHByb3ZpZGVkIGFzIGEgaGludCBmb3IgbWF0cml4IGNsaWVudHMgc28gdGhleVxuICAgY2FuIGNvbmZpZ3VyZS9sYXkgb3V0IHRoZSB3aWRnZXQgaW4gZGlmZmVyZW50IHdheXMuIEFsbCB3aWRnZXRzIG11c3QgaGF2ZSBhIHR5cGUuXG4gLSBgbmFtZWAgKFN0cmluZykgaXMgYW4gb3B0aW9uYWwgaHVtYW4tcmVhZGFibGUgc3RyaW5nIGFib3V0IHRoZSB3aWRnZXQuXG4gLSBgZGF0YWAgKE9iamVjdCkgaXMgc29tZSBvcHRpb25hbCBkYXRhIGFib3V0IHRoZSB3aWRnZXQsIGFuZCBjYW4gY29udGFpbiBhcmJpdHJhcnkga2V5L3ZhbHVlIHBhaXJzLlxuUmVzcG9uc2U6XG57XG4gICAgc3VjY2VzczogdHJ1ZVxufVxuRXhhbXBsZTpcbntcbiAgICBhY3Rpb246IFwic2V0X3dpZGdldFwiLFxuICAgIHJvb21faWQ6IFwiIWZvbzpiYXJcIixcbiAgICB3aWRnZXRfaWQ6IFwiYWJjMTIzXCIsXG4gICAgdXJsOiBcImh0dHA6Ly93aWRnZXQudXJsXCIsXG4gICAgdHlwZTogXCJleGFtcGxlXCIsXG4gICAgcmVzcG9uc2U6IHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZVxuICAgIH1cbn1cblxuZ2V0X3dpZGdldHNcbi0tLS0tLS0tLS0tXG5HZXQgYSBsaXN0IG9mIGFsbCB3aWRnZXRzIGluIHRoZSByb29tLiBUaGUgcmVzcG9uc2UgaXMgYW4gYXJyYXlcbm9mIHN0YXRlIGV2ZW50cy5cblxuUmVxdWVzdDpcbiAtIGByb29tX2lkYCAoU3RyaW5nKSBpcyB0aGUgcm9vbSB0byBnZXQgdGhlIHdpZGdldHMgaW4uXG5SZXNwb25zZTpcbltcbiAgICB7XG4gICAgICAgIC8vIFRPRE86IEVuYWJsZSBzdXBwb3J0IGZvciBtLndpZGdldCBldmVudCB0eXBlIChodHRwczovL2dpdGh1Yi5jb20vdmVjdG9yLWltL2VsZW1lbnQtd2ViL2lzc3Vlcy8xMzExMSlcbiAgICAgICAgdHlwZTogXCJpbS52ZWN0b3IubW9kdWxhci53aWRnZXRzXCIsXG4gICAgICAgIHN0YXRlX2tleTogXCJ3aWQxXCIsXG4gICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgIHR5cGU6IFwiZ3JhZmFuYVwiLFxuICAgICAgICAgICAgdXJsOiBcImh0dHBzOi8vZ3JhZmFuYXVybFwiLFxuICAgICAgICAgICAgbmFtZTogXCJkYXNoYm9hcmRcIixcbiAgICAgICAgICAgIGRhdGE6IHtrZXk6IFwidmFsXCJ9XG4gICAgICAgIH1cbiAgICAgICAgcm9vbV9pZDogXCIhZm9vOmJhclwiLFxuICAgICAgICBzZW5kZXI6IFwiQGFsaWNlOmxvY2FsaG9zdFwiXG4gICAgfVxuXVxuRXhhbXBsZTpcbntcbiAgICBhY3Rpb246IFwiZ2V0X3dpZGdldHNcIixcbiAgICByb29tX2lkOiBcIiFmb286YmFyXCIsXG4gICAgcmVzcG9uc2U6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gVE9ETzogRW5hYmxlIHN1cHBvcnQgZm9yIG0ud2lkZ2V0IGV2ZW50IHR5cGUgKGh0dHBzOi8vZ2l0aHViLmNvbS92ZWN0b3ItaW0vZWxlbWVudC13ZWIvaXNzdWVzLzEzMTExKVxuICAgICAgICAgICAgdHlwZTogXCJpbS52ZWN0b3IubW9kdWxhci53aWRnZXRzXCIsXG4gICAgICAgICAgICBzdGF0ZV9rZXk6IFwid2lkMVwiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgIHR5cGU6IFwiZ3JhZmFuYVwiLFxuICAgICAgICAgICAgICAgIHVybDogXCJodHRwczovL2dyYWZhbmF1cmxcIixcbiAgICAgICAgICAgICAgICBuYW1lOiBcImRhc2hib2FyZFwiLFxuICAgICAgICAgICAgICAgIGRhdGE6IHtrZXk6IFwidmFsXCJ9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByb29tX2lkOiBcIiFmb286YmFyXCIsXG4gICAgICAgICAgICBzZW5kZXI6IFwiQGFsaWNlOmxvY2FsaG9zdFwiXG4gICAgICAgIH1cbiAgICBdXG59XG5cbm1lbWJlcnNoaXBfc3RhdGUgQU5EIGJvdF9vcHRpb25zXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuR2V0IHRoZSBjb250ZW50IG9mIHRoZSBcIm0ucm9vbS5tZW1iZXJcIiBvciBcIm0ucm9vbS5ib3Qub3B0aW9uc1wiIHN0YXRlIGV2ZW50IHJlc3BlY3RpdmVseS5cblxuTkI6IFdoaWxzdCB0aGlzIEFQSSBpcyBiYXNpY2FsbHkgZXF1aXZhbGVudCB0byBnZXRTdGF0ZUV2ZW50LCB3ZSBzcGVjaWZpY2FsbHkgZG8gbm90XG4gICAgd2FudCBleHRlcm5hbCBlbnRpdGllcyB0byBiZSBhYmxlIHRvIHF1ZXJ5IGFueSBzdGF0ZSBldmVudCBmb3IgYW55IHJvb20sIGhlbmNlIHRoZVxuICAgIHJlc3RyaWN0aXZlIEFQSSBvdXRsaW5lZCBoZXJlLlxuXG5SZXF1ZXN0OlxuIC0gcm9vbV9pZCBpcyB0aGUgcm9vbSB3aGljaCBoYXMgdGhlIHN0YXRlIGV2ZW50LlxuIC0gdXNlcl9pZCBpcyB0aGUgc3RhdGVfa2V5IHBhcmFtZXRlciB3aGljaCBpbiBib3RoIGNhc2VzIGlzIGEgdXNlciBJRCAodGhlIG1lbWJlciBvciB0aGUgYm90KS5cbiAtIE5vIGFkZGl0aW9uYWwgZmllbGRzLlxuUmVzcG9uc2U6XG4gLSBUaGUgZXZlbnQgY29udGVudC4gSWYgdGhlcmUgaXMgbm8gc3RhdGUgZXZlbnQsIHRoZSBcInJlc3BvbnNlXCIga2V5IHNob3VsZCBiZSBudWxsLlxuRXhhbXBsZTpcbntcbiAgICBhY3Rpb246IFwibWVtYmVyc2hpcF9zdGF0ZVwiLFxuICAgIHJvb21faWQ6IFwiIWZvbzpiYXJcIixcbiAgICB1c2VyX2lkOiBcIkBzb21lbWVtYmVyOmJhclwiLFxuICAgIHJlc3BvbnNlOiB7XG4gICAgICAgIG1lbWJlcnNoaXA6IFwiam9pblwiLFxuICAgICAgICBkaXNwbGF5bmFtZTogXCJCb2JcIixcbiAgICAgICAgYXZhdGFyX3VybDogbnVsbFxuICAgIH1cbn1cbiovXG5cbmltcG9ydCB7IE1hdHJpeENsaWVudFBlZyB9IGZyb20gJy4vTWF0cml4Q2xpZW50UGVnJztcbmltcG9ydCB7IE1hdHJpeEV2ZW50IH0gZnJvbSAnbWF0cml4LWpzLXNkay9zcmMvbW9kZWxzL2V2ZW50JztcbmltcG9ydCBkaXMgZnJvbSAnLi9kaXNwYXRjaGVyL2Rpc3BhdGNoZXInO1xuaW1wb3J0IFdpZGdldFV0aWxzIGZyb20gJy4vdXRpbHMvV2lkZ2V0VXRpbHMnO1xuaW1wb3J0IFJvb21WaWV3U3RvcmUgZnJvbSAnLi9zdG9yZXMvUm9vbVZpZXdTdG9yZSc7XG5pbXBvcnQgeyBfdCB9IGZyb20gJy4vbGFuZ3VhZ2VIYW5kbGVyJztcbmltcG9ydCB7IEludGVncmF0aW9uTWFuYWdlcnMgfSBmcm9tIFwiLi9pbnRlZ3JhdGlvbnMvSW50ZWdyYXRpb25NYW5hZ2Vyc1wiO1xuaW1wb3J0IHsgV2lkZ2V0VHlwZSB9IGZyb20gXCIuL3dpZGdldHMvV2lkZ2V0VHlwZVwiO1xuaW1wb3J0IHsgb2JqZWN0Q2xvbmUgfSBmcm9tIFwiLi91dGlscy9vYmplY3RzXCI7XG5cbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gXCJtYXRyaXgtanMtc2RrL3NyYy9sb2dnZXJcIjtcblxuZW51bSBBY3Rpb24ge1xuICAgIENsb3NlU2NhbGFyID0gXCJjbG9zZV9zY2FsYXJcIixcbiAgICBHZXRXaWRnZXRzID0gXCJnZXRfd2lkZ2V0c1wiLFxuICAgIFNldFdpZGdldHMgPSBcInNldF93aWRnZXRzXCIsXG4gICAgU2V0V2lkZ2V0ID0gXCJzZXRfd2lkZ2V0XCIsXG4gICAgSm9pblJ1bGVzU3RhdGUgPSBcImpvaW5fcnVsZXNfc3RhdGVcIixcbiAgICBTZXRQbHVtYmluZ1N0YXRlID0gXCJzZXRfcGx1bWJpbmdfc3RhdGVcIixcbiAgICBHZXRNZW1iZXJzaGlwQ291bnQgPSBcImdldF9tZW1iZXJzaGlwX2NvdW50XCIsXG4gICAgR2V0Um9vbUVuY3J5cHRpb25TdGF0ZSA9IFwiZ2V0X3Jvb21fZW5jX3N0YXRlXCIsXG4gICAgQ2FuU2VuZEV2ZW50ID0gXCJjYW5fc2VuZF9ldmVudFwiLFxuICAgIE1lbWJlcnNoaXBTdGF0ZSA9IFwibWVtYmVyc2hpcF9zdGF0ZVwiLFxuICAgIGludml0ZSA9IFwiaW52aXRlXCIsXG4gICAgQm90T3B0aW9ucyA9IFwiYm90X29wdGlvbnNcIixcbiAgICBTZXRCb3RPcHRpb25zID0gXCJzZXRfYm90X29wdGlvbnNcIixcbiAgICBTZXRCb3RQb3dlciA9IFwic2V0X2JvdF9wb3dlclwiLFxufVxuXG5mdW5jdGlvbiBzZW5kUmVzcG9uc2UoZXZlbnQ6IE1lc3NhZ2VFdmVudDxhbnk+LCByZXM6IGFueSk6IHZvaWQge1xuICAgIGNvbnN0IGRhdGEgPSBvYmplY3RDbG9uZShldmVudC5kYXRhKTtcbiAgICBkYXRhLnJlc3BvbnNlID0gcmVzO1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBldmVudC5zb3VyY2UucG9zdE1lc3NhZ2UoZGF0YSwgZXZlbnQub3JpZ2luKTtcbn1cblxuZnVuY3Rpb24gc2VuZEVycm9yKGV2ZW50OiBNZXNzYWdlRXZlbnQ8YW55PiwgbXNnOiBzdHJpbmcsIG5lc3RlZEVycm9yPzogRXJyb3IpOiB2b2lkIHtcbiAgICBsb2dnZXIuZXJyb3IoXCJBY3Rpb246XCIgKyBldmVudC5kYXRhLmFjdGlvbiArIFwiIGZhaWxlZCB3aXRoIG1lc3NhZ2U6IFwiICsgbXNnKTtcbiAgICBjb25zdCBkYXRhID0gb2JqZWN0Q2xvbmUoZXZlbnQuZGF0YSk7XG4gICAgZGF0YS5yZXNwb25zZSA9IHtcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICAgIG1lc3NhZ2U6IG1zZyxcbiAgICAgICAgfSxcbiAgICB9O1xuICAgIGlmIChuZXN0ZWRFcnJvcikge1xuICAgICAgICBkYXRhLnJlc3BvbnNlLmVycm9yLl9lcnJvciA9IG5lc3RlZEVycm9yO1xuICAgIH1cbiAgICAvLyBAdHMtaWdub3JlXG4gICAgZXZlbnQuc291cmNlLnBvc3RNZXNzYWdlKGRhdGEsIGV2ZW50Lm9yaWdpbik7XG59XG5cbmZ1bmN0aW9uIGludml0ZVVzZXIoZXZlbnQ6IE1lc3NhZ2VFdmVudDxhbnk+LCByb29tSWQ6IHN0cmluZywgdXNlcklkOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBsb2dnZXIubG9nKGBSZWNlaXZlZCByZXF1ZXN0IHRvIGludml0ZSAke3VzZXJJZH0gaW50byByb29tICR7cm9vbUlkfWApO1xuICAgIGNvbnN0IGNsaWVudCA9IE1hdHJpeENsaWVudFBlZy5nZXQoKTtcbiAgICBpZiAoIWNsaWVudCkge1xuICAgICAgICBzZW5kRXJyb3IoZXZlbnQsIF90KCdZb3UgbmVlZCB0byBiZSBsb2dnZWQgaW4uJykpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHJvb20gPSBjbGllbnQuZ2V0Um9vbShyb29tSWQpO1xuICAgIGlmIChyb29tKSB7XG4gICAgICAgIC8vIGlmIHRoZXkgYXJlIGFscmVhZHkgaW52aXRlZCB3ZSBjYW4gcmVzb2x2ZSBpbW1lZGlhdGVseS5cbiAgICAgICAgY29uc3QgbWVtYmVyID0gcm9vbS5nZXRNZW1iZXIodXNlcklkKTtcbiAgICAgICAgaWYgKG1lbWJlciAmJiBtZW1iZXIubWVtYmVyc2hpcCA9PT0gXCJpbnZpdGVcIikge1xuICAgICAgICAgICAgc2VuZFJlc3BvbnNlKGV2ZW50LCB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2xpZW50Lmludml0ZShyb29tSWQsIHVzZXJJZCkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgc2VuZFJlc3BvbnNlKGV2ZW50LCB7XG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICB9KTtcbiAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgc2VuZEVycm9yKGV2ZW50LCBfdCgnWW91IG5lZWQgdG8gYmUgYWJsZSB0byBpbnZpdGUgdXNlcnMgdG8gZG8gdGhhdC4nKSwgZXJyKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gc2V0V2lkZ2V0KGV2ZW50OiBNZXNzYWdlRXZlbnQ8YW55Piwgcm9vbUlkOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBjb25zdCB3aWRnZXRJZCA9IGV2ZW50LmRhdGEud2lkZ2V0X2lkO1xuICAgIGxldCB3aWRnZXRUeXBlID0gZXZlbnQuZGF0YS50eXBlO1xuICAgIGNvbnN0IHdpZGdldFVybCA9IGV2ZW50LmRhdGEudXJsO1xuICAgIGNvbnN0IHdpZGdldE5hbWUgPSBldmVudC5kYXRhLm5hbWU7IC8vIG9wdGlvbmFsXG4gICAgY29uc3Qgd2lkZ2V0RGF0YSA9IGV2ZW50LmRhdGEuZGF0YTsgLy8gb3B0aW9uYWxcbiAgICBjb25zdCB1c2VyV2lkZ2V0ID0gZXZlbnQuZGF0YS51c2VyV2lkZ2V0O1xuXG4gICAgLy8gYm90aCBhZGRpbmcvcmVtb3Zpbmcgd2lkZ2V0cyBuZWVkIHRoZXNlIGNoZWNrc1xuICAgIGlmICghd2lkZ2V0SWQgfHwgd2lkZ2V0VXJsID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgc2VuZEVycm9yKGV2ZW50LCBfdChcIlVuYWJsZSB0byBjcmVhdGUgd2lkZ2V0LlwiKSwgbmV3IEVycm9yKFwiTWlzc2luZyByZXF1aXJlZCB3aWRnZXQgZmllbGRzLlwiKSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAod2lkZ2V0VXJsICE9PSBudWxsKSB7IC8vIGlmIHVybCBpcyBudWxsIGl0IGlzIGJlaW5nIGRlbGV0ZWQsIGRvbid0IG5lZWQgdG8gY2hlY2sgbmFtZS90eXBlL2V0Y1xuICAgICAgICAvLyBjaGVjayB0eXBlcyBvZiBmaWVsZHNcbiAgICAgICAgaWYgKHdpZGdldE5hbWUgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygd2lkZ2V0TmFtZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIHNlbmRFcnJvcihldmVudCwgX3QoXCJVbmFibGUgdG8gY3JlYXRlIHdpZGdldC5cIiksIG5ldyBFcnJvcihcIk9wdGlvbmFsIGZpZWxkICduYW1lJyBtdXN0IGJlIGEgc3RyaW5nLlwiKSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHdpZGdldERhdGEgIT09IHVuZGVmaW5lZCAmJiAhKHdpZGdldERhdGEgaW5zdGFuY2VvZiBPYmplY3QpKSB7XG4gICAgICAgICAgICBzZW5kRXJyb3IoZXZlbnQsIF90KFwiVW5hYmxlIHRvIGNyZWF0ZSB3aWRnZXQuXCIpLCBuZXcgRXJyb3IoXCJPcHRpb25hbCBmaWVsZCAnZGF0YScgbXVzdCBiZSBhbiBPYmplY3QuXCIpKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHdpZGdldFR5cGUgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBzZW5kRXJyb3IoZXZlbnQsIF90KFwiVW5hYmxlIHRvIGNyZWF0ZSB3aWRnZXQuXCIpLCBuZXcgRXJyb3IoXCJGaWVsZCAndHlwZScgbXVzdCBiZSBhIHN0cmluZy5cIikpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2Ygd2lkZ2V0VXJsICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgc2VuZEVycm9yKGV2ZW50LCBfdChcIlVuYWJsZSB0byBjcmVhdGUgd2lkZ2V0LlwiKSwgbmV3IEVycm9yKFwiRmllbGQgJ3VybCcgbXVzdCBiZSBhIHN0cmluZyBvciBudWxsLlwiKSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBjb252ZXJ0IHRoZSB3aWRnZXQgdHlwZSB0byBhIGtub3duIHdpZGdldCB0eXBlXG4gICAgd2lkZ2V0VHlwZSA9IFdpZGdldFR5cGUuZnJvbVN0cmluZyh3aWRnZXRUeXBlKTtcblxuICAgIGlmICh1c2VyV2lkZ2V0KSB7XG4gICAgICAgIFdpZGdldFV0aWxzLnNldFVzZXJXaWRnZXQod2lkZ2V0SWQsIHdpZGdldFR5cGUsIHdpZGdldFVybCwgd2lkZ2V0TmFtZSwgd2lkZ2V0RGF0YSkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBzZW5kUmVzcG9uc2UoZXZlbnQsIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGRpcy5kaXNwYXRjaCh7IGFjdGlvbjogXCJ1c2VyX3dpZGdldF91cGRhdGVkXCIgfSk7XG4gICAgICAgIH0pLmNhdGNoKChlKSA9PiB7XG4gICAgICAgICAgICBzZW5kRXJyb3IoZXZlbnQsIF90KCdVbmFibGUgdG8gY3JlYXRlIHdpZGdldC4nKSwgZSk7XG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7IC8vIFJvb20gd2lkZ2V0XG4gICAgICAgIGlmICghcm9vbUlkKSB7XG4gICAgICAgICAgICBzZW5kRXJyb3IoZXZlbnQsIF90KCdNaXNzaW5nIHJvb21JZC4nKSwgbnVsbCk7XG4gICAgICAgIH1cbiAgICAgICAgV2lkZ2V0VXRpbHMuc2V0Um9vbVdpZGdldChyb29tSWQsIHdpZGdldElkLCB3aWRnZXRUeXBlLCB3aWRnZXRVcmwsIHdpZGdldE5hbWUsIHdpZGdldERhdGEpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgc2VuZFJlc3BvbnNlKGV2ZW50LCB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LCAoZXJyKSA9PiB7XG4gICAgICAgICAgICBzZW5kRXJyb3IoZXZlbnQsIF90KCdGYWlsZWQgdG8gc2VuZCByZXF1ZXN0LicpLCBlcnIpO1xuICAgICAgICB9KTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGdldFdpZGdldHMoZXZlbnQ6IE1lc3NhZ2VFdmVudDxhbnk+LCByb29tSWQ6IHN0cmluZyk6IHZvaWQge1xuICAgIGNvbnN0IGNsaWVudCA9IE1hdHJpeENsaWVudFBlZy5nZXQoKTtcbiAgICBpZiAoIWNsaWVudCkge1xuICAgICAgICBzZW5kRXJyb3IoZXZlbnQsIF90KCdZb3UgbmVlZCB0byBiZSBsb2dnZWQgaW4uJykpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGxldCB3aWRnZXRTdGF0ZUV2ZW50cyA9IFtdO1xuXG4gICAgaWYgKHJvb21JZCkge1xuICAgICAgICBjb25zdCByb29tID0gY2xpZW50LmdldFJvb20ocm9vbUlkKTtcbiAgICAgICAgaWYgKCFyb29tKSB7XG4gICAgICAgICAgICBzZW5kRXJyb3IoZXZlbnQsIF90KCdUaGlzIHJvb20gaXMgbm90IHJlY29nbmlzZWQuJykpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIFhYWDogVGhpcyBnZXRzIHRoZSByYXcgZXZlbnQgb2JqZWN0IChJIHRoaW5rIGJlY2F1c2Ugd2UgY2FuJ3RcbiAgICAgICAgLy8gc2VuZCB0aGUgTWF0cml4RXZlbnQgb3ZlciBwb3N0TWVzc2FnZT8pXG4gICAgICAgIHdpZGdldFN0YXRlRXZlbnRzID0gV2lkZ2V0VXRpbHMuZ2V0Um9vbVdpZGdldHMocm9vbSkubWFwKChldikgPT4gZXYuZXZlbnQpO1xuICAgIH1cblxuICAgIC8vIEFkZCB1c2VyIHdpZGdldHMgKG5vdCBsaW5rZWQgdG8gYSBzcGVjaWZpYyByb29tKVxuICAgIGNvbnN0IHVzZXJXaWRnZXRzID0gV2lkZ2V0VXRpbHMuZ2V0VXNlcldpZGdldHNBcnJheSgpO1xuICAgIHdpZGdldFN0YXRlRXZlbnRzID0gd2lkZ2V0U3RhdGVFdmVudHMuY29uY2F0KHVzZXJXaWRnZXRzKTtcblxuICAgIHNlbmRSZXNwb25zZShldmVudCwgd2lkZ2V0U3RhdGVFdmVudHMpO1xufVxuXG5mdW5jdGlvbiBnZXRSb29tRW5jU3RhdGUoZXZlbnQ6IE1lc3NhZ2VFdmVudDxhbnk+LCByb29tSWQ6IHN0cmluZyk6IHZvaWQge1xuICAgIGNvbnN0IGNsaWVudCA9IE1hdHJpeENsaWVudFBlZy5nZXQoKTtcbiAgICBpZiAoIWNsaWVudCkge1xuICAgICAgICBzZW5kRXJyb3IoZXZlbnQsIF90KCdZb3UgbmVlZCB0byBiZSBsb2dnZWQgaW4uJykpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHJvb20gPSBjbGllbnQuZ2V0Um9vbShyb29tSWQpO1xuICAgIGlmICghcm9vbSkge1xuICAgICAgICBzZW5kRXJyb3IoZXZlbnQsIF90KCdUaGlzIHJvb20gaXMgbm90IHJlY29nbmlzZWQuJykpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHJvb21Jc0VuY3J5cHRlZCA9IE1hdHJpeENsaWVudFBlZy5nZXQoKS5pc1Jvb21FbmNyeXB0ZWQocm9vbUlkKTtcblxuICAgIHNlbmRSZXNwb25zZShldmVudCwgcm9vbUlzRW5jcnlwdGVkKTtcbn1cblxuZnVuY3Rpb24gc2V0UGx1bWJpbmdTdGF0ZShldmVudDogTWVzc2FnZUV2ZW50PGFueT4sIHJvb21JZDogc3RyaW5nLCBzdGF0dXM6IHN0cmluZyk6IHZvaWQge1xuICAgIGlmICh0eXBlb2Ygc3RhdHVzICE9PSAnc3RyaW5nJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1BsdW1iaW5nIHN0YXRlIHN0YXR1cyBzaG91bGQgYmUgYSBzdHJpbmcnKTtcbiAgICB9XG4gICAgbG9nZ2VyLmxvZyhgUmVjZWl2ZWQgcmVxdWVzdCB0byBzZXQgcGx1bWJpbmcgc3RhdGUgdG8gc3RhdHVzIFwiJHtzdGF0dXN9XCIgaW4gcm9vbSAke3Jvb21JZH1gKTtcbiAgICBjb25zdCBjbGllbnQgPSBNYXRyaXhDbGllbnRQZWcuZ2V0KCk7XG4gICAgaWYgKCFjbGllbnQpIHtcbiAgICAgICAgc2VuZEVycm9yKGV2ZW50LCBfdCgnWW91IG5lZWQgdG8gYmUgbG9nZ2VkIGluLicpKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjbGllbnQuc2VuZFN0YXRlRXZlbnQocm9vbUlkLCBcIm0ucm9vbS5wbHVtYmluZ1wiLCB7IHN0YXR1czogc3RhdHVzIH0pLnRoZW4oKCkgPT4ge1xuICAgICAgICBzZW5kUmVzcG9uc2UoZXZlbnQsIHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIH0pO1xuICAgIH0sIChlcnIpID0+IHtcbiAgICAgICAgc2VuZEVycm9yKGV2ZW50LCBlcnIubWVzc2FnZSA/IGVyci5tZXNzYWdlIDogX3QoJ0ZhaWxlZCB0byBzZW5kIHJlcXVlc3QuJyksIGVycik7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIHNldEJvdE9wdGlvbnMoZXZlbnQ6IE1lc3NhZ2VFdmVudDxhbnk+LCByb29tSWQ6IHN0cmluZywgdXNlcklkOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBsb2dnZXIubG9nKGBSZWNlaXZlZCByZXF1ZXN0IHRvIHNldCBvcHRpb25zIGZvciBib3QgJHt1c2VySWR9IGluIHJvb20gJHtyb29tSWR9YCk7XG4gICAgY29uc3QgY2xpZW50ID0gTWF0cml4Q2xpZW50UGVnLmdldCgpO1xuICAgIGlmICghY2xpZW50KSB7XG4gICAgICAgIHNlbmRFcnJvcihldmVudCwgX3QoJ1lvdSBuZWVkIHRvIGJlIGxvZ2dlZCBpbi4nKSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY2xpZW50LnNlbmRTdGF0ZUV2ZW50KHJvb21JZCwgXCJtLnJvb20uYm90Lm9wdGlvbnNcIiwgZXZlbnQuZGF0YS5jb250ZW50LCBcIl9cIiArIHVzZXJJZCkudGhlbigoKSA9PiB7XG4gICAgICAgIHNlbmRSZXNwb25zZShldmVudCwge1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgfSwgKGVycikgPT4ge1xuICAgICAgICBzZW5kRXJyb3IoZXZlbnQsIGVyci5tZXNzYWdlID8gZXJyLm1lc3NhZ2UgOiBfdCgnRmFpbGVkIHRvIHNlbmQgcmVxdWVzdC4nKSwgZXJyKTtcbiAgICB9KTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gc2V0Qm90UG93ZXIoXG4gICAgZXZlbnQ6IE1lc3NhZ2VFdmVudDxhbnk+LCByb29tSWQ6IHN0cmluZywgdXNlcklkOiBzdHJpbmcsIGxldmVsOiBudW1iZXIsIGlnbm9yZUlmR3JlYXRlcj86IGJvb2xlYW4sXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAoIShOdW1iZXIuaXNJbnRlZ2VyKGxldmVsKSAmJiBsZXZlbCA+PSAwKSkge1xuICAgICAgICBzZW5kRXJyb3IoZXZlbnQsIF90KCdQb3dlciBsZXZlbCBtdXN0IGJlIHBvc2l0aXZlIGludGVnZXIuJykpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgbG9nZ2VyLmxvZyhgUmVjZWl2ZWQgcmVxdWVzdCB0byBzZXQgcG93ZXIgbGV2ZWwgdG8gJHtsZXZlbH0gZm9yIGJvdCAke3VzZXJJZH0gaW4gcm9vbSAke3Jvb21JZH0uYCk7XG4gICAgY29uc3QgY2xpZW50ID0gTWF0cml4Q2xpZW50UGVnLmdldCgpO1xuICAgIGlmICghY2xpZW50KSB7XG4gICAgICAgIHNlbmRFcnJvcihldmVudCwgX3QoJ1lvdSBuZWVkIHRvIGJlIGxvZ2dlZCBpbi4nKSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBwb3dlckxldmVscyA9IGF3YWl0IGNsaWVudC5nZXRTdGF0ZUV2ZW50KHJvb21JZCwgXCJtLnJvb20ucG93ZXJfbGV2ZWxzXCIsIFwiXCIpO1xuXG4gICAgICAgIC8vIElmIHRoZSBQTCBpcyBlcXVhbCB0byBvciBncmVhdGVyIHRoYW4gdGhlIHJlcXVlc3RlZCBQTCwgaWdub3JlLlxuICAgICAgICBpZiAoaWdub3JlSWZHcmVhdGVyID09PSB0cnVlKSB7XG4gICAgICAgICAgICAvLyBBcyBwZXIgaHR0cHM6Ly9tYXRyaXgub3JnL2RvY3Mvc3BlYy9jbGllbnRfc2VydmVyL3IwLjYuMCNtLXJvb20tcG93ZXItbGV2ZWxzXG4gICAgICAgICAgICBjb25zdCBjdXJyZW50UGwgPSAoXG4gICAgICAgICAgICAgICAgcG93ZXJMZXZlbHMuY29udGVudC51c2VycyAmJiBwb3dlckxldmVscy5jb250ZW50LnVzZXJzW3VzZXJJZF1cbiAgICAgICAgICAgICkgfHwgcG93ZXJMZXZlbHMuY29udGVudC51c2Vyc19kZWZhdWx0IHx8IDA7XG5cbiAgICAgICAgICAgIGlmIChjdXJyZW50UGwgPj0gbGV2ZWwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VuZFJlc3BvbnNlKGV2ZW50LCB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgY2xpZW50LnNldFBvd2VyTGV2ZWwocm9vbUlkLCB1c2VySWQsIGxldmVsLCBuZXcgTWF0cml4RXZlbnQoXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdHlwZTogXCJtLnJvb20ucG93ZXJfbGV2ZWxzXCIsXG4gICAgICAgICAgICAgICAgY29udGVudDogcG93ZXJMZXZlbHMsXG4gICAgICAgICAgICB9LFxuICAgICAgICApKTtcbiAgICAgICAgcmV0dXJuIHNlbmRSZXNwb25zZShldmVudCwge1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHNlbmRFcnJvcihldmVudCwgZXJyLm1lc3NhZ2UgPyBlcnIubWVzc2FnZSA6IF90KCdGYWlsZWQgdG8gc2VuZCByZXF1ZXN0LicpLCBlcnIpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZ2V0TWVtYmVyc2hpcFN0YXRlKGV2ZW50OiBNZXNzYWdlRXZlbnQ8YW55Piwgcm9vbUlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKTogdm9pZCB7XG4gICAgbG9nZ2VyLmxvZyhgbWVtYmVyc2hpcF9zdGF0ZSBvZiAke3VzZXJJZH0gaW4gcm9vbSAke3Jvb21JZH0gcmVxdWVzdGVkLmApO1xuICAgIHJldHVyblN0YXRlRXZlbnQoZXZlbnQsIHJvb21JZCwgXCJtLnJvb20ubWVtYmVyXCIsIHVzZXJJZCk7XG59XG5cbmZ1bmN0aW9uIGdldEpvaW5SdWxlcyhldmVudDogTWVzc2FnZUV2ZW50PGFueT4sIHJvb21JZDogc3RyaW5nKTogdm9pZCB7XG4gICAgbG9nZ2VyLmxvZyhgam9pbl9ydWxlcyBvZiAke3Jvb21JZH0gcmVxdWVzdGVkLmApO1xuICAgIHJldHVyblN0YXRlRXZlbnQoZXZlbnQsIHJvb21JZCwgXCJtLnJvb20uam9pbl9ydWxlc1wiLCBcIlwiKTtcbn1cblxuZnVuY3Rpb24gYm90T3B0aW9ucyhldmVudDogTWVzc2FnZUV2ZW50PGFueT4sIHJvb21JZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZyk6IHZvaWQge1xuICAgIGxvZ2dlci5sb2coYGJvdF9vcHRpb25zIG9mICR7dXNlcklkfSBpbiByb29tICR7cm9vbUlkfSByZXF1ZXN0ZWQuYCk7XG4gICAgcmV0dXJuU3RhdGVFdmVudChldmVudCwgcm9vbUlkLCBcIm0ucm9vbS5ib3Qub3B0aW9uc1wiLCBcIl9cIiArIHVzZXJJZCk7XG59XG5cbmZ1bmN0aW9uIGdldE1lbWJlcnNoaXBDb3VudChldmVudDogTWVzc2FnZUV2ZW50PGFueT4sIHJvb21JZDogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc3QgY2xpZW50ID0gTWF0cml4Q2xpZW50UGVnLmdldCgpO1xuICAgIGlmICghY2xpZW50KSB7XG4gICAgICAgIHNlbmRFcnJvcihldmVudCwgX3QoJ1lvdSBuZWVkIHRvIGJlIGxvZ2dlZCBpbi4nKSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3Qgcm9vbSA9IGNsaWVudC5nZXRSb29tKHJvb21JZCk7XG4gICAgaWYgKCFyb29tKSB7XG4gICAgICAgIHNlbmRFcnJvcihldmVudCwgX3QoJ1RoaXMgcm9vbSBpcyBub3QgcmVjb2duaXNlZC4nKSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgY291bnQgPSByb29tLmdldEpvaW5lZE1lbWJlckNvdW50KCk7XG4gICAgc2VuZFJlc3BvbnNlKGV2ZW50LCBjb3VudCk7XG59XG5cbmZ1bmN0aW9uIGNhblNlbmRFdmVudChldmVudDogTWVzc2FnZUV2ZW50PGFueT4sIHJvb21JZDogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc3QgZXZUeXBlID0gXCJcIiArIGV2ZW50LmRhdGEuZXZlbnRfdHlwZTsgLy8gZm9yY2Ugc3RyaW5naWZ5XG4gICAgY29uc3QgaXNTdGF0ZSA9IEJvb2xlYW4oZXZlbnQuZGF0YS5pc19zdGF0ZSk7XG4gICAgY29uc3QgY2xpZW50ID0gTWF0cml4Q2xpZW50UGVnLmdldCgpO1xuICAgIGlmICghY2xpZW50KSB7XG4gICAgICAgIHNlbmRFcnJvcihldmVudCwgX3QoJ1lvdSBuZWVkIHRvIGJlIGxvZ2dlZCBpbi4nKSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3Qgcm9vbSA9IGNsaWVudC5nZXRSb29tKHJvb21JZCk7XG4gICAgaWYgKCFyb29tKSB7XG4gICAgICAgIHNlbmRFcnJvcihldmVudCwgX3QoJ1RoaXMgcm9vbSBpcyBub3QgcmVjb2duaXNlZC4nKSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHJvb20uZ2V0TXlNZW1iZXJzaGlwKCkgIT09IFwiam9pblwiKSB7XG4gICAgICAgIHNlbmRFcnJvcihldmVudCwgX3QoJ1lvdSBhcmUgbm90IGluIHRoaXMgcm9vbS4nKSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgbWUgPSBjbGllbnQuY3JlZGVudGlhbHMudXNlcklkO1xuXG4gICAgbGV0IGNhblNlbmQgPSBmYWxzZTtcbiAgICBpZiAoaXNTdGF0ZSkge1xuICAgICAgICBjYW5TZW5kID0gcm9vbS5jdXJyZW50U3RhdGUubWF5U2VuZFN0YXRlRXZlbnQoZXZUeXBlLCBtZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY2FuU2VuZCA9IHJvb20uY3VycmVudFN0YXRlLm1heVNlbmRFdmVudChldlR5cGUsIG1lKTtcbiAgICB9XG5cbiAgICBpZiAoIWNhblNlbmQpIHtcbiAgICAgICAgc2VuZEVycm9yKGV2ZW50LCBfdCgnWW91IGRvIG5vdCBoYXZlIHBlcm1pc3Npb24gdG8gZG8gdGhhdCBpbiB0aGlzIHJvb20uJykpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgc2VuZFJlc3BvbnNlKGV2ZW50LCB0cnVlKTtcbn1cblxuZnVuY3Rpb24gcmV0dXJuU3RhdGVFdmVudChldmVudDogTWVzc2FnZUV2ZW50PGFueT4sIHJvb21JZDogc3RyaW5nLCBldmVudFR5cGU6IHN0cmluZywgc3RhdGVLZXk6IHN0cmluZyk6IHZvaWQge1xuICAgIGNvbnN0IGNsaWVudCA9IE1hdHJpeENsaWVudFBlZy5nZXQoKTtcbiAgICBpZiAoIWNsaWVudCkge1xuICAgICAgICBzZW5kRXJyb3IoZXZlbnQsIF90KCdZb3UgbmVlZCB0byBiZSBsb2dnZWQgaW4uJykpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHJvb20gPSBjbGllbnQuZ2V0Um9vbShyb29tSWQpO1xuICAgIGlmICghcm9vbSkge1xuICAgICAgICBzZW5kRXJyb3IoZXZlbnQsIF90KCdUaGlzIHJvb20gaXMgbm90IHJlY29nbmlzZWQuJykpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHN0YXRlRXZlbnQgPSByb29tLmN1cnJlbnRTdGF0ZS5nZXRTdGF0ZUV2ZW50cyhldmVudFR5cGUsIHN0YXRlS2V5KTtcbiAgICBpZiAoIXN0YXRlRXZlbnQpIHtcbiAgICAgICAgc2VuZFJlc3BvbnNlKGV2ZW50LCBudWxsKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBzZW5kUmVzcG9uc2UoZXZlbnQsIHN0YXRlRXZlbnQuZ2V0Q29udGVudCgpKTtcbn1cblxuY29uc3Qgb25NZXNzYWdlID0gZnVuY3Rpb24oZXZlbnQ6IE1lc3NhZ2VFdmVudDxhbnk+KTogdm9pZCB7XG4gICAgaWYgKCFldmVudC5vcmlnaW4pIHsgLy8gc3R1cGlkIGNocm9tZVxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGV2ZW50Lm9yaWdpbiA9IGV2ZW50Lm9yaWdpbmFsRXZlbnQub3JpZ2luO1xuICAgIH1cblxuICAgIC8vIENoZWNrIHRoYXQgdGhlIGludGVncmF0aW9ucyBVSSBVUkwgc3RhcnRzIHdpdGggdGhlIG9yaWdpbiBvZiB0aGUgZXZlbnRcbiAgICAvLyBUaGlzIG1lYW5zIHRoZSBVUkwgY291bGQgY29udGFpbiBhIHBhdGggKGxpa2UgL2RldmVsb3ApIGFuZCBzdGlsbCBiZSB1c2VkXG4gICAgLy8gdG8gdmFsaWRhdGUgZXZlbnQgb3JpZ2lucywgd2hpY2ggZG8gbm90IHNwZWNpZnkgcGF0aHMuXG4gICAgLy8gKFNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvV2luZG93L3Bvc3RNZXNzYWdlKVxuICAgIGxldCBjb25maWdVcmw7XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKCFvcGVuTWFuYWdlclVybCkgb3Blbk1hbmFnZXJVcmwgPSBJbnRlZ3JhdGlvbk1hbmFnZXJzLnNoYXJlZEluc3RhbmNlKCkuZ2V0UHJpbWFyeU1hbmFnZXIoKS51aVVybDtcbiAgICAgICAgY29uZmlnVXJsID0gbmV3IFVSTChvcGVuTWFuYWdlclVybCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAvLyBObyBpbnRlZ3JhdGlvbnMgVUkgVVJMLCBpZ25vcmUgc2lsZW50bHkuXG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgbGV0IGV2ZW50T3JpZ2luVXJsO1xuICAgIHRyeSB7XG4gICAgICAgIGV2ZW50T3JpZ2luVXJsID0gbmV3IFVSTChldmVudC5vcmlnaW4pO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvLyBUT0RPIC0tIFNjYWxhciBwb3N0TWVzc2FnZSBBUEkgc2hvdWxkIGJlIG5hbWVzcGFjZWQgd2l0aCBldmVudC5kYXRhLmFwaSBmaWVsZFxuICAgIC8vIEZpeCBmb2xsb3dpbmcgXCJpZlwiIHN0YXRlbWVudCB0byByZXNwb25kIG9ubHkgdG8gc3BlY2lmaWMgQVBJIG1lc3NhZ2VzLlxuICAgIGlmIChcbiAgICAgICAgY29uZmlnVXJsLm9yaWdpbiAhPT0gZXZlbnRPcmlnaW5Vcmwub3JpZ2luIHx8XG4gICAgICAgICFldmVudC5kYXRhLmFjdGlvbiB8fFxuICAgICAgICBldmVudC5kYXRhLmFwaSAvLyBJZ25vcmUgbWVzc2FnZXMgd2l0aCBzcGVjaWZpYyBBUEkgc2V0XG4gICAgKSB7XG4gICAgICAgIC8vIGRvbid0IGxvZyB0aGlzIC0gZGVidWdnaW5nIEFQSXMgYW5kIGJyb3dzZXIgYWRkLW9ucyBsaWtlIHRvIHNwYW1cbiAgICAgICAgLy8gcG9zdE1lc3NhZ2Ugd2hpY2ggZmxvb2RzIHRoZSBsb2cgb3RoZXJ3aXNlXG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoZXZlbnQuZGF0YS5hY3Rpb24gPT09IEFjdGlvbi5DbG9zZVNjYWxhcikge1xuICAgICAgICBkaXMuZGlzcGF0Y2goeyBhY3Rpb246IEFjdGlvbi5DbG9zZVNjYWxhciB9KTtcbiAgICAgICAgc2VuZFJlc3BvbnNlKGV2ZW50LCBudWxsKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHJvb21JZCA9IGV2ZW50LmRhdGEucm9vbV9pZDtcbiAgICBjb25zdCB1c2VySWQgPSBldmVudC5kYXRhLnVzZXJfaWQ7XG5cbiAgICBpZiAoIXJvb21JZCkge1xuICAgICAgICAvLyBUaGVzZSBBUElzIGRvbid0IHJlcXVpcmUgcm9vbUlkXG4gICAgICAgIC8vIEdldCBhbmQgc2V0IHVzZXIgd2lkZ2V0cyAobm90IGFzc29jaWF0ZWQgd2l0aCBhIHNwZWNpZmljIHJvb20pXG4gICAgICAgIC8vIElmIHJvb21JZCBpcyBzcGVjaWZpZWQsIGl0IG11c3QgYmUgdmFsaWRhdGVkLCBzbyByb29tLWJhc2VkIHdpZGdldHMgYWdyZWVkXG4gICAgICAgIC8vIGhhbmRsZWQgZnVydGhlciBkb3duLlxuICAgICAgICBpZiAoZXZlbnQuZGF0YS5hY3Rpb24gPT09IEFjdGlvbi5HZXRXaWRnZXRzKSB7XG4gICAgICAgICAgICBnZXRXaWRnZXRzKGV2ZW50LCBudWxsKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSBlbHNlIGlmIChldmVudC5kYXRhLmFjdGlvbiA9PT0gQWN0aW9uLlNldFdpZGdldHMpIHtcbiAgICAgICAgICAgIHNldFdpZGdldChldmVudCwgbnVsbCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZW5kRXJyb3IoZXZlbnQsIF90KCdNaXNzaW5nIHJvb21faWQgaW4gcmVxdWVzdCcpKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmIChyb29tSWQgIT09IFJvb21WaWV3U3RvcmUuZ2V0Um9vbUlkKCkpIHtcbiAgICAgICAgc2VuZEVycm9yKGV2ZW50LCBfdCgnUm9vbSAlKHJvb21JZClzIG5vdCB2aXNpYmxlJywgeyByb29tSWQ6IHJvb21JZCB9KSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBHZXQgYW5kIHNldCByb29tLWJhc2VkIHdpZGdldHNcbiAgICBpZiAoZXZlbnQuZGF0YS5hY3Rpb24gPT09IEFjdGlvbi5HZXRXaWRnZXRzKSB7XG4gICAgICAgIGdldFdpZGdldHMoZXZlbnQsIHJvb21JZCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9IGVsc2UgaWYgKGV2ZW50LmRhdGEuYWN0aW9uID09PSBBY3Rpb24uU2V0V2lkZ2V0KSB7XG4gICAgICAgIHNldFdpZGdldChldmVudCwgcm9vbUlkKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFRoZXNlIEFQSXMgZG9uJ3QgcmVxdWlyZSB1c2VySWRcbiAgICBpZiAoZXZlbnQuZGF0YS5hY3Rpb24gPT09IEFjdGlvbi5Kb2luUnVsZXNTdGF0ZSkge1xuICAgICAgICBnZXRKb2luUnVsZXMoZXZlbnQsIHJvb21JZCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9IGVsc2UgaWYgKGV2ZW50LmRhdGEuYWN0aW9uID09PSBBY3Rpb24uU2V0UGx1bWJpbmdTdGF0ZSkge1xuICAgICAgICBzZXRQbHVtYmluZ1N0YXRlKGV2ZW50LCByb29tSWQsIGV2ZW50LmRhdGEuc3RhdHVzKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH0gZWxzZSBpZiAoZXZlbnQuZGF0YS5hY3Rpb24gPT09IEFjdGlvbi5HZXRNZW1iZXJzaGlwQ291bnQpIHtcbiAgICAgICAgZ2V0TWVtYmVyc2hpcENvdW50KGV2ZW50LCByb29tSWQpO1xuICAgICAgICByZXR1cm47XG4gICAgfSBlbHNlIGlmIChldmVudC5kYXRhLmFjdGlvbiA9PT0gQWN0aW9uLkdldFJvb21FbmNyeXB0aW9uU3RhdGUpIHtcbiAgICAgICAgZ2V0Um9vbUVuY1N0YXRlKGV2ZW50LCByb29tSWQpO1xuICAgICAgICByZXR1cm47XG4gICAgfSBlbHNlIGlmIChldmVudC5kYXRhLmFjdGlvbiA9PT0gQWN0aW9uLkNhblNlbmRFdmVudCkge1xuICAgICAgICBjYW5TZW5kRXZlbnQoZXZlbnQsIHJvb21JZCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoIXVzZXJJZCkge1xuICAgICAgICBzZW5kRXJyb3IoZXZlbnQsIF90KCdNaXNzaW5nIHVzZXJfaWQgaW4gcmVxdWVzdCcpKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBzd2l0Y2ggKGV2ZW50LmRhdGEuYWN0aW9uKSB7XG4gICAgICAgIGNhc2UgQWN0aW9uLk1lbWJlcnNoaXBTdGF0ZTpcbiAgICAgICAgICAgIGdldE1lbWJlcnNoaXBTdGF0ZShldmVudCwgcm9vbUlkLCB1c2VySWQpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgQWN0aW9uLmludml0ZTpcbiAgICAgICAgICAgIGludml0ZVVzZXIoZXZlbnQsIHJvb21JZCwgdXNlcklkKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIEFjdGlvbi5Cb3RPcHRpb25zOlxuICAgICAgICAgICAgYm90T3B0aW9ucyhldmVudCwgcm9vbUlkLCB1c2VySWQpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgQWN0aW9uLlNldEJvdE9wdGlvbnM6XG4gICAgICAgICAgICBzZXRCb3RPcHRpb25zKGV2ZW50LCByb29tSWQsIHVzZXJJZCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBBY3Rpb24uU2V0Qm90UG93ZXI6XG4gICAgICAgICAgICBzZXRCb3RQb3dlcihldmVudCwgcm9vbUlkLCB1c2VySWQsIGV2ZW50LmRhdGEubGV2ZWwsIGV2ZW50LmRhdGEuaWdub3JlSWZHcmVhdGVyKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgbG9nZ2VyLndhcm4oXCJVbmhhbmRsZWQgcG9zdE1lc3NhZ2UgZXZlbnQgd2l0aCBhY3Rpb24gJ1wiICsgZXZlbnQuZGF0YS5hY3Rpb24gK1wiJ1wiKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbn07XG5cbmxldCBsaXN0ZW5lckNvdW50ID0gMDtcbmxldCBvcGVuTWFuYWdlclVybDogc3RyaW5nID0gbnVsbDtcblxuZXhwb3J0IGZ1bmN0aW9uIHN0YXJ0TGlzdGVuaW5nKCk6IHZvaWQge1xuICAgIGlmIChsaXN0ZW5lckNvdW50ID09PSAwKSB7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBvbk1lc3NhZ2UsIGZhbHNlKTtcbiAgICB9XG4gICAgbGlzdGVuZXJDb3VudCArPSAxO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc3RvcExpc3RlbmluZygpOiB2b2lkIHtcbiAgICBsaXN0ZW5lckNvdW50IC09IDE7XG4gICAgaWYgKGxpc3RlbmVyQ291bnQgPT09IDApIHtcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIG9uTWVzc2FnZSk7XG4gICAgfVxuICAgIGlmIChsaXN0ZW5lckNvdW50IDwgMCkge1xuICAgICAgICAvLyBNYWtlIGFuIGVycm9yIHNvIHdlIGdldCBhIHN0YWNrIHRyYWNlXG4gICAgICAgIGNvbnN0IGUgPSBuZXcgRXJyb3IoXG4gICAgICAgICAgICBcIlNjYWxhck1lc3NhZ2luZzogbWlzbWF0Y2hlZCBzdGFydExpc3RlbmluZyAvIHN0b3BMaXN0ZW5pbmcgZGV0ZWN0ZWQuXCIgK1xuICAgICAgICAgICAgXCIgTmVnYXRpdmUgY291bnRcIixcbiAgICAgICAgKTtcbiAgICAgICAgbG9nZ2VyLmVycm9yKGUpO1xuICAgIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldE9wZW5NYW5hZ2VyVXJsKHVybDogc3RyaW5nKTogdm9pZCB7XG4gICAgb3Blbk1hbmFnZXJVcmwgPSB1cmw7XG59XG4iXX0=