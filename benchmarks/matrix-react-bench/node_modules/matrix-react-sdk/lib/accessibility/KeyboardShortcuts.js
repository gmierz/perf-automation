"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.toggleDialog = exports.registerShortcut = exports.Modifiers = exports.DIGITS = exports.Categories = exports.CMD_OR_CTRL = void 0;

var React = _interopRequireWildcard(require("react"));

var _classnames = _interopRequireDefault(require("classnames"));

var _Modal = _interopRequireDefault(require("../Modal"));

var _languageHandler = require("../languageHandler");

var _Keyboard = require("../Keyboard");

var _InfoDialog = _interopRequireDefault(require("../components/views/dialogs/InfoDialog"));

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

/*
Copyright 2020 The Matrix.org Foundation C.I.C.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
// TS: once languageHandler is TS we can probably inline this into the enum
(0, _languageHandler._td)("Navigation");
(0, _languageHandler._td)("Calls");
(0, _languageHandler._td)("Composer");
(0, _languageHandler._td)("Room List");
(0, _languageHandler._td)("Autocomplete");
let Categories; // TS: once languageHandler is TS we can probably inline this into the enum

exports.Categories = Categories;

(function (Categories) {
  Categories["NAVIGATION"] = "Navigation";
  Categories["CALLS"] = "Calls";
  Categories["COMPOSER"] = "Composer";
  Categories["ROOM_LIST"] = "Room List";
  Categories["ROOM"] = "Room";
  Categories["AUTOCOMPLETE"] = "Autocomplete";
})(Categories || (exports.Categories = Categories = {}));

(0, _languageHandler._td)("Alt");
(0, _languageHandler._td)("Alt Gr");
(0, _languageHandler._td)("Shift");
(0, _languageHandler._td)("Super");
(0, _languageHandler._td)("Ctrl");
let Modifiers; // Meta-modifier: isMac ? CMD : CONTROL

exports.Modifiers = Modifiers;

(function (Modifiers) {
  Modifiers["ALT"] = "Alt";
  Modifiers["ALT_GR"] = "Alt Gr";
  Modifiers["SHIFT"] = "Shift";
  Modifiers["SUPER"] = "Super";
  Modifiers["COMMAND"] = "Command";
  Modifiers["CONTROL"] = "Ctrl";
})(Modifiers || (exports.Modifiers = Modifiers = {}));

const CMD_OR_CTRL = _Keyboard.isMac ? Modifiers.COMMAND : Modifiers.CONTROL; // Meta-key representing the digits [0-9] often found at the top of standard keyboard layouts

exports.CMD_OR_CTRL = CMD_OR_CTRL;
const DIGITS = "digits";
exports.DIGITS = DIGITS;
const shortcuts = {
  [Categories.COMPOSER]: [{
    keybinds: [{
      modifiers: [CMD_OR_CTRL],
      key: _Keyboard.Key.B
    }],
    description: (0, _languageHandler._td)("Toggle Bold")
  }, {
    keybinds: [{
      modifiers: [CMD_OR_CTRL],
      key: _Keyboard.Key.I
    }],
    description: (0, _languageHandler._td)("Toggle Italics")
  }, {
    keybinds: [{
      modifiers: [CMD_OR_CTRL],
      key: _Keyboard.Key.GREATER_THAN
    }],
    description: (0, _languageHandler._td)("Toggle Quote")
  }, {
    keybinds: [{
      modifiers: [Modifiers.SHIFT],
      key: _Keyboard.Key.ENTER
    }],
    description: (0, _languageHandler._td)("New line")
  }, {
    keybinds: [{
      key: _Keyboard.Key.ARROW_UP
    }, {
      key: _Keyboard.Key.ARROW_DOWN
    }],
    description: (0, _languageHandler._td)("Navigate recent messages to edit")
  }, {
    keybinds: [{
      modifiers: [CMD_OR_CTRL],
      key: _Keyboard.Key.HOME
    }, {
      modifiers: [CMD_OR_CTRL],
      key: _Keyboard.Key.END
    }],
    description: (0, _languageHandler._td)("Jump to start/end of the composer")
  }, {
    keybinds: [{
      modifiers: [Modifiers.CONTROL, Modifiers.ALT],
      key: _Keyboard.Key.ARROW_UP
    }, {
      modifiers: [Modifiers.CONTROL, Modifiers.ALT],
      key: _Keyboard.Key.ARROW_DOWN
    }],
    description: (0, _languageHandler._td)("Navigate composer history")
  }, {
    keybinds: [{
      key: _Keyboard.Key.ESCAPE
    }],
    description: (0, _languageHandler._td)("Cancel replying to a message")
  }],
  [Categories.CALLS]: [{
    keybinds: [{
      modifiers: [CMD_OR_CTRL],
      key: _Keyboard.Key.D
    }],
    description: (0, _languageHandler._td)("Toggle microphone mute")
  }, {
    keybinds: [{
      modifiers: [CMD_OR_CTRL],
      key: _Keyboard.Key.E
    }],
    description: (0, _languageHandler._td)("Toggle video on/off")
  }],
  [Categories.ROOM]: [{
    keybinds: [{
      key: _Keyboard.Key.PAGE_UP
    }, {
      key: _Keyboard.Key.PAGE_DOWN
    }],
    description: (0, _languageHandler._td)("Scroll up/down in the timeline")
  }, {
    keybinds: [{
      key: _Keyboard.Key.ESCAPE
    }],
    description: (0, _languageHandler._td)("Dismiss read marker and jump to bottom")
  }, {
    keybinds: [{
      modifiers: [Modifiers.SHIFT],
      key: _Keyboard.Key.PAGE_UP
    }],
    description: (0, _languageHandler._td)("Jump to oldest unread message")
  }, {
    keybinds: [{
      modifiers: [CMD_OR_CTRL, Modifiers.SHIFT],
      key: _Keyboard.Key.U
    }],
    description: (0, _languageHandler._td)("Upload a file")
  }, {
    keybinds: [{
      modifiers: [CMD_OR_CTRL],
      key: _Keyboard.Key.F
    }],
    description: (0, _languageHandler._td)("Search (must be enabled)")
  }],
  [Categories.ROOM_LIST]: [{
    keybinds: [{
      modifiers: [CMD_OR_CTRL],
      key: _Keyboard.Key.K
    }],
    description: (0, _languageHandler._td)("Jump to room search")
  }, {
    keybinds: [{
      key: _Keyboard.Key.ARROW_UP
    }, {
      key: _Keyboard.Key.ARROW_DOWN
    }],
    description: (0, _languageHandler._td)("Navigate up/down in the room list")
  }, {
    keybinds: [{
      key: _Keyboard.Key.ENTER
    }],
    description: (0, _languageHandler._td)("Select room from the room list")
  }, {
    keybinds: [{
      key: _Keyboard.Key.ARROW_LEFT
    }],
    description: (0, _languageHandler._td)("Collapse room list section")
  }, {
    keybinds: [{
      key: _Keyboard.Key.ARROW_RIGHT
    }],
    description: (0, _languageHandler._td)("Expand room list section")
  }, {
    keybinds: [{
      key: _Keyboard.Key.ESCAPE
    }],
    description: (0, _languageHandler._td)("Clear room list filter field")
  }],
  [Categories.NAVIGATION]: [{
    keybinds: [{
      modifiers: [Modifiers.ALT, Modifiers.SHIFT],
      key: _Keyboard.Key.ARROW_UP
    }, {
      modifiers: [Modifiers.ALT, Modifiers.SHIFT],
      key: _Keyboard.Key.ARROW_DOWN
    }],
    description: (0, _languageHandler._td)("Previous/next unread room or DM")
  }, {
    keybinds: [{
      modifiers: [Modifiers.ALT],
      key: _Keyboard.Key.ARROW_UP
    }, {
      modifiers: [Modifiers.ALT],
      key: _Keyboard.Key.ARROW_DOWN
    }],
    description: (0, _languageHandler._td)("Previous/next room or DM")
  }, {
    keybinds: [{
      modifiers: [CMD_OR_CTRL],
      key: _Keyboard.Key.BACKTICK
    }],
    description: (0, _languageHandler._td)("Toggle the top left menu")
  }, {
    keybinds: [{
      key: _Keyboard.Key.ESCAPE
    }],
    description: (0, _languageHandler._td)("Close dialog or context menu")
  }, {
    keybinds: [{
      key: _Keyboard.Key.ENTER
    }, {
      key: _Keyboard.Key.SPACE
    }],
    description: (0, _languageHandler._td)("Activate selected button")
  }, {
    keybinds: [{
      modifiers: [CMD_OR_CTRL],
      key: _Keyboard.Key.PERIOD
    }],
    description: (0, _languageHandler._td)("Toggle right panel")
  }, {
    keybinds: [{
      modifiers: [CMD_OR_CTRL],
      key: _Keyboard.Key.SLASH
    }],
    description: (0, _languageHandler._td)("Toggle this dialog")
  }, {
    keybinds: [{
      modifiers: [Modifiers.CONTROL, _Keyboard.isMac ? Modifiers.SHIFT : Modifiers.ALT],
      key: _Keyboard.Key.H
    }],
    description: (0, _languageHandler._td)("Go to Home View")
  }],
  [Categories.AUTOCOMPLETE]: [{
    keybinds: [{
      key: _Keyboard.Key.ARROW_UP
    }, {
      key: _Keyboard.Key.ARROW_DOWN
    }],
    description: (0, _languageHandler._td)("Move autocomplete selection up/down")
  }, {
    keybinds: [{
      key: _Keyboard.Key.ESCAPE
    }],
    description: (0, _languageHandler._td)("Cancel autocomplete")
  }]
};
const categoryOrder = [Categories.COMPOSER, Categories.AUTOCOMPLETE, Categories.ROOM, Categories.ROOM_LIST, Categories.NAVIGATION, Categories.CALLS];
const modifierIcon = {
  [Modifiers.COMMAND]: "⌘"
};

if (_Keyboard.isMac) {
  modifierIcon[Modifiers.ALT] = "⌥";
}

const alternateKeyName = {
  [_Keyboard.Key.PAGE_UP]: (0, _languageHandler._td)("Page Up"),
  [_Keyboard.Key.PAGE_DOWN]: (0, _languageHandler._td)("Page Down"),
  [_Keyboard.Key.ESCAPE]: (0, _languageHandler._td)("Esc"),
  [_Keyboard.Key.ENTER]: (0, _languageHandler._td)("Enter"),
  [_Keyboard.Key.SPACE]: (0, _languageHandler._td)("Space"),
  [_Keyboard.Key.HOME]: (0, _languageHandler._td)("Home"),
  [_Keyboard.Key.END]: (0, _languageHandler._td)("End"),
  [DIGITS]: (0, _languageHandler._td)("[number]")
};
const keyIcon = {
  [_Keyboard.Key.ARROW_UP]: "↑",
  [_Keyboard.Key.ARROW_DOWN]: "↓",
  [_Keyboard.Key.ARROW_LEFT]: "←",
  [_Keyboard.Key.ARROW_RIGHT]: "→"
};

const Shortcut = ({
  shortcut
}) => {
  const classes = (0, _classnames.default)({
    "mx_KeyboardShortcutsDialog_inline": shortcut.keybinds.every(k => !k.modifiers || k.modifiers.length === 0)
  });
  return /*#__PURE__*/React.createElement("div", {
    className: classes
  }, /*#__PURE__*/React.createElement("h5", null, (0, _languageHandler._t)(shortcut.description)), shortcut.keybinds.map(s => {
    let text = s.key;

    if (alternateKeyName[s.key]) {
      text = (0, _languageHandler._t)(alternateKeyName[s.key]);
    } else if (keyIcon[s.key]) {
      text = keyIcon[s.key];
    }

    return /*#__PURE__*/React.createElement("div", {
      key: s.key
    }, s.modifiers && s.modifiers.map(m => {
      return /*#__PURE__*/React.createElement(React.Fragment, {
        key: m
      }, /*#__PURE__*/React.createElement("kbd", null, modifierIcon[m] || (0, _languageHandler._t)(m)), "+");
    }), /*#__PURE__*/React.createElement("kbd", null, text));
  }));
};

let activeModal = null;

const toggleDialog = () => {
  if (activeModal) {
    activeModal.close();
    activeModal = null;
    return;
  }

  const sections = categoryOrder.map(category => {
    const list = shortcuts[category];
    return /*#__PURE__*/React.createElement("div", {
      className: "mx_KeyboardShortcutsDialog_category",
      key: category
    }, /*#__PURE__*/React.createElement("h3", null, (0, _languageHandler._t)(category)), /*#__PURE__*/React.createElement("div", null, list.map(shortcut => /*#__PURE__*/React.createElement(Shortcut, {
      key: shortcut.description,
      shortcut: shortcut
    }))));
  });
  activeModal = _Modal.default.createTrackedDialog("Keyboard Shortcuts", "", _InfoDialog.default, {
    className: "mx_KeyboardShortcutsDialog",
    title: (0, _languageHandler._t)("Keyboard Shortcuts"),
    description: sections,
    hasCloseButton: true,
    onKeyDown: ev => {
      if (ev.ctrlKey && !ev.shiftKey && !ev.altKey && !ev.metaKey && ev.key === _Keyboard.Key.SLASH) {
        // Ctrl + /
        ev.stopPropagation();
        activeModal.close();
      }
    },
    onFinished: () => {
      activeModal = null;
    }
  });
};

exports.toggleDialog = toggleDialog;

const registerShortcut = (category, defn) => {
  shortcuts[category].push(defn);
};

exports.registerShortcut = registerShortcut;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9hY2Nlc3NpYmlsaXR5L0tleWJvYXJkU2hvcnRjdXRzLnRzeCJdLCJuYW1lcyI6WyJDYXRlZ29yaWVzIiwiTW9kaWZpZXJzIiwiQ01EX09SX0NUUkwiLCJpc01hYyIsIkNPTU1BTkQiLCJDT05UUk9MIiwiRElHSVRTIiwic2hvcnRjdXRzIiwiQ09NUE9TRVIiLCJrZXliaW5kcyIsIm1vZGlmaWVycyIsImtleSIsIktleSIsIkIiLCJkZXNjcmlwdGlvbiIsIkkiLCJHUkVBVEVSX1RIQU4iLCJTSElGVCIsIkVOVEVSIiwiQVJST1dfVVAiLCJBUlJPV19ET1dOIiwiSE9NRSIsIkVORCIsIkFMVCIsIkVTQ0FQRSIsIkNBTExTIiwiRCIsIkUiLCJST09NIiwiUEFHRV9VUCIsIlBBR0VfRE9XTiIsIlUiLCJGIiwiUk9PTV9MSVNUIiwiSyIsIkFSUk9XX0xFRlQiLCJBUlJPV19SSUdIVCIsIk5BVklHQVRJT04iLCJCQUNLVElDSyIsIlNQQUNFIiwiUEVSSU9EIiwiU0xBU0giLCJIIiwiQVVUT0NPTVBMRVRFIiwiY2F0ZWdvcnlPcmRlciIsIm1vZGlmaWVySWNvbiIsImFsdGVybmF0ZUtleU5hbWUiLCJrZXlJY29uIiwiU2hvcnRjdXQiLCJzaG9ydGN1dCIsImNsYXNzZXMiLCJldmVyeSIsImsiLCJsZW5ndGgiLCJtYXAiLCJzIiwidGV4dCIsIm0iLCJhY3RpdmVNb2RhbCIsInRvZ2dsZURpYWxvZyIsImNsb3NlIiwic2VjdGlvbnMiLCJjYXRlZ29yeSIsImxpc3QiLCJNb2RhbCIsImNyZWF0ZVRyYWNrZWREaWFsb2ciLCJJbmZvRGlhbG9nIiwiY2xhc3NOYW1lIiwidGl0bGUiLCJoYXNDbG9zZUJ1dHRvbiIsIm9uS2V5RG93biIsImV2IiwiY3RybEtleSIsInNoaWZ0S2V5IiwiYWx0S2V5IiwibWV0YUtleSIsInN0b3BQcm9wYWdhdGlvbiIsIm9uRmluaXNoZWQiLCJyZWdpc3RlclNob3J0Y3V0IiwiZGVmbiIsInB1c2giXSwibWFwcGluZ3MiOiI7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QUFDRixFQUFFLENBQUNHLE1BQWxDLElBQTRDLENBQUNILEVBQUUsQ0FBQ0ksT0FBaEQsSUFBMkRKLEVBQUUsQ0FBQzVELEdBQUgsS0FBV0MsY0FBSTZCLEtBQTlFLEVBQXFGO0FBQUU7QUFDbkY4QixRQUFBQSxFQUFFLENBQUNLLGVBQUg7QUFDQWxCLFFBQUFBLFdBQVcsQ0FBQ0UsS0FBWjtBQUNIO0FBQ0osS0FWeUU7QUFXMUVpQixJQUFBQSxVQUFVLEVBQUUsTUFBTTtBQUNkbkIsTUFBQUEsV0FBVyxHQUFHLElBQWQ7QUFDSDtBQWJ5RSxHQUFoRSxDQUFkO0FBZUgsQ0E5Qk07Ozs7QUFnQ0EsTUFBTW9CLGdCQUFnQixHQUFHLENBQUNoQixRQUFELEVBQXVCaUIsSUFBdkIsS0FBMkM7QUFDdkV4RSxFQUFBQSxTQUFTLENBQUN1RCxRQUFELENBQVQsQ0FBb0JrQixJQUFwQixDQUF5QkQsSUFBekI7QUFDSCxDQUZNIiwic291cmNlc0NvbnRlbnQiOlsiLypcbkNvcHlyaWdodCAyMDIwIFRoZSBNYXRyaXgub3JnIEZvdW5kYXRpb24gQy5JLkMuXG5cbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG55b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG5Zb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcblxuICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuXG5Vbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG5kaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG5XSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cblNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbmxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuKi9cblxuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgY2xhc3NOYW1lcyBmcm9tIFwiY2xhc3NuYW1lc1wiO1xuXG5pbXBvcnQgTW9kYWwgZnJvbSBcIi4uL01vZGFsXCI7XG5pbXBvcnQgeyBfdCwgX3RkIH0gZnJvbSBcIi4uL2xhbmd1YWdlSGFuZGxlclwiO1xuaW1wb3J0IHsgaXNNYWMsIEtleSB9IGZyb20gXCIuLi9LZXlib2FyZFwiO1xuaW1wb3J0IEluZm9EaWFsb2cgZnJvbSBcIi4uL2NvbXBvbmVudHMvdmlld3MvZGlhbG9ncy9JbmZvRGlhbG9nXCI7XG5cbi8vIFRTOiBvbmNlIGxhbmd1YWdlSGFuZGxlciBpcyBUUyB3ZSBjYW4gcHJvYmFibHkgaW5saW5lIHRoaXMgaW50byB0aGUgZW51bVxuX3RkKFwiTmF2aWdhdGlvblwiKTtcbl90ZChcIkNhbGxzXCIpO1xuX3RkKFwiQ29tcG9zZXJcIik7XG5fdGQoXCJSb29tIExpc3RcIik7XG5fdGQoXCJBdXRvY29tcGxldGVcIik7XG5cbmV4cG9ydCBlbnVtIENhdGVnb3JpZXMge1xuICAgIE5BVklHQVRJT04gPSBcIk5hdmlnYXRpb25cIixcbiAgICBDQUxMUyA9IFwiQ2FsbHNcIixcbiAgICBDT01QT1NFUiA9IFwiQ29tcG9zZXJcIixcbiAgICBST09NX0xJU1QgPSBcIlJvb20gTGlzdFwiLFxuICAgIFJPT00gPSBcIlJvb21cIixcbiAgICBBVVRPQ09NUExFVEUgPSBcIkF1dG9jb21wbGV0ZVwiLFxufVxuXG4vLyBUUzogb25jZSBsYW5ndWFnZUhhbmRsZXIgaXMgVFMgd2UgY2FuIHByb2JhYmx5IGlubGluZSB0aGlzIGludG8gdGhlIGVudW1cbl90ZChcIkFsdFwiKTtcbl90ZChcIkFsdCBHclwiKTtcbl90ZChcIlNoaWZ0XCIpO1xuX3RkKFwiU3VwZXJcIik7XG5fdGQoXCJDdHJsXCIpO1xuXG5leHBvcnQgZW51bSBNb2RpZmllcnMge1xuICAgIEFMVCA9IFwiQWx0XCIsIC8vIE9wdGlvbiBvbiBNYWMgYW5kIGRpc3BsYXllZCBhcyBhbiBJY29uXG4gICAgQUxUX0dSID0gXCJBbHQgR3JcIixcbiAgICBTSElGVCA9IFwiU2hpZnRcIixcbiAgICBTVVBFUiA9IFwiU3VwZXJcIiwgLy8gc2hvdWxkIHRoaXMgYmUgXCJXaW5kb3dzXCI/XG4gICAgLy8gSW5zdGVhZCBvZiB1c2luZyBiZWxvdywgY29uc2lkZXIgQ01EX09SX0NUUkxcbiAgICBDT01NQU5EID0gXCJDb21tYW5kXCIsIC8vIFRoaXMgZ2V0cyBkaXNwbGF5ZWQgYXMgYW4gSWNvblxuICAgIENPTlRST0wgPSBcIkN0cmxcIixcbn1cblxuLy8gTWV0YS1tb2RpZmllcjogaXNNYWMgPyBDTUQgOiBDT05UUk9MXG5leHBvcnQgY29uc3QgQ01EX09SX0NUUkwgPSBpc01hYyA/IE1vZGlmaWVycy5DT01NQU5EIDogTW9kaWZpZXJzLkNPTlRST0w7XG4vLyBNZXRhLWtleSByZXByZXNlbnRpbmcgdGhlIGRpZ2l0cyBbMC05XSBvZnRlbiBmb3VuZCBhdCB0aGUgdG9wIG9mIHN0YW5kYXJkIGtleWJvYXJkIGxheW91dHNcbmV4cG9ydCBjb25zdCBESUdJVFMgPSBcImRpZ2l0c1wiO1xuXG5pbnRlcmZhY2UgSUtleWJpbmQge1xuICAgIG1vZGlmaWVycz86IE1vZGlmaWVyc1tdO1xuICAgIGtleTogc3RyaW5nOyAvLyBUUzogZml4IHRoaXMgb25jZSBLZXkgaXMgYW4gZW51bVxufVxuXG5pbnRlcmZhY2UgSVNob3J0Y3V0IHtcbiAgICBrZXliaW5kczogSUtleWJpbmRbXTtcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xufVxuXG5jb25zdCBzaG9ydGN1dHM6IFJlY29yZDxDYXRlZ29yaWVzLCBJU2hvcnRjdXRbXT4gPSB7XG4gICAgW0NhdGVnb3JpZXMuQ09NUE9TRVJdOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleWJpbmRzOiBbe1xuICAgICAgICAgICAgICAgIG1vZGlmaWVyczogW0NNRF9PUl9DVFJMXSxcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5CLFxuICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogX3RkKFwiVG9nZ2xlIEJvbGRcIiksXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleWJpbmRzOiBbe1xuICAgICAgICAgICAgICAgIG1vZGlmaWVyczogW0NNRF9PUl9DVFJMXSxcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5JLFxuICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogX3RkKFwiVG9nZ2xlIEl0YWxpY3NcIiksXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleWJpbmRzOiBbe1xuICAgICAgICAgICAgICAgIG1vZGlmaWVyczogW0NNRF9PUl9DVFJMXSxcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5HUkVBVEVSX1RIQU4sXG4gICAgICAgICAgICB9XSxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBfdGQoXCJUb2dnbGUgUXVvdGVcIiksXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleWJpbmRzOiBbe1xuICAgICAgICAgICAgICAgIG1vZGlmaWVyczogW01vZGlmaWVycy5TSElGVF0sXG4gICAgICAgICAgICAgICAga2V5OiBLZXkuRU5URVIsXG4gICAgICAgICAgICB9XSxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBfdGQoXCJOZXcgbGluZVwiKSxcbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5YmluZHM6IFt7XG4gICAgICAgICAgICAgICAga2V5OiBLZXkuQVJST1dfVVAsXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAga2V5OiBLZXkuQVJST1dfRE9XTixcbiAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IF90ZChcIk5hdmlnYXRlIHJlY2VudCBtZXNzYWdlcyB0byBlZGl0XCIpLFxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXliaW5kczogW3tcbiAgICAgICAgICAgICAgICBtb2RpZmllcnM6IFtDTURfT1JfQ1RSTF0sXG4gICAgICAgICAgICAgICAga2V5OiBLZXkuSE9NRSxcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBtb2RpZmllcnM6IFtDTURfT1JfQ1RSTF0sXG4gICAgICAgICAgICAgICAga2V5OiBLZXkuRU5ELFxuICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogX3RkKFwiSnVtcCB0byBzdGFydC9lbmQgb2YgdGhlIGNvbXBvc2VyXCIpLFxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXliaW5kczogW3tcbiAgICAgICAgICAgICAgICBtb2RpZmllcnM6IFtNb2RpZmllcnMuQ09OVFJPTCwgTW9kaWZpZXJzLkFMVF0sXG4gICAgICAgICAgICAgICAga2V5OiBLZXkuQVJST1dfVVAsXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgbW9kaWZpZXJzOiBbTW9kaWZpZXJzLkNPTlRST0wsIE1vZGlmaWVycy5BTFRdLFxuICAgICAgICAgICAgICAgIGtleTogS2V5LkFSUk9XX0RPV04sXG4gICAgICAgICAgICB9XSxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBfdGQoXCJOYXZpZ2F0ZSBjb21wb3NlciBoaXN0b3J5XCIpLFxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXliaW5kczogW3tcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5FU0NBUEUsXG4gICAgICAgICAgICB9XSxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBfdGQoXCJDYW5jZWwgcmVwbHlpbmcgdG8gYSBtZXNzYWdlXCIpLFxuICAgICAgICB9LFxuICAgIF0sXG5cbiAgICBbQ2F0ZWdvcmllcy5DQUxMU106IFtcbiAgICAgICAge1xuICAgICAgICAgICAga2V5YmluZHM6IFt7XG4gICAgICAgICAgICAgICAgbW9kaWZpZXJzOiBbQ01EX09SX0NUUkxdLFxuICAgICAgICAgICAgICAgIGtleTogS2V5LkQsXG4gICAgICAgICAgICB9XSxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBfdGQoXCJUb2dnbGUgbWljcm9waG9uZSBtdXRlXCIpLFxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXliaW5kczogW3tcbiAgICAgICAgICAgICAgICBtb2RpZmllcnM6IFtDTURfT1JfQ1RSTF0sXG4gICAgICAgICAgICAgICAga2V5OiBLZXkuRSxcbiAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IF90ZChcIlRvZ2dsZSB2aWRlbyBvbi9vZmZcIiksXG4gICAgICAgIH0sXG4gICAgXSxcblxuICAgIFtDYXRlZ29yaWVzLlJPT01dOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGtleWJpbmRzOiBbe1xuICAgICAgICAgICAgICAgIGtleTogS2V5LlBBR0VfVVAsXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAga2V5OiBLZXkuUEFHRV9ET1dOLFxuICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogX3RkKFwiU2Nyb2xsIHVwL2Rvd24gaW4gdGhlIHRpbWVsaW5lXCIpLFxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXliaW5kczogW3tcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5FU0NBUEUsXG4gICAgICAgICAgICB9XSxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBfdGQoXCJEaXNtaXNzIHJlYWQgbWFya2VyIGFuZCBqdW1wIHRvIGJvdHRvbVwiKSxcbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5YmluZHM6IFt7XG4gICAgICAgICAgICAgICAgbW9kaWZpZXJzOiBbTW9kaWZpZXJzLlNISUZUXSxcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5QQUdFX1VQLFxuICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogX3RkKFwiSnVtcCB0byBvbGRlc3QgdW5yZWFkIG1lc3NhZ2VcIiksXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleWJpbmRzOiBbe1xuICAgICAgICAgICAgICAgIG1vZGlmaWVyczogW0NNRF9PUl9DVFJMLCBNb2RpZmllcnMuU0hJRlRdLFxuICAgICAgICAgICAgICAgIGtleTogS2V5LlUsXG4gICAgICAgICAgICB9XSxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBfdGQoXCJVcGxvYWQgYSBmaWxlXCIpLFxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXliaW5kczogW3tcbiAgICAgICAgICAgICAgICBtb2RpZmllcnM6IFtDTURfT1JfQ1RSTF0sXG4gICAgICAgICAgICAgICAga2V5OiBLZXkuRixcbiAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IF90ZChcIlNlYXJjaCAobXVzdCBiZSBlbmFibGVkKVwiKSxcbiAgICAgICAgfSxcbiAgICBdLFxuXG4gICAgW0NhdGVnb3JpZXMuUk9PTV9MSVNUXTogW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXliaW5kczogW3tcbiAgICAgICAgICAgICAgICBtb2RpZmllcnM6IFtDTURfT1JfQ1RSTF0sXG4gICAgICAgICAgICAgICAga2V5OiBLZXkuSyxcbiAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IF90ZChcIkp1bXAgdG8gcm9vbSBzZWFyY2hcIiksXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleWJpbmRzOiBbe1xuICAgICAgICAgICAgICAgIGtleTogS2V5LkFSUk9XX1VQLFxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIGtleTogS2V5LkFSUk9XX0RPV04sXG4gICAgICAgICAgICB9XSxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBfdGQoXCJOYXZpZ2F0ZSB1cC9kb3duIGluIHRoZSByb29tIGxpc3RcIiksXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleWJpbmRzOiBbe1xuICAgICAgICAgICAgICAgIGtleTogS2V5LkVOVEVSLFxuICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogX3RkKFwiU2VsZWN0IHJvb20gZnJvbSB0aGUgcm9vbSBsaXN0XCIpLFxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXliaW5kczogW3tcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5BUlJPV19MRUZULFxuICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogX3RkKFwiQ29sbGFwc2Ugcm9vbSBsaXN0IHNlY3Rpb25cIiksXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleWJpbmRzOiBbe1xuICAgICAgICAgICAgICAgIGtleTogS2V5LkFSUk9XX1JJR0hULFxuICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogX3RkKFwiRXhwYW5kIHJvb20gbGlzdCBzZWN0aW9uXCIpLFxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXliaW5kczogW3tcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5FU0NBUEUsXG4gICAgICAgICAgICB9XSxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBfdGQoXCJDbGVhciByb29tIGxpc3QgZmlsdGVyIGZpZWxkXCIpLFxuICAgICAgICB9LFxuICAgIF0sXG5cbiAgICBbQ2F0ZWdvcmllcy5OQVZJR0FUSU9OXTogW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXliaW5kczogW3tcbiAgICAgICAgICAgICAgICBtb2RpZmllcnM6IFtNb2RpZmllcnMuQUxULCBNb2RpZmllcnMuU0hJRlRdLFxuICAgICAgICAgICAgICAgIGtleTogS2V5LkFSUk9XX1VQLFxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIG1vZGlmaWVyczogW01vZGlmaWVycy5BTFQsIE1vZGlmaWVycy5TSElGVF0sXG4gICAgICAgICAgICAgICAga2V5OiBLZXkuQVJST1dfRE9XTixcbiAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IF90ZChcIlByZXZpb3VzL25leHQgdW5yZWFkIHJvb20gb3IgRE1cIiksXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleWJpbmRzOiBbe1xuICAgICAgICAgICAgICAgIG1vZGlmaWVyczogW01vZGlmaWVycy5BTFRdLFxuICAgICAgICAgICAgICAgIGtleTogS2V5LkFSUk9XX1VQLFxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIG1vZGlmaWVyczogW01vZGlmaWVycy5BTFRdLFxuICAgICAgICAgICAgICAgIGtleTogS2V5LkFSUk9XX0RPV04sXG4gICAgICAgICAgICB9XSxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBfdGQoXCJQcmV2aW91cy9uZXh0IHJvb20gb3IgRE1cIiksXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleWJpbmRzOiBbe1xuICAgICAgICAgICAgICAgIG1vZGlmaWVyczogW0NNRF9PUl9DVFJMXSxcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5CQUNLVElDSyxcbiAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IF90ZChcIlRvZ2dsZSB0aGUgdG9wIGxlZnQgbWVudVwiKSxcbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5YmluZHM6IFt7XG4gICAgICAgICAgICAgICAga2V5OiBLZXkuRVNDQVBFLFxuICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogX3RkKFwiQ2xvc2UgZGlhbG9nIG9yIGNvbnRleHQgbWVudVwiKSxcbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5YmluZHM6IFt7XG4gICAgICAgICAgICAgICAga2V5OiBLZXkuRU5URVIsXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAga2V5OiBLZXkuU1BBQ0UsXG4gICAgICAgICAgICB9XSxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBfdGQoXCJBY3RpdmF0ZSBzZWxlY3RlZCBidXR0b25cIiksXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleWJpbmRzOiBbe1xuICAgICAgICAgICAgICAgIG1vZGlmaWVyczogW0NNRF9PUl9DVFJMXSxcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5QRVJJT0QsXG4gICAgICAgICAgICB9XSxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBfdGQoXCJUb2dnbGUgcmlnaHQgcGFuZWxcIiksXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleWJpbmRzOiBbe1xuICAgICAgICAgICAgICAgIG1vZGlmaWVyczogW0NNRF9PUl9DVFJMXSxcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5TTEFTSCxcbiAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IF90ZChcIlRvZ2dsZSB0aGlzIGRpYWxvZ1wiKSxcbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5YmluZHM6IFt7XG4gICAgICAgICAgICAgICAgbW9kaWZpZXJzOiBbTW9kaWZpZXJzLkNPTlRST0wsIGlzTWFjID8gTW9kaWZpZXJzLlNISUZUIDogTW9kaWZpZXJzLkFMVF0sXG4gICAgICAgICAgICAgICAga2V5OiBLZXkuSCxcbiAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IF90ZChcIkdvIHRvIEhvbWUgVmlld1wiKSxcbiAgICAgICAgfSxcbiAgICBdLFxuXG4gICAgW0NhdGVnb3JpZXMuQVVUT0NPTVBMRVRFXTogW1xuICAgICAgICB7XG4gICAgICAgICAgICBrZXliaW5kczogW3tcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5BUlJPV19VUCxcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBrZXk6IEtleS5BUlJPV19ET1dOLFxuICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogX3RkKFwiTW92ZSBhdXRvY29tcGxldGUgc2VsZWN0aW9uIHVwL2Rvd25cIiksXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleWJpbmRzOiBbe1xuICAgICAgICAgICAgICAgIGtleTogS2V5LkVTQ0FQRSxcbiAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IF90ZChcIkNhbmNlbCBhdXRvY29tcGxldGVcIiksXG4gICAgICAgIH0sXG4gICAgXSxcbn07XG5cbmNvbnN0IGNhdGVnb3J5T3JkZXIgPSBbXG4gICAgQ2F0ZWdvcmllcy5DT01QT1NFUixcbiAgICBDYXRlZ29yaWVzLkFVVE9DT01QTEVURSxcbiAgICBDYXRlZ29yaWVzLlJPT00sXG4gICAgQ2F0ZWdvcmllcy5ST09NX0xJU1QsXG4gICAgQ2F0ZWdvcmllcy5OQVZJR0FUSU9OLFxuICAgIENhdGVnb3JpZXMuQ0FMTFMsXG5dO1xuXG5pbnRlcmZhY2UgSU1vZGFsIHtcbiAgICBjbG9zZTogKCkgPT4gdm9pZDtcbiAgICBmaW5pc2hlZDogUHJvbWlzZTxhbnlbXT47XG59XG5cbmNvbnN0IG1vZGlmaWVySWNvbjogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcbiAgICBbTW9kaWZpZXJzLkNPTU1BTkRdOiBcIuKMmFwiLFxufTtcblxuaWYgKGlzTWFjKSB7XG4gICAgbW9kaWZpZXJJY29uW01vZGlmaWVycy5BTFRdID0gXCLijKVcIjtcbn1cblxuY29uc3QgYWx0ZXJuYXRlS2V5TmFtZTogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcbiAgICBbS2V5LlBBR0VfVVBdOiBfdGQoXCJQYWdlIFVwXCIpLFxuICAgIFtLZXkuUEFHRV9ET1dOXTogX3RkKFwiUGFnZSBEb3duXCIpLFxuICAgIFtLZXkuRVNDQVBFXTogX3RkKFwiRXNjXCIpLFxuICAgIFtLZXkuRU5URVJdOiBfdGQoXCJFbnRlclwiKSxcbiAgICBbS2V5LlNQQUNFXTogX3RkKFwiU3BhY2VcIiksXG4gICAgW0tleS5IT01FXTogX3RkKFwiSG9tZVwiKSxcbiAgICBbS2V5LkVORF06IF90ZChcIkVuZFwiKSxcbiAgICBbRElHSVRTXTogX3RkKFwiW251bWJlcl1cIiksXG59O1xuY29uc3Qga2V5SWNvbjogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcbiAgICBbS2V5LkFSUk9XX1VQXTogXCLihpFcIixcbiAgICBbS2V5LkFSUk9XX0RPV05dOiBcIuKGk1wiLFxuICAgIFtLZXkuQVJST1dfTEVGVF06IFwi4oaQXCIsXG4gICAgW0tleS5BUlJPV19SSUdIVF06IFwi4oaSXCIsXG59O1xuXG5jb25zdCBTaG9ydGN1dDogUmVhY3QuRkM8e1xuICAgIHNob3J0Y3V0OiBJU2hvcnRjdXQ7XG59PiA9ICh7IHNob3J0Y3V0IH0pID0+IHtcbiAgICBjb25zdCBjbGFzc2VzID0gY2xhc3NOYW1lcyh7XG4gICAgICAgIFwibXhfS2V5Ym9hcmRTaG9ydGN1dHNEaWFsb2dfaW5saW5lXCI6IHNob3J0Y3V0LmtleWJpbmRzLmV2ZXJ5KGsgPT4gIWsubW9kaWZpZXJzIHx8IGsubW9kaWZpZXJzLmxlbmd0aCA9PT0gMCksXG4gICAgfSk7XG5cbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9e2NsYXNzZXN9PlxuICAgICAgICA8aDU+eyBfdChzaG9ydGN1dC5kZXNjcmlwdGlvbikgfTwvaDU+XG4gICAgICAgIHsgc2hvcnRjdXQua2V5YmluZHMubWFwKHMgPT4ge1xuICAgICAgICAgICAgbGV0IHRleHQgPSBzLmtleTtcbiAgICAgICAgICAgIGlmIChhbHRlcm5hdGVLZXlOYW1lW3Mua2V5XSkge1xuICAgICAgICAgICAgICAgIHRleHQgPSBfdChhbHRlcm5hdGVLZXlOYW1lW3Mua2V5XSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGtleUljb25bcy5rZXldKSB7XG4gICAgICAgICAgICAgICAgdGV4dCA9IGtleUljb25bcy5rZXldO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gPGRpdiBrZXk9e3Mua2V5fT5cbiAgICAgICAgICAgICAgICB7IHMubW9kaWZpZXJzICYmIHMubW9kaWZpZXJzLm1hcChtID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDxSZWFjdC5GcmFnbWVudCBrZXk9e219PlxuICAgICAgICAgICAgICAgICAgICAgICAgPGtiZD57IG1vZGlmaWVySWNvblttXSB8fCBfdChtKSB9PC9rYmQ+K1xuICAgICAgICAgICAgICAgICAgICA8L1JlYWN0LkZyYWdtZW50PjtcbiAgICAgICAgICAgICAgICB9KSB9XG4gICAgICAgICAgICAgICAgPGtiZD57IHRleHQgfTwva2JkPlxuICAgICAgICAgICAgPC9kaXY+O1xuICAgICAgICB9KSB9XG4gICAgPC9kaXY+O1xufTtcblxubGV0IGFjdGl2ZU1vZGFsOiBJTW9kYWwgPSBudWxsO1xuZXhwb3J0IGNvbnN0IHRvZ2dsZURpYWxvZyA9ICgpID0+IHtcbiAgICBpZiAoYWN0aXZlTW9kYWwpIHtcbiAgICAgICAgYWN0aXZlTW9kYWwuY2xvc2UoKTtcbiAgICAgICAgYWN0aXZlTW9kYWwgPSBudWxsO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3Qgc2VjdGlvbnMgPSBjYXRlZ29yeU9yZGVyLm1hcChjYXRlZ29yeSA9PiB7XG4gICAgICAgIGNvbnN0IGxpc3QgPSBzaG9ydGN1dHNbY2F0ZWdvcnldO1xuICAgICAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJteF9LZXlib2FyZFNob3J0Y3V0c0RpYWxvZ19jYXRlZ29yeVwiIGtleT17Y2F0ZWdvcnl9PlxuICAgICAgICAgICAgPGgzPnsgX3QoY2F0ZWdvcnkpIH08L2gzPlxuICAgICAgICAgICAgPGRpdj57IGxpc3QubWFwKHNob3J0Y3V0ID0+IDxTaG9ydGN1dCBrZXk9e3Nob3J0Y3V0LmRlc2NyaXB0aW9ufSBzaG9ydGN1dD17c2hvcnRjdXR9IC8+KSB9PC9kaXY+XG4gICAgICAgIDwvZGl2PjtcbiAgICB9KTtcblxuICAgIGFjdGl2ZU1vZGFsID0gTW9kYWwuY3JlYXRlVHJhY2tlZERpYWxvZyhcIktleWJvYXJkIFNob3J0Y3V0c1wiLCBcIlwiLCBJbmZvRGlhbG9nLCB7XG4gICAgICAgIGNsYXNzTmFtZTogXCJteF9LZXlib2FyZFNob3J0Y3V0c0RpYWxvZ1wiLFxuICAgICAgICB0aXRsZTogX3QoXCJLZXlib2FyZCBTaG9ydGN1dHNcIiksXG4gICAgICAgIGRlc2NyaXB0aW9uOiBzZWN0aW9ucyxcbiAgICAgICAgaGFzQ2xvc2VCdXR0b246IHRydWUsXG4gICAgICAgIG9uS2V5RG93bjogKGV2KSA9PiB7XG4gICAgICAgICAgICBpZiAoZXYuY3RybEtleSAmJiAhZXYuc2hpZnRLZXkgJiYgIWV2LmFsdEtleSAmJiAhZXYubWV0YUtleSAmJiBldi5rZXkgPT09IEtleS5TTEFTSCkgeyAvLyBDdHJsICsgL1xuICAgICAgICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIGFjdGl2ZU1vZGFsLmNsb3NlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIG9uRmluaXNoZWQ6ICgpID0+IHtcbiAgICAgICAgICAgIGFjdGl2ZU1vZGFsID0gbnVsbDtcbiAgICAgICAgfSxcbiAgICB9KTtcbn07XG5cbmV4cG9ydCBjb25zdCByZWdpc3RlclNob3J0Y3V0ID0gKGNhdGVnb3J5OiBDYXRlZ29yaWVzLCBkZWZuOiBJU2hvcnRjdXQpID0+IHtcbiAgICBzaG9ydGN1dHNbY2F0ZWdvcnldLnB1c2goZGVmbik7XG59O1xuIl19